# 能源数据结构分析——Energy_Dataset

生成时间: 2025-04-26 10:50:50

## 目录分析: Contacting

### 文件: April_2024.csv

#### 基本信息

- 总行数: 2696875

- 总列数: 44

- 时间范围: 2024-04-01 00:00:00 UTC 到 2024-04-30 23:59:59 UTC

#### 时间连续性分析

- 最小时间间隔: 0.0秒

- 最大时间间隔: 46122.0秒

- 平均时间间隔: 0.9611123841899918秒

- 时间间隔标准差: 30.268805355587777秒

#### 数据结构分析

##### 列信息

| 列名 | 数据类型 | 缺失值数量 | 唯一值数量 | 重复值数量 | 示例值 |
| --- | --- | --- | --- | --- | --- |
| ID | int64 | 0 | 2492049 | 204826 | [584190452, 583125419, 583088705] |
| TimeStamp | object | 0 | 2478844 | 218031 | ['2024-04-15 12:19:33 UTC', '2024-04-14 15:07:33 UTC', '2024-04-14 14:23:45 UTC'] |
| Station | object | 0 | 1 | 2696874 | ['E08VM_01-02210-00', 'E08VM_01-02210-00', 'E08VM_01-02210-00'] |
| rTotalActivePower | float64 | 0 | 530408 | 2166467 | [4406.05, 4559.04, 4300.62] |
| rTotalReactivePower | float64 | 0 | 588819 | 2108056 | [1434.56, 1847.4, 1970.36] |
| rTotalApparentPower | float64 | 0 | 429148 | 2267727 | [7256.96, 8065.07, 8243.99] |
| rTotalPowerFactorPF | float64 | 0 | 315675 | 2381200 | [0.607148, 0.565282, 0.521667] |
| rTotalActiveEnergy | int64 | 0 | 1 | 2696874 | [0, 0, 0] |
| rTotalReactiveEnergy | int64 | 0 | 97 | 2696778 | [1998600, 1998600, 1998600] |
| rTotalApparentEnergy | int64 | 0 | 6123 | 2690752 | [207175000, 206976000, 206968000] |
| aCurrentL1 | float64 | 0 | 172992 | 2523883 | [14.5417, 14.8786, 15.1752] |
| aCurrentL2 | float64 | 0 | 318782 | 2378093 | [8.19644, 9.05405, 9.23969] |
| aCurrentL3 | float64 | 0 | 209264 | 2487611 | [9.87805, 11.5014, 11.5919] |
| aVoltage_L1_N | float64 | 0 | 16064 | 2680811 | [222.06, 226.656, 228.1] |
| aVoltage_L2_N | float64 | 0 | 15855 | 2681020 | [223.313, 228.526, 229.825] |
| aVoltage_L3_N | float64 | 0 | 16254 | 2680621 | [222.458, 228.117, 229.386] |
| aActivePower_L1 | float64 | 0 | 245260 | 2451615 | [2154.47, 2042.13, 1982.06] |
| aActivePower_L2 | float64 | 0 | 451761 | 2245114 | [902.664, 948.463, 859.721] |
| aActivePower_L3 | float64 | 0 | 225923 | 2470952 | [1348.91, 1568.44, 1458.84] |
| aReactivePower_L1 | float64 | 0 | 475825 | 2221050 | [624.844, 855.955, 912.73] |
| aReactivePower_L2 | float64 | 0 | 890449 | 1806426 | [307.858, 263.723, 308.399] |
| aReactivePower_L3 | float64 | 0 | 642154 | 2054721 | [501.858, 727.724, 749.233] |
| aApparentPower_L1 | float64 | 0 | 274643 | 2422232 | [3229.14, 3372.34, 3461.45] |
| aApparentPower_L2 | float64 | 0 | 211972 | 2484903 | [1830.37, 2069.08, 2123.51] |
| aApparentPower_L3 | float64 | 0 | 226230 | 2470645 | [2197.46, 2623.66, 2659.03] |
| aCosPhi_L1 | float64 | 0 | 301165 | 2395710 | [0.955553, 0.923705, 0.91699] |
| aCosPhi_L2 | float64 | 0 | 271370 | 2425505 | [0.867936, 0.964234, 0.953649] |
| aCosPhi_L3 | float64 | 0 | 235365 | 2461510 | [0.944852, 0.901264, 0.894686] |
| aPowerFactorPF_L1 | float64 | 0 | 262720 | 2434155 | [0.667197, 0.605555, 0.572609] |
| aPowerFactorPF_L2 | float64 | 0 | 467337 | 2229538 | [0.493159, 0.458398, 0.404857] |
| aPowerFactorPF_L3 | float64 | 0 | 327125 | 2369750 | [0.613853, 0.597809, 0.548638] |
| aFrequency_L1 | float64 | 0 | 2114 | 2694761 | [49.9888, 50.0074, 50.0344] |
| aFrequency_L2 | int64 | 0 | 1 | 2696874 | [0, 0, 0] |
| aFrequency_L3 | int64 | 0 | 1 | 2696874 | [0, 0, 0] |
| airTotal | int64 | 0 | 20066 | 2676809 | [424650, 424010, 423985] |
| airDurchfluss | float64 | 0 | 538 | 2696337 | [0.3, 0.0, 0.1] |
| airTempeatur | float64 | 0 | 42 | 2696833 | [29.0, 30.0, 29.2] |
| airDruck | int64 | 0 | 1 | 2696874 | [0, 0, 0] |
| coolTotal | int64 | 0 | 1 | 2696874 | [0, 0, 0] |
| coolDurchfluss | int64 | 0 | 1 | 2696874 | [0, 0, 0] |
| coolTempeatur | int64 | 0 | 1 | 2696874 | [0, 0, 0] |
| coolDruck | int64 | 0 | 1 | 2696874 | [0, 0, 0] |
| celTemp | int64 | 0 | 1 | 2696874 | [0, 0, 0] |
| celHum | int64 | 0 | 1 | 2696874 | [0, 0, 0] |

##### 重复数据分析

- 完全重复的行数: 409652

- ID和TimeStamp同时重复的行数: 409652



## 目录分析: PCB

### 文件: April_2024.csv

#### 基本信息

- 总行数: 2690691

- 总列数: 44

- 时间范围: 2024-04-01 00:00:00 UTC 到 2024-04-30 23:59:59 UTC

#### 时间连续性分析

- 最小时间间隔: 0.0秒

- 最大时间间隔: 46068.0秒

- 平均时间间隔: 0.9633213042007812秒

- 时间间隔标准差: 30.268147956969973秒

#### 数据结构分析

##### 列信息

| 列名 | 数据类型 | 缺失值数量 | 唯一值数量 | 重复值数量 | 示例值 |
| --- | --- | --- | --- | --- | --- |
| ID | int64 | 0 | 2487100 | 203591 | [584083829, 584084319, 584084291] |
| TimeStamp | object | 0 | 2483767 | 206924 | ['2024-04-15 10:12:13 UTC', '2024-04-15 10:12:48 UTC', '2024-04-15 10:12:46 UTC'] |
| Station | object | 0 | 1 | 2690690 | ['E08VM_01-02500-01', 'E08VM_01-02500-01', 'E08VM_01-02500-01'] |
| rTotalActivePower | float64 | 0 | 185070 | 2505621 | [1650.4, 1516.58, 1534.09] |
| rTotalReactivePower | float64 | 0 | 558574 | 2132117 | [131.33, 162.757, 167.405] |
| rTotalApparentPower | float64 | 0 | 148928 | 2541763 | [2452.74, 2344.02, 2369.46] |
| rTotalPowerFactorPF | float64 | 0 | 349709 | 2340982 | [0.672879, 0.646998, 0.647442] |
| rTotalActiveEnergy | int64 | 0 | 1 | 2690690 | [34068000, 34068000, 34068000] |
| rTotalReactiveEnergy | int64 | 0 | 79 | 2690612 | [4588880, 4588880, 4588880] |
| rTotalApparentEnergy | int64 | 0 | 18617 | 2672074 | [75057600, 75057600, 75057600] |
| aCurrentL1 | float64 | 0 | 245024 | 2445667 | [3.40373, 3.2702, 3.30568] |
| aCurrentL2 | float64 | 0 | 272997 | 2417694 | [3.51169, 3.31562, 3.40702] |
| aCurrentL3 | float64 | 0 | 200936 | 2489755 | [4.31551, 4.13264, 4.11914] |
| aVoltage_L1_N | float64 | 0 | 16108 | 2674583 | [217.112, 217.426, 217.598] |
| aVoltage_L2_N | float64 | 0 | 15953 | 2674738 | [219.362, 219.383, 219.67] |
| aVoltage_L3_N | float64 | 0 | 16298 | 2674393 | [218.611, 219.133, 218.913] |
| aActivePower_L1 | float64 | 0 | 560398 | 2130293 | [437.264, 415.255, 415.047] |
| aActivePower_L2 | float64 | 0 | 582148 | 2108543 | [460.593, 396.44, 418.47] |
| aActivePower_L3 | float64 | 0 | 400874 | 2289817 | [752.541, 704.88, 700.57] |
| aReactivePower_L1 | float64 | 0 | 633630 | 2057061 | [66.7514, 88.4968, 66.3891] |
| aReactivePower_L2 | float64 | 0 | 1123429 | 1567262 | [-43.1377, -31.9463, -12.6988] |
| aReactivePower_L3 | float64 | 0 | 635334 | 2055357 | [107.716, 106.206, 113.714] |
| aApparentPower_L1 | float64 | 0 | 361625 | 2329066 | [738.988, 711.027, 719.309] |
| aApparentPower_L2 | float64 | 0 | 307107 | 2383584 | [770.333, 727.391, 748.418] |
| aApparentPower_L3 | float64 | 0 | 240231 | 2450460 | [943.42, 905.599, 901.733] |
| aCosPhi_L1 | float64 | 0 | 198969 | 2491722 | [0.997737, 0.984648, 0.998269] |
| aCosPhi_L2 | float64 | 0 | 114886 | 2575805 | [-0.991317, -0.999202, -0.997566] |
| aCosPhi_L3 | float64 | 0 | 113042 | 2577649 | [0.994725, 0.982331, 0.997207] |
| aPowerFactorPF_L1 | float64 | 0 | 472988 | 2217703 | [0.591707, 0.584021, 0.577009] |
| aPowerFactorPF_L2 | float64 | 0 | 469490 | 2221201 | [0.597915, 0.545016, 0.559139] |
| aPowerFactorPF_L3 | float64 | 0 | 247703 | 2442988 | [0.797674, 0.778359, 0.776915] |
| aFrequency_L1 | float64 | 0 | 2118 | 2688573 | [50.0529, 50.0519, 50.0519] |
| aFrequency_L2 | int64 | 0 | 1 | 2690690 | [0, 0, 0] |
| aFrequency_L3 | int64 | 0 | 1 | 2690690 | [0, 0, 0] |
| airTotal | float64 | 0 | 31949 | 2658742 | [40805.2, 40805.3, 40805.3] |
| airDurchfluss | float64 | 0 | 2340 | 2688351 | [3.68, 5.92, 7.88] |
| airTempeatur | float64 | 0 | 62 | 2690629 | [27.3, 27.3, 27.5] |
| airDruck | float64 | 0 | 251 | 2690440 | [6.38, 6.2, 6.3] |
| coolTotal | int64 | 0 | 1 | 2690690 | [0, 0, 0] |
| coolDurchfluss | int64 | 0 | 1 | 2690690 | [0, 0, 0] |
| coolTempeatur | int64 | 0 | 1 | 2690690 | [0, 0, 0] |
| coolDruck | int64 | 0 | 1 | 2690690 | [0, 0, 0] |
| celTemp | float64 | 0 | 2 | 2690689 | [25.6, 25.6, 25.6] |
| celHum | float64 | 0 | 120 | 2690571 | [21.5, 21.5, 21.5] |

##### 重复数据分析

- 完全重复的行数: 407182

- ID和TimeStamp同时重复的行数: 407182



## 目录分析: Ring

### 文件: April_2024.csv

#### 基本信息

- 总行数: 2689811

- 总列数: 44

- 时间范围: 2024-04-01 00:00:00 UTC 到 2024-04-30 23:59:59 UTC

#### 时间连续性分析

- 最小时间间隔: 0.0秒

- 最大时间间隔: 46122.0秒

- 平均时间间隔: 0.9636364650291285秒

- 时间间隔标准差: 30.308680865450885秒

#### 数据结构分析

##### 列信息

| 列名 | 数据类型 | 缺失值数量 | 唯一值数量 | 重复值数量 | 示例值 |
| --- | --- | --- | --- | --- | --- |
| ID | int64 | 0 | 2486423 | 203388 | [584768038, 584765147, 584767982] |
| TimeStamp | object | 0 | 2469398 | 220413 | ['2024-04-15 23:50:02 UTC', '2024-04-15 23:46:24 UTC', '2024-04-15 23:49:58 UTC'] |
| Station | object | 0 | 1 | 2689810 | ['E08EM_01-06000-01', 'E08EM_01-06000-01', 'E08EM_01-06000-01'] |
| rTotalActivePower | float64 | 0 | 433582 | 2256229 | [707.417, 706.058, 710.933] |
| rTotalReactivePower | float64 | 0 | 656561 | 2033250 | [601.497, 515.79, 596.763] |
| rTotalApparentPower | float64 | 0 | 297974 | 2391837 | [1108.48, 1110.7, 1104.93] |
| rTotalPowerFactorPF | float64 | 0 | 299132 | 2390679 | [0.638185, 0.635689, 0.64342] |
| rTotalActiveEnergy | int64 | 0 | 1 | 2689810 | [0, 0, 0] |
| rTotalReactiveEnergy | int64 | 0 | 1410 | 2688401 | [1288140, 1288140, 1288140] |
| rTotalApparentEnergy | int64 | 0 | 8801 | 2681010 | [32489600, 32489600, 32489600] |
| aCurrentL1 | float64 | 0 | 307797 | 2382014 | [2.01956, 1.79505, 2.02851] |
| aCurrentL2 | float64 | 0 | 254175 | 2435636 | [1.3723, 1.4612, 1.34574] |
| aCurrentL3 | float64 | 0 | 270925 | 2418886 | [1.60488, 1.76785, 1.61417] |
| aVoltage_L1_N | float64 | 0 | 16131 | 2673680 | [220.869, 219.89, 220.465] |
| aVoltage_L2_N | float64 | 0 | 15927 | 2673884 | [222.45, 221.911, 222.193] |
| aVoltage_L3_N | float64 | 0 | 16311 | 2673500 | [222.542, 221.584, 222.217] |
| aActivePower_L1 | float64 | 0 | 352785 | 2337026 | [248.314, 233.933, 252.979] |
| aActivePower_L2 | float64 | 0 | 309904 | 2379907 | [203.867, 206.421, 200.037] |
| aActivePower_L3 | float64 | 0 | 386252 | 2303559 | [255.236, 265.704, 257.917] |
| aReactivePower_L1 | float64 | 0 | 804757 | 1885054 | [313.848, 236.557, 314.133] |
| aReactivePower_L2 | float64 | 0 | 109391 | 2580420 | [137.163, 131.199, 138.159] |
| aReactivePower_L3 | float64 | 0 | 273510 | 2416301 | [150.487, 148.034, 144.471] |
| aApparentPower_L1 | float64 | 0 | 541749 | 2148062 | [446.058, 394.712, 447.217] |
| aApparentPower_L2 | float64 | 0 | 340429 | 2349382 | [305.269, 324.257, 299.015] |
| aApparentPower_L3 | float64 | 0 | 478029 | 2211782 | [357.155, 391.727, 358.696] |
| aCosPhi_L1 | float64 | 0 | 587652 | 2102159 | [0.625655, 0.794137, 0.624308] |
| aCosPhi_L2 | float64 | 0 | 279119 | 2410692 | [0.836958, 0.912782, 0.827003] |
| aCosPhi_L3 | float64 | 0 | 233750 | 2456061 | [0.872363, 0.922019, 0.86776] |
| aPowerFactorPF_L1 | float64 | 0 | 476207 | 2213604 | [0.556684, 0.592666, 0.565673] |
| aPowerFactorPF_L2 | float64 | 0 | 208234 | 2481577 | [0.667827, 0.636597, 0.668987] |
| aPowerFactorPF_L3 | float64 | 0 | 253666 | 2436145 | [0.714638, 0.678288, 0.719042] |
| aFrequency_L1 | float64 | 0 | 2127 | 2687684 | [49.9997, 49.9964, 49.9997] |
| aFrequency_L2 | int64 | 0 | 1 | 2689810 | [0, 0, 0] |
| aFrequency_L3 | int64 | 0 | 1 | 2689810 | [0, 0, 0] |
| airTotal | int64 | 0 | 8165 | 2681646 | [171325, 171324, 171324] |
| airDurchfluss | float64 | 0 | 496 | 2689315 | [16.4, 8.9, 16.5] |
| airTempeatur | float64 | 0 | 99 | 2689712 | [26.8, 27.0, 26.8] |
| airDruck | int64 | 0 | 1 | 2689810 | [0, 0, 0] |
| coolTotal | int64 | 0 | 1 | 2689810 | [0, 0, 0] |
| coolDurchfluss | int64 | 0 | 1 | 2689810 | [0, 0, 0] |
| coolTempeatur | int64 | 0 | 1 | 2689810 | [0, 0, 0] |
| coolDruck | int64 | 0 | 1 | 2689810 | [0, 0, 0] |
| celTemp | int64 | 0 | 1 | 2689810 | [0, 0, 0] |
| celHum | int64 | 0 | 1 | 2689810 | [0, 0, 0] |

##### 重复数据分析

- 完全重复的行数: 406776

- ID和TimeStamp同时重复的行数: 406776
###

#### 从数据质量分析中，我们可以看到一些重要的发现：
-数据完整性：
所有列都没有缺失值（missing values = 0）
大多数列都有变化（has variance = Yes）
-零值分析：
有几个列全是零值（100% zeros）：
rTotalActiveEnergy
aFrequency_L2, aFrequency_L3
airDruck
coolTotal, coolDurchfluss, coolTempeatur, coolDruck
celTemp, celHum
-数据分布：
大多数电力相关的测量值（电流、电压、功率等）都有很高的唯一值数量，表明这些值在连续变化
airDurchfluss（空气流量）有36.17%的零值，可能表示设备停机或待机状态
温度相关的测量值（airTempeatur）只有60个唯一值，这是合理的，因为温度变化通常比较缓慢
-异常发现：
一些传感器似乎没有工作（全是零值的列）
只有aFrequency_L1有数据，L2和L3都是零值










### Duration_of_Anomalies 数据库分析

#### 基本结构
Duration_of_Anomalies.csv 包含以下列：
- Condition: 异常状态标识（如 MS, R 等）
- Comment: 详细的异常描述
- Station: 发生异常的工作站
- Line: 生产线标识
- Date: 异常发生时间
- Shift: 班次（Früh早班, Spät晚班, Nacht夜班）
- Downtime: 停机时长

#### 数据特点
1. 记录了生产线上的异常事件和停机情况
2. 包含具体的时间戳和持续时间
3. 提供了异常的详细描述和分类
4. 关联到具体的工作站和生产线

## 异常数据与能源数据的关联分析

#### 时间维度关联
1. Energy_Data（能源数据）
   - 包含高频率采样的能源消耗数据（平均间隔约1秒）
   - 覆盖多个月的连续监测数据
   - 记录了设备的实时运行状态

2. Duration_of_Anomalies（异常数据）
   - 记录具体的异常事件发生时间
   - 包含事件的持续时长
   - 可以与能源数据的时间戳进行匹配


### 在机器学习项目中的角色

#### Energy_Data 的角色
1. 特征数据源
   - 提供丰富的能源消耗指标
   - 包含多维度的设备运行参数
   - 可用于提取时序特征
   - 适合用于异常检测的输入特征

2. 监测对象
   - 反映设备的运行状态
   - 能源异常可能预示设备故障
   - 可用于预测性维护

#### Duration_of_Anomalies 的角色
1. 标签数据源
   - 提供已知异常的时间点和持续时间
   - 可用于监督学习中的标签构建
   - 帮助验证异常检测模型的效果

2. 领域知识来源
   - 提供异常类型的分类信息
   - 包含专家总结的异常描述
   - 有助于理解异常的业务含义

### 数据处理建议

#### 预处理步骤
1. 时间对齐
   - 统一时间格式和时区
   - 建立时间窗口的对应关系
   - 处理时间重叠的情况

2. 特征工程
   - 从能源数据中提取时序特征
   - 计算统计特征（均值、方差等）
   - 构建滑动窗口特征

3. 标签构建
   - 基于异常持续时间创建标签
   - 处理多重异常的重叠情况
   - 考虑异常的前后影响时间


#### 验证与评估
1. 时间划分
   - 考虑时间连续性进行划分
   - 避免数据泄露
   - 保持验证集的时间独立性

2. 评估指标
   - 考虑异常检测的特殊性
   - 关注召回率和精确率
   - 评估检测的时间延迟

3. 业务验证
   - 结合领域专家知识
   - 验证检测结果的实用性
   - 评估经济效益

### 注意事项
1. 数据质量
   - 处理缺失值和异常值
   - 确保时间序列的连续性
   - 验证数据的一致性

2. 特征选择
   - 考虑特征的物理含义
   - 选择对异常敏感的指标
   - 减少冗余特征

3. 模型选择
   - 考虑实时性要求
   - 平衡模型复杂度
   - 注意可解释性需求

4. 系统集成
   - 考虑在线部署需求
   - 设计数据流处理流程
   - 规划模型更新策略

对这两个数据库的深入理解和建议：
数据加载优化：
使用Dask替代pandas进行大数据处理
实现延迟加载和分块处理
设置合适的块大小以平衡内存使用和性能

关键发现：
异常数据是离散的事件记录
能源数据是连续的时序记录
两者通过时间戳和工作站建立关联
异常持续时间可用于创建时间窗口标签

项目实施建议：
使用滑动窗口进行特征提取
实现在线学习以适应新的异常模式
建立异常预警机制
保存模型训练历史用于性能评估

注意事项：
处理时间重叠的异常事件
考虑异常的前导和滞后效应
平衡数据集中正常和异常样本的比例
验证异常标签的准确性