[2025-05-11 13:55:11,593] [INFO] [<frozen importlib] - Loading training and validation data...
[2025-05-11 13:55:12,046] [INFO] [<frozen importlib] - Class distribution before SMOTE:
[2025-05-11 13:55:12,046] [INFO] [<frozen importlib] - Training set - Normal: 1101486, Anomaly: 86059
[2025-05-11 13:55:12,046] [INFO] [<frozen importlib] - Training set anomaly ratio: 0.0725
[2025-05-11 13:55:12,047] [INFO] [<frozen importlib] - Validation set - Normal: 244243, Anomaly: 10230
[2025-05-11 13:55:12,047] [INFO] [<frozen importlib] - Validation set anomaly ratio: 0.0402
[2025-05-11 13:55:12,047] [INFO] [<frozen importlib] - Handling missing values with SimpleImputer...
[2025-05-11 13:55:13,058] [INFO] [<frozen importlib] - Number of NaN values in training set before imputation: 2715532
[2025-05-11 13:55:13,072] [INFO] [<frozen importlib] - Number of NaN values in validation set before imputation: 581898
[2025-05-11 13:55:13,144] [INFO] [<frozen importlib] - Number of NaN values in training set after imputation: 0
[2025-05-11 13:55:13,159] [INFO] [<frozen importlib] - Number of NaN values in validation set after imputation: 0
[2025-05-11 13:55:13,159] [INFO] [<frozen importlib] - Applying BorderlineSMOTE for oversampling...
[2025-05-11 13:55:52,550] [INFO] [<frozen importlib] - Class distribution after BorderlineSMOTE:
[2025-05-11 13:55:52,550] [INFO] [<frozen importlib] - Training set - Normal: 1101486, Anomaly: 110148
[2025-05-11 13:55:52,550] [INFO] [<frozen importlib] - Training set anomaly ratio: 0.0909
[2025-05-11 13:55:52,550] [INFO] [<frozen importlib] - Number of synthetic samples generated: 24089
[2025-05-11 13:55:52,550] [INFO] [<frozen importlib] - Training data shape: (1211634, 73)
[2025-05-11 13:55:52,550] [INFO] [<frozen importlib] - Validation data shape: (254473, 73)
[2025-05-11 13:55:52,572] [INFO] [<frozen importlib] - Training model with parameters: {'n_estimators': 300, 'max_depth': 30, 'min_samples_split': 10, 'class_weight': 'balanced'}
[2025-05-11 13:58:25,248] [INFO] [<frozen importlib] - Confusion matrix saved to src/model_report/confusion_matrix_1.png
[2025-05-11 13:58:25,335] [INFO] [<frozen importlib] - Precision-Recall curve saved to src/model_report/pr_curve_1.png
[2025-05-11 13:58:25,335] [INFO] [<frozen importlib] - New best model found! F1 Score: 0.1247
[2025-05-11 13:58:25,335] [INFO] [<frozen importlib] - Optimal threshold: 0.1001
[2025-05-11 13:58:25,394] [INFO] [<frozen importlib] - Metrics comparison plot saved to src/model_report/metrics_comparison.png
[2025-05-11 13:58:25,394] [INFO] [<frozen importlib] - Validation results saved to src/model_report/validation_results2.md
[2025-05-11 13:58:26,028] [INFO] [<frozen importlib] - Best model saved to src/models/random_forest_best_manual2.joblib
[2025-05-11 13:58:26,113] [INFO] [<frozen importlib] - Feature importance saved to src/model_report/feature_importance2.csv
[2025-05-11 13:58:26,450] [INFO] [<frozen importlib] - ROC curve saved to src/model_report/roc_curve.png
