# Transformer Model Configuration for Energy Anomaly Detection with PCA Features

# Paths
paths:
  pc_data_path: "Data/pc/pc_features_train_20.parquet"  # PCA特征数据路径
  output_dir: "experiments/pc_transformer"  # 模型输出和日志目录

  # pc_data_path: "Data/pc/statistic_40/train.parquet"  # PCA特征数据路径
  # output_dir: "experiments/statistic_40_transformer"  # 模型输出和日志目录
# Data configuration
data:
  seq_length: 60      # 序列长度/窗口大小
  stride: 60             # 滑动窗口步长
  val_ratio: 0.15       # 验证集比例（取时间序列末尾的15%）
  standardize: true     # 是否标准化特征
# Model configuration
model:
  d_model: 128           # Transformer模型的特征维度 (降低，因为PCA特征已经降维)
  nhead: 8              # 多头注意力中的头数
  num_layers: 1         # Transformer层数
  dim_feedforward: 256  # 前馈网络的维度
  dropout: 0.3          # Dropout概率
  num_classes: 2        # 输出类别数（二分类）
  activation: "gelu"    # Transformer层的激活函数

# Training configuration
training:
  batch_size: 64
  num_workers: 4
  num_epochs: 100
  learning_rate: 0.01
  weight_decay: 0.0001
  optimizer: "adam"     # 优化器选项: adam
  
  # Learning rate scheduling
  lr_scheduler: "reduce_on_plateau"  # 学习率调度器: reduce_on_plateau, cosine_annealing, none
  lr_reduce_factor: 0.5              # 学习率减少因子
  lr_reduce_patience: 5              # 没有改善后减少学习率的周期数
  min_lr: 1.0e-6                     # CosineAnnealingLR的最小学习率
  
  # Early stopping
  early_stopping_patience: 15        # 没有改善后停止训练的周期数
  early_stopping_min_delta: 0.0001   # 被视为改善的最小变化
  early_stopping_metric: "optimal_f1"  # 监控用于早停的指标: loss, f1, auprc, optimal_f1
  
  # Class weighting and loss function
  use_focal_loss: true               # 是否使用focal loss而不是交叉熵损失
  focal_loss_alpha: 0.5              # Focal loss的alpha参数（稀有类的权重）
  focal_loss_gamma: 2.0              # Focal loss的gamma参数（聚焦参数）

# Hardware configuration
hardware:
  precision: "float32"               # 精度选项: float32, float16（混合精度）

# Sequence labeling configuration
sequence_labeling:
  use_threshold_optimization: true   # 是否优化二分类阈值
  evaluation_metric: "optimal_f1"    # 模型评估的主要指标（f1, optimal_f1, auprc）

# Visualization
visualization:
  plot_confusion_matrix: true        # 是否绘制混淆矩阵
  plot_pr_curve: true                # 是否绘制精确率-召回率曲线
  plot_predictions: true             # 是否绘制预测样本 