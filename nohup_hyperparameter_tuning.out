[2025-11-19 08:22:01,866] [INFO] [<frozen importlib] - Loaded configuration from: configs/xgboost_tuning_config.yaml
[2025-11-19 08:22:01,866] [INFO] [<frozen importlib] - Tuning directory: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201
[2025-11-19 08:22:01,866] [INFO] [<frozen importlib] - Loading data from: experiments/statistic_feature_1024s_256/statistic_window_features_contact/window_features.parquet
[2025-11-19 08:22:01,866] [INFO] [<frozen importlib] - 
============================================================
[2025-11-19 08:22:01,866] [INFO] [<frozen importlib] - CREATING XGBOOST DATA LOADER
[2025-11-19 08:22:01,866] [INFO] [<frozen importlib] - ============================================================
[2025-11-19 08:22:01,866] [INFO] [<frozen importlib] - Loading window features from: experiments/statistic_feature_1024s_256/statistic_window_features_contact/window_features.parquet
[2025-11-19 08:22:01,966] [INFO] [<frozen importlib] - Loaded 125979 rows with 122 columns
[2025-11-19 08:22:01,966] [INFO] [<frozen importlib] - Feature columns: 120
[2025-11-19 08:22:01,967] [INFO] [<frozen importlib] - Target column: anomaly_label
[2025-11-19 08:22:01,967] [INFO] [<frozen importlib] - First few features: ['rTotalApparentEnergy_mean', 'rTotalApparentEnergy_std', 'rTotalApparentEnergy_change_point_score', 'rTotalApparentEnergy_ks_test_statistic', 'rTotalApparentEnergy_skew', 'rTotalApparentEnergy_trend_slope', 'rTotalApparentEnergy_dominant_frequency', 'rTotalApparentEnergy_spectral_peak', 'rTotalApparentEnergy_spectral_flatness', 'rTotalApparentEnergy_freq_energy_ratio_low_high']
[2025-11-19 08:22:01,967] [INFO] [<frozen importlib] - Overall anomaly ratio: 13938/125979 = 0.1106
[2025-11-19 08:22:01,967] [INFO] [<frozen importlib] - Splitting data sequentially - Train: 0.7, Val: 0.15, Test: 0.15
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - Train: 88185 samples
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - Val: 18897 samples
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - Test: 18897 samples
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - 
============================================================
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - DATA STATISTICS
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - ============================================================
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - 
--- Data Split ---
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - Total samples: 125979
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - Train samples: 88185 (70.0%)
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - Val samples: 18897 (15.0%)
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - Test samples: 18897 (15.0%)
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - 
--- Anomaly Distribution ---
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - Total anomalies: 13938 (0.1106)
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - Train - Normal: 76930, Anomaly: 11255 (ratio: 0.1276)
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - Val   - Normal: 17445, Anomaly: 1452 (ratio: 0.0768)
[2025-11-19 08:22:01,998] [INFO] [<frozen importlib] - Test  - Normal: 17666, Anomaly: 1231 (ratio: 0.0651)
[2025-11-19 08:22:01,999] [INFO] [<frozen importlib] - 
--- Feature Information ---
[2025-11-19 08:22:01,999] [INFO] [<frozen importlib] - Number of features: 120
[2025-11-19 08:22:01,999] [INFO] [<frozen importlib] - Feature names (first 10): ['rTotalApparentEnergy_mean', 'rTotalApparentEnergy_std', 'rTotalApparentEnergy_change_point_score', 'rTotalApparentEnergy_ks_test_statistic', 'rTotalApparentEnergy_skew', 'rTotalApparentEnergy_trend_slope', 'rTotalApparentEnergy_dominant_frequency', 'rTotalApparentEnergy_spectral_peak', 'rTotalApparentEnergy_spectral_flatness', 'rTotalApparentEnergy_freq_energy_ratio_low_high']
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - 
--- Data Arrays ---
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - X_train shape: (88185, 120), y_train shape: (88185,)
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - X_val shape: (18897, 120), y_val shape: (18897,)
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - X_test shape: (18897, 120), y_test shape: (18897,)
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Number of features: 120
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Training set class distribution - Negative: 76930, Positive: 11255, Ratio: 6.84
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - ============================================================

[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Data loaded:
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   Train samples: 88185
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   Validation samples: 18897
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   Test samples: 18897
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   Features: 120
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Tuning configuration from config file:
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   n_trials: 500
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   timeout: None
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   n_jobs: 1
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   device: GPU (CUDA)
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   optimization_metric: auprc
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Initialized XGBoostOptunaTuner (GPU mode)
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Optimization metric: auprc
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Search space loaded from config with 12 parameters:
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   max_depth: {'type': 'int', 'low': 3, 'high': 5}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   min_child_weight: {'type': 'int', 'low': 1, 'high': 10}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   gamma: {'type': 'float', 'low': 0.0, 'high': 1.0}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   learning_rate: {'type': 'float', 'low': 0.03, 'high': 0.2, 'log': True}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   n_estimators: {'type': 'int', 'low': 100, 'high': 500, 'step': 50}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   alpha: {'type': 'float', 'low': 0.0, 'high': 2.0}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   lambda: {'type': 'float', 'low': 0.0, 'high': 5.0}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   subsample: {'type': 'float', 'low': 0.5, 'high': 1.0}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   colsample_bytree: {'type': 'float', 'low': 0.5, 'high': 1.0}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   colsample_bylevel: {'type': 'float', 'low': 0.5, 'high': 1.0}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   colsample_bynode: {'type': 'float', 'low': 0.5, 'high': 1.0}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] -   scale_pos_weight: {'type': 'float', 'low': 5, 'high': 20}
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - ============================================================
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Starting Hyperparameter Tuning with Optuna
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - ============================================================
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Number of trials: 500
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Timeout: None
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Parallel jobs: 1
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Device: GPU (CUDA)
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Optimization metric: auprc
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - Note: Reported F1/Precision/Recall are point-adjusted values
[2025-11-19 08:22:02,028] [INFO] [<frozen importlib] - ============================================================
[I 2025-11-19 08:22:02,029] A new study created in memory with name: optuna_tuning_20251119_082201
  0%|          | 0/500 [00:00<?, ?it/s][2025-11-19 08:22:02,030] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 19.548647782429917
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   min_child_weight: 10
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   gamma: 0.7319939418114051
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   alpha: 0.3119890406724053
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   lambda: 0.2904180608409973
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   learning_rate: 0.09340308327072934
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   subsample: 0.9330880728874675
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   colsample_bytree: 0.8005575058716043
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8540362888980227
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   colsample_bynode: 0.5102922471479012
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:02,030] [INFO] [<frozen importlib] -   scale_pos_weight: 19.548647782429917
[2025-11-19 08:22:02,264] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[0]	train-logloss:1.14882	train-auc:0.65384	train-aucpr:0.22618	val-logloss:1.16857	val-auc:0.60247	val-aucpr:0.10196
[10]	train-logloss:1.09500	train-auc:0.69140	train-aucpr:0.29390	val-logloss:0.98970	val-auc:0.66229	val-aucpr:0.15069
[20]	train-logloss:1.07645	train-auc:0.70106	train-aucpr:0.30722	val-logloss:0.94424	val-auc:0.65954	val-aucpr:0.15905
[30]	train-logloss:1.06507	train-auc:0.71026	train-aucpr:0.31959	val-logloss:0.89724	val-auc:0.66606	val-aucpr:0.16018
[38]	train-logloss:1.05630	train-auc:0.71902	train-aucpr:0.32849	val-logloss:0.82004	val-auc:0.61599	val-aucpr:0.11234
[2025-11-19 08:22:02,500] [INFO] [<frozen importlib] - Training completed at iteration 9
[2025-11-19 08:22:02,501] [INFO] [<frozen importlib] - Best train loss: 1.0978
[2025-11-19 08:22:02,501] [INFO] [<frozen importlib] - Best val loss: 1.0148
[2025-11-19 08:22:02,501] [INFO] [<frozen importlib] - Best val AUC: 0.6769
[2025-11-19 08:22:02,501] [INFO] [<frozen importlib] - Best val AUCPR: 0.1805
[2025-11-19 08:22:02,505] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:22:03,660] [INFO] [<frozen importlib] - Optimal threshold: 0.7432
[2025-11-19 08:22:03,660] [INFO] [<frozen importlib] - Best f1: 0.2379
[2025-11-19 08:22:03,660] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:22:03,675] [INFO] [<frozen importlib] - Validation Results (threshold=0.7432):
[2025-11-19 08:22:03,675] [INFO] [<frozen importlib] -   Accuracy: 0.8976
[2025-11-19 08:22:03,675] [INFO] [<frozen importlib] -   Precision: 0.2778
[2025-11-19 08:22:03,675] [INFO] [<frozen importlib] -   Recall: 0.2080
[2025-11-19 08:22:03,675] [INFO] [<frozen importlib] -   F1 Score: 0.2379
[2025-11-19 08:22:03,675] [INFO] [<frozen importlib] -   AUROC: 0.6769
[2025-11-19 08:22:03,675] [INFO] [<frozen importlib] -   AUPRC: 0.1760
[2025-11-19 08:22:03,675] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:22:03,675] [INFO] [<frozen importlib] -     TN=16660, FP=785
[2025-11-19 08:22:03,675] [INFO] [<frozen importlib] -     FN=1150, TP=302
[2025-11-19 08:22:03,697] [INFO] [<frozen importlib] - Trial 0: AUPRC=0.1760, F1=0.4535, Prec=0.4552, Rec=0.4518 | Optimizing auprc=0.1760
[2025-11-19 08:22:03,697] [INFO] [<frozen importlib] -   → New best model found! (value=0.1760)
                                         0%|          | 0/500 [00:01<?, ?it/s]Best trial: 0. Best value: 0.176043:   0%|          | 0/500 [00:01<?, ?it/s]Best trial: 0. Best value: 0.176043:   0%|          | 1/500 [00:01<13:52,  1.67s/it][2025-11-19 08:22:03,699] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.495427649405375
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   gamma: 0.18182496720710062
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   alpha: 1.0495128632644757
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   lambda: 2.1597250932105787
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   learning_rate: 0.042484433685853404
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   subsample: 0.645614570099021
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   colsample_bytree: 0.8059264473611898
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   colsample_bylevel: 0.569746930326021
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   colsample_bynode: 0.6460723242676091
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:03,699] [INFO] [<frozen importlib] -   scale_pos_weight: 10.495427649405375
[2025-11-19 08:22:03,738] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:22:03,698] Trial 0 finished with value: 0.17604278019188965 and parameters: {'max_depth': 4, 'min_child_weight': 10, 'gamma': 0.7319939418114051, 'learning_rate': 0.09340308327072934, 'n_estimators': 150, 'alpha': 0.3119890406724053, 'lambda': 0.2904180608409973, 'subsample': 0.9330880728874675, 'colsample_bytree': 0.8005575058716043, 'colsample_bylevel': 0.8540362888980227, 'colsample_bynode': 0.5102922471479012, 'scale_pos_weight': 19.548647782429917}. Best is trial 0 with value: 0.17604278019188965.
[0]	train-logloss:0.86668	train-auc:0.66252	train-aucpr:0.25082	val-logloss:0.87882	val-auc:0.62604	val-aucpr:0.13408
[10]	train-logloss:0.82466	train-auc:0.69815	train-aucpr:0.30783	val-logloss:0.77704	val-auc:0.68596	val-aucpr:0.20822
[20]	train-logloss:0.80015	train-auc:0.70969	train-aucpr:0.31899	val-logloss:0.71535	val-auc:0.68608	val-aucpr:0.19957
[30]	train-logloss:0.78456	train-auc:0.71724	train-aucpr:0.32812	val-logloss:0.69617	val-auc:0.69112	val-aucpr:0.20282
[34]	train-logloss:0.78009	train-auc:0.71969	train-aucpr:0.33086	val-logloss:0.68696	val-auc:0.69133	val-aucpr:0.20276
[2025-11-19 08:22:03,884] [INFO] [<frozen importlib] - Training completed at iteration 5
[2025-11-19 08:22:03,884] [INFO] [<frozen importlib] - Best train loss: 0.8428
[2025-11-19 08:22:03,884] [INFO] [<frozen importlib] - Best val loss: 0.8202
[2025-11-19 08:22:03,884] [INFO] [<frozen importlib] - Best val AUC: 0.6869
[2025-11-19 08:22:03,884] [INFO] [<frozen importlib] - Best val AUCPR: 0.2139
[2025-11-19 08:22:03,888] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:22:05,370] [INFO] [<frozen importlib] - Optimal threshold: 0.6021
[2025-11-19 08:22:05,370] [INFO] [<frozen importlib] - Best f1: 0.2552
[2025-11-19 08:22:05,370] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:22:05,413] [INFO] [<frozen importlib] - Validation Results (threshold=0.6021):
[2025-11-19 08:22:05,414] [INFO] [<frozen importlib] -   Accuracy: 0.8928
[2025-11-19 08:22:05,414] [INFO] [<frozen importlib] -   Precision: 0.2739
[2025-11-19 08:22:05,414] [INFO] [<frozen importlib] -   Recall: 0.2390
[2025-11-19 08:22:05,414] [INFO] [<frozen importlib] -   F1 Score: 0.2552
[2025-11-19 08:22:05,414] [INFO] [<frozen importlib] -   AUROC: 0.6869
[2025-11-19 08:22:05,414] [INFO] [<frozen importlib] -   AUPRC: 0.2059
[2025-11-19 08:22:05,414] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:22:05,414] [INFO] [<frozen importlib] -     TN=16525, FP=920
[2025-11-19 08:22:05,414] [INFO] [<frozen importlib] -     FN=1105, TP=347
[2025-11-19 08:22:05,438] [INFO] [<frozen importlib] - Trial 1: AUPRC=0.2059, F1=0.4602, Prec=0.4352, Rec=0.4883 | Optimizing auprc=0.2059
[2025-11-19 08:22:05,439] [INFO] [<frozen importlib] -   → New best model found! (value=0.2059)
                                                                                    Best trial: 0. Best value: 0.176043:   0%|          | 1/500 [00:03<13:52,  1.67s/it]Best trial: 1. Best value: 0.205939:   0%|          | 1/500 [00:03<13:52,  1.67s/it]Best trial: 1. Best value: 0.205939:   0%|          | 2/500 [00:03<14:12,  1.71s/it][2025-11-19 08:22:05,440] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 17.125960221746915
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] -   gamma: 0.19967378215835974
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] -   alpha: 0.09290082543999545
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] -   lambda: 3.0377242595071916
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] -   learning_rate: 0.07957992095277988
[2025-11-19 08:22:05,440] [INFO] [<frozen importlib] -   subsample: 0.5852620618436457
[2025-11-19 08:22:05,441] [INFO] [<frozen importlib] -   colsample_bytree: 0.5325257964926398
[2025-11-19 08:22:05,441] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9744427686266666
[2025-11-19 08:22:05,441] [INFO] [<frozen importlib] -   colsample_bynode: 0.9828160165372797
[2025-11-19 08:22:05,441] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:05,441] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:05,441] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:05,441] [INFO] [<frozen importlib] -   scale_pos_weight: 17.125960221746915
[2025-11-19 08:22:05,482] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:22:05,439] Trial 1 finished with value: 0.20593858523948866 and parameters: {'max_depth': 5, 'min_child_weight': 3, 'gamma': 0.18182496720710062, 'learning_rate': 0.042484433685853404, 'n_estimators': 200, 'alpha': 1.0495128632644757, 'lambda': 2.1597250932105787, 'subsample': 0.645614570099021, 'colsample_bytree': 0.8059264473611898, 'colsample_bylevel': 0.569746930326021, 'colsample_bynode': 0.6460723242676091, 'scale_pos_weight': 10.495427649405375}. Best is trial 1 with value: 0.20593858523948866.
[0]	train-logloss:1.08931	train-auc:0.65261	train-aucpr:0.23605	val-logloss:1.11191	val-auc:0.60428	val-aucpr:0.10374
[10]	train-logloss:1.03302	train-auc:0.68835	train-aucpr:0.29088	val-logloss:0.93150	val-auc:0.69043	val-aucpr:0.20139
[20]	train-logloss:1.01167	train-auc:0.70205	train-aucpr:0.30365	val-logloss:0.88569	val-auc:0.68977	val-aucpr:0.19112
[30]	train-logloss:0.99813	train-auc:0.71095	train-aucpr:0.31463	val-logloss:0.84224	val-auc:0.69030	val-aucpr:0.18289
[40]	train-logloss:0.98949	train-auc:0.71902	train-aucpr:0.32303	val-logloss:0.78397	val-auc:0.68631	val-aucpr:0.17750
[2025-11-19 08:22:05,609] [INFO] [<frozen importlib] - Training completed at iteration 11
[2025-11-19 08:22:05,609] [INFO] [<frozen importlib] - Best train loss: 1.0306
[2025-11-19 08:22:05,609] [INFO] [<frozen importlib] - Best val loss: 0.9265
[2025-11-19 08:22:05,609] [INFO] [<frozen importlib] - Best val AUC: 0.6894
[2025-11-19 08:22:05,609] [INFO] [<frozen importlib] - Best val AUCPR: 0.2057
[2025-11-19 08:22:05,614] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:22:07,427] [INFO] [<frozen importlib] - Optimal threshold: 0.7040
[2025-11-19 08:22:07,427] [INFO] [<frozen importlib] - Best f1: 0.2595
[2025-11-19 08:22:07,427] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:22:07,446] [INFO] [<frozen importlib] - Validation Results (threshold=0.7040):
[2025-11-19 08:22:07,446] [INFO] [<frozen importlib] -   Accuracy: 0.8837
[2025-11-19 08:22:07,446] [INFO] [<frozen importlib] -   Precision: 0.2541
[2025-11-19 08:22:07,447] [INFO] [<frozen importlib] -   Recall: 0.2652
[2025-11-19 08:22:07,447] [INFO] [<frozen importlib] -   F1 Score: 0.2595
[2025-11-19 08:22:07,447] [INFO] [<frozen importlib] -   AUROC: 0.6894
[2025-11-19 08:22:07,447] [INFO] [<frozen importlib] -   AUPRC: 0.2027
[2025-11-19 08:22:07,447] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:22:07,447] [INFO] [<frozen importlib] -     TN=16315, FP=1130
[2025-11-19 08:22:07,447] [INFO] [<frozen importlib] -     FN=1067, TP=385
[2025-11-19 08:22:07,471] [INFO] [<frozen importlib] - Trial 2: AUPRC=0.2027, F1=0.4342, Prec=0.3879, Rec=0.4931 | Optimizing auprc=0.2027
                                                                                    Best trial: 1. Best value: 0.205939:   0%|          | 2/500 [00:05<14:12,  1.71s/it]Best trial: 1. Best value: 0.205939:   0%|          | 2/500 [00:05<14:12,  1.71s/it]Best trial: 1. Best value: 0.205939:   1%|          | 3/500 [00:05<15:23,  1.86s/it][2025-11-19 08:22:07,473] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 12.801020317667163
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   gamma: 0.6842330265121569
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   alpha: 0.9903538202225404
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   lambda: 0.17194260557609198
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   learning_rate: 0.06914594902276397
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   subsample: 0.954660201039391
[2025-11-19 08:22:07,473] [INFO] [<frozen importlib] -   colsample_bytree: 0.6293899908000085
[2025-11-19 08:22:07,474] [INFO] [<frozen importlib] -   colsample_bylevel: 0.831261142176991
[2025-11-19 08:22:07,474] [INFO] [<frozen importlib] -   colsample_bynode: 0.6558555380447055
[2025-11-19 08:22:07,474] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:07,474] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:07,474] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:07,474] [INFO] [<frozen importlib] -   scale_pos_weight: 12.801020317667163
[2025-11-19 08:22:07,520] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:22:07,472] Trial 2 finished with value: 0.20272484701782137 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.19967378215835974, 'learning_rate': 0.07957992095277988, 'n_estimators': 350, 'alpha': 0.09290082543999545, 'lambda': 3.0377242595071916, 'subsample': 0.5852620618436457, 'colsample_bytree': 0.5325257964926398, 'colsample_bylevel': 0.9744427686266666, 'colsample_bynode': 0.9828160165372797, 'scale_pos_weight': 17.125960221746915}. Best is trial 1 with value: 0.20593858523948866.
[0]	train-logloss:0.95959	train-auc:0.61506	train-aucpr:0.18940	val-logloss:0.98728	val-auc:0.61578	val-aucpr:0.12322
[10]	train-logloss:0.91441	train-auc:0.66911	train-aucpr:0.26534	val-logloss:0.85226	val-auc:0.64395	val-aucpr:0.14020
[20]	train-logloss:0.89623	train-auc:0.67950	train-aucpr:0.28264	val-logloss:0.78464	val-auc:0.66356	val-aucpr:0.19928
[30]	train-logloss:0.88561	train-auc:0.68386	train-aucpr:0.28706	val-logloss:0.73300	val-auc:0.69486	val-aucpr:0.22275
[40]	train-logloss:0.87871	train-auc:0.68969	train-aucpr:0.29285	val-logloss:0.72129	val-auc:0.68595	val-aucpr:0.22143
[50]	train-logloss:0.87229	train-auc:0.69631	train-aucpr:0.29981	val-logloss:0.70325	val-auc:0.68837	val-aucpr:0.20782
[57]	train-logloss:0.86913	train-auc:0.69911	train-aucpr:0.30352	val-logloss:0.72291	val-auc:0.65965	val-aucpr:0.16056
[2025-11-19 08:22:07,670] [INFO] [<frozen importlib] - Training completed at iteration 28
[2025-11-19 08:22:07,670] [INFO] [<frozen importlib] - Best train loss: 0.8876
[2025-11-19 08:22:07,670] [INFO] [<frozen importlib] - Best val loss: 0.7378
[2025-11-19 08:22:07,670] [INFO] [<frozen importlib] - Best val AUC: 0.6971
[2025-11-19 08:22:07,670] [INFO] [<frozen importlib] - Best val AUCPR: 0.2253
[2025-11-19 08:22:07,674] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:22:10,722] [INFO] [<frozen importlib] - Optimal threshold: 0.6302
[2025-11-19 08:22:10,723] [INFO] [<frozen importlib] - Best f1: 0.2691
[2025-11-19 08:22:10,723] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:22:10,745] [INFO] [<frozen importlib] - Validation Results (threshold=0.6302):
[2025-11-19 08:22:10,746] [INFO] [<frozen importlib] -   Accuracy: 0.8974
[2025-11-19 08:22:10,746] [INFO] [<frozen importlib] -   Precision: 0.2973
[2025-11-19 08:22:10,746] [INFO] [<frozen importlib] -   Recall: 0.2459
[2025-11-19 08:22:10,746] [INFO] [<frozen importlib] -   F1 Score: 0.2691
[2025-11-19 08:22:10,746] [INFO] [<frozen importlib] -   AUROC: 0.6971
[2025-11-19 08:22:10,746] [INFO] [<frozen importlib] -   AUPRC: 0.2236
[2025-11-19 08:22:10,746] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:22:10,746] [INFO] [<frozen importlib] -     TN=16601, FP=844
[2025-11-19 08:22:10,746] [INFO] [<frozen importlib] -     FN=1095, TP=357
[2025-11-19 08:22:10,769] [INFO] [<frozen importlib] - Trial 3: AUPRC=0.2236, F1=0.4263, Prec=0.4243, Rec=0.4284 | Optimizing auprc=0.2236
[2025-11-19 08:22:10,769] [INFO] [<frozen importlib] -   → New best model found! (value=0.2236)
                                                                                    Best trial: 1. Best value: 0.205939:   1%|          | 3/500 [00:08<15:23,  1.86s/it]Best trial: 3. Best value: 0.22359:   1%|          | 3/500 [00:08<15:23,  1.86s/it] Best trial: 3. Best value: 0.22359:   1%|          | 4/500 [00:08<20:03,  2.43s/it][2025-11-19 08:22:10,770] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.879954961448966
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   gamma: 0.9695846277645586
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   alpha: 1.7896547008552977
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   lambda: 2.9894998940554256
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   learning_rate: 0.13054491604548749
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   subsample: 0.9609371175115584
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   colsample_bytree: 0.5442462510259598
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5979914312095727
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   colsample_bynode: 0.522613644455269
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:10,770] [INFO] [<frozen importlib] -   scale_pos_weight: 9.879954961448966
[2025-11-19 08:22:10,844] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:22:10,769] Trial 3 finished with value: 0.22358963757877331 and parameters: {'max_depth': 3, 'min_child_weight': 1, 'gamma': 0.6842330265121569, 'learning_rate': 0.06914594902276397, 'n_estimators': 150, 'alpha': 0.9903538202225404, 'lambda': 0.17194260557609198, 'subsample': 0.954660201039391, 'colsample_bytree': 0.6293899908000085, 'colsample_bylevel': 0.831261142176991, 'colsample_bynode': 0.6558555380447055, 'scale_pos_weight': 12.801020317667163}. Best is trial 3 with value: 0.22358963757877331.
[0]	train-logloss:0.83212	train-auc:0.63930	train-aucpr:0.23481	val-logloss:0.83204	val-auc:0.63596	val-aucpr:0.16587
[10]	train-logloss:0.77301	train-auc:0.69120	train-aucpr:0.30016	val-logloss:0.65945	val-auc:0.68349	val-aucpr:0.19600
[20]	train-logloss:0.75324	train-auc:0.70876	train-aucpr:0.31457	val-logloss:0.62662	val-auc:0.68229	val-aucpr:0.20302
[30]	train-logloss:0.74237	train-auc:0.72069	train-aucpr:0.32953	val-logloss:0.59845	val-auc:0.67946	val-aucpr:0.20020
[40]	train-logloss:0.73493	train-auc:0.72871	train-aucpr:0.33863	val-logloss:0.57764	val-auc:0.68359	val-aucpr:0.20148
[45]	train-logloss:0.72971	train-auc:0.73427	train-aucpr:0.34535	val-logloss:0.51610	val-auc:0.66243	val-aucpr:0.15596
[2025-11-19 08:22:10,992] [INFO] [<frozen importlib] - Training completed at iteration 16
[2025-11-19 08:22:10,992] [INFO] [<frozen importlib] - Best train loss: 0.7608
[2025-11-19 08:22:10,992] [INFO] [<frozen importlib] - Best val loss: 0.6354
[2025-11-19 08:22:10,992] [INFO] [<frozen importlib] - Best val AUC: 0.6839
[2025-11-19 08:22:10,992] [INFO] [<frozen importlib] - Best val AUCPR: 0.2083
[2025-11-19 08:22:10,997] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:22:15,788] [INFO] [<frozen importlib] - Optimal threshold: 0.5780
[2025-11-19 08:22:15,788] [INFO] [<frozen importlib] - Best f1: 0.2603
[2025-11-19 08:22:15,788] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:22:15,833] [INFO] [<frozen importlib] - Validation Results (threshold=0.5780):
[2025-11-19 08:22:15,833] [INFO] [<frozen importlib] -   Accuracy: 0.8863
[2025-11-19 08:22:15,833] [INFO] [<frozen importlib] -   Precision: 0.2603
[2025-11-19 08:22:15,833] [INFO] [<frozen importlib] -   Recall: 0.2603
[2025-11-19 08:22:15,833] [INFO] [<frozen importlib] -   F1 Score: 0.2603
[2025-11-19 08:22:15,833] [INFO] [<frozen importlib] -   AUROC: 0.6839
[2025-11-19 08:22:15,833] [INFO] [<frozen importlib] -   AUPRC: 0.2083
[2025-11-19 08:22:15,833] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:22:15,833] [INFO] [<frozen importlib] -     TN=16371, FP=1074
[2025-11-19 08:22:15,833] [INFO] [<frozen importlib] -     FN=1074, TP=378
[2025-11-19 08:22:15,858] [INFO] [<frozen importlib] - Trial 4: AUPRC=0.2083, F1=0.4393, Prec=0.3983, Rec=0.4897 | Optimizing auprc=0.2083
                                                                                   Best trial: 3. Best value: 0.22359:   1%|          | 4/500 [00:13<20:03,  2.43s/it]Best trial: 3. Best value: 0.22359:   1%|          | 4/500 [00:13<20:03,  2.43s/it]Best trial: 3. Best value: 0.22359:   1%|          | 5/500 [00:13<27:56,  3.39s/it][2025-11-19 08:22:15,859] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.980735223012586
[2025-11-19 08:22:15,859] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   gamma: 0.8287375091519293
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   alpha: 1.085392166316497
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   lambda: 0.7046211248738132
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   learning_rate: 0.05902737075341557
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   subsample: 0.9010984903770198
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   colsample_bytree: 0.5372753218398854
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9934434683002586
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   colsample_bynode: 0.8861223846483287
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:15,860] [INFO] [<frozen importlib] -   scale_pos_weight: 7.980735223012586
[2025-11-19 08:22:15,906] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:22:15,858] Trial 4 finished with value: 0.20832958353612097 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.9695846277645586, 'learning_rate': 0.13054491604548749, 'n_estimators': 500, 'alpha': 1.7896547008552977, 'lambda': 2.9894998940554256, 'subsample': 0.9609371175115584, 'colsample_bytree': 0.5442462510259598, 'colsample_bylevel': 0.5979914312095727, 'colsample_bynode': 0.522613644455269, 'scale_pos_weight': 9.879954961448966}. Best is trial 3 with value: 0.22358963757877331.
[0]	train-logloss:0.74749	train-auc:0.65527	train-aucpr:0.23860	val-logloss:0.74449	val-auc:0.64136	val-aucpr:0.13321
[10]	train-logloss:0.71012	train-auc:0.68547	train-aucpr:0.28966	val-logloss:0.63780	val-auc:0.68136	val-aucpr:0.19976
[20]	train-logloss:0.69110	train-auc:0.69746	train-aucpr:0.30520	val-logloss:0.59110	val-auc:0.69503	val-aucpr:0.20828
[30]	train-logloss:0.68009	train-auc:0.70167	train-aucpr:0.31370	val-logloss:0.56056	val-auc:0.69935	val-aucpr:0.22198
[40]	train-logloss:0.67341	train-auc:0.70592	train-aucpr:0.31937	val-logloss:0.55025	val-auc:0.69594	val-aucpr:0.22434
[50]	train-logloss:0.66677	train-auc:0.71386	train-aucpr:0.32684	val-logloss:0.51868	val-auc:0.69872	val-aucpr:0.21843
[60]	train-logloss:0.66267	train-auc:0.72047	train-aucpr:0.33175	val-logloss:0.49994	val-auc:0.69217	val-aucpr:0.20548
[70]	train-logloss:0.65819	train-auc:0.72648	train-aucpr:0.33823	val-logloss:0.46706	val-auc:0.68677	val-aucpr:0.19521
[72]	train-logloss:0.65730	train-auc:0.72811	train-aucpr:0.33990	val-logloss:0.46580	val-auc:0.68504	val-aucpr:0.19296
[2025-11-19 08:22:16,121] [INFO] [<frozen importlib] - Training completed at iteration 43
[2025-11-19 08:22:16,121] [INFO] [<frozen importlib] - Best train loss: 0.6717
[2025-11-19 08:22:16,121] [INFO] [<frozen importlib] - Best val loss: 0.5371
[2025-11-19 08:22:16,121] [INFO] [<frozen importlib] - Best val AUC: 0.7004
[2025-11-19 08:22:16,121] [INFO] [<frozen importlib] - Best val AUCPR: 0.2244
[2025-11-19 08:22:16,127] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:22:23,358] [INFO] [<frozen importlib] - Optimal threshold: 0.5232
[2025-11-19 08:22:23,358] [INFO] [<frozen importlib] - Best f1: 0.2732
[2025-11-19 08:22:23,358] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:22:23,389] [INFO] [<frozen importlib] - Validation Results (threshold=0.5232):
[2025-11-19 08:22:23,389] [INFO] [<frozen importlib] -   Accuracy: 0.8995
[2025-11-19 08:22:23,389] [INFO] [<frozen importlib] -   Precision: 0.3075
[2025-11-19 08:22:23,389] [INFO] [<frozen importlib] -   Recall: 0.2459
[2025-11-19 08:22:23,389] [INFO] [<frozen importlib] -   F1 Score: 0.2732
[2025-11-19 08:22:23,389] [INFO] [<frozen importlib] -   AUROC: 0.7004
[2025-11-19 08:22:23,389] [INFO] [<frozen importlib] -   AUPRC: 0.2247
[2025-11-19 08:22:23,390] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:22:23,390] [INFO] [<frozen importlib] -     TN=16641, FP=804
[2025-11-19 08:22:23,390] [INFO] [<frozen importlib] -     FN=1095, TP=357
[2025-11-19 08:22:23,411] [INFO] [<frozen importlib] - Trial 5: AUPRC=0.2247, F1=0.4484, Prec=0.4478, Rec=0.4490 | Optimizing auprc=0.2247
[2025-11-19 08:22:23,411] [INFO] [<frozen importlib] -   → New best model found! (value=0.2247)
                                                                                   Best trial: 3. Best value: 0.22359:   1%|          | 5/500 [00:21<27:56,  3.39s/it]Best trial: 5. Best value: 0.224668:   1%|          | 5/500 [00:21<27:56,  3.39s/it]Best trial: 5. Best value: 0.224668:   1%|          | 6/500 [00:21<39:32,  4.80s/it][2025-11-19 08:22:23,412] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.953375254290354
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   gamma: 0.7068573438476171
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   alpha: 0.14808930346818072
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   lambda: 1.7923286427213632
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   learning_rate: 0.11960700969365366
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   subsample: 0.5579345297625649
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   colsample_bytree: 0.9315517129377968
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   colsample_bylevel: 0.811649063413779
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   colsample_bynode: 0.6654490124263246
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:23,412] [INFO] [<frozen importlib] -   scale_pos_weight: 5.953375254290354
[2025-11-19 08:22:23,454] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:22:23,411] Trial 5 finished with value: 0.22466795710784165 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.8287375091519293, 'learning_rate': 0.05902737075341557, 'n_estimators': 200, 'alpha': 1.085392166316497, 'lambda': 0.7046211248738132, 'subsample': 0.9010984903770198, 'colsample_bytree': 0.5372753218398854, 'colsample_bylevel': 0.9934434683002586, 'colsample_bynode': 0.8861223846483287, 'scale_pos_weight': 7.980735223012586}. Best is trial 5 with value: 0.22466795710784165.
[0]	train-logloss:0.63574	train-auc:0.64044	train-aucpr:0.21169	val-logloss:0.61406	val-auc:0.60235	val-aucpr:0.10356
[10]	train-logloss:0.59919	train-auc:0.67304	train-aucpr:0.27512	val-logloss:0.51962	val-auc:0.64852	val-aucpr:0.16602
[20]	train-logloss:0.58712	train-auc:0.68866	train-aucpr:0.28913	val-logloss:0.50443	val-auc:0.65091	val-aucpr:0.17349
[30]	train-logloss:0.58047	train-auc:0.69769	train-aucpr:0.30087	val-logloss:0.43895	val-auc:0.66934	val-aucpr:0.20039
[40]	train-logloss:0.57561	train-auc:0.70713	train-aucpr:0.31155	val-logloss:0.42891	val-auc:0.66888	val-aucpr:0.19764
[50]	train-logloss:0.57130	train-auc:0.71322	train-aucpr:0.31894	val-logloss:0.40489	val-auc:0.67532	val-aucpr:0.19992
[60]	train-logloss:0.56735	train-auc:0.72011	train-aucpr:0.32560	val-logloss:0.40048	val-auc:0.67911	val-aucpr:0.19494
[65]	train-logloss:0.56544	train-auc:0.72499	train-aucpr:0.33002	val-logloss:0.39292	val-auc:0.68548	val-aucpr:0.19477
[2025-11-19 08:22:23,610] [INFO] [<frozen importlib] - Training completed at iteration 35
[2025-11-19 08:22:23,611] [INFO] [<frozen importlib] - Best train loss: 0.5774
[2025-11-19 08:22:23,611] [INFO] [<frozen importlib] - Best val loss: 0.4316
[2025-11-19 08:22:23,611] [INFO] [<frozen importlib] - Best val AUC: 0.6753
[2025-11-19 08:22:23,611] [INFO] [<frozen importlib] - Best val AUCPR: 0.2044
[2025-11-19 08:22:23,616] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:22:29,452] [INFO] [<frozen importlib] - Optimal threshold: 0.4444
[2025-11-19 08:22:29,452] [INFO] [<frozen importlib] - Best f1: 0.2449
[2025-11-19 08:22:29,452] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:22:29,498] [INFO] [<frozen importlib] - Validation Results (threshold=0.4444):
[2025-11-19 08:22:29,498] [INFO] [<frozen importlib] -   Accuracy: 0.9106
[2025-11-19 08:22:29,498] [INFO] [<frozen importlib] -   Precision: 0.3486
[2025-11-19 08:22:29,498] [INFO] [<frozen importlib] -   Recall: 0.1887
[2025-11-19 08:22:29,498] [INFO] [<frozen importlib] -   F1 Score: 0.2449
[2025-11-19 08:22:29,498] [INFO] [<frozen importlib] -   AUROC: 0.6753
[2025-11-19 08:22:29,498] [INFO] [<frozen importlib] -   AUPRC: 0.2050
[2025-11-19 08:22:29,498] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:22:29,498] [INFO] [<frozen importlib] -     TN=16933, FP=512
[2025-11-19 08:22:29,498] [INFO] [<frozen importlib] -     FN=1178, TP=274
[2025-11-19 08:22:29,521] [INFO] [<frozen importlib] - Trial 6: AUPRC=0.2050, F1=0.4344, Prec=0.5156, Rec=0.3753 | Optimizing auprc=0.2050
                                                                                    Best trial: 5. Best value: 0.224668:   1%|          | 6/500 [00:27<39:32,  4.80s/it]Best trial: 5. Best value: 0.224668:   1%|          | 6/500 [00:27<39:32,  4.80s/it]Best trial: 5. Best value: 0.224668:   1%|▏         | 7/500 [00:27<42:58,  5.23s/it][2025-11-19 08:22:29,522] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 12.40693394546586
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   gamma: 0.7296061783380641
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   alpha: 0.9444298503238986
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   lambda: 0.5979712296915085
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   learning_rate: 0.10055656470799232
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   subsample: 0.8566223936114975
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   colsample_bytree: 0.8803925243084487
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7806385987847482
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   colsample_bynode: 0.8854835899772805
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:29,522] [INFO] [<frozen importlib] -   scale_pos_weight: 12.40693394546586
[2025-11-19 08:22:29,588] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:22:29,521] Trial 6 finished with value: 0.20497370888975894 and parameters: {'max_depth': 3, 'min_child_weight': 9, 'gamma': 0.7068573438476171, 'learning_rate': 0.11960700969365366, 'n_estimators': 400, 'alpha': 0.14808930346818072, 'lambda': 1.7923286427213632, 'subsample': 0.5579345297625649, 'colsample_bytree': 0.9315517129377968, 'colsample_bylevel': 0.811649063413779, 'colsample_bynode': 0.6654490124263246, 'scale_pos_weight': 5.953375254290354}. Best is trial 5 with value: 0.22466795710784165.
[0]	train-logloss:0.93825	train-auc:0.63825	train-aucpr:0.20525	val-logloss:0.94782	val-auc:0.57553	val-aucpr:0.09030
[10]	train-logloss:0.88804	train-auc:0.67399	train-aucpr:0.27107	val-logloss:0.77994	val-auc:0.65299	val-aucpr:0.17231
[20]	train-logloss:0.86904	train-auc:0.68975	train-aucpr:0.28076	val-logloss:0.75085	val-auc:0.67319	val-aucpr:0.19579
[30]	train-logloss:0.85825	train-auc:0.69632	train-aucpr:0.29589	val-logloss:0.72657	val-auc:0.68726	val-aucpr:0.20901
[40]	train-logloss:0.85126	train-auc:0.70293	train-aucpr:0.30510	val-logloss:0.69610	val-auc:0.69015	val-aucpr:0.20110
[50]	train-logloss:0.84456	train-auc:0.70898	train-aucpr:0.31282	val-logloss:0.68875	val-auc:0.69379	val-aucpr:0.19842
[60]	train-logloss:0.83869	train-auc:0.71600	train-aucpr:0.32045	val-logloss:0.66858	val-auc:0.68699	val-aucpr:0.19088
[63]	train-logloss:0.83753	train-auc:0.71729	train-aucpr:0.32227	val-logloss:0.67264	val-auc:0.68308	val-aucpr:0.18535
[2025-11-19 08:22:29,747] [INFO] [<frozen importlib] - Training completed at iteration 33
[2025-11-19 08:22:29,747] [INFO] [<frozen importlib] - Best train loss: 0.8560
[2025-11-19 08:22:29,747] [INFO] [<frozen importlib] - Best val loss: 0.7200
[2025-11-19 08:22:29,747] [INFO] [<frozen importlib] - Best val AUC: 0.6968
[2025-11-19 08:22:29,747] [INFO] [<frozen importlib] - Best val AUCPR: 0.2134
[2025-11-19 08:22:29,751] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:22:35,107] [INFO] [<frozen importlib] - Optimal threshold: 0.6438
[2025-11-19 08:22:35,107] [INFO] [<frozen importlib] - Best f1: 0.2621
[2025-11-19 08:22:35,107] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:22:35,130] [INFO] [<frozen importlib] - Validation Results (threshold=0.6438):
[2025-11-19 08:22:35,130] [INFO] [<frozen importlib] -   Accuracy: 0.8966
[2025-11-19 08:22:35,130] [INFO] [<frozen importlib] -   Precision: 0.2901
[2025-11-19 08:22:35,130] [INFO] [<frozen importlib] -   Recall: 0.2390
[2025-11-19 08:22:35,130] [INFO] [<frozen importlib] -   F1 Score: 0.2621
[2025-11-19 08:22:35,130] [INFO] [<frozen importlib] -   AUROC: 0.6968
[2025-11-19 08:22:35,130] [INFO] [<frozen importlib] -   AUPRC: 0.2135
[2025-11-19 08:22:35,130] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:22:35,130] [INFO] [<frozen importlib] -     TN=16596, FP=849
[2025-11-19 08:22:35,130] [INFO] [<frozen importlib] -     FN=1105, TP=347
[2025-11-19 08:22:35,152] [INFO] [<frozen importlib] - Trial 7: AUPRC=0.2135, F1=0.4489, Prec=0.4396, Rec=0.4587 | Optimizing auprc=0.2135
                                                                                    Best trial: 5. Best value: 0.224668:   1%|▏         | 7/500 [00:33<42:58,  5.23s/it]Best trial: 5. Best value: 0.224668:   1%|▏         | 7/500 [00:33<42:58,  5.23s/it]Best trial: 5. Best value: 0.224668:   2%|▏         | 8/500 [00:33<43:56,  5.36s/it][2025-11-19 08:22:35,153] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 16.33326707814573
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   gamma: 0.02541912674409519
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   alpha: 1.2728208225275608
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   lambda: 1.5717799053816335
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   learning_rate: 0.036814079385739204
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   subsample: 0.7542853455823514
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   colsample_bytree: 0.9537832369630466
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6246461145744375
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   colsample_bynode: 0.7051914615178149
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:35,153] [INFO] [<frozen importlib] -   scale_pos_weight: 16.33326707814573
[2025-11-19 08:22:35,230] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:22:35,152] Trial 7 finished with value: 0.21352963577124917 and parameters: {'max_depth': 3, 'min_child_weight': 4, 'gamma': 0.7296061783380641, 'learning_rate': 0.10055656470799232, 'n_estimators': 450, 'alpha': 0.9444298503238986, 'lambda': 0.5979712296915085, 'subsample': 0.8566223936114975, 'colsample_bytree': 0.8803925243084487, 'colsample_bylevel': 0.7806385987847482, 'colsample_bynode': 0.8854835899772805, 'scale_pos_weight': 12.40693394546586}. Best is trial 5 with value: 0.22466795710784165.
[0]	train-logloss:1.07449	train-auc:0.65095	train-aucpr:0.22495	val-logloss:1.10161	val-auc:0.65366	val-aucpr:0.12826
[10]	train-logloss:1.03647	train-auc:0.68000	train-aucpr:0.27933	val-logloss:0.99545	val-auc:0.68082	val-aucpr:0.18342
[20]	train-logloss:1.01728	train-auc:0.68968	train-aucpr:0.29121	val-logloss:0.92735	val-auc:0.68914	val-aucpr:0.20072
[30]	train-logloss:1.00387	train-auc:0.69710	train-aucpr:0.30257	val-logloss:0.86429	val-auc:0.69334	val-aucpr:0.20251
[40]	train-logloss:0.99417	train-auc:0.70233	train-aucpr:0.30843	val-logloss:0.83831	val-auc:0.69675	val-aucpr:0.20388
[50]	train-logloss:0.98727	train-auc:0.70411	train-aucpr:0.31127	val-logloss:0.81087	val-auc:0.69971	val-aucpr:0.21599
[60]	train-logloss:0.98007	train-auc:0.70925	train-aucpr:0.31616	val-logloss:0.81058	val-auc:0.69228	val-aucpr:0.21325
[70]	train-logloss:0.97493	train-auc:0.71297	train-aucpr:0.31987	val-logloss:0.79620	val-auc:0.69620	val-aucpr:0.21237
[79]	train-logloss:0.97099	train-auc:0.71613	train-aucpr:0.32265	val-logloss:0.79075	val-auc:0.69226	val-aucpr:0.20637
[2025-11-19 08:22:35,456] [INFO] [<frozen importlib] - Training completed at iteration 50
[2025-11-19 08:22:35,456] [INFO] [<frozen importlib] - Best train loss: 0.9873
[2025-11-19 08:22:35,456] [INFO] [<frozen importlib] - Best val loss: 0.8109
[2025-11-19 08:22:35,456] [INFO] [<frozen importlib] - Best val AUC: 0.6997
[2025-11-19 08:22:35,456] [INFO] [<frozen importlib] - Best val AUCPR: 0.2160
[2025-11-19 08:22:35,459] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:22:45,975] [INFO] [<frozen importlib] - Optimal threshold: 0.6848
[2025-11-19 08:22:45,975] [INFO] [<frozen importlib] - Best f1: 0.2618
[2025-11-19 08:22:45,975] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:22:46,017] [INFO] [<frozen importlib] - Validation Results (threshold=0.6848):
[2025-11-19 08:22:46,017] [INFO] [<frozen importlib] -   Accuracy: 0.8997
[2025-11-19 08:22:46,017] [INFO] [<frozen importlib] -   Precision: 0.3013
[2025-11-19 08:22:46,017] [INFO] [<frozen importlib] -   Recall: 0.2314
[2025-11-19 08:22:46,017] [INFO] [<frozen importlib] -   F1 Score: 0.2618
[2025-11-19 08:22:46,017] [INFO] [<frozen importlib] -   AUROC: 0.6997
[2025-11-19 08:22:46,017] [INFO] [<frozen importlib] -   AUPRC: 0.2165
[2025-11-19 08:22:46,017] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:22:46,017] [INFO] [<frozen importlib] -     TN=16666, FP=779
[2025-11-19 08:22:46,017] [INFO] [<frozen importlib] -     FN=1116, TP=336
[2025-11-19 08:22:46,048] [INFO] [<frozen importlib] - Trial 8: AUPRC=0.2165, F1=0.4458, Prec=0.4510, Rec=0.4408 | Optimizing auprc=0.2165
                                                                                    Best trial: 5. Best value: 0.224668:   2%|▏         | 8/500 [00:44<43:56,  5.36s/it]Best trial: 5. Best value: 0.224668:   2%|▏         | 8/500 [00:44<43:56,  5.36s/it]Best trial: 5. Best value: 0.224668:   2%|▏         | 9/500 [00:44<58:00,  7.09s/it][2025-11-19 08:22:46,050] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 13.09013362873476
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   gamma: 0.289751452913768
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   alpha: 1.616240759128834
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   lambda: 3.1670187825521174
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   learning_rate: 0.04073360826924564
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   subsample: 0.9357302950938589
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   colsample_bytree: 0.9018360384495572
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5932850294430179
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   colsample_bynode: 0.9462794992449889
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:46,050] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:46,051] [INFO] [<frozen importlib] -   scale_pos_weight: 13.09013362873476
[2025-11-19 08:22:46,142] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:22:46,048] Trial 8 finished with value: 0.21652564984906472 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.02541912674409519, 'learning_rate': 0.036814079385739204, 'n_estimators': 100, 'alpha': 1.2728208225275608, 'lambda': 1.5717799053816335, 'subsample': 0.7542853455823514, 'colsample_bytree': 0.9537832369630466, 'colsample_bylevel': 0.6246461145744375, 'colsample_bynode': 0.7051914615178149, 'scale_pos_weight': 16.33326707814573}. Best is trial 5 with value: 0.22466795710784165.
[0]	train-logloss:0.97055	train-auc:0.63735	train-aucpr:0.20631	val-logloss:0.99620	val-auc:0.55961	val-aucpr:0.08661
[10]	train-logloss:0.93835	train-auc:0.65766	train-aucpr:0.25062	val-logloss:0.89817	val-auc:0.61997	val-aucpr:0.10716
[20]	train-logloss:0.92140	train-auc:0.66833	train-aucpr:0.27059	val-logloss:0.84787	val-auc:0.63208	val-aucpr:0.12932
[30]	train-logloss:0.90992	train-auc:0.67838	train-aucpr:0.28059	val-logloss:0.79750	val-auc:0.65044	val-aucpr:0.18090
[40]	train-logloss:0.90236	train-auc:0.68332	train-aucpr:0.28274	val-logloss:0.77051	val-auc:0.66149	val-aucpr:0.19006
[50]	train-logloss:0.89542	train-auc:0.68759	train-aucpr:0.28564	val-logloss:0.75253	val-auc:0.68796	val-aucpr:0.20390
[60]	train-logloss:0.89036	train-auc:0.69072	train-aucpr:0.29215	val-logloss:0.73844	val-auc:0.69996	val-aucpr:0.21071
[70]	train-logloss:0.88577	train-auc:0.69546	train-aucpr:0.29671	val-logloss:0.74413	val-auc:0.69215	val-aucpr:0.20599
[80]	train-logloss:0.88248	train-auc:0.69795	train-aucpr:0.29937	val-logloss:0.72159	val-auc:0.69459	val-aucpr:0.20914
[89]	train-logloss:0.87876	train-auc:0.70188	train-aucpr:0.30364	val-logloss:0.71005	val-auc:0.69480	val-aucpr:0.21050
[2025-11-19 08:22:46,379] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:22:46,379] [INFO] [<frozen importlib] - Best train loss: 0.8904
[2025-11-19 08:22:46,379] [INFO] [<frozen importlib] - Best val loss: 0.7384
[2025-11-19 08:22:46,379] [INFO] [<frozen importlib] - Best val AUC: 0.7000
[2025-11-19 08:22:46,379] [INFO] [<frozen importlib] - Best val AUCPR: 0.2107
[2025-11-19 08:22:46,382] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:22:50,827] [INFO] [<frozen importlib] - Optimal threshold: 0.6527
[2025-11-19 08:22:50,828] [INFO] [<frozen importlib] - Best f1: 0.2714
[2025-11-19 08:22:50,828] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:22:50,874] [INFO] [<frozen importlib] - Validation Results (threshold=0.6527):
[2025-11-19 08:22:50,874] [INFO] [<frozen importlib] -   Accuracy: 0.9068
[2025-11-19 08:22:50,874] [INFO] [<frozen importlib] -   Precision: 0.3399
[2025-11-19 08:22:50,874] [INFO] [<frozen importlib] -   Recall: 0.2259
[2025-11-19 08:22:50,874] [INFO] [<frozen importlib] -   F1 Score: 0.2714
[2025-11-19 08:22:50,874] [INFO] [<frozen importlib] -   AUROC: 0.7000
[2025-11-19 08:22:50,875] [INFO] [<frozen importlib] -   AUPRC: 0.2107
[2025-11-19 08:22:50,875] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:22:50,875] [INFO] [<frozen importlib] -     TN=16808, FP=637
[2025-11-19 08:22:50,875] [INFO] [<frozen importlib] -     FN=1124, TP=328
[2025-11-19 08:22:50,904] [INFO] [<frozen importlib] - Trial 9: AUPRC=0.2107, F1=0.4486, Prec=0.4867, Rec=0.4160 | Optimizing auprc=0.2107
                                                                                    Best trial: 5. Best value: 0.224668:   2%|▏         | 9/500 [00:48<58:00,  7.09s/it]Best trial: 5. Best value: 0.224668:   2%|▏         | 9/500 [00:48<58:00,  7.09s/it]Best trial: 5. Best value: 0.224668:   2%|▏         | 10/500 [00:48<52:15,  6.40s/it][2025-11-19 08:22:50,910] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.1545690697771205
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   gamma: 0.9695371107878658
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   alpha: 0.6011296460986921
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   lambda: 4.7988537297270994
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   learning_rate: 0.1758909183900227
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   subsample: 0.8060821870348815
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   colsample_bytree: 0.6673975881116181
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9961813327301685
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   colsample_bynode: 0.8391268998756262
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:50,911] [INFO] [<frozen importlib] -   scale_pos_weight: 5.1545690697771205
[2025-11-19 08:22:50,987] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:22:50,904] Trial 9 finished with value: 0.2107237538514905 and parameters: {'max_depth': 3, 'min_child_weight': 1, 'gamma': 0.289751452913768, 'learning_rate': 0.04073360826924564, 'n_estimators': 500, 'alpha': 1.616240759128834, 'lambda': 3.1670187825521174, 'subsample': 0.9357302950938589, 'colsample_bytree': 0.9018360384495572, 'colsample_bylevel': 0.5932850294430179, 'colsample_bynode': 0.9462794992449889, 'scale_pos_weight': 13.09013362873476}. Best is trial 5 with value: 0.22466795710784165.
[0]	train-logloss:0.58445	train-auc:0.67086	train-aucpr:0.25818	val-logloss:0.55082	val-auc:0.63499	val-aucpr:0.11331
[10]	train-logloss:0.53161	train-auc:0.71769	train-aucpr:0.33449	val-logloss:0.44659	val-auc:0.66983	val-aucpr:0.19120
[20]	train-logloss:0.51705	train-auc:0.74222	train-aucpr:0.35984	val-logloss:0.41620	val-auc:0.67089	val-aucpr:0.16914
[30]	train-logloss:0.50455	train-auc:0.76570	train-aucpr:0.38481	val-logloss:0.37931	val-auc:0.66182	val-aucpr:0.14816
[40]	train-logloss:0.49459	train-auc:0.78632	train-aucpr:0.40737	val-logloss:0.37484	val-auc:0.66057	val-aucpr:0.14684
[41]	train-logloss:0.49342	train-auc:0.78813	train-aucpr:0.40933	val-logloss:0.37365	val-auc:0.65967	val-aucpr:0.14427
[2025-11-19 08:22:51,165] [INFO] [<frozen importlib] - Training completed at iteration 11
[2025-11-19 08:22:51,165] [INFO] [<frozen importlib] - Best train loss: 0.5293
[2025-11-19 08:22:51,165] [INFO] [<frozen importlib] - Best val loss: 0.4383
[2025-11-19 08:22:51,165] [INFO] [<frozen importlib] - Best val AUC: 0.6724
[2025-11-19 08:22:51,165] [INFO] [<frozen importlib] - Best val AUCPR: 0.1945
[2025-11-19 08:22:51,167] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:22:54,622] [INFO] [<frozen importlib] - Optimal threshold: 0.4485
[2025-11-19 08:22:54,622] [INFO] [<frozen importlib] - Best f1: 0.2525
[2025-11-19 08:22:54,622] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:22:54,682] [INFO] [<frozen importlib] - Validation Results (threshold=0.4485):
[2025-11-19 08:22:54,682] [INFO] [<frozen importlib] -   Accuracy: 0.9088
[2025-11-19 08:22:54,682] [INFO] [<frozen importlib] -   Precision: 0.3411
[2025-11-19 08:22:54,682] [INFO] [<frozen importlib] -   Recall: 0.2004
[2025-11-19 08:22:54,683] [INFO] [<frozen importlib] -   F1 Score: 0.2525
[2025-11-19 08:22:54,683] [INFO] [<frozen importlib] -   AUROC: 0.6724
[2025-11-19 08:22:54,683] [INFO] [<frozen importlib] -   AUPRC: 0.1945
[2025-11-19 08:22:54,683] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:22:54,683] [INFO] [<frozen importlib] -     TN=16883, FP=562
[2025-11-19 08:22:54,683] [INFO] [<frozen importlib] -     FN=1161, TP=291
[2025-11-19 08:22:54,711] [INFO] [<frozen importlib] - Trial 10: AUPRC=0.1945, F1=0.4661, Prec=0.5213, Rec=0.4215 | Optimizing auprc=0.1945
[2025-11-19 08:22:54,712] [INFO] [<frozen importlib] - Trial 10 pruned.
[2025-11-19 08:22:54,712] [ERROR] [<frozen importlib] - Trial 10 failed with error: 
                                                                                     Best trial: 5. Best value: 0.224668:   2%|▏         | 10/500 [00:52<52:15,  6.40s/it]Best trial: 5. Best value: 0.224668:   2%|▏         | 10/500 [00:52<52:15,  6.40s/it]Best trial: 5. Best value: 0.224668:   2%|▏         | 11/500 [00:52<45:41,  5.61s/it][2025-11-19 08:22:54,724] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.804515439359391
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   gamma: 0.5307950442282506
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   alpha: 1.389447692488778
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   lambda: 0.022783097812625996
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   learning_rate: 0.0580942653807854
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   subsample: 0.8745991796909733
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   colsample_bytree: 0.6383586962140074
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8954178991106394
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   colsample_bynode: 0.8045369317168723
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:22:54,724] [INFO] [<frozen importlib] -   scale_pos_weight: 7.804515439359391
[2025-11-19 08:22:54,816] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:22:54] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:22:54,712] Trial 10 pruned. 
[0]	train-logloss:0.73992	train-auc:0.63088	train-aucpr:0.21316	val-logloss:0.74050	val-auc:0.55929	val-aucpr:0.08659
[10]	train-logloss:0.70908	train-auc:0.66452	train-aucpr:0.26953	val-logloss:0.66870	val-auc:0.63498	val-aucpr:0.15242
[20]	train-logloss:0.69313	train-auc:0.67857	train-aucpr:0.28396	val-logloss:0.61876	val-auc:0.65067	val-aucpr:0.19128
[30]	train-logloss:0.68369	train-auc:0.68622	train-aucpr:0.29249	val-logloss:0.59907	val-auc:0.66962	val-aucpr:0.20879
[40]	train-logloss:0.67716	train-auc:0.69201	train-aucpr:0.29706	val-logloss:0.58931	val-auc:0.68086	val-aucpr:0.21168
[50]	train-logloss:0.67244	train-auc:0.69520	train-aucpr:0.30172	val-logloss:0.58592	val-auc:0.69061	val-aucpr:0.21428
[60]	train-logloss:0.66849	train-auc:0.69888	train-aucpr:0.30853	val-logloss:0.57287	val-auc:0.69291	val-aucpr:0.21474
[70]	train-logloss:0.66502	train-auc:0.70397	train-aucpr:0.31256	val-logloss:0.54680	val-auc:0.67893	val-aucpr:0.20931
[80]	train-logloss:0.66230	train-auc:0.70784	train-aucpr:0.31651	val-logloss:0.53991	val-auc:0.67571	val-aucpr:0.19054
[90]	train-logloss:0.65979	train-auc:0.71116	train-aucpr:0.31983	val-logloss:0.52742	val-auc:0.66809	val-aucpr:0.17118
[2025-11-19 08:22:55,035] [INFO] [<frozen importlib] - Training completed at iteration 61
[2025-11-19 08:22:55,035] [INFO] [<frozen importlib] - Best train loss: 0.6680
[2025-11-19 08:22:55,035] [INFO] [<frozen importlib] - Best val loss: 0.5636
[2025-11-19 08:22:55,035] [INFO] [<frozen importlib] - Best val AUC: 0.6923
[2025-11-19 08:22:55,035] [INFO] [<frozen importlib] - Best val AUCPR: 0.2176
[2025-11-19 08:22:55,040] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:22:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:23:02,656] [INFO] [<frozen importlib] - Optimal threshold: 0.5317
[2025-11-19 08:23:02,656] [INFO] [<frozen importlib] - Best f1: 0.2738
[2025-11-19 08:23:02,656] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:23:02,706] [INFO] [<frozen importlib] - Validation Results (threshold=0.5317):
[2025-11-19 08:23:02,707] [INFO] [<frozen importlib] -   Accuracy: 0.8989
[2025-11-19 08:23:02,707] [INFO] [<frozen importlib] -   Precision: 0.3056
[2025-11-19 08:23:02,707] [INFO] [<frozen importlib] -   Recall: 0.2479
[2025-11-19 08:23:02,707] [INFO] [<frozen importlib] -   F1 Score: 0.2738
[2025-11-19 08:23:02,707] [INFO] [<frozen importlib] -   AUROC: 0.6923
[2025-11-19 08:23:02,707] [INFO] [<frozen importlib] -   AUPRC: 0.2182
[2025-11-19 08:23:02,707] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:23:02,707] [INFO] [<frozen importlib] -     TN=16627, FP=818
[2025-11-19 08:23:02,707] [INFO] [<frozen importlib] -     FN=1092, TP=360
[2025-11-19 08:23:02,741] [INFO] [<frozen importlib] - Trial 11: AUPRC=0.2182, F1=0.4626, Prec=0.4550, Rec=0.4704 | Optimizing auprc=0.2182
                                                                                     Best trial: 5. Best value: 0.224668:   2%|▏         | 11/500 [01:00<45:41,  5.61s/it]Best trial: 5. Best value: 0.224668:   2%|▏         | 11/500 [01:00<45:41,  5.61s/it]Best trial: 5. Best value: 0.224668:   2%|▏         | 12/500 [01:00<51:35,  6.34s/it][2025-11-19 08:23:02,755] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 13.8456862952168
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   gamma: 0.5494023355072253
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   alpha: 0.7533100008194483
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   lambda: 1.0044483236563617
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   learning_rate: 0.0574852712166597
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   subsample: 0.9850339917696835
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   colsample_bytree: 0.6324335172974407
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   colsample_bylevel: 0.687322002403851
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   colsample_bynode: 0.7553315860117777
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:23:02,755] [INFO] [<frozen importlib] -   scale_pos_weight: 13.8456862952168
[2025-11-19 08:23:02,836] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:23:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:23:02,742] Trial 11 finished with value: 0.2181891268152661 and parameters: {'max_depth': 3, 'min_child_weight': 1, 'gamma': 0.5307950442282506, 'learning_rate': 0.0580942653807854, 'n_estimators': 250, 'alpha': 1.389447692488778, 'lambda': 0.022783097812625996, 'subsample': 0.8745991796909733, 'colsample_bytree': 0.6383586962140074, 'colsample_bylevel': 0.8954178991106394, 'colsample_bynode': 0.8045369317168723, 'scale_pos_weight': 7.804515439359391}. Best is trial 5 with value: 0.22466795710784165.
[0]	train-logloss:0.99347	train-auc:0.65965	train-aucpr:0.23365	val-logloss:1.01648	val-auc:0.61380	val-aucpr:0.13181
[10]	train-logloss:0.93727	train-auc:0.70206	train-aucpr:0.30587	val-logloss:0.86133	val-auc:0.67960	val-aucpr:0.18749
[20]	train-logloss:0.90958	train-auc:0.71349	train-aucpr:0.32207	val-logloss:0.80910	val-auc:0.67072	val-aucpr:0.19079
[30]	train-logloss:0.89490	train-auc:0.72001	train-aucpr:0.33217	val-logloss:0.76052	val-auc:0.67263	val-aucpr:0.19526
[40]	train-logloss:0.88172	train-auc:0.72968	train-aucpr:0.34437	val-logloss:0.71027	val-auc:0.67403	val-aucpr:0.18953
[44]	train-logloss:0.87856	train-auc:0.73156	train-aucpr:0.34683	val-logloss:0.70148	val-auc:0.67336	val-aucpr:0.19233
[2025-11-19 08:23:03,054] [INFO] [<frozen importlib] - Training completed at iteration 15
[2025-11-19 08:23:03,054] [INFO] [<frozen importlib] - Best train loss: 0.9210
[2025-11-19 08:23:03,054] [INFO] [<frozen importlib] - Best val loss: 0.8226
[2025-11-19 08:23:03,054] [INFO] [<frozen importlib] - Best val AUC: 0.6843
[2025-11-19 08:23:03,054] [INFO] [<frozen importlib] - Best val AUCPR: 0.2090
[2025-11-19 08:23:03,057] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:23:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:23:07,261] [INFO] [<frozen importlib] - Optimal threshold: 0.6597
[2025-11-19 08:23:07,261] [INFO] [<frozen importlib] - Best f1: 0.2437
[2025-11-19 08:23:07,261] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:23:07,304] [INFO] [<frozen importlib] - Validation Results (threshold=0.6597):
[2025-11-19 08:23:07,304] [INFO] [<frozen importlib] -   Accuracy: 0.8817
[2025-11-19 08:23:07,304] [INFO] [<frozen importlib] -   Precision: 0.2395
[2025-11-19 08:23:07,304] [INFO] [<frozen importlib] -   Recall: 0.2479
[2025-11-19 08:23:07,304] [INFO] [<frozen importlib] -   F1 Score: 0.2437
[2025-11-19 08:23:07,304] [INFO] [<frozen importlib] -   AUROC: 0.6843
[2025-11-19 08:23:07,304] [INFO] [<frozen importlib] -   AUPRC: 0.2084
[2025-11-19 08:23:07,304] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:23:07,304] [INFO] [<frozen importlib] -     TN=16302, FP=1143
[2025-11-19 08:23:07,304] [INFO] [<frozen importlib] -     FN=1092, TP=360
[2025-11-19 08:23:07,326] [INFO] [<frozen importlib] - Trial 12: AUPRC=0.2084, F1=0.4414, Prec=0.3914, Rec=0.5062 | Optimizing auprc=0.2084
                                                                                     Best trial: 5. Best value: 0.224668:   2%|▏         | 12/500 [01:05<51:35,  6.34s/it]Best trial: 5. Best value: 0.224668:   2%|▏         | 12/500 [01:05<51:35,  6.34s/it]Best trial: 5. Best value: 0.224668:   3%|▎         | 13/500 [01:05<47:09,  5.81s/it][2025-11-19 08:23:07,333] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.267975637393878
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   gamma: 0.8343963925162557
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   alpha: 1.2062592508546768
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   lambda: 0.9592177422921986
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   learning_rate: 0.05947572698522565
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   subsample: 0.6924839515611932
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   colsample_bytree: 0.5824923116775692
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9254498021758061
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   colsample_bynode: 0.5972491757987802
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:23:07,333] [INFO] [<frozen importlib] -   scale_pos_weight: 9.267975637393878
[2025-11-19 08:23:07,411] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:23:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:23:07,326] Trial 12 finished with value: 0.2083952771340873 and parameters: {'max_depth': 5, 'min_child_weight': 3, 'gamma': 0.5494023355072253, 'learning_rate': 0.0574852712166597, 'n_estimators': 100, 'alpha': 0.7533100008194483, 'lambda': 1.0044483236563617, 'subsample': 0.9850339917696835, 'colsample_bytree': 0.6324335172974407, 'colsample_bylevel': 0.687322002403851, 'colsample_bynode': 0.7553315860117777, 'scale_pos_weight': 13.8456862952168}. Best is trial 5 with value: 0.22466795710784165.
[0]	train-logloss:0.81177	train-auc:0.61675	train-aucpr:0.19430	val-logloss:0.82012	val-auc:0.63025	val-aucpr:0.13314
[10]	train-logloss:0.77708	train-auc:0.66431	train-aucpr:0.27153	val-logloss:0.72280	val-auc:0.64430	val-aucpr:0.12656
[20]	train-logloss:0.76018	train-auc:0.67548	train-aucpr:0.28201	val-logloss:0.67965	val-auc:0.65861	val-aucpr:0.17476
[30]	train-logloss:0.74942	train-auc:0.68558	train-aucpr:0.29013	val-logloss:0.66057	val-auc:0.66062	val-aucpr:0.17996
[40]	train-logloss:0.74220	train-auc:0.69151	train-aucpr:0.29492	val-logloss:0.65250	val-auc:0.67357	val-aucpr:0.18634
[50]	train-logloss:0.73660	train-auc:0.69598	train-aucpr:0.29911	val-logloss:0.64349	val-auc:0.67095	val-aucpr:0.18235
[60]	train-logloss:0.73221	train-auc:0.69883	train-aucpr:0.30255	val-logloss:0.62299	val-auc:0.67953	val-aucpr:0.18394
[68]	train-logloss:0.72903	train-auc:0.70206	train-aucpr:0.30535	val-logloss:0.60947	val-auc:0.68288	val-aucpr:0.17894
[2025-11-19 08:23:07,597] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 08:23:07,597] [INFO] [<frozen importlib] - Best train loss: 0.7429
[2025-11-19 08:23:07,597] [INFO] [<frozen importlib] - Best val loss: 0.6488
[2025-11-19 08:23:07,597] [INFO] [<frozen importlib] - Best val AUC: 0.6764
[2025-11-19 08:23:07,597] [INFO] [<frozen importlib] - Best val AUCPR: 0.1882
[2025-11-19 08:23:07,599] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:23:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:23:13,612] [INFO] [<frozen importlib] - Optimal threshold: 0.5706
[2025-11-19 08:23:13,612] [INFO] [<frozen importlib] - Best f1: 0.2486
[2025-11-19 08:23:13,612] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:23:13,658] [INFO] [<frozen importlib] - Validation Results (threshold=0.5706):
[2025-11-19 08:23:13,658] [INFO] [<frozen importlib] -   Accuracy: 0.8899
[2025-11-19 08:23:13,658] [INFO] [<frozen importlib] -   Precision: 0.2614
[2025-11-19 08:23:13,658] [INFO] [<frozen importlib] -   Recall: 0.2369
[2025-11-19 08:23:13,658] [INFO] [<frozen importlib] -   F1 Score: 0.2486
[2025-11-19 08:23:13,658] [INFO] [<frozen importlib] -   AUROC: 0.6764
[2025-11-19 08:23:13,658] [INFO] [<frozen importlib] -   AUPRC: 0.1885
[2025-11-19 08:23:13,658] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:23:13,658] [INFO] [<frozen importlib] -     TN=16473, FP=972
[2025-11-19 08:23:13,658] [INFO] [<frozen importlib] -     FN=1108, TP=344
[2025-11-19 08:23:13,683] [INFO] [<frozen importlib] - Trial 13: AUPRC=0.1885, F1=0.4351, Prec=0.4095, Rec=0.4642 | Optimizing auprc=0.1885
                                                                                     Best trial: 5. Best value: 0.224668:   3%|▎         | 13/500 [01:11<47:09,  5.81s/it]Best trial: 5. Best value: 0.224668:   3%|▎         | 13/500 [01:11<47:09,  5.81s/it]Best trial: 5. Best value: 0.224668:   3%|▎         | 14/500 [01:11<48:24,  5.98s/it][2025-11-19 08:23:13,696] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.574501509898503
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   gamma: 0.6187497895858647
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   alpha: 0.5266962623959177
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   lambda: 1.2920913434046557
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   learning_rate: 0.06800490728212863
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   subsample: 0.8571298462080281
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   colsample_bytree: 0.7277284557137742
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7177343251658946
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   colsample_bynode: 0.8818736974574264
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:23:13,696] [INFO] [<frozen importlib] -   scale_pos_weight: 7.574501509898503
[2025-11-19 08:23:13,791] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:23:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:23:13,683] Trial 13 finished with value: 0.18845322223371797 and parameters: {'max_depth': 3, 'min_child_weight': 5, 'gamma': 0.8343963925162557, 'learning_rate': 0.05947572698522565, 'n_estimators': 200, 'alpha': 1.2062592508546768, 'lambda': 0.9592177422921986, 'subsample': 0.6924839515611932, 'colsample_bytree': 0.5824923116775692, 'colsample_bylevel': 0.9254498021758061, 'colsample_bynode': 0.5972491757987802, 'scale_pos_weight': 9.267975637393878}. Best is trial 5 with value: 0.22466795710784165.
[0]	train-logloss:0.72575	train-auc:0.65583	train-aucpr:0.24173	val-logloss:0.71912	val-auc:0.64136	val-aucpr:0.13321
[10]	train-logloss:0.68669	train-auc:0.68699	train-aucpr:0.29193	val-logloss:0.62401	val-auc:0.67960	val-aucpr:0.18486
[20]	train-logloss:0.66770	train-auc:0.69835	train-aucpr:0.30987	val-logloss:0.59147	val-auc:0.68959	val-aucpr:0.20311
[30]	train-logloss:0.65711	train-auc:0.70272	train-aucpr:0.31794	val-logloss:0.55415	val-auc:0.69895	val-aucpr:0.21422
[40]	train-logloss:0.64986	train-auc:0.71110	train-aucpr:0.32650	val-logloss:0.53584	val-auc:0.69108	val-aucpr:0.20315
[50]	train-logloss:0.64378	train-auc:0.71940	train-aucpr:0.33478	val-logloss:0.51562	val-auc:0.68928	val-aucpr:0.20083
[60]	train-logloss:0.63891	train-auc:0.72751	train-aucpr:0.34149	val-logloss:0.51220	val-auc:0.68749	val-aucpr:0.20016
[62]	train-logloss:0.63813	train-auc:0.72908	train-aucpr:0.34249	val-logloss:0.51255	val-auc:0.68614	val-aucpr:0.19835
[2025-11-19 08:23:14,003] [INFO] [<frozen importlib] - Training completed at iteration 33
[2025-11-19 08:23:14,003] [INFO] [<frozen importlib] - Best train loss: 0.6546
[2025-11-19 08:23:14,003] [INFO] [<frozen importlib] - Best val loss: 0.5459
[2025-11-19 08:23:14,003] [INFO] [<frozen importlib] - Best val AUC: 0.7020
[2025-11-19 08:23:14,003] [INFO] [<frozen importlib] - Best val AUCPR: 0.2154
[2025-11-19 08:23:14,006] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:23:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:23:22,190] [INFO] [<frozen importlib] - Optimal threshold: 0.5203
[2025-11-19 08:23:22,190] [INFO] [<frozen importlib] - Best f1: 0.2631
[2025-11-19 08:23:22,190] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:23:22,239] [INFO] [<frozen importlib] - Validation Results (threshold=0.5203):
[2025-11-19 08:23:22,239] [INFO] [<frozen importlib] -   Accuracy: 0.8814
[2025-11-19 08:23:22,239] [INFO] [<frozen importlib] -   Precision: 0.2517
[2025-11-19 08:23:22,239] [INFO] [<frozen importlib] -   Recall: 0.2755
[2025-11-19 08:23:22,239] [INFO] [<frozen importlib] -   F1 Score: 0.2631
[2025-11-19 08:23:22,239] [INFO] [<frozen importlib] -   AUROC: 0.7020
[2025-11-19 08:23:22,239] [INFO] [<frozen importlib] -   AUPRC: 0.2158
[2025-11-19 08:23:22,239] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:23:22,239] [INFO] [<frozen importlib] -     TN=16256, FP=1189
[2025-11-19 08:23:22,239] [INFO] [<frozen importlib] -     FN=1052, TP=400
[2025-11-19 08:23:22,261] [INFO] [<frozen importlib] - Trial 14: AUPRC=0.2158, F1=0.4400, Prec=0.3852, Rec=0.5131 | Optimizing auprc=0.2158
                                                                                     Best trial: 5. Best value: 0.224668:   3%|▎         | 14/500 [01:20<48:24,  5.98s/it]Best trial: 5. Best value: 0.224668:   3%|▎         | 14/500 [01:20<48:24,  5.98s/it]Best trial: 5. Best value: 0.224668:   3%|▎         | 15/500 [01:20<54:38,  6.76s/it][2025-11-19 08:23:22,269] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.457907096346503
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   gamma: 0.35839028479054175
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   alpha: 0.889648608515864
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   lambda: 4.257586930950284
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   learning_rate: 0.04858519058663356
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   subsample: 0.7749997835195145
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   colsample_bytree: 0.5133499502578286
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9069968527889157
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   colsample_bynode: 0.7809488593470734
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:23:22,269] [INFO] [<frozen importlib] -   scale_pos_weight: 11.457907096346503
[2025-11-19 08:23:22,353] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:23:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:23:22,262] Trial 14 finished with value: 0.2157690085377525 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.6187497895858647, 'learning_rate': 0.06800490728212863, 'n_estimators': 300, 'alpha': 0.5266962623959177, 'lambda': 1.2920913434046557, 'subsample': 0.8571298462080281, 'colsample_bytree': 0.7277284557137742, 'colsample_bylevel': 0.7177343251658946, 'colsample_bynode': 0.8818736974574264, 'scale_pos_weight': 7.574501509898503}. Best is trial 5 with value: 0.22466795710784165.
[0]	train-logloss:0.90624	train-auc:0.65437	train-aucpr:0.23695	val-logloss:0.92096	val-auc:0.64344	val-aucpr:0.13418
[10]	train-logloss:0.86577	train-auc:0.68569	train-aucpr:0.28904	val-logloss:0.81668	val-auc:0.67822	val-aucpr:0.20805
[20]	train-logloss:0.84473	train-auc:0.69307	train-aucpr:0.30051	val-logloss:0.74570	val-auc:0.70536	val-aucpr:0.21650
[30]	train-logloss:0.83072	train-auc:0.69970	train-aucpr:0.30832	val-logloss:0.70627	val-auc:0.70808	val-aucpr:0.22785
[40]	train-logloss:0.82132	train-auc:0.70434	train-aucpr:0.31475	val-logloss:0.66427	val-auc:0.70883	val-aucpr:0.22871
[50]	train-logloss:0.81461	train-auc:0.70805	train-aucpr:0.31964	val-logloss:0.64801	val-auc:0.70988	val-aucpr:0.22918
[60]	train-logloss:0.80822	train-auc:0.71447	train-aucpr:0.32648	val-logloss:0.62440	val-auc:0.70544	val-aucpr:0.23418
[70]	train-logloss:0.80291	train-auc:0.72094	train-aucpr:0.33152	val-logloss:0.59189	val-auc:0.69281	val-aucpr:0.20252
[80]	train-logloss:0.79867	train-auc:0.72551	train-aucpr:0.33542	val-logloss:0.58427	val-auc:0.69223	val-aucpr:0.20261
[89]	train-logloss:0.79540	train-auc:0.72937	train-aucpr:0.33926	val-logloss:0.57218	val-auc:0.68536	val-aucpr:0.18905
[2025-11-19 08:23:22,628] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:23:22,628] [INFO] [<frozen importlib] - Best train loss: 0.8082
[2025-11-19 08:23:22,628] [INFO] [<frozen importlib] - Best val loss: 0.6244
[2025-11-19 08:23:22,628] [INFO] [<frozen importlib] - Best val AUC: 0.7054
[2025-11-19 08:23:22,628] [INFO] [<frozen importlib] - Best val AUCPR: 0.2342
[2025-11-19 08:23:22,631] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:23:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:23:36,006] [INFO] [<frozen importlib] - Optimal threshold: 0.6062
[2025-11-19 08:23:36,006] [INFO] [<frozen importlib] - Best f1: 0.2735
[2025-11-19 08:23:36,006] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:23:36,056] [INFO] [<frozen importlib] - Validation Results (threshold=0.6062):
[2025-11-19 08:23:36,056] [INFO] [<frozen importlib] -   Accuracy: 0.8977
[2025-11-19 08:23:36,056] [INFO] [<frozen importlib] -   Precision: 0.3008
[2025-11-19 08:23:36,056] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 08:23:36,056] [INFO] [<frozen importlib] -   F1 Score: 0.2735
[2025-11-19 08:23:36,056] [INFO] [<frozen importlib] -   AUROC: 0.7054
[2025-11-19 08:23:36,056] [INFO] [<frozen importlib] -   AUPRC: 0.2346
[2025-11-19 08:23:36,056] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:23:36,056] [INFO] [<frozen importlib] -     TN=16599, FP=846
[2025-11-19 08:23:36,056] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 08:23:36,083] [INFO] [<frozen importlib] - Trial 15: AUPRC=0.2346, F1=0.4556, Prec=0.4449, Rec=0.4669 | Optimizing auprc=0.2346
[2025-11-19 08:23:36,083] [INFO] [<frozen importlib] -   → New best model found! (value=0.2346)
                                                                                     Best trial: 5. Best value: 0.224668:   3%|▎         | 15/500 [01:34<54:38,  6.76s/it]Best trial: 15. Best value: 0.234562:   3%|▎         | 15/500 [01:34<54:38,  6.76s/it]Best trial: 15. Best value: 0.234562:   3%|▎         | 16/500 [01:34<1:11:40,  8.89s/it][2025-11-19 08:23:36,096] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.048743910213863
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   gamma: 0.3769959707663782
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   alpha: 1.5192762733856795
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   lambda: 4.359581504395244
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   learning_rate: 0.030059112036905856
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   subsample: 0.7646298588332265
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   colsample_bytree: 0.5071472619029155
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9223180041235874
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   colsample_bynode: 0.7744858174247135
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:23:36,096] [INFO] [<frozen importlib] -   scale_pos_weight: 11.048743910213863
[2025-11-19 08:23:36,181] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:23:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:23:36,083] Trial 15 finished with value: 0.2345623875788278 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.35839028479054175, 'learning_rate': 0.04858519058663356, 'n_estimators': 150, 'alpha': 0.889648608515864, 'lambda': 4.257586930950284, 'subsample': 0.7749997835195145, 'colsample_bytree': 0.5133499502578286, 'colsample_bylevel': 0.9069968527889157, 'colsample_bynode': 0.7809488593470734, 'scale_pos_weight': 11.457907096346503}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.89196	train-auc:0.65361	train-aucpr:0.23853	val-logloss:0.90796	val-auc:0.63938	val-aucpr:0.13753
[10]	train-logloss:0.86342	train-auc:0.68188	train-aucpr:0.28489	val-logloss:0.83538	val-auc:0.67276	val-aucpr:0.19993
[20]	train-logloss:0.84517	train-auc:0.68898	train-aucpr:0.29626	val-logloss:0.79524	val-auc:0.69128	val-aucpr:0.20815
[30]	train-logloss:0.83273	train-auc:0.69356	train-aucpr:0.29901	val-logloss:0.76108	val-auc:0.70210	val-aucpr:0.21410
[40]	train-logloss:0.82329	train-auc:0.69725	train-aucpr:0.30271	val-logloss:0.73623	val-auc:0.69933	val-aucpr:0.21315
[50]	train-logloss:0.81501	train-auc:0.70043	train-aucpr:0.30937	val-logloss:0.71171	val-auc:0.69595	val-aucpr:0.21560
[60]	train-logloss:0.80892	train-auc:0.70350	train-aucpr:0.31243	val-logloss:0.69879	val-auc:0.70127	val-aucpr:0.21971
[70]	train-logloss:0.80417	train-auc:0.70616	train-aucpr:0.31536	val-logloss:0.69569	val-auc:0.69963	val-aucpr:0.22074
[80]	train-logloss:0.79994	train-auc:0.70841	train-aucpr:0.31882	val-logloss:0.68293	val-auc:0.69779	val-aucpr:0.22128
[90]	train-logloss:0.79624	train-auc:0.71197	train-aucpr:0.32157	val-logloss:0.68004	val-auc:0.69800	val-aucpr:0.21773
[100]	train-logloss:0.79287	train-auc:0.71584	train-aucpr:0.32544	val-logloss:0.66664	val-auc:0.69240	val-aucpr:0.21189
[110]	train-logloss:0.78963	train-auc:0.71895	train-aucpr:0.32880	val-logloss:0.65728	val-auc:0.68976	val-aucpr:0.21051
[115]	train-logloss:0.78777	train-auc:0.72079	train-aucpr:0.33020	val-logloss:0.64515	val-auc:0.68413	val-aucpr:0.20574
[2025-11-19 08:23:36,523] [INFO] [<frozen importlib] - Training completed at iteration 85
[2025-11-19 08:23:36,524] [INFO] [<frozen importlib] - Best train loss: 0.7983
[2025-11-19 08:23:36,524] [INFO] [<frozen importlib] - Best val loss: 0.6830
[2025-11-19 08:23:36,524] [INFO] [<frozen importlib] - Best val AUC: 0.6998
[2025-11-19 08:23:36,524] [INFO] [<frozen importlib] - Best val AUCPR: 0.2232
[2025-11-19 08:23:36,526] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:23:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:23:51,032] [INFO] [<frozen importlib] - Optimal threshold: 0.6180
[2025-11-19 08:23:51,032] [INFO] [<frozen importlib] - Best f1: 0.2640
[2025-11-19 08:23:51,032] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:23:51,089] [INFO] [<frozen importlib] - Validation Results (threshold=0.6180):
[2025-11-19 08:23:51,089] [INFO] [<frozen importlib] -   Accuracy: 0.8964
[2025-11-19 08:23:51,089] [INFO] [<frozen importlib] -   Precision: 0.2908
[2025-11-19 08:23:51,089] [INFO] [<frozen importlib] -   Recall: 0.2417
[2025-11-19 08:23:51,089] [INFO] [<frozen importlib] -   F1 Score: 0.2640
[2025-11-19 08:23:51,089] [INFO] [<frozen importlib] -   AUROC: 0.6998
[2025-11-19 08:23:51,089] [INFO] [<frozen importlib] -   AUPRC: 0.2236
[2025-11-19 08:23:51,089] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:23:51,089] [INFO] [<frozen importlib] -     TN=16589, FP=856
[2025-11-19 08:23:51,089] [INFO] [<frozen importlib] -     FN=1101, TP=351
[2025-11-19 08:23:51,116] [INFO] [<frozen importlib] - Trial 16: AUPRC=0.2236, F1=0.4315, Prec=0.4259, Rec=0.4373 | Optimizing auprc=0.2236
                                                                                        Best trial: 15. Best value: 0.234562:   3%|▎         | 16/500 [01:49<1:11:40,  8.89s/it]Best trial: 15. Best value: 0.234562:   3%|▎         | 16/500 [01:49<1:11:40,  8.89s/it]Best trial: 15. Best value: 0.234562:   3%|▎         | 17/500 [01:49<1:26:24, 10.73s/it][2025-11-19 08:23:51,123] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.860290007874633
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   gamma: 0.40903663256612127
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   alpha: 0.7918088932287284
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   lambda: 3.8941483098275884
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   learning_rate: 0.047442105091855695
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   subsample: 0.6933145661944938
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   colsample_bytree: 0.5736306798333981
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9493117666802616
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   colsample_bynode: 0.9038474749200904
[2025-11-19 08:23:51,123] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:23:51,124] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:23:51,124] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:23:51,124] [INFO] [<frozen importlib] -   scale_pos_weight: 7.860290007874633
[2025-11-19 08:23:51,203] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:23:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:23:51,116] Trial 16 finished with value: 0.22356935377447232 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.3769959707663782, 'learning_rate': 0.030059112036905856, 'n_estimators': 200, 'alpha': 1.5192762733856795, 'lambda': 4.359581504395244, 'subsample': 0.7646298588332265, 'colsample_bytree': 0.5071472619029155, 'colsample_bylevel': 0.9223180041235874, 'colsample_bynode': 0.7744858174247135, 'scale_pos_weight': 11.048743910213863}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.74180	train-auc:0.67102	train-aucpr:0.25901	val-logloss:0.73908	val-auc:0.63898	val-aucpr:0.13680
[10]	train-logloss:0.70351	train-auc:0.70196	train-aucpr:0.30996	val-logloss:0.65383	val-auc:0.67875	val-aucpr:0.19250
[20]	train-logloss:0.68212	train-auc:0.71384	train-aucpr:0.32319	val-logloss:0.61064	val-auc:0.67907	val-aucpr:0.20001
[30]	train-logloss:0.66809	train-auc:0.72319	train-aucpr:0.33292	val-logloss:0.58001	val-auc:0.68486	val-aucpr:0.20679
[40]	train-logloss:0.65872	train-auc:0.72909	train-aucpr:0.34072	val-logloss:0.55469	val-auc:0.67242	val-aucpr:0.18275
[50]	train-logloss:0.65054	train-auc:0.73778	train-aucpr:0.34950	val-logloss:0.52759	val-auc:0.67196	val-aucpr:0.17416
[60]	train-logloss:0.64474	train-auc:0.74320	train-aucpr:0.35630	val-logloss:0.50294	val-auc:0.66382	val-aucpr:0.17154
[61]	train-logloss:0.64410	train-auc:0.74473	train-aucpr:0.35712	val-logloss:0.49961	val-auc:0.66259	val-aucpr:0.16957
[2025-11-19 08:23:51,448] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 08:23:51,448] [INFO] [<frozen importlib] - Best train loss: 0.6670
[2025-11-19 08:23:51,448] [INFO] [<frozen importlib] - Best val loss: 0.5771
[2025-11-19 08:23:51,448] [INFO] [<frozen importlib] - Best val AUC: 0.6853
[2025-11-19 08:23:51,448] [INFO] [<frozen importlib] - Best val AUCPR: 0.2085
[2025-11-19 08:23:51,452] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:23:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:23:59,358] [INFO] [<frozen importlib] - Optimal threshold: 0.5346
[2025-11-19 08:23:59,358] [INFO] [<frozen importlib] - Best f1: 0.2443
[2025-11-19 08:23:59,358] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:23:59,403] [INFO] [<frozen importlib] - Validation Results (threshold=0.5346):
[2025-11-19 08:23:59,404] [INFO] [<frozen importlib] -   Accuracy: 0.8893
[2025-11-19 08:23:59,404] [INFO] [<frozen importlib] -   Precision: 0.2570
[2025-11-19 08:23:59,404] [INFO] [<frozen importlib] -   Recall: 0.2328
[2025-11-19 08:23:59,404] [INFO] [<frozen importlib] -   F1 Score: 0.2443
[2025-11-19 08:23:59,404] [INFO] [<frozen importlib] -   AUROC: 0.6853
[2025-11-19 08:23:59,404] [INFO] [<frozen importlib] -   AUPRC: 0.2088
[2025-11-19 08:23:59,404] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:23:59,404] [INFO] [<frozen importlib] -     TN=16468, FP=977
[2025-11-19 08:23:59,404] [INFO] [<frozen importlib] -     FN=1114, TP=338
[2025-11-19 08:23:59,439] [INFO] [<frozen importlib] - Trial 17: AUPRC=0.2088, F1=0.4364, Prec=0.4097, Rec=0.4669 | Optimizing auprc=0.2088
                                                                                        Best trial: 15. Best value: 0.234562:   3%|▎         | 17/500 [01:57<1:26:24, 10.73s/it]Best trial: 15. Best value: 0.234562:   3%|▎         | 17/500 [01:57<1:26:24, 10.73s/it]Best trial: 15. Best value: 0.234562:   4%|▎         | 18/500 [01:57<1:20:24, 10.01s/it][2025-11-19 08:23:59,453] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.813537766958335
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   gamma: 0.4463987628201711
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   alpha: 0.42001126319479576
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   lambda: 3.6814654399430418
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   learning_rate: 0.049197610058707424
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   subsample: 0.5029716640176427
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   colsample_bytree: 0.7166311012099302
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8680057395727278
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   colsample_bynode: 0.8139172824017376
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:23:59,453] [INFO] [<frozen importlib] -   scale_pos_weight: 8.813537766958335
[2025-11-19 08:23:59,541] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:23:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:23:59,440] Trial 17 finished with value: 0.20876056451971747 and parameters: {'max_depth': 5, 'min_child_weight': 2, 'gamma': 0.40903663256612127, 'learning_rate': 0.047442105091855695, 'n_estimators': 300, 'alpha': 0.7918088932287284, 'lambda': 3.8941483098275884, 'subsample': 0.6933145661944938, 'colsample_bytree': 0.5736306798333981, 'colsample_bylevel': 0.9493117666802616, 'colsample_bynode': 0.9038474749200904, 'scale_pos_weight': 7.860290007874633}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.78982	train-auc:0.64983	train-aucpr:0.23195	val-logloss:0.79729	val-auc:0.59068	val-aucpr:0.12489
[10]	train-logloss:0.75286	train-auc:0.68451	train-aucpr:0.28076	val-logloss:0.69855	val-auc:0.68691	val-aucpr:0.18427
[20]	train-logloss:0.73391	train-auc:0.69229	train-aucpr:0.29716	val-logloss:0.65207	val-auc:0.69500	val-aucpr:0.18522
[30]	train-logloss:0.72173	train-auc:0.69927	train-aucpr:0.30803	val-logloss:0.64819	val-auc:0.69952	val-aucpr:0.20265
[40]	train-logloss:0.71342	train-auc:0.70653	train-aucpr:0.31521	val-logloss:0.62644	val-auc:0.70324	val-aucpr:0.20156
[50]	train-logloss:0.70683	train-auc:0.71250	train-aucpr:0.32062	val-logloss:0.60750	val-auc:0.69470	val-aucpr:0.19576
[60]	train-logloss:0.70022	train-auc:0.71894	train-aucpr:0.32725	val-logloss:0.59425	val-auc:0.69489	val-aucpr:0.19983
[70]	train-logloss:0.69564	train-auc:0.72407	train-aucpr:0.33235	val-logloss:0.56893	val-auc:0.69248	val-aucpr:0.19612
[80]	train-logloss:0.69097	train-auc:0.73041	train-aucpr:0.33827	val-logloss:0.57099	val-auc:0.68571	val-aucpr:0.18745
[89]	train-logloss:0.68774	train-auc:0.73546	train-aucpr:0.34311	val-logloss:0.56979	val-auc:0.68483	val-aucpr:0.19113
[2025-11-19 08:23:59,836] [INFO] [<frozen importlib] - Training completed at iteration 59
[2025-11-19 08:23:59,836] [INFO] [<frozen importlib] - Best train loss: 0.7010
[2025-11-19 08:23:59,836] [INFO] [<frozen importlib] - Best val loss: 0.5914
[2025-11-19 08:23:59,836] [INFO] [<frozen importlib] - Best val AUC: 0.6996
[2025-11-19 08:23:59,836] [INFO] [<frozen importlib] - Best val AUCPR: 0.2042
[2025-11-19 08:23:59,839] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:23:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:24:14,968] [INFO] [<frozen importlib] - Optimal threshold: 0.5749
[2025-11-19 08:24:14,969] [INFO] [<frozen importlib] - Best f1: 0.2544
[2025-11-19 08:24:14,969] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:24:15,044] [INFO] [<frozen importlib] - Validation Results (threshold=0.5749):
[2025-11-19 08:24:15,044] [INFO] [<frozen importlib] -   Accuracy: 0.8917
[2025-11-19 08:24:15,044] [INFO] [<frozen importlib] -   Precision: 0.2701
[2025-11-19 08:24:15,044] [INFO] [<frozen importlib] -   Recall: 0.2404
[2025-11-19 08:24:15,044] [INFO] [<frozen importlib] -   F1 Score: 0.2544
[2025-11-19 08:24:15,044] [INFO] [<frozen importlib] -   AUROC: 0.6996
[2025-11-19 08:24:15,044] [INFO] [<frozen importlib] -   AUPRC: 0.2046
[2025-11-19 08:24:15,044] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:24:15,044] [INFO] [<frozen importlib] -     TN=16502, FP=943
[2025-11-19 08:24:15,044] [INFO] [<frozen importlib] -     FN=1103, TP=349
[2025-11-19 08:24:15,073] [INFO] [<frozen importlib] - Trial 18: AUPRC=0.2046, F1=0.4300, Prec=0.4103, Rec=0.4518 | Optimizing auprc=0.2046
                                                                                        Best trial: 15. Best value: 0.234562:   4%|▎         | 18/500 [02:13<1:20:24, 10.01s/it]Best trial: 15. Best value: 0.234562:   4%|▎         | 18/500 [02:13<1:20:24, 10.01s/it]Best trial: 15. Best value: 0.234562:   4%|▍         | 19/500 [02:13<1:33:47, 11.70s/it][2025-11-19 08:24:15,086] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 15.021258147392647
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   gamma: 0.8876080890242959
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   alpha: 1.9025431165190534
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   lambda: 2.5049343573372806
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   learning_rate: 0.0838907193830914
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   subsample: 0.8106452018417596
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   colsample_bytree: 0.5792837219325999
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5143686093013831
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   colsample_bynode: 0.7151029289667776
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:24:15,087] [INFO] [<frozen importlib] -   scale_pos_weight: 15.021258147392647
[2025-11-19 08:24:15,183] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:24:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:24:15,074] Trial 18 finished with value: 0.20457701415539278 and parameters: {'max_depth': 4, 'min_child_weight': 4, 'gamma': 0.4463987628201711, 'learning_rate': 0.049197610058707424, 'n_estimators': 150, 'alpha': 0.42001126319479576, 'lambda': 3.6814654399430418, 'subsample': 0.5029716640176427, 'colsample_bytree': 0.7166311012099302, 'colsample_bylevel': 0.8680057395727278, 'colsample_bynode': 0.8139172824017376, 'scale_pos_weight': 8.813537766958335}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:1.02848	train-auc:0.64802	train-aucpr:0.22523	val-logloss:1.04492	val-auc:0.62688	val-aucpr:0.11097
[10]	train-logloss:0.97439	train-auc:0.68428	train-aucpr:0.28895	val-logloss:0.88646	val-auc:0.70380	val-aucpr:0.20142
[20]	train-logloss:0.95204	train-auc:0.69983	train-aucpr:0.30430	val-logloss:0.85231	val-auc:0.67384	val-aucpr:0.19526
[30]	train-logloss:0.93839	train-auc:0.70934	train-aucpr:0.31564	val-logloss:0.82141	val-auc:0.68614	val-aucpr:0.22174
[40]	train-logloss:0.92780	train-auc:0.71973	train-aucpr:0.32531	val-logloss:0.81649	val-auc:0.68534	val-aucpr:0.22004
[50]	train-logloss:0.91836	train-auc:0.72654	train-aucpr:0.33138	val-logloss:0.75571	val-auc:0.66949	val-aucpr:0.19160
[60]	train-logloss:0.91120	train-auc:0.73454	train-aucpr:0.33918	val-logloss:0.74309	val-auc:0.66906	val-aucpr:0.19140
[63]	train-logloss:0.90959	train-auc:0.73596	train-aucpr:0.34078	val-logloss:0.74560	val-auc:0.66606	val-aucpr:0.18826
[2025-11-19 08:24:15,414] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:24:15,414] [INFO] [<frozen importlib] - Best train loss: 0.9342
[2025-11-19 08:24:15,414] [INFO] [<frozen importlib] - Best val loss: 0.8279
[2025-11-19 08:24:15,414] [INFO] [<frozen importlib] - Best val AUC: 0.6840
[2025-11-19 08:24:15,414] [INFO] [<frozen importlib] - Best val AUCPR: 0.2241
[2025-11-19 08:24:15,417] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:24:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:24:26,455] [INFO] [<frozen importlib] - Optimal threshold: 0.7067
[2025-11-19 08:24:26,455] [INFO] [<frozen importlib] - Best f1: 0.2579
[2025-11-19 08:24:26,455] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:24:26,498] [INFO] [<frozen importlib] - Validation Results (threshold=0.7067):
[2025-11-19 08:24:26,499] [INFO] [<frozen importlib] -   Accuracy: 0.8995
[2025-11-19 08:24:26,499] [INFO] [<frozen importlib] -   Precision: 0.2981
[2025-11-19 08:24:26,499] [INFO] [<frozen importlib] -   Recall: 0.2273
[2025-11-19 08:24:26,499] [INFO] [<frozen importlib] -   F1 Score: 0.2579
[2025-11-19 08:24:26,499] [INFO] [<frozen importlib] -   AUROC: 0.6840
[2025-11-19 08:24:26,499] [INFO] [<frozen importlib] -   AUPRC: 0.2245
[2025-11-19 08:24:26,499] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:24:26,499] [INFO] [<frozen importlib] -     TN=16668, FP=777
[2025-11-19 08:24:26,499] [INFO] [<frozen importlib] -     FN=1122, TP=330
[2025-11-19 08:24:26,524] [INFO] [<frozen importlib] - Trial 19: AUPRC=0.2245, F1=0.4564, Prec=0.4589, Rec=0.4539 | Optimizing auprc=0.2245
                                                                                        Best trial: 15. Best value: 0.234562:   4%|▍         | 19/500 [02:24<1:33:47, 11.70s/it]Best trial: 15. Best value: 0.234562:   4%|▍         | 19/500 [02:24<1:33:47, 11.70s/it]Best trial: 15. Best value: 0.234562:   4%|▍         | 20/500 [02:24<1:32:59, 11.62s/it][2025-11-19 08:24:26,534] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.308013285752567
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   gamma: 0.30870566041033154
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   alpha: 1.155276162397291
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   lambda: 4.892391909490193
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   learning_rate: 0.031688267552620525
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   subsample: 0.8969419105800036
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   colsample_bytree: 0.5065860002764325
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   colsample_bylevel: 0.995301617805946
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   colsample_bynode: 0.8578875727024287
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:24:26,534] [INFO] [<frozen importlib] -   scale_pos_weight: 11.308013285752567
[2025-11-19 08:24:26,587] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:24:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:24:26,524] Trial 19 finished with value: 0.22447420608691665 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.8876080890242959, 'learning_rate': 0.0838907193830914, 'n_estimators': 250, 'alpha': 1.9025431165190534, 'lambda': 2.5049343573372806, 'subsample': 0.8106452018417596, 'colsample_bytree': 0.5792837219325999, 'colsample_bylevel': 0.5143686093013831, 'colsample_bynode': 0.7151029289667776, 'scale_pos_weight': 15.021258147392647}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.90185	train-auc:0.67179	train-aucpr:0.26503	val-logloss:0.91742	val-auc:0.65212	val-aucpr:0.13775
[10]	train-logloss:0.86609	train-auc:0.69881	train-aucpr:0.30403	val-logloss:0.84355	val-auc:0.68106	val-aucpr:0.18778
[20]	train-logloss:0.84359	train-auc:0.70662	train-aucpr:0.31225	val-logloss:0.78827	val-auc:0.68046	val-aucpr:0.19459
[30]	train-logloss:0.82829	train-auc:0.71188	train-aucpr:0.31935	val-logloss:0.75012	val-auc:0.68590	val-aucpr:0.19956
[40]	train-logloss:0.81732	train-auc:0.71597	train-aucpr:0.32578	val-logloss:0.73044	val-auc:0.69279	val-aucpr:0.19754
[50]	train-logloss:0.80894	train-auc:0.71974	train-aucpr:0.33058	val-logloss:0.70398	val-auc:0.69188	val-aucpr:0.19627
[60]	train-logloss:0.80160	train-auc:0.72431	train-aucpr:0.33712	val-logloss:0.68276	val-auc:0.68791	val-aucpr:0.19322
[64]	train-logloss:0.79916	train-auc:0.72599	train-aucpr:0.33914	val-logloss:0.67300	val-auc:0.68226	val-aucpr:0.18624
[2025-11-19 08:24:26,835] [INFO] [<frozen importlib] - Training completed at iteration 35
[2025-11-19 08:24:26,835] [INFO] [<frozen importlib] - Best train loss: 0.8226
[2025-11-19 08:24:26,835] [INFO] [<frozen importlib] - Best val loss: 0.7366
[2025-11-19 08:24:26,835] [INFO] [<frozen importlib] - Best val AUC: 0.6927
[2025-11-19 08:24:26,835] [INFO] [<frozen importlib] - Best val AUCPR: 0.2064
[2025-11-19 08:24:26,838] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:24:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:24:34,079] [INFO] [<frozen importlib] - Optimal threshold: 0.6100
[2025-11-19 08:24:34,079] [INFO] [<frozen importlib] - Best f1: 0.2555
[2025-11-19 08:24:34,079] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:24:34,127] [INFO] [<frozen importlib] - Validation Results (threshold=0.6100):
[2025-11-19 08:24:34,127] [INFO] [<frozen importlib] -   Accuracy: 0.8757
[2025-11-19 08:24:34,127] [INFO] [<frozen importlib] -   Precision: 0.2368
[2025-11-19 08:24:34,127] [INFO] [<frozen importlib] -   Recall: 0.2775
[2025-11-19 08:24:34,127] [INFO] [<frozen importlib] -   F1 Score: 0.2555
[2025-11-19 08:24:34,127] [INFO] [<frozen importlib] -   AUROC: 0.6927
[2025-11-19 08:24:34,127] [INFO] [<frozen importlib] -   AUPRC: 0.2067
[2025-11-19 08:24:34,127] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:24:34,127] [INFO] [<frozen importlib] -     TN=16146, FP=1299
[2025-11-19 08:24:34,127] [INFO] [<frozen importlib] -     FN=1049, TP=403
[2025-11-19 08:24:34,151] [INFO] [<frozen importlib] - Trial 20: AUPRC=0.2067, F1=0.4365, Prec=0.3716, Rec=0.5289 | Optimizing auprc=0.2067
                                                                                        Best trial: 15. Best value: 0.234562:   4%|▍         | 20/500 [02:32<1:32:59, 11.62s/it]Best trial: 15. Best value: 0.234562:   4%|▍         | 20/500 [02:32<1:32:59, 11.62s/it]Best trial: 15. Best value: 0.234562:   4%|▍         | 21/500 [02:32<1:23:13, 10.42s/it][2025-11-19 08:24:34,160] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 14.781129092830874
[2025-11-19 08:24:34,160] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:24:34,160] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:24:34,160] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:24:34,160] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   gamma: 0.8284231240521559
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   alpha: 1.9299387381626438
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   lambda: 2.5482740980641863
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   learning_rate: 0.0842529244036844
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   subsample: 0.7971870474882272
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   colsample_bytree: 0.5850933587947655
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5069487790895084
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   colsample_bynode: 0.7254426108920369
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:24:34,161] [INFO] [<frozen importlib] -   scale_pos_weight: 14.781129092830874
[2025-11-19 08:24:34,236] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:24:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:24:34,151] Trial 20 finished with value: 0.20667584830902025 and parameters: {'max_depth': 5, 'min_child_weight': 4, 'gamma': 0.30870566041033154, 'learning_rate': 0.031688267552620525, 'n_estimators': 100, 'alpha': 1.155276162397291, 'lambda': 4.892391909490193, 'subsample': 0.8969419105800036, 'colsample_bytree': 0.5065860002764325, 'colsample_bylevel': 0.995301617805946, 'colsample_bynode': 0.8578875727024287, 'scale_pos_weight': 11.308013285752567}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:1.02112	train-auc:0.64607	train-aucpr:0.22048	val-logloss:1.04060	val-auc:0.62321	val-aucpr:0.10564
[10]	train-logloss:0.96638	train-auc:0.68564	train-aucpr:0.28594	val-logloss:0.89256	val-auc:0.70638	val-aucpr:0.19105
[20]	train-logloss:0.94427	train-auc:0.69940	train-aucpr:0.30550	val-logloss:0.82747	val-auc:0.70283	val-aucpr:0.20879
[30]	train-logloss:0.93093	train-auc:0.70766	train-aucpr:0.31557	val-logloss:0.78766	val-auc:0.69860	val-aucpr:0.21155
[40]	train-logloss:0.92189	train-auc:0.71507	train-aucpr:0.32422	val-logloss:0.77324	val-auc:0.70026	val-aucpr:0.21538
[46]	train-logloss:0.91484	train-auc:0.72007	train-aucpr:0.33014	val-logloss:0.71551	val-auc:0.68830	val-aucpr:0.20365
[2025-11-19 08:24:34,393] [INFO] [<frozen importlib] - Training completed at iteration 17
[2025-11-19 08:24:34,393] [INFO] [<frozen importlib] - Best train loss: 0.9498
[2025-11-19 08:24:34,393] [INFO] [<frozen importlib] - Best val loss: 0.8548
[2025-11-19 08:24:34,393] [INFO] [<frozen importlib] - Best val AUC: 0.7070
[2025-11-19 08:24:34,393] [INFO] [<frozen importlib] - Best val AUCPR: 0.2190
[2025-11-19 08:24:34,397] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:24:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:24:38,474] [INFO] [<frozen importlib] - Optimal threshold: 0.6819
[2025-11-19 08:24:38,474] [INFO] [<frozen importlib] - Best f1: 0.2668
[2025-11-19 08:24:38,474] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:24:38,516] [INFO] [<frozen importlib] - Validation Results (threshold=0.6819):
[2025-11-19 08:24:38,516] [INFO] [<frozen importlib] -   Accuracy: 0.8816
[2025-11-19 08:24:38,516] [INFO] [<frozen importlib] -   Precision: 0.2545
[2025-11-19 08:24:38,516] [INFO] [<frozen importlib] -   Recall: 0.2803
[2025-11-19 08:24:38,516] [INFO] [<frozen importlib] -   F1 Score: 0.2668
[2025-11-19 08:24:38,516] [INFO] [<frozen importlib] -   AUROC: 0.7070
[2025-11-19 08:24:38,516] [INFO] [<frozen importlib] -   AUPRC: 0.2191
[2025-11-19 08:24:38,516] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:24:38,516] [INFO] [<frozen importlib] -     TN=16253, FP=1192
[2025-11-19 08:24:38,516] [INFO] [<frozen importlib] -     FN=1045, TP=407
[2025-11-19 08:24:38,538] [INFO] [<frozen importlib] - Trial 21: AUPRC=0.2191, F1=0.4424, Prec=0.3865, Rec=0.5172 | Optimizing auprc=0.2191
                                                                                        Best trial: 15. Best value: 0.234562:   4%|▍         | 21/500 [02:36<1:23:13, 10.42s/it]Best trial: 15. Best value: 0.234562:   4%|▍         | 21/500 [02:36<1:23:13, 10.42s/it]Best trial: 15. Best value: 0.234562:   4%|▍         | 22/500 [02:36<1:08:36,  8.61s/it][2025-11-19 08:24:38,546] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 15.932749939254544
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   gamma: 0.8693068231842486
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   alpha: 1.9819553275736408
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   lambda: 2.257135483234936
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   learning_rate: 0.06852813516865587
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   subsample: 0.8180297518072585
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   colsample_bytree: 0.56976981325024
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5073694510060646
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   colsample_bynode: 0.7843332262456578
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:24:38,546] [INFO] [<frozen importlib] -   scale_pos_weight: 15.932749939254544
[2025-11-19 08:24:38,617] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:24:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:24:38,539] Trial 21 finished with value: 0.2190814961397837 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.8284231240521559, 'learning_rate': 0.0842529244036844, 'n_estimators': 250, 'alpha': 1.9299387381626438, 'lambda': 2.5482740980641863, 'subsample': 0.7971870474882272, 'colsample_bytree': 0.5850933587947655, 'colsample_bylevel': 0.5069487790895084, 'colsample_bynode': 0.7254426108920369, 'scale_pos_weight': 14.781129092830874}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:1.05838	train-auc:0.64771	train-aucpr:0.22515	val-logloss:1.08041	val-auc:0.62822	val-aucpr:0.11202
[10]	train-logloss:1.00764	train-auc:0.68848	train-aucpr:0.28542	val-logloss:0.92779	val-auc:0.68862	val-aucpr:0.19284
[20]	train-logloss:0.98742	train-auc:0.69669	train-aucpr:0.29873	val-logloss:0.86724	val-auc:0.69793	val-aucpr:0.20286
[30]	train-logloss:0.97449	train-auc:0.70412	train-aucpr:0.30535	val-logloss:0.79977	val-auc:0.70484	val-aucpr:0.21216
[40]	train-logloss:0.96566	train-auc:0.71057	train-aucpr:0.31234	val-logloss:0.77994	val-auc:0.71003	val-aucpr:0.21197
[50]	train-logloss:0.95615	train-auc:0.71649	train-aucpr:0.32112	val-logloss:0.73525	val-auc:0.70701	val-aucpr:0.20120
[60]	train-logloss:0.94940	train-auc:0.72440	train-aucpr:0.32790	val-logloss:0.71759	val-auc:0.69575	val-aucpr:0.18940
[68]	train-logloss:0.94422	train-auc:0.72911	train-aucpr:0.33306	val-logloss:0.71000	val-auc:0.68915	val-aucpr:0.18198
[2025-11-19 08:24:38,826] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 08:24:38,826] [INFO] [<frozen importlib] - Best train loss: 0.9664
[2025-11-19 08:24:38,826] [INFO] [<frozen importlib] - Best val loss: 0.7759
[2025-11-19 08:24:38,826] [INFO] [<frozen importlib] - Best val AUC: 0.7088
[2025-11-19 08:24:38,826] [INFO] [<frozen importlib] - Best val AUCPR: 0.2167
[2025-11-19 08:24:38,829] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:24:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:24:50,374] [INFO] [<frozen importlib] - Optimal threshold: 0.6872
[2025-11-19 08:24:50,374] [INFO] [<frozen importlib] - Best f1: 0.2576
[2025-11-19 08:24:50,374] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:24:50,414] [INFO] [<frozen importlib] - Validation Results (threshold=0.6872):
[2025-11-19 08:24:50,414] [INFO] [<frozen importlib] -   Accuracy: 0.8713
[2025-11-19 08:24:50,414] [INFO] [<frozen importlib] -   Precision: 0.2314
[2025-11-19 08:24:50,414] [INFO] [<frozen importlib] -   Recall: 0.2906
[2025-11-19 08:24:50,414] [INFO] [<frozen importlib] -   F1 Score: 0.2576
[2025-11-19 08:24:50,414] [INFO] [<frozen importlib] -   AUROC: 0.7088
[2025-11-19 08:24:50,414] [INFO] [<frozen importlib] -   AUPRC: 0.2171
[2025-11-19 08:24:50,415] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:24:50,415] [INFO] [<frozen importlib] -     TN=16043, FP=1402
[2025-11-19 08:24:50,415] [INFO] [<frozen importlib] -     FN=1030, TP=422
[2025-11-19 08:24:50,440] [INFO] [<frozen importlib] - Trial 22: AUPRC=0.2171, F1=0.4366, Prec=0.3624, Rec=0.5489 | Optimizing auprc=0.2171
                                                                                        Best trial: 15. Best value: 0.234562:   4%|▍         | 22/500 [02:48<1:08:36,  8.61s/it]Best trial: 15. Best value: 0.234562:   4%|▍         | 22/500 [02:48<1:08:36,  8.61s/it]Best trial: 15. Best value: 0.234562:   5%|▍         | 23/500 [02:48<1:16:18,  9.60s/it][2025-11-19 08:24:50,447] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 18.18624913628737
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   gamma: 0.9052647519807523
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   alpha: 1.676263049131126
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   lambda: 3.561156315837249
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   learning_rate: 0.10995054727251403
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   subsample: 0.7239980688885019
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   colsample_bytree: 0.6798145876891726
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7643080707754749
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   colsample_bynode: 0.9308186213469086
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:24:50,447] [INFO] [<frozen importlib] -   scale_pos_weight: 18.18624913628737
[2025-11-19 08:24:50,521] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:24:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:24:50,440] Trial 22 finished with value: 0.2170541456646344 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.8693068231842486, 'learning_rate': 0.06852813516865587, 'n_estimators': 200, 'alpha': 1.9819553275736408, 'lambda': 2.257135483234936, 'subsample': 0.8180297518072585, 'colsample_bytree': 0.56976981325024, 'colsample_bylevel': 0.5073694510060646, 'colsample_bynode': 0.7843332262456578, 'scale_pos_weight': 15.932749939254544}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:1.11315	train-auc:0.65337	train-aucpr:0.23704	val-logloss:1.13008	val-auc:0.59446	val-aucpr:0.09939
[10]	train-logloss:1.05517	train-auc:0.69220	train-aucpr:0.29346	val-logloss:0.89047	val-auc:0.68178	val-aucpr:0.19064
[20]	train-logloss:1.03544	train-auc:0.70466	train-aucpr:0.31049	val-logloss:0.86448	val-auc:0.68469	val-aucpr:0.20837
[30]	train-logloss:1.02005	train-auc:0.71855	train-aucpr:0.32572	val-logloss:0.77878	val-auc:0.66790	val-aucpr:0.16631
[40]	train-logloss:1.00934	train-auc:0.72898	train-aucpr:0.33549	val-logloss:0.70623	val-auc:0.67074	val-aucpr:0.15437
[50]	train-logloss:0.99618	train-auc:0.74064	train-aucpr:0.34661	val-logloss:0.68924	val-auc:0.66748	val-aucpr:0.14464
[51]	train-logloss:0.99524	train-auc:0.74133	train-aucpr:0.34769	val-logloss:0.68841	val-auc:0.66852	val-aucpr:0.14622
[2025-11-19 08:24:50,686] [INFO] [<frozen importlib] - Training completed at iteration 22
[2025-11-19 08:24:50,686] [INFO] [<frozen importlib] - Best train loss: 1.0313
[2025-11-19 08:24:50,686] [INFO] [<frozen importlib] - Best val loss: 0.8626
[2025-11-19 08:24:50,686] [INFO] [<frozen importlib] - Best val AUC: 0.6866
[2025-11-19 08:24:50,686] [INFO] [<frozen importlib] - Best val AUCPR: 0.2107
[2025-11-19 08:24:50,689] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:24:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:24:57,241] [INFO] [<frozen importlib] - Optimal threshold: 0.7252
[2025-11-19 08:24:57,241] [INFO] [<frozen importlib] - Best f1: 0.2624
[2025-11-19 08:24:57,241] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:24:57,281] [INFO] [<frozen importlib] - Validation Results (threshold=0.7252):
[2025-11-19 08:24:57,281] [INFO] [<frozen importlib] -   Accuracy: 0.9051
[2025-11-19 08:24:57,281] [INFO] [<frozen importlib] -   Precision: 0.3258
[2025-11-19 08:24:57,281] [INFO] [<frozen importlib] -   Recall: 0.2197
[2025-11-19 08:24:57,281] [INFO] [<frozen importlib] -   F1 Score: 0.2624
[2025-11-19 08:24:57,281] [INFO] [<frozen importlib] -   AUROC: 0.6866
[2025-11-19 08:24:57,281] [INFO] [<frozen importlib] -   AUPRC: 0.2109
[2025-11-19 08:24:57,281] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:24:57,281] [INFO] [<frozen importlib] -     TN=16785, FP=660
[2025-11-19 08:24:57,281] [INFO] [<frozen importlib] -     FN=1133, TP=319
[2025-11-19 08:24:57,304] [INFO] [<frozen importlib] - Trial 23: AUPRC=0.2109, F1=0.4629, Prec=0.4907, Rec=0.4380 | Optimizing auprc=0.2109
                                                                                        Best trial: 15. Best value: 0.234562:   5%|▍         | 23/500 [02:55<1:16:18,  9.60s/it]Best trial: 15. Best value: 0.234562:   5%|▍         | 23/500 [02:55<1:16:18,  9.60s/it]Best trial: 15. Best value: 0.234562:   5%|▍         | 24/500 [02:55<1:09:38,  8.78s/it][2025-11-19 08:24:57,311] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 14.858616657241747
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   gamma: 0.6245618464803291
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   alpha: 1.4051954081756848
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   lambda: 4.250466523063772
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   learning_rate: 0.05544311206175471
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   subsample: 0.8241909080677585
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   colsample_bytree: 0.500966295027603
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7095223418616126
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   colsample_bynode: 0.7209615037666366
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:24:57,311] [INFO] [<frozen importlib] -   scale_pos_weight: 14.858616657241747
[2025-11-19 08:24:57,379] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:24:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:24:57,304] Trial 23 finished with value: 0.21092930947740832 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.9052647519807523, 'learning_rate': 0.10995054727251403, 'n_estimators': 250, 'alpha': 1.676263049131126, 'lambda': 3.561156315837249, 'subsample': 0.7239980688885019, 'colsample_bytree': 0.6798145876891726, 'colsample_bylevel': 0.7643080707754749, 'colsample_bynode': 0.9308186213469086, 'scale_pos_weight': 18.18624913628737}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:1.02753	train-auc:0.64181	train-aucpr:0.22892	val-logloss:1.05712	val-auc:0.63095	val-aucpr:0.13845
[10]	train-logloss:0.98149	train-auc:0.68629	train-aucpr:0.28751	val-logloss:0.92192	val-auc:0.69216	val-aucpr:0.19778
[20]	train-logloss:0.95992	train-auc:0.69319	train-aucpr:0.30270	val-logloss:0.85454	val-auc:0.69524	val-aucpr:0.20623
[30]	train-logloss:0.94682	train-auc:0.69960	train-aucpr:0.30845	val-logloss:0.82022	val-auc:0.69411	val-aucpr:0.21300
[40]	train-logloss:0.93668	train-auc:0.70628	train-aucpr:0.31379	val-logloss:0.79047	val-auc:0.69675	val-aucpr:0.21661
[50]	train-logloss:0.92882	train-auc:0.71253	train-aucpr:0.31918	val-logloss:0.75505	val-auc:0.68077	val-aucpr:0.19172
[60]	train-logloss:0.92207	train-auc:0.72017	train-aucpr:0.32505	val-logloss:0.70643	val-auc:0.67080	val-aucpr:0.18647
[67]	train-logloss:0.91778	train-auc:0.72424	train-aucpr:0.32865	val-logloss:0.66956	val-auc:0.67147	val-aucpr:0.16978
[2025-11-19 08:24:57,585] [INFO] [<frozen importlib] - Training completed at iteration 38
[2025-11-19 08:24:57,585] [INFO] [<frozen importlib] - Best train loss: 0.9383
[2025-11-19 08:24:57,585] [INFO] [<frozen importlib] - Best val loss: 0.7986
[2025-11-19 08:24:57,585] [INFO] [<frozen importlib] - Best val AUC: 0.6964
[2025-11-19 08:24:57,585] [INFO] [<frozen importlib] - Best val AUCPR: 0.2172
[2025-11-19 08:24:57,588] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:24:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:25:08,312] [INFO] [<frozen importlib] - Optimal threshold: 0.6730
[2025-11-19 08:25:08,312] [INFO] [<frozen importlib] - Best f1: 0.2599
[2025-11-19 08:25:08,312] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:25:08,364] [INFO] [<frozen importlib] - Validation Results (threshold=0.6730):
[2025-11-19 08:25:08,364] [INFO] [<frozen importlib] -   Accuracy: 0.8921
[2025-11-19 08:25:08,364] [INFO] [<frozen importlib] -   Precision: 0.2748
[2025-11-19 08:25:08,364] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 08:25:08,364] [INFO] [<frozen importlib] -   F1 Score: 0.2599
[2025-11-19 08:25:08,365] [INFO] [<frozen importlib] -   AUROC: 0.6964
[2025-11-19 08:25:08,365] [INFO] [<frozen importlib] -   AUPRC: 0.2179
[2025-11-19 08:25:08,365] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:25:08,365] [INFO] [<frozen importlib] -     TN=16500, FP=945
[2025-11-19 08:25:08,365] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 08:25:08,391] [INFO] [<frozen importlib] - Trial 24: AUPRC=0.2179, F1=0.4560, Prec=0.4283, Rec=0.4876 | Optimizing auprc=0.2179
                                                                                        Best trial: 15. Best value: 0.234562:   5%|▍         | 24/500 [03:06<1:09:38,  8.78s/it]Best trial: 15. Best value: 0.234562:   5%|▍         | 24/500 [03:06<1:09:38,  8.78s/it]Best trial: 15. Best value: 0.234562:   5%|▌         | 25/500 [03:06<1:14:58,  9.47s/it][2025-11-19 08:25:08,404] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.678011355433705
[2025-11-19 08:25:08,404] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:25:08,404] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:25:08,404] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:25:08,404] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:25:08,404] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:25:08,404] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   gamma: 0.8048852007735586
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   alpha: 0.921568116793035
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   lambda: 2.5935997856962096
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   learning_rate: 0.15679706503222002
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   subsample: 0.9046900054092587
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   colsample_bytree: 0.6181176190750675
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6436311157074671
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   colsample_bynode: 0.6068961110044846
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:25:08,405] [INFO] [<frozen importlib] -   scale_pos_weight: 11.678011355433705
[2025-11-19 08:25:08,496] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:25:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:25:08,391] Trial 24 finished with value: 0.21790297262006186 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.6245618464803291, 'learning_rate': 0.05544311206175471, 'n_estimators': 350, 'alpha': 1.4051954081756848, 'lambda': 4.250466523063772, 'subsample': 0.8241909080677585, 'colsample_bytree': 0.500966295027603, 'colsample_bylevel': 0.7095223418616126, 'colsample_bynode': 0.7209615037666366, 'scale_pos_weight': 14.858616657241747}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.90257	train-auc:0.64452	train-aucpr:0.23126	val-logloss:0.89926	val-auc:0.61101	val-aucpr:0.12077
[10]	train-logloss:0.83662	train-auc:0.69355	train-aucpr:0.30814	val-logloss:0.67348	val-auc:0.69454	val-aucpr:0.20566
[20]	train-logloss:0.81713	train-auc:0.70861	train-aucpr:0.32281	val-logloss:0.66228	val-auc:0.70104	val-aucpr:0.21529
[30]	train-logloss:0.80358	train-auc:0.72547	train-aucpr:0.33700	val-logloss:0.60801	val-auc:0.66575	val-aucpr:0.16417
[40]	train-logloss:0.79209	train-auc:0.73985	train-aucpr:0.34999	val-logloss:0.59510	val-auc:0.66268	val-aucpr:0.15643
[44]	train-logloss:0.78720	train-auc:0.74501	train-aucpr:0.35554	val-logloss:0.52971	val-auc:0.65684	val-aucpr:0.12790
[2025-11-19 08:25:08,646] [INFO] [<frozen importlib] - Training completed at iteration 14
[2025-11-19 08:25:08,646] [INFO] [<frozen importlib] - Best train loss: 0.8282
[2025-11-19 08:25:08,646] [INFO] [<frozen importlib] - Best val loss: 0.6702
[2025-11-19 08:25:08,646] [INFO] [<frozen importlib] - Best val AUC: 0.7055
[2025-11-19 08:25:08,646] [INFO] [<frozen importlib] - Best val AUCPR: 0.2210
[2025-11-19 08:25:08,649] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:25:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:25:12,344] [INFO] [<frozen importlib] - Optimal threshold: 0.6231
[2025-11-19 08:25:12,344] [INFO] [<frozen importlib] - Best f1: 0.2675
[2025-11-19 08:25:12,344] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:25:12,394] [INFO] [<frozen importlib] - Validation Results (threshold=0.6231):
[2025-11-19 08:25:12,395] [INFO] [<frozen importlib] -   Accuracy: 0.9050
[2025-11-19 08:25:12,395] [INFO] [<frozen importlib] -   Precision: 0.3280
[2025-11-19 08:25:12,395] [INFO] [<frozen importlib] -   Recall: 0.2259
[2025-11-19 08:25:12,395] [INFO] [<frozen importlib] -   F1 Score: 0.2675
[2025-11-19 08:25:12,395] [INFO] [<frozen importlib] -   AUROC: 0.7055
[2025-11-19 08:25:12,395] [INFO] [<frozen importlib] -   AUPRC: 0.2208
[2025-11-19 08:25:12,395] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:25:12,395] [INFO] [<frozen importlib] -     TN=16773, FP=672
[2025-11-19 08:25:12,395] [INFO] [<frozen importlib] -     FN=1124, TP=328
[2025-11-19 08:25:12,421] [INFO] [<frozen importlib] - Trial 25: AUPRC=0.2208, F1=0.4681, Prec=0.4913, Rec=0.4470 | Optimizing auprc=0.2208
                                                                                        Best trial: 15. Best value: 0.234562:   5%|▌         | 25/500 [03:10<1:14:58,  9.47s/it]Best trial: 15. Best value: 0.234562:   5%|▌         | 25/500 [03:10<1:14:58,  9.47s/it]Best trial: 15. Best value: 0.234562:   5%|▌         | 26/500 [03:10<1:01:55,  7.84s/it][2025-11-19 08:25:12,427] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.516816895796587
[2025-11-19 08:25:12,427] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:25:12,427] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:25:12,427] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   gamma: 0.9982835861660033
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   alpha: 0.7368667130873914
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   lambda: 1.9197304407738056
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   learning_rate: 0.0493734412796124
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   subsample: 0.7840871698253229
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   colsample_bytree: 0.5532569596308773
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8926786912299028
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   colsample_bynode: 0.8286025052219894
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:25:12,428] [INFO] [<frozen importlib] -   scale_pos_weight: 6.516816895796587
[2025-11-19 08:25:12,511] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:25:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:25:12,421] Trial 25 finished with value: 0.22077774854336535 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.8048852007735586, 'learning_rate': 0.15679706503222002, 'n_estimators': 150, 'alpha': 0.921568116793035, 'lambda': 2.5935997856962096, 'subsample': 0.9046900054092587, 'colsample_bytree': 0.6181176190750675, 'colsample_bylevel': 0.6436311157074671, 'colsample_bynode': 0.6068961110044846, 'scale_pos_weight': 11.678011355433705}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.67084	train-auc:0.66385	train-aucpr:0.25958	val-logloss:0.65967	val-auc:0.68943	val-aucpr:0.18569
[10]	train-logloss:0.63623	train-auc:0.70229	train-aucpr:0.31280	val-logloss:0.58248	val-auc:0.68966	val-aucpr:0.19537
[20]	train-logloss:0.61729	train-auc:0.71368	train-aucpr:0.32576	val-logloss:0.54775	val-auc:0.69212	val-aucpr:0.20195
[30]	train-logloss:0.60523	train-auc:0.72166	train-aucpr:0.33531	val-logloss:0.51246	val-auc:0.69050	val-aucpr:0.20029
[40]	train-logloss:0.59678	train-auc:0.72834	train-aucpr:0.34591	val-logloss:0.48633	val-auc:0.69511	val-aucpr:0.21064
[50]	train-logloss:0.58993	train-auc:0.73429	train-aucpr:0.35255	val-logloss:0.46110	val-auc:0.69207	val-aucpr:0.21185
[60]	train-logloss:0.58523	train-auc:0.73948	train-aucpr:0.35881	val-logloss:0.44645	val-auc:0.69470	val-aucpr:0.21578
[70]	train-logloss:0.58109	train-auc:0.74612	train-aucpr:0.36565	val-logloss:0.41465	val-auc:0.68056	val-aucpr:0.18621
[80]	train-logloss:0.57685	train-auc:0.75361	train-aucpr:0.37261	val-logloss:0.40629	val-auc:0.67992	val-aucpr:0.18535
[89]	train-logloss:0.57363	train-auc:0.75942	train-aucpr:0.37850	val-logloss:0.40222	val-auc:0.68026	val-aucpr:0.18251
[2025-11-19 08:25:12,851] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:25:12,851] [INFO] [<frozen importlib] - Best train loss: 0.5852
[2025-11-19 08:25:12,851] [INFO] [<frozen importlib] - Best val loss: 0.4464
[2025-11-19 08:25:12,851] [INFO] [<frozen importlib] - Best val AUC: 0.6947
[2025-11-19 08:25:12,851] [INFO] [<frozen importlib] - Best val AUCPR: 0.2158
[2025-11-19 08:25:12,854] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:25:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:25:27,190] [INFO] [<frozen importlib] - Optimal threshold: 0.4697
[2025-11-19 08:25:27,190] [INFO] [<frozen importlib] - Best f1: 0.2571
[2025-11-19 08:25:27,190] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:25:27,241] [INFO] [<frozen importlib] - Validation Results (threshold=0.4697):
[2025-11-19 08:25:27,242] [INFO] [<frozen importlib] -   Accuracy: 0.9015
[2025-11-19 08:25:27,242] [INFO] [<frozen importlib] -   Precision: 0.3058
[2025-11-19 08:25:27,242] [INFO] [<frozen importlib] -   Recall: 0.2218
[2025-11-19 08:25:27,242] [INFO] [<frozen importlib] -   F1 Score: 0.2571
[2025-11-19 08:25:27,242] [INFO] [<frozen importlib] -   AUROC: 0.6947
[2025-11-19 08:25:27,242] [INFO] [<frozen importlib] -   AUPRC: 0.2163
[2025-11-19 08:25:27,242] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:25:27,242] [INFO] [<frozen importlib] -     TN=16714, FP=731
[2025-11-19 08:25:27,242] [INFO] [<frozen importlib] -     FN=1130, TP=322
[2025-11-19 08:25:27,271] [INFO] [<frozen importlib] - Trial 26: AUPRC=0.2163, F1=0.4496, Prec=0.4641, Rec=0.4360 | Optimizing auprc=0.2163
[2025-11-19 08:25:27,271] [INFO] [<frozen importlib] - Trial 26 pruned.
[2025-11-19 08:25:27,271] [ERROR] [<frozen importlib] - Trial 26 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:   5%|▌         | 26/500 [03:25<1:01:55,  7.84s/it]Best trial: 15. Best value: 0.234562:   5%|▌         | 26/500 [03:25<1:01:55,  7.84s/it]Best trial: 15. Best value: 0.234562:   5%|▌         | 27/500 [03:25<1:18:22,  9.94s/it][2025-11-19 08:25:27,284] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 14.374224255233731
[2025-11-19 08:25:27,284] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:25:27,284] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:25:27,284] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:25:27,284] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:25:27,284] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:25:27,284] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:25:27,284] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:25:27,284] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:25:27,284] [INFO] [<frozen importlib] -   gamma: 0.4811641416756805
[2025-11-19 08:25:27,285] [INFO] [<frozen importlib] -   alpha: 1.8304617291297964
[2025-11-19 08:25:27,285] [INFO] [<frozen importlib] -   lambda: 4.269688356663178
[2025-11-19 08:25:27,285] [INFO] [<frozen importlib] -   learning_rate: 0.08760333401700038
[2025-11-19 08:25:27,285] [INFO] [<frozen importlib] -   subsample: 0.7296608602343858
[2025-11-19 08:25:27,285] [INFO] [<frozen importlib] -   colsample_bytree: 0.6067508065823507
[2025-11-19 08:25:27,285] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9332152960524143
[2025-11-19 08:25:27,285] [INFO] [<frozen importlib] -   colsample_bynode: 0.995503791488471
[2025-11-19 08:25:27,285] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:25:27,285] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:25:27,285] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:25:27,285] [INFO] [<frozen importlib] -   scale_pos_weight: 14.374224255233731
[2025-11-19 08:25:27,374] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:25:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:25:27,271] Trial 26 pruned. 
[0]	train-logloss:1.00650	train-auc:0.65467	train-aucpr:0.23494	val-logloss:1.02202	val-auc:0.60939	val-aucpr:0.10377
[10]	train-logloss:0.94656	train-auc:0.69181	train-aucpr:0.29863	val-logloss:0.85664	val-auc:0.68674	val-aucpr:0.18105
[20]	train-logloss:0.92483	train-auc:0.70244	train-aucpr:0.31076	val-logloss:0.79669	val-auc:0.68885	val-aucpr:0.19400
[30]	train-logloss:0.91167	train-auc:0.71257	train-aucpr:0.32038	val-logloss:0.72955	val-auc:0.68114	val-aucpr:0.17355
[40]	train-logloss:0.90187	train-auc:0.72242	train-aucpr:0.32859	val-logloss:0.68428	val-auc:0.67493	val-aucpr:0.15661
[44]	train-logloss:0.89785	train-auc:0.72632	train-aucpr:0.33213	val-logloss:0.68108	val-auc:0.67473	val-aucpr:0.15733
[2025-11-19 08:25:27,528] [INFO] [<frozen importlib] - Training completed at iteration 14
[2025-11-19 08:25:27,528] [INFO] [<frozen importlib] - Best train loss: 0.9362
[2025-11-19 08:25:27,528] [INFO] [<frozen importlib] - Best val loss: 0.8167
[2025-11-19 08:25:27,528] [INFO] [<frozen importlib] - Best val AUC: 0.6898
[2025-11-19 08:25:27,528] [INFO] [<frozen importlib] - Best val AUCPR: 0.2047
[2025-11-19 08:25:27,531] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:25:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:25:29,819] [INFO] [<frozen importlib] - Optimal threshold: 0.6684
[2025-11-19 08:25:29,819] [INFO] [<frozen importlib] - Best f1: 0.2560
[2025-11-19 08:25:29,819] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:25:29,874] [INFO] [<frozen importlib] - Validation Results (threshold=0.6684):
[2025-11-19 08:25:29,875] [INFO] [<frozen importlib] -   Accuracy: 0.8880
[2025-11-19 08:25:29,875] [INFO] [<frozen importlib] -   Precision: 0.2615
[2025-11-19 08:25:29,875] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 08:25:29,875] [INFO] [<frozen importlib] -   F1 Score: 0.2560
[2025-11-19 08:25:29,875] [INFO] [<frozen importlib] -   AUROC: 0.6898
[2025-11-19 08:25:29,875] [INFO] [<frozen importlib] -   AUPRC: 0.2041
[2025-11-19 08:25:29,875] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:25:29,875] [INFO] [<frozen importlib] -     TN=16417, FP=1028
[2025-11-19 08:25:29,875] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 08:25:29,902] [INFO] [<frozen importlib] - Trial 27: AUPRC=0.2041, F1=0.4219, Prec=0.3921, Rec=0.4566 | Optimizing auprc=0.2041
[2025-11-19 08:25:29,902] [INFO] [<frozen importlib] - Trial 27 pruned.
[2025-11-19 08:25:29,902] [ERROR] [<frozen importlib] - Trial 27 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:   5%|▌         | 27/500 [03:27<1:18:22,  9.94s/it]Best trial: 15. Best value: 0.234562:   5%|▌         | 27/500 [03:27<1:18:22,  9.94s/it]Best trial: 15. Best value: 0.234562:   6%|▌         | 28/500 [03:27<1:00:57,  7.75s/it][2025-11-19 08:25:29,914] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.016878181274748
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   gamma: 0.019817487756180696
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   alpha: 0.5863277213789403
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   lambda: 3.318599149389019
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   learning_rate: 0.07574429815807408
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   subsample: 0.840110601038596
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   colsample_bytree: 0.6819273770635983
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9598482300597748
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   colsample_bynode: 0.6958022451045883
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:25:29,914] [INFO] [<frozen importlib] -   scale_pos_weight: 10.016878181274748
[2025-11-19 08:25:29,996] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:25:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:25:29,902] Trial 27 pruned. 
[0]	train-logloss:0.84216	train-auc:0.65723	train-aucpr:0.22846	val-logloss:0.84325	val-auc:0.64021	val-aucpr:0.13293
[10]	train-logloss:0.79234	train-auc:0.68971	train-aucpr:0.29420	val-logloss:0.72444	val-auc:0.68042	val-aucpr:0.19165
[20]	train-logloss:0.77237	train-auc:0.69752	train-aucpr:0.30621	val-logloss:0.66434	val-auc:0.69427	val-aucpr:0.20984
[30]	train-logloss:0.75987	train-auc:0.70718	train-aucpr:0.31705	val-logloss:0.63299	val-auc:0.70164	val-aucpr:0.21127
[40]	train-logloss:0.75054	train-auc:0.71634	train-aucpr:0.32661	val-logloss:0.61640	val-auc:0.69257	val-aucpr:0.19972
[50]	train-logloss:0.74336	train-auc:0.72479	train-aucpr:0.33469	val-logloss:0.59870	val-auc:0.68587	val-aucpr:0.19627
[53]	train-logloss:0.74175	train-auc:0.72646	train-aucpr:0.33651	val-logloss:0.59362	val-auc:0.68404	val-aucpr:0.19345
[2025-11-19 08:25:30,192] [INFO] [<frozen importlib] - Training completed at iteration 23
[2025-11-19 08:25:30,192] [INFO] [<frozen importlib] - Best train loss: 0.7688
[2025-11-19 08:25:30,192] [INFO] [<frozen importlib] - Best val loss: 0.6585
[2025-11-19 08:25:30,192] [INFO] [<frozen importlib] - Best val AUC: 0.6968
[2025-11-19 08:25:30,192] [INFO] [<frozen importlib] - Best val AUCPR: 0.2163
[2025-11-19 08:25:30,195] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:25:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:25:34,328] [INFO] [<frozen importlib] - Optimal threshold: 0.5918
[2025-11-19 08:25:34,328] [INFO] [<frozen importlib] - Best f1: 0.2688
[2025-11-19 08:25:34,328] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:25:34,379] [INFO] [<frozen importlib] - Validation Results (threshold=0.5918):
[2025-11-19 08:25:34,380] [INFO] [<frozen importlib] -   Accuracy: 0.8932
[2025-11-19 08:25:34,380] [INFO] [<frozen importlib] -   Precision: 0.2836
[2025-11-19 08:25:34,380] [INFO] [<frozen importlib] -   Recall: 0.2555
[2025-11-19 08:25:34,380] [INFO] [<frozen importlib] -   F1 Score: 0.2688
[2025-11-19 08:25:34,380] [INFO] [<frozen importlib] -   AUROC: 0.6968
[2025-11-19 08:25:34,380] [INFO] [<frozen importlib] -   AUPRC: 0.2163
[2025-11-19 08:25:34,380] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:25:34,380] [INFO] [<frozen importlib] -     TN=16508, FP=937
[2025-11-19 08:25:34,380] [INFO] [<frozen importlib] -     FN=1081, TP=371
[2025-11-19 08:25:34,406] [INFO] [<frozen importlib] - Trial 28: AUPRC=0.2163, F1=0.4391, Prec=0.4177, Rec=0.4628 | Optimizing auprc=0.2163
                                                                                        Best trial: 15. Best value: 0.234562:   6%|▌         | 28/500 [03:32<1:00:57,  7.75s/it]Best trial: 15. Best value: 0.234562:   6%|▌         | 28/500 [03:32<1:00:57,  7.75s/it]Best trial: 15. Best value: 0.234562:   6%|▌         | 29/500 [03:32<53:11,  6.78s/it]  [2025-11-19 08:25:34,419] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 18.94413998272391
[2025-11-19 08:25:34,419] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:25:34,419] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:25:34,419] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:25:34,419] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:25:34,419] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:25:34,419] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:25:34,419] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:25:34,419] [INFO] [<frozen importlib] -   min_child_weight: 10
[2025-11-19 08:25:34,419] [INFO] [<frozen importlib] -   gamma: 0.7775356813126784
[2025-11-19 08:25:34,419] [INFO] [<frozen importlib] -   alpha: 0.2762500604389202
[2025-11-19 08:25:34,419] [INFO] [<frozen importlib] -   lambda: 0.6017149893511411
[2025-11-19 08:25:34,420] [INFO] [<frozen importlib] -   learning_rate: 0.0989742992733006
[2025-11-19 08:25:34,420] [INFO] [<frozen importlib] -   subsample: 0.8975043928167049
[2025-11-19 08:25:34,420] [INFO] [<frozen importlib] -   colsample_bytree: 0.8458429652599146
[2025-11-19 08:25:34,420] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8541827935110682
[2025-11-19 08:25:34,420] [INFO] [<frozen importlib] -   colsample_bynode: 0.7527569063134162
[2025-11-19 08:25:34,420] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:25:34,420] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:25:34,420] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:25:34,420] [INFO] [<frozen importlib] -   scale_pos_weight: 18.94413998272391
[2025-11-19 08:25:34,509] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:25:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:25:34,406] Trial 28 finished with value: 0.21626801855669803 and parameters: {'max_depth': 4, 'min_child_weight': 4, 'gamma': 0.019817487756180696, 'learning_rate': 0.07574429815807408, 'n_estimators': 350, 'alpha': 0.5863277213789403, 'lambda': 3.318599149389019, 'subsample': 0.840110601038596, 'colsample_bytree': 0.6819273770635983, 'colsample_bylevel': 0.9598482300597748, 'colsample_bynode': 0.6958022451045883, 'scale_pos_weight': 10.016878181274748}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:1.13365	train-auc:0.65296	train-aucpr:0.22462	val-logloss:1.15272	val-auc:0.61157	val-aucpr:0.10416
[10]	train-logloss:1.07706	train-auc:0.69218	train-aucpr:0.29496	val-logloss:0.90781	val-auc:0.68050	val-aucpr:0.19445
[20]	train-logloss:1.05572	train-auc:0.70599	train-aucpr:0.30939	val-logloss:0.85378	val-auc:0.69303	val-aucpr:0.19538
[30]	train-logloss:1.04255	train-auc:0.71850	train-aucpr:0.32403	val-logloss:0.83080	val-auc:0.68460	val-aucpr:0.18972
[40]	train-logloss:1.03174	train-auc:0.72694	train-aucpr:0.33403	val-logloss:0.78480	val-auc:0.64962	val-aucpr:0.13602
[46]	train-logloss:1.02421	train-auc:0.73356	train-aucpr:0.33923	val-logloss:0.79113	val-auc:0.65268	val-aucpr:0.13701
[2025-11-19 08:25:34,683] [INFO] [<frozen importlib] - Training completed at iteration 16
[2025-11-19 08:25:34,683] [INFO] [<frozen importlib] - Best train loss: 1.0653
[2025-11-19 08:25:34,683] [INFO] [<frozen importlib] - Best val loss: 0.8566
[2025-11-19 08:25:34,683] [INFO] [<frozen importlib] - Best val AUC: 0.6938
[2025-11-19 08:25:34,683] [INFO] [<frozen importlib] - Best val AUCPR: 0.2112
[2025-11-19 08:25:34,686] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:25:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:25:37,264] [INFO] [<frozen importlib] - Optimal threshold: 0.7033
[2025-11-19 08:25:37,264] [INFO] [<frozen importlib] - Best f1: 0.2492
[2025-11-19 08:25:37,264] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:25:37,334] [INFO] [<frozen importlib] - Validation Results (threshold=0.7033):
[2025-11-19 08:25:37,334] [INFO] [<frozen importlib] -   Accuracy: 0.8817
[2025-11-19 08:25:37,334] [INFO] [<frozen importlib] -   Precision: 0.2433
[2025-11-19 08:25:37,334] [INFO] [<frozen importlib] -   Recall: 0.2555
[2025-11-19 08:25:37,334] [INFO] [<frozen importlib] -   F1 Score: 0.2492
[2025-11-19 08:25:37,334] [INFO] [<frozen importlib] -   AUROC: 0.6938
[2025-11-19 08:25:37,334] [INFO] [<frozen importlib] -   AUPRC: 0.2106
[2025-11-19 08:25:37,334] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:25:37,334] [INFO] [<frozen importlib] -     TN=16291, FP=1154
[2025-11-19 08:25:37,334] [INFO] [<frozen importlib] -     FN=1081, TP=371
[2025-11-19 08:25:37,364] [INFO] [<frozen importlib] - Trial 29: AUPRC=0.2106, F1=0.4395, Prec=0.3888, Rec=0.5055 | Optimizing auprc=0.2106
                                                                                      Best trial: 15. Best value: 0.234562:   6%|▌         | 29/500 [03:35<53:11,  6.78s/it]Best trial: 15. Best value: 0.234562:   6%|▌         | 29/500 [03:35<53:11,  6.78s/it]Best trial: 15. Best value: 0.234562:   6%|▌         | 30/500 [03:35<44:06,  5.63s/it][2025-11-19 08:25:37,377] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 15.759300932894574
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   gamma: 0.6070801689765557
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   alpha: 0.8253281220832147
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   lambda: 2.7611076011923723
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   learning_rate: 0.036264337017122485
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   subsample: 0.6523790762424087
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   colsample_bytree: 0.8002008468071908
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7928963337438807
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   colsample_bynode: 0.8567864225072155
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:25:37,378] [INFO] [<frozen importlib] -   scale_pos_weight: 15.759300932894574
[2025-11-19 08:25:37,460] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:25:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:25:37,364] Trial 29 finished with value: 0.21063154136957643 and parameters: {'max_depth': 4, 'min_child_weight': 10, 'gamma': 0.7775356813126784, 'learning_rate': 0.0989742992733006, 'n_estimators': 150, 'alpha': 0.2762500604389202, 'lambda': 0.6017149893511411, 'subsample': 0.8975043928167049, 'colsample_bytree': 0.8458429652599146, 'colsample_bylevel': 0.8541827935110682, 'colsample_bynode': 0.7527569063134162, 'scale_pos_weight': 18.94413998272391}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:1.05776	train-auc:0.65333	train-aucpr:0.23566	val-logloss:1.09088	val-auc:0.59016	val-aucpr:0.10000
[10]	train-logloss:1.01925	train-auc:0.67993	train-aucpr:0.27747	val-logloss:0.97738	val-auc:0.66931	val-aucpr:0.17735
[20]	train-logloss:0.99896	train-auc:0.68932	train-aucpr:0.29258	val-logloss:0.90927	val-auc:0.68135	val-aucpr:0.19034
[30]	train-logloss:0.98573	train-auc:0.69613	train-aucpr:0.30036	val-logloss:0.87734	val-auc:0.68797	val-aucpr:0.20014
[40]	train-logloss:0.97622	train-auc:0.70116	train-aucpr:0.30378	val-logloss:0.84305	val-auc:0.69079	val-aucpr:0.20074
[50]	train-logloss:0.96780	train-auc:0.70598	train-aucpr:0.30853	val-logloss:0.82329	val-auc:0.68846	val-aucpr:0.19510
[56]	train-logloss:0.96371	train-auc:0.70775	train-aucpr:0.31218	val-logloss:0.80579	val-auc:0.69484	val-aucpr:0.20168
[2025-11-19 08:25:37,663] [INFO] [<frozen importlib] - Training completed at iteration 26
[2025-11-19 08:25:37,663] [INFO] [<frozen importlib] - Best train loss: 0.9907
[2025-11-19 08:25:37,663] [INFO] [<frozen importlib] - Best val loss: 0.8847
[2025-11-19 08:25:37,663] [INFO] [<frozen importlib] - Best val AUC: 0.6873
[2025-11-19 08:25:37,663] [INFO] [<frozen importlib] - Best val AUCPR: 0.2045
[2025-11-19 08:25:37,666] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:25:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:25:41,474] [INFO] [<frozen importlib] - Optimal threshold: 0.6829
[2025-11-19 08:25:41,474] [INFO] [<frozen importlib] - Best f1: 0.2530
[2025-11-19 08:25:41,474] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:25:41,523] [INFO] [<frozen importlib] - Validation Results (threshold=0.6829):
[2025-11-19 08:25:41,523] [INFO] [<frozen importlib] -   Accuracy: 0.8891
[2025-11-19 08:25:41,523] [INFO] [<frozen importlib] -   Precision: 0.2622
[2025-11-19 08:25:41,523] [INFO] [<frozen importlib] -   Recall: 0.2445
[2025-11-19 08:25:41,523] [INFO] [<frozen importlib] -   F1 Score: 0.2530
[2025-11-19 08:25:41,523] [INFO] [<frozen importlib] -   AUROC: 0.6873
[2025-11-19 08:25:41,523] [INFO] [<frozen importlib] -   AUPRC: 0.2037
[2025-11-19 08:25:41,523] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:25:41,523] [INFO] [<frozen importlib] -     TN=16446, FP=999
[2025-11-19 08:25:41,523] [INFO] [<frozen importlib] -     FN=1097, TP=355
[2025-11-19 08:25:41,550] [INFO] [<frozen importlib] - Trial 30: AUPRC=0.2037, F1=0.4359, Prec=0.4061, Rec=0.4704 | Optimizing auprc=0.2037
                                                                                      Best trial: 15. Best value: 0.234562:   6%|▌         | 30/500 [03:39<44:06,  5.63s/it]Best trial: 15. Best value: 0.234562:   6%|▌         | 30/500 [03:39<44:06,  5.63s/it]Best trial: 15. Best value: 0.234562:   6%|▌         | 31/500 [03:39<40:37,  5.20s/it][2025-11-19 08:25:41,561] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 13.032675224070028
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   gamma: 0.6924668438170574
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   alpha: 0.9910904534371809
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   lambda: 0.15126968090514803
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   learning_rate: 0.06668780874176436
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   subsample: 0.9983160286470929
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   colsample_bytree: 0.5444015003735464
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8327988623097949
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   colsample_bynode: 0.665477925192949
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:25:41,561] [INFO] [<frozen importlib] -   scale_pos_weight: 13.032675224070028
[2025-11-19 08:25:41,644] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:25:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:25:41,550] Trial 30 finished with value: 0.20366911686622635 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.6070801689765557, 'learning_rate': 0.036264337017122485, 'n_estimators': 250, 'alpha': 0.8253281220832147, 'lambda': 2.7611076011923723, 'subsample': 0.6523790762424087, 'colsample_bytree': 0.8002008468071908, 'colsample_bylevel': 0.7928963337438807, 'colsample_bynode': 0.8567864225072155, 'scale_pos_weight': 15.759300932894574}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.96594	train-auc:0.63434	train-aucpr:0.20779	val-logloss:0.98439	val-auc:0.62418	val-aucpr:0.12659
[10]	train-logloss:0.92453	train-auc:0.66894	train-aucpr:0.26972	val-logloss:0.85598	val-auc:0.65704	val-aucpr:0.17043
[20]	train-logloss:0.90637	train-auc:0.67601	train-aucpr:0.28149	val-logloss:0.80819	val-auc:0.65611	val-aucpr:0.17249
[30]	train-logloss:0.89509	train-auc:0.68585	train-aucpr:0.28599	val-logloss:0.77369	val-auc:0.66826	val-aucpr:0.19118
[40]	train-logloss:0.88763	train-auc:0.69093	train-aucpr:0.29521	val-logloss:0.73817	val-auc:0.68489	val-aucpr:0.19886
[50]	train-logloss:0.88081	train-auc:0.69571	train-aucpr:0.30131	val-logloss:0.73280	val-auc:0.68875	val-aucpr:0.20997
[60]	train-logloss:0.87558	train-auc:0.70172	train-aucpr:0.30635	val-logloss:0.69678	val-auc:0.68899	val-aucpr:0.20599
[70]	train-logloss:0.87132	train-auc:0.70595	train-aucpr:0.30971	val-logloss:0.68687	val-auc:0.68305	val-aucpr:0.19984
[80]	train-logloss:0.86779	train-auc:0.70894	train-aucpr:0.31503	val-logloss:0.67231	val-auc:0.67468	val-aucpr:0.17826
[81]	train-logloss:0.86739	train-auc:0.70930	train-aucpr:0.31539	val-logloss:0.67598	val-auc:0.67215	val-aucpr:0.17368
[2025-11-19 08:25:41,841] [INFO] [<frozen importlib] - Training completed at iteration 51
[2025-11-19 08:25:41,841] [INFO] [<frozen importlib] - Best train loss: 0.8801
[2025-11-19 08:25:41,841] [INFO] [<frozen importlib] - Best val loss: 0.7302
[2025-11-19 08:25:41,841] [INFO] [<frozen importlib] - Best val AUC: 0.6911
[2025-11-19 08:25:41,841] [INFO] [<frozen importlib] - Best val AUCPR: 0.2107
[2025-11-19 08:25:41,844] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:25:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:25:49,431] [INFO] [<frozen importlib] - Optimal threshold: 0.6519
[2025-11-19 08:25:49,431] [INFO] [<frozen importlib] - Best f1: 0.2567
[2025-11-19 08:25:49,431] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:25:49,484] [INFO] [<frozen importlib] - Validation Results (threshold=0.6519):
[2025-11-19 08:25:49,484] [INFO] [<frozen importlib] -   Accuracy: 0.9044
[2025-11-19 08:25:49,484] [INFO] [<frozen importlib] -   Precision: 0.3187
[2025-11-19 08:25:49,484] [INFO] [<frozen importlib] -   Recall: 0.2149
[2025-11-19 08:25:49,484] [INFO] [<frozen importlib] -   F1 Score: 0.2567
[2025-11-19 08:25:49,484] [INFO] [<frozen importlib] -   AUROC: 0.6911
[2025-11-19 08:25:49,484] [INFO] [<frozen importlib] -   AUPRC: 0.2110
[2025-11-19 08:25:49,484] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:25:49,484] [INFO] [<frozen importlib] -     TN=16778, FP=667
[2025-11-19 08:25:49,484] [INFO] [<frozen importlib] -     FN=1140, TP=312
[2025-11-19 08:25:49,508] [INFO] [<frozen importlib] - Trial 31: AUPRC=0.2110, F1=0.4516, Prec=0.4809, Rec=0.4256 | Optimizing auprc=0.2110
                                                                                      Best trial: 15. Best value: 0.234562:   6%|▌         | 31/500 [03:47<40:37,  5.20s/it]Best trial: 15. Best value: 0.234562:   6%|▌         | 31/500 [03:47<40:37,  5.20s/it]Best trial: 15. Best value: 0.234562:   6%|▋         | 32/500 [03:47<46:59,  6.03s/it][2025-11-19 08:25:49,516] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 12.413423960353446
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   gamma: 0.9026069357611998
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   alpha: 1.1114943918935707
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   lambda: 0.42292220035225353
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   learning_rate: 0.07076976992007218
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   subsample: 0.9427377755403673
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   colsample_bytree: 0.9987230060112434
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8863307604962395
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   colsample_bynode: 0.6294238968644537
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:25:49,516] [INFO] [<frozen importlib] -   scale_pos_weight: 12.413423960353446
[2025-11-19 08:25:49,605] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:25:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:25:49,508] Trial 31 finished with value: 0.21100591093803958 and parameters: {'max_depth': 3, 'min_child_weight': 1, 'gamma': 0.6924668438170574, 'learning_rate': 0.06668780874176436, 'n_estimators': 150, 'alpha': 0.9910904534371809, 'lambda': 0.15126968090514803, 'subsample': 0.9983160286470929, 'colsample_bytree': 0.5444015003735464, 'colsample_bylevel': 0.8327988623097949, 'colsample_bynode': 0.665477925192949, 'scale_pos_weight': 13.032675224070028}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.94170	train-auc:0.63937	train-aucpr:0.20631	val-logloss:0.95691	val-auc:0.57513	val-aucpr:0.08977
[10]	train-logloss:0.89906	train-auc:0.66744	train-aucpr:0.26621	val-logloss:0.82896	val-auc:0.63337	val-aucpr:0.11081
[20]	train-logloss:0.88085	train-auc:0.67916	train-aucpr:0.27697	val-logloss:0.75495	val-auc:0.66048	val-aucpr:0.19089
[30]	train-logloss:0.87025	train-auc:0.68502	train-aucpr:0.28546	val-logloss:0.71460	val-auc:0.69019	val-aucpr:0.21291
[40]	train-logloss:0.86166	train-auc:0.69532	train-aucpr:0.29478	val-logloss:0.70918	val-auc:0.69517	val-aucpr:0.20727
[50]	train-logloss:0.85594	train-auc:0.69985	train-aucpr:0.30134	val-logloss:0.69317	val-auc:0.69363	val-aucpr:0.20261
[60]	train-logloss:0.85076	train-auc:0.70504	train-aucpr:0.30684	val-logloss:0.66760	val-auc:0.68336	val-aucpr:0.19088
[61]	train-logloss:0.85028	train-auc:0.70559	train-aucpr:0.30727	val-logloss:0.66379	val-auc:0.67362	val-aucpr:0.17384
[2025-11-19 08:25:49,769] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 08:25:49,769] [INFO] [<frozen importlib] - Best train loss: 0.8687
[2025-11-19 08:25:49,769] [INFO] [<frozen importlib] - Best val loss: 0.7144
[2025-11-19 08:25:49,769] [INFO] [<frozen importlib] - Best val AUC: 0.6937
[2025-11-19 08:25:49,769] [INFO] [<frozen importlib] - Best val AUCPR: 0.2152
[2025-11-19 08:25:49,772] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:25:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:25:53,289] [INFO] [<frozen importlib] - Optimal threshold: 0.6300
[2025-11-19 08:25:53,289] [INFO] [<frozen importlib] - Best f1: 0.2603
[2025-11-19 08:25:53,289] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:25:53,334] [INFO] [<frozen importlib] - Validation Results (threshold=0.6300):
[2025-11-19 08:25:53,334] [INFO] [<frozen importlib] -   Accuracy: 0.8917
[2025-11-19 08:25:53,334] [INFO] [<frozen importlib] -   Precision: 0.2740
[2025-11-19 08:25:53,334] [INFO] [<frozen importlib] -   Recall: 0.2479
[2025-11-19 08:25:53,334] [INFO] [<frozen importlib] -   F1 Score: 0.2603
[2025-11-19 08:25:53,334] [INFO] [<frozen importlib] -   AUROC: 0.6937
[2025-11-19 08:25:53,335] [INFO] [<frozen importlib] -   AUPRC: 0.2142
[2025-11-19 08:25:53,335] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:25:53,335] [INFO] [<frozen importlib] -     TN=16491, FP=954
[2025-11-19 08:25:53,335] [INFO] [<frozen importlib] -     FN=1092, TP=360
[2025-11-19 08:25:53,366] [INFO] [<frozen importlib] - Trial 32: AUPRC=0.2142, F1=0.4305, Prec=0.4089, Rec=0.4545 | Optimizing auprc=0.2142
                                                                                      Best trial: 15. Best value: 0.234562:   6%|▋         | 32/500 [03:51<46:59,  6.03s/it]Best trial: 15. Best value: 0.234562:   6%|▋         | 32/500 [03:51<46:59,  6.03s/it]Best trial: 15. Best value: 0.234562:   7%|▋         | 33/500 [03:51<41:50,  5.38s/it][2025-11-19 08:25:53,380] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 13.748017037391671
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   gamma: 0.7715560221895644
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   alpha: 1.308890656714793
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   lambda: 0.9611958900479867
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   learning_rate: 0.06261069569590733
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   subsample: 0.9158815274900909
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   colsample_bytree: 0.5295548633087629
[2025-11-19 08:25:53,380] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8219619555334422
[2025-11-19 08:25:53,381] [INFO] [<frozen importlib] -   colsample_bynode: 0.541422198773366
[2025-11-19 08:25:53,381] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:25:53,381] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:25:53,381] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:25:53,381] [INFO] [<frozen importlib] -   scale_pos_weight: 13.748017037391671
[2025-11-19 08:25:53,471] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:25:53] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:25:53,366] Trial 32 finished with value: 0.21422217089096005 and parameters: {'max_depth': 3, 'min_child_weight': 2, 'gamma': 0.9026069357611998, 'learning_rate': 0.07076976992007218, 'n_estimators': 100, 'alpha': 1.1114943918935707, 'lambda': 0.42292220035225353, 'subsample': 0.9427377755403673, 'colsample_bytree': 0.9987230060112434, 'colsample_bylevel': 0.8863307604962395, 'colsample_bynode': 0.6294238968644537, 'scale_pos_weight': 12.413423960353446}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.99096	train-auc:0.63644	train-aucpr:0.21003	val-logloss:1.00713	val-auc:0.62147	val-aucpr:0.11018
[10]	train-logloss:0.95338	train-auc:0.66596	train-aucpr:0.25665	val-logloss:0.90530	val-auc:0.68694	val-aucpr:0.17152
[20]	train-logloss:0.93374	train-auc:0.67881	train-aucpr:0.27848	val-logloss:0.84169	val-auc:0.69922	val-aucpr:0.20694
[30]	train-logloss:0.92314	train-auc:0.68555	train-aucpr:0.28332	val-logloss:0.79273	val-auc:0.69970	val-aucpr:0.21262
[40]	train-logloss:0.91520	train-auc:0.69032	train-aucpr:0.29321	val-logloss:0.78354	val-auc:0.68731	val-aucpr:0.20566
[50]	train-logloss:0.90870	train-auc:0.69432	train-aucpr:0.29776	val-logloss:0.77516	val-auc:0.68839	val-aucpr:0.21013
[58]	train-logloss:0.90528	train-auc:0.69733	train-aucpr:0.30014	val-logloss:0.76209	val-auc:0.69227	val-aucpr:0.21006
[2025-11-19 08:25:53,641] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:25:53,641] [INFO] [<frozen importlib] - Best train loss: 0.9240
[2025-11-19 08:25:53,641] [INFO] [<frozen importlib] - Best val loss: 0.8021
[2025-11-19 08:25:53,641] [INFO] [<frozen importlib] - Best val AUC: 0.7028
[2025-11-19 08:25:53,641] [INFO] [<frozen importlib] - Best val AUCPR: 0.2170
[2025-11-19 08:25:53,644] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:25:53] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:25:59,471] [INFO] [<frozen importlib] - Optimal threshold: 0.6506
[2025-11-19 08:25:59,471] [INFO] [<frozen importlib] - Best f1: 0.2744
[2025-11-19 08:25:59,471] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:25:59,520] [INFO] [<frozen importlib] - Validation Results (threshold=0.6506):
[2025-11-19 08:25:59,520] [INFO] [<frozen importlib] -   Accuracy: 0.8981
[2025-11-19 08:25:59,520] [INFO] [<frozen importlib] -   Precision: 0.3031
[2025-11-19 08:25:59,520] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 08:25:59,520] [INFO] [<frozen importlib] -   F1 Score: 0.2744
[2025-11-19 08:25:59,520] [INFO] [<frozen importlib] -   AUROC: 0.7028
[2025-11-19 08:25:59,520] [INFO] [<frozen importlib] -   AUPRC: 0.2174
[2025-11-19 08:25:59,520] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:25:59,520] [INFO] [<frozen importlib] -     TN=16608, FP=837
[2025-11-19 08:25:59,520] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 08:25:59,544] [INFO] [<frozen importlib] - Trial 33: AUPRC=0.2174, F1=0.4413, Prec=0.4364, Rec=0.4463 | Optimizing auprc=0.2174
                                                                                      Best trial: 15. Best value: 0.234562:   7%|▋         | 33/500 [03:57<41:50,  5.38s/it]Best trial: 15. Best value: 0.234562:   7%|▋         | 33/500 [03:57<41:50,  5.38s/it]Best trial: 15. Best value: 0.234562:   7%|▋         | 34/500 [03:57<43:37,  5.62s/it][2025-11-19 08:25:59,558] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 17.326395737002183
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   gamma: 0.8988157348775014
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   alpha: 1.0601195515468889
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   lambda: 1.3777434706727385
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   learning_rate: 0.07755798883462012
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   subsample: 0.963430050187731
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   colsample_bytree: 0.6037197781272291
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7456384103951406
[2025-11-19 08:25:59,558] [INFO] [<frozen importlib] -   colsample_bynode: 0.5726203879409152
[2025-11-19 08:25:59,559] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:25:59,559] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:25:59,559] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:25:59,559] [INFO] [<frozen importlib] -   scale_pos_weight: 17.326395737002183
[2025-11-19 08:25:59,653] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:25:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:25:59,545] Trial 33 finished with value: 0.21736663030722267 and parameters: {'max_depth': 3, 'min_child_weight': 1, 'gamma': 0.7715560221895644, 'learning_rate': 0.06261069569590733, 'n_estimators': 150, 'alpha': 1.308890656714793, 'lambda': 0.9611958900479867, 'subsample': 0.9158815274900909, 'colsample_bytree': 0.5295548633087629, 'colsample_bylevel': 0.8219619555334422, 'colsample_bynode': 0.541422198773366, 'scale_pos_weight': 13.748017037391671}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:1.09319	train-auc:0.67145	train-aucpr:0.25224	val-logloss:1.11666	val-auc:0.56992	val-aucpr:0.10697
[10]	train-logloss:1.03070	train-auc:0.70926	train-aucpr:0.31281	val-logloss:0.93577	val-auc:0.67677	val-aucpr:0.18108
[20]	train-logloss:1.00533	train-auc:0.71926	train-aucpr:0.32967	val-logloss:0.87188	val-auc:0.69169	val-aucpr:0.19998
[30]	train-logloss:0.98982	train-auc:0.72795	train-aucpr:0.34057	val-logloss:0.83072	val-auc:0.69136	val-aucpr:0.19608
[40]	train-logloss:0.97602	train-auc:0.73965	train-aucpr:0.35179	val-logloss:0.76511	val-auc:0.65753	val-aucpr:0.15669
[50]	train-logloss:0.96432	train-auc:0.74997	train-aucpr:0.36331	val-logloss:0.62992	val-auc:0.64159	val-aucpr:0.11281
[2025-11-19 08:25:59,884] [INFO] [<frozen importlib] - Training completed at iteration 21
[2025-11-19 08:25:59,884] [INFO] [<frozen importlib] - Best train loss: 1.0038
[2025-11-19 08:25:59,884] [INFO] [<frozen importlib] - Best val loss: 0.8626
[2025-11-19 08:25:59,884] [INFO] [<frozen importlib] - Best val AUC: 0.6943
[2025-11-19 08:25:59,884] [INFO] [<frozen importlib] - Best val AUCPR: 0.2021
[2025-11-19 08:25:59,887] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:25:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:26:09,059] [INFO] [<frozen importlib] - Optimal threshold: 0.7013
[2025-11-19 08:26:09,059] [INFO] [<frozen importlib] - Best f1: 0.2523
[2025-11-19 08:26:09,059] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:26:09,103] [INFO] [<frozen importlib] - Validation Results (threshold=0.7013):
[2025-11-19 08:26:09,104] [INFO] [<frozen importlib] -   Accuracy: 0.9015
[2025-11-19 08:26:09,104] [INFO] [<frozen importlib] -   Precision: 0.3028
[2025-11-19 08:26:09,104] [INFO] [<frozen importlib] -   Recall: 0.2163
[2025-11-19 08:26:09,104] [INFO] [<frozen importlib] -   F1 Score: 0.2523
[2025-11-19 08:26:09,104] [INFO] [<frozen importlib] -   AUROC: 0.6943
[2025-11-19 08:26:09,104] [INFO] [<frozen importlib] -   AUPRC: 0.2027
[2025-11-19 08:26:09,104] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:26:09,104] [INFO] [<frozen importlib] -     TN=16722, FP=723
[2025-11-19 08:26:09,104] [INFO] [<frozen importlib] -     FN=1138, TP=314
[2025-11-19 08:26:09,136] [INFO] [<frozen importlib] - Trial 34: AUPRC=0.2027, F1=0.4661, Prec=0.4776, Rec=0.4552 | Optimizing auprc=0.2027
                                                                                      Best trial: 15. Best value: 0.234562:   7%|▋         | 34/500 [04:07<43:37,  5.62s/it]Best trial: 15. Best value: 0.234562:   7%|▋         | 34/500 [04:07<43:37,  5.62s/it]Best trial: 15. Best value: 0.234562:   7%|▋         | 35/500 [04:07<52:46,  6.81s/it][2025-11-19 08:26:09,150] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 19.926281597379322
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   gamma: 0.19144059131830665
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   alpha: 0.8677964379892359
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   lambda: 0.48264463877843133
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   learning_rate: 0.052377330230858735
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   subsample: 0.8784534992810362
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   colsample_bytree: 0.6510844752038725
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5370336425978744
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   colsample_bynode: 0.6679931200031002
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:26:09,151] [INFO] [<frozen importlib] -   scale_pos_weight: 19.926281597379322
[2025-11-19 08:26:09,245] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:26:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:26:09,137] Trial 34 finished with value: 0.20273913668372828 and parameters: {'max_depth': 5, 'min_child_weight': 2, 'gamma': 0.8988157348775014, 'learning_rate': 0.07755798883462012, 'n_estimators': 200, 'alpha': 1.0601195515468889, 'lambda': 1.3777434706727385, 'subsample': 0.963430050187731, 'colsample_bytree': 0.6037197781272291, 'colsample_bylevel': 0.7456384103951406, 'colsample_bynode': 0.5726203879409152, 'scale_pos_weight': 17.326395737002183}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:1.16722	train-auc:0.62466	train-aucpr:0.19632	val-logloss:1.20528	val-auc:0.61570	val-aucpr:0.10392
[10]	train-logloss:1.13539	train-auc:0.67088	train-aucpr:0.25468	val-logloss:1.09347	val-auc:0.66082	val-aucpr:0.16098
[20]	train-logloss:1.12189	train-auc:0.67857	train-aucpr:0.26771	val-logloss:1.01459	val-auc:0.69322	val-aucpr:0.19155
[30]	train-logloss:1.11299	train-auc:0.68227	train-aucpr:0.28022	val-logloss:0.97546	val-auc:0.69194	val-aucpr:0.21423
[40]	train-logloss:1.10638	train-auc:0.68874	train-aucpr:0.28880	val-logloss:0.95103	val-auc:0.69677	val-aucpr:0.20720
[50]	train-logloss:1.10067	train-auc:0.69104	train-aucpr:0.29354	val-logloss:0.94689	val-auc:0.70588	val-aucpr:0.21283
[60]	train-logloss:1.09482	train-auc:0.69739	train-aucpr:0.29868	val-logloss:0.93416	val-auc:0.69665	val-aucpr:0.20507
[2025-11-19 08:26:09,424] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 08:26:09,424] [INFO] [<frozen importlib] - Best train loss: 1.1122
[2025-11-19 08:26:09,424] [INFO] [<frozen importlib] - Best val loss: 0.9681
[2025-11-19 08:26:09,424] [INFO] [<frozen importlib] - Best val AUC: 0.6998
[2025-11-19 08:26:09,424] [INFO] [<frozen importlib] - Best val AUCPR: 0.2154
[2025-11-19 08:26:09,429] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:26:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:26:13,231] [INFO] [<frozen importlib] - Optimal threshold: 0.7239
[2025-11-19 08:26:13,231] [INFO] [<frozen importlib] - Best f1: 0.2578
[2025-11-19 08:26:13,231] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:26:13,282] [INFO] [<frozen importlib] - Validation Results (threshold=0.7239):
[2025-11-19 08:26:13,282] [INFO] [<frozen importlib] -   Accuracy: 0.8922
[2025-11-19 08:26:13,282] [INFO] [<frozen importlib] -   Precision: 0.2736
[2025-11-19 08:26:13,282] [INFO] [<frozen importlib] -   Recall: 0.2438
[2025-11-19 08:26:13,282] [INFO] [<frozen importlib] -   F1 Score: 0.2578
[2025-11-19 08:26:13,282] [INFO] [<frozen importlib] -   AUROC: 0.6998
[2025-11-19 08:26:13,282] [INFO] [<frozen importlib] -   AUPRC: 0.2137
[2025-11-19 08:26:13,282] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:26:13,282] [INFO] [<frozen importlib] -     TN=16505, FP=940
[2025-11-19 08:26:13,282] [INFO] [<frozen importlib] -     FN=1098, TP=354
[2025-11-19 08:26:13,308] [INFO] [<frozen importlib] - Trial 35: AUPRC=0.2137, F1=0.4392, Prec=0.4172, Rec=0.4635 | Optimizing auprc=0.2137
                                                                                      Best trial: 15. Best value: 0.234562:   7%|▋         | 35/500 [04:11<52:46,  6.81s/it]Best trial: 15. Best value: 0.234562:   7%|▋         | 35/500 [04:11<52:46,  6.81s/it]Best trial: 15. Best value: 0.234562:   7%|▋         | 36/500 [04:11<46:32,  6.02s/it][2025-11-19 08:26:13,322] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.857854639044012
[2025-11-19 08:26:13,322] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:26:13,322] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:26:13,322] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:26:13,322] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:26:13,322] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:26:13,322] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   gamma: 0.6785320356874758
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   alpha: 1.5001523081246835
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   lambda: 2.1953916777959357
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   learning_rate: 0.04121462298840779
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   subsample: 0.9544385829407518
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   colsample_bytree: 0.5349810098077536
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9680016551454987
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   colsample_bynode: 0.6847219541302161
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:26:13,323] [INFO] [<frozen importlib] -   scale_pos_weight: 11.857854639044012
[2025-11-19 08:26:13,408] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:26:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:26:13,309] Trial 35 finished with value: 0.2136785495971449 and parameters: {'max_depth': 3, 'min_child_weight': 3, 'gamma': 0.19144059131830665, 'learning_rate': 0.052377330230858735, 'n_estimators': 150, 'alpha': 0.8677964379892359, 'lambda': 0.48264463877843133, 'subsample': 0.8784534992810362, 'colsample_bytree': 0.6510844752038725, 'colsample_bylevel': 0.5370336425978744, 'colsample_bynode': 0.6679931200031002, 'scale_pos_weight': 19.926281597379322}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.92311	train-auc:0.66010	train-aucpr:0.23237	val-logloss:0.93774	val-auc:0.65355	val-aucpr:0.13858
[10]	train-logloss:0.88630	train-auc:0.68245	train-aucpr:0.28744	val-logloss:0.84084	val-auc:0.68866	val-aucpr:0.18819
[20]	train-logloss:0.86570	train-auc:0.68798	train-aucpr:0.29859	val-logloss:0.77763	val-auc:0.69910	val-aucpr:0.20602
[30]	train-logloss:0.85179	train-auc:0.69616	train-aucpr:0.30520	val-logloss:0.73774	val-auc:0.69946	val-aucpr:0.21811
[40]	train-logloss:0.84261	train-auc:0.69941	train-aucpr:0.30905	val-logloss:0.70648	val-auc:0.69998	val-aucpr:0.22220
[50]	train-logloss:0.83500	train-auc:0.70462	train-aucpr:0.31307	val-logloss:0.70234	val-auc:0.70433	val-aucpr:0.21927
[60]	train-logloss:0.82984	train-auc:0.70838	train-aucpr:0.31720	val-logloss:0.68989	val-auc:0.69952	val-aucpr:0.21617
[70]	train-logloss:0.82452	train-auc:0.71350	train-aucpr:0.32313	val-logloss:0.68002	val-auc:0.68425	val-aucpr:0.19990
[72]	train-logloss:0.82356	train-auc:0.71457	train-aucpr:0.32412	val-logloss:0.67774	val-auc:0.68405	val-aucpr:0.20024
[2025-11-19 08:26:13,641] [INFO] [<frozen importlib] - Training completed at iteration 43
[2025-11-19 08:26:13,641] [INFO] [<frozen importlib] - Best train loss: 0.8404
[2025-11-19 08:26:13,641] [INFO] [<frozen importlib] - Best val loss: 0.7039
[2025-11-19 08:26:13,641] [INFO] [<frozen importlib] - Best val AUC: 0.7032
[2025-11-19 08:26:13,641] [INFO] [<frozen importlib] - Best val AUCPR: 0.2226
[2025-11-19 08:26:13,644] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:26:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:26:22,104] [INFO] [<frozen importlib] - Optimal threshold: 0.6138
[2025-11-19 08:26:22,104] [INFO] [<frozen importlib] - Best f1: 0.2690
[2025-11-19 08:26:22,104] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:26:22,152] [INFO] [<frozen importlib] - Validation Results (threshold=0.6138):
[2025-11-19 08:26:22,152] [INFO] [<frozen importlib] -   Accuracy: 0.8901
[2025-11-19 08:26:22,152] [INFO] [<frozen importlib] -   Precision: 0.2752
[2025-11-19 08:26:22,152] [INFO] [<frozen importlib] -   Recall: 0.2631
[2025-11-19 08:26:22,152] [INFO] [<frozen importlib] -   F1 Score: 0.2690
[2025-11-19 08:26:22,152] [INFO] [<frozen importlib] -   AUROC: 0.7032
[2025-11-19 08:26:22,152] [INFO] [<frozen importlib] -   AUPRC: 0.2228
[2025-11-19 08:26:22,152] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:26:22,152] [INFO] [<frozen importlib] -     TN=16439, FP=1006
[2025-11-19 08:26:22,152] [INFO] [<frozen importlib] -     FN=1070, TP=382
[2025-11-19 08:26:22,179] [INFO] [<frozen importlib] - Trial 36: AUPRC=0.2228, F1=0.4369, Prec=0.4058, Rec=0.4731 | Optimizing auprc=0.2228
[2025-11-19 08:26:22,179] [INFO] [<frozen importlib] - Trial 36 pruned.
[2025-11-19 08:26:22,179] [ERROR] [<frozen importlib] - Trial 36 failed with error: 
                                                                                      Best trial: 15. Best value: 0.234562:   7%|▋         | 36/500 [04:20<46:32,  6.02s/it]Best trial: 15. Best value: 0.234562:   7%|▋         | 36/500 [04:20<46:32,  6.02s/it]Best trial: 15. Best value: 0.234562:   7%|▋         | 37/500 [04:20<53:02,  6.87s/it][2025-11-19 08:26:22,193] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.70437420809075
[2025-11-19 08:26:22,193] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:26:22,193] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:26:22,193] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   gamma: 0.7554679300987973
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   alpha: 0.6759754643820219
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   lambda: 1.8397658605362075
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   learning_rate: 0.09186317218103296
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   subsample: 0.8413558489141085
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   colsample_bytree: 0.7682348289154783
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   colsample_bylevel: 0.913549978893499
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   colsample_bynode: 0.6375985751186697
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:26:22,194] [INFO] [<frozen importlib] -   scale_pos_weight: 10.70437420809075
[2025-11-19 08:26:22,283] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:26:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:26:22,180] Trial 36 pruned. 
[0]	train-logloss:0.87144	train-auc:0.64105	train-aucpr:0.21928	val-logloss:0.87576	val-auc:0.60379	val-aucpr:0.10368
[10]	train-logloss:0.82416	train-auc:0.67226	train-aucpr:0.27923	val-logloss:0.72910	val-auc:0.64266	val-aucpr:0.16580
[20]	train-logloss:0.80697	train-auc:0.68319	train-aucpr:0.29071	val-logloss:0.67843	val-auc:0.67557	val-aucpr:0.20356
[30]	train-logloss:0.79589	train-auc:0.69468	train-aucpr:0.29742	val-logloss:0.69396	val-auc:0.66149	val-aucpr:0.19308
[40]	train-logloss:0.78938	train-auc:0.70112	train-aucpr:0.30515	val-logloss:0.69988	val-auc:0.67625	val-aucpr:0.18768
[49]	train-logloss:0.78361	train-auc:0.70602	train-aucpr:0.31172	val-logloss:0.67710	val-auc:0.67469	val-aucpr:0.18865
[2025-11-19 08:26:22,421] [INFO] [<frozen importlib] - Training completed at iteration 19
[2025-11-19 08:26:22,421] [INFO] [<frozen importlib] - Best train loss: 0.8078
[2025-11-19 08:26:22,421] [INFO] [<frozen importlib] - Best val loss: 0.6810
[2025-11-19 08:26:22,421] [INFO] [<frozen importlib] - Best val AUC: 0.6759
[2025-11-19 08:26:22,421] [INFO] [<frozen importlib] - Best val AUCPR: 0.2053
[2025-11-19 08:26:22,424] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:26:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:26:24,043] [INFO] [<frozen importlib] - Optimal threshold: 0.5830
[2025-11-19 08:26:24,043] [INFO] [<frozen importlib] - Best f1: 0.2620
[2025-11-19 08:26:24,043] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:26:24,086] [INFO] [<frozen importlib] - Validation Results (threshold=0.5830):
[2025-11-19 08:26:24,086] [INFO] [<frozen importlib] -   Accuracy: 0.8792
[2025-11-19 08:26:24,086] [INFO] [<frozen importlib] -   Precision: 0.2470
[2025-11-19 08:26:24,086] [INFO] [<frozen importlib] -   Recall: 0.2789
[2025-11-19 08:26:24,086] [INFO] [<frozen importlib] -   F1 Score: 0.2620
[2025-11-19 08:26:24,086] [INFO] [<frozen importlib] -   AUROC: 0.6759
[2025-11-19 08:26:24,086] [INFO] [<frozen importlib] -   AUPRC: 0.2037
[2025-11-19 08:26:24,086] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:26:24,086] [INFO] [<frozen importlib] -     TN=16210, FP=1235
[2025-11-19 08:26:24,086] [INFO] [<frozen importlib] -     FN=1047, TP=405
[2025-11-19 08:26:24,110] [INFO] [<frozen importlib] - Trial 37: AUPRC=0.2037, F1=0.4110, Prec=0.3601, Rec=0.4787 | Optimizing auprc=0.2037
                                                                                      Best trial: 15. Best value: 0.234562:   7%|▋         | 37/500 [04:22<53:02,  6.87s/it]Best trial: 15. Best value: 0.234562:   7%|▋         | 37/500 [04:22<53:02,  6.87s/it]Best trial: 15. Best value: 0.234562:   8%|▊         | 38/500 [04:22<41:30,  5.39s/it][2025-11-19 08:26:24,117] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.168083892615675
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   gamma: 0.29322372277786174
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   alpha: 0.43167232846811987
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   lambda: 0.7303771307029281
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   learning_rate: 0.04557773015834003
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   subsample: 0.7762482384820698
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   colsample_bytree: 0.5602301430726507
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8438900866726974
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   colsample_bynode: 0.7323893139152609
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:26:24,118] [INFO] [<frozen importlib] -   scale_pos_weight: 9.168083892615675
[2025-11-19 08:26:24,201] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:26:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:26:24,110] Trial 37 finished with value: 0.20374440749740985 and parameters: {'max_depth': 3, 'min_child_weight': 2, 'gamma': 0.7554679300987973, 'learning_rate': 0.09186317218103296, 'n_estimators': 100, 'alpha': 0.6759754643820219, 'lambda': 1.8397658605362075, 'subsample': 0.8413558489141085, 'colsample_bytree': 0.7682348289154783, 'colsample_bylevel': 0.913549978893499, 'colsample_bynode': 0.6375985751186697, 'scale_pos_weight': 10.70437420809075}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.80720	train-auc:0.64898	train-aucpr:0.23318	val-logloss:0.81376	val-auc:0.67539	val-aucpr:0.13250
[10]	train-logloss:0.77242	train-auc:0.68557	train-aucpr:0.29573	val-logloss:0.72570	val-auc:0.69006	val-aucpr:0.19872
[20]	train-logloss:0.75281	train-auc:0.69434	train-aucpr:0.30228	val-logloss:0.66970	val-auc:0.71119	val-aucpr:0.20576
[30]	train-logloss:0.74003	train-auc:0.70008	train-aucpr:0.30885	val-logloss:0.64997	val-auc:0.70921	val-aucpr:0.21506
[40]	train-logloss:0.73174	train-auc:0.70422	train-aucpr:0.31200	val-logloss:0.62518	val-auc:0.70865	val-aucpr:0.21763
[50]	train-logloss:0.72492	train-auc:0.70823	train-aucpr:0.31745	val-logloss:0.60407	val-auc:0.71148	val-aucpr:0.22089
[60]	train-logloss:0.71918	train-auc:0.71459	train-aucpr:0.32337	val-logloss:0.59848	val-auc:0.71112	val-aucpr:0.21846
[70]	train-logloss:0.71491	train-auc:0.71937	train-aucpr:0.32803	val-logloss:0.57685	val-auc:0.69913	val-aucpr:0.20385
[79]	train-logloss:0.71061	train-auc:0.72574	train-aucpr:0.33441	val-logloss:0.57214	val-auc:0.69758	val-aucpr:0.20016
[2025-11-19 08:26:24,440] [INFO] [<frozen importlib] - Training completed at iteration 50
[2025-11-19 08:26:24,440] [INFO] [<frozen importlib] - Best train loss: 0.7249
[2025-11-19 08:26:24,440] [INFO] [<frozen importlib] - Best val loss: 0.6041
[2025-11-19 08:26:24,440] [INFO] [<frozen importlib] - Best val AUC: 0.7115
[2025-11-19 08:26:24,440] [INFO] [<frozen importlib] - Best val AUCPR: 0.2209
[2025-11-19 08:26:24,443] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:26:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:26:36,688] [INFO] [<frozen importlib] - Optimal threshold: 0.5570
[2025-11-19 08:26:36,688] [INFO] [<frozen importlib] - Best f1: 0.2785
[2025-11-19 08:26:36,688] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:26:36,741] [INFO] [<frozen importlib] - Validation Results (threshold=0.5570):
[2025-11-19 08:26:36,741] [INFO] [<frozen importlib] -   Accuracy: 0.8933
[2025-11-19 08:26:36,741] [INFO] [<frozen importlib] -   Precision: 0.2899
[2025-11-19 08:26:36,741] [INFO] [<frozen importlib] -   Recall: 0.2679
[2025-11-19 08:26:36,741] [INFO] [<frozen importlib] -   F1 Score: 0.2785
[2025-11-19 08:26:36,741] [INFO] [<frozen importlib] -   AUROC: 0.7115
[2025-11-19 08:26:36,741] [INFO] [<frozen importlib] -   AUPRC: 0.2213
[2025-11-19 08:26:36,741] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:26:36,741] [INFO] [<frozen importlib] -     TN=16492, FP=953
[2025-11-19 08:26:36,741] [INFO] [<frozen importlib] -     FN=1063, TP=389
[2025-11-19 08:26:36,769] [INFO] [<frozen importlib] - Trial 38: AUPRC=0.2213, F1=0.4696, Prec=0.4364, Rec=0.5083 | Optimizing auprc=0.2213
                                                                                      Best trial: 15. Best value: 0.234562:   8%|▊         | 38/500 [04:34<41:30,  5.39s/it]Best trial: 15. Best value: 0.234562:   8%|▊         | 38/500 [04:34<41:30,  5.39s/it]Best trial: 15. Best value: 0.234562:   8%|▊         | 39/500 [04:34<58:10,  7.57s/it][2025-11-19 08:26:36,776] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 17.046759095958365
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   gamma: 0.11306282925329253
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   alpha: 1.024269284516879
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   lambda: 2.8879667306994192
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   learning_rate: 0.121243515141374
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   subsample: 0.874242551104843
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   colsample_bytree: 0.5250243179795784
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7928110332610881
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   colsample_bynode: 0.9577790478973721
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:26:36,777] [INFO] [<frozen importlib] -   scale_pos_weight: 17.046759095958365
[2025-11-19 08:26:36,857] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:26:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:26:36,769] Trial 38 finished with value: 0.22134944119664607 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.29322372277786174, 'learning_rate': 0.04557773015834003, 'n_estimators': 200, 'alpha': 0.43167232846811987, 'lambda': 0.7303771307029281, 'subsample': 0.7762482384820698, 'colsample_bytree': 0.5602301430726507, 'colsample_bylevel': 0.8438900866726974, 'colsample_bynode': 0.7323893139152609, 'scale_pos_weight': 9.168083892615675}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:1.08563	train-auc:0.63692	train-aucpr:0.21122	val-logloss:1.09793	val-auc:0.59716	val-aucpr:0.10161
[10]	train-logloss:1.03688	train-auc:0.67580	train-aucpr:0.27659	val-logloss:0.90475	val-auc:0.66347	val-aucpr:0.19558
[20]	train-logloss:1.01873	train-auc:0.69143	train-aucpr:0.29475	val-logloss:0.86114	val-auc:0.69540	val-aucpr:0.20566
[30]	train-logloss:1.00836	train-auc:0.69760	train-aucpr:0.30335	val-logloss:0.81827	val-auc:0.69455	val-aucpr:0.20811
[40]	train-logloss:0.99942	train-auc:0.70521	train-aucpr:0.31110	val-logloss:0.75936	val-auc:0.67054	val-aucpr:0.17296
[43]	train-logloss:0.99668	train-auc:0.70750	train-aucpr:0.31425	val-logloss:0.76452	val-auc:0.66107	val-aucpr:0.15273
[2025-11-19 08:26:36,982] [INFO] [<frozen importlib] - Training completed at iteration 13
[2025-11-19 08:26:36,982] [INFO] [<frozen importlib] - Best train loss: 1.0312
[2025-11-19 08:26:36,982] [INFO] [<frozen importlib] - Best val loss: 0.8733
[2025-11-19 08:26:36,982] [INFO] [<frozen importlib] - Best val AUC: 0.6940
[2025-11-19 08:26:36,982] [INFO] [<frozen importlib] - Best val AUCPR: 0.2182
[2025-11-19 08:26:36,985] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:26:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:26:38,091] [INFO] [<frozen importlib] - Optimal threshold: 0.7053
[2025-11-19 08:26:38,091] [INFO] [<frozen importlib] - Best f1: 0.2577
[2025-11-19 08:26:38,091] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:26:38,138] [INFO] [<frozen importlib] - Validation Results (threshold=0.7053):
[2025-11-19 08:26:38,138] [INFO] [<frozen importlib] -   Accuracy: 0.8918
[2025-11-19 08:26:38,138] [INFO] [<frozen importlib] -   Precision: 0.2724
[2025-11-19 08:26:38,138] [INFO] [<frozen importlib] -   Recall: 0.2445
[2025-11-19 08:26:38,138] [INFO] [<frozen importlib] -   F1 Score: 0.2577
[2025-11-19 08:26:38,138] [INFO] [<frozen importlib] -   AUROC: 0.6940
[2025-11-19 08:26:38,138] [INFO] [<frozen importlib] -   AUPRC: 0.2112
[2025-11-19 08:26:38,138] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:26:38,138] [INFO] [<frozen importlib] -     TN=16497, FP=948
[2025-11-19 08:26:38,138] [INFO] [<frozen importlib] -     FN=1097, TP=355
[2025-11-19 08:26:38,174] [INFO] [<frozen importlib] - Trial 39: AUPRC=0.2112, F1=0.4303, Prec=0.4097, Rec=0.4532 | Optimizing auprc=0.2112
                                                                                      Best trial: 15. Best value: 0.234562:   8%|▊         | 39/500 [04:36<58:10,  7.57s/it]Best trial: 15. Best value: 0.234562:   8%|▊         | 39/500 [04:36<58:10,  7.57s/it]Best trial: 15. Best value: 0.234562:   8%|▊         | 40/500 [04:36<43:51,  5.72s/it][2025-11-19 08:26:38,188] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 15.201311839160955
[2025-11-19 08:26:38,188] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:26:38,188] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:26:38,188] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:26:38,188] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:26:38,188] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:26:38,188] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:26:38,188] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 08:26:38,188] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   gamma: 0.9583864751613876
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   alpha: 0.2284189723916129
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   lambda: 0.15208471704009097
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   learning_rate: 0.08144163083638056
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   subsample: 0.9218528225328565
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   colsample_bytree: 0.6156613668455075
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8772155952944911
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   colsample_bynode: 0.7891495416791976
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:26:38,189] [INFO] [<frozen importlib] -   scale_pos_weight: 15.201311839160955
[2025-11-19 08:26:38,275] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:26:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:26:38,175] Trial 39 finished with value: 0.2112133898303227 and parameters: {'max_depth': 3, 'min_child_weight': 1, 'gamma': 0.11306282925329253, 'learning_rate': 0.121243515141374, 'n_estimators': 250, 'alpha': 1.024269284516879, 'lambda': 2.8879667306994192, 'subsample': 0.874242551104843, 'colsample_bytree': 0.5250243179795784, 'colsample_bylevel': 0.7928110332610881, 'colsample_bynode': 0.9577790478973721, 'scale_pos_weight': 17.046759095958365}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:1.03192	train-auc:0.66809	train-aucpr:0.26255	val-logloss:1.05660	val-auc:0.56083	val-aucpr:0.08639
[10]	train-logloss:0.96322	train-auc:0.70856	train-aucpr:0.31648	val-logloss:0.84683	val-auc:0.66890	val-aucpr:0.19124
[20]	train-logloss:0.93635	train-auc:0.72125	train-aucpr:0.33112	val-logloss:0.79991	val-auc:0.67874	val-aucpr:0.20219
[30]	train-logloss:0.92105	train-auc:0.73160	train-aucpr:0.34530	val-logloss:0.75181	val-auc:0.64252	val-aucpr:0.13557
[40]	train-logloss:0.90822	train-auc:0.74246	train-aucpr:0.35598	val-logloss:0.59676	val-auc:0.62216	val-aucpr:0.10993
[50]	train-logloss:0.89317	train-auc:0.75721	train-aucpr:0.37029	val-logloss:0.58281	val-auc:0.62920	val-aucpr:0.11301
[52]	train-logloss:0.89061	train-auc:0.75980	train-aucpr:0.37264	val-logloss:0.54239	val-auc:0.62724	val-aucpr:0.10752
[2025-11-19 08:26:38,514] [INFO] [<frozen importlib] - Training completed at iteration 23
[2025-11-19 08:26:38,514] [INFO] [<frozen importlib] - Best train loss: 0.9311
[2025-11-19 08:26:38,514] [INFO] [<frozen importlib] - Best val loss: 0.7827
[2025-11-19 08:26:38,514] [INFO] [<frozen importlib] - Best val AUC: 0.6811
[2025-11-19 08:26:38,514] [INFO] [<frozen importlib] - Best val AUCPR: 0.2080
[2025-11-19 08:26:38,517] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:26:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:26:46,872] [INFO] [<frozen importlib] - Optimal threshold: 0.6851
[2025-11-19 08:26:46,878] [INFO] [<frozen importlib] - Best f1: 0.2425
[2025-11-19 08:26:46,878] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:26:46,927] [INFO] [<frozen importlib] - Validation Results (threshold=0.6851):
[2025-11-19 08:26:46,927] [INFO] [<frozen importlib] -   Accuracy: 0.8899
[2025-11-19 08:26:46,927] [INFO] [<frozen importlib] -   Precision: 0.2573
[2025-11-19 08:26:46,927] [INFO] [<frozen importlib] -   Recall: 0.2293
[2025-11-19 08:26:46,927] [INFO] [<frozen importlib] -   F1 Score: 0.2425
[2025-11-19 08:26:46,927] [INFO] [<frozen importlib] -   AUROC: 0.6811
[2025-11-19 08:26:46,927] [INFO] [<frozen importlib] -   AUPRC: 0.2084
[2025-11-19 08:26:46,927] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:26:46,927] [INFO] [<frozen importlib] -     TN=16484, FP=961
[2025-11-19 08:26:46,927] [INFO] [<frozen importlib] -     FN=1119, TP=333
[2025-11-19 08:26:46,953] [INFO] [<frozen importlib] - Trial 40: AUPRC=0.2084, F1=0.4581, Prec=0.4273, Rec=0.4938 | Optimizing auprc=0.2084
[2025-11-19 08:26:46,954] [INFO] [<frozen importlib] - Trial 40 pruned.
[2025-11-19 08:26:46,954] [ERROR] [<frozen importlib] - Trial 40 failed with error: 
                                                                                      Best trial: 15. Best value: 0.234562:   8%|▊         | 40/500 [04:44<43:51,  5.72s/it]Best trial: 15. Best value: 0.234562:   8%|▊         | 40/500 [04:44<43:51,  5.72s/it]Best trial: 15. Best value: 0.234562:   8%|▊         | 41/500 [04:44<50:47,  6.64s/it][2025-11-19 08:26:46,968] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.613226930233491
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   gamma: 0.3429803297022266
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   alpha: 1.6596049891474007
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   lambda: 4.548953941351752
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   learning_rate: 0.039558428038320735
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   subsample: 0.7621407671412216
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   colsample_bytree: 0.5113232260778522
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9410959599646898
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   colsample_bynode: 0.7826239049708925
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:26:46,968] [INFO] [<frozen importlib] -   scale_pos_weight: 10.613226930233491
[2025-11-19 08:26:47,060] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:26:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:26:46,954] Trial 40 pruned. 
[0]	train-logloss:0.87251	train-auc:0.65134	train-aucpr:0.23634	val-logloss:0.88505	val-auc:0.66122	val-aucpr:0.13439
[10]	train-logloss:0.83791	train-auc:0.68318	train-aucpr:0.28577	val-logloss:0.79417	val-auc:0.68560	val-aucpr:0.19569
[20]	train-logloss:0.81873	train-auc:0.69011	train-aucpr:0.29768	val-logloss:0.74349	val-auc:0.68820	val-aucpr:0.19504
[30]	train-logloss:0.80504	train-auc:0.69699	train-aucpr:0.30311	val-logloss:0.71404	val-auc:0.69852	val-aucpr:0.21288
[40]	train-logloss:0.79541	train-auc:0.70132	train-aucpr:0.30956	val-logloss:0.68294	val-auc:0.69809	val-aucpr:0.21234
[50]	train-logloss:0.78831	train-auc:0.70524	train-aucpr:0.31338	val-logloss:0.67179	val-auc:0.70075	val-aucpr:0.21726
[60]	train-logloss:0.78235	train-auc:0.71068	train-aucpr:0.31808	val-logloss:0.66354	val-auc:0.69898	val-aucpr:0.21858
[70]	train-logloss:0.77819	train-auc:0.71368	train-aucpr:0.32184	val-logloss:0.65847	val-auc:0.69414	val-aucpr:0.20702
[80]	train-logloss:0.77396	train-auc:0.71784	train-aucpr:0.32605	val-logloss:0.65731	val-auc:0.68941	val-aucpr:0.19738
[85]	train-logloss:0.77255	train-auc:0.71938	train-aucpr:0.32709	val-logloss:0.64571	val-auc:0.69378	val-aucpr:0.20328
[2025-11-19 08:26:47,319] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 08:26:47,320] [INFO] [<frozen importlib] - Best train loss: 0.7849
[2025-11-19 08:26:47,320] [INFO] [<frozen importlib] - Best val loss: 0.6697
[2025-11-19 08:26:47,320] [INFO] [<frozen importlib] - Best val AUC: 0.6997
[2025-11-19 08:26:47,320] [INFO] [<frozen importlib] - Best val AUCPR: 0.2193
[2025-11-19 08:26:47,324] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:26:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:27:00,686] [INFO] [<frozen importlib] - Optimal threshold: 0.6062
[2025-11-19 08:27:00,686] [INFO] [<frozen importlib] - Best f1: 0.2730
[2025-11-19 08:27:00,686] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:27:00,731] [INFO] [<frozen importlib] - Validation Results (threshold=0.6062):
[2025-11-19 08:27:00,732] [INFO] [<frozen importlib] -   Accuracy: 0.8878
[2025-11-19 08:27:00,732] [INFO] [<frozen importlib] -   Precision: 0.2719
[2025-11-19 08:27:00,732] [INFO] [<frozen importlib] -   Recall: 0.2741
[2025-11-19 08:27:00,732] [INFO] [<frozen importlib] -   F1 Score: 0.2730
[2025-11-19 08:27:00,732] [INFO] [<frozen importlib] -   AUROC: 0.6997
[2025-11-19 08:27:00,732] [INFO] [<frozen importlib] -   AUPRC: 0.2197
[2025-11-19 08:27:00,732] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:27:00,732] [INFO] [<frozen importlib] -     TN=16379, FP=1066
[2025-11-19 08:27:00,732] [INFO] [<frozen importlib] -     FN=1054, TP=398
[2025-11-19 08:27:00,757] [INFO] [<frozen importlib] - Trial 41: AUPRC=0.2197, F1=0.4442, Prec=0.4028, Rec=0.4952 | Optimizing auprc=0.2197
                                                                                      Best trial: 15. Best value: 0.234562:   8%|▊         | 41/500 [04:58<50:47,  6.64s/it]Best trial: 15. Best value: 0.234562:   8%|▊         | 41/500 [04:58<50:47,  6.64s/it]Best trial: 15. Best value: 0.234562:   8%|▊         | 42/500 [04:58<1:07:04,  8.79s/it][2025-11-19 08:27:00,770] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 13.169297991092394
[2025-11-19 08:27:00,770] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:27:00,770] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:27:00,770] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:27:00,770] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:27:00,770] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:27:00,770] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:27:00,770] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:27:00,770] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 08:27:00,770] [INFO] [<frozen importlib] -   gamma: 0.3800096818874982
[2025-11-19 08:27:00,770] [INFO] [<frozen importlib] -   alpha: 1.5150985503978536
[2025-11-19 08:27:00,771] [INFO] [<frozen importlib] -   lambda: 4.233271936650859
[2025-11-19 08:27:00,771] [INFO] [<frozen importlib] -   learning_rate: 0.06359614817819782
[2025-11-19 08:27:00,771] [INFO] [<frozen importlib] -   subsample: 0.7275356022112999
[2025-11-19 08:27:00,771] [INFO] [<frozen importlib] -   colsample_bytree: 0.5916607735755979
[2025-11-19 08:27:00,771] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9787585113175068
[2025-11-19 08:27:00,771] [INFO] [<frozen importlib] -   colsample_bynode: 0.7623832267893202
[2025-11-19 08:27:00,771] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:27:00,771] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:27:00,771] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:27:00,771] [INFO] [<frozen importlib] -   scale_pos_weight: 13.169297991092394
[2025-11-19 08:27:00,845] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:27:00] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:27:00,757] Trial 41 finished with value: 0.21967735447417308 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.3429803297022266, 'learning_rate': 0.039558428038320735, 'n_estimators': 200, 'alpha': 1.6596049891474007, 'lambda': 4.548953941351752, 'subsample': 0.7621407671412216, 'colsample_bytree': 0.5113232260778522, 'colsample_bylevel': 0.9410959599646898, 'colsample_bynode': 0.7826239049708925, 'scale_pos_weight': 10.613226930233491}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.96927	train-auc:0.65229	train-aucpr:0.23020	val-logloss:0.98979	val-auc:0.56808	val-aucpr:0.09067
[10]	train-logloss:0.91911	train-auc:0.68692	train-aucpr:0.28830	val-logloss:0.85817	val-auc:0.68816	val-aucpr:0.19456
[20]	train-logloss:0.89647	train-auc:0.69745	train-aucpr:0.30448	val-logloss:0.78087	val-auc:0.69843	val-aucpr:0.20851
[30]	train-logloss:0.88238	train-auc:0.70485	train-aucpr:0.31409	val-logloss:0.73598	val-auc:0.69952	val-aucpr:0.20787
[40]	train-logloss:0.87267	train-auc:0.71447	train-aucpr:0.32093	val-logloss:0.72673	val-auc:0.68687	val-aucpr:0.19162
[50]	train-logloss:0.86417	train-auc:0.72161	train-aucpr:0.32883	val-logloss:0.71854	val-auc:0.67791	val-aucpr:0.17435
[56]	train-logloss:0.85959	train-auc:0.72523	train-aucpr:0.33209	val-logloss:0.70968	val-auc:0.67832	val-aucpr:0.17665
[2025-11-19 08:27:01,022] [INFO] [<frozen importlib] - Training completed at iteration 26
[2025-11-19 08:27:01,022] [INFO] [<frozen importlib] - Best train loss: 0.8876
[2025-11-19 08:27:01,022] [INFO] [<frozen importlib] - Best val loss: 0.7487
[2025-11-19 08:27:01,022] [INFO] [<frozen importlib] - Best val AUC: 0.7020
[2025-11-19 08:27:01,022] [INFO] [<frozen importlib] - Best val AUCPR: 0.2169
[2025-11-19 08:27:01,027] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:27:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:27:07,281] [INFO] [<frozen importlib] - Optimal threshold: 0.6480
[2025-11-19 08:27:07,282] [INFO] [<frozen importlib] - Best f1: 0.2671
[2025-11-19 08:27:07,282] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:27:07,327] [INFO] [<frozen importlib] - Validation Results (threshold=0.6480):
[2025-11-19 08:27:07,328] [INFO] [<frozen importlib] -   Accuracy: 0.8998
[2025-11-19 08:27:07,328] [INFO] [<frozen importlib] -   Precision: 0.3050
[2025-11-19 08:27:07,328] [INFO] [<frozen importlib] -   Recall: 0.2376
[2025-11-19 08:27:07,328] [INFO] [<frozen importlib] -   F1 Score: 0.2671
[2025-11-19 08:27:07,328] [INFO] [<frozen importlib] -   AUROC: 0.7020
[2025-11-19 08:27:07,328] [INFO] [<frozen importlib] -   AUPRC: 0.2173
[2025-11-19 08:27:07,328] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:27:07,328] [INFO] [<frozen importlib] -     TN=16659, FP=786
[2025-11-19 08:27:07,328] [INFO] [<frozen importlib] -     FN=1107, TP=345
[2025-11-19 08:27:07,351] [INFO] [<frozen importlib] - Trial 42: AUPRC=0.2173, F1=0.4355, Prec=0.4422, Rec=0.4291 | Optimizing auprc=0.2173
                                                                                        Best trial: 15. Best value: 0.234562:   8%|▊         | 42/500 [05:05<1:07:04,  8.79s/it]Best trial: 15. Best value: 0.234562:   8%|▊         | 42/500 [05:05<1:07:04,  8.79s/it]Best trial: 15. Best value: 0.234562:   9%|▊         | 43/500 [05:05<1:01:55,  8.13s/it][2025-11-19 08:27:07,359] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.999885726213947
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   gamma: 0.25973262242872874
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   alpha: 1.7406895789500287
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   lambda: 3.9668454534797393
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   learning_rate: 0.07427643184273286
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   subsample: 0.7583664902830833
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   colsample_bytree: 0.548416336534517
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9221458451514837
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   colsample_bynode: 0.7021974283334625
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:27:07,359] [INFO] [<frozen importlib] -   scale_pos_weight: 10.999885726213947
[2025-11-19 08:27:07,424] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:27:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:27:07,352] Trial 42 finished with value: 0.21730406512418834 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.3800096818874982, 'learning_rate': 0.06359614817819782, 'n_estimators': 200, 'alpha': 1.5150985503978536, 'lambda': 4.233271936650859, 'subsample': 0.7275356022112999, 'colsample_bytree': 0.5916607735755979, 'colsample_bylevel': 0.9787585113175068, 'colsample_bynode': 0.7623832267893202, 'scale_pos_weight': 13.169297991092394}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.88523	train-auc:0.64326	train-aucpr:0.21880	val-logloss:0.89460	val-auc:0.62329	val-aucpr:0.11334
[10]	train-logloss:0.83414	train-auc:0.68613	train-aucpr:0.28805	val-logloss:0.75434	val-auc:0.68509	val-aucpr:0.18616
[20]	train-logloss:0.81203	train-auc:0.70128	train-aucpr:0.30829	val-logloss:0.68657	val-auc:0.69622	val-aucpr:0.21837
[30]	train-logloss:0.79869	train-auc:0.71000	train-aucpr:0.31588	val-logloss:0.67667	val-auc:0.69359	val-aucpr:0.21022
[40]	train-logloss:0.79044	train-auc:0.71570	train-aucpr:0.32346	val-logloss:0.65945	val-auc:0.69538	val-aucpr:0.20690
[49]	train-logloss:0.78267	train-auc:0.72408	train-aucpr:0.33059	val-logloss:0.63941	val-auc:0.67940	val-aucpr:0.19028
[2025-11-19 08:27:07,585] [INFO] [<frozen importlib] - Training completed at iteration 19
[2025-11-19 08:27:07,585] [INFO] [<frozen importlib] - Best train loss: 0.8133
[2025-11-19 08:27:07,585] [INFO] [<frozen importlib] - Best val loss: 0.6902
[2025-11-19 08:27:07,585] [INFO] [<frozen importlib] - Best val AUC: 0.6945
[2025-11-19 08:27:07,585] [INFO] [<frozen importlib] - Best val AUCPR: 0.2203
[2025-11-19 08:27:07,590] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:27:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:27:11,039] [INFO] [<frozen importlib] - Optimal threshold: 0.5969
[2025-11-19 08:27:11,039] [INFO] [<frozen importlib] - Best f1: 0.2634
[2025-11-19 08:27:11,039] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:27:11,082] [INFO] [<frozen importlib] - Validation Results (threshold=0.5969):
[2025-11-19 08:27:11,082] [INFO] [<frozen importlib] -   Accuracy: 0.8789
[2025-11-19 08:27:11,082] [INFO] [<frozen importlib] -   Precision: 0.2473
[2025-11-19 08:27:11,082] [INFO] [<frozen importlib] -   Recall: 0.2817
[2025-11-19 08:27:11,082] [INFO] [<frozen importlib] -   F1 Score: 0.2634
[2025-11-19 08:27:11,082] [INFO] [<frozen importlib] -   AUROC: 0.6945
[2025-11-19 08:27:11,082] [INFO] [<frozen importlib] -   AUPRC: 0.2195
[2025-11-19 08:27:11,082] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:27:11,082] [INFO] [<frozen importlib] -     TN=16200, FP=1245
[2025-11-19 08:27:11,082] [INFO] [<frozen importlib] -     FN=1043, TP=409
[2025-11-19 08:27:11,106] [INFO] [<frozen importlib] - Trial 43: AUPRC=0.2195, F1=0.4410, Prec=0.3800, Rec=0.5255 | Optimizing auprc=0.2195
                                                                                        Best trial: 15. Best value: 0.234562:   9%|▊         | 43/500 [05:09<1:01:55,  8.13s/it]Best trial: 15. Best value: 0.234562:   9%|▊         | 43/500 [05:09<1:01:55,  8.13s/it]Best trial: 15. Best value: 0.234562:   9%|▉         | 44/500 [05:09<51:48,  6.82s/it]  [2025-11-19 08:27:11,114] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.030833796649775
[2025-11-19 08:27:11,114] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:27:11,114] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:27:11,114] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   gamma: 0.4922001021980212
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   alpha: 1.5311813636745
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   lambda: 4.614886152370245
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   learning_rate: 0.03154083289838561
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   subsample: 0.6672415247744865
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   colsample_bytree: 0.5246554846443983
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9123740937741239
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   colsample_bynode: 0.7382078717076309
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:27:11,115] [INFO] [<frozen importlib] -   scale_pos_weight: 10.030833796649775
[2025-11-19 08:27:11,191] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:27:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:27:11,106] Trial 43 finished with value: 0.21946697527058603 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.25973262242872874, 'learning_rate': 0.07427643184273286, 'n_estimators': 150, 'alpha': 1.7406895789500287, 'lambda': 3.9668454534797393, 'subsample': 0.7583664902830833, 'colsample_bytree': 0.548416336534517, 'colsample_bylevel': 0.9221458451514837, 'colsample_bynode': 0.7021974283334625, 'scale_pos_weight': 10.999885726213947}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.84813	train-auc:0.65105	train-aucpr:0.23698	val-logloss:0.85935	val-auc:0.63888	val-aucpr:0.13303
[10]	train-logloss:0.81994	train-auc:0.68105	train-aucpr:0.28086	val-logloss:0.78859	val-auc:0.67834	val-aucpr:0.19894
[20]	train-logloss:0.80183	train-auc:0.68687	train-aucpr:0.29132	val-logloss:0.74173	val-auc:0.69395	val-aucpr:0.21024
[30]	train-logloss:0.78960	train-auc:0.69211	train-aucpr:0.29661	val-logloss:0.70568	val-auc:0.69153	val-aucpr:0.20838
[40]	train-logloss:0.78055	train-auc:0.69628	train-aucpr:0.30228	val-logloss:0.67850	val-auc:0.69349	val-aucpr:0.21753
[50]	train-logloss:0.77322	train-auc:0.69962	train-aucpr:0.30713	val-logloss:0.65825	val-auc:0.69655	val-aucpr:0.22048
[60]	train-logloss:0.76671	train-auc:0.70379	train-aucpr:0.31297	val-logloss:0.63753	val-auc:0.69936	val-aucpr:0.22377
[70]	train-logloss:0.76163	train-auc:0.70673	train-aucpr:0.31701	val-logloss:0.63245	val-auc:0.70141	val-aucpr:0.22292
[80]	train-logloss:0.75758	train-auc:0.71045	train-aucpr:0.32085	val-logloss:0.62844	val-auc:0.70208	val-aucpr:0.22174
[90]	train-logloss:0.75414	train-auc:0.71362	train-aucpr:0.32468	val-logloss:0.61790	val-auc:0.70220	val-aucpr:0.22003
[2025-11-19 08:27:11,451] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:27:11,451] [INFO] [<frozen importlib] - Best train loss: 0.7667
[2025-11-19 08:27:11,451] [INFO] [<frozen importlib] - Best val loss: 0.6375
[2025-11-19 08:27:11,451] [INFO] [<frozen importlib] - Best val AUC: 0.6994
[2025-11-19 08:27:11,451] [INFO] [<frozen importlib] - Best val AUCPR: 0.2238
[2025-11-19 08:27:11,456] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:27:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:27:23,137] [INFO] [<frozen importlib] - Optimal threshold: 0.5875
[2025-11-19 08:27:23,143] [INFO] [<frozen importlib] - Best f1: 0.2708
[2025-11-19 08:27:23,144] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:27:23,185] [INFO] [<frozen importlib] - Validation Results (threshold=0.5875):
[2025-11-19 08:27:23,185] [INFO] [<frozen importlib] -   Accuracy: 0.8991
[2025-11-19 08:27:23,185] [INFO] [<frozen importlib] -   Precision: 0.3046
[2025-11-19 08:27:23,185] [INFO] [<frozen importlib] -   Recall: 0.2438
[2025-11-19 08:27:23,185] [INFO] [<frozen importlib] -   F1 Score: 0.2708
[2025-11-19 08:27:23,185] [INFO] [<frozen importlib] -   AUROC: 0.6994
[2025-11-19 08:27:23,185] [INFO] [<frozen importlib] -   AUPRC: 0.2241
[2025-11-19 08:27:23,185] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:27:23,185] [INFO] [<frozen importlib] -     TN=16637, FP=808
[2025-11-19 08:27:23,185] [INFO] [<frozen importlib] -     FN=1098, TP=354
[2025-11-19 08:27:23,208] [INFO] [<frozen importlib] - Trial 44: AUPRC=0.2241, F1=0.4594, Prec=0.4548, Rec=0.4642 | Optimizing auprc=0.2241
                                                                                      Best trial: 15. Best value: 0.234562:   9%|▉         | 44/500 [05:21<51:48,  6.82s/it]Best trial: 15. Best value: 0.234562:   9%|▉         | 44/500 [05:21<51:48,  6.82s/it]Best trial: 15. Best value: 0.234562:   9%|▉         | 45/500 [05:21<1:03:43,  8.40s/it][2025-11-19 08:27:23,216] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.369540402161887
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   gamma: 0.5421562510882245
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   alpha: 1.2686437982010168
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   lambda: 4.5702799397820435
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   learning_rate: 0.03409213411403409
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   subsample: 0.6204853141773836
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   colsample_bytree: 0.5631440137536877
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8995996297196684
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   colsample_bynode: 0.7403909186616697
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:27:23,216] [INFO] [<frozen importlib] -   scale_pos_weight: 8.369540402161887
[2025-11-19 08:27:23,290] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:27:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:27:23,208] Trial 44 finished with value: 0.2240796403100065 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.4922001021980212, 'learning_rate': 0.03154083289838561, 'n_estimators': 250, 'alpha': 1.5311813636745, 'lambda': 4.614886152370245, 'subsample': 0.6672415247744865, 'colsample_bytree': 0.5246554846443983, 'colsample_bylevel': 0.9123740937741239, 'colsample_bynode': 0.7382078717076309, 'scale_pos_weight': 10.030833796649775}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.76976	train-auc:0.64386	train-aucpr:0.23987	val-logloss:0.77509	val-auc:0.63203	val-aucpr:0.14928
[10]	train-logloss:0.74269	train-auc:0.67948	train-aucpr:0.28501	val-logloss:0.70350	val-auc:0.66405	val-aucpr:0.18651
[20]	train-logloss:0.72563	train-auc:0.68840	train-aucpr:0.29638	val-logloss:0.66005	val-auc:0.69796	val-aucpr:0.20794
[30]	train-logloss:0.71402	train-auc:0.69439	train-aucpr:0.30367	val-logloss:0.63307	val-auc:0.69784	val-aucpr:0.21709
[40]	train-logloss:0.70535	train-auc:0.70113	train-aucpr:0.30887	val-logloss:0.61833	val-auc:0.70010	val-aucpr:0.21774
[50]	train-logloss:0.69846	train-auc:0.70498	train-aucpr:0.31316	val-logloss:0.59807	val-auc:0.69754	val-aucpr:0.21585
[60]	train-logloss:0.69317	train-auc:0.70837	train-aucpr:0.31797	val-logloss:0.57739	val-auc:0.70007	val-aucpr:0.21729
[64]	train-logloss:0.69093	train-auc:0.70989	train-aucpr:0.32020	val-logloss:0.57172	val-auc:0.70020	val-aucpr:0.21731
[2025-11-19 08:27:23,486] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:27:23,486] [INFO] [<frozen importlib] - Best train loss: 0.7103
[2025-11-19 08:27:23,486] [INFO] [<frozen importlib] - Best val loss: 0.6213
[2025-11-19 08:27:23,486] [INFO] [<frozen importlib] - Best val AUC: 0.7023
[2025-11-19 08:27:23,486] [INFO] [<frozen importlib] - Best val AUCPR: 0.2237
[2025-11-19 08:27:23,489] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:27:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:27:30,483] [INFO] [<frozen importlib] - Optimal threshold: 0.5485
[2025-11-19 08:27:30,483] [INFO] [<frozen importlib] - Best f1: 0.2741
[2025-11-19 08:27:30,483] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:27:30,529] [INFO] [<frozen importlib] - Validation Results (threshold=0.5485):
[2025-11-19 08:27:30,529] [INFO] [<frozen importlib] -   Accuracy: 0.8986
[2025-11-19 08:27:30,529] [INFO] [<frozen importlib] -   Precision: 0.3045
[2025-11-19 08:27:30,529] [INFO] [<frozen importlib] -   Recall: 0.2493
[2025-11-19 08:27:30,529] [INFO] [<frozen importlib] -   F1 Score: 0.2741
[2025-11-19 08:27:30,529] [INFO] [<frozen importlib] -   AUROC: 0.7023
[2025-11-19 08:27:30,529] [INFO] [<frozen importlib] -   AUPRC: 0.2240
[2025-11-19 08:27:30,529] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:27:30,529] [INFO] [<frozen importlib] -     TN=16618, FP=827
[2025-11-19 08:27:30,529] [INFO] [<frozen importlib] -     FN=1090, TP=362
[2025-11-19 08:27:30,554] [INFO] [<frozen importlib] - Trial 45: AUPRC=0.2240, F1=0.4507, Prec=0.4450, Rec=0.4566 | Optimizing auprc=0.2240
[2025-11-19 08:27:30,554] [INFO] [<frozen importlib] - Trial 45 pruned.
[2025-11-19 08:27:30,554] [ERROR] [<frozen importlib] - Trial 45 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:   9%|▉         | 45/500 [05:28<1:03:43,  8.40s/it]Best trial: 15. Best value: 0.234562:   9%|▉         | 45/500 [05:28<1:03:43,  8.40s/it]Best trial: 15. Best value: 0.234562:   9%|▉         | 46/500 [05:28<1:01:10,  8.09s/it][2025-11-19 08:27:30,562] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.900737343940996
[2025-11-19 08:27:30,562] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   gamma: 0.4800761884538511
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   alpha: 1.4216601093219623
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   lambda: 1.6114744956065785
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   learning_rate: 0.04465602605392701
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   subsample: 0.6788745090381901
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   colsample_bytree: 0.645437173149172
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   colsample_bylevel: 0.666421175392507
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   colsample_bynode: 0.6788984114745379
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:27:30,563] [INFO] [<frozen importlib] -   scale_pos_weight: 9.900737343940996
[2025-11-19 08:27:30,632] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:27:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:27:30,554] Trial 45 pruned. 
[0]	train-logloss:0.84078	train-auc:0.64940	train-aucpr:0.23705	val-logloss:0.85057	val-auc:0.60845	val-aucpr:0.10625
[10]	train-logloss:0.80488	train-auc:0.68256	train-aucpr:0.28761	val-logloss:0.75677	val-auc:0.68913	val-aucpr:0.19257
[20]	train-logloss:0.78406	train-auc:0.69213	train-aucpr:0.30030	val-logloss:0.69379	val-auc:0.69370	val-aucpr:0.19298
[30]	train-logloss:0.77202	train-auc:0.69742	train-aucpr:0.30488	val-logloss:0.66745	val-auc:0.70119	val-aucpr:0.20662
[40]	train-logloss:0.76318	train-auc:0.70307	train-aucpr:0.30871	val-logloss:0.64598	val-auc:0.69193	val-aucpr:0.20002
[50]	train-logloss:0.75599	train-auc:0.70808	train-aucpr:0.31414	val-logloss:0.62502	val-auc:0.69133	val-aucpr:0.20167
[60]	train-logloss:0.75054	train-auc:0.71243	train-aucpr:0.31840	val-logloss:0.61320	val-auc:0.69404	val-aucpr:0.20414
[67]	train-logloss:0.74724	train-auc:0.71511	train-aucpr:0.32251	val-logloss:0.59329	val-auc:0.69266	val-aucpr:0.20158
[2025-11-19 08:27:30,836] [INFO] [<frozen importlib] - Training completed at iteration 37
[2025-11-19 08:27:30,836] [INFO] [<frozen importlib] - Best train loss: 0.7655
[2025-11-19 08:27:30,836] [INFO] [<frozen importlib] - Best val loss: 0.6477
[2025-11-19 08:27:30,836] [INFO] [<frozen importlib] - Best val AUC: 0.6970
[2025-11-19 08:27:30,836] [INFO] [<frozen importlib] - Best val AUCPR: 0.2113
[2025-11-19 08:27:30,840] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:27:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:27:41,099] [INFO] [<frozen importlib] - Optimal threshold: 0.5810
[2025-11-19 08:27:41,099] [INFO] [<frozen importlib] - Best f1: 0.2648
[2025-11-19 08:27:41,099] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:27:41,141] [INFO] [<frozen importlib] - Validation Results (threshold=0.5810):
[2025-11-19 08:27:41,141] [INFO] [<frozen importlib] -   Accuracy: 0.8880
[2025-11-19 08:27:41,141] [INFO] [<frozen importlib] -   Precision: 0.2672
[2025-11-19 08:27:41,141] [INFO] [<frozen importlib] -   Recall: 0.2624
[2025-11-19 08:27:41,141] [INFO] [<frozen importlib] -   F1 Score: 0.2648
[2025-11-19 08:27:41,141] [INFO] [<frozen importlib] -   AUROC: 0.6970
[2025-11-19 08:27:41,141] [INFO] [<frozen importlib] -   AUPRC: 0.2117
[2025-11-19 08:27:41,142] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:27:41,142] [INFO] [<frozen importlib] -     TN=16400, FP=1045
[2025-11-19 08:27:41,142] [INFO] [<frozen importlib] -     FN=1071, TP=381
[2025-11-19 08:27:41,163] [INFO] [<frozen importlib] - Trial 46: AUPRC=0.2117, F1=0.4433, Prec=0.4049, Rec=0.4897 | Optimizing auprc=0.2117
                                                                                        Best trial: 15. Best value: 0.234562:   9%|▉         | 46/500 [05:39<1:01:10,  8.09s/it]Best trial: 15. Best value: 0.234562:   9%|▉         | 46/500 [05:39<1:01:10,  8.09s/it]Best trial: 15. Best value: 0.234562:   9%|▉         | 47/500 [05:39<1:06:45,  8.84s/it][2025-11-19 08:27:41,170] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.087262413648594
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   gamma: 0.5862305982824132
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   alpha: 1.8709479313376645
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   lambda: 4.642940977792145
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   learning_rate: 0.05410645853960025
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   subsample: 0.9735519743285501
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   colsample_bytree: 0.5266111012462535
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8610097304899343
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   colsample_bynode: 0.7131743415918218
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:27:41,170] [INFO] [<frozen importlib] -   scale_pos_weight: 6.087262413648594
[2025-11-19 08:27:41,241] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:27:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:27:41,163] Trial 46 finished with value: 0.21165021024787387 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.4800761884538511, 'learning_rate': 0.04465602605392701, 'n_estimators': 300, 'alpha': 1.4216601093219623, 'lambda': 1.6114744956065785, 'subsample': 0.6788745090381901, 'colsample_bytree': 0.645437173149172, 'colsample_bylevel': 0.666421175392507, 'colsample_bynode': 0.6788984114745379, 'scale_pos_weight': 9.900737343940996}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.64791	train-auc:0.63591	train-aucpr:0.22544	val-logloss:0.63456	val-auc:0.59840	val-aucpr:0.10174
[10]	train-logloss:0.62448	train-auc:0.66380	train-aucpr:0.26456	val-logloss:0.56751	val-auc:0.63774	val-aucpr:0.16024
[20]	train-logloss:0.61147	train-auc:0.67091	train-aucpr:0.27709	val-logloss:0.52989	val-auc:0.64922	val-aucpr:0.18062
[30]	train-logloss:0.60272	train-auc:0.68041	train-aucpr:0.28880	val-logloss:0.51572	val-auc:0.65339	val-aucpr:0.18445
[40]	train-logloss:0.59700	train-auc:0.68797	train-aucpr:0.29409	val-logloss:0.50872	val-auc:0.66317	val-aucpr:0.19919
[50]	train-logloss:0.59279	train-auc:0.69308	train-aucpr:0.29908	val-logloss:0.51019	val-auc:0.67257	val-aucpr:0.21163
[60]	train-logloss:0.58917	train-auc:0.69634	train-aucpr:0.30578	val-logloss:0.49548	val-auc:0.69721	val-aucpr:0.21869
[70]	train-logloss:0.58639	train-auc:0.69958	train-aucpr:0.30882	val-logloss:0.48329	val-auc:0.69990	val-aucpr:0.22076
[80]	train-logloss:0.58394	train-auc:0.70266	train-aucpr:0.31220	val-logloss:0.48789	val-auc:0.68391	val-aucpr:0.20835
[90]	train-logloss:0.58162	train-auc:0.70661	train-aucpr:0.31626	val-logloss:0.47638	val-auc:0.68228	val-aucpr:0.20898
[93]	train-logloss:0.58114	train-auc:0.70759	train-aucpr:0.31691	val-logloss:0.47306	val-auc:0.68002	val-aucpr:0.20586
[2025-11-19 08:27:41,456] [INFO] [<frozen importlib] - Training completed at iteration 63
[2025-11-19 08:27:41,456] [INFO] [<frozen importlib] - Best train loss: 0.5884
[2025-11-19 08:27:41,456] [INFO] [<frozen importlib] - Best val loss: 0.4923
[2025-11-19 08:27:41,456] [INFO] [<frozen importlib] - Best val AUC: 0.6992
[2025-11-19 08:27:41,456] [INFO] [<frozen importlib] - Best val AUCPR: 0.2213
[2025-11-19 08:27:41,459] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:27:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:27:49,689] [INFO] [<frozen importlib] - Optimal threshold: 0.4670
[2025-11-19 08:27:49,689] [INFO] [<frozen importlib] - Best f1: 0.2766
[2025-11-19 08:27:49,689] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:27:49,729] [INFO] [<frozen importlib] - Validation Results (threshold=0.4670):
[2025-11-19 08:27:49,729] [INFO] [<frozen importlib] -   Accuracy: 0.9006
[2025-11-19 08:27:49,729] [INFO] [<frozen importlib] -   Precision: 0.3138
[2025-11-19 08:27:49,729] [INFO] [<frozen importlib] -   Recall: 0.2472
[2025-11-19 08:27:49,729] [INFO] [<frozen importlib] -   F1 Score: 0.2766
[2025-11-19 08:27:49,729] [INFO] [<frozen importlib] -   AUROC: 0.6992
[2025-11-19 08:27:49,729] [INFO] [<frozen importlib] -   AUPRC: 0.2219
[2025-11-19 08:27:49,729] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:27:49,729] [INFO] [<frozen importlib] -     TN=16660, FP=785
[2025-11-19 08:27:49,729] [INFO] [<frozen importlib] -     FN=1093, TP=359
[2025-11-19 08:27:49,752] [INFO] [<frozen importlib] - Trial 47: AUPRC=0.2219, F1=0.4535, Prec=0.4552, Rec=0.4518 | Optimizing auprc=0.2219
                                                                                        Best trial: 15. Best value: 0.234562:   9%|▉         | 47/500 [05:47<1:06:45,  8.84s/it]Best trial: 15. Best value: 0.234562:   9%|▉         | 47/500 [05:47<1:06:45,  8.84s/it]Best trial: 15. Best value: 0.234562:  10%|▉         | 48/500 [05:47<1:06:02,  8.77s/it][2025-11-19 08:27:49,761] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 13.734033499655764
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   gamma: 0.4363414172848291
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   alpha: 0.9156086159992548
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   lambda: 3.260549482972523
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   learning_rate: 0.060201239800366756
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   subsample: 0.5912946734001372
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   colsample_bytree: 0.5861282843770939
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5851147289862435
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   colsample_bynode: 0.6453638564811379
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:27:49,761] [INFO] [<frozen importlib] -   scale_pos_weight: 13.734033499655764
[2025-11-19 08:27:49,837] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:27:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:27:49,752] Trial 47 finished with value: 0.2219395154420926 and parameters: {'max_depth': 3, 'min_child_weight': 8, 'gamma': 0.5862305982824132, 'learning_rate': 0.05410645853960025, 'n_estimators': 250, 'alpha': 1.8709479313376645, 'lambda': 4.642940977792145, 'subsample': 0.9735519743285501, 'colsample_bytree': 0.5266111012462535, 'colsample_bylevel': 0.8610097304899343, 'colsample_bynode': 0.7131743415918218, 'scale_pos_weight': 6.087262413648594}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.99018	train-auc:0.64001	train-aucpr:0.21976	val-logloss:1.01210	val-auc:0.63227	val-aucpr:0.12327
[10]	train-logloss:0.94281	train-auc:0.68283	train-aucpr:0.28482	val-logloss:0.88710	val-auc:0.65405	val-aucpr:0.16281
[20]	train-logloss:0.92024	train-auc:0.69333	train-aucpr:0.30170	val-logloss:0.81560	val-auc:0.68977	val-aucpr:0.20755
[30]	train-logloss:0.90615	train-auc:0.70129	train-aucpr:0.31088	val-logloss:0.77065	val-auc:0.69583	val-aucpr:0.22037
[40]	train-logloss:0.89743	train-auc:0.70813	train-aucpr:0.31438	val-logloss:0.72781	val-auc:0.69639	val-aucpr:0.21762
[50]	train-logloss:0.88958	train-auc:0.71403	train-aucpr:0.32038	val-logloss:0.69088	val-auc:0.69290	val-aucpr:0.20360
[60]	train-logloss:0.88228	train-auc:0.71989	train-aucpr:0.32674	val-logloss:0.68852	val-auc:0.68323	val-aucpr:0.18514
[63]	train-logloss:0.88108	train-auc:0.72132	train-aucpr:0.32847	val-logloss:0.68174	val-auc:0.68147	val-aucpr:0.17496
[2025-11-19 08:27:50,034] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:27:50,034] [INFO] [<frozen importlib] - Best train loss: 0.9020
[2025-11-19 08:27:50,034] [INFO] [<frozen importlib] - Best val loss: 0.7519
[2025-11-19 08:27:50,034] [INFO] [<frozen importlib] - Best val AUC: 0.6979
[2025-11-19 08:27:50,034] [INFO] [<frozen importlib] - Best val AUCPR: 0.2224
[2025-11-19 08:27:50,036] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:27:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:28:01,507] [INFO] [<frozen importlib] - Optimal threshold: 0.6546
[2025-11-19 08:28:01,507] [INFO] [<frozen importlib] - Best f1: 0.2583
[2025-11-19 08:28:01,507] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:28:01,547] [INFO] [<frozen importlib] - Validation Results (threshold=0.6546):
[2025-11-19 08:28:01,547] [INFO] [<frozen importlib] -   Accuracy: 0.8954
[2025-11-19 08:28:01,547] [INFO] [<frozen importlib] -   Precision: 0.2838
[2025-11-19 08:28:01,547] [INFO] [<frozen importlib] -   Recall: 0.2369
[2025-11-19 08:28:01,547] [INFO] [<frozen importlib] -   F1 Score: 0.2583
[2025-11-19 08:28:01,547] [INFO] [<frozen importlib] -   AUROC: 0.6979
[2025-11-19 08:28:01,547] [INFO] [<frozen importlib] -   AUPRC: 0.2227
[2025-11-19 08:28:01,547] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:28:01,547] [INFO] [<frozen importlib] -     TN=16577, FP=868
[2025-11-19 08:28:01,547] [INFO] [<frozen importlib] -     FN=1108, TP=344
[2025-11-19 08:28:01,570] [INFO] [<frozen importlib] - Trial 48: AUPRC=0.2227, F1=0.4631, Prec=0.4461, Rec=0.4814 | Optimizing auprc=0.2227
[2025-11-19 08:28:01,571] [INFO] [<frozen importlib] - Trial 48 pruned.
[2025-11-19 08:28:01,571] [ERROR] [<frozen importlib] - Trial 48 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:  10%|▉         | 48/500 [05:59<1:06:02,  8.77s/it]Best trial: 15. Best value: 0.234562:  10%|▉         | 48/500 [05:59<1:06:02,  8.77s/it]Best trial: 15. Best value: 0.234562:  10%|▉         | 49/500 [05:59<1:12:46,  9.68s/it][2025-11-19 08:28:01,578] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.979751207588775
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   gamma: 0.6697385527885271
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   alpha: 1.2348818858825503
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   lambda: 3.9229052320509146
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   learning_rate: 0.03823021090406931
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   subsample: 0.7025509816564218
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   colsample_bytree: 0.713255741938926
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8096159715409128
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   colsample_bynode: 0.894225120418674
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:28:01,578] [INFO] [<frozen importlib] -   scale_pos_weight: 6.979751207588775
[2025-11-19 08:28:01,651] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:28:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:28:01,571] Trial 48 pruned. 
[0]	train-logloss:0.69745	train-auc:0.65260	train-aucpr:0.23974	val-logloss:0.69424	val-auc:0.56508	val-aucpr:0.09276
[10]	train-logloss:0.67159	train-auc:0.68348	train-aucpr:0.27898	val-logloss:0.62439	val-auc:0.67407	val-aucpr:0.17378
[20]	train-logloss:0.65554	train-auc:0.69218	train-aucpr:0.29717	val-logloss:0.58604	val-auc:0.68578	val-aucpr:0.19446
[30]	train-logloss:0.64490	train-auc:0.69826	train-aucpr:0.30414	val-logloss:0.56234	val-auc:0.69214	val-aucpr:0.19601
[40]	train-logloss:0.63699	train-auc:0.70209	train-aucpr:0.31111	val-logloss:0.54704	val-auc:0.68992	val-aucpr:0.19939
[50]	train-logloss:0.63139	train-auc:0.70538	train-aucpr:0.31535	val-logloss:0.53172	val-auc:0.69559	val-aucpr:0.21119
[60]	train-logloss:0.62651	train-auc:0.70988	train-aucpr:0.32028	val-logloss:0.50948	val-auc:0.69978	val-aucpr:0.21332
[70]	train-logloss:0.62252	train-auc:0.71444	train-aucpr:0.32501	val-logloss:0.49132	val-auc:0.70433	val-aucpr:0.21595
[80]	train-logloss:0.61929	train-auc:0.71836	train-aucpr:0.32891	val-logloss:0.47778	val-auc:0.70442	val-aucpr:0.21527
[90]	train-logloss:0.61662	train-auc:0.72171	train-aucpr:0.33247	val-logloss:0.46930	val-auc:0.70234	val-aucpr:0.20751
[100]	train-logloss:0.61392	train-auc:0.72608	train-aucpr:0.33725	val-logloss:0.46503	val-auc:0.69814	val-aucpr:0.19864
[2025-11-19 08:28:01,931] [INFO] [<frozen importlib] - Training completed at iteration 70
[2025-11-19 08:28:01,931] [INFO] [<frozen importlib] - Best train loss: 0.6225
[2025-11-19 08:28:01,931] [INFO] [<frozen importlib] - Best val loss: 0.4913
[2025-11-19 08:28:01,931] [INFO] [<frozen importlib] - Best val AUC: 0.7043
[2025-11-19 08:28:01,931] [INFO] [<frozen importlib] - Best val AUCPR: 0.2159
[2025-11-19 08:28:01,934] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:28:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:28:15,339] [INFO] [<frozen importlib] - Optimal threshold: 0.4786
[2025-11-19 08:28:15,339] [INFO] [<frozen importlib] - Best f1: 0.2709
[2025-11-19 08:28:15,339] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:28:15,379] [INFO] [<frozen importlib] - Validation Results (threshold=0.4786):
[2025-11-19 08:28:15,380] [INFO] [<frozen importlib] -   Accuracy: 0.8955
[2025-11-19 08:28:15,380] [INFO] [<frozen importlib] -   Precision: 0.2920
[2025-11-19 08:28:15,380] [INFO] [<frozen importlib] -   Recall: 0.2528
[2025-11-19 08:28:15,380] [INFO] [<frozen importlib] -   F1 Score: 0.2709
[2025-11-19 08:28:15,380] [INFO] [<frozen importlib] -   AUROC: 0.7043
[2025-11-19 08:28:15,380] [INFO] [<frozen importlib] -   AUPRC: 0.2164
[2025-11-19 08:28:15,380] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:28:15,380] [INFO] [<frozen importlib] -     TN=16555, FP=890
[2025-11-19 08:28:15,380] [INFO] [<frozen importlib] -     FN=1085, TP=367
[2025-11-19 08:28:15,399] [INFO] [<frozen importlib] - Trial 49: AUPRC=0.2164, F1=0.4423, Prec=0.4277, Rec=0.4580 | Optimizing auprc=0.2164
                                                                                        Best trial: 15. Best value: 0.234562:  10%|▉         | 49/500 [06:13<1:12:46,  9.68s/it]Best trial: 15. Best value: 0.234562:  10%|▉         | 49/500 [06:13<1:12:46,  9.68s/it]Best trial: 15. Best value: 0.234562:  10%|█         | 50/500 [06:13<1:21:56, 10.93s/it][2025-11-19 08:28:15,406] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.095154086889723
[2025-11-19 08:28:15,406] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   gamma: 0.7331837308410015
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   alpha: 1.1065813389283083
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   lambda: 4.982672034634055
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   learning_rate: 0.09632551034200801
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   subsample: 0.6628729808828133
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   colsample_bytree: 0.5234537920791631
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9892122294860155
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   colsample_bynode: 0.8069747160560803
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:28:15,407] [INFO] [<frozen importlib] -   scale_pos_weight: 5.095154086889723
[2025-11-19 08:28:15,481] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:28:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:28:15,399] Trial 49 finished with value: 0.21637384776955776 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.6697385527885271, 'learning_rate': 0.03823021090406931, 'n_estimators': 250, 'alpha': 1.2348818858825503, 'lambda': 3.9229052320509146, 'subsample': 0.7025509816564218, 'colsample_bytree': 0.713255741938926, 'colsample_bylevel': 0.8096159715409128, 'colsample_bynode': 0.894225120418674, 'scale_pos_weight': 6.979751207588775}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.58688	train-auc:0.67325	train-aucpr:0.26724	val-logloss:0.56086	val-auc:0.65362	val-aucpr:0.15847
[10]	train-logloss:0.54569	train-auc:0.70730	train-aucpr:0.31937	val-logloss:0.46532	val-auc:0.68940	val-aucpr:0.20303
[20]	train-logloss:0.52860	train-auc:0.72289	train-aucpr:0.34002	val-logloss:0.44330	val-auc:0.69179	val-aucpr:0.19998
[30]	train-logloss:0.51891	train-auc:0.73565	train-aucpr:0.35503	val-logloss:0.40617	val-auc:0.68821	val-aucpr:0.19522
[33]	train-logloss:0.51591	train-auc:0.74282	train-aucpr:0.36003	val-logloss:0.40903	val-auc:0.68630	val-aucpr:0.19287
[2025-11-19 08:28:15,656] [INFO] [<frozen importlib] - Training completed at iteration 3
[2025-11-19 08:28:15,656] [INFO] [<frozen importlib] - Best train loss: 0.5694
[2025-11-19 08:28:15,656] [INFO] [<frozen importlib] - Best val loss: 0.5179
[2025-11-19 08:28:15,656] [INFO] [<frozen importlib] - Best val AUC: 0.6962
[2025-11-19 08:28:15,656] [INFO] [<frozen importlib] - Best val AUCPR: 0.2108
[2025-11-19 08:28:15,658] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:28:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:28:16,256] [INFO] [<frozen importlib] - Optimal threshold: 0.4271
[2025-11-19 08:28:16,256] [INFO] [<frozen importlib] - Best f1: 0.2596
[2025-11-19 08:28:16,256] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:28:16,300] [INFO] [<frozen importlib] - Validation Results (threshold=0.4271):
[2025-11-19 08:28:16,300] [INFO] [<frozen importlib] -   Accuracy: 0.8868
[2025-11-19 08:28:16,300] [INFO] [<frozen importlib] -   Precision: 0.2610
[2025-11-19 08:28:16,300] [INFO] [<frozen importlib] -   Recall: 0.2583
[2025-11-19 08:28:16,300] [INFO] [<frozen importlib] -   F1 Score: 0.2596
[2025-11-19 08:28:16,300] [INFO] [<frozen importlib] -   AUROC: 0.6962
[2025-11-19 08:28:16,300] [INFO] [<frozen importlib] -   AUPRC: 0.2077
[2025-11-19 08:28:16,301] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:28:16,301] [INFO] [<frozen importlib] -     TN=16383, FP=1062
[2025-11-19 08:28:16,301] [INFO] [<frozen importlib] -     FN=1077, TP=375
[2025-11-19 08:28:16,326] [INFO] [<frozen importlib] - Trial 50: AUPRC=0.2077, F1=0.4361, Prec=0.3976, Rec=0.4828 | Optimizing auprc=0.2077
                                                                                        Best trial: 15. Best value: 0.234562:  10%|█         | 50/500 [06:14<1:21:56, 10.93s/it]Best trial: 15. Best value: 0.234562:  10%|█         | 50/500 [06:14<1:21:56, 10.93s/it]Best trial: 15. Best value: 0.234562:  10%|█         | 51/500 [06:14<59:18,  7.93s/it]  [2025-11-19 08:28:16,339] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.974272236463646
[2025-11-19 08:28:16,339] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:28:16,339] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:28:16,339] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:28:16,339] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:28:16,339] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:28:16,339] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   gamma: 0.3607039938151157
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   alpha: 1.5666022549785792
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   lambda: 3.6768835801564923
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   learning_rate: 0.03270501773902967
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   subsample: 0.7895597638217988
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   colsample_bytree: 0.5042636412108364
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9064906233293373
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   colsample_bynode: 0.7538822610260812
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:28:16,340] [INFO] [<frozen importlib] -   scale_pos_weight: 11.974272236463646
[2025-11-19 08:28:16,413] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:28:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:28:16,326] Trial 50 finished with value: 0.20771448749874563 and parameters: {'max_depth': 5, 'min_child_weight': 5, 'gamma': 0.7331837308410015, 'learning_rate': 0.09632551034200801, 'n_estimators': 100, 'alpha': 1.1065813389283083, 'lambda': 4.982672034634055, 'subsample': 0.6628729808828133, 'colsample_bytree': 0.5234537920791631, 'colsample_bylevel': 0.9892122294860155, 'colsample_bynode': 0.8069747160560803, 'scale_pos_weight': 5.095154086889723}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.92879	train-auc:0.65442	train-aucpr:0.23754	val-logloss:0.94867	val-auc:0.64363	val-aucpr:0.13419
[10]	train-logloss:0.89671	train-auc:0.68235	train-aucpr:0.28576	val-logloss:0.86990	val-auc:0.69072	val-aucpr:0.18623
[20]	train-logloss:0.87781	train-auc:0.68762	train-aucpr:0.29444	val-logloss:0.81714	val-auc:0.69363	val-aucpr:0.19274
[30]	train-logloss:0.86475	train-auc:0.69266	train-aucpr:0.30071	val-logloss:0.77544	val-auc:0.69386	val-aucpr:0.20088
[40]	train-logloss:0.85523	train-auc:0.69638	train-aucpr:0.30384	val-logloss:0.75276	val-auc:0.69731	val-aucpr:0.20742
[50]	train-logloss:0.84725	train-auc:0.69946	train-aucpr:0.30824	val-logloss:0.71847	val-auc:0.70365	val-aucpr:0.21633
[60]	train-logloss:0.84151	train-auc:0.70371	train-aucpr:0.31228	val-logloss:0.70922	val-auc:0.70395	val-aucpr:0.22032
[70]	train-logloss:0.83640	train-auc:0.70709	train-aucpr:0.31647	val-logloss:0.70271	val-auc:0.70453	val-aucpr:0.21215
[80]	train-logloss:0.83186	train-auc:0.71121	train-aucpr:0.32049	val-logloss:0.68978	val-auc:0.69594	val-aucpr:0.20288
[86]	train-logloss:0.82969	train-auc:0.71300	train-aucpr:0.32185	val-logloss:0.68421	val-auc:0.69553	val-aucpr:0.20378
[2025-11-19 08:28:16,660] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 08:28:16,660] [INFO] [<frozen importlib] - Best train loss: 0.8438
[2025-11-19 08:28:16,660] [INFO] [<frozen importlib] - Best val loss: 0.7184
[2025-11-19 08:28:16,660] [INFO] [<frozen importlib] - Best val AUC: 0.7041
[2025-11-19 08:28:16,660] [INFO] [<frozen importlib] - Best val AUCPR: 0.2217
[2025-11-19 08:28:16,662] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:28:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:28:26,513] [INFO] [<frozen importlib] - Optimal threshold: 0.6331
[2025-11-19 08:28:26,513] [INFO] [<frozen importlib] - Best f1: 0.2708
[2025-11-19 08:28:26,513] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:28:26,557] [INFO] [<frozen importlib] - Validation Results (threshold=0.6331):
[2025-11-19 08:28:26,557] [INFO] [<frozen importlib] -   Accuracy: 0.9034
[2025-11-19 08:28:26,557] [INFO] [<frozen importlib] -   Precision: 0.3222
[2025-11-19 08:28:26,557] [INFO] [<frozen importlib] -   Recall: 0.2335
[2025-11-19 08:28:26,557] [INFO] [<frozen importlib] -   F1 Score: 0.2708
[2025-11-19 08:28:26,557] [INFO] [<frozen importlib] -   AUROC: 0.7041
[2025-11-19 08:28:26,557] [INFO] [<frozen importlib] -   AUPRC: 0.2220
[2025-11-19 08:28:26,557] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:28:26,557] [INFO] [<frozen importlib] -     TN=16732, FP=713
[2025-11-19 08:28:26,557] [INFO] [<frozen importlib] -     FN=1113, TP=339
[2025-11-19 08:28:26,582] [INFO] [<frozen importlib] - Trial 51: AUPRC=0.2220, F1=0.4458, Prec=0.4655, Rec=0.4277 | Optimizing auprc=0.2220
                                                                                      Best trial: 15. Best value: 0.234562:  10%|█         | 51/500 [06:24<59:18,  7.93s/it]Best trial: 15. Best value: 0.234562:  10%|█         | 51/500 [06:24<59:18,  7.93s/it]Best trial: 15. Best value: 0.234562:  10%|█         | 52/500 [06:24<1:04:24,  8.63s/it][2025-11-19 08:28:26,590] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.478403224498557
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   gamma: 0.22832702822360623
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   alpha: 1.3430593685218952
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   lambda: 4.411573042304613
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   learning_rate: 0.031251984379613754
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   subsample: 0.7123533397296291
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   colsample_bytree: 0.5482162442456877
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9495047720359461
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   colsample_bynode: 0.776604856310766
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:28:26,590] [INFO] [<frozen importlib] -   scale_pos_weight: 9.478403224498557
[2025-11-19 08:28:26,668] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:28:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:28:26,582] Trial 51 finished with value: 0.22195896120459882 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.3607039938151157, 'learning_rate': 0.03270501773902967, 'n_estimators': 200, 'alpha': 1.5666022549785792, 'lambda': 3.6768835801564923, 'subsample': 0.7895597638217988, 'colsample_bytree': 0.5042636412108364, 'colsample_bylevel': 0.9064906233293373, 'colsample_bynode': 0.7538822610260812, 'scale_pos_weight': 11.974272236463646}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.82333	train-auc:0.64660	train-aucpr:0.23246	val-logloss:0.83473	val-auc:0.63503	val-aucpr:0.14169
[10]	train-logloss:0.79573	train-auc:0.68332	train-aucpr:0.28543	val-logloss:0.76388	val-auc:0.67971	val-aucpr:0.19015
[20]	train-logloss:0.77832	train-auc:0.68726	train-aucpr:0.29457	val-logloss:0.72277	val-auc:0.69317	val-aucpr:0.20124
[30]	train-logloss:0.76594	train-auc:0.69274	train-aucpr:0.30116	val-logloss:0.68668	val-auc:0.69072	val-aucpr:0.20358
[40]	train-logloss:0.75690	train-auc:0.69764	train-aucpr:0.30598	val-logloss:0.66200	val-auc:0.69325	val-aucpr:0.20769
[50]	train-logloss:0.74939	train-auc:0.70270	train-aucpr:0.30997	val-logloss:0.64515	val-auc:0.70131	val-aucpr:0.21140
[60]	train-logloss:0.74349	train-auc:0.70545	train-aucpr:0.31325	val-logloss:0.63200	val-auc:0.70232	val-aucpr:0.21131
[70]	train-logloss:0.73878	train-auc:0.70795	train-aucpr:0.31741	val-logloss:0.62158	val-auc:0.70102	val-aucpr:0.21299
[77]	train-logloss:0.73593	train-auc:0.71128	train-aucpr:0.32008	val-logloss:0.61696	val-auc:0.70108	val-aucpr:0.21419
[2025-11-19 08:28:26,891] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 08:28:26,891] [INFO] [<frozen importlib] - Best train loss: 0.7513
[2025-11-19 08:28:26,891] [INFO] [<frozen importlib] - Best val loss: 0.6466
[2025-11-19 08:28:26,891] [INFO] [<frozen importlib] - Best val AUC: 0.6983
[2025-11-19 08:28:26,891] [INFO] [<frozen importlib] - Best val AUCPR: 0.2155
[2025-11-19 08:28:26,894] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:28:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:28:36,245] [INFO] [<frozen importlib] - Optimal threshold: 0.5726
[2025-11-19 08:28:36,245] [INFO] [<frozen importlib] - Best f1: 0.2628
[2025-11-19 08:28:36,245] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:28:36,285] [INFO] [<frozen importlib] - Validation Results (threshold=0.5726):
[2025-11-19 08:28:36,285] [INFO] [<frozen importlib] -   Accuracy: 0.8892
[2025-11-19 08:28:36,285] [INFO] [<frozen importlib] -   Precision: 0.2689
[2025-11-19 08:28:36,285] [INFO] [<frozen importlib] -   Recall: 0.2569
[2025-11-19 08:28:36,285] [INFO] [<frozen importlib] -   F1 Score: 0.2628
[2025-11-19 08:28:36,285] [INFO] [<frozen importlib] -   AUROC: 0.6983
[2025-11-19 08:28:36,285] [INFO] [<frozen importlib] -   AUPRC: 0.2158
[2025-11-19 08:28:36,285] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:28:36,285] [INFO] [<frozen importlib] -     TN=16431, FP=1014
[2025-11-19 08:28:36,285] [INFO] [<frozen importlib] -     FN=1079, TP=373
[2025-11-19 08:28:36,308] [INFO] [<frozen importlib] - Trial 52: AUPRC=0.2158, F1=0.4427, Prec=0.4087, Rec=0.4828 | Optimizing auprc=0.2158
                                                                                        Best trial: 15. Best value: 0.234562:  10%|█         | 52/500 [06:34<1:04:24,  8.63s/it]Best trial: 15. Best value: 0.234562:  10%|█         | 52/500 [06:34<1:04:24,  8.63s/it]Best trial: 15. Best value: 0.234562:  11%|█         | 53/500 [06:34<1:06:43,  8.96s/it][2025-11-19 08:28:36,315] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.358799057980422
[2025-11-19 08:28:36,315] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:28:36,315] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:28:36,315] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:28:36,315] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:28:36,315] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   gamma: 0.1341859652322327
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   alpha: 1.1844964866518939
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   lambda: 4.79281908411207
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   learning_rate: 0.03511072910414519
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   subsample: 0.6138054229815387
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   colsample_bytree: 0.5685533456267319
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9642928001232587
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   colsample_bynode: 0.8339337304359665
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:28:36,316] [INFO] [<frozen importlib] -   scale_pos_weight: 11.358799057980422
[2025-11-19 08:28:36,384] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:28:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:28:36,308] Trial 52 finished with value: 0.21580982636268622 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.22832702822360623, 'learning_rate': 0.031251984379613754, 'n_estimators': 200, 'alpha': 1.3430593685218952, 'lambda': 4.411573042304613, 'subsample': 0.7123533397296291, 'colsample_bytree': 0.5482162442456877, 'colsample_bylevel': 0.9495047720359461, 'colsample_bynode': 0.776604856310766, 'scale_pos_weight': 9.478403224498557}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.90420	train-auc:0.65274	train-aucpr:0.23625	val-logloss:0.92335	val-auc:0.56088	val-aucpr:0.08672
[10]	train-logloss:0.87068	train-auc:0.68274	train-aucpr:0.27437	val-logloss:0.83590	val-auc:0.68090	val-aucpr:0.18959
[20]	train-logloss:0.85081	train-auc:0.68919	train-aucpr:0.29141	val-logloss:0.77589	val-auc:0.69435	val-aucpr:0.20960
[30]	train-logloss:0.83729	train-auc:0.69577	train-aucpr:0.29984	val-logloss:0.72736	val-auc:0.70000	val-aucpr:0.22295
[40]	train-logloss:0.82771	train-auc:0.70083	train-aucpr:0.30576	val-logloss:0.69368	val-auc:0.70540	val-aucpr:0.21915
[50]	train-logloss:0.81989	train-auc:0.70480	train-aucpr:0.31116	val-logloss:0.68143	val-auc:0.70384	val-aucpr:0.22092
[60]	train-logloss:0.81367	train-auc:0.70916	train-aucpr:0.31552	val-logloss:0.64951	val-auc:0.70208	val-aucpr:0.22296
[64]	train-logloss:0.81086	train-auc:0.71169	train-aucpr:0.31758	val-logloss:0.64465	val-auc:0.69640	val-aucpr:0.21349
[2025-11-19 08:28:36,583] [INFO] [<frozen importlib] - Training completed at iteration 35
[2025-11-19 08:28:36,583] [INFO] [<frozen importlib] - Best train loss: 0.8320
[2025-11-19 08:28:36,583] [INFO] [<frozen importlib] - Best val loss: 0.7093
[2025-11-19 08:28:36,583] [INFO] [<frozen importlib] - Best val AUC: 0.7004
[2025-11-19 08:28:36,583] [INFO] [<frozen importlib] - Best val AUCPR: 0.2240
[2025-11-19 08:28:36,586] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:28:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:28:44,076] [INFO] [<frozen importlib] - Optimal threshold: 0.6043
[2025-11-19 08:28:44,076] [INFO] [<frozen importlib] - Best f1: 0.2700
[2025-11-19 08:28:44,076] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:28:44,195] [INFO] [<frozen importlib] - Validation Results (threshold=0.6043):
[2025-11-19 08:28:44,196] [INFO] [<frozen importlib] -   Accuracy: 0.8829
[2025-11-19 08:28:44,196] [INFO] [<frozen importlib] -   Precision: 0.2592
[2025-11-19 08:28:44,196] [INFO] [<frozen importlib] -   Recall: 0.2817
[2025-11-19 08:28:44,196] [INFO] [<frozen importlib] -   F1 Score: 0.2700
[2025-11-19 08:28:44,196] [INFO] [<frozen importlib] -   AUROC: 0.7004
[2025-11-19 08:28:44,196] [INFO] [<frozen importlib] -   AUPRC: 0.2243
[2025-11-19 08:28:44,196] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:28:44,196] [INFO] [<frozen importlib] -     TN=16276, FP=1169
[2025-11-19 08:28:44,196] [INFO] [<frozen importlib] -     FN=1043, TP=409
[2025-11-19 08:28:44,225] [INFO] [<frozen importlib] - Trial 53: AUPRC=0.2243, F1=0.4366, Prec=0.3851, Rec=0.5041 | Optimizing auprc=0.2243
                                                                                        Best trial: 15. Best value: 0.234562:  11%|█         | 53/500 [06:42<1:06:43,  8.96s/it]Best trial: 15. Best value: 0.234562:  11%|█         | 53/500 [06:42<1:06:43,  8.96s/it]Best trial: 15. Best value: 0.234562:  11%|█         | 54/500 [06:42<1:04:15,  8.64s/it][2025-11-19 08:28:44,232] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.435612763997241
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   gamma: 0.12049679491313742
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   alpha: 1.1580780177190115
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   lambda: 4.814064034568648
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   learning_rate: 0.034514135775826224
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   subsample: 0.6273048576090526
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   colsample_bytree: 0.5723246536630288
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9730855189112185
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   colsample_bynode: 0.8664470531230137
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:28:44,232] [INFO] [<frozen importlib] -   scale_pos_weight: 8.435612763997241
[2025-11-19 08:28:44,311] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:28:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:28:44,225] Trial 53 finished with value: 0.2243123251534227 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.1341859652322327, 'learning_rate': 0.03511072910414519, 'n_estimators': 250, 'alpha': 1.1844964866518939, 'lambda': 4.79281908411207, 'subsample': 0.6138054229815387, 'colsample_bytree': 0.5685533456267319, 'colsample_bylevel': 0.9642928001232587, 'colsample_bynode': 0.8339337304359665, 'scale_pos_weight': 11.358799057980422}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.77295	train-auc:0.65084	train-aucpr:0.23821	val-logloss:0.77949	val-auc:0.54820	val-aucpr:0.08188
[10]	train-logloss:0.74526	train-auc:0.68249	train-aucpr:0.27771	val-logloss:0.70863	val-auc:0.67871	val-aucpr:0.17972
[20]	train-logloss:0.72793	train-auc:0.69007	train-aucpr:0.29435	val-logloss:0.66395	val-auc:0.68963	val-aucpr:0.20021
[30]	train-logloss:0.71642	train-auc:0.69568	train-aucpr:0.30137	val-logloss:0.63416	val-auc:0.69164	val-aucpr:0.21820
[40]	train-logloss:0.70797	train-auc:0.69948	train-aucpr:0.30617	val-logloss:0.61377	val-auc:0.69626	val-aucpr:0.22089
[50]	train-logloss:0.70158	train-auc:0.70134	train-aucpr:0.30947	val-logloss:0.60610	val-auc:0.69980	val-aucpr:0.22320
[60]	train-logloss:0.69605	train-auc:0.70573	train-aucpr:0.31487	val-logloss:0.59553	val-auc:0.69769	val-aucpr:0.22367
[70]	train-logloss:0.69142	train-auc:0.70944	train-aucpr:0.31877	val-logloss:0.58250	val-auc:0.69088	val-aucpr:0.21810
[80]	train-logloss:0.68787	train-auc:0.71272	train-aucpr:0.32261	val-logloss:0.57037	val-auc:0.68788	val-aucpr:0.21352
[83]	train-logloss:0.68721	train-auc:0.71341	train-aucpr:0.32362	val-logloss:0.57499	val-auc:0.68869	val-aucpr:0.21525
[2025-11-19 08:28:44,582] [INFO] [<frozen importlib] - Training completed at iteration 54
[2025-11-19 08:28:44,582] [INFO] [<frozen importlib] - Best train loss: 0.6992
[2025-11-19 08:28:44,582] [INFO] [<frozen importlib] - Best val loss: 0.6027
[2025-11-19 08:28:44,582] [INFO] [<frozen importlib] - Best val AUC: 0.7002
[2025-11-19 08:28:44,582] [INFO] [<frozen importlib] - Best val AUCPR: 0.2248
[2025-11-19 08:28:44,585] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:28:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:28:56,027] [INFO] [<frozen importlib] - Optimal threshold: 0.5424
[2025-11-19 08:28:56,027] [INFO] [<frozen importlib] - Best f1: 0.2771
[2025-11-19 08:28:56,027] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:28:56,072] [INFO] [<frozen importlib] - Validation Results (threshold=0.5424):
[2025-11-19 08:28:56,072] [INFO] [<frozen importlib] -   Accuracy: 0.8959
[2025-11-19 08:28:56,072] [INFO] [<frozen importlib] -   Precision: 0.2971
[2025-11-19 08:28:56,072] [INFO] [<frozen importlib] -   Recall: 0.2596
[2025-11-19 08:28:56,072] [INFO] [<frozen importlib] -   F1 Score: 0.2771
[2025-11-19 08:28:56,072] [INFO] [<frozen importlib] -   AUROC: 0.7002
[2025-11-19 08:28:56,072] [INFO] [<frozen importlib] -   AUPRC: 0.2251
[2025-11-19 08:28:56,072] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:28:56,072] [INFO] [<frozen importlib] -     TN=16553, FP=892
[2025-11-19 08:28:56,072] [INFO] [<frozen importlib] -     FN=1075, TP=377
[2025-11-19 08:28:56,101] [INFO] [<frozen importlib] - Trial 54: AUPRC=0.2251, F1=0.4472, Prec=0.4308, Rec=0.4649 | Optimizing auprc=0.2251
                                                                                        Best trial: 15. Best value: 0.234562:  11%|█         | 54/500 [06:54<1:04:15,  8.64s/it]Best trial: 15. Best value: 0.234562:  11%|█         | 54/500 [06:54<1:04:15,  8.64s/it]Best trial: 15. Best value: 0.234562:  11%|█         | 55/500 [06:54<1:11:18,  9.61s/it][2025-11-19 08:28:56,108] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.498156682454743
[2025-11-19 08:28:56,108] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:28:56,108] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:28:56,108] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   gamma: 0.11212425665976584
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   alpha: 1.1536921445322288
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   lambda: 4.770471663412394
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   learning_rate: 0.03478835200703253
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   subsample: 0.6265659030225472
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   colsample_bytree: 0.5704566053018207
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9720178270169868
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   colsample_bynode: 0.859209475997325
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:28:56,109] [INFO] [<frozen importlib] -   scale_pos_weight: 8.498156682454743
[2025-11-19 08:28:56,188] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:28:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:28:56,101] Trial 54 finished with value: 0.2251016850537188 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.12049679491313742, 'learning_rate': 0.034514135775826224, 'n_estimators': 350, 'alpha': 1.1580780177190115, 'lambda': 4.814064034568648, 'subsample': 0.6273048576090526, 'colsample_bytree': 0.5723246536630288, 'colsample_bylevel': 0.9730855189112185, 'colsample_bynode': 0.8664470531230137, 'scale_pos_weight': 8.435612763997241}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.77603	train-auc:0.65070	train-aucpr:0.23817	val-logloss:0.78296	val-auc:0.54833	val-aucpr:0.08169
[10]	train-logloss:0.74807	train-auc:0.68277	train-aucpr:0.27657	val-logloss:0.70447	val-auc:0.67498	val-aucpr:0.18218
[20]	train-logloss:0.73047	train-auc:0.69057	train-aucpr:0.29502	val-logloss:0.65526	val-auc:0.69362	val-aucpr:0.20288
[30]	train-logloss:0.71884	train-auc:0.69528	train-aucpr:0.30238	val-logloss:0.62902	val-auc:0.69442	val-aucpr:0.21706
[40]	train-logloss:0.71037	train-auc:0.70031	train-aucpr:0.30724	val-logloss:0.61394	val-auc:0.69602	val-aucpr:0.21216
[50]	train-logloss:0.70404	train-auc:0.70257	train-aucpr:0.31100	val-logloss:0.58893	val-auc:0.69935	val-aucpr:0.21366
[60]	train-logloss:0.69867	train-auc:0.70725	train-aucpr:0.31549	val-logloss:0.57021	val-auc:0.69593	val-aucpr:0.21217
[63]	train-logloss:0.69696	train-auc:0.70928	train-aucpr:0.31743	val-logloss:0.56518	val-auc:0.68325	val-aucpr:0.20946
[2025-11-19 08:28:56,388] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:28:56,388] [INFO] [<frozen importlib] - Best train loss: 0.7149
[2025-11-19 08:28:56,388] [INFO] [<frozen importlib] - Best val loss: 0.6137
[2025-11-19 08:28:56,388] [INFO] [<frozen importlib] - Best val AUC: 0.6965
[2025-11-19 08:28:56,388] [INFO] [<frozen importlib] - Best val AUCPR: 0.2187
[2025-11-19 08:28:56,391] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:28:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:29:03,918] [INFO] [<frozen importlib] - Optimal threshold: 0.5429
[2025-11-19 08:29:03,918] [INFO] [<frozen importlib] - Best f1: 0.2700
[2025-11-19 08:29:03,918] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:29:03,962] [INFO] [<frozen importlib] - Validation Results (threshold=0.5429):
[2025-11-19 08:29:03,962] [INFO] [<frozen importlib] -   Accuracy: 0.8996
[2025-11-19 08:29:03,962] [INFO] [<frozen importlib] -   Precision: 0.3057
[2025-11-19 08:29:03,962] [INFO] [<frozen importlib] -   Recall: 0.2417
[2025-11-19 08:29:03,962] [INFO] [<frozen importlib] -   F1 Score: 0.2700
[2025-11-19 08:29:03,962] [INFO] [<frozen importlib] -   AUROC: 0.6965
[2025-11-19 08:29:03,962] [INFO] [<frozen importlib] -   AUPRC: 0.2190
[2025-11-19 08:29:03,962] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:29:03,962] [INFO] [<frozen importlib] -     TN=16648, FP=797
[2025-11-19 08:29:03,962] [INFO] [<frozen importlib] -     FN=1101, TP=351
[2025-11-19 08:29:03,989] [INFO] [<frozen importlib] - Trial 55: AUPRC=0.2190, F1=0.4447, Prec=0.4465, Rec=0.4428 | Optimizing auprc=0.2190
[2025-11-19 08:29:03,990] [INFO] [<frozen importlib] - Trial 55 pruned.
[2025-11-19 08:29:03,990] [ERROR] [<frozen importlib] - Trial 55 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:  11%|█         | 55/500 [07:01<1:11:18,  9.61s/it]Best trial: 15. Best value: 0.234562:  11%|█         | 55/500 [07:01<1:11:18,  9.61s/it]Best trial: 15. Best value: 0.234562:  11%|█         | 56/500 [07:01<1:07:18,  9.10s/it][2025-11-19 08:29:04,004] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.946481677621074
[2025-11-19 08:29:04,004] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:29:04,004] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:29:04,004] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:29:04,004] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:29:04,004] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:29:04,004] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:29:04,004] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:29:04,004] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 08:29:04,004] [INFO] [<frozen importlib] -   gamma: 0.1262965517425632
[2025-11-19 08:29:04,004] [INFO] [<frozen importlib] -   alpha: 1.7361322704298308
[2025-11-19 08:29:04,004] [INFO] [<frozen importlib] -   lambda: 4.084588065644413
[2025-11-19 08:29:04,005] [INFO] [<frozen importlib] -   learning_rate: 0.0432570909491344
[2025-11-19 08:29:04,005] [INFO] [<frozen importlib] -   subsample: 0.5447727519401928
[2025-11-19 08:29:04,005] [INFO] [<frozen importlib] -   colsample_bytree: 0.5960597684756495
[2025-11-19 08:29:04,005] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9966460459427406
[2025-11-19 08:29:04,005] [INFO] [<frozen importlib] -   colsample_bynode: 0.9229472278645222
[2025-11-19 08:29:04,005] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:29:04,005] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:29:04,005] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:29:04,005] [INFO] [<frozen importlib] -   scale_pos_weight: 7.946481677621074
[2025-11-19 08:29:04,088] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:29:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:29:03,990] Trial 55 pruned. 
[0]	train-logloss:0.74720	train-auc:0.65602	train-aucpr:0.24083	val-logloss:0.74700	val-auc:0.64656	val-aucpr:0.13121
[10]	train-logloss:0.71572	train-auc:0.68369	train-aucpr:0.28521	val-logloss:0.66744	val-auc:0.67846	val-aucpr:0.18421
[20]	train-logloss:0.69798	train-auc:0.69317	train-aucpr:0.29649	val-logloss:0.62314	val-auc:0.68932	val-aucpr:0.20592
[30]	train-logloss:0.68639	train-auc:0.70023	train-aucpr:0.30546	val-logloss:0.60421	val-auc:0.69160	val-aucpr:0.20397
[40]	train-logloss:0.67852	train-auc:0.70570	train-aucpr:0.31057	val-logloss:0.57534	val-auc:0.69071	val-aucpr:0.19716
[50]	train-logloss:0.67256	train-auc:0.70905	train-aucpr:0.31481	val-logloss:0.55875	val-auc:0.69042	val-aucpr:0.19844
[51]	train-logloss:0.67206	train-auc:0.70916	train-aucpr:0.31549	val-logloss:0.55687	val-auc:0.69062	val-aucpr:0.19923
[2025-11-19 08:29:04,258] [INFO] [<frozen importlib] - Training completed at iteration 22
[2025-11-19 08:29:04,258] [INFO] [<frozen importlib] - Best train loss: 0.6952
[2025-11-19 08:29:04,258] [INFO] [<frozen importlib] - Best val loss: 0.6155
[2025-11-19 08:29:04,258] [INFO] [<frozen importlib] - Best val AUC: 0.6912
[2025-11-19 08:29:04,258] [INFO] [<frozen importlib] - Best val AUCPR: 0.2100
[2025-11-19 08:29:04,261] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:29:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:29:08,856] [INFO] [<frozen importlib] - Optimal threshold: 0.5330
[2025-11-19 08:29:08,856] [INFO] [<frozen importlib] - Best f1: 0.2582
[2025-11-19 08:29:08,856] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:29:08,901] [INFO] [<frozen importlib] - Validation Results (threshold=0.5330):
[2025-11-19 08:29:08,901] [INFO] [<frozen importlib] -   Accuracy: 0.8814
[2025-11-19 08:29:08,901] [INFO] [<frozen importlib] -   Precision: 0.2486
[2025-11-19 08:29:08,901] [INFO] [<frozen importlib] -   Recall: 0.2686
[2025-11-19 08:29:08,902] [INFO] [<frozen importlib] -   F1 Score: 0.2582
[2025-11-19 08:29:08,902] [INFO] [<frozen importlib] -   AUROC: 0.6912
[2025-11-19 08:29:08,902] [INFO] [<frozen importlib] -   AUPRC: 0.2103
[2025-11-19 08:29:08,902] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:29:08,902] [INFO] [<frozen importlib] -     TN=16266, FP=1179
[2025-11-19 08:29:08,902] [INFO] [<frozen importlib] -     FN=1062, TP=390
[2025-11-19 08:29:08,928] [INFO] [<frozen importlib] - Trial 56: AUPRC=0.2103, F1=0.4418, Prec=0.3875, Rec=0.5138 | Optimizing auprc=0.2103
[2025-11-19 08:29:08,929] [INFO] [<frozen importlib] - Trial 56 pruned.
[2025-11-19 08:29:08,929] [ERROR] [<frozen importlib] - Trial 56 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:  11%|█         | 56/500 [07:06<1:07:18,  9.10s/it]Best trial: 15. Best value: 0.234562:  11%|█         | 56/500 [07:06<1:07:18,  9.10s/it]Best trial: 15. Best value: 0.234562:  11%|█▏        | 57/500 [07:06<57:57,  7.85s/it]  [2025-11-19 08:29:08,936] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.266170477225929
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   gamma: 0.14779228379712636
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   alpha: 0.026030694426153356
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   lambda: 4.835225647614894
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   learning_rate: 0.03000235738811515
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   subsample: 0.5884285828616498
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   colsample_bytree: 0.6306383693383575
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9532013730920565
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   colsample_bynode: 0.8701775640233947
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:29:08,937] [INFO] [<frozen importlib] -   scale_pos_weight: 7.266170477225929
[2025-11-19 08:29:09,020] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:29:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:29:08,929] Trial 56 pruned. 
[0]	train-logloss:0.71338	train-auc:0.65292	train-aucpr:0.24027	val-logloss:0.71376	val-auc:0.59421	val-aucpr:0.10397
[10]	train-logloss:0.69089	train-auc:0.67974	train-aucpr:0.27545	val-logloss:0.65331	val-auc:0.68971	val-aucpr:0.19463
[20]	train-logloss:0.67581	train-auc:0.68546	train-aucpr:0.29434	val-logloss:0.62077	val-auc:0.69132	val-aucpr:0.19814
[30]	train-logloss:0.66495	train-auc:0.69289	train-aucpr:0.30114	val-logloss:0.58645	val-auc:0.69269	val-aucpr:0.20642
[40]	train-logloss:0.65684	train-auc:0.69833	train-aucpr:0.30618	val-logloss:0.56632	val-auc:0.69693	val-aucpr:0.20488
[50]	train-logloss:0.65078	train-auc:0.70177	train-aucpr:0.31020	val-logloss:0.54426	val-auc:0.69994	val-aucpr:0.20957
[60]	train-logloss:0.64576	train-auc:0.70469	train-aucpr:0.31383	val-logloss:0.53421	val-auc:0.70193	val-aucpr:0.21346
[70]	train-logloss:0.64182	train-auc:0.70774	train-aucpr:0.31678	val-logloss:0.53350	val-auc:0.70174	val-aucpr:0.21411
[80]	train-logloss:0.63840	train-auc:0.71068	train-aucpr:0.31957	val-logloss:0.52720	val-auc:0.70344	val-aucpr:0.21475
[90]	train-logloss:0.63542	train-auc:0.71487	train-aucpr:0.32409	val-logloss:0.51659	val-auc:0.70434	val-aucpr:0.21471
[100]	train-logloss:0.63309	train-auc:0.71750	train-aucpr:0.32770	val-logloss:0.51628	val-auc:0.70374	val-aucpr:0.21496
[103]	train-logloss:0.63235	train-auc:0.71873	train-aucpr:0.32884	val-logloss:0.51936	val-auc:0.70128	val-aucpr:0.21396
[2025-11-19 08:29:09,336] [INFO] [<frozen importlib] - Training completed at iteration 74
[2025-11-19 08:29:09,336] [INFO] [<frozen importlib] - Best train loss: 0.6408
[2025-11-19 08:29:09,336] [INFO] [<frozen importlib] - Best val loss: 0.5305
[2025-11-19 08:29:09,336] [INFO] [<frozen importlib] - Best val AUC: 0.7029
[2025-11-19 08:29:09,336] [INFO] [<frozen importlib] - Best val AUCPR: 0.2159
[2025-11-19 08:29:09,339] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:29:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:29:23,565] [INFO] [<frozen importlib] - Optimal threshold: 0.5167
[2025-11-19 08:29:23,565] [INFO] [<frozen importlib] - Best f1: 0.2744
[2025-11-19 08:29:23,565] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:29:23,613] [INFO] [<frozen importlib] - Validation Results (threshold=0.5167):
[2025-11-19 08:29:23,613] [INFO] [<frozen importlib] -   Accuracy: 0.9034
[2025-11-19 08:29:23,613] [INFO] [<frozen importlib] -   Precision: 0.3246
[2025-11-19 08:29:23,613] [INFO] [<frozen importlib] -   Recall: 0.2376
[2025-11-19 08:29:23,613] [INFO] [<frozen importlib] -   F1 Score: 0.2744
[2025-11-19 08:29:23,613] [INFO] [<frozen importlib] -   AUROC: 0.7029
[2025-11-19 08:29:23,613] [INFO] [<frozen importlib] -   AUPRC: 0.2163
[2025-11-19 08:29:23,613] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:29:23,613] [INFO] [<frozen importlib] -     TN=16727, FP=718
[2025-11-19 08:29:23,613] [INFO] [<frozen importlib] -     FN=1107, TP=345
[2025-11-19 08:29:23,639] [INFO] [<frozen importlib] - Trial 57: AUPRC=0.2163, F1=0.4472, Prec=0.4654, Rec=0.4304 | Optimizing auprc=0.2163
                                                                                      Best trial: 15. Best value: 0.234562:  11%|█▏        | 57/500 [07:21<57:57,  7.85s/it]Best trial: 15. Best value: 0.234562:  11%|█▏        | 57/500 [07:21<57:57,  7.85s/it]Best trial: 15. Best value: 0.234562:  12%|█▏        | 58/500 [07:21<1:12:59,  9.91s/it][2025-11-19 08:29:23,648] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.093214189947208
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   gamma: 0.0555824245918507
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   alpha: 1.452919102705113
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   lambda: 4.694305605575112
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   learning_rate: 0.03500983724535085
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   subsample: 0.6203998578352514
[2025-11-19 08:29:23,648] [INFO] [<frozen importlib] -   colsample_bytree: 0.580873777105176
[2025-11-19 08:29:23,649] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9791087864525803
[2025-11-19 08:29:23,649] [INFO] [<frozen importlib] -   colsample_bynode: 0.8335356818171181
[2025-11-19 08:29:23,649] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:29:23,649] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:29:23,649] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:29:23,649] [INFO] [<frozen importlib] -   scale_pos_weight: 10.093214189947208
[2025-11-19 08:29:23,727] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:29:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:29:23,640] Trial 57 finished with value: 0.21631383469716603 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.14779228379712636, 'learning_rate': 0.03000235738811515, 'n_estimators': 400, 'alpha': 0.026030694426153356, 'lambda': 4.835225647614894, 'subsample': 0.5884285828616498, 'colsample_bytree': 0.6306383693383575, 'colsample_bylevel': 0.9532013730920565, 'colsample_bynode': 0.8701775640233947, 'scale_pos_weight': 7.266170477225929}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.85059	train-auc:0.65037	train-aucpr:0.23761	val-logloss:0.86543	val-auc:0.54833	val-aucpr:0.08169
[10]	train-logloss:0.81929	train-auc:0.68055	train-aucpr:0.27660	val-logloss:0.78083	val-auc:0.68240	val-aucpr:0.18481
[20]	train-logloss:0.80052	train-auc:0.68712	train-aucpr:0.29172	val-logloss:0.72097	val-auc:0.69323	val-aucpr:0.20241
[30]	train-logloss:0.78729	train-auc:0.69528	train-aucpr:0.30101	val-logloss:0.68944	val-auc:0.69713	val-aucpr:0.21064
[40]	train-logloss:0.77798	train-auc:0.69986	train-aucpr:0.30637	val-logloss:0.66086	val-auc:0.69897	val-aucpr:0.21043
[50]	train-logloss:0.77093	train-auc:0.70237	train-aucpr:0.31110	val-logloss:0.64551	val-auc:0.70025	val-aucpr:0.21779
[60]	train-logloss:0.76517	train-auc:0.70644	train-aucpr:0.31660	val-logloss:0.63985	val-auc:0.70095	val-aucpr:0.22014
[70]	train-logloss:0.76027	train-auc:0.71016	train-aucpr:0.31944	val-logloss:0.62632	val-auc:0.69778	val-aucpr:0.21404
[80]	train-logloss:0.75585	train-auc:0.71397	train-aucpr:0.32291	val-logloss:0.61054	val-auc:0.69917	val-aucpr:0.21622
[83]	train-logloss:0.75511	train-auc:0.71471	train-aucpr:0.32386	val-logloss:0.60873	val-auc:0.69930	val-aucpr:0.21681
[2025-11-19 08:29:23,978] [INFO] [<frozen importlib] - Training completed at iteration 54
[2025-11-19 08:29:23,978] [INFO] [<frozen importlib] - Best train loss: 0.7683
[2025-11-19 08:29:23,978] [INFO] [<frozen importlib] - Best val loss: 0.6469
[2025-11-19 08:29:23,978] [INFO] [<frozen importlib] - Best val AUC: 0.7017
[2025-11-19 08:29:23,978] [INFO] [<frozen importlib] - Best val AUCPR: 0.2212
[2025-11-19 08:29:23,981] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:29:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:29:36,224] [INFO] [<frozen importlib] - Optimal threshold: 0.5917
[2025-11-19 08:29:36,224] [INFO] [<frozen importlib] - Best f1: 0.2734
[2025-11-19 08:29:36,224] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:29:36,285] [INFO] [<frozen importlib] - Validation Results (threshold=0.5917):
[2025-11-19 08:29:36,285] [INFO] [<frozen importlib] -   Accuracy: 0.8993
[2025-11-19 08:29:36,285] [INFO] [<frozen importlib] -   Precision: 0.3068
[2025-11-19 08:29:36,285] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 08:29:36,285] [INFO] [<frozen importlib] -   F1 Score: 0.2734
[2025-11-19 08:29:36,285] [INFO] [<frozen importlib] -   AUROC: 0.7017
[2025-11-19 08:29:36,285] [INFO] [<frozen importlib] -   AUPRC: 0.2216
[2025-11-19 08:29:36,285] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:29:36,285] [INFO] [<frozen importlib] -     TN=16636, FP=809
[2025-11-19 08:29:36,285] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 08:29:36,319] [INFO] [<frozen importlib] - Trial 58: AUPRC=0.2216, F1=0.4603, Prec=0.4552, Rec=0.4656 | Optimizing auprc=0.2216
[2025-11-19 08:29:36,319] [INFO] [<frozen importlib] - Trial 58 pruned.
[2025-11-19 08:29:36,319] [ERROR] [<frozen importlib] - Trial 58 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:  12%|█▏        | 58/500 [07:34<1:12:59,  9.91s/it]Best trial: 15. Best value: 0.234562:  12%|█▏        | 58/500 [07:34<1:12:59,  9.91s/it]Best trial: 15. Best value: 0.234562:  12%|█▏        | 59/500 [07:34<1:18:55, 10.74s/it][2025-11-19 08:29:36,334] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.904467151325635
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   gamma: 0.06338854035901742
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   alpha: 1.2146737899365934
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   lambda: 4.469076632873126
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   learning_rate: 0.041839350067085904
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   subsample: 0.5649611751981264
[2025-11-19 08:29:36,334] [INFO] [<frozen importlib] -   colsample_bytree: 0.6604541583231665
[2025-11-19 08:29:36,335] [INFO] [<frozen importlib] -   colsample_bylevel: 0.933600033399397
[2025-11-19 08:29:36,335] [INFO] [<frozen importlib] -   colsample_bynode: 0.8159640490293928
[2025-11-19 08:29:36,335] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:29:36,335] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:29:36,335] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:29:36,335] [INFO] [<frozen importlib] -   scale_pos_weight: 8.904467151325635
[2025-11-19 08:29:36,439] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:29:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:29:36,319] Trial 58 pruned. 
[0]	train-logloss:0.79473	train-auc:0.65230	train-aucpr:0.22848	val-logloss:0.79924	val-auc:0.65302	val-aucpr:0.12382
[10]	train-logloss:0.76147	train-auc:0.68105	train-aucpr:0.28375	val-logloss:0.71099	val-auc:0.67962	val-aucpr:0.18885
[20]	train-logloss:0.74309	train-auc:0.68888	train-aucpr:0.29568	val-logloss:0.66475	val-auc:0.69142	val-aucpr:0.21206
[30]	train-logloss:0.73141	train-auc:0.69594	train-aucpr:0.30085	val-logloss:0.62690	val-auc:0.69431	val-aucpr:0.21388
[40]	train-logloss:0.72297	train-auc:0.70162	train-aucpr:0.30645	val-logloss:0.59445	val-auc:0.69688	val-aucpr:0.21382
[50]	train-logloss:0.71641	train-auc:0.70642	train-aucpr:0.31197	val-logloss:0.58986	val-auc:0.69366	val-aucpr:0.21155
[60]	train-logloss:0.71035	train-auc:0.71235	train-aucpr:0.31815	val-logloss:0.56750	val-auc:0.69462	val-aucpr:0.21229
[70]	train-logloss:0.70585	train-auc:0.71684	train-aucpr:0.32429	val-logloss:0.55576	val-auc:0.69239	val-aucpr:0.20299
[73]	train-logloss:0.70474	train-auc:0.71843	train-aucpr:0.32546	val-logloss:0.55295	val-auc:0.69379	val-aucpr:0.20241
[2025-11-19 08:29:36,665] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 08:29:36,665] [INFO] [<frozen importlib] - Best train loss: 0.7200
[2025-11-19 08:29:36,665] [INFO] [<frozen importlib] - Best val loss: 0.5966
[2025-11-19 08:29:36,665] [INFO] [<frozen importlib] - Best val AUC: 0.6994
[2025-11-19 08:29:36,665] [INFO] [<frozen importlib] - Best val AUCPR: 0.2181
[2025-11-19 08:29:36,668] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:29:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:29:47,939] [INFO] [<frozen importlib] - Optimal threshold: 0.5488
[2025-11-19 08:29:47,939] [INFO] [<frozen importlib] - Best f1: 0.2669
[2025-11-19 08:29:47,939] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:29:47,974] [INFO] [<frozen importlib] - Validation Results (threshold=0.5488):
[2025-11-19 08:29:47,974] [INFO] [<frozen importlib] -   Accuracy: 0.8945
[2025-11-19 08:29:47,974] [INFO] [<frozen importlib] -   Precision: 0.2863
[2025-11-19 08:29:47,974] [INFO] [<frozen importlib] -   Recall: 0.2500
[2025-11-19 08:29:47,974] [INFO] [<frozen importlib] -   F1 Score: 0.2669
[2025-11-19 08:29:47,974] [INFO] [<frozen importlib] -   AUROC: 0.6994
[2025-11-19 08:29:47,974] [INFO] [<frozen importlib] -   AUPRC: 0.2184
[2025-11-19 08:29:47,974] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:29:47,974] [INFO] [<frozen importlib] -     TN=16540, FP=905
[2025-11-19 08:29:47,974] [INFO] [<frozen importlib] -     FN=1089, TP=363
[2025-11-19 08:29:47,999] [INFO] [<frozen importlib] - Trial 59: AUPRC=0.2184, F1=0.4406, Prec=0.4239, Rec=0.4587 | Optimizing auprc=0.2184
                                                                                        Best trial: 15. Best value: 0.234562:  12%|█▏        | 59/500 [07:45<1:18:55, 10.74s/it]Best trial: 15. Best value: 0.234562:  12%|█▏        | 59/500 [07:45<1:18:55, 10.74s/it]Best trial: 15. Best value: 0.234562:  12%|█▏        | 60/500 [07:45<1:20:49, 11.02s/it][2025-11-19 08:29:48,007] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.383965074722878
[2025-11-19 08:29:48,007] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:29:48,007] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:29:48,007] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:29:48,007] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:29:48,007] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:29:48,007] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:29:48,007] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:29:48,007] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 08:29:48,007] [INFO] [<frozen importlib] -   gamma: 0.16013750578912106
[2025-11-19 08:29:48,007] [INFO] [<frozen importlib] -   alpha: 0.961785977089365
[2025-11-19 08:29:48,007] [INFO] [<frozen importlib] -   lambda: 4.979722254427728
[2025-11-19 08:29:48,008] [INFO] [<frozen importlib] -   learning_rate: 0.05089796566796697
[2025-11-19 08:29:48,008] [INFO] [<frozen importlib] -   subsample: 0.6692409741345771
[2025-11-19 08:29:48,008] [INFO] [<frozen importlib] -   colsample_bytree: 0.5413155868293643
[2025-11-19 08:29:48,008] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6327356773461652
[2025-11-19 08:29:48,008] [INFO] [<frozen importlib] -   colsample_bynode: 0.9052511908488592
[2025-11-19 08:29:48,008] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:29:48,008] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:29:48,008] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:29:48,008] [INFO] [<frozen importlib] -   scale_pos_weight: 10.383965074722878
[2025-11-19 08:29:48,106] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:29:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:29:48,000] Trial 59 finished with value: 0.21844009864821579 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.06338854035901742, 'learning_rate': 0.041839350067085904, 'n_estimators': 250, 'alpha': 1.2146737899365934, 'lambda': 4.469076632873126, 'subsample': 0.5649611751981264, 'colsample_bytree': 0.6604541583231665, 'colsample_bylevel': 0.933600033399397, 'colsample_bynode': 0.8159640490293928, 'scale_pos_weight': 8.904467151325635}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.86202	train-auc:0.63335	train-aucpr:0.22148	val-logloss:0.87660	val-auc:0.65658	val-aucpr:0.13975
[10]	train-logloss:0.82237	train-auc:0.68038	train-aucpr:0.29383	val-logloss:0.76825	val-auc:0.67919	val-aucpr:0.20140
[20]	train-logloss:0.80180	train-auc:0.68897	train-aucpr:0.30232	val-logloss:0.70829	val-auc:0.70365	val-aucpr:0.21065
[30]	train-logloss:0.78888	train-auc:0.69498	train-aucpr:0.30907	val-logloss:0.66872	val-auc:0.70650	val-aucpr:0.21950
[40]	train-logloss:0.78028	train-auc:0.70077	train-aucpr:0.31323	val-logloss:0.64161	val-auc:0.70711	val-aucpr:0.22437
[50]	train-logloss:0.77253	train-auc:0.70825	train-aucpr:0.31907	val-logloss:0.63776	val-auc:0.70208	val-aucpr:0.21441
[60]	train-logloss:0.76740	train-auc:0.71266	train-aucpr:0.32344	val-logloss:0.62875	val-auc:0.70383	val-aucpr:0.21947
[70]	train-logloss:0.76268	train-auc:0.71797	train-aucpr:0.32811	val-logloss:0.61538	val-auc:0.69637	val-aucpr:0.21378
[2025-11-19 08:29:48,334] [INFO] [<frozen importlib] - Training completed at iteration 40
[2025-11-19 08:29:48,334] [INFO] [<frozen importlib] - Best train loss: 0.7803
[2025-11-19 08:29:48,334] [INFO] [<frozen importlib] - Best val loss: 0.6416
[2025-11-19 08:29:48,334] [INFO] [<frozen importlib] - Best val AUC: 0.7071
[2025-11-19 08:29:48,334] [INFO] [<frozen importlib] - Best val AUCPR: 0.2244
[2025-11-19 08:29:48,338] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:29:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:29:59,705] [INFO] [<frozen importlib] - Optimal threshold: 0.5866
[2025-11-19 08:29:59,705] [INFO] [<frozen importlib] - Best f1: 0.2664
[2025-11-19 08:29:59,705] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:29:59,750] [INFO] [<frozen importlib] - Validation Results (threshold=0.5866):
[2025-11-19 08:29:59,750] [INFO] [<frozen importlib] -   Accuracy: 0.8861
[2025-11-19 08:29:59,750] [INFO] [<frozen importlib] -   Precision: 0.2637
[2025-11-19 08:29:59,750] [INFO] [<frozen importlib] -   Recall: 0.2693
[2025-11-19 08:29:59,750] [INFO] [<frozen importlib] -   F1 Score: 0.2664
[2025-11-19 08:29:59,750] [INFO] [<frozen importlib] -   AUROC: 0.7071
[2025-11-19 08:29:59,750] [INFO] [<frozen importlib] -   AUPRC: 0.2247
[2025-11-19 08:29:59,750] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:29:59,750] [INFO] [<frozen importlib] -     TN=16353, FP=1092
[2025-11-19 08:29:59,750] [INFO] [<frozen importlib] -     FN=1061, TP=391
[2025-11-19 08:29:59,779] [INFO] [<frozen importlib] - Trial 60: AUPRC=0.2247, F1=0.4412, Prec=0.3974, Rec=0.4959 | Optimizing auprc=0.2247
                                                                                        Best trial: 15. Best value: 0.234562:  12%|█▏        | 60/500 [07:57<1:20:49, 11.02s/it]Best trial: 15. Best value: 0.234562:  12%|█▏        | 60/500 [07:57<1:20:49, 11.02s/it]Best trial: 15. Best value: 0.234562:  12%|█▏        | 61/500 [07:57<1:22:18, 11.25s/it][2025-11-19 08:29:59,794] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.354192469816201
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   gamma: 0.2441957473988257
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   alpha: 0.9567329115470586
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   lambda: 4.997828363579103
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   learning_rate: 0.03764613295631585
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   subsample: 0.6697777498104494
[2025-11-19 08:29:59,794] [INFO] [<frozen importlib] -   colsample_bytree: 0.5404353639723163
[2025-11-19 08:29:59,795] [INFO] [<frozen importlib] -   colsample_bylevel: 0.543103511717632
[2025-11-19 08:29:59,795] [INFO] [<frozen importlib] -   colsample_bynode: 0.9126433544025856
[2025-11-19 08:29:59,795] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:29:59,795] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:29:59,795] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:29:59,795] [INFO] [<frozen importlib] -   scale_pos_weight: 11.354192469816201
[2025-11-19 08:29:59,885] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:29:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:29:59,779] Trial 60 finished with value: 0.22471863960165842 and parameters: {'max_depth': 4, 'min_child_weight': 9, 'gamma': 0.16013750578912106, 'learning_rate': 0.05089796566796697, 'n_estimators': 350, 'alpha': 0.961785977089365, 'lambda': 4.979722254427728, 'subsample': 0.6692409741345771, 'colsample_bytree': 0.5413155868293643, 'colsample_bylevel': 0.6327356773461652, 'colsample_bynode': 0.9052511908488592, 'scale_pos_weight': 10.383965074722878}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.90439	train-auc:0.62867	train-aucpr:0.21833	val-logloss:0.92659	val-auc:0.62970	val-aucpr:0.12868
[10]	train-logloss:0.87133	train-auc:0.68324	train-aucpr:0.28143	val-logloss:0.84677	val-auc:0.66941	val-aucpr:0.19086
[20]	train-logloss:0.85079	train-auc:0.68994	train-aucpr:0.29428	val-logloss:0.78008	val-auc:0.69283	val-aucpr:0.21771
[30]	train-logloss:0.83775	train-auc:0.69441	train-aucpr:0.30125	val-logloss:0.75222	val-auc:0.69444	val-aucpr:0.22017
[40]	train-logloss:0.82700	train-auc:0.70193	train-aucpr:0.30636	val-logloss:0.72655	val-auc:0.69736	val-aucpr:0.21008
[50]	train-logloss:0.81890	train-auc:0.70679	train-aucpr:0.31130	val-logloss:0.71364	val-auc:0.69629	val-aucpr:0.21005
[59]	train-logloss:0.81305	train-auc:0.70945	train-aucpr:0.31549	val-logloss:0.70537	val-auc:0.69720	val-aucpr:0.21461
[2025-11-19 08:30:00,079] [INFO] [<frozen importlib] - Training completed at iteration 30
[2025-11-19 08:30:00,079] [INFO] [<frozen importlib] - Best train loss: 0.8378
[2025-11-19 08:30:00,079] [INFO] [<frozen importlib] - Best val loss: 0.7522
[2025-11-19 08:30:00,079] [INFO] [<frozen importlib] - Best val AUC: 0.6944
[2025-11-19 08:30:00,079] [INFO] [<frozen importlib] - Best val AUCPR: 0.2202
[2025-11-19 08:30:00,084] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:30:00] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:30:07,944] [INFO] [<frozen importlib] - Optimal threshold: 0.6119
[2025-11-19 08:30:07,944] [INFO] [<frozen importlib] - Best f1: 0.2586
[2025-11-19 08:30:07,944] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:30:07,984] [INFO] [<frozen importlib] - Validation Results (threshold=0.6119):
[2025-11-19 08:30:07,984] [INFO] [<frozen importlib] -   Accuracy: 0.8798
[2025-11-19 08:30:07,984] [INFO] [<frozen importlib] -   Precision: 0.2458
[2025-11-19 08:30:07,984] [INFO] [<frozen importlib] -   Recall: 0.2727
[2025-11-19 08:30:07,984] [INFO] [<frozen importlib] -   F1 Score: 0.2586
[2025-11-19 08:30:07,984] [INFO] [<frozen importlib] -   AUROC: 0.6944
[2025-11-19 08:30:07,984] [INFO] [<frozen importlib] -   AUPRC: 0.2205
[2025-11-19 08:30:07,984] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:30:07,984] [INFO] [<frozen importlib] -     TN=16230, FP=1215
[2025-11-19 08:30:07,984] [INFO] [<frozen importlib] -     FN=1056, TP=396
[2025-11-19 08:30:08,005] [INFO] [<frozen importlib] - Trial 61: AUPRC=0.2205, F1=0.4316, Prec=0.3766, Rec=0.5055 | Optimizing auprc=0.2205
                                                                                        Best trial: 15. Best value: 0.234562:  12%|█▏        | 61/500 [08:05<1:22:18, 11.25s/it]Best trial: 15. Best value: 0.234562:  12%|█▏        | 61/500 [08:05<1:22:18, 11.25s/it]Best trial: 15. Best value: 0.234562:  12%|█▏        | 62/500 [08:05<1:15:29, 10.34s/it][2025-11-19 08:30:08,014] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.551030225003107
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   min_child_weight: 10
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   gamma: 0.16552418629099613
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   alpha: 0.8715896750835027
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   lambda: 4.122124500804706
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   learning_rate: 0.04982210550327075
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   subsample: 0.63514367726737
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   colsample_bytree: 0.5195173048010522
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6060881401368987
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   colsample_bynode: 0.9564071848480931
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:30:08,014] [INFO] [<frozen importlib] -   scale_pos_weight: 9.551030225003107
[2025-11-19 08:30:08,089] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:30:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:30:08,006] Trial 61 finished with value: 0.2204933637478308 and parameters: {'max_depth': 4, 'min_child_weight': 9, 'gamma': 0.2441957473988257, 'learning_rate': 0.03764613295631585, 'n_estimators': 350, 'alpha': 0.9567329115470586, 'lambda': 4.997828363579103, 'subsample': 0.6697777498104494, 'colsample_bytree': 0.5404353639723163, 'colsample_bylevel': 0.543103511717632, 'colsample_bynode': 0.9126433544025856, 'scale_pos_weight': 11.354192469816201}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.82514	train-auc:0.63567	train-aucpr:0.22426	val-logloss:0.83696	val-auc:0.65289	val-aucpr:0.14829
[10]	train-logloss:0.78673	train-auc:0.68263	train-aucpr:0.28938	val-logloss:0.74016	val-auc:0.68185	val-aucpr:0.20648
[20]	train-logloss:0.76681	train-auc:0.69038	train-aucpr:0.30068	val-logloss:0.67791	val-auc:0.70322	val-aucpr:0.21178
[30]	train-logloss:0.75383	train-auc:0.69777	train-aucpr:0.30832	val-logloss:0.65137	val-auc:0.70301	val-aucpr:0.21223
[40]	train-logloss:0.74539	train-auc:0.70344	train-aucpr:0.31325	val-logloss:0.63164	val-auc:0.70767	val-aucpr:0.21502
[50]	train-logloss:0.73912	train-auc:0.70854	train-aucpr:0.31730	val-logloss:0.62068	val-auc:0.70892	val-aucpr:0.21956
[60]	train-logloss:0.73334	train-auc:0.71378	train-aucpr:0.32420	val-logloss:0.60849	val-auc:0.70774	val-aucpr:0.22163
[70]	train-logloss:0.72908	train-auc:0.71820	train-aucpr:0.32807	val-logloss:0.58721	val-auc:0.69177	val-aucpr:0.20298
[80]	train-logloss:0.72468	train-auc:0.72311	train-aucpr:0.33269	val-logloss:0.56810	val-auc:0.68763	val-aucpr:0.19972
[84]	train-logloss:0.72377	train-auc:0.72501	train-aucpr:0.33455	val-logloss:0.55752	val-auc:0.68119	val-aucpr:0.18591
[2025-11-19 08:30:08,330] [INFO] [<frozen importlib] - Training completed at iteration 54
[2025-11-19 08:30:08,330] [INFO] [<frozen importlib] - Best train loss: 0.7366
[2025-11-19 08:30:08,330] [INFO] [<frozen importlib] - Best val loss: 0.6153
[2025-11-19 08:30:08,330] [INFO] [<frozen importlib] - Best val AUC: 0.7093
[2025-11-19 08:30:08,330] [INFO] [<frozen importlib] - Best val AUCPR: 0.2226
[2025-11-19 08:30:08,334] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:30:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:30:22,026] [INFO] [<frozen importlib] - Optimal threshold: 0.5914
[2025-11-19 08:30:22,026] [INFO] [<frozen importlib] - Best f1: 0.2782
[2025-11-19 08:30:22,026] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:30:22,072] [INFO] [<frozen importlib] - Validation Results (threshold=0.5914):
[2025-11-19 08:30:22,072] [INFO] [<frozen importlib] -   Accuracy: 0.8968
[2025-11-19 08:30:22,072] [INFO] [<frozen importlib] -   Precision: 0.3006
[2025-11-19 08:30:22,072] [INFO] [<frozen importlib] -   Recall: 0.2590
[2025-11-19 08:30:22,072] [INFO] [<frozen importlib] -   F1 Score: 0.2782
[2025-11-19 08:30:22,072] [INFO] [<frozen importlib] -   AUROC: 0.7093
[2025-11-19 08:30:22,072] [INFO] [<frozen importlib] -   AUPRC: 0.2232
[2025-11-19 08:30:22,072] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:30:22,072] [INFO] [<frozen importlib] -     TN=16570, FP=875
[2025-11-19 08:30:22,072] [INFO] [<frozen importlib] -     FN=1076, TP=376
[2025-11-19 08:30:22,098] [INFO] [<frozen importlib] - Trial 62: AUPRC=0.2232, F1=0.4346, Prec=0.4247, Rec=0.4449 | Optimizing auprc=0.2232
[2025-11-19 08:30:22,098] [INFO] [<frozen importlib] - Trial 62 pruned.
[2025-11-19 08:30:22,098] [ERROR] [<frozen importlib] - Trial 62 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:  12%|█▏        | 62/500 [08:20<1:15:29, 10.34s/it]Best trial: 15. Best value: 0.234562:  12%|█▏        | 62/500 [08:20<1:15:29, 10.34s/it]Best trial: 15. Best value: 0.234562:  13%|█▎        | 63/500 [08:20<1:23:31, 11.47s/it][2025-11-19 08:30:22,108] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.532155664869206
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   gamma: 0.07385745191489393
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   alpha: 1.0282660030320274
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   lambda: 4.755698377075436
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   learning_rate: 0.032833307894704684
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   subsample: 0.7423046390318149
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   colsample_bytree: 0.500387698865045
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6447630491513691
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   colsample_bynode: 0.881275838118281
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:30:22,108] [INFO] [<frozen importlib] -   scale_pos_weight: 10.532155664869206
[2025-11-19 08:30:22,184] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:30:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:30:22,098] Trial 62 pruned. 
[0]	train-logloss:0.87037	train-auc:0.63763	train-aucpr:0.22251	val-logloss:0.88817	val-auc:0.65460	val-aucpr:0.14359
[10]	train-logloss:0.84086	train-auc:0.68169	train-aucpr:0.28252	val-logloss:0.81318	val-auc:0.67896	val-aucpr:0.17722
[20]	train-logloss:0.82193	train-auc:0.69005	train-aucpr:0.29570	val-logloss:0.75975	val-auc:0.69963	val-aucpr:0.21540
[30]	train-logloss:0.80892	train-auc:0.69485	train-aucpr:0.30224	val-logloss:0.71235	val-auc:0.70505	val-aucpr:0.22497
[40]	train-logloss:0.79947	train-auc:0.69853	train-aucpr:0.30618	val-logloss:0.69284	val-auc:0.70100	val-aucpr:0.22310
[50]	train-logloss:0.79175	train-auc:0.70268	train-aucpr:0.31099	val-logloss:0.68944	val-auc:0.69859	val-aucpr:0.22382
[60]	train-logloss:0.78569	train-auc:0.70677	train-aucpr:0.31526	val-logloss:0.68223	val-auc:0.69932	val-aucpr:0.22423
[70]	train-logloss:0.78076	train-auc:0.70993	train-aucpr:0.31846	val-logloss:0.67730	val-auc:0.69861	val-aucpr:0.21818
[80]	train-logloss:0.77702	train-auc:0.71301	train-aucpr:0.32138	val-logloss:0.66970	val-auc:0.69637	val-aucpr:0.21596
[85]	train-logloss:0.77543	train-auc:0.71429	train-aucpr:0.32247	val-logloss:0.65414	val-auc:0.69917	val-aucpr:0.22065
[2025-11-19 08:30:22,434] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 08:30:22,434] [INFO] [<frozen importlib] - Best train loss: 0.7882
[2025-11-19 08:30:22,434] [INFO] [<frozen importlib] - Best val loss: 0.6821
[2025-11-19 08:30:22,434] [INFO] [<frozen importlib] - Best val AUC: 0.6994
[2025-11-19 08:30:22,434] [INFO] [<frozen importlib] - Best val AUCPR: 0.2266
[2025-11-19 08:30:22,439] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:30:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:30:33,489] [INFO] [<frozen importlib] - Optimal threshold: 0.6020
[2025-11-19 08:30:33,489] [INFO] [<frozen importlib] - Best f1: 0.2688
[2025-11-19 08:30:33,489] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:30:33,543] [INFO] [<frozen importlib] - Validation Results (threshold=0.6020):
[2025-11-19 08:30:33,543] [INFO] [<frozen importlib] -   Accuracy: 0.8978
[2025-11-19 08:30:33,543] [INFO] [<frozen importlib] -   Precision: 0.2986
[2025-11-19 08:30:33,543] [INFO] [<frozen importlib] -   Recall: 0.2445
[2025-11-19 08:30:33,543] [INFO] [<frozen importlib] -   F1 Score: 0.2688
[2025-11-19 08:30:33,543] [INFO] [<frozen importlib] -   AUROC: 0.6994
[2025-11-19 08:30:33,543] [INFO] [<frozen importlib] -   AUPRC: 0.2270
[2025-11-19 08:30:33,543] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:30:33,543] [INFO] [<frozen importlib] -     TN=16611, FP=834
[2025-11-19 08:30:33,543] [INFO] [<frozen importlib] -     FN=1097, TP=355
[2025-11-19 08:30:33,570] [INFO] [<frozen importlib] - Trial 63: AUPRC=0.2270, F1=0.4428, Prec=0.4380, Rec=0.4477 | Optimizing auprc=0.2270
                                                                                        Best trial: 15. Best value: 0.234562:  13%|█▎        | 63/500 [08:31<1:23:31, 11.47s/it]Best trial: 15. Best value: 0.234562:  13%|█▎        | 63/500 [08:31<1:23:31, 11.47s/it]Best trial: 15. Best value: 0.234562:  13%|█▎        | 64/500 [08:31<1:23:20, 11.47s/it][2025-11-19 08:30:33,579] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 12.511891596824784
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   gamma: 0.07778032233477511
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   alpha: 0.7185691009120656
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   lambda: 2.3913716784875954
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   learning_rate: 0.046296336347522365
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   subsample: 0.7474625246336046
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   colsample_bytree: 0.5588909290059136
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6414056583485481
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   colsample_bynode: 0.889482132873315
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:30:33,579] [INFO] [<frozen importlib] -   scale_pos_weight: 12.511891596824784
[2025-11-19 08:30:33,659] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:30:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:30:33,571] Trial 63 finished with value: 0.22695003511293227 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.07385745191489393, 'learning_rate': 0.032833307894704684, 'n_estimators': 400, 'alpha': 1.0282660030320274, 'lambda': 4.755698377075436, 'subsample': 0.7423046390318149, 'colsample_bytree': 0.500387698865045, 'colsample_bylevel': 0.6447630491513691, 'colsample_bynode': 0.881275838118281, 'scale_pos_weight': 10.532155664869206}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.94714	train-auc:0.65614	train-aucpr:0.23438	val-logloss:0.96577	val-auc:0.65032	val-aucpr:0.13177
[10]	train-logloss:0.90562	train-auc:0.69034	train-aucpr:0.29391	val-logloss:0.85878	val-auc:0.67869	val-aucpr:0.18720
[20]	train-logloss:0.88485	train-auc:0.69536	train-aucpr:0.30089	val-logloss:0.79088	val-auc:0.69603	val-aucpr:0.19978
[30]	train-logloss:0.87142	train-auc:0.69973	train-aucpr:0.30741	val-logloss:0.74243	val-auc:0.69747	val-aucpr:0.21123
[40]	train-logloss:0.86201	train-auc:0.70345	train-aucpr:0.31248	val-logloss:0.69851	val-auc:0.69703	val-aucpr:0.21447
[50]	train-logloss:0.85379	train-auc:0.71002	train-aucpr:0.31776	val-logloss:0.69200	val-auc:0.69569	val-aucpr:0.20636
[60]	train-logloss:0.84817	train-auc:0.71366	train-aucpr:0.32231	val-logloss:0.67923	val-auc:0.69094	val-aucpr:0.19347
[70]	train-logloss:0.84291	train-auc:0.71938	train-aucpr:0.32733	val-logloss:0.65754	val-auc:0.67153	val-aucpr:0.16095
[2025-11-19 08:30:33,875] [INFO] [<frozen importlib] - Training completed at iteration 40
[2025-11-19 08:30:33,875] [INFO] [<frozen importlib] - Best train loss: 0.8620
[2025-11-19 08:30:33,875] [INFO] [<frozen importlib] - Best val loss: 0.6985
[2025-11-19 08:30:33,875] [INFO] [<frozen importlib] - Best val AUC: 0.6970
[2025-11-19 08:30:33,875] [INFO] [<frozen importlib] - Best val AUCPR: 0.2145
[2025-11-19 08:30:33,880] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:30:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:30:51,044] [INFO] [<frozen importlib] - Optimal threshold: 0.6184
[2025-11-19 08:30:51,044] [INFO] [<frozen importlib] - Best f1: 0.2650
[2025-11-19 08:30:51,044] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:30:51,123] [INFO] [<frozen importlib] - Validation Results (threshold=0.6184):
[2025-11-19 08:30:51,123] [INFO] [<frozen importlib] -   Accuracy: 0.8890
[2025-11-19 08:30:51,123] [INFO] [<frozen importlib] -   Precision: 0.2698
[2025-11-19 08:30:51,123] [INFO] [<frozen importlib] -   Recall: 0.2603
[2025-11-19 08:30:51,123] [INFO] [<frozen importlib] -   F1 Score: 0.2650
[2025-11-19 08:30:51,123] [INFO] [<frozen importlib] -   AUROC: 0.6970
[2025-11-19 08:30:51,124] [INFO] [<frozen importlib] -   AUPRC: 0.2148
[2025-11-19 08:30:51,124] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:30:51,124] [INFO] [<frozen importlib] -     TN=16422, FP=1023
[2025-11-19 08:30:51,124] [INFO] [<frozen importlib] -     FN=1074, TP=378
[2025-11-19 08:30:51,171] [INFO] [<frozen importlib] - Trial 64: AUPRC=0.2148, F1=0.4497, Prec=0.4124, Rec=0.4945 | Optimizing auprc=0.2148
[2025-11-19 08:30:51,171] [INFO] [<frozen importlib] - Trial 64 pruned.
[2025-11-19 08:30:51,171] [ERROR] [<frozen importlib] - Trial 64 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:  13%|█▎        | 64/500 [08:49<1:23:20, 11.47s/it]Best trial: 15. Best value: 0.234562:  13%|█▎        | 64/500 [08:49<1:23:20, 11.47s/it]Best trial: 15. Best value: 0.234562:  13%|█▎        | 65/500 [08:49<1:36:29, 13.31s/it][2025-11-19 08:30:51,180] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.279589608907585
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   gamma: 0.2034478091053893
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   alpha: 1.0518470059087877
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   lambda: 4.805194141991773
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   learning_rate: 0.05210481451539681
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   subsample: 0.6062893785352766
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   colsample_bytree: 0.504044537793473
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7327012944927144
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   colsample_bynode: 0.8496112691289571
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:30:51,180] [INFO] [<frozen importlib] -   scale_pos_weight: 10.279589608907585
[2025-11-19 08:30:51,313] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:30:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:30:51,171] Trial 64 pruned. 
[0]	train-logloss:0.85674	train-auc:0.64711	train-aucpr:0.22516	val-logloss:0.86416	val-auc:0.64870	val-aucpr:0.12317
[10]	train-logloss:0.81610	train-auc:0.68582	train-aucpr:0.29077	val-logloss:0.78294	val-auc:0.67922	val-aucpr:0.18461
[20]	train-logloss:0.79522	train-auc:0.69400	train-aucpr:0.30175	val-logloss:0.75120	val-auc:0.69641	val-aucpr:0.20172
[30]	train-logloss:0.78239	train-auc:0.70096	train-aucpr:0.30841	val-logloss:0.72117	val-auc:0.70045	val-aucpr:0.20749
[40]	train-logloss:0.77351	train-auc:0.70538	train-aucpr:0.31488	val-logloss:0.70529	val-auc:0.69436	val-aucpr:0.19782
[50]	train-logloss:0.76701	train-auc:0.70980	train-aucpr:0.32100	val-logloss:0.68175	val-auc:0.69726	val-aucpr:0.20443
[56]	train-logloss:0.76296	train-auc:0.71229	train-aucpr:0.32475	val-logloss:0.66445	val-auc:0.69815	val-aucpr:0.20688
[2025-11-19 08:30:51,558] [INFO] [<frozen importlib] - Training completed at iteration 27
[2025-11-19 08:30:51,558] [INFO] [<frozen importlib] - Best train loss: 0.7859
[2025-11-19 08:30:51,558] [INFO] [<frozen importlib] - Best val loss: 0.7228
[2025-11-19 08:30:51,558] [INFO] [<frozen importlib] - Best val AUC: 0.7041
[2025-11-19 08:30:51,558] [INFO] [<frozen importlib] - Best val AUCPR: 0.2104
[2025-11-19 08:30:51,566] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:30:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:31:03,697] [INFO] [<frozen importlib] - Optimal threshold: 0.6067
[2025-11-19 08:31:03,697] [INFO] [<frozen importlib] - Best f1: 0.2648
[2025-11-19 08:31:03,697] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:31:03,752] [INFO] [<frozen importlib] - Validation Results (threshold=0.6067):
[2025-11-19 08:31:03,752] [INFO] [<frozen importlib] -   Accuracy: 0.8816
[2025-11-19 08:31:03,752] [INFO] [<frozen importlib] -   Precision: 0.2531
[2025-11-19 08:31:03,752] [INFO] [<frozen importlib] -   Recall: 0.2775
[2025-11-19 08:31:03,752] [INFO] [<frozen importlib] -   F1 Score: 0.2648
[2025-11-19 08:31:03,752] [INFO] [<frozen importlib] -   AUROC: 0.7041
[2025-11-19 08:31:03,752] [INFO] [<frozen importlib] -   AUPRC: 0.2109
[2025-11-19 08:31:03,752] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:31:03,752] [INFO] [<frozen importlib] -     TN=16256, FP=1189
[2025-11-19 08:31:03,752] [INFO] [<frozen importlib] -     FN=1049, TP=403
[2025-11-19 08:31:03,781] [INFO] [<frozen importlib] - Trial 65: AUPRC=0.2109, F1=0.4387, Prec=0.3843, Rec=0.5110 | Optimizing auprc=0.2109
                                                                                        Best trial: 15. Best value: 0.234562:  13%|█▎        | 65/500 [09:01<1:36:29, 13.31s/it]Best trial: 15. Best value: 0.234562:  13%|█▎        | 65/500 [09:01<1:36:29, 13.31s/it]Best trial: 15. Best value: 0.234562:  13%|█▎        | 66/500 [09:01<1:34:44, 13.10s/it][2025-11-19 08:31:03,794] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.666539989072069
[2025-11-19 08:31:03,794] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   gamma: 0.02774152144413644
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   alpha: 1.1654409964882786
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   lambda: 4.406736879350412
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   learning_rate: 0.03924672057877188
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   subsample: 0.8161190144812464
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   colsample_bytree: 0.5736564547070458
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6882482026361328
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   colsample_bynode: 0.8729375111252283
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:31:03,795] [INFO] [<frozen importlib] -   scale_pos_weight: 11.666539989072069
[2025-11-19 08:31:03,890] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:31:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:31:03,781] Trial 65 finished with value: 0.21086754192047513 and parameters: {'max_depth': 4, 'min_child_weight': 4, 'gamma': 0.2034478091053893, 'learning_rate': 0.05210481451539681, 'n_estimators': 400, 'alpha': 1.0518470059087877, 'lambda': 4.805194141991773, 'subsample': 0.6062893785352766, 'colsample_bytree': 0.504044537793473, 'colsample_bylevel': 0.7327012944927144, 'colsample_bynode': 0.8496112691289571, 'scale_pos_weight': 10.279589608907585}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.91577	train-auc:0.65464	train-aucpr:0.22600	val-logloss:0.93198	val-auc:0.66718	val-aucpr:0.14903
[10]	train-logloss:0.87970	train-auc:0.68324	train-aucpr:0.28925	val-logloss:0.83200	val-auc:0.69815	val-aucpr:0.19724
[20]	train-logloss:0.85925	train-auc:0.69060	train-aucpr:0.29930	val-logloss:0.78016	val-auc:0.70209	val-aucpr:0.20394
[30]	train-logloss:0.84587	train-auc:0.69424	train-aucpr:0.30465	val-logloss:0.74816	val-auc:0.70169	val-aucpr:0.20878
[40]	train-logloss:0.83686	train-auc:0.69831	train-aucpr:0.30864	val-logloss:0.73747	val-auc:0.70170	val-aucpr:0.21038
[50]	train-logloss:0.82865	train-auc:0.70487	train-aucpr:0.31402	val-logloss:0.72917	val-auc:0.69443	val-aucpr:0.20981
[60]	train-logloss:0.82339	train-auc:0.70874	train-aucpr:0.31843	val-logloss:0.71750	val-auc:0.69202	val-aucpr:0.21397
[70]	train-logloss:0.81849	train-auc:0.71282	train-aucpr:0.32252	val-logloss:0.70690	val-auc:0.67486	val-aucpr:0.19411
[80]	train-logloss:0.81438	train-auc:0.71687	train-aucpr:0.32674	val-logloss:0.68177	val-auc:0.67010	val-aucpr:0.18332
[86]	train-logloss:0.81180	train-auc:0.71962	train-aucpr:0.32873	val-logloss:0.67756	val-auc:0.65826	val-aucpr:0.15910
[2025-11-19 08:31:04,218] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 08:31:04,218] [INFO] [<frozen importlib] - Best train loss: 0.8256
[2025-11-19 08:31:04,218] [INFO] [<frozen importlib] - Best val loss: 0.7169
[2025-11-19 08:31:04,218] [INFO] [<frozen importlib] - Best val AUC: 0.6957
[2025-11-19 08:31:04,218] [INFO] [<frozen importlib] - Best val AUCPR: 0.2153
[2025-11-19 08:31:04,223] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:31:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:31:26,874] [INFO] [<frozen importlib] - Optimal threshold: 0.6334
[2025-11-19 08:31:26,874] [INFO] [<frozen importlib] - Best f1: 0.2742
[2025-11-19 08:31:26,874] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:31:26,952] [INFO] [<frozen importlib] - Validation Results (threshold=0.6334):
[2025-11-19 08:31:26,952] [INFO] [<frozen importlib] -   Accuracy: 0.9019
[2025-11-19 08:31:26,952] [INFO] [<frozen importlib] -   Precision: 0.3179
[2025-11-19 08:31:26,952] [INFO] [<frozen importlib] -   Recall: 0.2410
[2025-11-19 08:31:26,952] [INFO] [<frozen importlib] -   F1 Score: 0.2742
[2025-11-19 08:31:26,952] [INFO] [<frozen importlib] -   AUROC: 0.6957
[2025-11-19 08:31:26,952] [INFO] [<frozen importlib] -   AUPRC: 0.2159
[2025-11-19 08:31:26,952] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:31:26,952] [INFO] [<frozen importlib] -     TN=16694, FP=751
[2025-11-19 08:31:26,952] [INFO] [<frozen importlib] -     FN=1102, TP=350
[2025-11-19 08:31:26,983] [INFO] [<frozen importlib] - Trial 66: AUPRC=0.2159, F1=0.4648, Prec=0.4704, Rec=0.4594 | Optimizing auprc=0.2159
[2025-11-19 08:31:26,984] [INFO] [<frozen importlib] - Trial 66 pruned.
[2025-11-19 08:31:26,984] [ERROR] [<frozen importlib] - Trial 66 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:  13%|█▎        | 66/500 [09:24<1:34:44, 13.10s/it]Best trial: 15. Best value: 0.234562:  13%|█▎        | 66/500 [09:24<1:34:44, 13.10s/it]Best trial: 15. Best value: 0.234562:  13%|█▎        | 67/500 [09:24<1:56:24, 16.13s/it][2025-11-19 08:31:26,997] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.94132488824361
[2025-11-19 08:31:26,997] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:31:26,997] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:31:26,997] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:31:26,997] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:31:26,997] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   gamma: 0.007773415241666762
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   alpha: 0.8069139034241302
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   lambda: 4.9366583360375
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   learning_rate: 0.03313955026399109
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   subsample: 0.6443330423746454
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   colsample_bytree: 0.6198445045273155
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5645700103539848
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   colsample_bynode: 0.8414577295792224
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:31:26,998] [INFO] [<frozen importlib] -   scale_pos_weight: 10.94132488824361
[2025-11-19 08:31:27,091] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:31:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:31:26,984] Trial 66 pruned. 
[0]	train-logloss:0.88714	train-auc:0.64706	train-aucpr:0.23517	val-logloss:0.90438	val-auc:0.59263	val-aucpr:0.12430
[10]	train-logloss:0.85617	train-auc:0.68159	train-aucpr:0.28311	val-logloss:0.82044	val-auc:0.68764	val-aucpr:0.19552
[20]	train-logloss:0.83723	train-auc:0.68733	train-aucpr:0.29316	val-logloss:0.76471	val-auc:0.69883	val-aucpr:0.20842
[30]	train-logloss:0.82413	train-auc:0.69402	train-aucpr:0.29940	val-logloss:0.74120	val-auc:0.70045	val-aucpr:0.21321
[40]	train-logloss:0.81459	train-auc:0.69915	train-aucpr:0.30401	val-logloss:0.72653	val-auc:0.69950	val-aucpr:0.20866
[50]	train-logloss:0.80720	train-auc:0.70187	train-aucpr:0.30905	val-logloss:0.70823	val-auc:0.70109	val-aucpr:0.21394
[60]	train-logloss:0.80153	train-auc:0.70540	train-aucpr:0.31231	val-logloss:0.69671	val-auc:0.70059	val-aucpr:0.21430
[70]	train-logloss:0.79693	train-auc:0.70724	train-aucpr:0.31542	val-logloss:0.67995	val-auc:0.69900	val-aucpr:0.21646
[80]	train-logloss:0.79264	train-auc:0.71066	train-aucpr:0.31834	val-logloss:0.66870	val-auc:0.70299	val-aucpr:0.22161
[90]	train-logloss:0.78960	train-auc:0.71343	train-aucpr:0.32158	val-logloss:0.65484	val-auc:0.69802	val-aucpr:0.21329
[100]	train-logloss:0.78614	train-auc:0.71746	train-aucpr:0.32500	val-logloss:0.65167	val-auc:0.69578	val-aucpr:0.20849
[109]	train-logloss:0.78353	train-auc:0.72099	train-aucpr:0.32841	val-logloss:0.63643	val-auc:0.68956	val-aucpr:0.20460
[2025-11-19 08:31:27,489] [INFO] [<frozen importlib] - Training completed at iteration 80
[2025-11-19 08:31:27,489] [INFO] [<frozen importlib] - Best train loss: 0.7926
[2025-11-19 08:31:27,489] [INFO] [<frozen importlib] - Best val loss: 0.6687
[2025-11-19 08:31:27,489] [INFO] [<frozen importlib] - Best val AUC: 0.7030
[2025-11-19 08:31:27,489] [INFO] [<frozen importlib] - Best val AUCPR: 0.2216
[2025-11-19 08:31:27,499] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:31:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:31:42,155] [INFO] [<frozen importlib] - Optimal threshold: 0.6113
[2025-11-19 08:31:42,155] [INFO] [<frozen importlib] - Best f1: 0.2690
[2025-11-19 08:31:42,155] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:31:42,208] [INFO] [<frozen importlib] - Validation Results (threshold=0.6113):
[2025-11-19 08:31:42,208] [INFO] [<frozen importlib] -   Accuracy: 0.9045
[2025-11-19 08:31:42,208] [INFO] [<frozen importlib] -   Precision: 0.3268
[2025-11-19 08:31:42,208] [INFO] [<frozen importlib] -   Recall: 0.2287
[2025-11-19 08:31:42,208] [INFO] [<frozen importlib] -   F1 Score: 0.2690
[2025-11-19 08:31:42,208] [INFO] [<frozen importlib] -   AUROC: 0.7030
[2025-11-19 08:31:42,208] [INFO] [<frozen importlib] -   AUPRC: 0.2220
[2025-11-19 08:31:42,208] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:31:42,209] [INFO] [<frozen importlib] -     TN=16761, FP=684
[2025-11-19 08:31:42,209] [INFO] [<frozen importlib] -     FN=1120, TP=332
[2025-11-19 08:31:42,236] [INFO] [<frozen importlib] - Trial 67: AUPRC=0.2220, F1=0.4505, Prec=0.4759, Rec=0.4277 | Optimizing auprc=0.2220
                                                                                        Best trial: 15. Best value: 0.234562:  13%|█▎        | 67/500 [09:40<1:56:24, 16.13s/it]Best trial: 15. Best value: 0.234562:  13%|█▎        | 67/500 [09:40<1:56:24, 16.13s/it]Best trial: 15. Best value: 0.234562:  14%|█▎        | 68/500 [09:40<1:54:14, 15.87s/it][2025-11-19 08:31:42,251] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.315977001782624
[2025-11-19 08:31:42,251] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:31:42,251] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:31:42,251] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:31:42,251] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:31:42,251] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:31:42,251] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:31:42,251] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:31:42,251] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   gamma: 0.07787870645383357
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   alpha: 0.969783873798149
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   lambda: 4.705151091769622
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   learning_rate: 0.05627144326562441
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   subsample: 0.7403746783757753
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   colsample_bytree: 0.5396667786744973
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6151575874030826
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   colsample_bynode: 0.9410379545532392
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:31:42,252] [INFO] [<frozen importlib] -   scale_pos_weight: 8.315977001782624
[2025-11-19 08:31:42,334] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:31:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:31:42,236] Trial 67 finished with value: 0.22199193219244706 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.007773415241666762, 'learning_rate': 0.03313955026399109, 'n_estimators': 400, 'alpha': 0.8069139034241302, 'lambda': 4.9366583360375, 'subsample': 0.6443330423746454, 'colsample_bytree': 0.6198445045273155, 'colsample_bylevel': 0.5645700103539848, 'colsample_bynode': 0.8414577295792224, 'scale_pos_weight': 10.94132488824361}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.76567	train-auc:0.63452	train-aucpr:0.21862	val-logloss:0.76865	val-auc:0.64841	val-aucpr:0.13294
[10]	train-logloss:0.72920	train-auc:0.68005	train-aucpr:0.29006	val-logloss:0.66863	val-auc:0.68884	val-aucpr:0.21139
[20]	train-logloss:0.71023	train-auc:0.69048	train-aucpr:0.30187	val-logloss:0.61482	val-auc:0.71139	val-aucpr:0.22320
[30]	train-logloss:0.69884	train-auc:0.69726	train-aucpr:0.30930	val-logloss:0.57749	val-auc:0.70045	val-aucpr:0.22374
[40]	train-logloss:0.69150	train-auc:0.70362	train-aucpr:0.31443	val-logloss:0.56195	val-auc:0.70598	val-aucpr:0.22689
[50]	train-logloss:0.68531	train-auc:0.70921	train-aucpr:0.31989	val-logloss:0.54835	val-auc:0.70541	val-aucpr:0.22194
[55]	train-logloss:0.68296	train-auc:0.71179	train-aucpr:0.32206	val-logloss:0.54640	val-auc:0.70685	val-aucpr:0.22659
[2025-11-19 08:31:42,533] [INFO] [<frozen importlib] - Training completed at iteration 26
[2025-11-19 08:31:42,533] [INFO] [<frozen importlib] - Best train loss: 0.7028
[2025-11-19 08:31:42,533] [INFO] [<frozen importlib] - Best val loss: 0.5877
[2025-11-19 08:31:42,533] [INFO] [<frozen importlib] - Best val AUC: 0.7075
[2025-11-19 08:31:42,533] [INFO] [<frozen importlib] - Best val AUCPR: 0.2275
[2025-11-19 08:31:42,536] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:31:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:31:49,319] [INFO] [<frozen importlib] - Optimal threshold: 0.5157
[2025-11-19 08:31:49,319] [INFO] [<frozen importlib] - Best f1: 0.2736
[2025-11-19 08:31:49,319] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:31:49,381] [INFO] [<frozen importlib] - Validation Results (threshold=0.5157):
[2025-11-19 08:31:49,381] [INFO] [<frozen importlib] -   Accuracy: 0.8823
[2025-11-19 08:31:49,381] [INFO] [<frozen importlib] -   Precision: 0.2601
[2025-11-19 08:31:49,381] [INFO] [<frozen importlib] -   Recall: 0.2886
[2025-11-19 08:31:49,381] [INFO] [<frozen importlib] -   F1 Score: 0.2736
[2025-11-19 08:31:49,381] [INFO] [<frozen importlib] -   AUROC: 0.7075
[2025-11-19 08:31:49,381] [INFO] [<frozen importlib] -   AUPRC: 0.2279
[2025-11-19 08:31:49,381] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:31:49,381] [INFO] [<frozen importlib] -     TN=16253, FP=1192
[2025-11-19 08:31:49,381] [INFO] [<frozen importlib] -     FN=1033, TP=419
[2025-11-19 08:31:49,407] [INFO] [<frozen importlib] - Trial 68: AUPRC=0.2279, F1=0.4318, Prec=0.3792, Rec=0.5014 | Optimizing auprc=0.2279
                                                                                        Best trial: 15. Best value: 0.234562:  14%|█▎        | 68/500 [09:47<1:54:14, 15.87s/it]Best trial: 15. Best value: 0.234562:  14%|█▎        | 68/500 [09:47<1:54:14, 15.87s/it]Best trial: 15. Best value: 0.234562:  14%|█▍        | 69/500 [09:47<1:35:14, 13.26s/it][2025-11-19 08:31:49,422] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.401498109756778
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   gamma: 0.08322920416534146
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   alpha: 0.6496727808845124
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   lambda: 3.8187889837622526
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   learning_rate: 0.057601970976626816
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   subsample: 0.743702193418994
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   colsample_bytree: 0.5375285924534576
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6336655763459837
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   colsample_bynode: 0.9434671567687313
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:31:49,423] [INFO] [<frozen importlib] -   scale_pos_weight: 8.401498109756778
[2025-11-19 08:31:49,507] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:31:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:31:49,407] Trial 68 finished with value: 0.22793335304215545 and parameters: {'max_depth': 4, 'min_child_weight': 9, 'gamma': 0.07787870645383357, 'learning_rate': 0.05627144326562441, 'n_estimators': 350, 'alpha': 0.969783873798149, 'lambda': 4.705151091769622, 'subsample': 0.7403746783757753, 'colsample_bytree': 0.5396667786744973, 'colsample_bylevel': 0.6151575874030826, 'colsample_bynode': 0.9410379545532392, 'scale_pos_weight': 8.315977001782624}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.76980	train-auc:0.63369	train-aucpr:0.22509	val-logloss:0.77301	val-auc:0.64663	val-aucpr:0.12237
[10]	train-logloss:0.73179	train-auc:0.68355	train-aucpr:0.29606	val-logloss:0.67453	val-auc:0.70270	val-aucpr:0.21086
[20]	train-logloss:0.71235	train-auc:0.69370	train-aucpr:0.30596	val-logloss:0.60970	val-auc:0.71093	val-aucpr:0.21942
[30]	train-logloss:0.70077	train-auc:0.69986	train-aucpr:0.31260	val-logloss:0.59088	val-auc:0.70376	val-aucpr:0.21897
[40]	train-logloss:0.69346	train-auc:0.70498	train-aucpr:0.31777	val-logloss:0.56818	val-auc:0.70304	val-aucpr:0.21792
[50]	train-logloss:0.68673	train-auc:0.71269	train-aucpr:0.32479	val-logloss:0.55352	val-auc:0.69935	val-aucpr:0.21058
[55]	train-logloss:0.68425	train-auc:0.71552	train-aucpr:0.32727	val-logloss:0.54916	val-auc:0.69889	val-aucpr:0.21220
[2025-11-19 08:31:49,686] [INFO] [<frozen importlib] - Training completed at iteration 26
[2025-11-19 08:31:49,686] [INFO] [<frozen importlib] - Best train loss: 0.7049
[2025-11-19 08:31:49,686] [INFO] [<frozen importlib] - Best val loss: 0.5977
[2025-11-19 08:31:49,686] [INFO] [<frozen importlib] - Best val AUC: 0.7092
[2025-11-19 08:31:49,686] [INFO] [<frozen importlib] - Best val AUCPR: 0.2210
[2025-11-19 08:31:49,689] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:31:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:31:57,055] [INFO] [<frozen importlib] - Optimal threshold: 0.5462
[2025-11-19 08:31:57,056] [INFO] [<frozen importlib] - Best f1: 0.2644
[2025-11-19 08:31:57,056] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:31:57,101] [INFO] [<frozen importlib] - Validation Results (threshold=0.5462):
[2025-11-19 08:31:57,101] [INFO] [<frozen importlib] -   Accuracy: 0.8881
[2025-11-19 08:31:57,101] [INFO] [<frozen importlib] -   Precision: 0.2672
[2025-11-19 08:31:57,101] [INFO] [<frozen importlib] -   Recall: 0.2617
[2025-11-19 08:31:57,101] [INFO] [<frozen importlib] -   F1 Score: 0.2644
[2025-11-19 08:31:57,101] [INFO] [<frozen importlib] -   AUROC: 0.7092
[2025-11-19 08:31:57,101] [INFO] [<frozen importlib] -   AUPRC: 0.2214
[2025-11-19 08:31:57,101] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:31:57,101] [INFO] [<frozen importlib] -     TN=16403, FP=1042
[2025-11-19 08:31:57,101] [INFO] [<frozen importlib] -     FN=1072, TP=380
[2025-11-19 08:31:57,133] [INFO] [<frozen importlib] - Trial 69: AUPRC=0.2214, F1=0.4383, Prec=0.4018, Rec=0.4821 | Optimizing auprc=0.2214
                                                                                        Best trial: 15. Best value: 0.234562:  14%|█▍        | 69/500 [09:55<1:35:14, 13.26s/it]Best trial: 15. Best value: 0.234562:  14%|█▍        | 69/500 [09:55<1:35:14, 13.26s/it]Best trial: 15. Best value: 0.234562:  14%|█▍        | 70/500 [09:55<1:23:07, 11.60s/it][2025-11-19 08:31:57,142] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.419967781408886
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   gamma: 0.84455255271769
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   alpha: 0.9721965388377476
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   lambda: 4.160540938175033
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   learning_rate: 0.06241498772618546
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   subsample: 0.8036418389265058
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   colsample_bytree: 0.5525083737252046
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6131841655618829
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   colsample_bynode: 0.9092435858477513
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:31:57,142] [INFO] [<frozen importlib] -   scale_pos_weight: 7.419967781408886
[2025-11-19 08:31:57,232] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:31:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:31:57,134] Trial 69 finished with value: 0.22135516504722164 and parameters: {'max_depth': 4, 'min_child_weight': 9, 'gamma': 0.08322920416534146, 'learning_rate': 0.057601970976626816, 'n_estimators': 400, 'alpha': 0.6496727808845124, 'lambda': 3.8187889837622526, 'subsample': 0.743702193418994, 'colsample_bytree': 0.5375285924534576, 'colsample_bylevel': 0.6336655763459837, 'colsample_bynode': 0.9434671567687313, 'scale_pos_weight': 8.401498109756778}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.71866	train-auc:0.64820	train-aucpr:0.22957	val-logloss:0.71534	val-auc:0.64326	val-aucpr:0.13035
[10]	train-logloss:0.68161	train-auc:0.68803	train-aucpr:0.29699	val-logloss:0.60885	val-auc:0.71038	val-aucpr:0.21311
[20]	train-logloss:0.66408	train-auc:0.69618	train-aucpr:0.30918	val-logloss:0.56730	val-auc:0.70494	val-aucpr:0.21008
[30]	train-logloss:0.65316	train-auc:0.70294	train-aucpr:0.31750	val-logloss:0.53716	val-auc:0.71104	val-aucpr:0.22217
[40]	train-logloss:0.64668	train-auc:0.70873	train-aucpr:0.32186	val-logloss:0.52465	val-auc:0.70304	val-aucpr:0.21914
[50]	train-logloss:0.64143	train-auc:0.71342	train-aucpr:0.32658	val-logloss:0.50792	val-auc:0.69848	val-aucpr:0.21292
[60]	train-logloss:0.63663	train-auc:0.72118	train-aucpr:0.33312	val-logloss:0.49857	val-auc:0.69378	val-aucpr:0.21024
[2025-11-19 08:31:57,441] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 08:31:57,441] [INFO] [<frozen importlib] - Best train loss: 0.6524
[2025-11-19 08:31:57,441] [INFO] [<frozen importlib] - Best val loss: 0.5367
[2025-11-19 08:31:57,441] [INFO] [<frozen importlib] - Best val AUC: 0.7112
[2025-11-19 08:31:57,441] [INFO] [<frozen importlib] - Best val AUCPR: 0.2222
[2025-11-19 08:31:57,445] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:31:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:32:04,580] [INFO] [<frozen importlib] - Optimal threshold: 0.5132
[2025-11-19 08:32:04,580] [INFO] [<frozen importlib] - Best f1: 0.2798
[2025-11-19 08:32:04,580] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:32:04,633] [INFO] [<frozen importlib] - Validation Results (threshold=0.5132):
[2025-11-19 08:32:04,633] [INFO] [<frozen importlib] -   Accuracy: 0.9049
[2025-11-19 08:32:04,633] [INFO] [<frozen importlib] -   Precision: 0.3346
[2025-11-19 08:32:04,633] [INFO] [<frozen importlib] -   Recall: 0.2404
[2025-11-19 08:32:04,633] [INFO] [<frozen importlib] -   F1 Score: 0.2798
[2025-11-19 08:32:04,633] [INFO] [<frozen importlib] -   AUROC: 0.7112
[2025-11-19 08:32:04,633] [INFO] [<frozen importlib] -   AUPRC: 0.2225
[2025-11-19 08:32:04,633] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:32:04,633] [INFO] [<frozen importlib] -     TN=16751, FP=694
[2025-11-19 08:32:04,633] [INFO] [<frozen importlib] -     FN=1103, TP=349
[2025-11-19 08:32:04,660] [INFO] [<frozen importlib] - Trial 70: AUPRC=0.2225, F1=0.4421, Prec=0.4674, Rec=0.4194 | Optimizing auprc=0.2225
                                                                                        Best trial: 15. Best value: 0.234562:  14%|█▍        | 70/500 [10:02<1:23:07, 11.60s/it]Best trial: 15. Best value: 0.234562:  14%|█▍        | 70/500 [10:02<1:23:07, 11.60s/it]Best trial: 15. Best value: 0.234562:  14%|█▍        | 71/500 [10:02<1:14:11, 10.38s/it][2025-11-19 08:32:04,670] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.5244361154680215
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   min_child_weight: 10
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   gamma: 0.16599564830404215
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   alpha: 1.0912197300398292
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   lambda: 4.724033900600399
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   learning_rate: 0.10481371950988097
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   subsample: 0.6966292834424002
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   colsample_bytree: 0.5160449547758015
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5785685856101995
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   colsample_bynode: 0.93203043025308
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:32:04,670] [INFO] [<frozen importlib] -   scale_pos_weight: 6.5244361154680215
[2025-11-19 08:32:04,757] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:32:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:32:04,660] Trial 70 finished with value: 0.2225293035653188 and parameters: {'max_depth': 4, 'min_child_weight': 9, 'gamma': 0.84455255271769, 'learning_rate': 0.06241498772618546, 'n_estimators': 300, 'alpha': 0.9721965388377476, 'lambda': 4.160540938175033, 'subsample': 0.8036418389265058, 'colsample_bytree': 0.5525083737252046, 'colsample_bylevel': 0.6131841655618829, 'colsample_bynode': 0.9092435858477513, 'scale_pos_weight': 7.419967781408886}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.66833	train-auc:0.63376	train-aucpr:0.23763	val-logloss:0.65888	val-auc:0.63159	val-aucpr:0.13605
[10]	train-logloss:0.62371	train-auc:0.69217	train-aucpr:0.30434	val-logloss:0.52610	val-auc:0.70230	val-aucpr:0.21759
[20]	train-logloss:0.60873	train-auc:0.70290	train-aucpr:0.31496	val-logloss:0.50130	val-auc:0.70184	val-aucpr:0.22089
[30]	train-logloss:0.60018	train-auc:0.71347	train-aucpr:0.32484	val-logloss:0.48524	val-auc:0.69671	val-aucpr:0.21667
[40]	train-logloss:0.59404	train-auc:0.72314	train-aucpr:0.33367	val-logloss:0.47518	val-auc:0.70241	val-aucpr:0.21394
[50]	train-logloss:0.58847	train-auc:0.73275	train-aucpr:0.34246	val-logloss:0.45849	val-auc:0.68708	val-aucpr:0.19473
[2025-11-19 08:32:04,929] [INFO] [<frozen importlib] - Training completed at iteration 20
[2025-11-19 08:32:04,929] [INFO] [<frozen importlib] - Best train loss: 0.6087
[2025-11-19 08:32:04,929] [INFO] [<frozen importlib] - Best val loss: 0.5013
[2025-11-19 08:32:04,929] [INFO] [<frozen importlib] - Best val AUC: 0.7018
[2025-11-19 08:32:04,929] [INFO] [<frozen importlib] - Best val AUCPR: 0.2209
[2025-11-19 08:32:04,932] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:32:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:32:09,212] [INFO] [<frozen importlib] - Optimal threshold: 0.4587
[2025-11-19 08:32:09,212] [INFO] [<frozen importlib] - Best f1: 0.2586
[2025-11-19 08:32:09,212] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:32:09,272] [INFO] [<frozen importlib] - Validation Results (threshold=0.4587):
[2025-11-19 08:32:09,273] [INFO] [<frozen importlib] -   Accuracy: 0.8716
[2025-11-19 08:32:09,273] [INFO] [<frozen importlib] -   Precision: 0.2324
[2025-11-19 08:32:09,273] [INFO] [<frozen importlib] -   Recall: 0.2913
[2025-11-19 08:32:09,273] [INFO] [<frozen importlib] -   F1 Score: 0.2586
[2025-11-19 08:32:09,273] [INFO] [<frozen importlib] -   AUROC: 0.7018
[2025-11-19 08:32:09,273] [INFO] [<frozen importlib] -   AUPRC: 0.2209
[2025-11-19 08:32:09,273] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:32:09,273] [INFO] [<frozen importlib] -     TN=16048, FP=1397
[2025-11-19 08:32:09,273] [INFO] [<frozen importlib] -     FN=1029, TP=423
[2025-11-19 08:32:09,299] [INFO] [<frozen importlib] - Trial 71: AUPRC=0.2209, F1=0.4423, Prec=0.3667, Rec=0.5572 | Optimizing auprc=0.2209
                                                                                        Best trial: 15. Best value: 0.234562:  14%|█▍        | 71/500 [10:07<1:14:11, 10.38s/it]Best trial: 15. Best value: 0.234562:  14%|█▍        | 71/500 [10:07<1:14:11, 10.38s/it]Best trial: 15. Best value: 0.234562:  14%|█▍        | 72/500 [10:07<1:01:44,  8.66s/it][2025-11-19 08:32:09,321] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.081047937704078
[2025-11-19 08:32:09,321] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:32:09,321] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:32:09,321] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:32:09,321] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:32:09,321] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:32:09,321] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:32:09,321] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:32:09,321] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   gamma: 0.1351349033129034
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   alpha: 0.8802036338037047
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   lambda: 4.375846356571814
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   learning_rate: 0.03603440203497565
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   subsample: 0.6834105515956264
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   colsample_bytree: 0.6013155556611881
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6687444585995664
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   colsample_bynode: 0.9796674456459568
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:32:09,322] [INFO] [<frozen importlib] -   scale_pos_weight: 8.081047937704078
[2025-11-19 08:32:09,418] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:32:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:32:09,299] Trial 71 finished with value: 0.2209478703834481 and parameters: {'max_depth': 4, 'min_child_weight': 10, 'gamma': 0.16599564830404215, 'learning_rate': 0.10481371950988097, 'n_estimators': 350, 'alpha': 1.0912197300398292, 'lambda': 4.724033900600399, 'subsample': 0.6966292834424002, 'colsample_bytree': 0.5160449547758015, 'colsample_bylevel': 0.5785685856101995, 'colsample_bynode': 0.93203043025308, 'scale_pos_weight': 6.5244361154680215}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.75509	train-auc:0.65358	train-aucpr:0.23694	val-logloss:0.75936	val-auc:0.54854	val-aucpr:0.08382
[10]	train-logloss:0.72718	train-auc:0.68357	train-aucpr:0.28964	val-logloss:0.68241	val-auc:0.68875	val-aucpr:0.19781
[20]	train-logloss:0.71014	train-auc:0.69007	train-aucpr:0.29747	val-logloss:0.63483	val-auc:0.69650	val-aucpr:0.20364
[30]	train-logloss:0.69896	train-auc:0.69632	train-aucpr:0.30424	val-logloss:0.59509	val-auc:0.70302	val-aucpr:0.21502
[40]	train-logloss:0.69070	train-auc:0.70050	train-aucpr:0.30852	val-logloss:0.58482	val-auc:0.70280	val-aucpr:0.21526
[50]	train-logloss:0.68453	train-auc:0.70294	train-aucpr:0.31241	val-logloss:0.56171	val-auc:0.70275	val-aucpr:0.21711
[60]	train-logloss:0.67953	train-auc:0.70633	train-aucpr:0.31621	val-logloss:0.56596	val-auc:0.69605	val-aucpr:0.20808
[70]	train-logloss:0.67514	train-auc:0.71051	train-aucpr:0.31978	val-logloss:0.56106	val-auc:0.69700	val-aucpr:0.20822
[78]	train-logloss:0.67237	train-auc:0.71393	train-aucpr:0.32321	val-logloss:0.55178	val-auc:0.69109	val-aucpr:0.20011
[2025-11-19 08:32:09,678] [INFO] [<frozen importlib] - Training completed at iteration 49
[2025-11-19 08:32:09,678] [INFO] [<frozen importlib] - Best train loss: 0.6848
[2025-11-19 08:32:09,678] [INFO] [<frozen importlib] - Best val loss: 0.5624
[2025-11-19 08:32:09,678] [INFO] [<frozen importlib] - Best val AUC: 0.7022
[2025-11-19 08:32:09,678] [INFO] [<frozen importlib] - Best val AUCPR: 0.2180
[2025-11-19 08:32:09,681] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:32:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:32:19,422] [INFO] [<frozen importlib] - Optimal threshold: 0.5237
[2025-11-19 08:32:19,422] [INFO] [<frozen importlib] - Best f1: 0.2663
[2025-11-19 08:32:19,422] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:32:19,467] [INFO] [<frozen importlib] - Validation Results (threshold=0.5237):
[2025-11-19 08:32:19,467] [INFO] [<frozen importlib] -   Accuracy: 0.9011
[2025-11-19 08:32:19,467] [INFO] [<frozen importlib] -   Precision: 0.3099
[2025-11-19 08:32:19,467] [INFO] [<frozen importlib] -   Recall: 0.2335
[2025-11-19 08:32:19,467] [INFO] [<frozen importlib] -   F1 Score: 0.2663
[2025-11-19 08:32:19,467] [INFO] [<frozen importlib] -   AUROC: 0.7022
[2025-11-19 08:32:19,467] [INFO] [<frozen importlib] -   AUPRC: 0.2186
[2025-11-19 08:32:19,467] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:32:19,467] [INFO] [<frozen importlib] -     TN=16690, FP=755
[2025-11-19 08:32:19,467] [INFO] [<frozen importlib] -     FN=1113, TP=339
[2025-11-19 08:32:19,494] [INFO] [<frozen importlib] - Trial 72: AUPRC=0.2186, F1=0.4620, Prec=0.4676, Rec=0.4566 | Optimizing auprc=0.2186
                                                                                        Best trial: 15. Best value: 0.234562:  14%|█▍        | 72/500 [10:17<1:01:44,  8.66s/it]Best trial: 15. Best value: 0.234562:  14%|█▍        | 72/500 [10:17<1:01:44,  8.66s/it]Best trial: 15. Best value: 0.234562:  15%|█▍        | 73/500 [10:17<1:04:53,  9.12s/it][2025-11-19 08:32:19,503] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.091195161397692
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   gamma: 0.09120164117555334
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   alpha: 1.0073765388539448
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   lambda: 3.4246595028777995
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   learning_rate: 0.04902823962002801
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   subsample: 0.7415300663551591
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   colsample_bytree: 0.5367694260717635
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   colsample_bylevel: 0.525127397917965
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   colsample_bynode: 0.87179045704281
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:32:19,503] [INFO] [<frozen importlib] -   scale_pos_weight: 9.091195161397692
[2025-11-19 08:32:19,588] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:32:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:32:19,494] Trial 72 finished with value: 0.2186018566877993 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.1351349033129034, 'learning_rate': 0.03603440203497565, 'n_estimators': 300, 'alpha': 0.8802036338037047, 'lambda': 4.375846356571814, 'subsample': 0.6834105515956264, 'colsample_bytree': 0.6013155556611881, 'colsample_bylevel': 0.6687444585995664, 'colsample_bynode': 0.9796674456459568, 'scale_pos_weight': 8.081047937704078}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.80382	train-auc:0.63569	train-aucpr:0.21960	val-logloss:0.81140	val-auc:0.64100	val-aucpr:0.13644
[10]	train-logloss:0.76807	train-auc:0.67997	train-aucpr:0.28986	val-logloss:0.72369	val-auc:0.71133	val-aucpr:0.20882
[20]	train-logloss:0.74838	train-auc:0.69003	train-aucpr:0.30336	val-logloss:0.67079	val-auc:0.71330	val-aucpr:0.21762
[30]	train-logloss:0.73641	train-auc:0.69713	train-aucpr:0.30897	val-logloss:0.63714	val-auc:0.71951	val-aucpr:0.22745
[40]	train-logloss:0.72755	train-auc:0.70436	train-aucpr:0.31471	val-logloss:0.61520	val-auc:0.71933	val-aucpr:0.22398
[50]	train-logloss:0.72138	train-auc:0.70833	train-aucpr:0.31891	val-logloss:0.59798	val-auc:0.71662	val-aucpr:0.22271
[60]	train-logloss:0.71597	train-auc:0.71430	train-aucpr:0.32376	val-logloss:0.59406	val-auc:0.71694	val-aucpr:0.22485
[63]	train-logloss:0.71486	train-auc:0.71550	train-aucpr:0.32491	val-logloss:0.59886	val-auc:0.70219	val-aucpr:0.21160
[2025-11-19 08:32:19,805] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:32:19,805] [INFO] [<frozen importlib] - Best train loss: 0.7324
[2025-11-19 08:32:19,805] [INFO] [<frozen importlib] - Best val loss: 0.6203
[2025-11-19 08:32:19,805] [INFO] [<frozen importlib] - Best val AUC: 0.7224
[2025-11-19 08:32:19,805] [INFO] [<frozen importlib] - Best val AUCPR: 0.2281
[2025-11-19 08:32:19,808] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:32:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:32:32,195] [INFO] [<frozen importlib] - Optimal threshold: 0.5805
[2025-11-19 08:32:32,195] [INFO] [<frozen importlib] - Best f1: 0.2772
[2025-11-19 08:32:32,195] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:32:32,239] [INFO] [<frozen importlib] - Validation Results (threshold=0.5805):
[2025-11-19 08:32:32,239] [INFO] [<frozen importlib] -   Accuracy: 0.9048
[2025-11-19 08:32:32,239] [INFO] [<frozen importlib] -   Precision: 0.3327
[2025-11-19 08:32:32,239] [INFO] [<frozen importlib] -   Recall: 0.2376
[2025-11-19 08:32:32,239] [INFO] [<frozen importlib] -   F1 Score: 0.2772
[2025-11-19 08:32:32,239] [INFO] [<frozen importlib] -   AUROC: 0.7224
[2025-11-19 08:32:32,239] [INFO] [<frozen importlib] -   AUPRC: 0.2285
[2025-11-19 08:32:32,239] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:32:32,239] [INFO] [<frozen importlib] -     TN=16753, FP=692
[2025-11-19 08:32:32,239] [INFO] [<frozen importlib] -     FN=1107, TP=345
[2025-11-19 08:32:32,263] [INFO] [<frozen importlib] - Trial 73: AUPRC=0.2285, F1=0.4441, Prec=0.4693, Rec=0.4215 | Optimizing auprc=0.2285
                                                                                        Best trial: 15. Best value: 0.234562:  15%|█▍        | 73/500 [10:30<1:04:53,  9.12s/it]Best trial: 15. Best value: 0.234562:  15%|█▍        | 73/500 [10:30<1:04:53,  9.12s/it]Best trial: 15. Best value: 0.234562:  15%|█▍        | 74/500 [10:30<1:12:30, 10.21s/it][2025-11-19 08:32:32,279] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.79301520170264
[2025-11-19 08:32:32,279] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:32:32,279] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:32:32,279] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   gamma: 0.03863770047840283
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   alpha: 1.0276860426297623
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   lambda: 2.058039027324914
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   learning_rate: 0.05148112548042198
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   subsample: 0.7734592695240862
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   colsample_bytree: 0.5010264736463178
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5301833626865028
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   colsample_bynode: 0.8962692555215963
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:32:32,280] [INFO] [<frozen importlib] -   scale_pos_weight: 8.79301520170264
[2025-11-19 08:32:32,369] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:32:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:32:32,264] Trial 73 finished with value: 0.22852960087541335 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.09120164117555334, 'learning_rate': 0.04902823962002801, 'n_estimators': 400, 'alpha': 1.0073765388539448, 'lambda': 3.4246595028777995, 'subsample': 0.7415300663551591, 'colsample_bytree': 0.5367694260717635, 'colsample_bylevel': 0.525127397917965, 'colsample_bynode': 0.87179045704281, 'scale_pos_weight': 9.091195161397692}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.78958	train-auc:0.63384	train-aucpr:0.21300	val-logloss:0.79320	val-auc:0.68890	val-aucpr:0.14933
[10]	train-logloss:0.75408	train-auc:0.68457	train-aucpr:0.28915	val-logloss:0.70892	val-auc:0.69314	val-aucpr:0.19840
[20]	train-logloss:0.73439	train-auc:0.69377	train-aucpr:0.30169	val-logloss:0.65733	val-auc:0.70507	val-aucpr:0.21918
[30]	train-logloss:0.72226	train-auc:0.69863	train-aucpr:0.30912	val-logloss:0.61463	val-auc:0.70596	val-aucpr:0.22655
[40]	train-logloss:0.71370	train-auc:0.70404	train-aucpr:0.31418	val-logloss:0.58166	val-auc:0.70079	val-aucpr:0.21930
[50]	train-logloss:0.70774	train-auc:0.70829	train-aucpr:0.31874	val-logloss:0.57876	val-auc:0.69998	val-aucpr:0.21759
[57]	train-logloss:0.70427	train-auc:0.71141	train-aucpr:0.32153	val-logloss:0.55854	val-auc:0.69548	val-aucpr:0.21107
[2025-11-19 08:32:32,573] [INFO] [<frozen importlib] - Training completed at iteration 28
[2025-11-19 08:32:32,573] [INFO] [<frozen importlib] - Best train loss: 0.7243
[2025-11-19 08:32:32,573] [INFO] [<frozen importlib] - Best val loss: 0.6225
[2025-11-19 08:32:32,573] [INFO] [<frozen importlib] - Best val AUC: 0.7062
[2025-11-19 08:32:32,573] [INFO] [<frozen importlib] - Best val AUCPR: 0.2271
[2025-11-19 08:32:32,576] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:32:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:32:41,605] [INFO] [<frozen importlib] - Optimal threshold: 0.5557
[2025-11-19 08:32:41,605] [INFO] [<frozen importlib] - Best f1: 0.2767
[2025-11-19 08:32:41,605] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:32:41,656] [INFO] [<frozen importlib] - Validation Results (threshold=0.5557):
[2025-11-19 08:32:41,656] [INFO] [<frozen importlib] -   Accuracy: 0.8968
[2025-11-19 08:32:41,656] [INFO] [<frozen importlib] -   Precision: 0.2998
[2025-11-19 08:32:41,656] [INFO] [<frozen importlib] -   Recall: 0.2569
[2025-11-19 08:32:41,656] [INFO] [<frozen importlib] -   F1 Score: 0.2767
[2025-11-19 08:32:41,656] [INFO] [<frozen importlib] -   AUROC: 0.7062
[2025-11-19 08:32:41,656] [INFO] [<frozen importlib] -   AUPRC: 0.2277
[2025-11-19 08:32:41,656] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:32:41,656] [INFO] [<frozen importlib] -     TN=16574, FP=871
[2025-11-19 08:32:41,656] [INFO] [<frozen importlib] -     FN=1079, TP=373
[2025-11-19 08:32:41,683] [INFO] [<frozen importlib] - Trial 74: AUPRC=0.2277, F1=0.4672, Prec=0.4484, Rec=0.4876 | Optimizing auprc=0.2277
                                                                                        Best trial: 15. Best value: 0.234562:  15%|█▍        | 74/500 [10:39<1:12:30, 10.21s/it]Best trial: 15. Best value: 0.234562:  15%|█▍        | 74/500 [10:39<1:12:30, 10.21s/it]Best trial: 15. Best value: 0.234562:  15%|█▌        | 75/500 [10:39<1:10:39,  9.97s/it][2025-11-19 08:32:41,692] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.96852164893977
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   gamma: 0.04139817795129445
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   alpha: 1.0190170001815066
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   lambda: 3.4156219228754985
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   learning_rate: 0.05023875575030664
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   subsample: 0.7713598607173203
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   colsample_bytree: 0.5381319365120325
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5346610647261465
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   colsample_bynode: 0.8941338941896234
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:32:41,692] [INFO] [<frozen importlib] -   scale_pos_weight: 8.96852164893977
[2025-11-19 08:32:41,773] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:32:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:32:41,683] Trial 74 finished with value: 0.227652448782961 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.03863770047840283, 'learning_rate': 0.05148112548042198, 'n_estimators': 450, 'alpha': 1.0276860426297623, 'lambda': 2.058039027324914, 'subsample': 0.7734592695240862, 'colsample_bytree': 0.5010264736463178, 'colsample_bylevel': 0.5301833626865028, 'colsample_bynode': 0.8962692555215963, 'scale_pos_weight': 8.79301520170264}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.79809	train-auc:0.63369	train-aucpr:0.21563	val-logloss:0.80276	val-auc:0.69108	val-aucpr:0.16706
[10]	train-logloss:0.76214	train-auc:0.68299	train-aucpr:0.28713	val-logloss:0.70322	val-auc:0.71307	val-aucpr:0.20992
[20]	train-logloss:0.74190	train-auc:0.69210	train-aucpr:0.30234	val-logloss:0.66010	val-auc:0.71306	val-aucpr:0.21903
[30]	train-logloss:0.72998	train-auc:0.69680	train-aucpr:0.31028	val-logloss:0.61806	val-auc:0.72029	val-aucpr:0.22182
[40]	train-logloss:0.72116	train-auc:0.70253	train-aucpr:0.31659	val-logloss:0.59116	val-auc:0.71985	val-aucpr:0.22424
[50]	train-logloss:0.71517	train-auc:0.70745	train-aucpr:0.32037	val-logloss:0.58633	val-auc:0.71447	val-aucpr:0.22329
[60]	train-logloss:0.70978	train-auc:0.71371	train-aucpr:0.32645	val-logloss:0.58303	val-auc:0.71541	val-aucpr:0.22578
[70]	train-logloss:0.70597	train-auc:0.71780	train-aucpr:0.33058	val-logloss:0.56358	val-auc:0.70958	val-aucpr:0.21644
[80]	train-logloss:0.70116	train-auc:0.72470	train-aucpr:0.33716	val-logloss:0.54417	val-auc:0.69920	val-aucpr:0.20435
[90]	train-logloss:0.69761	train-auc:0.73024	train-aucpr:0.34132	val-logloss:0.53014	val-auc:0.68973	val-aucpr:0.18494
[2025-11-19 08:32:42,038] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:32:42,038] [INFO] [<frozen importlib] - Best train loss: 0.7098
[2025-11-19 08:32:42,038] [INFO] [<frozen importlib] - Best val loss: 0.5830
[2025-11-19 08:32:42,038] [INFO] [<frozen importlib] - Best val AUC: 0.7154
[2025-11-19 08:32:42,038] [INFO] [<frozen importlib] - Best val AUCPR: 0.2258
[2025-11-19 08:32:42,041] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:32:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:32:56,633] [INFO] [<frozen importlib] - Optimal threshold: 0.5657
[2025-11-19 08:32:56,633] [INFO] [<frozen importlib] - Best f1: 0.2682
[2025-11-19 08:32:56,633] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:32:56,677] [INFO] [<frozen importlib] - Validation Results (threshold=0.5657):
[2025-11-19 08:32:56,677] [INFO] [<frozen importlib] -   Accuracy: 0.8906
[2025-11-19 08:32:56,677] [INFO] [<frozen importlib] -   Precision: 0.2758
[2025-11-19 08:32:56,677] [INFO] [<frozen importlib] -   Recall: 0.2610
[2025-11-19 08:32:56,677] [INFO] [<frozen importlib] -   F1 Score: 0.2682
[2025-11-19 08:32:56,677] [INFO] [<frozen importlib] -   AUROC: 0.7154
[2025-11-19 08:32:56,677] [INFO] [<frozen importlib] -   AUPRC: 0.2263
[2025-11-19 08:32:56,677] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:32:56,677] [INFO] [<frozen importlib] -     TN=16450, FP=995
[2025-11-19 08:32:56,677] [INFO] [<frozen importlib] -     FN=1073, TP=379
[2025-11-19 08:32:56,703] [INFO] [<frozen importlib] - Trial 75: AUPRC=0.2263, F1=0.4468, Prec=0.4144, Rec=0.4848 | Optimizing auprc=0.2263
                                                                                        Best trial: 15. Best value: 0.234562:  15%|█▌        | 75/500 [10:54<1:10:39,  9.97s/it]Best trial: 15. Best value: 0.234562:  15%|█▌        | 75/500 [10:54<1:10:39,  9.97s/it]Best trial: 15. Best value: 0.234562:  15%|█▌        | 76/500 [10:54<1:21:11, 11.49s/it][2025-11-19 08:32:56,719] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.937856819177256
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   gamma: 0.040355569670510856
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   alpha: 1.0134152437004182
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   lambda: 2.0776910752443447
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   learning_rate: 0.04828595118740347
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   subsample: 0.7725594176500064
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   colsample_bytree: 0.5027474082999297
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5277691593246014
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   colsample_bynode: 0.8731094872460069
[2025-11-19 08:32:56,719] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:32:56,720] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:32:56,720] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:32:56,720] [INFO] [<frozen importlib] -   scale_pos_weight: 8.937856819177256
[2025-11-19 08:32:56,805] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:32:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:32:56,703] Trial 75 finished with value: 0.2262803118511586 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.04139817795129445, 'learning_rate': 0.05023875575030664, 'n_estimators': 500, 'alpha': 1.0190170001815066, 'lambda': 3.4156219228754985, 'subsample': 0.7713598607173203, 'colsample_bytree': 0.5381319365120325, 'colsample_bylevel': 0.5346610647261465, 'colsample_bynode': 0.8941338941896234, 'scale_pos_weight': 8.96852164893977}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.79682	train-auc:0.63384	train-aucpr:0.21300	val-logloss:0.80170	val-auc:0.68890	val-aucpr:0.14933
[10]	train-logloss:0.76239	train-auc:0.68389	train-aucpr:0.28926	val-logloss:0.72003	val-auc:0.69339	val-aucpr:0.19834
[20]	train-logloss:0.74260	train-auc:0.69359	train-aucpr:0.30123	val-logloss:0.66761	val-auc:0.70633	val-aucpr:0.21915
[30]	train-logloss:0.73034	train-auc:0.69798	train-aucpr:0.30824	val-logloss:0.62578	val-auc:0.70868	val-aucpr:0.22919
[40]	train-logloss:0.72164	train-auc:0.70336	train-aucpr:0.31298	val-logloss:0.59277	val-auc:0.70055	val-aucpr:0.22057
[50]	train-logloss:0.71552	train-auc:0.70700	train-aucpr:0.31675	val-logloss:0.58854	val-auc:0.70018	val-aucpr:0.21780
[59]	train-logloss:0.71104	train-auc:0.71197	train-aucpr:0.32197	val-logloss:0.58396	val-auc:0.69440	val-aucpr:0.20973
[2025-11-19 08:32:56,997] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:32:56,997] [INFO] [<frozen importlib] - Best train loss: 0.7314
[2025-11-19 08:32:56,997] [INFO] [<frozen importlib] - Best val loss: 0.6302
[2025-11-19 08:32:56,997] [INFO] [<frozen importlib] - Best val AUC: 0.7091
[2025-11-19 08:32:56,997] [INFO] [<frozen importlib] - Best val AUCPR: 0.2297
[2025-11-19 08:32:57,000] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:32:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:33:05,281] [INFO] [<frozen importlib] - Optimal threshold: 0.5490
[2025-11-19 08:33:05,281] [INFO] [<frozen importlib] - Best f1: 0.2744
[2025-11-19 08:33:05,281] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:33:05,321] [INFO] [<frozen importlib] - Validation Results (threshold=0.5490):
[2025-11-19 08:33:05,321] [INFO] [<frozen importlib] -   Accuracy: 0.8881
[2025-11-19 08:33:05,321] [INFO] [<frozen importlib] -   Precision: 0.2734
[2025-11-19 08:33:05,321] [INFO] [<frozen importlib] -   Recall: 0.2755
[2025-11-19 08:33:05,321] [INFO] [<frozen importlib] -   F1 Score: 0.2744
[2025-11-19 08:33:05,321] [INFO] [<frozen importlib] -   AUROC: 0.7091
[2025-11-19 08:33:05,321] [INFO] [<frozen importlib] -   AUPRC: 0.2301
[2025-11-19 08:33:05,321] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:33:05,321] [INFO] [<frozen importlib] -     TN=16382, FP=1063
[2025-11-19 08:33:05,321] [INFO] [<frozen importlib] -     FN=1052, TP=400
[2025-11-19 08:33:05,349] [INFO] [<frozen importlib] - Trial 76: AUPRC=0.2301, F1=0.4537, Prec=0.4098, Rec=0.5083 | Optimizing auprc=0.2301
                                                                                        Best trial: 15. Best value: 0.234562:  15%|█▌        | 76/500 [11:03<1:21:11, 11.49s/it]Best trial: 15. Best value: 0.234562:  15%|█▌        | 76/500 [11:03<1:21:11, 11.49s/it]Best trial: 15. Best value: 0.234562:  15%|█▌        | 77/500 [11:03<1:14:58, 10.64s/it][2025-11-19 08:33:05,356] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.758026913581363
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   gamma: 0.09543933232455566
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   alpha: 1.0234624485083916
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   lambda: 1.9837511692287197
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   learning_rate: 0.04752732940152004
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   subsample: 0.7810919225515686
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   colsample_bytree: 0.5005133046442192
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5286218739380583
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   colsample_bynode: 0.8829859218076432
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:33:05,356] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:33:05,357] [INFO] [<frozen importlib] -   scale_pos_weight: 8.758026913581363
[2025-11-19 08:33:05,435] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:33:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:33:05,349] Trial 76 finished with value: 0.23005603645271433 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.040355569670510856, 'learning_rate': 0.04828595118740347, 'n_estimators': 500, 'alpha': 1.0134152437004182, 'lambda': 2.0776910752443447, 'subsample': 0.7725594176500064, 'colsample_bytree': 0.5027474082999297, 'colsample_bylevel': 0.5277691593246014, 'colsample_bynode': 0.8731094872460069, 'scale_pos_weight': 8.937856819177256}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.78823	train-auc:0.63384	train-aucpr:0.21291	val-logloss:0.79232	val-auc:0.68890	val-aucpr:0.14933
[10]	train-logloss:0.75480	train-auc:0.68359	train-aucpr:0.28798	val-logloss:0.71439	val-auc:0.69742	val-aucpr:0.20059
[20]	train-logloss:0.73553	train-auc:0.69272	train-aucpr:0.29953	val-logloss:0.66005	val-auc:0.70619	val-aucpr:0.21790
[30]	train-logloss:0.72323	train-auc:0.69782	train-aucpr:0.30704	val-logloss:0.61984	val-auc:0.70764	val-aucpr:0.22660
[40]	train-logloss:0.71454	train-auc:0.70393	train-aucpr:0.31215	val-logloss:0.59431	val-auc:0.70192	val-aucpr:0.21876
[50]	train-logloss:0.70835	train-auc:0.70735	train-aucpr:0.31602	val-logloss:0.58520	val-auc:0.70249	val-aucpr:0.21844
[60]	train-logloss:0.70325	train-auc:0.71242	train-aucpr:0.32156	val-logloss:0.57134	val-auc:0.69952	val-aucpr:0.21192
[62]	train-logloss:0.70225	train-auc:0.71357	train-aucpr:0.32253	val-logloss:0.56321	val-auc:0.70157	val-aucpr:0.21339
[2025-11-19 08:33:05,627] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 08:33:05,627] [INFO] [<frozen importlib] - Best train loss: 0.7211
[2025-11-19 08:33:05,627] [INFO] [<frozen importlib] - Best val loss: 0.6185
[2025-11-19 08:33:05,627] [INFO] [<frozen importlib] - Best val AUC: 0.7084
[2025-11-19 08:33:05,627] [INFO] [<frozen importlib] - Best val AUCPR: 0.2269
[2025-11-19 08:33:05,630] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:33:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:33:15,281] [INFO] [<frozen importlib] - Optimal threshold: 0.5435
[2025-11-19 08:33:15,281] [INFO] [<frozen importlib] - Best f1: 0.2700
[2025-11-19 08:33:15,281] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:33:15,328] [INFO] [<frozen importlib] - Validation Results (threshold=0.5435):
[2025-11-19 08:33:15,328] [INFO] [<frozen importlib] -   Accuracy: 0.8824
[2025-11-19 08:33:15,328] [INFO] [<frozen importlib] -   Precision: 0.2580
[2025-11-19 08:33:15,328] [INFO] [<frozen importlib] -   Recall: 0.2831
[2025-11-19 08:33:15,328] [INFO] [<frozen importlib] -   F1 Score: 0.2700
[2025-11-19 08:33:15,328] [INFO] [<frozen importlib] -   AUROC: 0.7084
[2025-11-19 08:33:15,328] [INFO] [<frozen importlib] -   AUPRC: 0.2273
[2025-11-19 08:33:15,328] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:33:15,328] [INFO] [<frozen importlib] -     TN=16263, FP=1182
[2025-11-19 08:33:15,328] [INFO] [<frozen importlib] -     FN=1041, TP=411
[2025-11-19 08:33:15,351] [INFO] [<frozen importlib] - Trial 77: AUPRC=0.2273, F1=0.4437, Prec=0.3885, Rec=0.5172 | Optimizing auprc=0.2273
                                                                                        Best trial: 15. Best value: 0.234562:  15%|█▌        | 77/500 [11:13<1:14:58, 10.64s/it]Best trial: 15. Best value: 0.234562:  15%|█▌        | 77/500 [11:13<1:14:58, 10.64s/it]Best trial: 15. Best value: 0.234562:  16%|█▌        | 78/500 [11:13<1:13:28, 10.45s/it][2025-11-19 08:33:15,362] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.122736337511313
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   gamma: 0.04327599424643562
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   alpha: 1.0063386733919562
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   lambda: 1.6529721613841408
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   learning_rate: 0.0472413652943819
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   subsample: 0.7745820732139302
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   colsample_bytree: 0.503909902557287
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5237832321886894
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   colsample_bynode: 0.8794597851722961
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:33:15,362] [INFO] [<frozen importlib] -   scale_pos_weight: 9.122736337511313
[2025-11-19 08:33:15,444] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:33:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:33:15,352] Trial 77 finished with value: 0.22730730605012317 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.09543933232455566, 'learning_rate': 0.04752732940152004, 'n_estimators': 500, 'alpha': 1.0234624485083916, 'lambda': 1.9837511692287197, 'subsample': 0.7810919225515686, 'colsample_bytree': 0.5005133046442192, 'colsample_bylevel': 0.5286218739380583, 'colsample_bynode': 0.8829859218076432, 'scale_pos_weight': 8.758026913581363}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.80570	train-auc:0.63384	train-aucpr:0.21300	val-logloss:0.81163	val-auc:0.68890	val-aucpr:0.14933
[10]	train-logloss:0.77127	train-auc:0.68472	train-aucpr:0.28968	val-logloss:0.72956	val-auc:0.68742	val-aucpr:0.19664
[20]	train-logloss:0.75137	train-auc:0.69410	train-aucpr:0.30090	val-logloss:0.67717	val-auc:0.70325	val-aucpr:0.21698
[30]	train-logloss:0.73896	train-auc:0.69841	train-aucpr:0.30780	val-logloss:0.63620	val-auc:0.70419	val-aucpr:0.22461
[40]	train-logloss:0.73004	train-auc:0.70433	train-aucpr:0.31263	val-logloss:0.60647	val-auc:0.69301	val-aucpr:0.21683
[50]	train-logloss:0.72378	train-auc:0.70756	train-aucpr:0.31631	val-logloss:0.59745	val-auc:0.69102	val-aucpr:0.21388
[60]	train-logloss:0.71846	train-auc:0.71267	train-aucpr:0.32233	val-logloss:0.58546	val-auc:0.69078	val-aucpr:0.21082
[62]	train-logloss:0.71750	train-auc:0.71345	train-aucpr:0.32321	val-logloss:0.58274	val-auc:0.69106	val-aucpr:0.21088
[2025-11-19 08:33:15,636] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 08:33:15,636] [INFO] [<frozen importlib] - Best train loss: 0.7367
[2025-11-19 08:33:15,636] [INFO] [<frozen importlib] - Best val loss: 0.6305
[2025-11-19 08:33:15,636] [INFO] [<frozen importlib] - Best val AUC: 0.7017
[2025-11-19 08:33:15,636] [INFO] [<frozen importlib] - Best val AUCPR: 0.2248
[2025-11-19 08:33:15,642] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:33:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:33:24,143] [INFO] [<frozen importlib] - Optimal threshold: 0.5529
[2025-11-19 08:33:24,144] [INFO] [<frozen importlib] - Best f1: 0.2707
[2025-11-19 08:33:24,144] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:33:24,188] [INFO] [<frozen importlib] - Validation Results (threshold=0.5529):
[2025-11-19 08:33:24,188] [INFO] [<frozen importlib] -   Accuracy: 0.8905
[2025-11-19 08:33:24,188] [INFO] [<frozen importlib] -   Precision: 0.2773
[2025-11-19 08:33:24,188] [INFO] [<frozen importlib] -   Recall: 0.2645
[2025-11-19 08:33:24,188] [INFO] [<frozen importlib] -   F1 Score: 0.2707
[2025-11-19 08:33:24,188] [INFO] [<frozen importlib] -   AUROC: 0.7017
[2025-11-19 08:33:24,188] [INFO] [<frozen importlib] -   AUPRC: 0.2253
[2025-11-19 08:33:24,188] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:33:24,188] [INFO] [<frozen importlib] -     TN=16444, FP=1001
[2025-11-19 08:33:24,188] [INFO] [<frozen importlib] -     FN=1068, TP=384
[2025-11-19 08:33:24,211] [INFO] [<frozen importlib] - Trial 78: AUPRC=0.2253, F1=0.4529, Prec=0.4177, Rec=0.4945 | Optimizing auprc=0.2253
                                                                                        Best trial: 15. Best value: 0.234562:  16%|█▌        | 78/500 [11:22<1:13:28, 10.45s/it]Best trial: 15. Best value: 0.234562:  16%|█▌        | 78/500 [11:22<1:13:28, 10.45s/it]Best trial: 15. Best value: 0.234562:  16%|█▌        | 79/500 [11:22<1:09:57,  9.97s/it][2025-11-19 08:33:24,219] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.70929059470874
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   gamma: 0.0022535039598245987
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   alpha: 0.769759940766441
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   lambda: 2.3219605601105284
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   learning_rate: 0.05457780258590373
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   subsample: 0.736548230539976
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   colsample_bytree: 0.5152751870860799
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5594407003398145
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   colsample_bynode: 0.9189498657264707
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:33:24,219] [INFO] [<frozen importlib] -   scale_pos_weight: 9.70929059470874
[2025-11-19 08:33:24,299] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:33:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:33:24,211] Trial 78 finished with value: 0.22526585048367798 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.04327599424643562, 'learning_rate': 0.0472413652943819, 'n_estimators': 500, 'alpha': 1.0063386733919562, 'lambda': 1.6529721613841408, 'subsample': 0.7745820732139302, 'colsample_bytree': 0.503909902557287, 'colsample_bylevel': 0.5237832321886894, 'colsample_bynode': 0.8794597851722961, 'scale_pos_weight': 9.122736337511313}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.83201	train-auc:0.63581	train-aucpr:0.23123	val-logloss:0.84402	val-auc:0.64105	val-aucpr:0.15068
[10]	train-logloss:0.79105	train-auc:0.68643	train-aucpr:0.29991	val-logloss:0.74080	val-auc:0.70443	val-aucpr:0.21855
[20]	train-logloss:0.77101	train-auc:0.69586	train-aucpr:0.30776	val-logloss:0.68404	val-auc:0.70673	val-aucpr:0.21221
[30]	train-logloss:0.75919	train-auc:0.69994	train-aucpr:0.31159	val-logloss:0.64419	val-auc:0.70261	val-aucpr:0.21234
[33]	train-logloss:0.75579	train-auc:0.70289	train-aucpr:0.31514	val-logloss:0.64060	val-auc:0.70202	val-aucpr:0.21574
[2025-11-19 08:33:24,424] [INFO] [<frozen importlib] - Training completed at iteration 4
[2025-11-19 08:33:24,424] [INFO] [<frozen importlib] - Best train loss: 0.8126
[2025-11-19 08:33:24,424] [INFO] [<frozen importlib] - Best val loss: 0.7967
[2025-11-19 08:33:24,424] [INFO] [<frozen importlib] - Best val AUC: 0.7016
[2025-11-19 08:33:24,424] [INFO] [<frozen importlib] - Best val AUCPR: 0.2223
[2025-11-19 08:33:24,431] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:33:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:33:24,850] [INFO] [<frozen importlib] - Optimal threshold: 0.5816
[2025-11-19 08:33:24,850] [INFO] [<frozen importlib] - Best f1: 0.2738
[2025-11-19 08:33:24,850] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:33:24,892] [INFO] [<frozen importlib] - Validation Results (threshold=0.5816):
[2025-11-19 08:33:24,893] [INFO] [<frozen importlib] -   Accuracy: 0.8711
[2025-11-19 08:33:24,893] [INFO] [<frozen importlib] -   Precision: 0.2415
[2025-11-19 08:33:24,893] [INFO] [<frozen importlib] -   Recall: 0.3161
[2025-11-19 08:33:24,893] [INFO] [<frozen importlib] -   F1 Score: 0.2738
[2025-11-19 08:33:24,893] [INFO] [<frozen importlib] -   AUROC: 0.7016
[2025-11-19 08:33:24,893] [INFO] [<frozen importlib] -   AUPRC: 0.2085
[2025-11-19 08:33:24,893] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:33:24,893] [INFO] [<frozen importlib] -     TN=16003, FP=1442
[2025-11-19 08:33:24,893] [INFO] [<frozen importlib] -     FN=993, TP=459
[2025-11-19 08:33:24,916] [INFO] [<frozen importlib] - Trial 79: AUPRC=0.2085, F1=0.4225, Prec=0.3496, Rec=0.5337 | Optimizing auprc=0.2085
                                                                                        Best trial: 15. Best value: 0.234562:  16%|█▌        | 79/500 [11:22<1:09:57,  9.97s/it]Best trial: 15. Best value: 0.234562:  16%|█▌        | 79/500 [11:22<1:09:57,  9.97s/it]Best trial: 15. Best value: 0.234562:  16%|█▌        | 80/500 [11:22<50:19,  7.19s/it]  [2025-11-19 08:33:24,925] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.954082666550681
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   gamma: 0.0900042402303467
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   alpha: 0.8429485298163737
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   lambda: 1.9932181946654544
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   learning_rate: 0.04807467697659614
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   subsample: 0.714530251662901
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   colsample_bytree: 0.501221235338009
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5488331948513696
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   colsample_bynode: 0.8902162190917623
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:33:24,925] [INFO] [<frozen importlib] -   scale_pos_weight: 8.954082666550681
[2025-11-19 08:33:25,010] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:33:25] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:33:24,916] Trial 79 finished with value: 0.20851013456909442 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.0022535039598245987, 'learning_rate': 0.05457780258590373, 'n_estimators': 500, 'alpha': 0.769759940766441, 'lambda': 2.3219605601105284, 'subsample': 0.736548230539976, 'colsample_bytree': 0.5152751870860799, 'colsample_bylevel': 0.5594407003398145, 'colsample_bynode': 0.9189498657264707, 'scale_pos_weight': 9.70929059470874}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.79747	train-auc:0.63440	train-aucpr:0.21988	val-logloss:0.80495	val-auc:0.64734	val-aucpr:0.14016
[10]	train-logloss:0.76308	train-auc:0.68626	train-aucpr:0.28915	val-logloss:0.71807	val-auc:0.69479	val-aucpr:0.20181
[20]	train-logloss:0.74303	train-auc:0.69287	train-aucpr:0.29950	val-logloss:0.65687	val-auc:0.70862	val-aucpr:0.21900
[30]	train-logloss:0.73106	train-auc:0.69819	train-aucpr:0.30653	val-logloss:0.62175	val-auc:0.70547	val-aucpr:0.22580
[40]	train-logloss:0.72214	train-auc:0.70425	train-aucpr:0.31293	val-logloss:0.58787	val-auc:0.69698	val-aucpr:0.22031
[50]	train-logloss:0.71619	train-auc:0.70776	train-aucpr:0.31609	val-logloss:0.57698	val-auc:0.70248	val-aucpr:0.22577
[60]	train-logloss:0.71108	train-auc:0.71204	train-aucpr:0.32181	val-logloss:0.55484	val-auc:0.70358	val-aucpr:0.22464
[70]	train-logloss:0.70637	train-auc:0.71800	train-aucpr:0.32684	val-logloss:0.52620	val-auc:0.67430	val-aucpr:0.18337
[80]	train-logloss:0.70247	train-auc:0.72270	train-aucpr:0.33156	val-logloss:0.52715	val-auc:0.67162	val-aucpr:0.17753
[81]	train-logloss:0.70217	train-auc:0.72309	train-aucpr:0.33192	val-logloss:0.52127	val-auc:0.67213	val-aucpr:0.17939
[2025-11-19 08:33:25,261] [INFO] [<frozen importlib] - Training completed at iteration 52
[2025-11-19 08:33:25,261] [INFO] [<frozen importlib] - Best train loss: 0.7149
[2025-11-19 08:33:25,261] [INFO] [<frozen importlib] - Best val loss: 0.5766
[2025-11-19 08:33:25,261] [INFO] [<frozen importlib] - Best val AUC: 0.7030
[2025-11-19 08:33:25,261] [INFO] [<frozen importlib] - Best val AUCPR: 0.2272
[2025-11-19 08:33:25,266] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:33:25] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:33:37,851] [INFO] [<frozen importlib] - Optimal threshold: 0.5366
[2025-11-19 08:33:37,851] [INFO] [<frozen importlib] - Best f1: 0.2661
[2025-11-19 08:33:37,851] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:33:37,896] [INFO] [<frozen importlib] - Validation Results (threshold=0.5366):
[2025-11-19 08:33:37,897] [INFO] [<frozen importlib] -   Accuracy: 0.8885
[2025-11-19 08:33:37,897] [INFO] [<frozen importlib] -   Precision: 0.2692
[2025-11-19 08:33:37,897] [INFO] [<frozen importlib] -   Recall: 0.2631
[2025-11-19 08:33:37,897] [INFO] [<frozen importlib] -   F1 Score: 0.2661
[2025-11-19 08:33:37,897] [INFO] [<frozen importlib] -   AUROC: 0.7030
[2025-11-19 08:33:37,897] [INFO] [<frozen importlib] -   AUPRC: 0.2276
[2025-11-19 08:33:37,897] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:33:37,897] [INFO] [<frozen importlib] -     TN=16408, FP=1037
[2025-11-19 08:33:37,897] [INFO] [<frozen importlib] -     FN=1070, TP=382
[2025-11-19 08:33:37,922] [INFO] [<frozen importlib] - Trial 80: AUPRC=0.2276, F1=0.4521, Prec=0.4121, Rec=0.5007 | Optimizing auprc=0.2276
                                                                                      Best trial: 15. Best value: 0.234562:  16%|█▌        | 80/500 [11:35<50:19,  7.19s/it]Best trial: 15. Best value: 0.234562:  16%|█▌        | 80/500 [11:35<50:19,  7.19s/it]Best trial: 15. Best value: 0.234562:  16%|█▌        | 81/500 [11:35<1:02:23,  8.94s/it][2025-11-19 08:33:37,937] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.824414623370563
[2025-11-19 08:33:37,937] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:33:37,937] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:33:37,937] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:33:37,937] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:33:37,937] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:33:37,937] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:33:37,937] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:33:37,937] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:33:37,937] [INFO] [<frozen importlib] -   gamma: 0.09459165721429762
[2025-11-19 08:33:37,937] [INFO] [<frozen importlib] -   alpha: 0.8354567690812236
[2025-11-19 08:33:37,938] [INFO] [<frozen importlib] -   lambda: 2.0832308386614087
[2025-11-19 08:33:37,938] [INFO] [<frozen importlib] -   learning_rate: 0.04353552779231622
[2025-11-19 08:33:37,938] [INFO] [<frozen importlib] -   subsample: 0.7700262912131441
[2025-11-19 08:33:37,938] [INFO] [<frozen importlib] -   colsample_bytree: 0.5321666408869449
[2025-11-19 08:33:37,938] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5489028937155745
[2025-11-19 08:33:37,938] [INFO] [<frozen importlib] -   colsample_bynode: 0.8974611115170221
[2025-11-19 08:33:37,938] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:33:37,938] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:33:37,938] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:33:37,938] [INFO] [<frozen importlib] -   scale_pos_weight: 8.824414623370563
[2025-11-19 08:33:38,014] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:33:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:33:37,923] Trial 80 finished with value: 0.2275811693899183 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.0900042402303467, 'learning_rate': 0.04807467697659614, 'n_estimators': 450, 'alpha': 0.8429485298163737, 'lambda': 1.9932181946654544, 'subsample': 0.714530251662901, 'colsample_bytree': 0.501221235338009, 'colsample_bylevel': 0.5488331948513696, 'colsample_bynode': 0.8902162190917623, 'scale_pos_weight': 8.954082666550681}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.79142	train-auc:0.63358	train-aucpr:0.22126	val-logloss:0.80071	val-auc:0.63326	val-aucpr:0.13890
[10]	train-logloss:0.75854	train-auc:0.68470	train-aucpr:0.28729	val-logloss:0.73111	val-auc:0.70291	val-aucpr:0.19972
[20]	train-logloss:0.73974	train-auc:0.69180	train-aucpr:0.30044	val-logloss:0.67368	val-auc:0.71009	val-aucpr:0.20993
[30]	train-logloss:0.72749	train-auc:0.69656	train-aucpr:0.30695	val-logloss:0.62812	val-auc:0.70936	val-aucpr:0.21695
[40]	train-logloss:0.71934	train-auc:0.70169	train-aucpr:0.31124	val-logloss:0.60617	val-auc:0.70103	val-aucpr:0.21297
[50]	train-logloss:0.71268	train-auc:0.70756	train-aucpr:0.31537	val-logloss:0.60028	val-auc:0.68826	val-aucpr:0.20275
[58]	train-logloss:0.70857	train-auc:0.70990	train-aucpr:0.31976	val-logloss:0.59590	val-auc:0.69070	val-aucpr:0.20677
[2025-11-19 08:33:38,195] [INFO] [<frozen importlib] - Training completed at iteration 28
[2025-11-19 08:33:38,195] [INFO] [<frozen importlib] - Best train loss: 0.7297
[2025-11-19 08:33:38,195] [INFO] [<frozen importlib] - Best val loss: 0.6328
[2025-11-19 08:33:38,195] [INFO] [<frozen importlib] - Best val AUC: 0.7110
[2025-11-19 08:33:38,195] [INFO] [<frozen importlib] - Best val AUCPR: 0.2199
[2025-11-19 08:33:38,200] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:33:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:33:44,772] [INFO] [<frozen importlib] - Optimal threshold: 0.5528
[2025-11-19 08:33:44,772] [INFO] [<frozen importlib] - Best f1: 0.2712
[2025-11-19 08:33:44,772] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:33:44,814] [INFO] [<frozen importlib] - Validation Results (threshold=0.5528):
[2025-11-19 08:33:44,814] [INFO] [<frozen importlib] -   Accuracy: 0.8982
[2025-11-19 08:33:44,814] [INFO] [<frozen importlib] -   Precision: 0.3013
[2025-11-19 08:33:44,814] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 08:33:44,814] [INFO] [<frozen importlib] -   F1 Score: 0.2712
[2025-11-19 08:33:44,814] [INFO] [<frozen importlib] -   AUROC: 0.7110
[2025-11-19 08:33:44,814] [INFO] [<frozen importlib] -   AUPRC: 0.2203
[2025-11-19 08:33:44,814] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:33:44,814] [INFO] [<frozen importlib] -     TN=16615, FP=830
[2025-11-19 08:33:44,814] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 08:33:44,836] [INFO] [<frozen importlib] - Trial 81: AUPRC=0.2203, F1=0.4300, Prec=0.4296, Rec=0.4304 | Optimizing auprc=0.2203
[2025-11-19 08:33:44,836] [INFO] [<frozen importlib] - Trial 81 pruned.
[2025-11-19 08:33:44,836] [ERROR] [<frozen importlib] - Trial 81 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:  16%|█▌        | 81/500 [11:42<1:02:23,  8.94s/it]Best trial: 15. Best value: 0.234562:  16%|█▌        | 81/500 [11:42<1:02:23,  8.94s/it]Best trial: 15. Best value: 0.234562:  16%|█▋        | 82/500 [11:42<58:01,  8.33s/it]  [2025-11-19 08:33:44,845] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.137412850156515
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] -   gamma: 0.04173269488537886
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] -   alpha: 0.9156160702632641
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] -   lambda: 1.961558512881988
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] -   learning_rate: 0.04842058489090102
[2025-11-19 08:33:44,845] [INFO] [<frozen importlib] -   subsample: 0.718606494165375
[2025-11-19 08:33:44,846] [INFO] [<frozen importlib] -   colsample_bytree: 0.5172427975117934
[2025-11-19 08:33:44,846] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5140158314544281
[2025-11-19 08:33:44,846] [INFO] [<frozen importlib] -   colsample_bynode: 0.9381689878926479
[2025-11-19 08:33:44,846] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:33:44,846] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:33:44,846] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:33:44,846] [INFO] [<frozen importlib] -   scale_pos_weight: 9.137412850156515
[2025-11-19 08:33:44,919] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:33:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:33:44,836] Trial 81 pruned. 
[0]	train-logloss:0.80618	train-auc:0.63373	train-aucpr:0.21785	val-logloss:0.81542	val-auc:0.63706	val-aucpr:0.13926
[10]	train-logloss:0.77062	train-auc:0.68275	train-aucpr:0.28437	val-logloss:0.73049	val-auc:0.65394	val-aucpr:0.17520
[20]	train-logloss:0.75102	train-auc:0.69022	train-aucpr:0.29519	val-logloss:0.67008	val-auc:0.69746	val-aucpr:0.20905
[30]	train-logloss:0.73891	train-auc:0.69692	train-aucpr:0.30581	val-logloss:0.63581	val-auc:0.69716	val-aucpr:0.21322
[40]	train-logloss:0.72982	train-auc:0.70292	train-aucpr:0.31325	val-logloss:0.62247	val-auc:0.68905	val-aucpr:0.20300
[50]	train-logloss:0.72354	train-auc:0.70798	train-aucpr:0.31768	val-logloss:0.61477	val-auc:0.67615	val-aucpr:0.18483
[60]	train-logloss:0.71783	train-auc:0.71266	train-aucpr:0.32307	val-logloss:0.59816	val-auc:0.67511	val-aucpr:0.17595
[63]	train-logloss:0.71656	train-auc:0.71373	train-aucpr:0.32412	val-logloss:0.59138	val-auc:0.67717	val-aucpr:0.17874
[2025-11-19 08:33:45,119] [INFO] [<frozen importlib] - Training completed at iteration 33
[2025-11-19 08:33:45,119] [INFO] [<frozen importlib] - Best train loss: 0.7355
[2025-11-19 08:33:45,119] [INFO] [<frozen importlib] - Best val loss: 0.6227
[2025-11-19 08:33:45,119] [INFO] [<frozen importlib] - Best val AUC: 0.6953
[2025-11-19 08:33:45,119] [INFO] [<frozen importlib] - Best val AUCPR: 0.2133
[2025-11-19 08:33:45,123] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:33:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:33:55,792] [INFO] [<frozen importlib] - Optimal threshold: 0.5583
[2025-11-19 08:33:55,792] [INFO] [<frozen importlib] - Best f1: 0.2682
[2025-11-19 08:33:55,792] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:33:55,838] [INFO] [<frozen importlib] - Validation Results (threshold=0.5583):
[2025-11-19 08:33:55,838] [INFO] [<frozen importlib] -   Accuracy: 0.8969
[2025-11-19 08:33:55,838] [INFO] [<frozen importlib] -   Precision: 0.2950
[2025-11-19 08:33:55,838] [INFO] [<frozen importlib] -   Recall: 0.2459
[2025-11-19 08:33:55,838] [INFO] [<frozen importlib] -   F1 Score: 0.2682
[2025-11-19 08:33:55,838] [INFO] [<frozen importlib] -   AUROC: 0.6953
[2025-11-19 08:33:55,838] [INFO] [<frozen importlib] -   AUPRC: 0.2138
[2025-11-19 08:33:55,838] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:33:55,838] [INFO] [<frozen importlib] -     TN=16592, FP=853
[2025-11-19 08:33:55,838] [INFO] [<frozen importlib] -     FN=1095, TP=357
[2025-11-19 08:33:55,861] [INFO] [<frozen importlib] - Trial 82: AUPRC=0.2138, F1=0.4441, Prec=0.4355, Rec=0.4532 | Optimizing auprc=0.2138
[2025-11-19 08:33:55,862] [INFO] [<frozen importlib] - Trial 82 pruned.
[2025-11-19 08:33:55,862] [ERROR] [<frozen importlib] - Trial 82 failed with error: 
                                                                                      Best trial: 15. Best value: 0.234562:  16%|█▋        | 82/500 [11:53<58:01,  8.33s/it]Best trial: 15. Best value: 0.234562:  16%|█▋        | 82/500 [11:53<58:01,  8.33s/it]Best trial: 15. Best value: 0.234562:  17%|█▋        | 83/500 [11:53<1:03:30,  9.14s/it][2025-11-19 08:33:55,870] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.481029961384467
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   gamma: 0.09905776543485112
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   alpha: 1.0284877811521476
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   lambda: 2.691932228919423
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   learning_rate: 0.056606764406209646
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   subsample: 0.7901502662791386
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   colsample_bytree: 0.5017689845774366
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5258591625842948
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   colsample_bynode: 0.9578419206300275
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:33:55,870] [INFO] [<frozen importlib] -   scale_pos_weight: 9.481029961384467
[2025-11-19 08:33:55,939] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:33:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:33:55,862] Trial 82 pruned. 
[0]	train-logloss:0.82147	train-auc:0.63374	train-aucpr:0.21240	val-logloss:0.83163	val-auc:0.62911	val-aucpr:0.11831
[10]	train-logloss:0.78179	train-auc:0.68619	train-aucpr:0.28568	val-logloss:0.73074	val-auc:0.68357	val-aucpr:0.18920
[20]	train-logloss:0.76106	train-auc:0.69622	train-aucpr:0.30245	val-logloss:0.67439	val-auc:0.69193	val-aucpr:0.20041
[30]	train-logloss:0.74879	train-auc:0.70054	train-aucpr:0.31003	val-logloss:0.63472	val-auc:0.69847	val-aucpr:0.22177
[40]	train-logloss:0.73965	train-auc:0.70811	train-aucpr:0.31576	val-logloss:0.61464	val-auc:0.69209	val-aucpr:0.21346
[50]	train-logloss:0.73341	train-auc:0.71262	train-aucpr:0.31979	val-logloss:0.60230	val-auc:0.69340	val-aucpr:0.20986
[60]	train-logloss:0.72793	train-auc:0.71852	train-aucpr:0.32654	val-logloss:0.58808	val-auc:0.69069	val-aucpr:0.20890
[2025-11-19 08:33:56,126] [INFO] [<frozen importlib] - Training completed at iteration 30
[2025-11-19 08:33:56,126] [INFO] [<frozen importlib] - Best train loss: 0.7488
[2025-11-19 08:33:56,126] [INFO] [<frozen importlib] - Best val loss: 0.6347
[2025-11-19 08:33:56,126] [INFO] [<frozen importlib] - Best val AUC: 0.6985
[2025-11-19 08:33:56,126] [INFO] [<frozen importlib] - Best val AUCPR: 0.2218
[2025-11-19 08:33:56,131] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:33:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:34:05,639] [INFO] [<frozen importlib] - Optimal threshold: 0.5704
[2025-11-19 08:34:05,640] [INFO] [<frozen importlib] - Best f1: 0.2694
[2025-11-19 08:34:05,640] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:34:05,686] [INFO] [<frozen importlib] - Validation Results (threshold=0.5704):
[2025-11-19 08:34:05,686] [INFO] [<frozen importlib] -   Accuracy: 0.9016
[2025-11-19 08:34:05,686] [INFO] [<frozen importlib] -   Precision: 0.3135
[2025-11-19 08:34:05,686] [INFO] [<frozen importlib] -   Recall: 0.2362
[2025-11-19 08:34:05,686] [INFO] [<frozen importlib] -   F1 Score: 0.2694
[2025-11-19 08:34:05,686] [INFO] [<frozen importlib] -   AUROC: 0.6985
[2025-11-19 08:34:05,686] [INFO] [<frozen importlib] -   AUPRC: 0.2221
[2025-11-19 08:34:05,686] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:34:05,686] [INFO] [<frozen importlib] -     TN=16694, FP=751
[2025-11-19 08:34:05,686] [INFO] [<frozen importlib] -     FN=1109, TP=343
[2025-11-19 08:34:05,710] [INFO] [<frozen importlib] - Trial 83: AUPRC=0.2221, F1=0.4573, Prec=0.4651, Rec=0.4497 | Optimizing auprc=0.2221
                                                                                        Best trial: 15. Best value: 0.234562:  17%|█▋        | 83/500 [12:03<1:03:30,  9.14s/it]Best trial: 15. Best value: 0.234562:  17%|█▋        | 83/500 [12:03<1:03:30,  9.14s/it]Best trial: 15. Best value: 0.234562:  17%|█▋        | 84/500 [12:03<1:04:50,  9.35s/it][2025-11-19 08:34:05,719] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.644520850111354
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   gamma: 0.06802332790586155
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   alpha: 1.0611049411694344
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   lambda: 1.7028421770767945
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   learning_rate: 0.053067842786525266
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   subsample: 0.7575429624550749
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   colsample_bytree: 0.532883546890336
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5558243009285769
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   colsample_bynode: 0.9743644102245673
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:34:05,719] [INFO] [<frozen importlib] -   scale_pos_weight: 7.644520850111354
[2025-11-19 08:34:05,795] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:34:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:34:05,711] Trial 83 finished with value: 0.22214075107401543 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.09905776543485112, 'learning_rate': 0.056606764406209646, 'n_estimators': 450, 'alpha': 1.0284877811521476, 'lambda': 2.691932228919423, 'subsample': 0.7901502662791386, 'colsample_bytree': 0.5017689845774366, 'colsample_bylevel': 0.5258591625842948, 'colsample_bynode': 0.9578419206300275, 'scale_pos_weight': 9.481029961384467}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.73189	train-auc:0.63303	train-aucpr:0.22859	val-logloss:0.73281	val-auc:0.65122	val-aucpr:0.14135
[10]	train-logloss:0.69744	train-auc:0.68476	train-aucpr:0.29382	val-logloss:0.65716	val-auc:0.70720	val-aucpr:0.20683
[20]	train-logloss:0.67930	train-auc:0.69416	train-aucpr:0.30384	val-logloss:0.60201	val-auc:0.71782	val-aucpr:0.21274
[30]	train-logloss:0.66858	train-auc:0.69833	train-aucpr:0.31054	val-logloss:0.57468	val-auc:0.71156	val-aucpr:0.21866
[40]	train-logloss:0.66111	train-auc:0.70505	train-aucpr:0.31549	val-logloss:0.55413	val-auc:0.70377	val-aucpr:0.20703
[50]	train-logloss:0.65555	train-auc:0.71022	train-aucpr:0.32030	val-logloss:0.54374	val-auc:0.69945	val-aucpr:0.20313
[59]	train-logloss:0.65112	train-auc:0.71596	train-aucpr:0.32737	val-logloss:0.54697	val-auc:0.70120	val-aucpr:0.20332
[2025-11-19 08:34:05,984] [INFO] [<frozen importlib] - Training completed at iteration 30
[2025-11-19 08:34:05,984] [INFO] [<frozen importlib] - Best train loss: 0.6686
[2025-11-19 08:34:05,984] [INFO] [<frozen importlib] - Best val loss: 0.5747
[2025-11-19 08:34:05,984] [INFO] [<frozen importlib] - Best val AUC: 0.7116
[2025-11-19 08:34:05,984] [INFO] [<frozen importlib] - Best val AUCPR: 0.2187
[2025-11-19 08:34:05,989] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:34:06] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:34:13,153] [INFO] [<frozen importlib] - Optimal threshold: 0.5294
[2025-11-19 08:34:13,153] [INFO] [<frozen importlib] - Best f1: 0.2690
[2025-11-19 08:34:13,153] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:34:13,202] [INFO] [<frozen importlib] - Validation Results (threshold=0.5294):
[2025-11-19 08:34:13,202] [INFO] [<frozen importlib] -   Accuracy: 0.8936
[2025-11-19 08:34:13,202] [INFO] [<frozen importlib] -   Precision: 0.2848
[2025-11-19 08:34:13,202] [INFO] [<frozen importlib] -   Recall: 0.2548
[2025-11-19 08:34:13,202] [INFO] [<frozen importlib] -   F1 Score: 0.2690
[2025-11-19 08:34:13,202] [INFO] [<frozen importlib] -   AUROC: 0.7116
[2025-11-19 08:34:13,202] [INFO] [<frozen importlib] -   AUPRC: 0.2190
[2025-11-19 08:34:13,202] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:34:13,202] [INFO] [<frozen importlib] -     TN=16516, FP=929
[2025-11-19 08:34:13,202] [INFO] [<frozen importlib] -     FN=1082, TP=370
[2025-11-19 08:34:13,228] [INFO] [<frozen importlib] - Trial 84: AUPRC=0.2190, F1=0.4473, Prec=0.4248, Rec=0.4725 | Optimizing auprc=0.2190
[2025-11-19 08:34:13,228] [INFO] [<frozen importlib] - Trial 84 pruned.
[2025-11-19 08:34:13,228] [ERROR] [<frozen importlib] - Trial 84 failed with error: 
                                                                                        Best trial: 15. Best value: 0.234562:  17%|█▋        | 84/500 [12:11<1:04:50,  9.35s/it]Best trial: 15. Best value: 0.234562:  17%|█▋        | 84/500 [12:11<1:04:50,  9.35s/it]Best trial: 15. Best value: 0.234562:  17%|█▋        | 85/500 [12:11<1:00:52,  8.80s/it][2025-11-19 08:34:13,243] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.721511234671373
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   gamma: 0.03746783859257395
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   alpha: 0.9048500487443297
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   lambda: 1.4496775102011443
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   learning_rate: 0.04740253909139041
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   subsample: 0.7382484277715696
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   colsample_bytree: 0.5000765373954672
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5017933721986363
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   colsample_bynode: 0.878528943880928
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:34:13,243] [INFO] [<frozen importlib] -   scale_pos_weight: 8.721511234671373
[2025-11-19 08:34:13,319] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:34:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:34:13,228] Trial 84 pruned. 
[0]	train-logloss:0.78643	train-auc:0.63317	train-aucpr:0.21816	val-logloss:0.79271	val-auc:0.64700	val-aucpr:0.14116
[10]	train-logloss:0.75245	train-auc:0.68914	train-aucpr:0.28991	val-logloss:0.70278	val-auc:0.66936	val-aucpr:0.18077
[20]	train-logloss:0.73255	train-auc:0.69653	train-aucpr:0.30348	val-logloss:0.65565	val-auc:0.69539	val-aucpr:0.20508
[30]	train-logloss:0.72074	train-auc:0.69987	train-aucpr:0.30860	val-logloss:0.61543	val-auc:0.70561	val-aucpr:0.22313
[40]	train-logloss:0.71238	train-auc:0.70403	train-aucpr:0.31284	val-logloss:0.59523	val-auc:0.70319	val-aucpr:0.22187
[50]	train-logloss:0.70643	train-auc:0.70888	train-aucpr:0.31713	val-logloss:0.59730	val-auc:0.69526	val-aucpr:0.21306
[60]	train-logloss:0.70148	train-auc:0.71267	train-aucpr:0.32248	val-logloss:0.59010	val-auc:0.69449	val-aucpr:0.21814
[61]	train-logloss:0.70099	train-auc:0.71336	train-aucpr:0.32313	val-logloss:0.58974	val-auc:0.69521	val-aucpr:0.21898
[2025-11-19 08:34:13,513] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 08:34:13,513] [INFO] [<frozen importlib] - Best train loss: 0.7186
[2025-11-19 08:34:13,513] [INFO] [<frozen importlib] - Best val loss: 0.6131
[2025-11-19 08:34:13,513] [INFO] [<frozen importlib] - Best val AUC: 0.7072
[2025-11-19 08:34:13,513] [INFO] [<frozen importlib] - Best val AUCPR: 0.2252
[2025-11-19 08:34:13,519] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:34:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:34:23,044] [INFO] [<frozen importlib] - Optimal threshold: 0.5431
[2025-11-19 08:34:23,044] [INFO] [<frozen importlib] - Best f1: 0.2689
[2025-11-19 08:34:23,044] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:34:23,088] [INFO] [<frozen importlib] - Validation Results (threshold=0.5431):
[2025-11-19 08:34:23,088] [INFO] [<frozen importlib] -   Accuracy: 0.8915
[2025-11-19 08:34:23,088] [INFO] [<frozen importlib] -   Precision: 0.2788
[2025-11-19 08:34:23,088] [INFO] [<frozen importlib] -   Recall: 0.2596
[2025-11-19 08:34:23,088] [INFO] [<frozen importlib] -   F1 Score: 0.2689
[2025-11-19 08:34:23,088] [INFO] [<frozen importlib] -   AUROC: 0.7072
[2025-11-19 08:34:23,088] [INFO] [<frozen importlib] -   AUPRC: 0.2256
[2025-11-19 08:34:23,088] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:34:23,088] [INFO] [<frozen importlib] -     TN=16470, FP=975
[2025-11-19 08:34:23,088] [INFO] [<frozen importlib] -     FN=1075, TP=377
[2025-11-19 08:34:23,111] [INFO] [<frozen importlib] - Trial 85: AUPRC=0.2256, F1=0.4477, Prec=0.4179, Rec=0.4821 | Optimizing auprc=0.2256
                                                                                        Best trial: 15. Best value: 0.234562:  17%|█▋        | 85/500 [12:21<1:00:52,  8.80s/it]Best trial: 15. Best value: 0.234562:  17%|█▋        | 85/500 [12:21<1:00:52,  8.80s/it]Best trial: 15. Best value: 0.234562:  17%|█▋        | 86/500 [12:21<1:02:58,  9.13s/it][2025-11-19 08:34:23,120] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.998188226291237
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   gamma: 0.21210964670583576
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   alpha: 0.8269969876891811
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   lambda: 2.022853579513606
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   learning_rate: 0.05002247838948042
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   subsample: 0.8269934913697266
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   colsample_bytree: 0.5169301812897599
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5246516347463153
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   colsample_bynode: 0.8224838048637291
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:34:23,120] [INFO] [<frozen importlib] -   scale_pos_weight: 6.998188226291237
[2025-11-19 08:34:23,198] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:34:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:34:23,112] Trial 85 finished with value: 0.2256052023628418 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.03746783859257395, 'learning_rate': 0.04740253909139041, 'n_estimators': 500, 'alpha': 0.9048500487443297, 'lambda': 1.4496775102011443, 'subsample': 0.7382484277715696, 'colsample_bytree': 0.5000765373954672, 'colsample_bylevel': 0.5017933721986363, 'colsample_bynode': 0.878528943880928, 'scale_pos_weight': 8.721511234671373}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.69818	train-auc:0.63355	train-aucpr:0.22925	val-logloss:0.69520	val-auc:0.65092	val-aucpr:0.13598
[10]	train-logloss:0.66871	train-auc:0.67988	train-aucpr:0.28434	val-logloss:0.64787	val-auc:0.65550	val-aucpr:0.15737
[20]	train-logloss:0.65186	train-auc:0.69008	train-aucpr:0.29927	val-logloss:0.59093	val-auc:0.69816	val-aucpr:0.20944
[30]	train-logloss:0.64139	train-auc:0.69464	train-aucpr:0.30712	val-logloss:0.54797	val-auc:0.71030	val-aucpr:0.22437
[40]	train-logloss:0.63381	train-auc:0.70007	train-aucpr:0.31298	val-logloss:0.52321	val-auc:0.71057	val-aucpr:0.22642
[50]	train-logloss:0.62820	train-auc:0.70658	train-aucpr:0.31829	val-logloss:0.49303	val-auc:0.70799	val-aucpr:0.21203
[60]	train-logloss:0.62399	train-auc:0.71276	train-aucpr:0.32379	val-logloss:0.48544	val-auc:0.70354	val-aucpr:0.20595
[64]	train-logloss:0.62249	train-auc:0.71488	train-aucpr:0.32565	val-logloss:0.47964	val-auc:0.70001	val-aucpr:0.20150
[2025-11-19 08:34:23,399] [INFO] [<frozen importlib] - Training completed at iteration 35
[2025-11-19 08:34:23,399] [INFO] [<frozen importlib] - Best train loss: 0.6373
[2025-11-19 08:34:23,399] [INFO] [<frozen importlib] - Best val loss: 0.5308
[2025-11-19 08:34:23,399] [INFO] [<frozen importlib] - Best val AUC: 0.7122
[2025-11-19 08:34:23,399] [INFO] [<frozen importlib] - Best val AUCPR: 0.2287
[2025-11-19 08:34:23,404] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:34:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:34:32,937] [INFO] [<frozen importlib] - Optimal threshold: 0.4879
[2025-11-19 08:34:32,937] [INFO] [<frozen importlib] - Best f1: 0.2724
[2025-11-19 08:34:32,937] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:34:32,980] [INFO] [<frozen importlib] - Validation Results (threshold=0.4879):
[2025-11-19 08:34:32,980] [INFO] [<frozen importlib] -   Accuracy: 0.8965
[2025-11-19 08:34:32,980] [INFO] [<frozen importlib] -   Precision: 0.2964
[2025-11-19 08:34:32,980] [INFO] [<frozen importlib] -   Recall: 0.2521
[2025-11-19 08:34:32,980] [INFO] [<frozen importlib] -   F1 Score: 0.2724
[2025-11-19 08:34:32,980] [INFO] [<frozen importlib] -   AUROC: 0.7122
[2025-11-19 08:34:32,980] [INFO] [<frozen importlib] -   AUPRC: 0.2291
[2025-11-19 08:34:32,980] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:34:32,980] [INFO] [<frozen importlib] -     TN=16576, FP=869
[2025-11-19 08:34:32,980] [INFO] [<frozen importlib] -     FN=1086, TP=366
[2025-11-19 08:34:33,003] [INFO] [<frozen importlib] - Trial 86: AUPRC=0.2291, F1=0.4355, Prec=0.4264, Rec=0.4449 | Optimizing auprc=0.2291
                                                                                        Best trial: 15. Best value: 0.234562:  17%|█▋        | 86/500 [12:30<1:02:58,  9.13s/it]Best trial: 15. Best value: 0.234562:  17%|█▋        | 86/500 [12:30<1:02:58,  9.13s/it]Best trial: 15. Best value: 0.234562:  17%|█▋        | 87/500 [12:30<1:04:23,  9.36s/it][2025-11-19 08:34:33,012] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.860262361454306
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   gamma: 0.21632892743840823
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   alpha: 0.8366265692492781
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   lambda: 2.070802941061696
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   learning_rate: 0.045553614916125196
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   subsample: 0.8452094671206707
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   colsample_bytree: 0.5153950534835394
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5695690955542125
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   colsample_bynode: 0.8490059880285329
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:34:33,012] [INFO] [<frozen importlib] -   scale_pos_weight: 6.860262361454306
[2025-11-19 08:34:33,091] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:34:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:34:33,004] Trial 86 finished with value: 0.22906169948924981 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.21210964670583576, 'learning_rate': 0.05002247838948042, 'n_estimators': 450, 'alpha': 0.8269969876891811, 'lambda': 2.022853579513606, 'subsample': 0.8269934913697266, 'colsample_bytree': 0.5169301812897599, 'colsample_bylevel': 0.5246516347463153, 'colsample_bynode': 0.8224838048637291, 'scale_pos_weight': 6.998188226291237}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.69087	train-auc:0.63918	train-aucpr:0.24088	val-logloss:0.68768	val-auc:0.64112	val-aucpr:0.15170
[10]	train-logloss:0.66359	train-auc:0.68022	train-aucpr:0.28876	val-logloss:0.62037	val-auc:0.67131	val-aucpr:0.18807
[20]	train-logloss:0.64743	train-auc:0.68826	train-aucpr:0.30073	val-logloss:0.57268	val-auc:0.68656	val-aucpr:0.21143
[30]	train-logloss:0.63679	train-auc:0.69453	train-aucpr:0.30750	val-logloss:0.53625	val-auc:0.68985	val-aucpr:0.22252
[40]	train-logloss:0.62927	train-auc:0.70026	train-aucpr:0.31362	val-logloss:0.52298	val-auc:0.69476	val-aucpr:0.22256
[50]	train-logloss:0.62425	train-auc:0.70424	train-aucpr:0.31761	val-logloss:0.51514	val-auc:0.69543	val-aucpr:0.22331
[60]	train-logloss:0.62011	train-auc:0.70939	train-aucpr:0.32231	val-logloss:0.50795	val-auc:0.69577	val-aucpr:0.22226
[70]	train-logloss:0.61647	train-auc:0.71461	train-aucpr:0.32657	val-logloss:0.50605	val-auc:0.68890	val-aucpr:0.21422
[74]	train-logloss:0.61493	train-auc:0.71689	train-aucpr:0.32941	val-logloss:0.49458	val-auc:0.69050	val-aucpr:0.21146
[2025-11-19 08:34:33,314] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 08:34:33,314] [INFO] [<frozen importlib] - Best train loss: 0.6272
[2025-11-19 08:34:33,314] [INFO] [<frozen importlib] - Best val loss: 0.5166
[2025-11-19 08:34:33,314] [INFO] [<frozen importlib] - Best val AUC: 0.6980
[2025-11-19 08:34:33,314] [INFO] [<frozen importlib] - Best val AUCPR: 0.2262
[2025-11-19 08:34:33,319] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:34:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:34:44,098] [INFO] [<frozen importlib] - Optimal threshold: 0.4894
[2025-11-19 08:34:44,098] [INFO] [<frozen importlib] - Best f1: 0.2716
[2025-11-19 08:34:44,098] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:34:44,142] [INFO] [<frozen importlib] - Validation Results (threshold=0.4894):
[2025-11-19 08:34:44,142] [INFO] [<frozen importlib] -   Accuracy: 0.8970
[2025-11-19 08:34:44,142] [INFO] [<frozen importlib] -   Precision: 0.2973
[2025-11-19 08:34:44,142] [INFO] [<frozen importlib] -   Recall: 0.2500
[2025-11-19 08:34:44,142] [INFO] [<frozen importlib] -   F1 Score: 0.2716
[2025-11-19 08:34:44,142] [INFO] [<frozen importlib] -   AUROC: 0.6980
[2025-11-19 08:34:44,142] [INFO] [<frozen importlib] -   AUPRC: 0.2266
[2025-11-19 08:34:44,142] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:34:44,142] [INFO] [<frozen importlib] -     TN=16587, FP=858
[2025-11-19 08:34:44,142] [INFO] [<frozen importlib] -     FN=1089, TP=363
[2025-11-19 08:34:44,165] [INFO] [<frozen importlib] - Trial 87: AUPRC=0.2266, F1=0.4376, Prec=0.4299, Rec=0.4456 | Optimizing auprc=0.2266
                                                                                        Best trial: 15. Best value: 0.234562:  17%|█▋        | 87/500 [12:42<1:04:23,  9.36s/it]Best trial: 15. Best value: 0.234562:  17%|█▋        | 87/500 [12:42<1:04:23,  9.36s/it]Best trial: 15. Best value: 0.234562:  18%|█▊        | 88/500 [12:42<1:07:57,  9.90s/it][2025-11-19 08:34:44,176] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.631362006709303
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   gamma: 0.1811733647495376
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   alpha: 0.7021585817936496
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   lambda: 1.7980349894523493
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   learning_rate: 0.04098442415237318
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   subsample: 0.8005536472184569
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   colsample_bytree: 0.5482182732472327
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5911278421405926
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   colsample_bynode: 0.7897641425384319
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:34:44,176] [INFO] [<frozen importlib] -   scale_pos_weight: 5.631362006709303
[2025-11-19 08:34:44,253] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:34:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:34:44,166] Trial 87 finished with value: 0.22656945864243286 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.21632892743840823, 'learning_rate': 0.045553614916125196, 'n_estimators': 450, 'alpha': 0.8366265692492781, 'lambda': 2.070802941061696, 'subsample': 0.8452094671206707, 'colsample_bytree': 0.5153950534835394, 'colsample_bylevel': 0.5695690955542125, 'colsample_bynode': 0.8490059880285329, 'scale_pos_weight': 6.860262361454306}. Best is trial 15 with value: 0.2345623875788278.
[0]	train-logloss:0.62270	train-auc:0.64762	train-aucpr:0.24349	val-logloss:0.60853	val-auc:0.62146	val-aucpr:0.11382
[10]	train-logloss:0.59997	train-auc:0.68082	train-aucpr:0.29245	val-logloss:0.55261	val-auc:0.67381	val-aucpr:0.19811
[20]	train-logloss:0.58646	train-auc:0.68668	train-aucpr:0.30222	val-logloss:0.52358	val-auc:0.70339	val-aucpr:0.21743
[30]	train-logloss:0.57726	train-auc:0.69319	train-aucpr:0.30789	val-logloss:0.49549	val-auc:0.70606	val-aucpr:0.21706
[40]	train-logloss:0.57063	train-auc:0.69785	train-aucpr:0.31308	val-logloss:0.47712	val-auc:0.70030	val-aucpr:0.22381
[50]	train-logloss:0.56536	train-auc:0.70263	train-aucpr:0.31789	val-logloss:0.46408	val-auc:0.70691	val-aucpr:0.22957
[60]	train-logloss:0.56160	train-auc:0.70668	train-aucpr:0.32159	val-logloss:0.44524	val-auc:0.71071	val-aucpr:0.23644
[70]	train-logloss:0.55846	train-auc:0.71177	train-aucpr:0.32595	val-logloss:0.43986	val-auc:0.70598	val-aucpr:0.22811
[80]	train-logloss:0.55579	train-auc:0.71480	train-aucpr:0.32950	val-logloss:0.43439	val-auc:0.70191	val-aucpr:0.21826
[90]	train-logloss:0.55344	train-auc:0.71923	train-aucpr:0.33317	val-logloss:0.44053	val-auc:0.70030	val-aucpr:0.21320
[2025-11-19 08:34:44,516] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:34:44,516] [INFO] [<frozen importlib] - Best train loss: 0.5616
[2025-11-19 08:34:44,516] [INFO] [<frozen importlib] - Best val loss: 0.4452
[2025-11-19 08:34:44,516] [INFO] [<frozen importlib] - Best val AUC: 0.7107
[2025-11-19 08:34:44,516] [INFO] [<frozen importlib] - Best val AUCPR: 0.2364
[2025-11-19 08:34:44,522] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:34:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:34:56,385] [INFO] [<frozen importlib] - Optimal threshold: 0.4439
[2025-11-19 08:34:56,385] [INFO] [<frozen importlib] - Best f1: 0.2773
[2025-11-19 08:34:56,385] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:34:56,429] [INFO] [<frozen importlib] - Validation Results (threshold=0.4439):
[2025-11-19 08:34:56,429] [INFO] [<frozen importlib] -   Accuracy: 0.9026
[2025-11-19 08:34:56,429] [INFO] [<frozen importlib] -   Precision: 0.3227
[2025-11-19 08:34:56,429] [INFO] [<frozen importlib] -   Recall: 0.2431
[2025-11-19 08:34:56,429] [INFO] [<frozen importlib] -   F1 Score: 0.2773
[2025-11-19 08:34:56,429] [INFO] [<frozen importlib] -   AUROC: 0.7107
[2025-11-19 08:34:56,429] [INFO] [<frozen importlib] -   AUPRC: 0.2367
[2025-11-19 08:34:56,429] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:34:56,429] [INFO] [<frozen importlib] -     TN=16704, FP=741
[2025-11-19 08:34:56,429] [INFO] [<frozen importlib] -     FN=1099, TP=353
[2025-11-19 08:34:56,459] [INFO] [<frozen importlib] - Trial 88: AUPRC=0.2367, F1=0.4551, Prec=0.4658, Rec=0.4449 | Optimizing auprc=0.2367
[2025-11-19 08:34:56,460] [INFO] [<frozen importlib] -   → New best model found! (value=0.2367)
                                                                                        Best trial: 15. Best value: 0.234562:  18%|█▊        | 88/500 [12:54<1:07:57,  9.90s/it]Best trial: 88. Best value: 0.236742:  18%|█▊        | 88/500 [12:54<1:07:57,  9.90s/it]Best trial: 88. Best value: 0.236742:  18%|█▊        | 89/500 [12:54<1:12:43, 10.62s/it][2025-11-19 08:34:56,468] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.3187880170624595
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   gamma: 0.26843015322907926
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   alpha: 0.5425719648392888
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   lambda: 1.2329953331597059
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   learning_rate: 0.04161710020280459
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   subsample: 0.8311041967649924
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   colsample_bytree: 0.5562350322938018
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5241433073748916
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   colsample_bynode: 0.7963048028945404
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:34:56,468] [INFO] [<frozen importlib] -   scale_pos_weight: 6.3187880170624595
[2025-11-19 08:34:56,541] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:34:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:34:56,460] Trial 88 finished with value: 0.23674240239886388 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.1811733647495376, 'learning_rate': 0.04098442415237318, 'n_estimators': 450, 'alpha': 0.7021585817936496, 'lambda': 1.7980349894523493, 'subsample': 0.8005536472184569, 'colsample_bytree': 0.5482182732472327, 'colsample_bylevel': 0.5911278421405926, 'colsample_bynode': 0.7897641425384319, 'scale_pos_weight': 5.631362006709303}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.66151	train-auc:0.63939	train-aucpr:0.23172	val-logloss:0.65294	val-auc:0.63077	val-aucpr:0.13748
[10]	train-logloss:0.63646	train-auc:0.67895	train-aucpr:0.28986	val-logloss:0.58983	val-auc:0.69331	val-aucpr:0.21065
[20]	train-logloss:0.62157	train-auc:0.68772	train-aucpr:0.29853	val-logloss:0.56011	val-auc:0.69955	val-aucpr:0.20495
[30]	train-logloss:0.61180	train-auc:0.69375	train-aucpr:0.30530	val-logloss:0.52260	val-auc:0.70013	val-aucpr:0.21968
[40]	train-logloss:0.60490	train-auc:0.69787	train-aucpr:0.31000	val-logloss:0.51989	val-auc:0.70212	val-aucpr:0.22147
[50]	train-logloss:0.59963	train-auc:0.70336	train-aucpr:0.31417	val-logloss:0.50869	val-auc:0.70376	val-aucpr:0.22437
[60]	train-logloss:0.59577	train-auc:0.70784	train-aucpr:0.31819	val-logloss:0.49486	val-auc:0.70458	val-aucpr:0.22527
[70]	train-logloss:0.59247	train-auc:0.71139	train-aucpr:0.32203	val-logloss:0.49295	val-auc:0.70812	val-aucpr:0.22637
[80]	train-logloss:0.58995	train-auc:0.71489	train-aucpr:0.32539	val-logloss:0.48840	val-auc:0.70572	val-aucpr:0.22803
[90]	train-logloss:0.58735	train-auc:0.71853	train-aucpr:0.32988	val-logloss:0.47363	val-auc:0.70199	val-aucpr:0.22671
[95]	train-logloss:0.58625	train-auc:0.72062	train-aucpr:0.33261	val-logloss:0.46482	val-auc:0.70197	val-aucpr:0.22627
[2025-11-19 08:34:56,815] [INFO] [<frozen importlib] - Training completed at iteration 66
[2025-11-19 08:34:56,815] [INFO] [<frozen importlib] - Best train loss: 0.5937
[2025-11-19 08:34:56,815] [INFO] [<frozen importlib] - Best val loss: 0.4906
[2025-11-19 08:34:56,815] [INFO] [<frozen importlib] - Best val AUC: 0.7068
[2025-11-19 08:34:56,815] [INFO] [<frozen importlib] - Best val AUCPR: 0.2281
[2025-11-19 08:34:56,820] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:34:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:35:10,163] [INFO] [<frozen importlib] - Optimal threshold: 0.4772
[2025-11-19 08:35:10,163] [INFO] [<frozen importlib] - Best f1: 0.2745
[2025-11-19 08:35:10,163] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:35:10,217] [INFO] [<frozen importlib] - Validation Results (threshold=0.4772):
[2025-11-19 08:35:10,217] [INFO] [<frozen importlib] -   Accuracy: 0.8968
[2025-11-19 08:35:10,217] [INFO] [<frozen importlib] -   Precision: 0.2983
[2025-11-19 08:35:10,217] [INFO] [<frozen importlib] -   Recall: 0.2541
[2025-11-19 08:35:10,217] [INFO] [<frozen importlib] -   F1 Score: 0.2745
[2025-11-19 08:35:10,217] [INFO] [<frozen importlib] -   AUROC: 0.7068
[2025-11-19 08:35:10,217] [INFO] [<frozen importlib] -   AUPRC: 0.2287
[2025-11-19 08:35:10,217] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:35:10,217] [INFO] [<frozen importlib] -     TN=16577, FP=868
[2025-11-19 08:35:10,217] [INFO] [<frozen importlib] -     FN=1083, TP=369
[2025-11-19 08:35:10,240] [INFO] [<frozen importlib] - Trial 89: AUPRC=0.2287, F1=0.4502, Prec=0.4371, Rec=0.4642 | Optimizing auprc=0.2287
                                                                                        Best trial: 88. Best value: 0.236742:  18%|█▊        | 89/500 [13:08<1:12:43, 10.62s/it]Best trial: 88. Best value: 0.236742:  18%|█▊        | 89/500 [13:08<1:12:43, 10.62s/it]Best trial: 88. Best value: 0.236742:  18%|█▊        | 90/500 [13:08<1:19:01, 11.57s/it][2025-11-19 08:35:10,252] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.701132933543956
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   gamma: 0.2731932978841425
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   alpha: 0.5494810627794126
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   lambda: 1.2503796718430369
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   learning_rate: 0.04166128632073687
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   subsample: 0.8323884519889977
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   colsample_bytree: 0.5559083854842285
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5934263158080765
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   colsample_bynode: 0.8234539269504176
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:35:10,252] [INFO] [<frozen importlib] -   scale_pos_weight: 5.701132933543956
[2025-11-19 08:35:10,333] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:35:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:35:10,240] Trial 89 finished with value: 0.2286577276244031 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.26843015322907926, 'learning_rate': 0.04161710020280459, 'n_estimators': 450, 'alpha': 0.5425719648392888, 'lambda': 1.2329953331597059, 'subsample': 0.8311041967649924, 'colsample_bytree': 0.5562350322938018, 'colsample_bylevel': 0.5241433073748916, 'colsample_bynode': 0.7963048028945404, 'scale_pos_weight': 6.3187880170624595}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.62680	train-auc:0.64557	train-aucpr:0.23588	val-logloss:0.61380	val-auc:0.63400	val-aucpr:0.13284
[10]	train-logloss:0.60360	train-auc:0.68233	train-aucpr:0.29119	val-logloss:0.55649	val-auc:0.69598	val-aucpr:0.20381
[20]	train-logloss:0.58921	train-auc:0.68853	train-aucpr:0.30090	val-logloss:0.51861	val-auc:0.70477	val-aucpr:0.21636
[30]	train-logloss:0.57970	train-auc:0.69468	train-aucpr:0.30752	val-logloss:0.49812	val-auc:0.70704	val-aucpr:0.22039
[40]	train-logloss:0.57326	train-auc:0.69954	train-aucpr:0.31292	val-logloss:0.49055	val-auc:0.70148	val-aucpr:0.21770
[50]	train-logloss:0.56799	train-auc:0.70515	train-aucpr:0.31836	val-logloss:0.49294	val-auc:0.70341	val-aucpr:0.21687
[60]	train-logloss:0.56428	train-auc:0.70990	train-aucpr:0.32295	val-logloss:0.47634	val-auc:0.70267	val-aucpr:0.21908
[2025-11-19 08:35:10,539] [INFO] [<frozen importlib] - Training completed at iteration 30
[2025-11-19 08:35:10,539] [INFO] [<frozen importlib] - Best train loss: 0.5797
[2025-11-19 08:35:10,539] [INFO] [<frozen importlib] - Best val loss: 0.4981
[2025-11-19 08:35:10,539] [INFO] [<frozen importlib] - Best val AUC: 0.7070
[2025-11-19 08:35:10,539] [INFO] [<frozen importlib] - Best val AUCPR: 0.2204
[2025-11-19 08:35:10,545] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:35:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:35:16,738] [INFO] [<frozen importlib] - Optimal threshold: 0.4509
[2025-11-19 08:35:16,738] [INFO] [<frozen importlib] - Best f1: 0.2744
[2025-11-19 08:35:16,738] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:35:16,780] [INFO] [<frozen importlib] - Validation Results (threshold=0.4509):
[2025-11-19 08:35:16,780] [INFO] [<frozen importlib] -   Accuracy: 0.8953
[2025-11-19 08:35:16,780] [INFO] [<frozen importlib] -   Precision: 0.2936
[2025-11-19 08:35:16,780] [INFO] [<frozen importlib] -   Recall: 0.2576
[2025-11-19 08:35:16,780] [INFO] [<frozen importlib] -   F1 Score: 0.2744
[2025-11-19 08:35:16,780] [INFO] [<frozen importlib] -   AUROC: 0.7070
[2025-11-19 08:35:16,780] [INFO] [<frozen importlib] -   AUPRC: 0.2206
[2025-11-19 08:35:16,780] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:35:16,780] [INFO] [<frozen importlib] -     TN=16545, FP=900
[2025-11-19 08:35:16,780] [INFO] [<frozen importlib] -     FN=1078, TP=374
[2025-11-19 08:35:16,809] [INFO] [<frozen importlib] - Trial 90: AUPRC=0.2206, F1=0.4408, Prec=0.4249, Rec=0.4580 | Optimizing auprc=0.2206
[2025-11-19 08:35:16,809] [INFO] [<frozen importlib] - Trial 90 pruned.
[2025-11-19 08:35:16,809] [ERROR] [<frozen importlib] - Trial 90 failed with error: 
                                                                                        Best trial: 88. Best value: 0.236742:  18%|█▊        | 90/500 [13:14<1:19:01, 11.57s/it]Best trial: 88. Best value: 0.236742:  18%|█▊        | 90/500 [13:14<1:19:01, 11.57s/it]Best trial: 88. Best value: 0.236742:  18%|█▊        | 91/500 [13:14<1:08:37, 10.07s/it][2025-11-19 08:35:16,816] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.196547509424415
[2025-11-19 08:35:16,816] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:35:16,816] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:35:16,816] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:35:16,816] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:35:16,816] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:35:16,816] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:35:16,816] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   gamma: 0.3173622340369953
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   alpha: 0.4631672668344643
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   lambda: 1.7998441454645149
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   learning_rate: 0.043648631508914654
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   subsample: 0.802552230401412
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   colsample_bytree: 0.5271857884896186
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5250903485257413
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   colsample_bynode: 0.8063770665143838
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:35:16,817] [INFO] [<frozen importlib] -   scale_pos_weight: 6.196547509424415
[2025-11-19 08:35:16,890] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:35:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:35:16,809] Trial 90 pruned. 
[0]	train-logloss:0.65474	train-auc:0.63288	train-aucpr:0.22971	val-logloss:0.64652	val-auc:0.64900	val-aucpr:0.13522
[10]	train-logloss:0.62912	train-auc:0.68142	train-aucpr:0.28996	val-logloss:0.59576	val-auc:0.67855	val-aucpr:0.19059
[20]	train-logloss:0.61410	train-auc:0.68791	train-aucpr:0.30192	val-logloss:0.55310	val-auc:0.70461	val-aucpr:0.21473
[30]	train-logloss:0.60447	train-auc:0.69371	train-aucpr:0.30748	val-logloss:0.51531	val-auc:0.70883	val-aucpr:0.22292
[40]	train-logloss:0.59788	train-auc:0.69923	train-aucpr:0.31342	val-logloss:0.49478	val-auc:0.70527	val-aucpr:0.22057
[50]	train-logloss:0.59255	train-auc:0.70370	train-aucpr:0.31722	val-logloss:0.48229	val-auc:0.70261	val-aucpr:0.21976
[60]	train-logloss:0.58860	train-auc:0.70796	train-aucpr:0.32183	val-logloss:0.47794	val-auc:0.70147	val-aucpr:0.22256
[63]	train-logloss:0.58776	train-auc:0.70933	train-aucpr:0.32313	val-logloss:0.47706	val-auc:0.70283	val-aucpr:0.22174
[2025-11-19 08:35:17,087] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:35:17,087] [INFO] [<frozen importlib] - Best train loss: 0.6017
[2025-11-19 08:35:17,087] [INFO] [<frozen importlib] - Best val loss: 0.5038
[2025-11-19 08:35:17,087] [INFO] [<frozen importlib] - Best val AUC: 0.7097
[2025-11-19 08:35:17,087] [INFO] [<frozen importlib] - Best val AUCPR: 0.2239
[2025-11-19 08:35:17,092] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:35:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:35:26,424] [INFO] [<frozen importlib] - Optimal threshold: 0.4579
[2025-11-19 08:35:26,424] [INFO] [<frozen importlib] - Best f1: 0.2756
[2025-11-19 08:35:26,424] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:35:26,477] [INFO] [<frozen importlib] - Validation Results (threshold=0.4579):
[2025-11-19 08:35:26,477] [INFO] [<frozen importlib] -   Accuracy: 0.8924
[2025-11-19 08:35:26,477] [INFO] [<frozen importlib] -   Precision: 0.2854
[2025-11-19 08:35:26,477] [INFO] [<frozen importlib] -   Recall: 0.2665
[2025-11-19 08:35:26,477] [INFO] [<frozen importlib] -   F1 Score: 0.2756
[2025-11-19 08:35:26,477] [INFO] [<frozen importlib] -   AUROC: 0.7097
[2025-11-19 08:35:26,477] [INFO] [<frozen importlib] -   AUPRC: 0.2243
[2025-11-19 08:35:26,477] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:35:26,477] [INFO] [<frozen importlib] -     TN=16476, FP=969
[2025-11-19 08:35:26,477] [INFO] [<frozen importlib] -     FN=1065, TP=387
[2025-11-19 08:35:26,499] [INFO] [<frozen importlib] - Trial 91: AUPRC=0.2243, F1=0.4516, Prec=0.4215, Rec=0.4862 | Optimizing auprc=0.2243
[2025-11-19 08:35:26,500] [INFO] [<frozen importlib] - Trial 91 pruned.
[2025-11-19 08:35:26,500] [ERROR] [<frozen importlib] - Trial 91 failed with error: 
                                                                                        Best trial: 88. Best value: 0.236742:  18%|█▊        | 91/500 [13:24<1:08:37, 10.07s/it]Best trial: 88. Best value: 0.236742:  18%|█▊        | 91/500 [13:24<1:08:37, 10.07s/it]Best trial: 88. Best value: 0.236742:  18%|█▊        | 92/500 [13:24<1:07:41,  9.95s/it][2025-11-19 08:35:26,508] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.5780869878800905
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   gamma: 0.19149486161780027
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   alpha: 0.6710279213836977
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   lambda: 1.1126684305635504
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   learning_rate: 0.04840527198249487
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   subsample: 0.829077634660711
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   colsample_bytree: 0.5504955864364334
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5500864726927196
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   colsample_bynode: 0.7953335882062094
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:35:26,508] [INFO] [<frozen importlib] -   scale_pos_weight: 5.5780869878800905
[2025-11-19 08:35:26,576] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:35:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:35:26,500] Trial 91 pruned. 
[0]	train-logloss:0.61935	train-auc:0.64192	train-aucpr:0.23918	val-logloss:0.60361	val-auc:0.62865	val-aucpr:0.13563
[10]	train-logloss:0.59415	train-auc:0.67952	train-aucpr:0.29036	val-logloss:0.53771	val-auc:0.69008	val-aucpr:0.20746
[20]	train-logloss:0.57961	train-auc:0.69030	train-aucpr:0.30297	val-logloss:0.49534	val-auc:0.70694	val-aucpr:0.22128
[30]	train-logloss:0.57042	train-auc:0.69738	train-aucpr:0.30933	val-logloss:0.47815	val-auc:0.71156	val-aucpr:0.22226
[40]	train-logloss:0.56417	train-auc:0.70135	train-aucpr:0.31496	val-logloss:0.47655	val-auc:0.71010	val-aucpr:0.22555
[50]	train-logloss:0.55914	train-auc:0.70737	train-aucpr:0.32027	val-logloss:0.47451	val-auc:0.70539	val-aucpr:0.21975
[60]	train-logloss:0.55553	train-auc:0.71275	train-aucpr:0.32487	val-logloss:0.47230	val-auc:0.70244	val-aucpr:0.21283
[70]	train-logloss:0.55252	train-auc:0.71624	train-aucpr:0.32973	val-logloss:0.47072	val-auc:0.69837	val-aucpr:0.21273
[71]	train-logloss:0.55241	train-auc:0.71655	train-aucpr:0.33012	val-logloss:0.47064	val-auc:0.69825	val-aucpr:0.21343
[2025-11-19 08:35:26,795] [INFO] [<frozen importlib] - Training completed at iteration 42
[2025-11-19 08:35:26,795] [INFO] [<frozen importlib] - Best train loss: 0.5627
[2025-11-19 08:35:26,795] [INFO] [<frozen importlib] - Best val loss: 0.4730
[2025-11-19 08:35:26,795] [INFO] [<frozen importlib] - Best val AUC: 0.7106
[2025-11-19 08:35:26,795] [INFO] [<frozen importlib] - Best val AUCPR: 0.2278
[2025-11-19 08:35:26,800] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:35:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:35:37,345] [INFO] [<frozen importlib] - Optimal threshold: 0.4591
[2025-11-19 08:35:37,345] [INFO] [<frozen importlib] - Best f1: 0.2747
[2025-11-19 08:35:37,345] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:35:37,387] [INFO] [<frozen importlib] - Validation Results (threshold=0.4591):
[2025-11-19 08:35:37,388] [INFO] [<frozen importlib] -   Accuracy: 0.9031
[2025-11-19 08:35:37,388] [INFO] [<frozen importlib] -   Precision: 0.3231
[2025-11-19 08:35:37,388] [INFO] [<frozen importlib] -   Recall: 0.2390
[2025-11-19 08:35:37,388] [INFO] [<frozen importlib] -   F1 Score: 0.2747
[2025-11-19 08:35:37,388] [INFO] [<frozen importlib] -   AUROC: 0.7106
[2025-11-19 08:35:37,388] [INFO] [<frozen importlib] -   AUPRC: 0.2284
[2025-11-19 08:35:37,388] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:35:37,388] [INFO] [<frozen importlib] -     TN=16718, FP=727
[2025-11-19 08:35:37,388] [INFO] [<frozen importlib] -     FN=1105, TP=347
[2025-11-19 08:35:37,411] [INFO] [<frozen importlib] - Trial 92: AUPRC=0.2284, F1=0.4546, Prec=0.4686, Rec=0.4415 | Optimizing auprc=0.2284
                                                                                        Best trial: 88. Best value: 0.236742:  18%|█▊        | 92/500 [13:35<1:07:41,  9.95s/it]Best trial: 88. Best value: 0.236742:  18%|█▊        | 92/500 [13:35<1:07:41,  9.95s/it]Best trial: 88. Best value: 0.236742:  19%|█▊        | 93/500 [13:35<1:09:28, 10.24s/it][2025-11-19 08:35:37,420] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.54216766303749
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   gamma: 0.18078746229313186
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   alpha: 0.681027048115553
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   lambda: 1.1930023865719668
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   learning_rate: 0.03940319694474193
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   subsample: 0.853587841186895
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   colsample_bytree: 0.5494584748254145
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5792212475040641
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   colsample_bynode: 0.7989740764573495
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:35:37,420] [INFO] [<frozen importlib] -   scale_pos_weight: 5.54216766303749
[2025-11-19 08:35:37,496] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:35:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:35:37,412] Trial 92 finished with value: 0.2284458395731578 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.19149486161780027, 'learning_rate': 0.04840527198249487, 'n_estimators': 450, 'alpha': 0.6710279213836977, 'lambda': 1.1126684305635504, 'subsample': 0.829077634660711, 'colsample_bytree': 0.5504955864364334, 'colsample_bylevel': 0.5500864726927196, 'colsample_bynode': 0.7953335882062094, 'scale_pos_weight': 5.5780869878800905}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.61776	train-auc:0.64818	train-aucpr:0.24904	val-logloss:0.60325	val-auc:0.62566	val-aucpr:0.13622
[10]	train-logloss:0.59578	train-auc:0.67883	train-aucpr:0.29145	val-logloss:0.55580	val-auc:0.67423	val-aucpr:0.19652
[20]	train-logloss:0.58255	train-auc:0.68734	train-aucpr:0.29967	val-logloss:0.52472	val-auc:0.66667	val-aucpr:0.19813
[30]	train-logloss:0.57366	train-auc:0.69143	train-aucpr:0.30546	val-logloss:0.49556	val-auc:0.66875	val-aucpr:0.19618
[40]	train-logloss:0.56722	train-auc:0.69655	train-aucpr:0.30983	val-logloss:0.47747	val-auc:0.68869	val-aucpr:0.21281
[50]	train-logloss:0.56227	train-auc:0.70047	train-aucpr:0.31428	val-logloss:0.47109	val-auc:0.69851	val-aucpr:0.21659
[60]	train-logloss:0.55840	train-auc:0.70587	train-aucpr:0.31869	val-logloss:0.46288	val-auc:0.69582	val-aucpr:0.21390
[70]	train-logloss:0.55531	train-auc:0.71033	train-aucpr:0.32248	val-logloss:0.46553	val-auc:0.68726	val-aucpr:0.20180
[80]	train-logloss:0.55290	train-auc:0.71346	train-aucpr:0.32600	val-logloss:0.44936	val-auc:0.69133	val-aucpr:0.21014
[83]	train-logloss:0.55219	train-auc:0.71422	train-aucpr:0.32657	val-logloss:0.44840	val-auc:0.69139	val-aucpr:0.21020
[2025-11-19 08:35:37,739] [INFO] [<frozen importlib] - Training completed at iteration 54
[2025-11-19 08:35:37,739] [INFO] [<frozen importlib] - Best train loss: 0.5608
[2025-11-19 08:35:37,739] [INFO] [<frozen importlib] - Best val loss: 0.4654
[2025-11-19 08:35:37,739] [INFO] [<frozen importlib] - Best val AUC: 0.6989
[2025-11-19 08:35:37,739] [INFO] [<frozen importlib] - Best val AUCPR: 0.2189
[2025-11-19 08:35:37,743] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:35:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:35:49,610] [INFO] [<frozen importlib] - Optimal threshold: 0.4275
[2025-11-19 08:35:49,610] [INFO] [<frozen importlib] - Best f1: 0.2637
[2025-11-19 08:35:49,610] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:35:49,663] [INFO] [<frozen importlib] - Validation Results (threshold=0.4275):
[2025-11-19 08:35:49,664] [INFO] [<frozen importlib] -   Accuracy: 0.8759
[2025-11-19 08:35:49,664] [INFO] [<frozen importlib] -   Precision: 0.2424
[2025-11-19 08:35:49,664] [INFO] [<frozen importlib] -   Recall: 0.2893
[2025-11-19 08:35:49,664] [INFO] [<frozen importlib] -   F1 Score: 0.2637
[2025-11-19 08:35:49,664] [INFO] [<frozen importlib] -   AUROC: 0.6989
[2025-11-19 08:35:49,664] [INFO] [<frozen importlib] -   AUPRC: 0.2193
[2025-11-19 08:35:49,664] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:35:49,664] [INFO] [<frozen importlib] -     TN=16132, FP=1313
[2025-11-19 08:35:49,664] [INFO] [<frozen importlib] -     FN=1032, TP=420
[2025-11-19 08:35:49,689] [INFO] [<frozen importlib] - Trial 93: AUPRC=0.2193, F1=0.4263, Prec=0.3632, Rec=0.5158 | Optimizing auprc=0.2193
[2025-11-19 08:35:49,689] [INFO] [<frozen importlib] - Trial 93 pruned.
[2025-11-19 08:35:49,689] [ERROR] [<frozen importlib] - Trial 93 failed with error: 
                                                                                        Best trial: 88. Best value: 0.236742:  19%|█▊        | 93/500 [13:47<1:09:28, 10.24s/it]Best trial: 88. Best value: 0.236742:  19%|█▊        | 93/500 [13:47<1:09:28, 10.24s/it]Best trial: 88. Best value: 0.236742:  19%|█▉        | 94/500 [13:47<1:13:25, 10.85s/it][2025-11-19 08:35:49,697] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.475983586369802
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   gamma: 0.23089191286815036
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   alpha: 0.6395896058386444
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   lambda: 1.471719760416178
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   learning_rate: 0.04466200315515997
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   subsample: 0.8268580950792769
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   colsample_bytree: 0.8399016406400734
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   colsample_bylevel: 0.546404299736674
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   colsample_bynode: 0.769838108282445
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:35:49,697] [INFO] [<frozen importlib] -   scale_pos_weight: 5.475983586369802
[2025-11-19 08:35:49,777] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:35:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:35:49,689] Trial 93 pruned. 
[0]	train-logloss:0.61358	train-auc:0.64348	train-aucpr:0.24573	val-logloss:0.59739	val-auc:0.61970	val-aucpr:0.11147
[10]	train-logloss:0.58927	train-auc:0.67980	train-aucpr:0.28831	val-logloss:0.53674	val-auc:0.65823	val-aucpr:0.17475
[20]	train-logloss:0.57548	train-auc:0.69095	train-aucpr:0.30025	val-logloss:0.50514	val-auc:0.68263	val-aucpr:0.18472
[30]	train-logloss:0.56619	train-auc:0.69684	train-aucpr:0.30900	val-logloss:0.48202	val-auc:0.68743	val-aucpr:0.19578
[40]	train-logloss:0.56004	train-auc:0.70183	train-aucpr:0.31424	val-logloss:0.46592	val-auc:0.68778	val-aucpr:0.20481
[50]	train-logloss:0.55511	train-auc:0.70664	train-aucpr:0.31921	val-logloss:0.45365	val-auc:0.69752	val-aucpr:0.20896
[60]	train-logloss:0.55146	train-auc:0.71044	train-aucpr:0.32391	val-logloss:0.44767	val-auc:0.69785	val-aucpr:0.21395
[70]	train-logloss:0.54842	train-auc:0.71329	train-aucpr:0.32859	val-logloss:0.45413	val-auc:0.69691	val-aucpr:0.21268
[80]	train-logloss:0.54596	train-auc:0.71773	train-aucpr:0.33253	val-logloss:0.45275	val-auc:0.69665	val-aucpr:0.21360
[90]	train-logloss:0.54316	train-auc:0.72403	train-aucpr:0.33776	val-logloss:0.43444	val-auc:0.69787	val-aucpr:0.21433
[95]	train-logloss:0.54233	train-auc:0.72602	train-aucpr:0.33975	val-logloss:0.43519	val-auc:0.69574	val-aucpr:0.21233
[2025-11-19 08:35:50,050] [INFO] [<frozen importlib] - Training completed at iteration 65
[2025-11-19 08:35:50,050] [INFO] [<frozen importlib] - Best train loss: 0.5498
[2025-11-19 08:35:50,050] [INFO] [<frozen importlib] - Best val loss: 0.4542
[2025-11-19 08:35:50,050] [INFO] [<frozen importlib] - Best val AUC: 0.6983
[2025-11-19 08:35:50,050] [INFO] [<frozen importlib] - Best val AUCPR: 0.2170
[2025-11-19 08:35:50,056] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:35:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:36:03,179] [INFO] [<frozen importlib] - Optimal threshold: 0.4574
[2025-11-19 08:36:03,179] [INFO] [<frozen importlib] - Best f1: 0.2649
[2025-11-19 08:36:03,179] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:36:03,223] [INFO] [<frozen importlib] - Validation Results (threshold=0.4574):
[2025-11-19 08:36:03,223] [INFO] [<frozen importlib] -   Accuracy: 0.9007
[2025-11-19 08:36:03,223] [INFO] [<frozen importlib] -   Precision: 0.3073
[2025-11-19 08:36:03,223] [INFO] [<frozen importlib] -   Recall: 0.2328
[2025-11-19 08:36:03,223] [INFO] [<frozen importlib] -   F1 Score: 0.2649
[2025-11-19 08:36:03,223] [INFO] [<frozen importlib] -   AUROC: 0.6983
[2025-11-19 08:36:03,223] [INFO] [<frozen importlib] -   AUPRC: 0.2175
[2025-11-19 08:36:03,223] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:36:03,223] [INFO] [<frozen importlib] -     TN=16683, FP=762
[2025-11-19 08:36:03,223] [INFO] [<frozen importlib] -     FN=1114, TP=338
[2025-11-19 08:36:03,246] [INFO] [<frozen importlib] - Trial 94: AUPRC=0.2175, F1=0.4662, Prec=0.4690, Rec=0.4635 | Optimizing auprc=0.2175
                                                                                        Best trial: 88. Best value: 0.236742:  19%|█▉        | 94/500 [14:01<1:13:25, 10.85s/it]Best trial: 88. Best value: 0.236742:  19%|█▉        | 94/500 [14:01<1:13:25, 10.85s/it]Best trial: 88. Best value: 0.236742:  19%|█▉        | 95/500 [14:01<1:18:43, 11.66s/it][2025-11-19 08:36:03,256] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.44305836401233
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   gamma: 0.1919520733825369
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   alpha: 0.7287335054526209
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   lambda: 1.127471797970631
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   learning_rate: 0.05511975631036753
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   subsample: 0.8628110892875296
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   colsample_bytree: 0.5616576891605679
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5063104450360733
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   colsample_bynode: 0.7910568382050625
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:36:03,256] [INFO] [<frozen importlib] -   scale_pos_weight: 6.44305836401233
[2025-11-19 08:36:03,327] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:36:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:36:03,247] Trial 94 finished with value: 0.21748428840510797 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.23089191286815036, 'learning_rate': 0.04466200315515997, 'n_estimators': 450, 'alpha': 0.6395896058386444, 'lambda': 1.471719760416178, 'subsample': 0.8268580950792769, 'colsample_bytree': 0.8399016406400734, 'colsample_bylevel': 0.546404299736674, 'colsample_bynode': 0.769838108282445, 'scale_pos_weight': 5.475983586369802}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.66754	train-auc:0.63396	train-aucpr:0.23503	val-logloss:0.66213	val-auc:0.62526	val-aucpr:0.13128
[10]	train-logloss:0.63737	train-auc:0.68673	train-aucpr:0.29320	val-logloss:0.59219	val-auc:0.70376	val-aucpr:0.21761
[20]	train-logloss:0.62151	train-auc:0.69202	train-aucpr:0.30034	val-logloss:0.55781	val-auc:0.70338	val-aucpr:0.22003
[30]	train-logloss:0.61178	train-auc:0.69777	train-aucpr:0.30735	val-logloss:0.53239	val-auc:0.70386	val-aucpr:0.22630
[40]	train-logloss:0.60461	train-auc:0.70721	train-aucpr:0.31472	val-logloss:0.52597	val-auc:0.70403	val-aucpr:0.21793
[50]	train-logloss:0.59875	train-auc:0.71404	train-aucpr:0.32225	val-logloss:0.50652	val-auc:0.70055	val-aucpr:0.20915
[58]	train-logloss:0.59577	train-auc:0.71775	train-aucpr:0.32594	val-logloss:0.49152	val-auc:0.69998	val-aucpr:0.20951
[2025-11-19 08:36:03,526] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:36:03,526] [INFO] [<frozen importlib] - Best train loss: 0.6126
[2025-11-19 08:36:03,526] [INFO] [<frozen importlib] - Best val loss: 0.5224
[2025-11-19 08:36:03,526] [INFO] [<frozen importlib] - Best val AUC: 0.7042
[2025-11-19 08:36:03,526] [INFO] [<frozen importlib] - Best val AUCPR: 0.2267
[2025-11-19 08:36:03,532] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:36:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:36:12,131] [INFO] [<frozen importlib] - Optimal threshold: 0.4830
[2025-11-19 08:36:12,132] [INFO] [<frozen importlib] - Best f1: 0.2770
[2025-11-19 08:36:12,132] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:36:12,180] [INFO] [<frozen importlib] - Validation Results (threshold=0.4830):
[2025-11-19 08:36:12,180] [INFO] [<frozen importlib] -   Accuracy: 0.9022
[2025-11-19 08:36:12,180] [INFO] [<frozen importlib] -   Precision: 0.3207
[2025-11-19 08:36:12,180] [INFO] [<frozen importlib] -   Recall: 0.2438
[2025-11-19 08:36:12,180] [INFO] [<frozen importlib] -   F1 Score: 0.2770
[2025-11-19 08:36:12,180] [INFO] [<frozen importlib] -   AUROC: 0.7042
[2025-11-19 08:36:12,180] [INFO] [<frozen importlib] -   AUPRC: 0.2271
[2025-11-19 08:36:12,180] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:36:12,180] [INFO] [<frozen importlib] -     TN=16695, FP=750
[2025-11-19 08:36:12,180] [INFO] [<frozen importlib] -     FN=1098, TP=354
[2025-11-19 08:36:12,205] [INFO] [<frozen importlib] - Trial 95: AUPRC=0.2271, F1=0.4569, Prec=0.4650, Rec=0.4490 | Optimizing auprc=0.2271
                                                                                        Best trial: 88. Best value: 0.236742:  19%|█▉        | 95/500 [14:10<1:18:43, 11.66s/it]Best trial: 88. Best value: 0.236742:  19%|█▉        | 95/500 [14:10<1:18:43, 11.66s/it]Best trial: 88. Best value: 0.236742:  19%|█▉        | 96/500 [14:10<1:13:04, 10.85s/it][2025-11-19 08:36:12,214] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.087179384680402
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   gamma: 0.24827989880869017
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   alpha: 0.5972789489815209
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   lambda: 0.7546588784876449
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   learning_rate: 0.04044013941087155
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   subsample: 0.8118131562865085
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   colsample_bytree: 0.5191636802671118
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5160643827198933
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   colsample_bynode: 0.8182344737380403
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:36:12,214] [INFO] [<frozen importlib] -   scale_pos_weight: 7.087179384680402
[2025-11-19 08:36:12,288] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:36:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:36:12,205] Trial 95 finished with value: 0.22708823447662352 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.1919520733825369, 'learning_rate': 0.05511975631036753, 'n_estimators': 400, 'alpha': 0.7287335054526209, 'lambda': 1.127471797970631, 'subsample': 0.8628110892875296, 'colsample_bytree': 0.5616576891605679, 'colsample_bylevel': 0.5063104450360733, 'colsample_bynode': 0.7910568382050625, 'scale_pos_weight': 6.44305836401233}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.70352	train-auc:0.64072	train-aucpr:0.21609	val-logloss:0.70242	val-auc:0.65803	val-aucpr:0.12896
[10]	train-logloss:0.67724	train-auc:0.68274	train-aucpr:0.28900	val-logloss:0.64952	val-auc:0.68421	val-aucpr:0.20518
[20]	train-logloss:0.66152	train-auc:0.69066	train-aucpr:0.29723	val-logloss:0.59808	val-auc:0.71387	val-aucpr:0.21727
[30]	train-logloss:0.65091	train-auc:0.69376	train-aucpr:0.30402	val-logloss:0.55772	val-auc:0.71537	val-aucpr:0.22837
[40]	train-logloss:0.64345	train-auc:0.69885	train-aucpr:0.30977	val-logloss:0.54528	val-auc:0.71093	val-aucpr:0.22371
[50]	train-logloss:0.63723	train-auc:0.70300	train-aucpr:0.31475	val-logloss:0.52742	val-auc:0.70366	val-aucpr:0.21946
[60]	train-logloss:0.63290	train-auc:0.70651	train-aucpr:0.31881	val-logloss:0.51943	val-auc:0.70385	val-aucpr:0.22383
[63]	train-logloss:0.63201	train-auc:0.70751	train-aucpr:0.31981	val-logloss:0.52239	val-auc:0.69986	val-aucpr:0.21944
[2025-11-19 08:36:12,486] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:36:12,486] [INFO] [<frozen importlib] - Best train loss: 0.6479
[2025-11-19 08:36:12,486] [INFO] [<frozen importlib] - Best val loss: 0.5468
[2025-11-19 08:36:12,486] [INFO] [<frozen importlib] - Best val AUC: 0.7155
[2025-11-19 08:36:12,486] [INFO] [<frozen importlib] - Best val AUCPR: 0.2293
[2025-11-19 08:36:12,490] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:36:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:36:21,706] [INFO] [<frozen importlib] - Optimal threshold: 0.4863
[2025-11-19 08:36:21,706] [INFO] [<frozen importlib] - Best f1: 0.2736
[2025-11-19 08:36:21,706] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:36:21,752] [INFO] [<frozen importlib] - Validation Results (threshold=0.4863):
[2025-11-19 08:36:21,752] [INFO] [<frozen importlib] -   Accuracy: 0.8935
[2025-11-19 08:36:21,752] [INFO] [<frozen importlib] -   Precision: 0.2876
[2025-11-19 08:36:21,752] [INFO] [<frozen importlib] -   Recall: 0.2610
[2025-11-19 08:36:21,752] [INFO] [<frozen importlib] -   F1 Score: 0.2736
[2025-11-19 08:36:21,752] [INFO] [<frozen importlib] -   AUROC: 0.7155
[2025-11-19 08:36:21,752] [INFO] [<frozen importlib] -   AUPRC: 0.2297
[2025-11-19 08:36:21,752] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:36:21,752] [INFO] [<frozen importlib] -     TN=16506, FP=939
[2025-11-19 08:36:21,752] [INFO] [<frozen importlib] -     FN=1073, TP=379
[2025-11-19 08:36:21,774] [INFO] [<frozen importlib] - Trial 96: AUPRC=0.2297, F1=0.4509, Prec=0.4257, Rec=0.4793 | Optimizing auprc=0.2297
                                                                                        Best trial: 88. Best value: 0.236742:  19%|█▉        | 96/500 [14:19<1:13:04, 10.85s/it]Best trial: 88. Best value: 0.236742:  19%|█▉        | 96/500 [14:19<1:13:04, 10.85s/it]Best trial: 88. Best value: 0.236742:  19%|█▉        | 97/500 [14:19<1:10:18, 10.47s/it][2025-11-19 08:36:21,789] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.088445202301585
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   gamma: 0.2806440712427334
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   alpha: 0.4998981813845044
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   lambda: 0.890168205412508
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   learning_rate: 0.04086015525824585
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   subsample: 0.7939779176033191
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   colsample_bytree: 0.545753671780003
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5119046641926579
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   colsample_bynode: 0.8196169498678408
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:36:21,789] [INFO] [<frozen importlib] -   scale_pos_weight: 7.088445202301585
[2025-11-19 08:36:21,862] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:36:21] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:36:21,774] Trial 96 finished with value: 0.2296886806792656 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.24827989880869017, 'learning_rate': 0.04044013941087155, 'n_estimators': 450, 'alpha': 0.5972789489815209, 'lambda': 0.7546588784876449, 'subsample': 0.8118131562865085, 'colsample_bytree': 0.5191636802671118, 'colsample_bylevel': 0.5160643827198933, 'colsample_bynode': 0.8182344737380403, 'scale_pos_weight': 7.087179384680402}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.70293	train-auc:0.64827	train-aucpr:0.25209	val-logloss:0.69892	val-auc:0.61602	val-aucpr:0.13491
[10]	train-logloss:0.67629	train-auc:0.68124	train-aucpr:0.28697	val-logloss:0.64053	val-auc:0.69319	val-aucpr:0.20202
[20]	train-logloss:0.66074	train-auc:0.68734	train-aucpr:0.29900	val-logloss:0.59302	val-auc:0.70068	val-aucpr:0.21481
[30]	train-logloss:0.65014	train-auc:0.69364	train-aucpr:0.30701	val-logloss:0.55018	val-auc:0.70268	val-aucpr:0.22034
[40]	train-logloss:0.64291	train-auc:0.69814	train-aucpr:0.31149	val-logloss:0.53584	val-auc:0.69865	val-aucpr:0.22172
[50]	train-logloss:0.63686	train-auc:0.70336	train-aucpr:0.31494	val-logloss:0.52663	val-auc:0.70206	val-aucpr:0.22147
[60]	train-logloss:0.63251	train-auc:0.70774	train-aucpr:0.31904	val-logloss:0.52259	val-auc:0.70404	val-aucpr:0.22669
[70]	train-logloss:0.62864	train-auc:0.71221	train-aucpr:0.32440	val-logloss:0.53059	val-auc:0.69159	val-aucpr:0.21198
[80]	train-logloss:0.62530	train-auc:0.71582	train-aucpr:0.32848	val-logloss:0.52197	val-auc:0.69160	val-aucpr:0.21052
[90]	train-logloss:0.62242	train-auc:0.72026	train-aucpr:0.33236	val-logloss:0.49262	val-auc:0.68413	val-aucpr:0.20471
[2025-11-19 08:36:22,127] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:36:22,127] [INFO] [<frozen importlib] - Best train loss: 0.6325
[2025-11-19 08:36:22,127] [INFO] [<frozen importlib] - Best val loss: 0.5226
[2025-11-19 08:36:22,127] [INFO] [<frozen importlib] - Best val AUC: 0.7040
[2025-11-19 08:36:22,127] [INFO] [<frozen importlib] - Best val AUCPR: 0.2267
[2025-11-19 08:36:22,135] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:36:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:36:35,521] [INFO] [<frozen importlib] - Optimal threshold: 0.5117
[2025-11-19 08:36:35,521] [INFO] [<frozen importlib] - Best f1: 0.2742
[2025-11-19 08:36:35,521] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:36:35,567] [INFO] [<frozen importlib] - Validation Results (threshold=0.5117):
[2025-11-19 08:36:35,567] [INFO] [<frozen importlib] -   Accuracy: 0.9067
[2025-11-19 08:36:35,567] [INFO] [<frozen importlib] -   Precision: 0.3408
[2025-11-19 08:36:35,567] [INFO] [<frozen importlib] -   Recall: 0.2293
[2025-11-19 08:36:35,567] [INFO] [<frozen importlib] -   F1 Score: 0.2742
[2025-11-19 08:36:35,567] [INFO] [<frozen importlib] -   AUROC: 0.7040
[2025-11-19 08:36:35,568] [INFO] [<frozen importlib] -   AUPRC: 0.2270
[2025-11-19 08:36:35,568] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:36:35,568] [INFO] [<frozen importlib] -     TN=16801, FP=644
[2025-11-19 08:36:35,568] [INFO] [<frozen importlib] -     FN=1119, TP=333
[2025-11-19 08:36:35,596] [INFO] [<frozen importlib] - Trial 97: AUPRC=0.2270, F1=0.4583, Prec=0.4917, Rec=0.4291 | Optimizing auprc=0.2270
                                                                                        Best trial: 88. Best value: 0.236742:  19%|█▉        | 97/500 [14:33<1:10:18, 10.47s/it]Best trial: 88. Best value: 0.236742:  19%|█▉        | 97/500 [14:33<1:10:18, 10.47s/it]Best trial: 88. Best value: 0.236742:  20%|█▉        | 98/500 [14:33<1:16:52, 11.47s/it][2025-11-19 08:36:35,611] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.264130784824177
[2025-11-19 08:36:35,611] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:36:35,611] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:36:35,611] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:36:35,611] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:36:35,611] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:36:35,611] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:36:35,611] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:36:35,611] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:36:35,611] [INFO] [<frozen importlib] -   gamma: 0.24576281111034037
[2025-11-19 08:36:35,612] [INFO] [<frozen importlib] -   alpha: 0.5988839680374408
[2025-11-19 08:36:35,612] [INFO] [<frozen importlib] -   lambda: 3.079084613932039
[2025-11-19 08:36:35,612] [INFO] [<frozen importlib] -   learning_rate: 0.050743417012177244
[2025-11-19 08:36:35,612] [INFO] [<frozen importlib] -   subsample: 0.8152281672373516
[2025-11-19 08:36:35,612] [INFO] [<frozen importlib] -   colsample_bytree: 0.5264489705790781
[2025-11-19 08:36:35,612] [INFO] [<frozen importlib] -   colsample_bylevel: 0.53989831466484
[2025-11-19 08:36:35,612] [INFO] [<frozen importlib] -   colsample_bynode: 0.796761378967628
[2025-11-19 08:36:35,612] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:36:35,612] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:36:35,612] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:36:35,612] [INFO] [<frozen importlib] -   scale_pos_weight: 5.264130784824177
[2025-11-19 08:36:35,691] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:36:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:36:35,597] Trial 97 finished with value: 0.22704702886921874 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.2806440712427334, 'learning_rate': 0.04086015525824585, 'n_estimators': 400, 'alpha': 0.4998981813845044, 'lambda': 0.890168205412508, 'subsample': 0.7939779176033191, 'colsample_bytree': 0.545753671780003, 'colsample_bylevel': 0.5119046641926579, 'colsample_bynode': 0.8196169498678408, 'scale_pos_weight': 7.088445202301585}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.60167	train-auc:0.64259	train-aucpr:0.21823	val-logloss:0.58420	val-auc:0.68232	val-aucpr:0.15771
[10]	train-logloss:0.57613	train-auc:0.68245	train-aucpr:0.29095	val-logloss:0.54141	val-auc:0.71318	val-aucpr:0.21589
[20]	train-logloss:0.56185	train-auc:0.68962	train-aucpr:0.30462	val-logloss:0.49538	val-auc:0.71560	val-aucpr:0.21940
[30]	train-logloss:0.55330	train-auc:0.69482	train-aucpr:0.31121	val-logloss:0.46697	val-auc:0.71332	val-aucpr:0.22591
[40]	train-logloss:0.54752	train-auc:0.70145	train-aucpr:0.31675	val-logloss:0.45806	val-auc:0.70602	val-aucpr:0.22147
[50]	train-logloss:0.54269	train-auc:0.70848	train-aucpr:0.32243	val-logloss:0.45484	val-auc:0.69524	val-aucpr:0.20851
[59]	train-logloss:0.53939	train-auc:0.71256	train-aucpr:0.32755	val-logloss:0.44537	val-auc:0.69667	val-aucpr:0.20707
[2025-11-19 08:36:35,881] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:36:35,881] [INFO] [<frozen importlib] - Best train loss: 0.5540
[2025-11-19 08:36:35,881] [INFO] [<frozen importlib] - Best val loss: 0.4677
[2025-11-19 08:36:35,881] [INFO] [<frozen importlib] - Best val AUC: 0.7124
[2025-11-19 08:36:35,881] [INFO] [<frozen importlib] - Best val AUCPR: 0.2268
[2025-11-19 08:36:35,887] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:36:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:36:42,198] [INFO] [<frozen importlib] - Optimal threshold: 0.4290
[2025-11-19 08:36:42,198] [INFO] [<frozen importlib] - Best f1: 0.2825
[2025-11-19 08:36:42,198] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:36:42,241] [INFO] [<frozen importlib] - Validation Results (threshold=0.4290):
[2025-11-19 08:36:42,241] [INFO] [<frozen importlib] -   Accuracy: 0.8981
[2025-11-19 08:36:42,241] [INFO] [<frozen importlib] -   Precision: 0.3079
[2025-11-19 08:36:42,241] [INFO] [<frozen importlib] -   Recall: 0.2610
[2025-11-19 08:36:42,241] [INFO] [<frozen importlib] -   F1 Score: 0.2825
[2025-11-19 08:36:42,241] [INFO] [<frozen importlib] -   AUROC: 0.7124
[2025-11-19 08:36:42,241] [INFO] [<frozen importlib] -   AUPRC: 0.2271
[2025-11-19 08:36:42,241] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:36:42,241] [INFO] [<frozen importlib] -     TN=16593, FP=852
[2025-11-19 08:36:42,241] [INFO] [<frozen importlib] -     FN=1073, TP=379
[2025-11-19 08:36:42,263] [INFO] [<frozen importlib] - Trial 98: AUPRC=0.2271, F1=0.4401, Prec=0.4328, Rec=0.4477 | Optimizing auprc=0.2271
                                                                                        Best trial: 88. Best value: 0.236742:  20%|█▉        | 98/500 [14:40<1:16:52, 11.47s/it]Best trial: 88. Best value: 0.236742:  20%|█▉        | 98/500 [14:40<1:16:52, 11.47s/it]Best trial: 88. Best value: 0.236742:  20%|█▉        | 99/500 [14:40<1:07:02, 10.03s/it][2025-11-19 08:36:42,272] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.860353469129381
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   gamma: 0.21246540436419376
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   alpha: 0.543662248108913
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   lambda: 0.7629881554501214
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   learning_rate: 0.058980660262388546
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   subsample: 0.8347859947659897
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   colsample_bytree: 0.5880546690751025
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5179780702481993
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   colsample_bynode: 0.7638211724647086
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:36:42,272] [INFO] [<frozen importlib] -   scale_pos_weight: 5.860353469129381
[2025-11-19 08:36:42,342] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:36:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:36:42,264] Trial 98 finished with value: 0.22711954107140803 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.24576281111034037, 'learning_rate': 0.050743417012177244, 'n_estimators': 450, 'alpha': 0.5988839680374408, 'lambda': 3.079084613932039, 'subsample': 0.8152281672373516, 'colsample_bytree': 0.5264489705790781, 'colsample_bylevel': 0.53989831466484, 'colsample_bynode': 0.796761378967628, 'scale_pos_weight': 5.264130784824177}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.63510	train-auc:0.62938	train-aucpr:0.22362	val-logloss:0.62487	val-auc:0.61904	val-aucpr:0.12353
[10]	train-logloss:0.60491	train-auc:0.68215	train-aucpr:0.28978	val-logloss:0.55501	val-auc:0.69583	val-aucpr:0.18760
[20]	train-logloss:0.58957	train-auc:0.69220	train-aucpr:0.30617	val-logloss:0.51506	val-auc:0.70312	val-aucpr:0.21797
[30]	train-logloss:0.58052	train-auc:0.70000	train-aucpr:0.31247	val-logloss:0.48415	val-auc:0.70842	val-aucpr:0.23102
[40]	train-logloss:0.57405	train-auc:0.70814	train-aucpr:0.31802	val-logloss:0.46573	val-auc:0.70365	val-aucpr:0.22795
[50]	train-logloss:0.56919	train-auc:0.71251	train-aucpr:0.32505	val-logloss:0.45275	val-auc:0.70708	val-aucpr:0.22462
[60]	train-logloss:0.56547	train-auc:0.71852	train-aucpr:0.33122	val-logloss:0.44611	val-auc:0.70534	val-aucpr:0.22531
[2025-11-19 08:36:42,527] [INFO] [<frozen importlib] - Training completed at iteration 30
[2025-11-19 08:36:42,527] [INFO] [<frozen importlib] - Best train loss: 0.5805
[2025-11-19 08:36:42,527] [INFO] [<frozen importlib] - Best val loss: 0.4842
[2025-11-19 08:36:42,527] [INFO] [<frozen importlib] - Best val AUC: 0.7084
[2025-11-19 08:36:42,527] [INFO] [<frozen importlib] - Best val AUCPR: 0.2310
[2025-11-19 08:36:42,531] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:36:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:36:49,361] [INFO] [<frozen importlib] - Optimal threshold: 0.4536
[2025-11-19 08:36:49,361] [INFO] [<frozen importlib] - Best f1: 0.2627
[2025-11-19 08:36:49,361] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:36:49,412] [INFO] [<frozen importlib] - Validation Results (threshold=0.4536):
[2025-11-19 08:36:49,412] [INFO] [<frozen importlib] -   Accuracy: 0.8865
[2025-11-19 08:36:49,412] [INFO] [<frozen importlib] -   Precision: 0.2624
[2025-11-19 08:36:49,412] [INFO] [<frozen importlib] -   Recall: 0.2631
[2025-11-19 08:36:49,412] [INFO] [<frozen importlib] -   F1 Score: 0.2627
[2025-11-19 08:36:49,412] [INFO] [<frozen importlib] -   AUROC: 0.7084
[2025-11-19 08:36:49,412] [INFO] [<frozen importlib] -   AUPRC: 0.2312
[2025-11-19 08:36:49,412] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:36:49,412] [INFO] [<frozen importlib] -     TN=16371, FP=1074
[2025-11-19 08:36:49,412] [INFO] [<frozen importlib] -     FN=1070, TP=382
[2025-11-19 08:36:49,435] [INFO] [<frozen importlib] - Trial 99: AUPRC=0.2312, F1=0.4393, Prec=0.3983, Rec=0.4897 | Optimizing auprc=0.2312
                                                                                        Best trial: 88. Best value: 0.236742:  20%|█▉        | 99/500 [14:47<1:07:02, 10.03s/it]Best trial: 88. Best value: 0.236742:  20%|█▉        | 99/500 [14:47<1:07:02, 10.03s/it]Best trial: 88. Best value: 0.236742:  20%|██        | 100/500 [14:47<1:01:09,  9.17s/it][2025-11-19 08:36:49,444] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.777284245825742
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   gamma: 0.31781316368147605
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   alpha: 0.35279940156928385
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   lambda: 0.738758063435796
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   learning_rate: 0.06038301032679091
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   subsample: 0.8670384210412112
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   colsample_bytree: 0.5854754293315638
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5146013072340468
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   colsample_bynode: 0.7640673698374324
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:36:49,444] [INFO] [<frozen importlib] -   scale_pos_weight: 5.777284245825742
[2025-11-19 08:36:49,517] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:36:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:36:49,436] Trial 99 finished with value: 0.23118533312499412 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.21246540436419376, 'learning_rate': 0.058980660262388546, 'n_estimators': 500, 'alpha': 0.543662248108913, 'lambda': 0.7629881554501214, 'subsample': 0.8347859947659897, 'colsample_bytree': 0.5880546690751025, 'colsample_bylevel': 0.5179780702481993, 'colsample_bynode': 0.7638211724647086, 'scale_pos_weight': 5.860353469129381}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.63030	train-auc:0.62938	train-aucpr:0.22362	val-logloss:0.61932	val-auc:0.61902	val-aucpr:0.12353
[10]	train-logloss:0.59969	train-auc:0.68344	train-aucpr:0.29201	val-logloss:0.54868	val-auc:0.69926	val-aucpr:0.20997
[20]	train-logloss:0.58450	train-auc:0.69263	train-aucpr:0.30342	val-logloss:0.49882	val-auc:0.70389	val-aucpr:0.22438
[30]	train-logloss:0.57575	train-auc:0.69979	train-aucpr:0.30975	val-logloss:0.48254	val-auc:0.71139	val-aucpr:0.23250
[40]	train-logloss:0.56963	train-auc:0.70741	train-aucpr:0.31560	val-logloss:0.46715	val-auc:0.70819	val-aucpr:0.22744
[50]	train-logloss:0.56491	train-auc:0.71239	train-aucpr:0.32300	val-logloss:0.45789	val-auc:0.70502	val-aucpr:0.21975
[59]	train-logloss:0.56174	train-auc:0.71772	train-aucpr:0.32817	val-logloss:0.44400	val-auc:0.69544	val-aucpr:0.21540
[2025-11-19 08:36:49,704] [INFO] [<frozen importlib] - Training completed at iteration 30
[2025-11-19 08:36:49,704] [INFO] [<frozen importlib] - Best train loss: 0.5758
[2025-11-19 08:36:49,704] [INFO] [<frozen importlib] - Best val loss: 0.4825
[2025-11-19 08:36:49,704] [INFO] [<frozen importlib] - Best val AUC: 0.7114
[2025-11-19 08:36:49,704] [INFO] [<frozen importlib] - Best val AUCPR: 0.2325
[2025-11-19 08:36:49,709] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:36:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:36:56,855] [INFO] [<frozen importlib] - Optimal threshold: 0.4488
[2025-11-19 08:36:56,855] [INFO] [<frozen importlib] - Best f1: 0.2697
[2025-11-19 08:36:56,855] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:36:56,898] [INFO] [<frozen importlib] - Validation Results (threshold=0.4488):
[2025-11-19 08:36:56,898] [INFO] [<frozen importlib] -   Accuracy: 0.8879
[2025-11-19 08:36:56,898] [INFO] [<frozen importlib] -   Precision: 0.2700
[2025-11-19 08:36:56,898] [INFO] [<frozen importlib] -   Recall: 0.2693
[2025-11-19 08:36:56,898] [INFO] [<frozen importlib] -   F1 Score: 0.2697
[2025-11-19 08:36:56,898] [INFO] [<frozen importlib] -   AUROC: 0.7114
[2025-11-19 08:36:56,898] [INFO] [<frozen importlib] -   AUPRC: 0.2328
[2025-11-19 08:36:56,898] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:36:56,898] [INFO] [<frozen importlib] -     TN=16388, FP=1057
[2025-11-19 08:36:56,898] [INFO] [<frozen importlib] -     FN=1061, TP=391
[2025-11-19 08:36:56,921] [INFO] [<frozen importlib] - Trial 100: AUPRC=0.2328, F1=0.4431, Prec=0.4032, Rec=0.4917 | Optimizing auprc=0.2328
                                                                                         Best trial: 88. Best value: 0.236742:  20%|██        | 100/500 [14:54<1:01:09,  9.17s/it]Best trial: 88. Best value: 0.236742:  20%|██        | 100/500 [14:54<1:01:09,  9.17s/it]Best trial: 88. Best value: 0.236742:  20%|██        | 101/500 [14:54<57:38,  8.67s/it]  [2025-11-19 08:36:56,930] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.691400879773661
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   gamma: 0.3143972267081706
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   alpha: 0.3464290604665037
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   lambda: 0.670318978985042
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   learning_rate: 0.06601718573045103
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   subsample: 0.8793242126908073
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   colsample_bytree: 0.5911154206338567
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5192330855428691
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   colsample_bynode: 0.7705169132492345
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:36:56,930] [INFO] [<frozen importlib] -   scale_pos_weight: 6.691400879773661
[2025-11-19 08:36:57,004] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:36:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:36:56,922] Trial 100 finished with value: 0.23278122784532204 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.31781316368147605, 'learning_rate': 0.06038301032679091, 'n_estimators': 500, 'alpha': 0.35279940156928385, 'lambda': 0.738758063435796, 'subsample': 0.8670384210412112, 'colsample_bytree': 0.5854754293315638, 'colsample_bylevel': 0.5146013072340468, 'colsample_bynode': 0.7640673698374324, 'scale_pos_weight': 5.777284245825742}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.68054	train-auc:0.62940	train-aucpr:0.22362	val-logloss:0.67637	val-auc:0.61904	val-aucpr:0.12676
[10]	train-logloss:0.64488	train-auc:0.68409	train-aucpr:0.29317	val-logloss:0.59481	val-auc:0.66878	val-aucpr:0.18704
[20]	train-logloss:0.62795	train-auc:0.69490	train-aucpr:0.30702	val-logloss:0.54743	val-auc:0.69768	val-aucpr:0.21086
[30]	train-logloss:0.61846	train-auc:0.70183	train-aucpr:0.31354	val-logloss:0.51976	val-auc:0.70654	val-aucpr:0.21620
[40]	train-logloss:0.61210	train-auc:0.70929	train-aucpr:0.32031	val-logloss:0.51100	val-auc:0.70737	val-aucpr:0.22241
[50]	train-logloss:0.60629	train-auc:0.71685	train-aucpr:0.32843	val-logloss:0.49453	val-auc:0.70938	val-aucpr:0.22186
[60]	train-logloss:0.60225	train-auc:0.72318	train-aucpr:0.33541	val-logloss:0.48775	val-auc:0.70125	val-aucpr:0.20889
[70]	train-logloss:0.59825	train-auc:0.72979	train-aucpr:0.34058	val-logloss:0.48815	val-auc:0.68454	val-aucpr:0.19007
[76]	train-logloss:0.59639	train-auc:0.73201	train-aucpr:0.34436	val-logloss:0.48621	val-auc:0.68096	val-aucpr:0.19032
[2025-11-19 08:36:57,228] [INFO] [<frozen importlib] - Training completed at iteration 46
[2025-11-19 08:36:57,228] [INFO] [<frozen importlib] - Best train loss: 0.6083
[2025-11-19 08:36:57,228] [INFO] [<frozen importlib] - Best val loss: 0.4929
[2025-11-19 08:36:57,228] [INFO] [<frozen importlib] - Best val AUC: 0.7077
[2025-11-19 08:36:57,228] [INFO] [<frozen importlib] - Best val AUCPR: 0.2234
[2025-11-19 08:36:57,232] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:36:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:37:09,395] [INFO] [<frozen importlib] - Optimal threshold: 0.5019
[2025-11-19 08:37:09,395] [INFO] [<frozen importlib] - Best f1: 0.2698
[2025-11-19 08:37:09,395] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:37:09,439] [INFO] [<frozen importlib] - Validation Results (threshold=0.5019):
[2025-11-19 08:37:09,439] [INFO] [<frozen importlib] -   Accuracy: 0.8969
[2025-11-19 08:37:09,439] [INFO] [<frozen importlib] -   Precision: 0.2958
[2025-11-19 08:37:09,439] [INFO] [<frozen importlib] -   Recall: 0.2479
[2025-11-19 08:37:09,439] [INFO] [<frozen importlib] -   F1 Score: 0.2698
[2025-11-19 08:37:09,439] [INFO] [<frozen importlib] -   AUROC: 0.7077
[2025-11-19 08:37:09,439] [INFO] [<frozen importlib] -   AUPRC: 0.2238
[2025-11-19 08:37:09,439] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:37:09,439] [INFO] [<frozen importlib] -     TN=16588, FP=857
[2025-11-19 08:37:09,439] [INFO] [<frozen importlib] -     FN=1092, TP=360
[2025-11-19 08:37:09,459] [INFO] [<frozen importlib] - Trial 101: AUPRC=0.2238, F1=0.4514, Prec=0.4399, Rec=0.4635 | Optimizing auprc=0.2238
                                                                                       Best trial: 88. Best value: 0.236742:  20%|██        | 101/500 [15:07<57:38,  8.67s/it]Best trial: 88. Best value: 0.236742:  20%|██        | 101/500 [15:07<57:38,  8.67s/it]Best trial: 88. Best value: 0.236742:  20%|██        | 102/500 [15:07<1:05:11,  9.83s/it][2025-11-19 08:37:09,473] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.937368472381713
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   gamma: 0.35093795454473264
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   alpha: 0.3353930938956415
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   lambda: 0.31592160397603836
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   learning_rate: 0.058733867530578916
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   subsample: 0.8383534531852264
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   colsample_bytree: 0.5818837037976439
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5007251068558355
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   colsample_bynode: 0.7637852680175543
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:37:09,473] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:37:09,474] [INFO] [<frozen importlib] -   scale_pos_weight: 5.937368472381713
[2025-11-19 08:37:09,547] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:37:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:37:09,459] Trial 101 finished with value: 0.22378454997624292 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.3143972267081706, 'learning_rate': 0.06601718573045103, 'n_estimators': 500, 'alpha': 0.3464290604665037, 'lambda': 0.670318978985042, 'subsample': 0.8793242126908073, 'colsample_bytree': 0.5911154206338567, 'colsample_bylevel': 0.5192330855428691, 'colsample_bynode': 0.7705169132492345, 'scale_pos_weight': 6.691400879773661}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.63911	train-auc:0.64380	train-aucpr:0.23243	val-logloss:0.62892	val-auc:0.61356	val-aucpr:0.11880
[10]	train-logloss:0.60933	train-auc:0.68607	train-aucpr:0.29045	val-logloss:0.55939	val-auc:0.70694	val-aucpr:0.20426
[20]	train-logloss:0.59434	train-auc:0.69125	train-aucpr:0.30130	val-logloss:0.53275	val-auc:0.69593	val-aucpr:0.21574
[30]	train-logloss:0.58424	train-auc:0.69976	train-aucpr:0.31207	val-logloss:0.49540	val-auc:0.68661	val-aucpr:0.20790
[40]	train-logloss:0.57811	train-auc:0.70706	train-aucpr:0.31940	val-logloss:0.49544	val-auc:0.68625	val-aucpr:0.21188
[50]	train-logloss:0.57238	train-auc:0.71451	train-aucpr:0.32686	val-logloss:0.48765	val-auc:0.68620	val-aucpr:0.20681
[52]	train-logloss:0.57168	train-auc:0.71566	train-aucpr:0.32793	val-logloss:0.48725	val-auc:0.68530	val-aucpr:0.20648
[2025-11-19 08:37:09,716] [INFO] [<frozen importlib] - Training completed at iteration 23
[2025-11-19 08:37:09,716] [INFO] [<frozen importlib] - Best train loss: 0.5909
[2025-11-19 08:37:09,716] [INFO] [<frozen importlib] - Best val loss: 0.5189
[2025-11-19 08:37:09,716] [INFO] [<frozen importlib] - Best val AUC: 0.6987
[2025-11-19 08:37:09,716] [INFO] [<frozen importlib] - Best val AUCPR: 0.2194
[2025-11-19 08:37:09,720] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:37:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:37:15,555] [INFO] [<frozen importlib] - Optimal threshold: 0.4602
[2025-11-19 08:37:15,555] [INFO] [<frozen importlib] - Best f1: 0.2619
[2025-11-19 08:37:15,555] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:37:15,606] [INFO] [<frozen importlib] - Validation Results (threshold=0.4602):
[2025-11-19 08:37:15,606] [INFO] [<frozen importlib] -   Accuracy: 0.8861
[2025-11-19 08:37:15,606] [INFO] [<frozen importlib] -   Precision: 0.2608
[2025-11-19 08:37:15,606] [INFO] [<frozen importlib] -   Recall: 0.2631
[2025-11-19 08:37:15,606] [INFO] [<frozen importlib] -   F1 Score: 0.2619
[2025-11-19 08:37:15,606] [INFO] [<frozen importlib] -   AUROC: 0.6987
[2025-11-19 08:37:15,606] [INFO] [<frozen importlib] -   AUPRC: 0.2196
[2025-11-19 08:37:15,606] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:37:15,606] [INFO] [<frozen importlib] -     TN=16362, FP=1083
[2025-11-19 08:37:15,606] [INFO] [<frozen importlib] -     FN=1070, TP=382
[2025-11-19 08:37:15,629] [INFO] [<frozen importlib] - Trial 102: AUPRC=0.2196, F1=0.4457, Prec=0.4017, Rec=0.5007 | Optimizing auprc=0.2196
                                                                                         Best trial: 88. Best value: 0.236742:  20%|██        | 102/500 [15:13<1:05:11,  9.83s/it]Best trial: 88. Best value: 0.236742:  20%|██        | 102/500 [15:13<1:05:11,  9.83s/it]Best trial: 88. Best value: 0.236742:  21%|██        | 103/500 [15:13<57:46,  8.73s/it]  [2025-11-19 08:37:15,639] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.349156182262185
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   gamma: 0.26277005417009563
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   alpha: 0.5551203095986734
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   lambda: 0.8157958832536275
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   learning_rate: 0.04268010051664057
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   subsample: 0.8654144211344247
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   colsample_bytree: 0.61076052214445
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5567689575917245
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   colsample_bynode: 0.7821472167541829
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:37:15,639] [INFO] [<frozen importlib] -   scale_pos_weight: 6.349156182262185
[2025-11-19 08:37:15,707] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:37:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:37:15,630] Trial 102 finished with value: 0.21958129916265184 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.35093795454473264, 'learning_rate': 0.058733867530578916, 'n_estimators': 500, 'alpha': 0.3353930938956415, 'lambda': 0.31592160397603836, 'subsample': 0.8383534531852264, 'colsample_bytree': 0.5818837037976439, 'colsample_bylevel': 0.5007251068558355, 'colsample_bynode': 0.7637852680175543, 'scale_pos_weight': 5.937368472381713}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.66286	train-auc:0.65355	train-aucpr:0.23677	val-logloss:0.65489	val-auc:0.62336	val-aucpr:0.11853
[10]	train-logloss:0.63717	train-auc:0.68318	train-aucpr:0.29301	val-logloss:0.58941	val-auc:0.68980	val-aucpr:0.19573
[20]	train-logloss:0.62181	train-auc:0.69121	train-aucpr:0.30253	val-logloss:0.54780	val-auc:0.69768	val-aucpr:0.20692
[30]	train-logloss:0.61200	train-auc:0.69616	train-aucpr:0.30810	val-logloss:0.52334	val-auc:0.69993	val-aucpr:0.21501
[40]	train-logloss:0.60492	train-auc:0.70144	train-aucpr:0.31381	val-logloss:0.50611	val-auc:0.68741	val-aucpr:0.20117
[50]	train-logloss:0.59959	train-auc:0.70598	train-aucpr:0.31876	val-logloss:0.50474	val-auc:0.68144	val-aucpr:0.19490
[60]	train-logloss:0.59584	train-auc:0.70890	train-aucpr:0.32245	val-logloss:0.49654	val-auc:0.68508	val-aucpr:0.20104
[2025-11-19 08:37:15,903] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 08:37:15,903] [INFO] [<frozen importlib] - Best train loss: 0.6111
[2025-11-19 08:37:15,903] [INFO] [<frozen importlib] - Best val loss: 0.5206
[2025-11-19 08:37:15,903] [INFO] [<frozen importlib] - Best val AUC: 0.6990
[2025-11-19 08:37:15,903] [INFO] [<frozen importlib] - Best val AUCPR: 0.2153
[2025-11-19 08:37:15,907] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:37:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:37:22,161] [INFO] [<frozen importlib] - Optimal threshold: 0.4725
[2025-11-19 08:37:22,161] [INFO] [<frozen importlib] - Best f1: 0.2687
[2025-11-19 08:37:22,161] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:37:22,205] [INFO] [<frozen importlib] - Validation Results (threshold=0.4725):
[2025-11-19 08:37:22,205] [INFO] [<frozen importlib] -   Accuracy: 0.8928
[2025-11-19 08:37:22,205] [INFO] [<frozen importlib] -   Precision: 0.2825
[2025-11-19 08:37:22,205] [INFO] [<frozen importlib] -   Recall: 0.2562
[2025-11-19 08:37:22,205] [INFO] [<frozen importlib] -   F1 Score: 0.2687
[2025-11-19 08:37:22,205] [INFO] [<frozen importlib] -   AUROC: 0.6990
[2025-11-19 08:37:22,205] [INFO] [<frozen importlib] -   AUPRC: 0.2158
[2025-11-19 08:37:22,205] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:37:22,205] [INFO] [<frozen importlib] -     TN=16500, FP=945
[2025-11-19 08:37:22,205] [INFO] [<frozen importlib] -     FN=1080, TP=372
[2025-11-19 08:37:22,228] [INFO] [<frozen importlib] - Trial 103: AUPRC=0.2158, F1=0.4415, Prec=0.4181, Rec=0.4676 | Optimizing auprc=0.2158
                                                                                       Best trial: 88. Best value: 0.236742:  21%|██        | 103/500 [15:20<57:46,  8.73s/it]Best trial: 88. Best value: 0.236742:  21%|██        | 103/500 [15:20<57:46,  8.73s/it]Best trial: 88. Best value: 0.236742:  21%|██        | 104/500 [15:20<53:24,  8.09s/it][2025-11-19 08:37:22,237] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.992826977422212
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   gamma: 0.20571210606632637
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   alpha: 0.3909333994717299
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   lambda: 1.0662879427499652
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   learning_rate: 0.07065984122429435
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   subsample: 0.8895375381200599
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   colsample_bytree: 0.565238179899893
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5162977207024858
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   colsample_bynode: 0.7446934070831586
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:37:22,237] [INFO] [<frozen importlib] -   scale_pos_weight: 5.992826977422212
[2025-11-19 08:37:22,308] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:37:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:37:22,228] Trial 103 finished with value: 0.21579123771719208 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.26277005417009563, 'learning_rate': 0.04268010051664057, 'n_estimators': 500, 'alpha': 0.5551203095986734, 'lambda': 0.8157958832536275, 'subsample': 0.8654144211344247, 'colsample_bytree': 0.61076052214445, 'colsample_bylevel': 0.5567689575917245, 'colsample_bynode': 0.7821472167541829, 'scale_pos_weight': 6.349156182262185}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.64155	train-auc:0.63400	train-aucpr:0.22976	val-logloss:0.63241	val-auc:0.62302	val-aucpr:0.12032
[10]	train-logloss:0.60774	train-auc:0.68643	train-aucpr:0.29945	val-logloss:0.55106	val-auc:0.67737	val-aucpr:0.17858
[20]	train-logloss:0.59172	train-auc:0.69655	train-aucpr:0.30795	val-logloss:0.52428	val-auc:0.69403	val-aucpr:0.20360
[30]	train-logloss:0.58258	train-auc:0.70447	train-aucpr:0.31619	val-logloss:0.51850	val-auc:0.68800	val-aucpr:0.20433
[40]	train-logloss:0.57664	train-auc:0.71153	train-aucpr:0.32267	val-logloss:0.49786	val-auc:0.68885	val-aucpr:0.19923
[50]	train-logloss:0.57144	train-auc:0.71988	train-aucpr:0.33028	val-logloss:0.44299	val-auc:0.69964	val-aucpr:0.19613
[53]	train-logloss:0.57016	train-auc:0.72246	train-aucpr:0.33275	val-logloss:0.44196	val-auc:0.70163	val-aucpr:0.19774
[2025-11-19 08:37:22,479] [INFO] [<frozen importlib] - Training completed at iteration 24
[2025-11-19 08:37:22,479] [INFO] [<frozen importlib] - Best train loss: 0.5873
[2025-11-19 08:37:22,479] [INFO] [<frozen importlib] - Best val loss: 0.5066
[2025-11-19 08:37:22,479] [INFO] [<frozen importlib] - Best val AUC: 0.6967
[2025-11-19 08:37:22,479] [INFO] [<frozen importlib] - Best val AUCPR: 0.2105
[2025-11-19 08:37:22,483] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:37:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:37:30,660] [INFO] [<frozen importlib] - Optimal threshold: 0.4902
[2025-11-19 08:37:30,660] [INFO] [<frozen importlib] - Best f1: 0.2556
[2025-11-19 08:37:30,660] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:37:30,706] [INFO] [<frozen importlib] - Validation Results (threshold=0.4902):
[2025-11-19 08:37:30,706] [INFO] [<frozen importlib] -   Accuracy: 0.9078
[2025-11-19 08:37:30,706] [INFO] [<frozen importlib] -   Precision: 0.3367
[2025-11-19 08:37:30,706] [INFO] [<frozen importlib] -   Recall: 0.2059
[2025-11-19 08:37:30,706] [INFO] [<frozen importlib] -   F1 Score: 0.2556
[2025-11-19 08:37:30,706] [INFO] [<frozen importlib] -   AUROC: 0.6967
[2025-11-19 08:37:30,706] [INFO] [<frozen importlib] -   AUPRC: 0.2109
[2025-11-19 08:37:30,706] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:37:30,706] [INFO] [<frozen importlib] -     TN=16856, FP=589
[2025-11-19 08:37:30,706] [INFO] [<frozen importlib] -     FN=1153, TP=299
[2025-11-19 08:37:30,731] [INFO] [<frozen importlib] - Trial 104: AUPRC=0.2109, F1=0.4614, Prec=0.5096, Rec=0.4215 | Optimizing auprc=0.2109
                                                                                       Best trial: 88. Best value: 0.236742:  21%|██        | 104/500 [15:28<53:24,  8.09s/it]Best trial: 88. Best value: 0.236742:  21%|██        | 104/500 [15:28<53:24,  8.09s/it]Best trial: 88. Best value: 0.236742:  21%|██        | 105/500 [15:28<54:04,  8.21s/it][2025-11-19 08:37:30,740] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.10904318634565
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   gamma: 0.2928190669864268
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   alpha: 0.18812853987340283
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   lambda: 0.513953774055548
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   learning_rate: 0.061353864237755476
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   subsample: 0.8227500727329063
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   colsample_bytree: 0.7545265149293712
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5359142780146293
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   colsample_bynode: 0.8064912832654225
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:37:30,740] [INFO] [<frozen importlib] -   scale_pos_weight: 5.10904318634565
[2025-11-19 08:37:30,817] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:37:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:37:30,732] Trial 104 finished with value: 0.21092368714565687 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.20571210606632637, 'learning_rate': 0.07065984122429435, 'n_estimators': 500, 'alpha': 0.3909333994717299, 'lambda': 1.0662879427499652, 'subsample': 0.8895375381200599, 'colsample_bytree': 0.565238179899893, 'colsample_bylevel': 0.5162977207024858, 'colsample_bynode': 0.7446934070831586, 'scale_pos_weight': 5.992826977422212}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.59165	train-auc:0.64125	train-aucpr:0.24414	val-logloss:0.57035	val-auc:0.61328	val-aucpr:0.11909
[10]	train-logloss:0.56316	train-auc:0.68235	train-aucpr:0.29390	val-logloss:0.51860	val-auc:0.69880	val-aucpr:0.17551
[20]	train-logloss:0.54878	train-auc:0.69268	train-aucpr:0.30716	val-logloss:0.47113	val-auc:0.69365	val-aucpr:0.20565
[30]	train-logloss:0.54025	train-auc:0.70137	train-aucpr:0.31589	val-logloss:0.44900	val-auc:0.70701	val-aucpr:0.22144
[40]	train-logloss:0.53461	train-auc:0.70837	train-aucpr:0.32206	val-logloss:0.44644	val-auc:0.70617	val-aucpr:0.21624
[50]	train-logloss:0.52963	train-auc:0.71525	train-aucpr:0.32890	val-logloss:0.43787	val-auc:0.70783	val-aucpr:0.22003
[60]	train-logloss:0.52614	train-auc:0.72021	train-aucpr:0.33569	val-logloss:0.42786	val-auc:0.70252	val-aucpr:0.21630
[61]	train-logloss:0.52582	train-auc:0.72119	train-aucpr:0.33649	val-logloss:0.42817	val-auc:0.70225	val-aucpr:0.21534
[2025-11-19 08:37:31,011] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 08:37:31,011] [INFO] [<frozen importlib] - Best train loss: 0.5391
[2025-11-19 08:37:31,011] [INFO] [<frozen importlib] - Best val loss: 0.4445
[2025-11-19 08:37:31,011] [INFO] [<frozen importlib] - Best val AUC: 0.7076
[2025-11-19 08:37:31,011] [INFO] [<frozen importlib] - Best val AUCPR: 0.2216
[2025-11-19 08:37:31,017] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:37:31] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:37:37,650] [INFO] [<frozen importlib] - Optimal threshold: 0.4229
[2025-11-19 08:37:37,651] [INFO] [<frozen importlib] - Best f1: 0.2770
[2025-11-19 08:37:37,651] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:37:37,692] [INFO] [<frozen importlib] - Validation Results (threshold=0.4229):
[2025-11-19 08:37:37,692] [INFO] [<frozen importlib] -   Accuracy: 0.8986
[2025-11-19 08:37:37,692] [INFO] [<frozen importlib] -   Precision: 0.3063
[2025-11-19 08:37:37,692] [INFO] [<frozen importlib] -   Recall: 0.2528
[2025-11-19 08:37:37,692] [INFO] [<frozen importlib] -   F1 Score: 0.2770
[2025-11-19 08:37:37,692] [INFO] [<frozen importlib] -   AUROC: 0.7076
[2025-11-19 08:37:37,692] [INFO] [<frozen importlib] -   AUPRC: 0.2219
[2025-11-19 08:37:37,692] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:37:37,692] [INFO] [<frozen importlib] -     TN=16614, FP=831
[2025-11-19 08:37:37,692] [INFO] [<frozen importlib] -     FN=1085, TP=367
[2025-11-19 08:37:37,716] [INFO] [<frozen importlib] - Trial 105: AUPRC=0.2219, F1=0.4282, Prec=0.4281, Rec=0.4284 | Optimizing auprc=0.2219
[2025-11-19 08:37:37,716] [INFO] [<frozen importlib] - Trial 105 pruned.
[2025-11-19 08:37:37,717] [ERROR] [<frozen importlib] - Trial 105 failed with error: 
                                                                                       Best trial: 88. Best value: 0.236742:  21%|██        | 105/500 [15:35<54:04,  8.21s/it]Best trial: 88. Best value: 0.236742:  21%|██        | 105/500 [15:35<54:04,  8.21s/it]Best trial: 88. Best value: 0.236742:  21%|██        | 106/500 [15:35<51:31,  7.85s/it][2025-11-19 08:37:37,732] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.695824710713101
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   gamma: 0.39795874083166316
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   alpha: 0.4942221980452347
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   lambda: 0.8075263762058438
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   learning_rate: 0.06559826378802318
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   subsample: 0.8092970693265162
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   colsample_bytree: 0.9131634827031119
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5684471453529272
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   colsample_bynode: 0.7590899194715134
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:37:37,732] [INFO] [<frozen importlib] -   scale_pos_weight: 5.695824710713101
[2025-11-19 08:37:37,814] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:37:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:37:37,717] Trial 105 pruned. 
[0]	train-logloss:0.62434	train-auc:0.65086	train-aucpr:0.24467	val-logloss:0.60730	val-auc:0.64281	val-aucpr:0.12420
[10]	train-logloss:0.59224	train-auc:0.68372	train-aucpr:0.29677	val-logloss:0.52931	val-auc:0.67841	val-aucpr:0.19026
[20]	train-logloss:0.57722	train-auc:0.69553	train-aucpr:0.30701	val-logloss:0.51917	val-auc:0.68648	val-aucpr:0.20420
[30]	train-logloss:0.56818	train-auc:0.70230	train-aucpr:0.31558	val-logloss:0.50548	val-auc:0.68598	val-aucpr:0.19012
[40]	train-logloss:0.56284	train-auc:0.70781	train-aucpr:0.32178	val-logloss:0.48845	val-auc:0.68803	val-aucpr:0.19341
[49]	train-logloss:0.55846	train-auc:0.71247	train-aucpr:0.32771	val-logloss:0.47908	val-auc:0.68415	val-aucpr:0.19130
[2025-11-19 08:37:37,978] [INFO] [<frozen importlib] - Training completed at iteration 20
[2025-11-19 08:37:37,978] [INFO] [<frozen importlib] - Best train loss: 0.5772
[2025-11-19 08:37:37,978] [INFO] [<frozen importlib] - Best val loss: 0.5192
[2025-11-19 08:37:37,978] [INFO] [<frozen importlib] - Best val AUC: 0.6865
[2025-11-19 08:37:37,978] [INFO] [<frozen importlib] - Best val AUCPR: 0.2042
[2025-11-19 08:37:37,983] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:37:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:37:40,838] [INFO] [<frozen importlib] - Optimal threshold: 0.4614
[2025-11-19 08:37:40,838] [INFO] [<frozen importlib] - Best f1: 0.2678
[2025-11-19 08:37:40,838] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:37:40,883] [INFO] [<frozen importlib] - Validation Results (threshold=0.4614):
[2025-11-19 08:37:40,883] [INFO] [<frozen importlib] -   Accuracy: 0.8906
[2025-11-19 08:37:40,883] [INFO] [<frozen importlib] -   Precision: 0.2757
[2025-11-19 08:37:40,884] [INFO] [<frozen importlib] -   Recall: 0.2603
[2025-11-19 08:37:40,884] [INFO] [<frozen importlib] -   F1 Score: 0.2678
[2025-11-19 08:37:40,884] [INFO] [<frozen importlib] -   AUROC: 0.6865
[2025-11-19 08:37:40,884] [INFO] [<frozen importlib] -   AUPRC: 0.2037
[2025-11-19 08:37:40,884] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:37:40,884] [INFO] [<frozen importlib] -     TN=16452, FP=993
[2025-11-19 08:37:40,884] [INFO] [<frozen importlib] -     FN=1074, TP=378
[2025-11-19 08:37:40,912] [INFO] [<frozen importlib] - Trial 106: AUPRC=0.2037, F1=0.4540, Prec=0.4196, Rec=0.4945 | Optimizing auprc=0.2037
[2025-11-19 08:37:40,912] [INFO] [<frozen importlib] - Trial 106 pruned.
[2025-11-19 08:37:40,912] [ERROR] [<frozen importlib] - Trial 106 failed with error: 
                                                                                       Best trial: 88. Best value: 0.236742:  21%|██        | 106/500 [15:38<51:31,  7.85s/it]Best trial: 88. Best value: 0.236742:  21%|██        | 106/500 [15:38<51:31,  7.85s/it]Best trial: 88. Best value: 0.236742:  21%|██▏       | 107/500 [15:38<42:15,  6.45s/it][2025-11-19 08:37:40,927] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.355371479142647
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   gamma: 0.18051723822672866
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   alpha: 0.264403361140018
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   lambda: 0.9730741666340207
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   learning_rate: 0.052856363549444854
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   subsample: 0.8453960763095024
[2025-11-19 08:37:40,927] [INFO] [<frozen importlib] -   colsample_bytree: 0.5569521443707459
[2025-11-19 08:37:40,928] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5830641919678329
[2025-11-19 08:37:40,928] [INFO] [<frozen importlib] -   colsample_bynode: 0.728846146377894
[2025-11-19 08:37:40,928] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:37:40,928] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:37:40,928] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:37:40,928] [INFO] [<frozen importlib] -   scale_pos_weight: 7.355371479142647
[2025-11-19 08:37:41,003] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:37:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:37:40,912] Trial 106 pruned. 
[0]	train-logloss:0.71648	train-auc:0.64821	train-aucpr:0.22792	val-logloss:0.71385	val-auc:0.61216	val-aucpr:0.12149
[10]	train-logloss:0.68411	train-auc:0.68153	train-aucpr:0.28821	val-logloss:0.63014	val-auc:0.69631	val-aucpr:0.20628
[20]	train-logloss:0.66658	train-auc:0.69313	train-aucpr:0.30260	val-logloss:0.58788	val-auc:0.70409	val-aucpr:0.20875
[30]	train-logloss:0.65583	train-auc:0.70107	train-aucpr:0.31055	val-logloss:0.56057	val-auc:0.71326	val-aucpr:0.22176
[40]	train-logloss:0.64814	train-auc:0.70567	train-aucpr:0.31670	val-logloss:0.53977	val-auc:0.71593	val-aucpr:0.22514
[50]	train-logloss:0.64241	train-auc:0.71058	train-aucpr:0.32282	val-logloss:0.52138	val-auc:0.71567	val-aucpr:0.22232
[60]	train-logloss:0.63790	train-auc:0.71612	train-aucpr:0.32827	val-logloss:0.51729	val-auc:0.71442	val-aucpr:0.22229
[70]	train-logloss:0.63402	train-auc:0.72178	train-aucpr:0.33297	val-logloss:0.49172	val-auc:0.69806	val-aucpr:0.20002
[73]	train-logloss:0.63295	train-auc:0.72326	train-aucpr:0.33483	val-logloss:0.49791	val-auc:0.68794	val-aucpr:0.17972
[2025-11-19 08:37:41,224] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 08:37:41,224] [INFO] [<frozen importlib] - Best train loss: 0.6453
[2025-11-19 08:37:41,224] [INFO] [<frozen importlib] - Best val loss: 0.5358
[2025-11-19 08:37:41,224] [INFO] [<frozen importlib] - Best val AUC: 0.7179
[2025-11-19 08:37:41,224] [INFO] [<frozen importlib] - Best val AUCPR: 0.2260
[2025-11-19 08:37:41,231] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:37:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:37:53,574] [INFO] [<frozen importlib] - Optimal threshold: 0.5096
[2025-11-19 08:37:53,574] [INFO] [<frozen importlib] - Best f1: 0.2703
[2025-11-19 08:37:53,574] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:37:53,622] [INFO] [<frozen importlib] - Validation Results (threshold=0.5096):
[2025-11-19 08:37:53,622] [INFO] [<frozen importlib] -   Accuracy: 0.8923
[2025-11-19 08:37:53,622] [INFO] [<frozen importlib] -   Precision: 0.2818
[2025-11-19 08:37:53,622] [INFO] [<frozen importlib] -   Recall: 0.2596
[2025-11-19 08:37:53,622] [INFO] [<frozen importlib] -   F1 Score: 0.2703
[2025-11-19 08:37:53,622] [INFO] [<frozen importlib] -   AUROC: 0.7179
[2025-11-19 08:37:53,622] [INFO] [<frozen importlib] -   AUPRC: 0.2264
[2025-11-19 08:37:53,622] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:37:53,622] [INFO] [<frozen importlib] -     TN=16484, FP=961
[2025-11-19 08:37:53,622] [INFO] [<frozen importlib] -     FN=1075, TP=377
[2025-11-19 08:37:53,646] [INFO] [<frozen importlib] - Trial 107: AUPRC=0.2264, F1=0.4718, Prec=0.4367, Rec=0.5131 | Optimizing auprc=0.2264
                                                                                       Best trial: 88. Best value: 0.236742:  21%|██▏       | 107/500 [15:51<42:15,  6.45s/it]Best trial: 88. Best value: 0.236742:  21%|██▏       | 107/500 [15:51<42:15,  6.45s/it]Best trial: 88. Best value: 0.236742:  22%|██▏       | 108/500 [15:51<54:27,  8.34s/it][2025-11-19 08:37:53,657] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.712110538678357
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   gamma: 0.31987223313066626
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   alpha: 0.7783361863498841
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   lambda: 0.35154979723219715
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   learning_rate: 0.045190445158483986
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   subsample: 0.8304759391157912
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   colsample_bytree: 0.5407299869513575
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   colsample_bylevel: 0.599759177959616
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   colsample_bynode: 0.7908100430141862
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:37:53,657] [INFO] [<frozen importlib] -   scale_pos_weight: 6.712110538678357
[2025-11-19 08:37:53,735] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:37:53] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:37:53,646] Trial 107 finished with value: 0.22641557655234035 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.18051723822672866, 'learning_rate': 0.052856363549444854, 'n_estimators': 400, 'alpha': 0.264403361140018, 'lambda': 0.9730741666340207, 'subsample': 0.8453960763095024, 'colsample_bytree': 0.5569521443707459, 'colsample_bylevel': 0.5830641919678329, 'colsample_bynode': 0.728846146377894, 'scale_pos_weight': 7.355371479142647}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.68300	train-auc:0.63274	train-aucpr:0.23946	val-logloss:0.67856	val-auc:0.63391	val-aucpr:0.13798
[10]	train-logloss:0.65500	train-auc:0.68293	train-aucpr:0.29403	val-logloss:0.62108	val-auc:0.67139	val-aucpr:0.20092
[20]	train-logloss:0.63923	train-auc:0.69121	train-aucpr:0.30316	val-logloss:0.57810	val-auc:0.67694	val-aucpr:0.21013
[30]	train-logloss:0.62895	train-auc:0.69461	train-aucpr:0.30945	val-logloss:0.55087	val-auc:0.67871	val-aucpr:0.21635
[40]	train-logloss:0.62201	train-auc:0.69970	train-aucpr:0.31193	val-logloss:0.53555	val-auc:0.70337	val-aucpr:0.22878
[50]	train-logloss:0.61652	train-auc:0.70428	train-aucpr:0.31703	val-logloss:0.52747	val-auc:0.70125	val-aucpr:0.22191
[60]	train-logloss:0.61259	train-auc:0.70871	train-aucpr:0.32089	val-logloss:0.51256	val-auc:0.69845	val-aucpr:0.21900
[70]	train-logloss:0.60889	train-auc:0.71278	train-aucpr:0.32648	val-logloss:0.48524	val-auc:0.68728	val-aucpr:0.20973
[2025-11-19 08:37:53,942] [INFO] [<frozen importlib] - Training completed at iteration 40
[2025-11-19 08:37:53,942] [INFO] [<frozen importlib] - Best train loss: 0.6220
[2025-11-19 08:37:53,942] [INFO] [<frozen importlib] - Best val loss: 0.5356
[2025-11-19 08:37:53,942] [INFO] [<frozen importlib] - Best val AUC: 0.7034
[2025-11-19 08:37:53,942] [INFO] [<frozen importlib] - Best val AUCPR: 0.2288
[2025-11-19 08:37:53,948] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:37:53] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:38:03,605] [INFO] [<frozen importlib] - Optimal threshold: 0.4900
[2025-11-19 08:38:03,605] [INFO] [<frozen importlib] - Best f1: 0.2860
[2025-11-19 08:38:03,605] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:38:03,652] [INFO] [<frozen importlib] - Validation Results (threshold=0.4900):
[2025-11-19 08:38:03,652] [INFO] [<frozen importlib] -   Accuracy: 0.9007
[2025-11-19 08:38:03,652] [INFO] [<frozen importlib] -   Precision: 0.3195
[2025-11-19 08:38:03,652] [INFO] [<frozen importlib] -   Recall: 0.2590
[2025-11-19 08:38:03,652] [INFO] [<frozen importlib] -   F1 Score: 0.2860
[2025-11-19 08:38:03,652] [INFO] [<frozen importlib] -   AUROC: 0.7034
[2025-11-19 08:38:03,652] [INFO] [<frozen importlib] -   AUPRC: 0.2293
[2025-11-19 08:38:03,652] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:38:03,652] [INFO] [<frozen importlib] -     TN=16644, FP=801
[2025-11-19 08:38:03,652] [INFO] [<frozen importlib] -     FN=1076, TP=376
[2025-11-19 08:38:03,675] [INFO] [<frozen importlib] - Trial 108: AUPRC=0.2293, F1=0.4365, Prec=0.4399, Rec=0.4332 | Optimizing auprc=0.2293
                                                                                       Best trial: 88. Best value: 0.236742:  22%|██▏       | 108/500 [16:01<54:27,  8.34s/it]Best trial: 88. Best value: 0.236742:  22%|██▏       | 108/500 [16:01<54:27,  8.34s/it]Best trial: 88. Best value: 0.236742:  22%|██▏       | 109/500 [16:01<57:37,  8.84s/it][2025-11-19 08:38:03,684] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.766493223627394
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   gamma: 0.3167198836365196
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   alpha: 0.7713473386596033
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   lambda: 0.3521394592212925
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   learning_rate: 0.0382741810730435
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   subsample: 0.798715191396861
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   colsample_bytree: 0.5160226126889853
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   colsample_bylevel: 0.550524680845269
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   colsample_bynode: 0.7913609621811528
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:38:03,684] [INFO] [<frozen importlib] -   scale_pos_weight: 6.766493223627394
[2025-11-19 08:38:03,757] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:38:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:38:03,676] Trial 108 finished with value: 0.22927232188948632 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.31987223313066626, 'learning_rate': 0.045190445158483986, 'n_estimators': 500, 'alpha': 0.7783361863498841, 'lambda': 0.35154979723219715, 'subsample': 0.8304759391157912, 'colsample_bytree': 0.5407299869513575, 'colsample_bylevel': 0.599759177959616, 'colsample_bynode': 0.7908100430141862, 'scale_pos_weight': 6.712110538678357}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.68653	train-auc:0.63719	train-aucpr:0.22363	val-logloss:0.68476	val-auc:0.62461	val-aucpr:0.09886
[10]	train-logloss:0.66236	train-auc:0.68023	train-aucpr:0.28354	val-logloss:0.62226	val-auc:0.67973	val-aucpr:0.19525
[20]	train-logloss:0.64726	train-auc:0.68653	train-aucpr:0.29627	val-logloss:0.57701	val-auc:0.69254	val-aucpr:0.20750
[30]	train-logloss:0.63711	train-auc:0.69135	train-aucpr:0.30215	val-logloss:0.54911	val-auc:0.68095	val-aucpr:0.21295
[40]	train-logloss:0.62969	train-auc:0.69628	train-aucpr:0.30721	val-logloss:0.53234	val-auc:0.67791	val-aucpr:0.21082
[50]	train-logloss:0.62395	train-auc:0.70080	train-aucpr:0.31102	val-logloss:0.52079	val-auc:0.68984	val-aucpr:0.21727
[60]	train-logloss:0.62003	train-auc:0.70450	train-aucpr:0.31397	val-logloss:0.51311	val-auc:0.69316	val-aucpr:0.21751
[70]	train-logloss:0.61659	train-auc:0.70830	train-aucpr:0.31759	val-logloss:0.51512	val-auc:0.68713	val-aucpr:0.21577
[80]	train-logloss:0.61299	train-auc:0.71375	train-aucpr:0.32257	val-logloss:0.51407	val-auc:0.67953	val-aucpr:0.21314
[81]	train-logloss:0.61276	train-auc:0.71390	train-aucpr:0.32284	val-logloss:0.51319	val-auc:0.68064	val-aucpr:0.21315
[2025-11-19 08:38:03,997] [INFO] [<frozen importlib] - Training completed at iteration 52
[2025-11-19 08:38:03,997] [INFO] [<frozen importlib] - Best train loss: 0.6231
[2025-11-19 08:38:03,997] [INFO] [<frozen importlib] - Best val loss: 0.5187
[2025-11-19 08:38:03,997] [INFO] [<frozen importlib] - Best val AUC: 0.6907
[2025-11-19 08:38:03,997] [INFO] [<frozen importlib] - Best val AUCPR: 0.2179
[2025-11-19 08:38:04,002] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:38:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:38:17,338] [INFO] [<frozen importlib] - Optimal threshold: 0.4833
[2025-11-19 08:38:17,339] [INFO] [<frozen importlib] - Best f1: 0.2647
[2025-11-19 08:38:17,339] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:38:17,378] [INFO] [<frozen importlib] - Validation Results (threshold=0.4833):
[2025-11-19 08:38:17,378] [INFO] [<frozen importlib] -   Accuracy: 0.8921
[2025-11-19 08:38:17,378] [INFO] [<frozen importlib] -   Precision: 0.2778
[2025-11-19 08:38:17,378] [INFO] [<frozen importlib] -   Recall: 0.2528
[2025-11-19 08:38:17,378] [INFO] [<frozen importlib] -   F1 Score: 0.2647
[2025-11-19 08:38:17,378] [INFO] [<frozen importlib] -   AUROC: 0.6907
[2025-11-19 08:38:17,378] [INFO] [<frozen importlib] -   AUPRC: 0.2183
[2025-11-19 08:38:17,378] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:38:17,378] [INFO] [<frozen importlib] -     TN=16491, FP=954
[2025-11-19 08:38:17,378] [INFO] [<frozen importlib] -     FN=1085, TP=367
[2025-11-19 08:38:17,401] [INFO] [<frozen importlib] - Trial 109: AUPRC=0.2183, F1=0.4527, Prec=0.4246, Rec=0.4848 | Optimizing auprc=0.2183
[2025-11-19 08:38:17,402] [INFO] [<frozen importlib] - Trial 109 pruned.
[2025-11-19 08:38:17,402] [ERROR] [<frozen importlib] - Trial 109 failed with error: 
                                                                                       Best trial: 88. Best value: 0.236742:  22%|██▏       | 109/500 [16:15<57:37,  8.84s/it]Best trial: 88. Best value: 0.236742:  22%|██▏       | 109/500 [16:15<57:37,  8.84s/it]Best trial: 88. Best value: 0.236742:  22%|██▏       | 110/500 [16:15<1:07:00, 10.31s/it][2025-11-19 08:38:17,410] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.924331608405217
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   gamma: 0.33615610637462284
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   alpha: 0.6975862204852544
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   lambda: 0.6935925535347616
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   learning_rate: 0.04474939451594752
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   subsample: 0.8540699872206307
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   colsample_bytree: 0.5759922394871417
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5167568855630881
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   colsample_bynode: 0.8269833935655918
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:38:17,410] [INFO] [<frozen importlib] -   scale_pos_weight: 5.924331608405217
[2025-11-19 08:38:17,484] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:38:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:38:17,402] Trial 109 pruned. 
[0]	train-logloss:0.63929	train-auc:0.64246	train-aucpr:0.23491	val-logloss:0.62894	val-auc:0.61852	val-aucpr:0.13010
[10]	train-logloss:0.61427	train-auc:0.68209	train-aucpr:0.29314	val-logloss:0.56857	val-auc:0.69615	val-aucpr:0.19997
[20]	train-logloss:0.59947	train-auc:0.69101	train-aucpr:0.30130	val-logloss:0.52733	val-auc:0.69957	val-aucpr:0.21405
[30]	train-logloss:0.58975	train-auc:0.69674	train-aucpr:0.30916	val-logloss:0.50096	val-auc:0.70415	val-aucpr:0.22246
[40]	train-logloss:0.58332	train-auc:0.70174	train-aucpr:0.31347	val-logloss:0.49114	val-auc:0.70448	val-aucpr:0.22111
[50]	train-logloss:0.57808	train-auc:0.70634	train-aucpr:0.31808	val-logloss:0.48656	val-auc:0.70228	val-aucpr:0.22158
[60]	train-logloss:0.57429	train-auc:0.71085	train-aucpr:0.32257	val-logloss:0.47788	val-auc:0.70311	val-aucpr:0.22218
[63]	train-logloss:0.57334	train-auc:0.71188	train-aucpr:0.32391	val-logloss:0.47674	val-auc:0.70300	val-aucpr:0.22297
[2025-11-19 08:38:17,682] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:38:17,682] [INFO] [<frozen importlib] - Best train loss: 0.5869
[2025-11-19 08:38:17,682] [INFO] [<frozen importlib] - Best val loss: 0.4979
[2025-11-19 08:38:17,682] [INFO] [<frozen importlib] - Best val AUC: 0.7055
[2025-11-19 08:38:17,682] [INFO] [<frozen importlib] - Best val AUCPR: 0.2255
[2025-11-19 08:38:17,687] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:38:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:38:27,075] [INFO] [<frozen importlib] - Optimal threshold: 0.4811
[2025-11-19 08:38:27,075] [INFO] [<frozen importlib] - Best f1: 0.2599
[2025-11-19 08:38:27,075] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:38:27,115] [INFO] [<frozen importlib] - Validation Results (threshold=0.4811):
[2025-11-19 08:38:27,115] [INFO] [<frozen importlib] -   Accuracy: 0.9084
[2025-11-19 08:38:27,115] [INFO] [<frozen importlib] -   Precision: 0.3427
[2025-11-19 08:38:27,115] [INFO] [<frozen importlib] -   Recall: 0.2094
[2025-11-19 08:38:27,115] [INFO] [<frozen importlib] -   F1 Score: 0.2599
[2025-11-19 08:38:27,115] [INFO] [<frozen importlib] -   AUROC: 0.7055
[2025-11-19 08:38:27,115] [INFO] [<frozen importlib] -   AUPRC: 0.2257
[2025-11-19 08:38:27,115] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:38:27,115] [INFO] [<frozen importlib] -     TN=16862, FP=583
[2025-11-19 08:38:27,115] [INFO] [<frozen importlib] -     FN=1148, TP=304
[2025-11-19 08:38:27,138] [INFO] [<frozen importlib] - Trial 110: AUPRC=0.2257, F1=0.4693, Prec=0.5170, Rec=0.4298 | Optimizing auprc=0.2257
[2025-11-19 08:38:27,138] [INFO] [<frozen importlib] - Trial 110 pruned.
[2025-11-19 08:38:27,139] [ERROR] [<frozen importlib] - Trial 110 failed with error: 
                                                                                         Best trial: 88. Best value: 0.236742:  22%|██▏       | 110/500 [16:25<1:07:00, 10.31s/it]Best trial: 88. Best value: 0.236742:  22%|██▏       | 110/500 [16:25<1:07:00, 10.31s/it]Best trial: 88. Best value: 0.236742:  22%|██▏       | 111/500 [16:25<1:05:43, 10.14s/it][2025-11-19 08:38:27,147] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.096743466902312
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   gamma: 0.24876919734354974
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   alpha: 0.6171789020726527
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   lambda: 0.4965312058115391
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   learning_rate: 0.05637100335256273
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   subsample: 0.8258349805257754
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   colsample_bytree: 0.5396691659432615
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6072273457865202
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   colsample_bynode: 0.7791405636927873
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:38:27,147] [INFO] [<frozen importlib] -   scale_pos_weight: 7.096743466902312
[2025-11-19 08:38:27,225] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:38:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:38:27,139] Trial 110 pruned. 
[0]	train-logloss:0.70285	train-auc:0.63274	train-aucpr:0.23946	val-logloss:0.70014	val-auc:0.63391	val-aucpr:0.13798
[10]	train-logloss:0.66941	train-auc:0.68260	train-aucpr:0.29530	val-logloss:0.63163	val-auc:0.66696	val-aucpr:0.19768
[20]	train-logloss:0.65237	train-auc:0.69356	train-aucpr:0.30812	val-logloss:0.57477	val-auc:0.69212	val-aucpr:0.21856
[30]	train-logloss:0.64218	train-auc:0.69753	train-aucpr:0.31272	val-logloss:0.53744	val-auc:0.69552	val-aucpr:0.22684
[40]	train-logloss:0.63473	train-auc:0.70650	train-aucpr:0.31901	val-logloss:0.53865	val-auc:0.70574	val-aucpr:0.22300
[50]	train-logloss:0.62912	train-auc:0.71144	train-aucpr:0.32556	val-logloss:0.52619	val-auc:0.70660	val-aucpr:0.22383
[59]	train-logloss:0.62528	train-auc:0.71693	train-aucpr:0.32948	val-logloss:0.51840	val-auc:0.70206	val-aucpr:0.22419
[2025-11-19 08:38:27,414] [INFO] [<frozen importlib] - Training completed at iteration 30
[2025-11-19 08:38:27,414] [INFO] [<frozen importlib] - Best train loss: 0.6422
[2025-11-19 08:38:27,414] [INFO] [<frozen importlib] - Best val loss: 0.5374
[2025-11-19 08:38:27,414] [INFO] [<frozen importlib] - Best val AUC: 0.6955
[2025-11-19 08:38:27,414] [INFO] [<frozen importlib] - Best val AUCPR: 0.2268
[2025-11-19 08:38:27,420] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:38:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:38:33,806] [INFO] [<frozen importlib] - Optimal threshold: 0.4857
[2025-11-19 08:38:33,806] [INFO] [<frozen importlib] - Best f1: 0.2879
[2025-11-19 08:38:33,806] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:38:33,850] [INFO] [<frozen importlib] - Validation Results (threshold=0.4857):
[2025-11-19 08:38:33,850] [INFO] [<frozen importlib] -   Accuracy: 0.8971
[2025-11-19 08:38:33,850] [INFO] [<frozen importlib] -   Precision: 0.3075
[2025-11-19 08:38:33,850] [INFO] [<frozen importlib] -   Recall: 0.2707
[2025-11-19 08:38:33,850] [INFO] [<frozen importlib] -   F1 Score: 0.2879
[2025-11-19 08:38:33,850] [INFO] [<frozen importlib] -   AUROC: 0.6955
[2025-11-19 08:38:33,850] [INFO] [<frozen importlib] -   AUPRC: 0.2272
[2025-11-19 08:38:33,850] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:38:33,850] [INFO] [<frozen importlib] -     TN=16560, FP=885
[2025-11-19 08:38:33,850] [INFO] [<frozen importlib] -     FN=1059, TP=393
[2025-11-19 08:38:33,875] [INFO] [<frozen importlib] - Trial 111: AUPRC=0.2272, F1=0.4446, Prec=0.4301, Rec=0.4601 | Optimizing auprc=0.2272
                                                                                         Best trial: 88. Best value: 0.236742:  22%|██▏       | 111/500 [16:31<1:05:43, 10.14s/it]Best trial: 88. Best value: 0.236742:  22%|██▏       | 111/500 [16:31<1:05:43, 10.14s/it]Best trial: 88. Best value: 0.236742:  22%|██▏       | 112/500 [16:31<58:57,  9.12s/it]  [2025-11-19 08:38:33,885] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.003381137107857
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   gamma: 0.1506510370198747
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   alpha: 0.7984689880243155
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   lambda: 0.5920957470355233
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   learning_rate: 0.049337389784241674
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   subsample: 0.834136367944904
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   colsample_bytree: 0.5321149189136438
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5390550709412703
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   colsample_bynode: 0.812194328231906
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:38:33,885] [INFO] [<frozen importlib] -   scale_pos_weight: 8.003381137107857
[2025-11-19 08:38:33,958] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:38:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:38:33,876] Trial 111 finished with value: 0.2272358371691757 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.24876919734354974, 'learning_rate': 0.05637100335256273, 'n_estimators': 450, 'alpha': 0.6171789020726527, 'lambda': 0.4965312058115391, 'subsample': 0.8258349805257754, 'colsample_bytree': 0.5396691659432615, 'colsample_bylevel': 0.6072273457865202, 'colsample_bynode': 0.7791405636927873, 'scale_pos_weight': 7.096743466902312}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.75072	train-auc:0.63232	train-aucpr:0.22549	val-logloss:0.75403	val-auc:0.64840	val-aucpr:0.14089
[10]	train-logloss:0.71719	train-auc:0.68283	train-aucpr:0.29126	val-logloss:0.68528	val-auc:0.68859	val-aucpr:0.19812
[20]	train-logloss:0.69906	train-auc:0.69069	train-aucpr:0.30350	val-logloss:0.63257	val-auc:0.70292	val-aucpr:0.21302
[30]	train-logloss:0.68787	train-auc:0.69563	train-aucpr:0.30986	val-logloss:0.58579	val-auc:0.71069	val-aucpr:0.21980
[40]	train-logloss:0.68017	train-auc:0.70300	train-aucpr:0.31550	val-logloss:0.56251	val-auc:0.70272	val-aucpr:0.21245
[50]	train-logloss:0.67355	train-auc:0.70948	train-aucpr:0.32144	val-logloss:0.55591	val-auc:0.70017	val-aucpr:0.20547
[60]	train-logloss:0.66888	train-auc:0.71432	train-aucpr:0.32730	val-logloss:0.54282	val-auc:0.70109	val-aucpr:0.20762
[62]	train-logloss:0.66817	train-auc:0.71513	train-aucpr:0.32790	val-logloss:0.53767	val-auc:0.70025	val-aucpr:0.20601
[2025-11-19 08:38:34,149] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 08:38:34,149] [INFO] [<frozen importlib] - Best train loss: 0.6858
[2025-11-19 08:38:34,149] [INFO] [<frozen importlib] - Best val loss: 0.5784
[2025-11-19 08:38:34,149] [INFO] [<frozen importlib] - Best val AUC: 0.7115
[2025-11-19 08:38:34,149] [INFO] [<frozen importlib] - Best val AUCPR: 0.2208
[2025-11-19 08:38:34,153] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:38:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:38:42,975] [INFO] [<frozen importlib] - Optimal threshold: 0.5165
[2025-11-19 08:38:42,976] [INFO] [<frozen importlib] - Best f1: 0.2752
[2025-11-19 08:38:42,976] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:38:43,018] [INFO] [<frozen importlib] - Validation Results (threshold=0.5165):
[2025-11-19 08:38:43,018] [INFO] [<frozen importlib] -   Accuracy: 0.8863
[2025-11-19 08:38:43,018] [INFO] [<frozen importlib] -   Precision: 0.2697
[2025-11-19 08:38:43,018] [INFO] [<frozen importlib] -   Recall: 0.2810
[2025-11-19 08:38:43,018] [INFO] [<frozen importlib] -   F1 Score: 0.2752
[2025-11-19 08:38:43,018] [INFO] [<frozen importlib] -   AUROC: 0.7115
[2025-11-19 08:38:43,018] [INFO] [<frozen importlib] -   AUPRC: 0.2214
[2025-11-19 08:38:43,018] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:38:43,018] [INFO] [<frozen importlib] -     TN=16340, FP=1105
[2025-11-19 08:38:43,018] [INFO] [<frozen importlib] -     FN=1044, TP=408
[2025-11-19 08:38:43,043] [INFO] [<frozen importlib] - Trial 112: AUPRC=0.2214, F1=0.4351, Prec=0.3915, Rec=0.4897 | Optimizing auprc=0.2214
[2025-11-19 08:38:43,043] [INFO] [<frozen importlib] - Trial 112 pruned.
[2025-11-19 08:38:43,043] [ERROR] [<frozen importlib] - Trial 112 failed with error: 
                                                                                       Best trial: 88. Best value: 0.236742:  22%|██▏       | 112/500 [16:41<58:57,  9.12s/it]Best trial: 88. Best value: 0.236742:  22%|██▏       | 112/500 [16:41<58:57,  9.12s/it]Best trial: 88. Best value: 0.236742:  23%|██▎       | 113/500 [16:41<58:54,  9.13s/it][2025-11-19 08:38:43,052] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.7254570476972955
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   gamma: 0.4341723642850662
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   alpha: 0.5810930564756686
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   lambda: 1.3299432039464585
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   learning_rate: 0.04035526940855391
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   subsample: 0.8137404398043816
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   colsample_bytree: 0.5469961787926977
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6002111758480192
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   colsample_bynode: 0.8000562697647838
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:38:43,052] [INFO] [<frozen importlib] -   scale_pos_weight: 7.7254570476972955
[2025-11-19 08:38:43,123] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:38:43] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:38:43,044] Trial 112 pruned. 
[0]	train-logloss:0.73664	train-auc:0.64799	train-aucpr:0.24463	val-logloss:0.73697	val-auc:0.62031	val-aucpr:0.11223
[10]	train-logloss:0.70824	train-auc:0.67748	train-aucpr:0.28920	val-logloss:0.66712	val-auc:0.67430	val-aucpr:0.19261
[20]	train-logloss:0.69183	train-auc:0.68589	train-aucpr:0.29965	val-logloss:0.62821	val-auc:0.69798	val-aucpr:0.21238
[30]	train-logloss:0.68059	train-auc:0.69365	train-aucpr:0.30658	val-logloss:0.58591	val-auc:0.69665	val-aucpr:0.22012
[40]	train-logloss:0.67283	train-auc:0.69887	train-aucpr:0.31152	val-logloss:0.56136	val-auc:0.69859	val-aucpr:0.22087
[50]	train-logloss:0.66625	train-auc:0.70375	train-aucpr:0.31711	val-logloss:0.56366	val-auc:0.69795	val-aucpr:0.21945
[60]	train-logloss:0.66167	train-auc:0.70742	train-aucpr:0.32074	val-logloss:0.55234	val-auc:0.70446	val-aucpr:0.22234
[70]	train-logloss:0.65821	train-auc:0.71111	train-aucpr:0.32430	val-logloss:0.55430	val-auc:0.69838	val-aucpr:0.21633
[80]	train-logloss:0.65500	train-auc:0.71417	train-aucpr:0.32780	val-logloss:0.54928	val-auc:0.69953	val-aucpr:0.21892
[90]	train-logloss:0.65198	train-auc:0.71868	train-aucpr:0.33153	val-logloss:0.53631	val-auc:0.69693	val-aucpr:0.22052
[92]	train-logloss:0.65141	train-auc:0.71957	train-aucpr:0.33246	val-logloss:0.53334	val-auc:0.69779	val-aucpr:0.21815
[2025-11-19 08:38:43,385] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 08:38:43,385] [INFO] [<frozen importlib] - Best train loss: 0.6609
[2025-11-19 08:38:43,385] [INFO] [<frozen importlib] - Best val loss: 0.5547
[2025-11-19 08:38:43,385] [INFO] [<frozen importlib] - Best val AUC: 0.7050
[2025-11-19 08:38:43,385] [INFO] [<frozen importlib] - Best val AUCPR: 0.2235
[2025-11-19 08:38:43,389] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:38:43] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:38:56,265] [INFO] [<frozen importlib] - Optimal threshold: 0.5436
[2025-11-19 08:38:56,265] [INFO] [<frozen importlib] - Best f1: 0.2615
[2025-11-19 08:38:56,265] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:38:56,308] [INFO] [<frozen importlib] - Validation Results (threshold=0.5436):
[2025-11-19 08:38:56,309] [INFO] [<frozen importlib] -   Accuracy: 0.8999
[2025-11-19 08:38:56,309] [INFO] [<frozen importlib] -   Precision: 0.3018
[2025-11-19 08:38:56,309] [INFO] [<frozen importlib] -   Recall: 0.2307
[2025-11-19 08:38:56,309] [INFO] [<frozen importlib] -   F1 Score: 0.2615
[2025-11-19 08:38:56,309] [INFO] [<frozen importlib] -   AUROC: 0.7050
[2025-11-19 08:38:56,309] [INFO] [<frozen importlib] -   AUPRC: 0.2238
[2025-11-19 08:38:56,309] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:38:56,309] [INFO] [<frozen importlib] -     TN=16670, FP=775
[2025-11-19 08:38:56,309] [INFO] [<frozen importlib] -     FN=1117, TP=335
[2025-11-19 08:38:56,332] [INFO] [<frozen importlib] - Trial 113: AUPRC=0.2238, F1=0.4333, Prec=0.4428, Rec=0.4242 | Optimizing auprc=0.2238
                                                                                       Best trial: 88. Best value: 0.236742:  23%|██▎       | 113/500 [16:54<58:54,  9.13s/it]Best trial: 88. Best value: 0.236742:  23%|██▎       | 113/500 [16:54<58:54,  9.13s/it]Best trial: 88. Best value: 0.236742:  23%|██▎       | 114/500 [16:54<1:06:46, 10.38s/it][2025-11-19 08:38:56,340] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.36605658970947
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   gamma: 0.22421152260636268
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   alpha: 0.40034145051186143
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   lambda: 0.19535138976258906
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   learning_rate: 0.045770001249783594
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   subsample: 0.7828746827876905
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   colsample_bytree: 0.5648915356518922
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5744037311007228
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   colsample_bynode: 0.7471170826652428
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:38:56,340] [INFO] [<frozen importlib] -   scale_pos_weight: 5.36605658970947
[2025-11-19 08:38:56,414] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:38:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:38:56,332] Trial 113 finished with value: 0.2238453993708292 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.4341723642850662, 'learning_rate': 0.04035526940855391, 'n_estimators': 450, 'alpha': 0.5810930564756686, 'lambda': 1.3299432039464585, 'subsample': 0.8137404398043816, 'colsample_bytree': 0.5469961787926977, 'colsample_bylevel': 0.6002111758480192, 'colsample_bynode': 0.8000562697647838, 'scale_pos_weight': 7.7254570476972955}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.60746	train-auc:0.64036	train-aucpr:0.23144	val-logloss:0.59186	val-auc:0.62928	val-aucpr:0.12806
[10]	train-logloss:0.58431	train-auc:0.68124	train-aucpr:0.29187	val-logloss:0.54689	val-auc:0.67116	val-aucpr:0.19292
[20]	train-logloss:0.57039	train-auc:0.69134	train-aucpr:0.30080	val-logloss:0.50853	val-auc:0.68169	val-aucpr:0.20721
[30]	train-logloss:0.56103	train-auc:0.69820	train-aucpr:0.30874	val-logloss:0.48258	val-auc:0.69077	val-aucpr:0.21635
[40]	train-logloss:0.55461	train-auc:0.70281	train-aucpr:0.31400	val-logloss:0.46896	val-auc:0.68989	val-aucpr:0.21598
[50]	train-logloss:0.54948	train-auc:0.70843	train-aucpr:0.31925	val-logloss:0.45069	val-auc:0.69744	val-aucpr:0.21758
[60]	train-logloss:0.54572	train-auc:0.71298	train-aucpr:0.32440	val-logloss:0.44947	val-auc:0.69558	val-aucpr:0.21677
[70]	train-logloss:0.54276	train-auc:0.71629	train-aucpr:0.32915	val-logloss:0.44838	val-auc:0.68752	val-aucpr:0.19949
[80]	train-logloss:0.54013	train-auc:0.72019	train-aucpr:0.33305	val-logloss:0.43900	val-auc:0.68446	val-aucpr:0.19724
[85]	train-logloss:0.53907	train-auc:0.72166	train-aucpr:0.33514	val-logloss:0.43090	val-auc:0.69098	val-aucpr:0.20011
[2025-11-19 08:38:56,665] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 08:38:56,665] [INFO] [<frozen importlib] - Best train loss: 0.5473
[2025-11-19 08:38:56,665] [INFO] [<frozen importlib] - Best val loss: 0.4475
[2025-11-19 08:38:56,665] [INFO] [<frozen importlib] - Best val AUC: 0.7013
[2025-11-19 08:38:56,665] [INFO] [<frozen importlib] - Best val AUCPR: 0.2198
[2025-11-19 08:38:56,670] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:38:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:39:09,896] [INFO] [<frozen importlib] - Optimal threshold: 0.4245
[2025-11-19 08:39:09,896] [INFO] [<frozen importlib] - Best f1: 0.2697
[2025-11-19 08:39:09,896] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:39:09,939] [INFO] [<frozen importlib] - Validation Results (threshold=0.4245):
[2025-11-19 08:39:09,939] [INFO] [<frozen importlib] -   Accuracy: 0.8880
[2025-11-19 08:39:09,939] [INFO] [<frozen importlib] -   Precision: 0.2702
[2025-11-19 08:39:09,939] [INFO] [<frozen importlib] -   Recall: 0.2693
[2025-11-19 08:39:09,939] [INFO] [<frozen importlib] -   F1 Score: 0.2697
[2025-11-19 08:39:09,939] [INFO] [<frozen importlib] -   AUROC: 0.7013
[2025-11-19 08:39:09,939] [INFO] [<frozen importlib] -   AUPRC: 0.2202
[2025-11-19 08:39:09,939] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:39:09,939] [INFO] [<frozen importlib] -     TN=16389, FP=1056
[2025-11-19 08:39:09,939] [INFO] [<frozen importlib] -     FN=1061, TP=391
[2025-11-19 08:39:09,962] [INFO] [<frozen importlib] - Trial 114: AUPRC=0.2202, F1=0.4408, Prec=0.4017, Rec=0.4883 | Optimizing auprc=0.2202
[2025-11-19 08:39:09,963] [INFO] [<frozen importlib] - Trial 114 pruned.
[2025-11-19 08:39:09,963] [ERROR] [<frozen importlib] - Trial 114 failed with error: 
                                                                                         Best trial: 88. Best value: 0.236742:  23%|██▎       | 114/500 [17:07<1:06:46, 10.38s/it]Best trial: 88. Best value: 0.236742:  23%|██▎       | 114/500 [17:07<1:06:46, 10.38s/it]Best trial: 88. Best value: 0.236742:  23%|██▎       | 115/500 [17:07<1:12:51, 11.35s/it][2025-11-19 08:39:09,971] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.223156671601517
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   gamma: 0.2890235522484124
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   alpha: 0.7551419030158634
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   lambda: 0.833638378234041
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   learning_rate: 0.18680909207295213
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   subsample: 0.7516630890236589
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   colsample_bytree: 0.5943815117288995
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6225096984754274
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   colsample_bynode: 0.8442752566029584
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:39:09,971] [INFO] [<frozen importlib] -   scale_pos_weight: 6.223156671601517
[2025-11-19 08:39:10,046] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:39:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:39:09,963] Trial 114 pruned. 
[0]	train-logloss:0.64601	train-auc:0.63121	train-aucpr:0.23455	val-logloss:0.61575	val-auc:0.61263	val-aucpr:0.13945
[10]	train-logloss:0.59448	train-auc:0.70168	train-aucpr:0.30826	val-logloss:0.50042	val-auc:0.68217	val-aucpr:0.19753
[20]	train-logloss:0.58138	train-auc:0.72073	train-aucpr:0.32848	val-logloss:0.48144	val-auc:0.64323	val-aucpr:0.13667
[30]	train-logloss:0.57101	train-auc:0.73771	train-aucpr:0.34744	val-logloss:0.43701	val-auc:0.64639	val-aucpr:0.13691
[35]	train-logloss:0.56761	train-auc:0.74259	train-aucpr:0.35429	val-logloss:0.43240	val-auc:0.64653	val-aucpr:0.13704
[2025-11-19 08:39:10,184] [INFO] [<frozen importlib] - Training completed at iteration 6
[2025-11-19 08:39:10,184] [INFO] [<frozen importlib] - Best train loss: 0.6069
[2025-11-19 08:39:10,184] [INFO] [<frozen importlib] - Best val loss: 0.5077
[2025-11-19 08:39:10,184] [INFO] [<frozen importlib] - Best val AUC: 0.6898
[2025-11-19 08:39:10,184] [INFO] [<frozen importlib] - Best val AUCPR: 0.2131
[2025-11-19 08:39:10,189] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:39:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:39:10,941] [INFO] [<frozen importlib] - Optimal threshold: 0.4642
[2025-11-19 08:39:10,941] [INFO] [<frozen importlib] - Best f1: 0.2761
[2025-11-19 08:39:10,941] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:39:10,984] [INFO] [<frozen importlib] - Validation Results (threshold=0.4642):
[2025-11-19 08:39:10,984] [INFO] [<frozen importlib] -   Accuracy: 0.9029
[2025-11-19 08:39:10,984] [INFO] [<frozen importlib] -   Precision: 0.3232
[2025-11-19 08:39:10,984] [INFO] [<frozen importlib] -   Recall: 0.2410
[2025-11-19 08:39:10,984] [INFO] [<frozen importlib] -   F1 Score: 0.2761
[2025-11-19 08:39:10,984] [INFO] [<frozen importlib] -   AUROC: 0.6898
[2025-11-19 08:39:10,984] [INFO] [<frozen importlib] -   AUPRC: 0.2091
[2025-11-19 08:39:10,984] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:39:10,984] [INFO] [<frozen importlib] -     TN=16712, FP=733
[2025-11-19 08:39:10,984] [INFO] [<frozen importlib] -     FN=1102, TP=350
[2025-11-19 08:39:11,010] [INFO] [<frozen importlib] - Trial 115: AUPRC=0.2091, F1=0.4471, Prec=0.4618, Rec=0.4332 | Optimizing auprc=0.2091
                                                                                         Best trial: 88. Best value: 0.236742:  23%|██▎       | 115/500 [17:08<1:12:51, 11.35s/it]Best trial: 88. Best value: 0.236742:  23%|██▎       | 115/500 [17:08<1:12:51, 11.35s/it]Best trial: 88. Best value: 0.236742:  23%|██▎       | 116/500 [17:08<52:52,  8.26s/it]  [2025-11-19 08:39:11,019] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.742043041007408
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   gamma: 0.26618369362665967
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   alpha: 0.6624184234690194
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   lambda: 2.4367521921012427
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   learning_rate: 0.059259087502410344
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   subsample: 0.8665041219841026
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   colsample_bytree: 0.5240034461485615
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5888249849999825
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   colsample_bynode: 0.7684875091802096
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:39:11,019] [INFO] [<frozen importlib] -   scale_pos_weight: 5.742043041007408
[2025-11-19 08:39:11,090] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:39:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:39:11,011] Trial 115 finished with value: 0.20912281624308113 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.2890235522484124, 'learning_rate': 0.18680909207295213, 'n_estimators': 400, 'alpha': 0.7551419030158634, 'lambda': 0.833638378234041, 'subsample': 0.7516630890236589, 'colsample_bytree': 0.5943815117288995, 'colsample_bylevel': 0.6225096984754274, 'colsample_bynode': 0.8442752566029584, 'scale_pos_weight': 6.223156671601517}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.62804	train-auc:0.63918	train-aucpr:0.24174	val-logloss:0.61567	val-auc:0.64168	val-aucpr:0.13780
[10]	train-logloss:0.59858	train-auc:0.68624	train-aucpr:0.29551	val-logloss:0.54429	val-auc:0.67280	val-aucpr:0.18917
[20]	train-logloss:0.58325	train-auc:0.69570	train-aucpr:0.30673	val-logloss:0.50803	val-auc:0.71518	val-aucpr:0.22452
[30]	train-logloss:0.57425	train-auc:0.70082	train-aucpr:0.31370	val-logloss:0.48947	val-auc:0.72240	val-aucpr:0.23150
[40]	train-logloss:0.56795	train-auc:0.70594	train-aucpr:0.31992	val-logloss:0.46970	val-auc:0.71885	val-aucpr:0.23166
[50]	train-logloss:0.56333	train-auc:0.71160	train-aucpr:0.32628	val-logloss:0.45889	val-auc:0.71824	val-aucpr:0.23034
[60]	train-logloss:0.55921	train-auc:0.71830	train-aucpr:0.33351	val-logloss:0.46612	val-auc:0.70886	val-aucpr:0.22737
[70]	train-logloss:0.55609	train-auc:0.72415	train-aucpr:0.33894	val-logloss:0.43374	val-auc:0.70650	val-aucpr:0.22141
[74]	train-logloss:0.55507	train-auc:0.72601	train-aucpr:0.34130	val-logloss:0.43054	val-auc:0.70586	val-aucpr:0.22217
[2025-11-19 08:39:11,312] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 08:39:11,312] [INFO] [<frozen importlib] - Best train loss: 0.5660
[2025-11-19 08:39:11,312] [INFO] [<frozen importlib] - Best val loss: 0.4665
[2025-11-19 08:39:11,312] [INFO] [<frozen importlib] - Best val AUC: 0.7200
[2025-11-19 08:39:11,312] [INFO] [<frozen importlib] - Best val AUCPR: 0.2342
[2025-11-19 08:39:11,319] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:39:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:39:24,045] [INFO] [<frozen importlib] - Optimal threshold: 0.4701
[2025-11-19 08:39:24,045] [INFO] [<frozen importlib] - Best f1: 0.2864
[2025-11-19 08:39:24,045] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:39:24,092] [INFO] [<frozen importlib] - Validation Results (threshold=0.4701):
[2025-11-19 08:39:24,093] [INFO] [<frozen importlib] -   Accuracy: 0.9117
[2025-11-19 08:39:24,093] [INFO] [<frozen importlib] -   Precision: 0.3777
[2025-11-19 08:39:24,093] [INFO] [<frozen importlib] -   Recall: 0.2307
[2025-11-19 08:39:24,093] [INFO] [<frozen importlib] -   F1 Score: 0.2864
[2025-11-19 08:39:24,093] [INFO] [<frozen importlib] -   AUROC: 0.7200
[2025-11-19 08:39:24,093] [INFO] [<frozen importlib] -   AUPRC: 0.2347
[2025-11-19 08:39:24,093] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:39:24,093] [INFO] [<frozen importlib] -     TN=16893, FP=552
[2025-11-19 08:39:24,093] [INFO] [<frozen importlib] -     FN=1117, TP=335
[2025-11-19 08:39:24,171] [INFO] [<frozen importlib] - Trial 116: AUPRC=0.2347, F1=0.4591, Prec=0.5196, Rec=0.4112 | Optimizing auprc=0.2347
                                                                                       Best trial: 88. Best value: 0.236742:  23%|██▎       | 116/500 [17:22<52:52,  8.26s/it]Best trial: 88. Best value: 0.236742:  23%|██▎       | 116/500 [17:22<52:52,  8.26s/it]Best trial: 88. Best value: 0.236742:  23%|██▎       | 117/500 [17:22<1:02:07,  9.73s/it][2025-11-19 08:39:24,186] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.825313186095609
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   gamma: 0.37784525619871967
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   alpha: 0.6542644791316803
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   lambda: 2.4857660514700646
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   learning_rate: 0.05954972230626701
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   subsample: 0.8678651760421585
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   colsample_bytree: 0.5230947718128545
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5632325804709296
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   colsample_bynode: 0.781304439050836
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:39:24,186] [INFO] [<frozen importlib] -   scale_pos_weight: 5.825313186095609
[2025-11-19 08:39:24,267] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:39:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:39:24,171] Trial 116 finished with value: 0.2346507388577944 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.26618369362665967, 'learning_rate': 0.059259087502410344, 'n_estimators': 450, 'alpha': 0.6624184234690194, 'lambda': 2.4367521921012427, 'subsample': 0.8665041219841026, 'colsample_bytree': 0.5240034461485615, 'colsample_bylevel': 0.5888249849999825, 'colsample_bynode': 0.7684875091802096, 'scale_pos_weight': 5.742043041007408}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.63285	train-auc:0.63711	train-aucpr:0.23377	val-logloss:0.62075	val-auc:0.63200	val-aucpr:0.14008
[10]	train-logloss:0.60381	train-auc:0.68406	train-aucpr:0.28735	val-logloss:0.56204	val-auc:0.69695	val-aucpr:0.20223
[20]	train-logloss:0.58791	train-auc:0.69254	train-aucpr:0.30397	val-logloss:0.51467	val-auc:0.70599	val-aucpr:0.21514
[30]	train-logloss:0.57877	train-auc:0.69805	train-aucpr:0.31154	val-logloss:0.48645	val-auc:0.70466	val-aucpr:0.22129
[40]	train-logloss:0.57285	train-auc:0.70406	train-aucpr:0.31743	val-logloss:0.46862	val-auc:0.70006	val-aucpr:0.22173
[50]	train-logloss:0.56831	train-auc:0.70982	train-aucpr:0.32325	val-logloss:0.46044	val-auc:0.69997	val-aucpr:0.21698
[60]	train-logloss:0.56452	train-auc:0.71495	train-aucpr:0.32981	val-logloss:0.45090	val-auc:0.70141	val-aucpr:0.21767
[70]	train-logloss:0.56138	train-auc:0.72062	train-aucpr:0.33513	val-logloss:0.42640	val-auc:0.68628	val-aucpr:0.19802
[74]	train-logloss:0.56049	train-auc:0.72318	train-aucpr:0.33746	val-logloss:0.43031	val-auc:0.68654	val-aucpr:0.19877
[2025-11-19 08:39:24,489] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 08:39:24,489] [INFO] [<frozen importlib] - Best train loss: 0.5713
[2025-11-19 08:39:24,489] [INFO] [<frozen importlib] - Best val loss: 0.4649
[2025-11-19 08:39:24,489] [INFO] [<frozen importlib] - Best val AUC: 0.7001
[2025-11-19 08:39:24,489] [INFO] [<frozen importlib] - Best val AUCPR: 0.2246
[2025-11-19 08:39:24,494] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:39:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:39:36,342] [INFO] [<frozen importlib] - Optimal threshold: 0.4446
[2025-11-19 08:39:36,342] [INFO] [<frozen importlib] - Best f1: 0.2821
[2025-11-19 08:39:36,342] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:39:36,385] [INFO] [<frozen importlib] - Validation Results (threshold=0.4446):
[2025-11-19 08:39:36,385] [INFO] [<frozen importlib] -   Accuracy: 0.8982
[2025-11-19 08:39:36,385] [INFO] [<frozen importlib] -   Precision: 0.3078
[2025-11-19 08:39:36,385] [INFO] [<frozen importlib] -   Recall: 0.2603
[2025-11-19 08:39:36,385] [INFO] [<frozen importlib] -   F1 Score: 0.2821
[2025-11-19 08:39:36,385] [INFO] [<frozen importlib] -   AUROC: 0.7001
[2025-11-19 08:39:36,385] [INFO] [<frozen importlib] -   AUPRC: 0.2250
[2025-11-19 08:39:36,385] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:39:36,385] [INFO] [<frozen importlib] -     TN=16595, FP=850
[2025-11-19 08:39:36,385] [INFO] [<frozen importlib] -     FN=1074, TP=378
[2025-11-19 08:39:36,408] [INFO] [<frozen importlib] - Trial 117: AUPRC=0.2250, F1=0.4409, Prec=0.4337, Rec=0.4483 | Optimizing auprc=0.2250
[2025-11-19 08:39:36,408] [INFO] [<frozen importlib] - Trial 117 pruned.
[2025-11-19 08:39:36,408] [ERROR] [<frozen importlib] - Trial 117 failed with error: 
                                                                                         Best trial: 88. Best value: 0.236742:  23%|██▎       | 117/500 [17:34<1:02:07,  9.73s/it]Best trial: 88. Best value: 0.236742:  23%|██▎       | 117/500 [17:34<1:02:07,  9.73s/it]Best trial: 88. Best value: 0.236742:  24%|██▎       | 118/500 [17:34<1:06:44, 10.48s/it][2025-11-19 08:39:36,417] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.052697216280817
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   gamma: 0.25595721369972757
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   alpha: 0.5234514817749398
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   lambda: 2.2276426537996747
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   learning_rate: 0.041926856177796776
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   subsample: 0.9097573915243609
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   colsample_bytree: 0.5184105008158201
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5318648973340818
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   colsample_bynode: 0.7626708330266139
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:39:36,417] [INFO] [<frozen importlib] -   scale_pos_weight: 5.052697216280817
[2025-11-19 08:39:36,489] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:39:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:39:36,408] Trial 117 pruned. 
[0]	train-logloss:0.58994	train-auc:0.63784	train-aucpr:0.23955	val-logloss:0.57204	val-auc:0.65492	val-aucpr:0.14672
[10]	train-logloss:0.56893	train-auc:0.68123	train-aucpr:0.29045	val-logloss:0.52387	val-auc:0.66018	val-aucpr:0.18234
[20]	train-logloss:0.55598	train-auc:0.68904	train-aucpr:0.29962	val-logloss:0.48961	val-auc:0.69861	val-aucpr:0.20888
[30]	train-logloss:0.54753	train-auc:0.69163	train-aucpr:0.30549	val-logloss:0.47159	val-auc:0.71447	val-aucpr:0.21978
[40]	train-logloss:0.54081	train-auc:0.69730	train-aucpr:0.31221	val-logloss:0.45892	val-auc:0.71642	val-aucpr:0.22137
[50]	train-logloss:0.53597	train-auc:0.70239	train-aucpr:0.31636	val-logloss:0.45038	val-auc:0.71004	val-aucpr:0.22512
[60]	train-logloss:0.53279	train-auc:0.70580	train-aucpr:0.32057	val-logloss:0.44343	val-auc:0.70814	val-aucpr:0.22700
[70]	train-logloss:0.52967	train-auc:0.71089	train-aucpr:0.32486	val-logloss:0.44076	val-auc:0.69913	val-aucpr:0.21143
[80]	train-logloss:0.52738	train-auc:0.71385	train-aucpr:0.32804	val-logloss:0.43270	val-auc:0.69777	val-aucpr:0.21009
[89]	train-logloss:0.52504	train-auc:0.71833	train-aucpr:0.33230	val-logloss:0.41072	val-auc:0.68946	val-aucpr:0.19409
[2025-11-19 08:39:36,745] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:39:36,745] [INFO] [<frozen importlib] - Best train loss: 0.5328
[2025-11-19 08:39:36,745] [INFO] [<frozen importlib] - Best val loss: 0.4434
[2025-11-19 08:39:36,745] [INFO] [<frozen importlib] - Best val AUC: 0.7081
[2025-11-19 08:39:36,745] [INFO] [<frozen importlib] - Best val AUCPR: 0.2270
[2025-11-19 08:39:36,749] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:39:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:39:49,851] [INFO] [<frozen importlib] - Optimal threshold: 0.4374
[2025-11-19 08:39:49,851] [INFO] [<frozen importlib] - Best f1: 0.2781
[2025-11-19 08:39:49,851] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:39:49,895] [INFO] [<frozen importlib] - Validation Results (threshold=0.4374):
[2025-11-19 08:39:49,895] [INFO] [<frozen importlib] -   Accuracy: 0.9082
[2025-11-19 08:39:49,895] [INFO] [<frozen importlib] -   Precision: 0.3516
[2025-11-19 08:39:49,895] [INFO] [<frozen importlib] -   Recall: 0.2300
[2025-11-19 08:39:49,895] [INFO] [<frozen importlib] -   F1 Score: 0.2781
[2025-11-19 08:39:49,895] [INFO] [<frozen importlib] -   AUROC: 0.7081
[2025-11-19 08:39:49,895] [INFO] [<frozen importlib] -   AUPRC: 0.2276
[2025-11-19 08:39:49,895] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:39:49,895] [INFO] [<frozen importlib] -     TN=16829, FP=616
[2025-11-19 08:39:49,895] [INFO] [<frozen importlib] -     FN=1118, TP=334
[2025-11-19 08:39:49,918] [INFO] [<frozen importlib] - Trial 118: AUPRC=0.2276, F1=0.4625, Prec=0.5024, Rec=0.4284 | Optimizing auprc=0.2276
                                                                                         Best trial: 88. Best value: 0.236742:  24%|██▎       | 118/500 [17:47<1:06:44, 10.48s/it]Best trial: 88. Best value: 0.236742:  24%|██▎       | 118/500 [17:47<1:06:44, 10.48s/it]Best trial: 88. Best value: 0.236742:  24%|██▍       | 119/500 [17:47<1:12:20, 11.39s/it][2025-11-19 08:39:49,935] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.531242338380538
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   gamma: 0.3055796492836247
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   alpha: 0.700282282657293
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   lambda: 2.3661531185270563
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   learning_rate: 0.03762534858521803
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   subsample: 0.8861626440532219
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   colsample_bytree: 0.5536256926045271
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5858218086850826
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   colsample_bynode: 0.7702546037058146
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:39:49,935] [INFO] [<frozen importlib] -   scale_pos_weight: 6.531242338380538
[2025-11-19 08:39:50,009] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:39:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:39:49,918] Trial 118 finished with value: 0.22764043095755124 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.25595721369972757, 'learning_rate': 0.041926856177796776, 'n_estimators': 450, 'alpha': 0.5234514817749398, 'lambda': 2.2276426537996747, 'subsample': 0.9097573915243609, 'colsample_bytree': 0.5184105008158201, 'colsample_bylevel': 0.5318648973340818, 'colsample_bynode': 0.7626708330266139, 'scale_pos_weight': 5.052697216280817}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.67342	train-auc:0.64674	train-aucpr:0.23686	val-logloss:0.66776	val-auc:0.63457	val-aucpr:0.13244
[10]	train-logloss:0.64993	train-auc:0.68123	train-aucpr:0.28950	val-logloss:0.60944	val-auc:0.66768	val-aucpr:0.19060
[20]	train-logloss:0.63534	train-auc:0.68661	train-aucpr:0.29765	val-logloss:0.56914	val-auc:0.68181	val-aucpr:0.20353
[30]	train-logloss:0.62519	train-auc:0.69347	train-aucpr:0.30411	val-logloss:0.54166	val-auc:0.69499	val-aucpr:0.21770
[40]	train-logloss:0.61805	train-auc:0.69801	train-aucpr:0.30897	val-logloss:0.51940	val-auc:0.69955	val-aucpr:0.21998
[50]	train-logloss:0.61194	train-auc:0.70287	train-aucpr:0.31440	val-logloss:0.51229	val-auc:0.70090	val-aucpr:0.22210
[60]	train-logloss:0.60777	train-auc:0.70702	train-aucpr:0.31851	val-logloss:0.50745	val-auc:0.69923	val-aucpr:0.21680
[70]	train-logloss:0.60422	train-auc:0.71056	train-aucpr:0.32271	val-logloss:0.50520	val-auc:0.69814	val-aucpr:0.21415
[77]	train-logloss:0.60236	train-auc:0.71274	train-aucpr:0.32512	val-logloss:0.50316	val-auc:0.69967	val-aucpr:0.21883
[2025-11-19 08:39:50,236] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 08:39:50,236] [INFO] [<frozen importlib] - Best train loss: 0.6135
[2025-11-19 08:39:50,236] [INFO] [<frozen importlib] - Best val loss: 0.5191
[2025-11-19 08:39:50,236] [INFO] [<frozen importlib] - Best val AUC: 0.7031
[2025-11-19 08:39:50,236] [INFO] [<frozen importlib] - Best val AUCPR: 0.2231
[2025-11-19 08:39:50,240] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:39:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:40:00,883] [INFO] [<frozen importlib] - Optimal threshold: 0.4787
[2025-11-19 08:40:00,883] [INFO] [<frozen importlib] - Best f1: 0.2653
[2025-11-19 08:40:00,883] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:40:00,937] [INFO] [<frozen importlib] - Validation Results (threshold=0.4787):
[2025-11-19 08:40:00,937] [INFO] [<frozen importlib] -   Accuracy: 0.8813
[2025-11-19 08:40:00,937] [INFO] [<frozen importlib] -   Precision: 0.2530
[2025-11-19 08:40:00,937] [INFO] [<frozen importlib] -   Recall: 0.2789
[2025-11-19 08:40:00,937] [INFO] [<frozen importlib] -   F1 Score: 0.2653
[2025-11-19 08:40:00,937] [INFO] [<frozen importlib] -   AUROC: 0.7031
[2025-11-19 08:40:00,937] [INFO] [<frozen importlib] -   AUPRC: 0.2234
[2025-11-19 08:40:00,937] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:40:00,937] [INFO] [<frozen importlib] -     TN=16249, FP=1196
[2025-11-19 08:40:00,937] [INFO] [<frozen importlib] -     FN=1047, TP=405
[2025-11-19 08:40:00,962] [INFO] [<frozen importlib] - Trial 119: AUPRC=0.2234, F1=0.4308, Prec=0.3781, Rec=0.5007 | Optimizing auprc=0.2234
                                                                                         Best trial: 88. Best value: 0.236742:  24%|██▍       | 119/500 [17:58<1:12:20, 11.39s/it]Best trial: 88. Best value: 0.236742:  24%|██▍       | 119/500 [17:58<1:12:20, 11.39s/it]Best trial: 88. Best value: 0.236742:  24%|██▍       | 120/500 [17:58<1:11:29, 11.29s/it][2025-11-19 08:40:00,971] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.599252388700657
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   gamma: 0.22744372620290798
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   alpha: 0.45263446803287527
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   lambda: 2.8057484114241387
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   learning_rate: 0.05366010649366913
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   subsample: 0.854079696373926
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   colsample_bytree: 0.6843837765500431
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5007379008692521
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   colsample_bynode: 0.8346238921087652
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:40:00,971] [INFO] [<frozen importlib] -   scale_pos_weight: 5.599252388700657
[2025-11-19 08:40:01,049] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:40:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:40:00,962] Trial 119 finished with value: 0.2234110345855785 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.3055796492836247, 'learning_rate': 0.03762534858521803, 'n_estimators': 500, 'alpha': 0.700282282657293, 'lambda': 2.3661531185270563, 'subsample': 0.8861626440532219, 'colsample_bytree': 0.5536256926045271, 'colsample_bylevel': 0.5858218086850826, 'colsample_bynode': 0.7702546037058146, 'scale_pos_weight': 6.531242338380538}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.62071	train-auc:0.63089	train-aucpr:0.21329	val-logloss:0.60798	val-auc:0.60011	val-aucpr:0.11124
[10]	train-logloss:0.59261	train-auc:0.68566	train-aucpr:0.29356	val-logloss:0.55606	val-auc:0.66322	val-aucpr:0.13628
[20]	train-logloss:0.57792	train-auc:0.69361	train-aucpr:0.30452	val-logloss:0.51206	val-auc:0.67049	val-aucpr:0.18416
[30]	train-logloss:0.56865	train-auc:0.70170	train-aucpr:0.31046	val-logloss:0.49767	val-auc:0.68593	val-aucpr:0.19389
[40]	train-logloss:0.56258	train-auc:0.70601	train-aucpr:0.31604	val-logloss:0.47854	val-auc:0.69244	val-aucpr:0.20230
[50]	train-logloss:0.55762	train-auc:0.71189	train-aucpr:0.32318	val-logloss:0.47240	val-auc:0.70078	val-aucpr:0.20916
[60]	train-logloss:0.55373	train-auc:0.71757	train-aucpr:0.32948	val-logloss:0.46354	val-auc:0.69970	val-aucpr:0.20774
[70]	train-logloss:0.55026	train-auc:0.72217	train-aucpr:0.33634	val-logloss:0.44164	val-auc:0.69420	val-aucpr:0.19915
[80]	train-logloss:0.54777	train-auc:0.72707	train-aucpr:0.34150	val-logloss:0.43211	val-auc:0.68345	val-aucpr:0.18247
[84]	train-logloss:0.54663	train-auc:0.72883	train-aucpr:0.34324	val-logloss:0.43092	val-auc:0.68480	val-aucpr:0.18304
[2025-11-19 08:40:01,295] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 08:40:01,295] [INFO] [<frozen importlib] - Best train loss: 0.5559
[2025-11-19 08:40:01,295] [INFO] [<frozen importlib] - Best val loss: 0.4680
[2025-11-19 08:40:01,295] [INFO] [<frozen importlib] - Best val AUC: 0.7013
[2025-11-19 08:40:01,295] [INFO] [<frozen importlib] - Best val AUCPR: 0.2114
[2025-11-19 08:40:01,300] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:40:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:40:14,074] [INFO] [<frozen importlib] - Optimal threshold: 0.4619
[2025-11-19 08:40:14,074] [INFO] [<frozen importlib] - Best f1: 0.2712
[2025-11-19 08:40:14,074] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:40:14,121] [INFO] [<frozen importlib] - Validation Results (threshold=0.4619):
[2025-11-19 08:40:14,121] [INFO] [<frozen importlib] -   Accuracy: 0.9098
[2025-11-19 08:40:14,121] [INFO] [<frozen importlib] -   Precision: 0.3578
[2025-11-19 08:40:14,121] [INFO] [<frozen importlib] -   Recall: 0.2183
[2025-11-19 08:40:14,121] [INFO] [<frozen importlib] -   F1 Score: 0.2712
[2025-11-19 08:40:14,121] [INFO] [<frozen importlib] -   AUROC: 0.7013
[2025-11-19 08:40:14,121] [INFO] [<frozen importlib] -   AUPRC: 0.2119
[2025-11-19 08:40:14,121] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:40:14,121] [INFO] [<frozen importlib] -     TN=16876, FP=569
[2025-11-19 08:40:14,121] [INFO] [<frozen importlib] -     FN=1135, TP=317
[2025-11-19 08:40:14,149] [INFO] [<frozen importlib] - Trial 120: AUPRC=0.2119, F1=0.4584, Prec=0.5137, Rec=0.4139 | Optimizing auprc=0.2119
                                                                                         Best trial: 88. Best value: 0.236742:  24%|██▍       | 120/500 [18:12<1:11:29, 11.29s/it]Best trial: 88. Best value: 0.236742:  24%|██▍       | 120/500 [18:12<1:11:29, 11.29s/it]Best trial: 88. Best value: 0.236742:  24%|██▍       | 121/500 [18:12<1:14:53, 11.86s/it][2025-11-19 08:40:14,157] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.894936796523911
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   gamma: 0.32799786254364427
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   alpha: 0.9456609645957644
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   lambda: 1.059028360702138
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   learning_rate: 0.06390146662923123
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   subsample: 0.8063456278130986
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   colsample_bytree: 0.5393363412413211
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6153745406718996
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   colsample_bynode: 0.8165031176625763
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:40:14,157] [INFO] [<frozen importlib] -   scale_pos_weight: 6.894936796523911
[2025-11-19 08:40:14,232] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:40:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:40:14,149] Trial 120 finished with value: 0.21190284544032179 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.22744372620290798, 'learning_rate': 0.05366010649366913, 'n_estimators': 450, 'alpha': 0.45263446803287527, 'lambda': 2.8057484114241387, 'subsample': 0.854079696373926, 'colsample_bytree': 0.6843837765500431, 'colsample_bylevel': 0.5007379008692521, 'colsample_bynode': 0.8346238921087652, 'scale_pos_weight': 5.599252388700657}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.69151	train-auc:0.63288	train-aucpr:0.22971	val-logloss:0.68674	val-auc:0.64889	val-aucpr:0.13487
[10]	train-logloss:0.65629	train-auc:0.68380	train-aucpr:0.29486	val-logloss:0.60268	val-auc:0.67459	val-aucpr:0.15655
[20]	train-logloss:0.63949	train-auc:0.69469	train-aucpr:0.30545	val-logloss:0.56752	val-auc:0.68492	val-aucpr:0.19972
[30]	train-logloss:0.62952	train-auc:0.69997	train-aucpr:0.31313	val-logloss:0.53375	val-auc:0.70364	val-aucpr:0.22500
[40]	train-logloss:0.62272	train-auc:0.70812	train-aucpr:0.31972	val-logloss:0.52525	val-auc:0.71175	val-aucpr:0.22248
[50]	train-logloss:0.61704	train-auc:0.71440	train-aucpr:0.32686	val-logloss:0.51648	val-auc:0.71028	val-aucpr:0.21890
[60]	train-logloss:0.61273	train-auc:0.72165	train-aucpr:0.33429	val-logloss:0.48439	val-auc:0.70094	val-aucpr:0.21361
[62]	train-logloss:0.61195	train-auc:0.72238	train-aucpr:0.33551	val-logloss:0.47824	val-auc:0.69999	val-aucpr:0.21382
[2025-11-19 08:40:14,420] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 08:40:14,420] [INFO] [<frozen importlib] - Best train loss: 0.6277
[2025-11-19 08:40:14,420] [INFO] [<frozen importlib] - Best val loss: 0.5399
[2025-11-19 08:40:14,420] [INFO] [<frozen importlib] - Best val AUC: 0.7089
[2025-11-19 08:40:14,420] [INFO] [<frozen importlib] - Best val AUCPR: 0.2259
[2025-11-19 08:40:14,425] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:40:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:40:22,078] [INFO] [<frozen importlib] - Optimal threshold: 0.5090
[2025-11-19 08:40:22,078] [INFO] [<frozen importlib] - Best f1: 0.2797
[2025-11-19 08:40:22,078] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:40:22,122] [INFO] [<frozen importlib] - Validation Results (threshold=0.5090):
[2025-11-19 08:40:22,123] [INFO] [<frozen importlib] -   Accuracy: 0.8874
[2025-11-19 08:40:22,123] [INFO] [<frozen importlib] -   Precision: 0.2751
[2025-11-19 08:40:22,123] [INFO] [<frozen importlib] -   Recall: 0.2844
[2025-11-19 08:40:22,123] [INFO] [<frozen importlib] -   F1 Score: 0.2797
[2025-11-19 08:40:22,123] [INFO] [<frozen importlib] -   AUROC: 0.7089
[2025-11-19 08:40:22,123] [INFO] [<frozen importlib] -   AUPRC: 0.2266
[2025-11-19 08:40:22,123] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:40:22,123] [INFO] [<frozen importlib] -     TN=16357, FP=1088
[2025-11-19 08:40:22,123] [INFO] [<frozen importlib] -     FN=1039, TP=413
[2025-11-19 08:40:22,146] [INFO] [<frozen importlib] - Trial 121: AUPRC=0.2266, F1=0.4214, Prec=0.3839, Rec=0.4669 | Optimizing auprc=0.2266
                                                                                         Best trial: 88. Best value: 0.236742:  24%|██▍       | 121/500 [18:20<1:14:53, 11.86s/it]Best trial: 88. Best value: 0.236742:  24%|██▍       | 121/500 [18:20<1:14:53, 11.86s/it]Best trial: 88. Best value: 0.236742:  24%|██▍       | 122/500 [18:20<1:07:24, 10.70s/it][2025-11-19 08:40:22,161] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.1963413929775815
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   gamma: 0.2727810964411647
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   alpha: 0.6214794942800451
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   lambda: 1.85991830144013
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   learning_rate: 0.048929019784849447
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   subsample: 0.8482154661345419
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   colsample_bytree: 0.5121122503472689
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5219495523553296
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   colsample_bynode: 0.7901334506612637
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:40:22,161] [INFO] [<frozen importlib] -   scale_pos_weight: 6.1963413929775815
[2025-11-19 08:40:22,238] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:40:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:40:22,146] Trial 121 finished with value: 0.22657183709616197 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.32799786254364427, 'learning_rate': 0.06390146662923123, 'n_estimators': 500, 'alpha': 0.9456609645957644, 'lambda': 1.059028360702138, 'subsample': 0.8063456278130986, 'colsample_bytree': 0.5393363412413211, 'colsample_bylevel': 0.6153745406718996, 'colsample_bynode': 0.8165031176625763, 'scale_pos_weight': 6.894936796523911}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.65437	train-auc:0.63934	train-aucpr:0.21825	val-logloss:0.64649	val-auc:0.65957	val-aucpr:0.13068
[10]	train-logloss:0.62786	train-auc:0.68706	train-aucpr:0.29002	val-logloss:0.59704	val-auc:0.67969	val-aucpr:0.19696
[20]	train-logloss:0.61288	train-auc:0.69049	train-aucpr:0.29783	val-logloss:0.55622	val-auc:0.71073	val-aucpr:0.21900
[30]	train-logloss:0.60298	train-auc:0.69476	train-aucpr:0.30595	val-logloss:0.52074	val-auc:0.69974	val-aucpr:0.22494
[40]	train-logloss:0.59565	train-auc:0.70050	train-aucpr:0.31179	val-logloss:0.49587	val-auc:0.70197	val-aucpr:0.22470
[50]	train-logloss:0.59039	train-auc:0.70701	train-aucpr:0.31792	val-logloss:0.49746	val-auc:0.70049	val-aucpr:0.22212
[60]	train-logloss:0.58667	train-auc:0.71059	train-aucpr:0.32320	val-logloss:0.49099	val-auc:0.70375	val-aucpr:0.22381
[67]	train-logloss:0.58401	train-auc:0.71532	train-aucpr:0.32668	val-logloss:0.47464	val-auc:0.69491	val-aucpr:0.21574
[2025-11-19 08:40:22,438] [INFO] [<frozen importlib] - Training completed at iteration 37
[2025-11-19 08:40:22,438] [INFO] [<frozen importlib] - Best train loss: 0.5977
[2025-11-19 08:40:22,438] [INFO] [<frozen importlib] - Best val loss: 0.5030
[2025-11-19 08:40:22,438] [INFO] [<frozen importlib] - Best val AUC: 0.7051
[2025-11-19 08:40:22,438] [INFO] [<frozen importlib] - Best val AUCPR: 0.2281
[2025-11-19 08:40:22,443] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:40:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:40:32,551] [INFO] [<frozen importlib] - Optimal threshold: 0.4710
[2025-11-19 08:40:32,551] [INFO] [<frozen importlib] - Best f1: 0.2798
[2025-11-19 08:40:32,551] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:40:32,593] [INFO] [<frozen importlib] - Validation Results (threshold=0.4710):
[2025-11-19 08:40:32,593] [INFO] [<frozen importlib] -   Accuracy: 0.8984
[2025-11-19 08:40:32,593] [INFO] [<frozen importlib] -   Precision: 0.3072
[2025-11-19 08:40:32,593] [INFO] [<frozen importlib] -   Recall: 0.2569
[2025-11-19 08:40:32,593] [INFO] [<frozen importlib] -   F1 Score: 0.2798
[2025-11-19 08:40:32,593] [INFO] [<frozen importlib] -   AUROC: 0.7051
[2025-11-19 08:40:32,593] [INFO] [<frozen importlib] -   AUPRC: 0.2285
[2025-11-19 08:40:32,593] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:40:32,593] [INFO] [<frozen importlib] -     TN=16604, FP=841
[2025-11-19 08:40:32,593] [INFO] [<frozen importlib] -     FN=1079, TP=373
[2025-11-19 08:40:32,618] [INFO] [<frozen importlib] - Trial 122: AUPRC=0.2285, F1=0.4465, Prec=0.4393, Rec=0.4539 | Optimizing auprc=0.2285
                                                                                         Best trial: 88. Best value: 0.236742:  24%|██▍       | 122/500 [18:30<1:07:24, 10.70s/it]Best trial: 88. Best value: 0.236742:  24%|██▍       | 122/500 [18:30<1:07:24, 10.70s/it]Best trial: 88. Best value: 0.236742:  25%|██▍       | 123/500 [18:30<1:06:47, 10.63s/it][2025-11-19 08:40:32,627] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.359138497567315
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   gamma: 0.27022014623962254
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   alpha: 0.6281119997896114
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   lambda: 2.1353851048464536
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   learning_rate: 0.04908347027872627
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   subsample: 0.8424208177891276
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   colsample_bytree: 0.5088853585792911
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   colsample_bylevel: 0.519734394938968
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   colsample_bynode: 0.7515524559363376
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:40:32,627] [INFO] [<frozen importlib] -   scale_pos_weight: 6.359138497567315
[2025-11-19 08:40:32,703] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:40:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:40:32,618] Trial 122 finished with value: 0.2284617887660423 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.2727810964411647, 'learning_rate': 0.048929019784849447, 'n_estimators': 450, 'alpha': 0.6214794942800451, 'lambda': 1.85991830144013, 'subsample': 0.8482154661345419, 'colsample_bytree': 0.5121122503472689, 'colsample_bylevel': 0.5219495523553296, 'colsample_bynode': 0.7901334506612637, 'scale_pos_weight': 6.1963413929775815}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.66339	train-auc:0.63934	train-aucpr:0.21825	val-logloss:0.65674	val-auc:0.65957	val-aucpr:0.13068
[10]	train-logloss:0.63648	train-auc:0.68621	train-aucpr:0.28762	val-logloss:0.60697	val-auc:0.67419	val-aucpr:0.19361
[20]	train-logloss:0.62102	train-auc:0.69269	train-aucpr:0.29875	val-logloss:0.55360	val-auc:0.68461	val-aucpr:0.20977
[30]	train-logloss:0.61084	train-auc:0.69733	train-aucpr:0.30617	val-logloss:0.52235	val-auc:0.68963	val-aucpr:0.21635
[40]	train-logloss:0.60364	train-auc:0.70277	train-aucpr:0.31140	val-logloss:0.50496	val-auc:0.68478	val-aucpr:0.20915
[50]	train-logloss:0.59826	train-auc:0.70818	train-aucpr:0.31722	val-logloss:0.49835	val-auc:0.69165	val-aucpr:0.20698
[58]	train-logloss:0.59535	train-auc:0.71068	train-aucpr:0.32108	val-logloss:0.49308	val-auc:0.69389	val-aucpr:0.20811
[2025-11-19 08:40:32,886] [INFO] [<frozen importlib] - Training completed at iteration 28
[2025-11-19 08:40:32,886] [INFO] [<frozen importlib] - Best train loss: 0.6128
[2025-11-19 08:40:32,886] [INFO] [<frozen importlib] - Best val loss: 0.5282
[2025-11-19 08:40:32,886] [INFO] [<frozen importlib] - Best val AUC: 0.6892
[2025-11-19 08:40:32,886] [INFO] [<frozen importlib] - Best val AUCPR: 0.2177
[2025-11-19 08:40:32,891] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:40:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:40:42,212] [INFO] [<frozen importlib] - Optimal threshold: 0.4853
[2025-11-19 08:40:42,212] [INFO] [<frozen importlib] - Best f1: 0.2614
[2025-11-19 08:40:42,212] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:40:42,256] [INFO] [<frozen importlib] - Validation Results (threshold=0.4853):
[2025-11-19 08:40:42,257] [INFO] [<frozen importlib] -   Accuracy: 0.8962
[2025-11-19 08:40:42,257] [INFO] [<frozen importlib] -   Precision: 0.2884
[2025-11-19 08:40:42,257] [INFO] [<frozen importlib] -   Recall: 0.2390
[2025-11-19 08:40:42,257] [INFO] [<frozen importlib] -   F1 Score: 0.2614
[2025-11-19 08:40:42,257] [INFO] [<frozen importlib] -   AUROC: 0.6892
[2025-11-19 08:40:42,257] [INFO] [<frozen importlib] -   AUPRC: 0.2181
[2025-11-19 08:40:42,257] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:40:42,257] [INFO] [<frozen importlib] -     TN=16589, FP=856
[2025-11-19 08:40:42,257] [INFO] [<frozen importlib] -     FN=1105, TP=347
[2025-11-19 08:40:42,282] [INFO] [<frozen importlib] - Trial 123: AUPRC=0.2181, F1=0.4411, Prec=0.4327, Rec=0.4497 | Optimizing auprc=0.2181
[2025-11-19 08:40:42,282] [INFO] [<frozen importlib] - Trial 123 pruned.
[2025-11-19 08:40:42,282] [ERROR] [<frozen importlib] - Trial 123 failed with error: 
                                                                                         Best trial: 88. Best value: 0.236742:  25%|██▍       | 123/500 [18:40<1:06:47, 10.63s/it]Best trial: 88. Best value: 0.236742:  25%|██▍       | 123/500 [18:40<1:06:47, 10.63s/it]Best trial: 88. Best value: 0.236742:  25%|██▍       | 124/500 [18:40<1:04:48, 10.34s/it][2025-11-19 08:40:42,291] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.056806234494827
[2025-11-19 08:40:42,291] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:40:42,291] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:40:42,291] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:40:42,291] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:40:42,291] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:40:42,291] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:40:42,291] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:40:42,291] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:40:42,291] [INFO] [<frozen importlib] -   gamma: 0.36393006163758973
[2025-11-19 08:40:42,291] [INFO] [<frozen importlib] -   alpha: 0.5648461060263247
[2025-11-19 08:40:42,292] [INFO] [<frozen importlib] -   lambda: 1.5321908899625645
[2025-11-19 08:40:42,292] [INFO] [<frozen importlib] -   learning_rate: 0.04653651190868111
[2025-11-19 08:40:42,292] [INFO] [<frozen importlib] -   subsample: 0.8315775914005535
[2025-11-19 08:40:42,292] [INFO] [<frozen importlib] -   colsample_bytree: 0.5269701423486102
[2025-11-19 08:40:42,292] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5424743810081664
[2025-11-19 08:40:42,292] [INFO] [<frozen importlib] -   colsample_bynode: 0.7870912014819506
[2025-11-19 08:40:42,292] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:40:42,292] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:40:42,292] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:40:42,292] [INFO] [<frozen importlib] -   scale_pos_weight: 6.056806234494827
[2025-11-19 08:40:42,367] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:40:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:40:42,282] Trial 123 pruned. 
[0]	train-logloss:0.64681	train-auc:0.64093	train-aucpr:0.21599	val-logloss:0.63676	val-auc:0.67957	val-aucpr:0.13360
[10]	train-logloss:0.62042	train-auc:0.68137	train-aucpr:0.29026	val-logloss:0.57665	val-auc:0.70598	val-aucpr:0.21359
[20]	train-logloss:0.60546	train-auc:0.68886	train-aucpr:0.30255	val-logloss:0.53260	val-auc:0.69619	val-aucpr:0.21646
[30]	train-logloss:0.59598	train-auc:0.69430	train-aucpr:0.30922	val-logloss:0.50404	val-auc:0.70159	val-aucpr:0.22160
[40]	train-logloss:0.58924	train-auc:0.70059	train-aucpr:0.31467	val-logloss:0.48563	val-auc:0.70176	val-aucpr:0.22142
[50]	train-logloss:0.58407	train-auc:0.70680	train-aucpr:0.31876	val-logloss:0.48618	val-auc:0.69669	val-aucpr:0.22014
[60]	train-logloss:0.58029	train-auc:0.71125	train-aucpr:0.32365	val-logloss:0.47355	val-auc:0.69576	val-aucpr:0.22162
[70]	train-logloss:0.57703	train-auc:0.71607	train-aucpr:0.32829	val-logloss:0.44587	val-auc:0.68640	val-aucpr:0.20444
[77]	train-logloss:0.57445	train-auc:0.71935	train-aucpr:0.33211	val-logloss:0.45160	val-auc:0.67457	val-aucpr:0.18640
[2025-11-19 08:40:42,596] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 08:40:42,596] [INFO] [<frozen importlib] - Best train loss: 0.5855
[2025-11-19 08:40:42,596] [INFO] [<frozen importlib] - Best val loss: 0.4834
[2025-11-19 08:40:42,596] [INFO] [<frozen importlib] - Best val AUC: 0.7027
[2025-11-19 08:40:42,596] [INFO] [<frozen importlib] - Best val AUCPR: 0.2241
[2025-11-19 08:40:42,602] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:40:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:40:54,714] [INFO] [<frozen importlib] - Optimal threshold: 0.4647
[2025-11-19 08:40:54,714] [INFO] [<frozen importlib] - Best f1: 0.2764
[2025-11-19 08:40:54,714] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:40:54,757] [INFO] [<frozen importlib] - Validation Results (threshold=0.4647):
[2025-11-19 08:40:54,757] [INFO] [<frozen importlib] -   Accuracy: 0.9008
[2025-11-19 08:40:54,757] [INFO] [<frozen importlib] -   Precision: 0.3146
[2025-11-19 08:40:54,757] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 08:40:54,757] [INFO] [<frozen importlib] -   F1 Score: 0.2764
[2025-11-19 08:40:54,757] [INFO] [<frozen importlib] -   AUROC: 0.7027
[2025-11-19 08:40:54,757] [INFO] [<frozen importlib] -   AUPRC: 0.2245
[2025-11-19 08:40:54,757] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:40:54,757] [INFO] [<frozen importlib] -     TN=16665, FP=780
[2025-11-19 08:40:54,757] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 08:40:54,782] [INFO] [<frozen importlib] - Trial 124: AUPRC=0.2245, F1=0.4596, Prec=0.4606, Rec=0.4587 | Optimizing auprc=0.2245
                                                                                         Best trial: 88. Best value: 0.236742:  25%|██▍       | 124/500 [18:52<1:04:48, 10.34s/it]Best trial: 88. Best value: 0.236742:  25%|██▍       | 124/500 [18:52<1:04:48, 10.34s/it]Best trial: 88. Best value: 0.236742:  25%|██▌       | 125/500 [18:52<1:08:40, 10.99s/it][2025-11-19 08:40:54,796] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.360206786217672
[2025-11-19 08:40:54,796] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:40:54,796] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:40:54,796] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   gamma: 0.2112766625928453
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   alpha: 0.7229950513941782
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   lambda: 2.5132199171831764
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   learning_rate: 0.043571331130736086
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   subsample: 0.7923061136846494
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   colsample_bytree: 0.5149466088067154
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7634913820673326
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   colsample_bynode: 0.793750343830247
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:40:54,797] [INFO] [<frozen importlib] -   scale_pos_weight: 5.360206786217672
[2025-11-19 08:40:54,875] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:40:54] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:40:54,782] Trial 124 finished with value: 0.22453337907610105 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.36393006163758973, 'learning_rate': 0.04653651190868111, 'n_estimators': 450, 'alpha': 0.5648461060263247, 'lambda': 1.5321908899625645, 'subsample': 0.8315775914005535, 'colsample_bytree': 0.5269701423486102, 'colsample_bylevel': 0.5424743810081664, 'colsample_bynode': 0.7870912014819506, 'scale_pos_weight': 6.056806234494827}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.60698	train-auc:0.65521	train-aucpr:0.24808	val-logloss:0.58878	val-auc:0.65086	val-aucpr:0.13973
[10]	train-logloss:0.58387	train-auc:0.68342	train-aucpr:0.29369	val-logloss:0.53631	val-auc:0.67390	val-aucpr:0.20331
[20]	train-logloss:0.57073	train-auc:0.68997	train-aucpr:0.30016	val-logloss:0.49563	val-auc:0.69599	val-aucpr:0.21536
[30]	train-logloss:0.56148	train-auc:0.69633	train-aucpr:0.30765	val-logloss:0.46531	val-auc:0.70280	val-aucpr:0.22083
[40]	train-logloss:0.55543	train-auc:0.70043	train-aucpr:0.31292	val-logloss:0.45671	val-auc:0.70628	val-aucpr:0.22502
[50]	train-logloss:0.55056	train-auc:0.70470	train-aucpr:0.31697	val-logloss:0.44727	val-auc:0.70359	val-aucpr:0.22495
[60]	train-logloss:0.54663	train-auc:0.71033	train-aucpr:0.32261	val-logloss:0.43187	val-auc:0.70425	val-aucpr:0.22715
[70]	train-logloss:0.54362	train-auc:0.71465	train-aucpr:0.32696	val-logloss:0.44100	val-auc:0.69092	val-aucpr:0.21241
[80]	train-logloss:0.54052	train-auc:0.72068	train-aucpr:0.33144	val-logloss:0.43806	val-auc:0.68846	val-aucpr:0.21317
[90]	train-logloss:0.53811	train-auc:0.72476	train-aucpr:0.33601	val-logloss:0.43361	val-auc:0.69124	val-aucpr:0.20967
[91]	train-logloss:0.53792	train-auc:0.72527	train-aucpr:0.33629	val-logloss:0.43342	val-auc:0.69125	val-aucpr:0.20938
[2025-11-19 08:40:55,132] [INFO] [<frozen importlib] - Training completed at iteration 61
[2025-11-19 08:40:55,132] [INFO] [<frozen importlib] - Best train loss: 0.5464
[2025-11-19 08:40:55,132] [INFO] [<frozen importlib] - Best val loss: 0.4312
[2025-11-19 08:40:55,132] [INFO] [<frozen importlib] - Best val AUC: 0.7051
[2025-11-19 08:40:55,132] [INFO] [<frozen importlib] - Best val AUCPR: 0.2273
[2025-11-19 08:40:55,137] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:40:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:41:07,923] [INFO] [<frozen importlib] - Optimal threshold: 0.4325
[2025-11-19 08:41:07,923] [INFO] [<frozen importlib] - Best f1: 0.2749
[2025-11-19 08:41:07,923] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:41:07,966] [INFO] [<frozen importlib] - Validation Results (threshold=0.4325):
[2025-11-19 08:41:07,966] [INFO] [<frozen importlib] -   Accuracy: 0.9051
[2025-11-19 08:41:07,966] [INFO] [<frozen importlib] -   Precision: 0.3327
[2025-11-19 08:41:07,966] [INFO] [<frozen importlib] -   Recall: 0.2342
[2025-11-19 08:41:07,966] [INFO] [<frozen importlib] -   F1 Score: 0.2749
[2025-11-19 08:41:07,966] [INFO] [<frozen importlib] -   AUROC: 0.7051
[2025-11-19 08:41:07,966] [INFO] [<frozen importlib] -   AUPRC: 0.2277
[2025-11-19 08:41:07,966] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:41:07,966] [INFO] [<frozen importlib] -     TN=16763, FP=682
[2025-11-19 08:41:07,966] [INFO] [<frozen importlib] -     FN=1112, TP=340
[2025-11-19 08:41:07,989] [INFO] [<frozen importlib] - Trial 125: AUPRC=0.2277, F1=0.4620, Prec=0.4845, Rec=0.4415 | Optimizing auprc=0.2277
                                                                                         Best trial: 88. Best value: 0.236742:  25%|██▌       | 125/500 [19:05<1:08:40, 10.99s/it]Best trial: 88. Best value: 0.236742:  25%|██▌       | 125/500 [19:05<1:08:40, 10.99s/it]Best trial: 88. Best value: 0.236742:  25%|██▌       | 126/500 [19:05<1:12:38, 11.65s/it][2025-11-19 08:41:07,999] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.333360591443311
[2025-11-19 08:41:07,999] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:41:07,999] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:41:07,999] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:41:07,999] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:41:07,999] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:41:07,999] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:41:07,999] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:41:07,999] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   gamma: 0.18311621075798729
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   alpha: 0.6656812824660019
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   lambda: 0.015211797615721667
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   learning_rate: 0.1403140187616994
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   subsample: 0.8181822900097064
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   colsample_bytree: 0.5332374020302456
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5108734363822842
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   colsample_bynode: 0.8096308253587756
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:41:08,000] [INFO] [<frozen importlib] -   scale_pos_weight: 7.333360591443311
[2025-11-19 08:41:08,073] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:41:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:41:07,989] Trial 125 finished with value: 0.22767442022972723 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.2112766625928453, 'learning_rate': 0.043571331130736086, 'n_estimators': 450, 'alpha': 0.7229950513941782, 'lambda': 2.5132199171831764, 'subsample': 0.7923061136846494, 'colsample_bytree': 0.5149466088067154, 'colsample_bylevel': 0.7634913820673326, 'colsample_bynode': 0.793750343830247, 'scale_pos_weight': 5.360206786217672}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.70939	train-auc:0.63255	train-aucpr:0.22386	val-logloss:0.70118	val-auc:0.64589	val-aucpr:0.12313
[10]	train-logloss:0.65682	train-auc:0.69309	train-aucpr:0.30183	val-logloss:0.60362	val-auc:0.68009	val-aucpr:0.19795
[20]	train-logloss:0.64000	train-auc:0.71161	train-aucpr:0.31973	val-logloss:0.56419	val-auc:0.68765	val-aucpr:0.18838
[30]	train-logloss:0.63076	train-auc:0.72224	train-aucpr:0.33261	val-logloss:0.53150	val-auc:0.68846	val-aucpr:0.18612
[40]	train-logloss:0.62257	train-auc:0.73724	train-aucpr:0.34736	val-logloss:0.46508	val-auc:0.67049	val-aucpr:0.15925
[42]	train-logloss:0.62062	train-auc:0.73948	train-aucpr:0.34956	val-logloss:0.46506	val-auc:0.67124	val-aucpr:0.16016
[2025-11-19 08:41:08,214] [INFO] [<frozen importlib] - Training completed at iteration 13
[2025-11-19 08:41:08,214] [INFO] [<frozen importlib] - Best train loss: 0.6501
[2025-11-19 08:41:08,214] [INFO] [<frozen importlib] - Best val loss: 0.5820
[2025-11-19 08:41:08,214] [INFO] [<frozen importlib] - Best val AUC: 0.6951
[2025-11-19 08:41:08,214] [INFO] [<frozen importlib] - Best val AUCPR: 0.2135
[2025-11-19 08:41:08,219] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:41:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:41:11,950] [INFO] [<frozen importlib] - Optimal threshold: 0.5268
[2025-11-19 08:41:11,950] [INFO] [<frozen importlib] - Best f1: 0.2852
[2025-11-19 08:41:11,950] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:41:11,995] [INFO] [<frozen importlib] - Validation Results (threshold=0.5268):
[2025-11-19 08:41:11,995] [INFO] [<frozen importlib] -   Accuracy: 0.8883
[2025-11-19 08:41:11,995] [INFO] [<frozen importlib] -   Precision: 0.2807
[2025-11-19 08:41:11,995] [INFO] [<frozen importlib] -   Recall: 0.2899
[2025-11-19 08:41:11,996] [INFO] [<frozen importlib] -   F1 Score: 0.2852
[2025-11-19 08:41:11,996] [INFO] [<frozen importlib] -   AUROC: 0.6951
[2025-11-19 08:41:11,996] [INFO] [<frozen importlib] -   AUPRC: 0.2138
[2025-11-19 08:41:11,996] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:41:11,996] [INFO] [<frozen importlib] -     TN=16366, FP=1079
[2025-11-19 08:41:11,996] [INFO] [<frozen importlib] -     FN=1031, TP=421
[2025-11-19 08:41:12,020] [INFO] [<frozen importlib] - Trial 126: AUPRC=0.2138, F1=0.4576, Prec=0.4104, Rec=0.5172 | Optimizing auprc=0.2138
                                                                                         Best trial: 88. Best value: 0.236742:  25%|██▌       | 126/500 [19:09<1:12:38, 11.65s/it]Best trial: 88. Best value: 0.236742:  25%|██▌       | 126/500 [19:09<1:12:38, 11.65s/it]Best trial: 88. Best value: 0.236742:  25%|██▌       | 127/500 [19:09<58:14,  9.37s/it]  [2025-11-19 08:41:12,036] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.573064085843947
[2025-11-19 08:41:12,036] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:41:12,036] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:41:12,036] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:41:12,036] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:41:12,036] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:41:12,036] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   gamma: 0.3023827573566335
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   alpha: 0.7807562281339393
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   lambda: 1.8935369809600353
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   learning_rate: 0.05052493333577081
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   subsample: 0.8463751223878759
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   colsample_bytree: 0.5481750890223077
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5259443437983509
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   colsample_bynode: 0.8588209655855629
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:41:12,037] [INFO] [<frozen importlib] -   scale_pos_weight: 6.573064085843947
[2025-11-19 08:41:12,117] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:41:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:41:12,021] Trial 126 finished with value: 0.21377974179420395 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.18311621075798729, 'learning_rate': 0.1403140187616994, 'n_estimators': 500, 'alpha': 0.6656812824660019, 'lambda': 0.015211797615721667, 'subsample': 0.8181822900097064, 'colsample_bytree': 0.5332374020302456, 'colsample_bylevel': 0.5108734363822842, 'colsample_bynode': 0.8096308253587756, 'scale_pos_weight': 7.333360591443311}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.67440	train-auc:0.64848	train-aucpr:0.25264	val-logloss:0.66622	val-auc:0.60982	val-aucpr:0.13401
[10]	train-logloss:0.64529	train-auc:0.68113	train-aucpr:0.29163	val-logloss:0.59157	val-auc:0.67373	val-aucpr:0.20337
[20]	train-logloss:0.62918	train-auc:0.69071	train-aucpr:0.30274	val-logloss:0.55224	val-auc:0.69610	val-aucpr:0.20950
[30]	train-logloss:0.61921	train-auc:0.69783	train-aucpr:0.30962	val-logloss:0.52775	val-auc:0.69920	val-aucpr:0.20867
[40]	train-logloss:0.61268	train-auc:0.70259	train-aucpr:0.31388	val-logloss:0.52716	val-auc:0.69414	val-aucpr:0.21250
[47]	train-logloss:0.60820	train-auc:0.70762	train-aucpr:0.31896	val-logloss:0.51910	val-auc:0.69832	val-aucpr:0.20869
[2025-11-19 08:41:12,273] [INFO] [<frozen importlib] - Training completed at iteration 18
[2025-11-19 08:41:12,273] [INFO] [<frozen importlib] - Best train loss: 0.6316
[2025-11-19 08:41:12,273] [INFO] [<frozen importlib] - Best val loss: 0.5618
[2025-11-19 08:41:12,273] [INFO] [<frozen importlib] - Best val AUC: 0.6993
[2025-11-19 08:41:12,273] [INFO] [<frozen importlib] - Best val AUCPR: 0.2141
[2025-11-19 08:41:12,278] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:41:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:41:16,248] [INFO] [<frozen importlib] - Optimal threshold: 0.4745
[2025-11-19 08:41:16,248] [INFO] [<frozen importlib] - Best f1: 0.2564
[2025-11-19 08:41:16,249] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:41:16,297] [INFO] [<frozen importlib] - Validation Results (threshold=0.4745):
[2025-11-19 08:41:16,297] [INFO] [<frozen importlib] -   Accuracy: 0.8637
[2025-11-19 08:41:16,297] [INFO] [<frozen importlib] -   Precision: 0.2208
[2025-11-19 08:41:16,297] [INFO] [<frozen importlib] -   Recall: 0.3058
[2025-11-19 08:41:16,297] [INFO] [<frozen importlib] -   F1 Score: 0.2564
[2025-11-19 08:41:16,297] [INFO] [<frozen importlib] -   AUROC: 0.6993
[2025-11-19 08:41:16,297] [INFO] [<frozen importlib] -   AUPRC: 0.2144
[2025-11-19 08:41:16,297] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:41:16,297] [INFO] [<frozen importlib] -     TN=15878, FP=1567
[2025-11-19 08:41:16,297] [INFO] [<frozen importlib] -     FN=1008, TP=444
[2025-11-19 08:41:16,320] [INFO] [<frozen importlib] - Trial 127: AUPRC=0.2144, F1=0.4264, Prec=0.3430, Rec=0.5634 | Optimizing auprc=0.2144
                                                                                       Best trial: 88. Best value: 0.236742:  25%|██▌       | 127/500 [19:14<58:14,  9.37s/it]Best trial: 88. Best value: 0.236742:  25%|██▌       | 127/500 [19:14<58:14,  9.37s/it]Best trial: 88. Best value: 0.236742:  26%|██▌       | 128/500 [19:14<48:39,  7.85s/it][2025-11-19 08:41:16,330] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.189538404237861
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   gamma: 0.24002582205759232
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   alpha: 0.6018241348223965
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   lambda: 1.7105874666353735
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   learning_rate: 0.05242185960751953
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   subsample: 0.876774533222502
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   colsample_bytree: 0.9937860825577293
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5569928364185612
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   colsample_bynode: 0.737092369589783
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:41:16,330] [INFO] [<frozen importlib] -   scale_pos_weight: 6.189538404237861
[2025-11-19 08:41:16,413] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:41:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:41:16,321] Trial 127 finished with value: 0.21435493632013403 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.3023827573566335, 'learning_rate': 0.05052493333577081, 'n_estimators': 450, 'alpha': 0.7807562281339393, 'lambda': 1.8935369809600353, 'subsample': 0.8463751223878759, 'colsample_bytree': 0.5481750890223077, 'colsample_bylevel': 0.5259443437983509, 'colsample_bynode': 0.8588209655855629, 'scale_pos_weight': 6.573064085843947}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.65320	train-auc:0.65097	train-aucpr:0.23778	val-logloss:0.64130	val-auc:0.63255	val-aucpr:0.11675
[10]	train-logloss:0.62350	train-auc:0.68381	train-aucpr:0.29639	val-logloss:0.56381	val-auc:0.68559	val-aucpr:0.20033
[20]	train-logloss:0.60787	train-auc:0.69344	train-aucpr:0.30483	val-logloss:0.51973	val-auc:0.68422	val-aucpr:0.21154
[30]	train-logloss:0.59787	train-auc:0.70263	train-aucpr:0.31444	val-logloss:0.51689	val-auc:0.69127	val-aucpr:0.20678
[40]	train-logloss:0.59144	train-auc:0.70599	train-aucpr:0.31932	val-logloss:0.49050	val-auc:0.68492	val-aucpr:0.21042
[50]	train-logloss:0.58664	train-auc:0.71055	train-aucpr:0.32429	val-logloss:0.48082	val-auc:0.68038	val-aucpr:0.19916
[60]	train-logloss:0.58269	train-auc:0.71499	train-aucpr:0.32993	val-logloss:0.47197	val-auc:0.68135	val-aucpr:0.20032
[70]	train-logloss:0.57877	train-auc:0.72312	train-aucpr:0.33677	val-logloss:0.45256	val-auc:0.68631	val-aucpr:0.19472
[72]	train-logloss:0.57847	train-auc:0.72347	train-aucpr:0.33739	val-logloss:0.45160	val-auc:0.68677	val-aucpr:0.19644
[2025-11-19 08:41:16,637] [INFO] [<frozen importlib] - Training completed at iteration 42
[2025-11-19 08:41:16,637] [INFO] [<frozen importlib] - Best train loss: 0.5903
[2025-11-19 08:41:16,637] [INFO] [<frozen importlib] - Best val loss: 0.4886
[2025-11-19 08:41:16,637] [INFO] [<frozen importlib] - Best val AUC: 0.6861
[2025-11-19 08:41:16,637] [INFO] [<frozen importlib] - Best val AUCPR: 0.2128
[2025-11-19 08:41:16,642] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:41:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:41:26,433] [INFO] [<frozen importlib] - Optimal threshold: 0.4699
[2025-11-19 08:41:26,433] [INFO] [<frozen importlib] - Best f1: 0.2565
[2025-11-19 08:41:26,433] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:41:26,480] [INFO] [<frozen importlib] - Validation Results (threshold=0.4699):
[2025-11-19 08:41:26,480] [INFO] [<frozen importlib] -   Accuracy: 0.9009
[2025-11-19 08:41:26,480] [INFO] [<frozen importlib] -   Precision: 0.3027
[2025-11-19 08:41:26,480] [INFO] [<frozen importlib] -   Recall: 0.2225
[2025-11-19 08:41:26,480] [INFO] [<frozen importlib] -   F1 Score: 0.2565
[2025-11-19 08:41:26,480] [INFO] [<frozen importlib] -   AUROC: 0.6861
[2025-11-19 08:41:26,480] [INFO] [<frozen importlib] -   AUPRC: 0.2132
[2025-11-19 08:41:26,480] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:41:26,480] [INFO] [<frozen importlib] -     TN=16701, FP=744
[2025-11-19 08:41:26,480] [INFO] [<frozen importlib] -     FN=1129, TP=323
[2025-11-19 08:41:26,503] [INFO] [<frozen importlib] - Trial 128: AUPRC=0.2132, F1=0.4713, Prec=0.4764, Rec=0.4663 | Optimizing auprc=0.2132
[2025-11-19 08:41:26,503] [INFO] [<frozen importlib] - Trial 128 pruned.
[2025-11-19 08:41:26,503] [ERROR] [<frozen importlib] - Trial 128 failed with error: 
                                                                                       Best trial: 88. Best value: 0.236742:  26%|██▌       | 128/500 [19:24<48:39,  7.85s/it]Best trial: 88. Best value: 0.236742:  26%|██▌       | 128/500 [19:24<48:39,  7.85s/it]Best trial: 88. Best value: 0.236742:  26%|██▌       | 129/500 [19:24<52:51,  8.55s/it][2025-11-19 08:41:26,512] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.118383897560668
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   gamma: 0.28062956858605115
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   alpha: 0.8901729295844005
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   lambda: 1.8470780286571484
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   learning_rate: 0.04671793071806681
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   subsample: 0.8595595262428356
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   colsample_bytree: 0.5781537021920994
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5309065752570215
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   colsample_bynode: 0.770602077508236
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:41:26,512] [INFO] [<frozen importlib] -   scale_pos_weight: 7.118383897560668
[2025-11-19 08:41:26,591] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:41:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:41:26,503] Trial 128 pruned. 
[0]	train-logloss:0.70471	train-auc:0.63500	train-aucpr:0.23059	val-logloss:0.70264	val-auc:0.60626	val-aucpr:0.11507
[10]	train-logloss:0.67556	train-auc:0.68426	train-aucpr:0.28881	val-logloss:0.63072	val-auc:0.69569	val-aucpr:0.20356
[20]	train-logloss:0.65883	train-auc:0.69207	train-aucpr:0.30109	val-logloss:0.58576	val-auc:0.70654	val-aucpr:0.21995
[30]	train-logloss:0.64798	train-auc:0.69760	train-aucpr:0.30937	val-logloss:0.55574	val-auc:0.70315	val-aucpr:0.22848
[40]	train-logloss:0.64059	train-auc:0.70211	train-aucpr:0.31336	val-logloss:0.54148	val-auc:0.70819	val-aucpr:0.22408
[50]	train-logloss:0.63458	train-auc:0.70703	train-aucpr:0.31901	val-logloss:0.52927	val-auc:0.71216	val-aucpr:0.22848
[60]	train-logloss:0.63049	train-auc:0.71150	train-aucpr:0.32384	val-logloss:0.51855	val-auc:0.71186	val-aucpr:0.22834
[61]	train-logloss:0.63012	train-auc:0.71204	train-aucpr:0.32416	val-logloss:0.51629	val-auc:0.71035	val-aucpr:0.22760
[2025-11-19 08:41:26,784] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 08:41:26,784] [INFO] [<frozen importlib] - Best train loss: 0.6464
[2025-11-19 08:41:26,784] [INFO] [<frozen importlib] - Best val loss: 0.5479
[2025-11-19 08:41:26,784] [INFO] [<frozen importlib] - Best val AUC: 0.7053
[2025-11-19 08:41:26,784] [INFO] [<frozen importlib] - Best val AUCPR: 0.2313
[2025-11-19 08:41:26,790] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:41:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:41:37,129] [INFO] [<frozen importlib] - Optimal threshold: 0.4892
[2025-11-19 08:41:37,129] [INFO] [<frozen importlib] - Best f1: 0.2696
[2025-11-19 08:41:37,129] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:41:37,177] [INFO] [<frozen importlib] - Validation Results (threshold=0.4892):
[2025-11-19 08:41:37,177] [INFO] [<frozen importlib] -   Accuracy: 0.8893
[2025-11-19 08:41:37,177] [INFO] [<frozen importlib] -   Precision: 0.2736
[2025-11-19 08:41:37,177] [INFO] [<frozen importlib] -   Recall: 0.2658
[2025-11-19 08:41:37,177] [INFO] [<frozen importlib] -   F1 Score: 0.2696
[2025-11-19 08:41:37,177] [INFO] [<frozen importlib] -   AUROC: 0.7053
[2025-11-19 08:41:37,177] [INFO] [<frozen importlib] -   AUPRC: 0.2316
[2025-11-19 08:41:37,177] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:41:37,177] [INFO] [<frozen importlib] -     TN=16420, FP=1025
[2025-11-19 08:41:37,177] [INFO] [<frozen importlib] -     FN=1066, TP=386
[2025-11-19 08:41:37,200] [INFO] [<frozen importlib] - Trial 129: AUPRC=0.2316, F1=0.4416, Prec=0.4065, Rec=0.4835 | Optimizing auprc=0.2316
                                                                                       Best trial: 88. Best value: 0.236742:  26%|██▌       | 129/500 [19:35<52:51,  8.55s/it]Best trial: 88. Best value: 0.236742:  26%|██▌       | 129/500 [19:35<52:51,  8.55s/it]Best trial: 88. Best value: 0.236742:  26%|██▌       | 130/500 [19:35<56:41,  9.19s/it][2025-11-19 08:41:37,214] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.608516494193539
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   gamma: 0.27366996982541947
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   alpha: 0.4838533535516276
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   lambda: 1.8374410862450223
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   learning_rate: 0.0399209013456507
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   subsample: 0.8610325955133665
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   colsample_bytree: 0.5818100689434289
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5067941727742772
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   colsample_bynode: 0.7747446545910116
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:41:37,214] [INFO] [<frozen importlib] -   scale_pos_weight: 7.608516494193539
[2025-11-19 08:41:37,291] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:41:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:41:37,200] Trial 129 finished with value: 0.23160843689462002 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.28062956858605115, 'learning_rate': 0.04671793071806681, 'n_estimators': 450, 'alpha': 0.8901729295844005, 'lambda': 1.8470780286571484, 'subsample': 0.8595595262428356, 'colsample_bytree': 0.5781537021920994, 'colsample_bylevel': 0.5309065752570215, 'colsample_bynode': 0.770602077508236, 'scale_pos_weight': 7.118383897560668}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.73097	train-auc:0.64297	train-aucpr:0.23009	val-logloss:0.73305	val-auc:0.61123	val-aucpr:0.12733
[10]	train-logloss:0.70341	train-auc:0.68398	train-aucpr:0.28857	val-logloss:0.66078	val-auc:0.70399	val-aucpr:0.22005
[20]	train-logloss:0.68724	train-auc:0.68988	train-aucpr:0.29785	val-logloss:0.62847	val-auc:0.70091	val-aucpr:0.21779
[30]	train-logloss:0.67630	train-auc:0.69395	train-aucpr:0.30329	val-logloss:0.58833	val-auc:0.69711	val-aucpr:0.22747
[40]	train-logloss:0.66867	train-auc:0.69770	train-aucpr:0.30725	val-logloss:0.56188	val-auc:0.70099	val-aucpr:0.22548
[50]	train-logloss:0.66231	train-auc:0.70293	train-aucpr:0.31359	val-logloss:0.55674	val-auc:0.69422	val-aucpr:0.22249
[60]	train-logloss:0.65805	train-auc:0.70575	train-aucpr:0.31723	val-logloss:0.54736	val-auc:0.70117	val-aucpr:0.22278
[70]	train-logloss:0.65373	train-auc:0.71177	train-aucpr:0.32171	val-logloss:0.52098	val-auc:0.69583	val-aucpr:0.21478
[73]	train-logloss:0.65271	train-auc:0.71311	train-aucpr:0.32297	val-logloss:0.52526	val-auc:0.69326	val-aucpr:0.20816
[2025-11-19 08:41:37,513] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 08:41:37,513] [INFO] [<frozen importlib] - Best train loss: 0.6656
[2025-11-19 08:41:37,513] [INFO] [<frozen importlib] - Best val loss: 0.5619
[2025-11-19 08:41:37,513] [INFO] [<frozen importlib] - Best val AUC: 0.6992
[2025-11-19 08:41:37,513] [INFO] [<frozen importlib] - Best val AUCPR: 0.2279
[2025-11-19 08:41:37,518] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:41:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:41:47,996] [INFO] [<frozen importlib] - Optimal threshold: 0.5180
[2025-11-19 08:41:47,996] [INFO] [<frozen importlib] - Best f1: 0.2684
[2025-11-19 08:41:47,996] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:41:48,044] [INFO] [<frozen importlib] - Validation Results (threshold=0.5180):
[2025-11-19 08:41:48,044] [INFO] [<frozen importlib] -   Accuracy: 0.8950
[2025-11-19 08:41:48,044] [INFO] [<frozen importlib] -   Precision: 0.2889
[2025-11-19 08:41:48,044] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 08:41:48,044] [INFO] [<frozen importlib] -   F1 Score: 0.2684
[2025-11-19 08:41:48,044] [INFO] [<frozen importlib] -   AUROC: 0.6992
[2025-11-19 08:41:48,044] [INFO] [<frozen importlib] -   AUPRC: 0.2282
[2025-11-19 08:41:48,044] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:41:48,044] [INFO] [<frozen importlib] -     TN=16549, FP=896
[2025-11-19 08:41:48,044] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 08:41:48,067] [INFO] [<frozen importlib] - Trial 130: AUPRC=0.2282, F1=0.4634, Prec=0.4414, Rec=0.4876 | Optimizing auprc=0.2282
                                                                                       Best trial: 88. Best value: 0.236742:  26%|██▌       | 130/500 [19:46<56:41,  9.19s/it]Best trial: 88. Best value: 0.236742:  26%|██▌       | 130/500 [19:46<56:41,  9.19s/it]Best trial: 88. Best value: 0.236742:  26%|██▌       | 131/500 [19:46<59:37,  9.70s/it][2025-11-19 08:41:48,078] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.966673278381947
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   gamma: 0.402148787269791
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   alpha: 0.8949467564133108
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   lambda: 2.2529619822771743
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   learning_rate: 0.04586649993596647
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   subsample: 0.8935833896657146
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   colsample_bytree: 0.5551941075016248
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5342003013742761
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   colsample_bynode: 0.7189511753477033
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:41:48,078] [INFO] [<frozen importlib] -   scale_pos_weight: 6.966673278381947
[2025-11-19 08:41:48,154] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:41:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:41:48,068] Trial 130 finished with value: 0.22818481030025922 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.27366996982541947, 'learning_rate': 0.0399209013456507, 'n_estimators': 450, 'alpha': 0.4838533535516276, 'lambda': 1.8374410862450223, 'subsample': 0.8610325955133665, 'colsample_bytree': 0.5818100689434289, 'colsample_bylevel': 0.5067941727742772, 'colsample_bynode': 0.7747446545910116, 'scale_pos_weight': 7.608516494193539}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.69657	train-auc:0.63896	train-aucpr:0.22187	val-logloss:0.69274	val-auc:0.63563	val-aucpr:0.13337
[10]	train-logloss:0.66857	train-auc:0.68084	train-aucpr:0.28967	val-logloss:0.62412	val-auc:0.67708	val-aucpr:0.18613
[20]	train-logloss:0.65185	train-auc:0.69066	train-aucpr:0.30003	val-logloss:0.57719	val-auc:0.69973	val-aucpr:0.21374
[30]	train-logloss:0.64117	train-auc:0.69738	train-aucpr:0.30557	val-logloss:0.55171	val-auc:0.69967	val-aucpr:0.22285
[40]	train-logloss:0.63406	train-auc:0.70171	train-aucpr:0.31152	val-logloss:0.54343	val-auc:0.69962	val-aucpr:0.21941
[50]	train-logloss:0.62858	train-auc:0.70694	train-aucpr:0.31613	val-logloss:0.52951	val-auc:0.69904	val-aucpr:0.21660
[60]	train-logloss:0.62438	train-auc:0.71143	train-aucpr:0.32161	val-logloss:0.51283	val-auc:0.69785	val-aucpr:0.21599
[68]	train-logloss:0.62188	train-auc:0.71363	train-aucpr:0.32478	val-logloss:0.50639	val-auc:0.69985	val-aucpr:0.21458
[2025-11-19 08:41:48,366] [INFO] [<frozen importlib] - Training completed at iteration 38
[2025-11-19 08:41:48,366] [INFO] [<frozen importlib] - Best train loss: 0.6353
[2025-11-19 08:41:48,366] [INFO] [<frozen importlib] - Best val loss: 0.5413
[2025-11-19 08:41:48,366] [INFO] [<frozen importlib] - Best val AUC: 0.7006
[2025-11-19 08:41:48,366] [INFO] [<frozen importlib] - Best val AUCPR: 0.2249
[2025-11-19 08:41:48,371] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:41:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:41:59,150] [INFO] [<frozen importlib] - Optimal threshold: 0.5068
[2025-11-19 08:41:59,150] [INFO] [<frozen importlib] - Best f1: 0.2677
[2025-11-19 08:41:59,150] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:41:59,193] [INFO] [<frozen importlib] - Validation Results (threshold=0.5068):
[2025-11-19 08:41:59,193] [INFO] [<frozen importlib] -   Accuracy: 0.8963
[2025-11-19 08:41:59,193] [INFO] [<frozen importlib] -   Precision: 0.2927
[2025-11-19 08:41:59,193] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 08:41:59,193] [INFO] [<frozen importlib] -   F1 Score: 0.2677
[2025-11-19 08:41:59,193] [INFO] [<frozen importlib] -   AUROC: 0.7006
[2025-11-19 08:41:59,193] [INFO] [<frozen importlib] -   AUPRC: 0.2252
[2025-11-19 08:41:59,193] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:41:59,193] [INFO] [<frozen importlib] -     TN=16580, FP=865
[2025-11-19 08:41:59,193] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 08:41:59,218] [INFO] [<frozen importlib] - Trial 131: AUPRC=0.2252, F1=0.4286, Prec=0.4222, Rec=0.4353 | Optimizing auprc=0.2252
                                                                                       Best trial: 88. Best value: 0.236742:  26%|██▌       | 131/500 [19:57<59:37,  9.70s/it]Best trial: 88. Best value: 0.236742:  26%|██▌       | 131/500 [19:57<59:37,  9.70s/it]Best trial: 88. Best value: 0.236742:  26%|██▋       | 132/500 [19:57<1:02:08, 10.13s/it][2025-11-19 08:41:59,228] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.6563900175990804
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   gamma: 0.3326113419819395
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   alpha: 0.7433898162859726
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   lambda: 1.5734990171020053
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   learning_rate: 0.04255472407585307
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   subsample: 0.8711501022825608
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   colsample_bytree: 0.566688969175947
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   colsample_bylevel: 0.548461061989481
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   colsample_bynode: 0.7602864313518748
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:41:59,228] [INFO] [<frozen importlib] -   scale_pos_weight: 5.6563900175990804
[2025-11-19 08:41:59,301] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:41:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:41:59,219] Trial 131 finished with value: 0.22524877026175955 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.402148787269791, 'learning_rate': 0.04586649993596647, 'n_estimators': 450, 'alpha': 0.8949467564133108, 'lambda': 2.2529619822771743, 'subsample': 0.8935833896657146, 'colsample_bytree': 0.5551941075016248, 'colsample_bylevel': 0.5342003013742761, 'colsample_bynode': 0.7189511753477033, 'scale_pos_weight': 6.966673278381947}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.62436	train-auc:0.63672	train-aucpr:0.23590	val-logloss:0.61191	val-auc:0.60842	val-aucpr:0.11969
[10]	train-logloss:0.60089	train-auc:0.68331	train-aucpr:0.29134	val-logloss:0.55300	val-auc:0.67824	val-aucpr:0.21106
[20]	train-logloss:0.58673	train-auc:0.69096	train-aucpr:0.30071	val-logloss:0.51576	val-auc:0.68697	val-aucpr:0.22000
[30]	train-logloss:0.57783	train-auc:0.69609	train-aucpr:0.30609	val-logloss:0.50640	val-auc:0.70816	val-aucpr:0.22887
[40]	train-logloss:0.57133	train-auc:0.69952	train-aucpr:0.31052	val-logloss:0.49402	val-auc:0.70892	val-aucpr:0.22691
[50]	train-logloss:0.56594	train-auc:0.70438	train-aucpr:0.31658	val-logloss:0.48577	val-auc:0.70840	val-aucpr:0.22762
[60]	train-logloss:0.56228	train-auc:0.70904	train-aucpr:0.32117	val-logloss:0.47563	val-auc:0.70416	val-aucpr:0.22498
[70]	train-logloss:0.55922	train-auc:0.71317	train-aucpr:0.32605	val-logloss:0.48299	val-auc:0.69027	val-aucpr:0.21150
[80]	train-logloss:0.55674	train-auc:0.71714	train-aucpr:0.32978	val-logloss:0.47584	val-auc:0.69178	val-aucpr:0.21157
[85]	train-logloss:0.55518	train-auc:0.71957	train-aucpr:0.33197	val-logloss:0.47437	val-auc:0.69035	val-aucpr:0.20799
[2025-11-19 08:41:59,549] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 08:41:59,549] [INFO] [<frozen importlib] - Best train loss: 0.5638
[2025-11-19 08:41:59,549] [INFO] [<frozen importlib] - Best val loss: 0.4773
[2025-11-19 08:41:59,549] [INFO] [<frozen importlib] - Best val AUC: 0.7086
[2025-11-19 08:41:59,549] [INFO] [<frozen importlib] - Best val AUCPR: 0.2293
[2025-11-19 08:41:59,554] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:41:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:42:11,502] [INFO] [<frozen importlib] - Optimal threshold: 0.4681
[2025-11-19 08:42:11,502] [INFO] [<frozen importlib] - Best f1: 0.2817
[2025-11-19 08:42:11,502] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:42:11,547] [INFO] [<frozen importlib] - Validation Results (threshold=0.4681):
[2025-11-19 08:42:11,547] [INFO] [<frozen importlib] -   Accuracy: 0.9101
[2025-11-19 08:42:11,547] [INFO] [<frozen importlib] -   Precision: 0.3651
[2025-11-19 08:42:11,547] [INFO] [<frozen importlib] -   Recall: 0.2293
[2025-11-19 08:42:11,547] [INFO] [<frozen importlib] -   F1 Score: 0.2817
[2025-11-19 08:42:11,547] [INFO] [<frozen importlib] -   AUROC: 0.7086
[2025-11-19 08:42:11,547] [INFO] [<frozen importlib] -   AUPRC: 0.2297
[2025-11-19 08:42:11,547] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:42:11,547] [INFO] [<frozen importlib] -     TN=16866, FP=579
[2025-11-19 08:42:11,547] [INFO] [<frozen importlib] -     FN=1119, TP=333
[2025-11-19 08:42:11,570] [INFO] [<frozen importlib] - Trial 132: AUPRC=0.2297, F1=0.4526, Prec=0.5064, Rec=0.4091 | Optimizing auprc=0.2297
                                                                                         Best trial: 88. Best value: 0.236742:  26%|██▋       | 132/500 [20:09<1:02:08, 10.13s/it]Best trial: 88. Best value: 0.236742:  26%|██▋       | 132/500 [20:09<1:02:08, 10.13s/it]Best trial: 88. Best value: 0.236742:  27%|██▋       | 133/500 [20:09<1:06:02, 10.80s/it][2025-11-19 08:42:11,582] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.818729279165959
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   gamma: 0.3356105890404161
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   alpha: 0.7347066764166246
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   lambda: 1.630658222930371
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   learning_rate: 0.043019795249483087
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   subsample: 0.8684332807350181
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   colsample_bytree: 0.568897313364488
[2025-11-19 08:42:11,582] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5187452992443027
[2025-11-19 08:42:11,583] [INFO] [<frozen importlib] -   colsample_bynode: 0.7582120221441383
[2025-11-19 08:42:11,583] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:42:11,583] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:42:11,583] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:42:11,583] [INFO] [<frozen importlib] -   scale_pos_weight: 5.818729279165959
[2025-11-19 08:42:11,657] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:42:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:42:11,571] Trial 132 finished with value: 0.22965357368176095 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.3326113419819395, 'learning_rate': 0.04255472407585307, 'n_estimators': 450, 'alpha': 0.7433898162859726, 'lambda': 1.5734990171020053, 'subsample': 0.8711501022825608, 'colsample_bytree': 0.566688969175947, 'colsample_bylevel': 0.548461061989481, 'colsample_bynode': 0.7602864313518748, 'scale_pos_weight': 5.6563900175990804}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.63344	train-auc:0.63825	train-aucpr:0.22722	val-logloss:0.62228	val-auc:0.61488	val-aucpr:0.11694
[10]	train-logloss:0.60953	train-auc:0.68341	train-aucpr:0.28999	val-logloss:0.56098	val-auc:0.67719	val-aucpr:0.20248
[20]	train-logloss:0.59545	train-auc:0.69036	train-aucpr:0.29747	val-logloss:0.52235	val-auc:0.68780	val-aucpr:0.20548
[30]	train-logloss:0.58576	train-auc:0.69577	train-aucpr:0.30538	val-logloss:0.50812	val-auc:0.70355	val-aucpr:0.21857
[40]	train-logloss:0.57966	train-auc:0.69864	train-aucpr:0.30918	val-logloss:0.49231	val-auc:0.70196	val-aucpr:0.21837
[50]	train-logloss:0.57435	train-auc:0.70445	train-aucpr:0.31484	val-logloss:0.48483	val-auc:0.70244	val-aucpr:0.21815
[58]	train-logloss:0.57123	train-auc:0.70875	train-aucpr:0.31823	val-logloss:0.48150	val-auc:0.69917	val-aucpr:0.21148
[2025-11-19 08:42:11,844] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:42:11,844] [INFO] [<frozen importlib] - Best train loss: 0.5866
[2025-11-19 08:42:11,844] [INFO] [<frozen importlib] - Best val loss: 0.5008
[2025-11-19 08:42:11,844] [INFO] [<frozen importlib] - Best val AUC: 0.7043
[2025-11-19 08:42:11,844] [INFO] [<frozen importlib] - Best val AUCPR: 0.2190
[2025-11-19 08:42:11,849] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:42:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:42:20,158] [INFO] [<frozen importlib] - Optimal threshold: 0.4448
[2025-11-19 08:42:20,159] [INFO] [<frozen importlib] - Best f1: 0.2658
[2025-11-19 08:42:20,159] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:42:20,202] [INFO] [<frozen importlib] - Validation Results (threshold=0.4448):
[2025-11-19 08:42:20,202] [INFO] [<frozen importlib] -   Accuracy: 0.8772
[2025-11-19 08:42:20,202] [INFO] [<frozen importlib] -   Precision: 0.2459
[2025-11-19 08:42:20,202] [INFO] [<frozen importlib] -   Recall: 0.2893
[2025-11-19 08:42:20,202] [INFO] [<frozen importlib] -   F1 Score: 0.2658
[2025-11-19 08:42:20,202] [INFO] [<frozen importlib] -   AUROC: 0.7043
[2025-11-19 08:42:20,202] [INFO] [<frozen importlib] -   AUPRC: 0.2194
[2025-11-19 08:42:20,202] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:42:20,202] [INFO] [<frozen importlib] -     TN=16157, FP=1288
[2025-11-19 08:42:20,202] [INFO] [<frozen importlib] -     FN=1032, TP=420
[2025-11-19 08:42:20,224] [INFO] [<frozen importlib] - Trial 133: AUPRC=0.2194, F1=0.4472, Prec=0.3799, Rec=0.5434 | Optimizing auprc=0.2194
[2025-11-19 08:42:20,224] [INFO] [<frozen importlib] - Trial 133 pruned.
[2025-11-19 08:42:20,224] [ERROR] [<frozen importlib] - Trial 133 failed with error: 
                                                                                         Best trial: 88. Best value: 0.236742:  27%|██▋       | 133/500 [20:18<1:06:02, 10.80s/it]Best trial: 88. Best value: 0.236742:  27%|██▋       | 133/500 [20:18<1:06:02, 10.80s/it]Best trial: 88. Best value: 0.236742:  27%|██▋       | 134/500 [20:18<1:01:56, 10.15s/it][2025-11-19 08:42:20,233] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.0064138980761825
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   gamma: 0.28092349119286164
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   alpha: 0.8608859149514633
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   lambda: 1.7404395443569767
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   learning_rate: 0.04682212361300299
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   subsample: 0.9034648008570566
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   colsample_bytree: 0.5115640722541587
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5277470940241916
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   colsample_bynode: 0.7704274133690627
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:42:20,233] [INFO] [<frozen importlib] -   scale_pos_weight: 5.0064138980761825
[2025-11-19 08:42:20,307] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:42:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:42:20,224] Trial 133 pruned. 
[0]	train-logloss:0.58699	train-auc:0.63782	train-aucpr:0.23981	val-logloss:0.56857	val-auc:0.65171	val-aucpr:0.13717
[10]	train-logloss:0.56473	train-auc:0.68172	train-aucpr:0.29029	val-logloss:0.52778	val-auc:0.67844	val-aucpr:0.19957
[20]	train-logloss:0.55148	train-auc:0.68863	train-aucpr:0.29723	val-logloss:0.48697	val-auc:0.69009	val-aucpr:0.21253
[30]	train-logloss:0.54267	train-auc:0.69408	train-aucpr:0.30510	val-logloss:0.45995	val-auc:0.70431	val-aucpr:0.21858
[40]	train-logloss:0.53616	train-auc:0.70097	train-aucpr:0.31197	val-logloss:0.45178	val-auc:0.69544	val-aucpr:0.20224
[50]	train-logloss:0.53155	train-auc:0.70647	train-aucpr:0.31728	val-logloss:0.44643	val-auc:0.69507	val-aucpr:0.20097
[60]	train-logloss:0.52824	train-auc:0.71040	train-aucpr:0.32235	val-logloss:0.43941	val-auc:0.69928	val-aucpr:0.21075
[64]	train-logloss:0.52699	train-auc:0.71213	train-aucpr:0.32449	val-logloss:0.44030	val-auc:0.69342	val-aucpr:0.20343
[2025-11-19 08:42:20,501] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:42:20,501] [INFO] [<frozen importlib] - Best train loss: 0.5397
[2025-11-19 08:42:20,501] [INFO] [<frozen importlib] - Best val loss: 0.4535
[2025-11-19 08:42:20,501] [INFO] [<frozen importlib] - Best val AUC: 0.7075
[2025-11-19 08:42:20,501] [INFO] [<frozen importlib] - Best val AUCPR: 0.2211
[2025-11-19 08:42:20,505] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:42:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:42:30,225] [INFO] [<frozen importlib] - Optimal threshold: 0.4121
[2025-11-19 08:42:30,225] [INFO] [<frozen importlib] - Best f1: 0.2676
[2025-11-19 08:42:30,225] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:42:30,269] [INFO] [<frozen importlib] - Validation Results (threshold=0.4121):
[2025-11-19 08:42:30,269] [INFO] [<frozen importlib] -   Accuracy: 0.8842
[2025-11-19 08:42:30,269] [INFO] [<frozen importlib] -   Precision: 0.2602
[2025-11-19 08:42:30,269] [INFO] [<frozen importlib] -   Recall: 0.2755
[2025-11-19 08:42:30,269] [INFO] [<frozen importlib] -   F1 Score: 0.2676
[2025-11-19 08:42:30,269] [INFO] [<frozen importlib] -   AUROC: 0.7075
[2025-11-19 08:42:30,269] [INFO] [<frozen importlib] -   AUPRC: 0.2215
[2025-11-19 08:42:30,269] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:42:30,269] [INFO] [<frozen importlib] -     TN=16308, FP=1137
[2025-11-19 08:42:30,269] [INFO] [<frozen importlib] -     FN=1052, TP=400
[2025-11-19 08:42:30,293] [INFO] [<frozen importlib] - Trial 134: AUPRC=0.2215, F1=0.4483, Prec=0.3968, Rec=0.5152 | Optimizing auprc=0.2215
[2025-11-19 08:42:30,294] [INFO] [<frozen importlib] - Trial 134 pruned.
[2025-11-19 08:42:30,294] [ERROR] [<frozen importlib] - Trial 134 failed with error: 
                                                                                         Best trial: 88. Best value: 0.236742:  27%|██▋       | 134/500 [20:28<1:01:56, 10.15s/it]Best trial: 88. Best value: 0.236742:  27%|██▋       | 134/500 [20:28<1:01:56, 10.15s/it]Best trial: 88. Best value: 0.236742:  27%|██▋       | 135/500 [20:28<1:01:37, 10.13s/it][2025-11-19 08:42:30,303] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.659619241219951
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   gamma: 0.35689334851722704
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   alpha: 0.8022727101574694
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   lambda: 1.4458626935645886
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   learning_rate: 0.036942118837412906
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   subsample: 0.8547206427658939
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   colsample_bytree: 0.5999964500076347
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5426671425340599
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   colsample_bynode: 0.7431655445115359
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:42:30,303] [INFO] [<frozen importlib] -   scale_pos_weight: 6.659619241219951
[2025-11-19 08:42:30,378] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:42:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:42:30,294] Trial 134 pruned. 
[0]	train-logloss:0.68104	train-auc:0.62857	train-aucpr:0.22239	val-logloss:0.67801	val-auc:0.60581	val-aucpr:0.09833
[10]	train-logloss:0.65719	train-auc:0.68155	train-aucpr:0.28766	val-logloss:0.62872	val-auc:0.67957	val-aucpr:0.19144
[20]	train-logloss:0.64211	train-auc:0.68897	train-aucpr:0.29974	val-logloss:0.59777	val-auc:0.68150	val-aucpr:0.20106
[30]	train-logloss:0.63168	train-auc:0.69287	train-aucpr:0.30454	val-logloss:0.56259	val-auc:0.69523	val-aucpr:0.21392
[40]	train-logloss:0.62423	train-auc:0.69811	train-aucpr:0.30970	val-logloss:0.54541	val-auc:0.70517	val-aucpr:0.22063
[50]	train-logloss:0.61839	train-auc:0.70193	train-aucpr:0.31403	val-logloss:0.53022	val-auc:0.71118	val-aucpr:0.22500
[60]	train-logloss:0.61451	train-auc:0.70484	train-aucpr:0.31686	val-logloss:0.52123	val-auc:0.70669	val-aucpr:0.22701
[70]	train-logloss:0.61105	train-auc:0.70914	train-aucpr:0.32055	val-logloss:0.51197	val-auc:0.70301	val-aucpr:0.21751
[80]	train-logloss:0.60806	train-auc:0.71260	train-aucpr:0.32503	val-logloss:0.50276	val-auc:0.69460	val-aucpr:0.21097
[85]	train-logloss:0.60667	train-auc:0.71384	train-aucpr:0.32623	val-logloss:0.51100	val-auc:0.69176	val-aucpr:0.20299
[2025-11-19 08:42:30,623] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 08:42:30,623] [INFO] [<frozen importlib] - Best train loss: 0.6162
[2025-11-19 08:42:30,623] [INFO] [<frozen importlib] - Best val loss: 0.5247
[2025-11-19 08:42:30,623] [INFO] [<frozen importlib] - Best val AUC: 0.7073
[2025-11-19 08:42:30,623] [INFO] [<frozen importlib] - Best val AUCPR: 0.2277
[2025-11-19 08:42:30,628] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:42:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:42:41,904] [INFO] [<frozen importlib] - Optimal threshold: 0.4778
[2025-11-19 08:42:41,905] [INFO] [<frozen importlib] - Best f1: 0.2793
[2025-11-19 08:42:41,905] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:42:41,961] [INFO] [<frozen importlib] - Validation Results (threshold=0.4778):
[2025-11-19 08:42:41,961] [INFO] [<frozen importlib] -   Accuracy: 0.8984
[2025-11-19 08:42:41,961] [INFO] [<frozen importlib] -   Precision: 0.3069
[2025-11-19 08:42:41,961] [INFO] [<frozen importlib] -   Recall: 0.2562
[2025-11-19 08:42:41,961] [INFO] [<frozen importlib] -   F1 Score: 0.2793
[2025-11-19 08:42:41,961] [INFO] [<frozen importlib] -   AUROC: 0.7073
[2025-11-19 08:42:41,961] [INFO] [<frozen importlib] -   AUPRC: 0.2282
[2025-11-19 08:42:41,961] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:42:41,961] [INFO] [<frozen importlib] -     TN=16605, FP=840
[2025-11-19 08:42:41,961] [INFO] [<frozen importlib] -     FN=1080, TP=372
[2025-11-19 08:42:41,988] [INFO] [<frozen importlib] - Trial 135: AUPRC=0.2282, F1=0.4435, Prec=0.4374, Rec=0.4497 | Optimizing auprc=0.2282
                                                                                         Best trial: 88. Best value: 0.236742:  27%|██▋       | 135/500 [20:39<1:01:37, 10.13s/it]Best trial: 88. Best value: 0.236742:  27%|██▋       | 135/500 [20:39<1:01:37, 10.13s/it]Best trial: 88. Best value: 0.236742:  27%|██▋       | 136/500 [20:39<1:04:17, 10.60s/it][2025-11-19 08:42:42,003] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.092559129580367
[2025-11-19 08:42:42,003] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:42:42,003] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:42:42,003] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:42:42,003] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   gamma: 0.256962324740063
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   alpha: 0.9345743490530876
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   lambda: 1.9144585702832608
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   learning_rate: 0.04133225682002682
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   subsample: 0.7627871065017625
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   colsample_bytree: 0.5247260790414482
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   colsample_bylevel: 0.560117179053181
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   colsample_bynode: 0.7529721271360956
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:42:42,004] [INFO] [<frozen importlib] -   scale_pos_weight: 7.092559129580367
[2025-11-19 08:42:42,077] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:42:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:42:41,988] Trial 135 finished with value: 0.22817519332364036 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.35689334851722704, 'learning_rate': 0.036942118837412906, 'n_estimators': 500, 'alpha': 0.8022727101574694, 'lambda': 1.4458626935645886, 'subsample': 0.8547206427658939, 'colsample_bytree': 0.5999964500076347, 'colsample_bylevel': 0.5426671425340599, 'colsample_bynode': 0.7431655445115359, 'scale_pos_weight': 6.659619241219951}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.70379	train-auc:0.63424	train-aucpr:0.22986	val-logloss:0.70246	val-auc:0.63871	val-aucpr:0.14614
[10]	train-logloss:0.67735	train-auc:0.68307	train-aucpr:0.28621	val-logloss:0.65043	val-auc:0.68074	val-aucpr:0.19931
[20]	train-logloss:0.66115	train-auc:0.68882	train-aucpr:0.30253	val-logloss:0.61534	val-auc:0.71043	val-aucpr:0.22073
[30]	train-logloss:0.65075	train-auc:0.69266	train-aucpr:0.30665	val-logloss:0.58397	val-auc:0.68934	val-aucpr:0.22176
[40]	train-logloss:0.64279	train-auc:0.69838	train-aucpr:0.31199	val-logloss:0.57205	val-auc:0.70100	val-aucpr:0.23014
[50]	train-logloss:0.63722	train-auc:0.70304	train-aucpr:0.31605	val-logloss:0.55760	val-auc:0.69812	val-aucpr:0.22916
[60]	train-logloss:0.63298	train-auc:0.70714	train-aucpr:0.31978	val-logloss:0.55201	val-auc:0.69424	val-aucpr:0.22677
[66]	train-logloss:0.63059	train-auc:0.70967	train-aucpr:0.32228	val-logloss:0.53213	val-auc:0.68824	val-aucpr:0.22419
[2025-11-19 08:42:42,277] [INFO] [<frozen importlib] - Training completed at iteration 37
[2025-11-19 08:42:42,277] [INFO] [<frozen importlib] - Best train loss: 0.6451
[2025-11-19 08:42:42,277] [INFO] [<frozen importlib] - Best val loss: 0.5693
[2025-11-19 08:42:42,277] [INFO] [<frozen importlib] - Best val AUC: 0.7026
[2025-11-19 08:42:42,277] [INFO] [<frozen importlib] - Best val AUCPR: 0.2304
[2025-11-19 08:42:42,282] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:42:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:42:51,492] [INFO] [<frozen importlib] - Optimal threshold: 0.5058
[2025-11-19 08:42:51,492] [INFO] [<frozen importlib] - Best f1: 0.2766
[2025-11-19 08:42:51,492] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:42:51,536] [INFO] [<frozen importlib] - Validation Results (threshold=0.5058):
[2025-11-19 08:42:51,536] [INFO] [<frozen importlib] -   Accuracy: 0.8893
[2025-11-19 08:42:51,536] [INFO] [<frozen importlib] -   Precision: 0.2778
[2025-11-19 08:42:51,536] [INFO] [<frozen importlib] -   Recall: 0.2755
[2025-11-19 08:42:51,536] [INFO] [<frozen importlib] -   F1 Score: 0.2766
[2025-11-19 08:42:51,536] [INFO] [<frozen importlib] -   AUROC: 0.7026
[2025-11-19 08:42:51,536] [INFO] [<frozen importlib] -   AUPRC: 0.2307
[2025-11-19 08:42:51,536] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:42:51,536] [INFO] [<frozen importlib] -     TN=16405, FP=1040
[2025-11-19 08:42:51,536] [INFO] [<frozen importlib] -     FN=1052, TP=400
[2025-11-19 08:42:51,559] [INFO] [<frozen importlib] - Trial 136: AUPRC=0.2307, F1=0.4435, Prec=0.4057, Rec=0.4890 | Optimizing auprc=0.2307
                                                                                         Best trial: 88. Best value: 0.236742:  27%|██▋       | 136/500 [20:49<1:04:17, 10.60s/it]Best trial: 88. Best value: 0.236742:  27%|██▋       | 136/500 [20:49<1:04:17, 10.60s/it]Best trial: 88. Best value: 0.236742:  27%|██▋       | 137/500 [20:49<1:02:15, 10.29s/it][2025-11-19 08:42:51,573] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.161546879091032
[2025-11-19 08:42:51,573] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:42:51,573] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   gamma: 0.25192925738139926
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   alpha: 0.8775629789707958
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   lambda: 2.172903740941216
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   learning_rate: 0.041479044479489434
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   subsample: 0.7837621999980358
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   colsample_bytree: 0.619564278126983
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5946522854643127
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   colsample_bynode: 0.7502964352874878
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:42:51,574] [INFO] [<frozen importlib] -   scale_pos_weight: 7.161546879091032
[2025-11-19 08:42:51,650] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:42:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:42:51,559] Trial 136 finished with value: 0.23074585668514336 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.256962324740063, 'learning_rate': 0.04133225682002682, 'n_estimators': 450, 'alpha': 0.9345743490530876, 'lambda': 1.9144585702832608, 'subsample': 0.7627871065017625, 'colsample_bytree': 0.5247260790414482, 'colsample_bylevel': 0.560117179053181, 'colsample_bynode': 0.7529721271360956, 'scale_pos_weight': 7.092559129580367}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.70721	train-auc:0.64250	train-aucpr:0.23162	val-logloss:0.70517	val-auc:0.60169	val-aucpr:0.12029
[10]	train-logloss:0.67965	train-auc:0.67953	train-aucpr:0.29270	val-logloss:0.63068	val-auc:0.70055	val-aucpr:0.20342
[20]	train-logloss:0.66344	train-auc:0.68824	train-aucpr:0.30087	val-logloss:0.58153	val-auc:0.69610	val-aucpr:0.21546
[30]	train-logloss:0.65255	train-auc:0.69612	train-aucpr:0.30823	val-logloss:0.55454	val-auc:0.69949	val-aucpr:0.22542
[40]	train-logloss:0.64528	train-auc:0.69942	train-aucpr:0.31227	val-logloss:0.53169	val-auc:0.69717	val-aucpr:0.22499
[50]	train-logloss:0.63898	train-auc:0.70575	train-aucpr:0.31805	val-logloss:0.52138	val-auc:0.68927	val-aucpr:0.21695
[60]	train-logloss:0.63460	train-auc:0.71046	train-aucpr:0.32131	val-logloss:0.51491	val-auc:0.69030	val-aucpr:0.21642
[2025-11-19 08:42:51,835] [INFO] [<frozen importlib] - Training completed at iteration 30
[2025-11-19 08:42:51,835] [INFO] [<frozen importlib] - Best train loss: 0.6525
[2025-11-19 08:42:51,835] [INFO] [<frozen importlib] - Best val loss: 0.5545
[2025-11-19 08:42:51,835] [INFO] [<frozen importlib] - Best val AUC: 0.6995
[2025-11-19 08:42:51,835] [INFO] [<frozen importlib] - Best val AUCPR: 0.2254
[2025-11-19 08:42:51,840] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:42:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:42:58,761] [INFO] [<frozen importlib] - Optimal threshold: 0.5124
[2025-11-19 08:42:58,761] [INFO] [<frozen importlib] - Best f1: 0.2636
[2025-11-19 08:42:58,761] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:42:58,815] [INFO] [<frozen importlib] - Validation Results (threshold=0.5124):
[2025-11-19 08:42:58,815] [INFO] [<frozen importlib] -   Accuracy: 0.9013
[2025-11-19 08:42:58,815] [INFO] [<frozen importlib] -   Precision: 0.3087
[2025-11-19 08:42:58,815] [INFO] [<frozen importlib] -   Recall: 0.2300
[2025-11-19 08:42:58,815] [INFO] [<frozen importlib] -   F1 Score: 0.2636
[2025-11-19 08:42:58,815] [INFO] [<frozen importlib] -   AUROC: 0.6995
[2025-11-19 08:42:58,815] [INFO] [<frozen importlib] -   AUPRC: 0.2257
[2025-11-19 08:42:58,815] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:42:58,815] [INFO] [<frozen importlib] -     TN=16697, FP=748
[2025-11-19 08:42:58,815] [INFO] [<frozen importlib] -     FN=1118, TP=334
[2025-11-19 08:42:58,837] [INFO] [<frozen importlib] - Trial 137: AUPRC=0.2257, F1=0.4605, Prec=0.4680, Rec=0.4532 | Optimizing auprc=0.2257
[2025-11-19 08:42:58,837] [INFO] [<frozen importlib] - Trial 137 pruned.
[2025-11-19 08:42:58,837] [ERROR] [<frozen importlib] - Trial 137 failed with error: 
                                                                                         Best trial: 88. Best value: 0.236742:  27%|██▋       | 137/500 [20:56<1:02:15, 10.29s/it]Best trial: 88. Best value: 0.236742:  27%|██▋       | 137/500 [20:56<1:02:15, 10.29s/it]Best trial: 88. Best value: 0.236742:  28%|██▊       | 138/500 [20:56<56:37,  9.39s/it]  [2025-11-19 08:42:58,846] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.043497883894059
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   gamma: 0.29284144543204504
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   alpha: 0.9351118499792279
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   lambda: 1.5731003967063575
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   learning_rate: 0.04024825309367351
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   subsample: 0.7600702757451973
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   colsample_bytree: 0.5879173507155179
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5643015813640213
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   colsample_bynode: 0.7256779111148028
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:42:58,846] [INFO] [<frozen importlib] -   scale_pos_weight: 8.043497883894059
[2025-11-19 08:42:58,923] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:42:58] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:42:58,837] Trial 137 pruned. 
[0]	train-logloss:0.75312	train-auc:0.64346	train-aucpr:0.22535	val-logloss:0.75661	val-auc:0.62293	val-aucpr:0.12150
[10]	train-logloss:0.72375	train-auc:0.68169	train-aucpr:0.28874	val-logloss:0.68447	val-auc:0.66218	val-aucpr:0.17661
[20]	train-logloss:0.70696	train-auc:0.68865	train-aucpr:0.29604	val-logloss:0.65336	val-auc:0.68350	val-aucpr:0.20962
[30]	train-logloss:0.69565	train-auc:0.69246	train-aucpr:0.30164	val-logloss:0.61006	val-auc:0.70282	val-aucpr:0.22465
[40]	train-logloss:0.68782	train-auc:0.69903	train-aucpr:0.30741	val-logloss:0.58737	val-auc:0.70140	val-aucpr:0.22634
[50]	train-logloss:0.68099	train-auc:0.70477	train-aucpr:0.31450	val-logloss:0.56608	val-auc:0.69832	val-aucpr:0.22407
[60]	train-logloss:0.67637	train-auc:0.70721	train-aucpr:0.31786	val-logloss:0.56011	val-auc:0.70154	val-aucpr:0.23040
[70]	train-logloss:0.67261	train-auc:0.71114	train-aucpr:0.32289	val-logloss:0.54535	val-auc:0.68514	val-aucpr:0.21655
[80]	train-logloss:0.66895	train-auc:0.71455	train-aucpr:0.32738	val-logloss:0.53532	val-auc:0.68401	val-aucpr:0.21651
[90]	train-logloss:0.66608	train-auc:0.71890	train-aucpr:0.33108	val-logloss:0.52253	val-auc:0.68166	val-aucpr:0.20308
[2025-11-19 08:42:59,182] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:42:59,182] [INFO] [<frozen importlib] - Best train loss: 0.6764
[2025-11-19 08:42:59,182] [INFO] [<frozen importlib] - Best val loss: 0.5601
[2025-11-19 08:42:59,182] [INFO] [<frozen importlib] - Best val AUC: 0.7015
[2025-11-19 08:42:59,182] [INFO] [<frozen importlib] - Best val AUCPR: 0.2304
[2025-11-19 08:42:59,187] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:42:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:43:12,731] [INFO] [<frozen importlib] - Optimal threshold: 0.5282
[2025-11-19 08:43:12,731] [INFO] [<frozen importlib] - Best f1: 0.2822
[2025-11-19 08:43:12,731] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:43:12,785] [INFO] [<frozen importlib] - Validation Results (threshold=0.5282):
[2025-11-19 08:43:12,785] [INFO] [<frozen importlib] -   Accuracy: 0.9050
[2025-11-19 08:43:12,785] [INFO] [<frozen importlib] -   Precision: 0.3362
[2025-11-19 08:43:12,785] [INFO] [<frozen importlib] -   Recall: 0.2431
[2025-11-19 08:43:12,785] [INFO] [<frozen importlib] -   F1 Score: 0.2822
[2025-11-19 08:43:12,785] [INFO] [<frozen importlib] -   AUROC: 0.7015
[2025-11-19 08:43:12,785] [INFO] [<frozen importlib] -   AUPRC: 0.2307
[2025-11-19 08:43:12,785] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:43:12,785] [INFO] [<frozen importlib] -     TN=16748, FP=697
[2025-11-19 08:43:12,785] [INFO] [<frozen importlib] -     FN=1099, TP=353
[2025-11-19 08:43:12,808] [INFO] [<frozen importlib] - Trial 138: AUPRC=0.2307, F1=0.4489, Prec=0.4716, Rec=0.4284 | Optimizing auprc=0.2307
                                                                                       Best trial: 88. Best value: 0.236742:  28%|██▊       | 138/500 [21:10<56:37,  9.39s/it]Best trial: 88. Best value: 0.236742:  28%|██▊       | 138/500 [21:10<56:37,  9.39s/it]Best trial: 88. Best value: 0.236742:  28%|██▊       | 139/500 [21:10<1:04:45, 10.76s/it][2025-11-19 08:43:12,817] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.133070886838386
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   gamma: 0.2973733140474368
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   alpha: 0.8309391822796264
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   lambda: 1.5835880163284042
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   learning_rate: 0.03605820570423612
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   subsample: 0.7665196995424339
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   colsample_bytree: 0.5910402351263773
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5725383726758809
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   colsample_bynode: 0.6970128042926119
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:43:12,817] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:43:12,818] [INFO] [<frozen importlib] -   scale_pos_weight: 8.133070886838386
[2025-11-19 08:43:12,892] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:43:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:43:12,808] Trial 138 finished with value: 0.23074134676581473 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.29284144543204504, 'learning_rate': 0.04024825309367351, 'n_estimators': 400, 'alpha': 0.9351118499792279, 'lambda': 1.5731003967063575, 'subsample': 0.7600702757451973, 'colsample_bytree': 0.5879173507155179, 'colsample_bylevel': 0.5643015813640213, 'colsample_bynode': 0.7256779111148028, 'scale_pos_weight': 8.043497883894059}. Best is trial 88 with value: 0.23674240239886388.
[0]	train-logloss:0.75803	train-auc:0.64245	train-aucpr:0.22715	val-logloss:0.76338	val-auc:0.62149	val-aucpr:0.12197
[10]	train-logloss:0.73170	train-auc:0.67683	train-aucpr:0.28724	val-logloss:0.70179	val-auc:0.66666	val-aucpr:0.16966
[20]	train-logloss:0.71458	train-auc:0.68808	train-aucpr:0.29798	val-logloss:0.66339	val-auc:0.68836	val-aucpr:0.20987
[30]	train-logloss:0.70274	train-auc:0.69427	train-aucpr:0.30216	val-logloss:0.62510	val-auc:0.69137	val-aucpr:0.21712
[40]	train-logloss:0.69500	train-auc:0.69789	train-aucpr:0.30531	val-logloss:0.59532	val-auc:0.70215	val-aucpr:0.22290
[50]	train-logloss:0.68786	train-auc:0.70377	train-aucpr:0.31159	val-logloss:0.57808	val-auc:0.70980	val-aucpr:0.22221
[60]	train-logloss:0.68319	train-auc:0.70658	train-aucpr:0.31470	val-logloss:0.57466	val-auc:0.70679	val-aucpr:0.22282
[67]	train-logloss:0.68037	train-auc:0.70926	train-aucpr:0.31851	val-logloss:0.57486	val-auc:0.70176	val-aucpr:0.21621
[2025-11-19 08:43:13,095] [INFO] [<frozen importlib] - Training completed at iteration 37
[2025-11-19 08:43:13,095] [INFO] [<frozen importlib] - Best train loss: 0.6972
[2025-11-19 08:43:13,095] [INFO] [<frozen importlib] - Best val loss: 0.6040
[2025-11-19 08:43:13,095] [INFO] [<frozen importlib] - Best val AUC: 0.7037
[2025-11-19 08:43:13,095] [INFO] [<frozen importlib] - Best val AUCPR: 0.2239
[2025-11-19 08:43:13,099] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:43:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:43:22,420] [INFO] [<frozen importlib] - Optimal threshold: 0.5462
[2025-11-19 08:43:22,420] [INFO] [<frozen importlib] - Best f1: 0.2734
[2025-11-19 08:43:22,420] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:43:22,469] [INFO] [<frozen importlib] - Validation Results (threshold=0.5462):
[2025-11-19 08:43:22,469] [INFO] [<frozen importlib] -   Accuracy: 0.9058
[2025-11-19 08:43:22,469] [INFO] [<frozen importlib] -   Precision: 0.3353
[2025-11-19 08:43:22,469] [INFO] [<frozen importlib] -   Recall: 0.2307
[2025-11-19 08:43:22,470] [INFO] [<frozen importlib] -   F1 Score: 0.2734
[2025-11-19 08:43:22,470] [INFO] [<frozen importlib] -   AUROC: 0.7037
[2025-11-19 08:43:22,470] [INFO] [<frozen importlib] -   AUPRC: 0.2243
[2025-11-19 08:43:22,470] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:43:22,470] [INFO] [<frozen importlib] -     TN=16781, FP=664
[2025-11-19 08:43:22,470] [INFO] [<frozen importlib] -     FN=1117, TP=335
[2025-11-19 08:43:22,493] [INFO] [<frozen importlib] - Trial 139: AUPRC=0.2243, F1=0.4498, Prec=0.4804, Rec=0.4229 | Optimizing auprc=0.2243
[2025-11-19 08:43:22,493] [INFO] [<frozen importlib] - Trial 139 pruned.
[2025-11-19 08:43:22,493] [ERROR] [<frozen importlib] - Trial 139 failed with error: 
                                                                                         Best trial: 88. Best value: 0.236742:  28%|██▊       | 139/500 [21:20<1:04:45, 10.76s/it]Best trial: 88. Best value: 0.236742:  28%|██▊       | 139/500 [21:20<1:04:45, 10.76s/it]Best trial: 88. Best value: 0.236742:  28%|██▊       | 140/500 [21:20<1:02:37, 10.44s/it][2025-11-19 08:43:22,502] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.561749907659935
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   gamma: 0.3254123404906592
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   alpha: 0.9562881843292422
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   lambda: 1.2580870311139578
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   learning_rate: 0.03859551262225236
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   subsample: 0.7983206837614771
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   colsample_bytree: 0.5812176765334321
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5612515124282439
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   colsample_bynode: 0.7127049668129265
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:43:22,503] [INFO] [<frozen importlib] -   scale_pos_weight: 7.561749907659935
[2025-11-19 08:43:22,574] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:43:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:43:22,493] Trial 139 pruned. 
[0]	train-logloss:0.72853	train-auc:0.64399	train-aucpr:0.21918	val-logloss:0.73119	val-auc:0.62075	val-aucpr:0.12472
[10]	train-logloss:0.70168	train-auc:0.67861	train-aucpr:0.28822	val-logloss:0.65906	val-auc:0.69411	val-aucpr:0.20361
[20]	train-logloss:0.68560	train-auc:0.68875	train-aucpr:0.29646	val-logloss:0.61831	val-auc:0.69987	val-aucpr:0.21134
[30]	train-logloss:0.67467	train-auc:0.69584	train-aucpr:0.30217	val-logloss:0.59360	val-auc:0.69959	val-aucpr:0.21498
[40]	train-logloss:0.66710	train-auc:0.70057	train-aucpr:0.30654	val-logloss:0.57872	val-auc:0.70395	val-aucpr:0.21387
[50]	train-logloss:0.66079	train-auc:0.70416	train-aucpr:0.31247	val-logloss:0.56040	val-auc:0.70866	val-aucpr:0.22422
[60]	train-logloss:0.65587	train-auc:0.70786	train-aucpr:0.31695	val-logloss:0.55255	val-auc:0.70498	val-aucpr:0.22918
[70]	train-logloss:0.65208	train-auc:0.71197	train-aucpr:0.32153	val-logloss:0.55077	val-auc:0.70873	val-aucpr:0.23120
[80]	train-logloss:0.64864	train-auc:0.71527	train-aucpr:0.32600	val-logloss:0.54603	val-auc:0.71028	val-aucpr:0.23626
[90]	train-logloss:0.64576	train-auc:0.71840	train-aucpr:0.32943	val-logloss:0.54837	val-auc:0.71007	val-aucpr:0.23186
[100]	train-logloss:0.64298	train-auc:0.72326	train-aucpr:0.33359	val-logloss:0.53491	val-auc:0.70734	val-aucpr:0.22797
[110]	train-logloss:0.64033	train-auc:0.72633	train-aucpr:0.33744	val-logloss:0.52265	val-auc:0.70695	val-aucpr:0.22862
[113]	train-logloss:0.63934	train-auc:0.72772	train-aucpr:0.33916	val-logloss:0.51783	val-auc:0.70176	val-aucpr:0.22146
[2025-11-19 08:43:22,885] [INFO] [<frozen importlib] - Training completed at iteration 83
[2025-11-19 08:43:22,885] [INFO] [<frozen importlib] - Best train loss: 0.6476
[2025-11-19 08:43:22,885] [INFO] [<frozen importlib] - Best val loss: 0.5495
[2025-11-19 08:43:22,885] [INFO] [<frozen importlib] - Best val AUC: 0.7115
[2025-11-19 08:43:22,885] [INFO] [<frozen importlib] - Best val AUCPR: 0.2371
[2025-11-19 08:43:22,890] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:43:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:43:36,997] [INFO] [<frozen importlib] - Optimal threshold: 0.5238
[2025-11-19 08:43:36,997] [INFO] [<frozen importlib] - Best f1: 0.2809
[2025-11-19 08:43:36,997] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:43:37,046] [INFO] [<frozen importlib] - Validation Results (threshold=0.5238):
[2025-11-19 08:43:37,046] [INFO] [<frozen importlib] -   Accuracy: 0.8914
[2025-11-19 08:43:37,046] [INFO] [<frozen importlib] -   Precision: 0.2858
[2025-11-19 08:43:37,046] [INFO] [<frozen importlib] -   Recall: 0.2762
[2025-11-19 08:43:37,046] [INFO] [<frozen importlib] -   F1 Score: 0.2809
[2025-11-19 08:43:37,046] [INFO] [<frozen importlib] -   AUROC: 0.7115
[2025-11-19 08:43:37,046] [INFO] [<frozen importlib] -   AUPRC: 0.2375
[2025-11-19 08:43:37,046] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:43:37,046] [INFO] [<frozen importlib] -     TN=16443, FP=1002
[2025-11-19 08:43:37,046] [INFO] [<frozen importlib] -     FN=1051, TP=401
[2025-11-19 08:43:37,069] [INFO] [<frozen importlib] - Trial 140: AUPRC=0.2375, F1=0.4619, Prec=0.4238, Rec=0.5076 | Optimizing auprc=0.2375
[2025-11-19 08:43:37,069] [INFO] [<frozen importlib] -   → New best model found! (value=0.2375)
                                                                                         Best trial: 88. Best value: 0.236742:  28%|██▊       | 140/500 [21:35<1:02:37, 10.44s/it]Best trial: 140. Best value: 0.237476:  28%|██▊       | 140/500 [21:35<1:02:37, 10.44s/it]Best trial: 140. Best value: 0.237476:  28%|██▊       | 141/500 [21:35<1:09:53, 11.68s/it][2025-11-19 08:43:37,085] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.7639148740364
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   gamma: 0.3261876904983494
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   alpha: 0.929621199582972
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   lambda: 1.4225137988118846
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   learning_rate: 0.038598258216850284
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   subsample: 0.7976993922495275
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   colsample_bytree: 0.6052286095378188
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5857999990929614
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   colsample_bynode: 0.7220202374407768
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:43:37,085] [INFO] [<frozen importlib] -   scale_pos_weight: 7.7639148740364
[2025-11-19 08:43:37,159] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:43:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:43:37,069] Trial 140 finished with value: 0.23747621706147465 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.3254123404906592, 'learning_rate': 0.03859551262225236, 'n_estimators': 500, 'alpha': 0.9562881843292422, 'lambda': 1.2580870311139578, 'subsample': 0.7983206837614771, 'colsample_bytree': 0.5812176765334321, 'colsample_bylevel': 0.5612515124282439, 'colsample_bynode': 0.7127049668129265, 'scale_pos_weight': 7.561749907659935}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.73904	train-auc:0.64139	train-aucpr:0.23337	val-logloss:0.74053	val-auc:0.62814	val-aucpr:0.14300
[10]	train-logloss:0.71192	train-auc:0.67686	train-aucpr:0.28730	val-logloss:0.67144	val-auc:0.67686	val-aucpr:0.19812
[20]	train-logloss:0.69508	train-auc:0.68994	train-aucpr:0.29655	val-logloss:0.62264	val-auc:0.68845	val-aucpr:0.20841
[30]	train-logloss:0.68393	train-auc:0.69421	train-aucpr:0.30273	val-logloss:0.58675	val-auc:0.69737	val-aucpr:0.21636
[40]	train-logloss:0.67606	train-auc:0.69828	train-aucpr:0.30699	val-logloss:0.56618	val-auc:0.70146	val-aucpr:0.21980
[50]	train-logloss:0.66963	train-auc:0.70302	train-aucpr:0.31139	val-logloss:0.55547	val-auc:0.69881	val-aucpr:0.21966
[60]	train-logloss:0.66519	train-auc:0.70628	train-aucpr:0.31598	val-logloss:0.55360	val-auc:0.70083	val-aucpr:0.21992
[70]	train-logloss:0.66120	train-auc:0.70987	train-aucpr:0.32003	val-logloss:0.54209	val-auc:0.70032	val-aucpr:0.21352
[78]	train-logloss:0.65844	train-auc:0.71302	train-aucpr:0.32313	val-logloss:0.53786	val-auc:0.69797	val-aucpr:0.20787
[2025-11-19 08:43:37,387] [INFO] [<frozen importlib] - Training completed at iteration 48
[2025-11-19 08:43:37,387] [INFO] [<frozen importlib] - Best train loss: 0.6706
[2025-11-19 08:43:37,387] [INFO] [<frozen importlib] - Best val loss: 0.5588
[2025-11-19 08:43:37,387] [INFO] [<frozen importlib] - Best val AUC: 0.7031
[2025-11-19 08:43:37,387] [INFO] [<frozen importlib] - Best val AUCPR: 0.2233
[2025-11-19 08:43:37,392] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:43:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:43:47,433] [INFO] [<frozen importlib] - Optimal threshold: 0.5083
[2025-11-19 08:43:47,433] [INFO] [<frozen importlib] - Best f1: 0.2798
[2025-11-19 08:43:47,433] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:43:47,479] [INFO] [<frozen importlib] - Validation Results (threshold=0.5083):
[2025-11-19 08:43:47,479] [INFO] [<frozen importlib] -   Accuracy: 0.8946
[2025-11-19 08:43:47,479] [INFO] [<frozen importlib] -   Precision: 0.2945
[2025-11-19 08:43:47,479] [INFO] [<frozen importlib] -   Recall: 0.2665
[2025-11-19 08:43:47,479] [INFO] [<frozen importlib] -   F1 Score: 0.2798
[2025-11-19 08:43:47,479] [INFO] [<frozen importlib] -   AUROC: 0.7031
[2025-11-19 08:43:47,479] [INFO] [<frozen importlib] -   AUPRC: 0.2240
[2025-11-19 08:43:47,479] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:43:47,479] [INFO] [<frozen importlib] -     TN=16518, FP=927
[2025-11-19 08:43:47,479] [INFO] [<frozen importlib] -     FN=1065, TP=387
[2025-11-19 08:43:47,509] [INFO] [<frozen importlib] - Trial 141: AUPRC=0.2240, F1=0.4374, Prec=0.4181, Rec=0.4587 | Optimizing auprc=0.2240
                                                                                          Best trial: 140. Best value: 0.237476:  28%|██▊       | 141/500 [21:45<1:09:53, 11.68s/it]Best trial: 140. Best value: 0.237476:  28%|██▊       | 141/500 [21:45<1:09:53, 11.68s/it]Best trial: 140. Best value: 0.237476:  28%|██▊       | 142/500 [21:45<1:07:28, 11.31s/it][2025-11-19 08:43:47,518] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.502328503485785
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   gamma: 0.3779344653666093
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   alpha: 0.9855487846838232
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   lambda: 1.2460060025123807
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   learning_rate: 0.04020559498998731
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   subsample: 0.8201178292602374
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   colsample_bytree: 0.5653821638250504
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5635717640601885
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   colsample_bynode: 0.7120532084524069
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:43:47,518] [INFO] [<frozen importlib] -   scale_pos_weight: 7.502328503485785
[2025-11-19 08:43:47,592] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:43:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:43:47,509] Trial 141 finished with value: 0.22395830721625967 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.3261876904983494, 'learning_rate': 0.038598258216850284, 'n_estimators': 500, 'alpha': 0.929621199582972, 'lambda': 1.4225137988118846, 'subsample': 0.7976993922495275, 'colsample_bytree': 0.6052286095378188, 'colsample_bylevel': 0.5857999990929614, 'colsample_bynode': 0.7220202374407768, 'scale_pos_weight': 7.7639148740364}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.72525	train-auc:0.64633	train-aucpr:0.23059	val-logloss:0.72568	val-auc:0.62852	val-aucpr:0.12610
[10]	train-logloss:0.69856	train-auc:0.68335	train-aucpr:0.28871	val-logloss:0.66682	val-auc:0.68223	val-aucpr:0.19723
[20]	train-logloss:0.68206	train-auc:0.68850	train-aucpr:0.29545	val-logloss:0.62219	val-auc:0.70264	val-aucpr:0.20756
[30]	train-logloss:0.67111	train-auc:0.69500	train-aucpr:0.30463	val-logloss:0.59485	val-auc:0.69727	val-aucpr:0.21571
[40]	train-logloss:0.66327	train-auc:0.69957	train-aucpr:0.30878	val-logloss:0.57416	val-auc:0.69339	val-aucpr:0.21249
[50]	train-logloss:0.65707	train-auc:0.70300	train-aucpr:0.31353	val-logloss:0.55116	val-auc:0.69810	val-aucpr:0.22173
[60]	train-logloss:0.65269	train-auc:0.70772	train-aucpr:0.31725	val-logloss:0.53912	val-auc:0.70055	val-aucpr:0.22371
[70]	train-logloss:0.64908	train-auc:0.71127	train-aucpr:0.32048	val-logloss:0.53149	val-auc:0.70043	val-aucpr:0.21990
[80]	train-logloss:0.64585	train-auc:0.71529	train-aucpr:0.32475	val-logloss:0.51954	val-auc:0.69920	val-aucpr:0.22042
[87]	train-logloss:0.64390	train-auc:0.71783	train-aucpr:0.32685	val-logloss:0.52168	val-auc:0.69583	val-aucpr:0.21613
[2025-11-19 08:43:47,843] [INFO] [<frozen importlib] - Training completed at iteration 57
[2025-11-19 08:43:47,843] [INFO] [<frozen importlib] - Best train loss: 0.6542
[2025-11-19 08:43:47,843] [INFO] [<frozen importlib] - Best val loss: 0.5419
[2025-11-19 08:43:47,843] [INFO] [<frozen importlib] - Best val AUC: 0.7014
[2025-11-19 08:43:47,843] [INFO] [<frozen importlib] - Best val AUCPR: 0.2241
[2025-11-19 08:43:47,848] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:43:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:44:00,641] [INFO] [<frozen importlib] - Optimal threshold: 0.5104
[2025-11-19 08:44:00,642] [INFO] [<frozen importlib] - Best f1: 0.2740
[2025-11-19 08:44:00,642] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:44:00,688] [INFO] [<frozen importlib] - Validation Results (threshold=0.5104):
[2025-11-19 08:44:00,688] [INFO] [<frozen importlib] -   Accuracy: 0.8990
[2025-11-19 08:44:00,688] [INFO] [<frozen importlib] -   Precision: 0.3061
[2025-11-19 08:44:00,688] [INFO] [<frozen importlib] -   Recall: 0.2479
[2025-11-19 08:44:00,688] [INFO] [<frozen importlib] -   F1 Score: 0.2740
[2025-11-19 08:44:00,688] [INFO] [<frozen importlib] -   AUROC: 0.7014
[2025-11-19 08:44:00,688] [INFO] [<frozen importlib] -   AUPRC: 0.2244
[2025-11-19 08:44:00,688] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:44:00,688] [INFO] [<frozen importlib] -     TN=16629, FP=816
[2025-11-19 08:44:00,688] [INFO] [<frozen importlib] -     FN=1092, TP=360
[2025-11-19 08:44:00,713] [INFO] [<frozen importlib] - Trial 142: AUPRC=0.2244, F1=0.4529, Prec=0.4486, Rec=0.4573 | Optimizing auprc=0.2244
                                                                                          Best trial: 140. Best value: 0.237476:  28%|██▊       | 142/500 [21:58<1:07:28, 11.31s/it]Best trial: 140. Best value: 0.237476:  28%|██▊       | 142/500 [21:58<1:07:28, 11.31s/it]Best trial: 140. Best value: 0.237476:  29%|██▊       | 143/500 [21:58<1:10:40, 11.88s/it][2025-11-19 08:44:00,736] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.806019136071913
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   gamma: 0.3435467727081737
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   alpha: 1.126973095393294
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   lambda: 1.7601736663190481
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   learning_rate: 0.044224548251180315
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   subsample: 0.7584806334003281
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   colsample_bytree: 0.5833037220467552
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   colsample_bylevel: 0.552018175371993
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   colsample_bynode: 0.7333085654611092
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:44:00,736] [INFO] [<frozen importlib] -   scale_pos_weight: 6.806019136071913
[2025-11-19 08:44:00,813] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:44:00] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:44:00,713] Trial 142 finished with value: 0.2244476188314142 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.3779344653666093, 'learning_rate': 0.04020559498998731, 'n_estimators': 500, 'alpha': 0.9855487846838232, 'lambda': 1.2460060025123807, 'subsample': 0.8201178292602374, 'colsample_bytree': 0.5653821638250504, 'colsample_bylevel': 0.5635717640601885, 'colsample_bynode': 0.7120532084524069, 'scale_pos_weight': 7.502328503485785}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.68792	train-auc:0.63773	train-aucpr:0.22648	val-logloss:0.68430	val-auc:0.58648	val-aucpr:0.10221
[10]	train-logloss:0.66047	train-auc:0.68169	train-aucpr:0.29024	val-logloss:0.60998	val-auc:0.69319	val-aucpr:0.21654
[20]	train-logloss:0.64485	train-auc:0.69001	train-aucpr:0.29915	val-logloss:0.56713	val-auc:0.69866	val-aucpr:0.21814
[30]	train-logloss:0.63429	train-auc:0.69575	train-aucpr:0.30572	val-logloss:0.55505	val-auc:0.70412	val-aucpr:0.21710
[40]	train-logloss:0.62718	train-auc:0.70198	train-aucpr:0.31124	val-logloss:0.53795	val-auc:0.70963	val-aucpr:0.22088
[50]	train-logloss:0.62128	train-auc:0.70667	train-aucpr:0.31742	val-logloss:0.52936	val-auc:0.71406	val-aucpr:0.22566
[60]	train-logloss:0.61699	train-auc:0.71037	train-aucpr:0.32154	val-logloss:0.52153	val-auc:0.71057	val-aucpr:0.22759
[70]	train-logloss:0.61355	train-auc:0.71497	train-aucpr:0.32636	val-logloss:0.52323	val-auc:0.71058	val-aucpr:0.22290
[80]	train-logloss:0.61020	train-auc:0.71918	train-aucpr:0.33126	val-logloss:0.51882	val-auc:0.71279	val-aucpr:0.22664
[84]	train-logloss:0.60926	train-auc:0.72058	train-aucpr:0.33237	val-logloss:0.51899	val-auc:0.70558	val-aucpr:0.21810
[2025-11-19 08:44:01,059] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 08:44:01,059] [INFO] [<frozen importlib] - Best train loss: 0.6194
[2025-11-19 08:44:01,059] [INFO] [<frozen importlib] - Best val loss: 0.5205
[2025-11-19 08:44:01,059] [INFO] [<frozen importlib] - Best val AUC: 0.7136
[2025-11-19 08:44:01,059] [INFO] [<frozen importlib] - Best val AUCPR: 0.2293
[2025-11-19 08:44:01,064] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:44:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:44:13,241] [INFO] [<frozen importlib] - Optimal threshold: 0.5020
[2025-11-19 08:44:13,241] [INFO] [<frozen importlib] - Best f1: 0.2674
[2025-11-19 08:44:13,241] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:44:13,289] [INFO] [<frozen importlib] - Validation Results (threshold=0.5020):
[2025-11-19 08:44:13,289] [INFO] [<frozen importlib] -   Accuracy: 0.8907
[2025-11-19 08:44:13,289] [INFO] [<frozen importlib] -   Precision: 0.2756
[2025-11-19 08:44:13,289] [INFO] [<frozen importlib] -   Recall: 0.2596
[2025-11-19 08:44:13,289] [INFO] [<frozen importlib] -   F1 Score: 0.2674
[2025-11-19 08:44:13,289] [INFO] [<frozen importlib] -   AUROC: 0.7136
[2025-11-19 08:44:13,289] [INFO] [<frozen importlib] -   AUPRC: 0.2297
[2025-11-19 08:44:13,289] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:44:13,289] [INFO] [<frozen importlib] -     TN=16454, FP=991
[2025-11-19 08:44:13,289] [INFO] [<frozen importlib] -     FN=1075, TP=377
[2025-11-19 08:44:13,312] [INFO] [<frozen importlib] - Trial 143: AUPRC=0.2297, F1=0.4274, Prec=0.4012, Rec=0.4573 | Optimizing auprc=0.2297
                                                                                          Best trial: 140. Best value: 0.237476:  29%|██▊       | 143/500 [22:11<1:10:40, 11.88s/it]Best trial: 140. Best value: 0.237476:  29%|██▊       | 143/500 [22:11<1:10:40, 11.88s/it]Best trial: 140. Best value: 0.237476:  29%|██▉       | 144/500 [22:11<1:11:45, 12.09s/it][2025-11-19 08:44:13,323] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.813664133900415
[2025-11-19 08:44:13,323] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:44:13,323] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:44:13,323] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:44:13,323] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:44:13,323] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:44:13,323] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   gamma: 0.34884258411001384
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   alpha: 0.9343173011817546
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   lambda: 1.9797617078107308
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   learning_rate: 0.04479700539438954
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   subsample: 0.7516273628922491
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   colsample_bytree: 0.5781329004657219
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5506132643574408
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   colsample_bynode: 0.7314693555807015
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:44:13,324] [INFO] [<frozen importlib] -   scale_pos_weight: 6.813664133900415
[2025-11-19 08:44:13,399] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:44:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:44:13,313] Trial 143 finished with value: 0.22965285066624 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.3435467727081737, 'learning_rate': 0.044224548251180315, 'n_estimators': 500, 'alpha': 1.126973095393294, 'lambda': 1.7601736663190481, 'subsample': 0.7584806334003281, 'colsample_bytree': 0.5833037220467552, 'colsample_bylevel': 0.552018175371993, 'colsample_bynode': 0.7333085654611092, 'scale_pos_weight': 6.806019136071913}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.68836	train-auc:0.63582	train-aucpr:0.22926	val-logloss:0.68365	val-auc:0.60917	val-aucpr:0.11741
[10]	train-logloss:0.66033	train-auc:0.68290	train-aucpr:0.29121	val-logloss:0.61610	val-auc:0.70911	val-aucpr:0.22360
[20]	train-logloss:0.64458	train-auc:0.68925	train-aucpr:0.30294	val-logloss:0.57819	val-auc:0.71063	val-aucpr:0.22183
[30]	train-logloss:0.63407	train-auc:0.69609	train-aucpr:0.30803	val-logloss:0.55867	val-auc:0.71412	val-aucpr:0.22475
[35]	train-logloss:0.63018	train-auc:0.69784	train-aucpr:0.31100	val-logloss:0.54005	val-auc:0.71456	val-aucpr:0.22685
[2025-11-19 08:44:13,531] [INFO] [<frozen importlib] - Training completed at iteration 6
[2025-11-19 08:44:13,531] [INFO] [<frozen importlib] - Best train loss: 0.6700
[2025-11-19 08:44:13,531] [INFO] [<frozen importlib] - Best val loss: 0.6363
[2025-11-19 08:44:13,531] [INFO] [<frozen importlib] - Best val AUC: 0.7183
[2025-11-19 08:44:13,531] [INFO] [<frozen importlib] - Best val AUCPR: 0.2274
[2025-11-19 08:44:13,536] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:44:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:44:14,365] [INFO] [<frozen importlib] - Optimal threshold: 0.4932
[2025-11-19 08:44:14,365] [INFO] [<frozen importlib] - Best f1: 0.2705
[2025-11-19 08:44:14,365] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:44:14,407] [INFO] [<frozen importlib] - Validation Results (threshold=0.4932):
[2025-11-19 08:44:14,407] [INFO] [<frozen importlib] -   Accuracy: 0.8784
[2025-11-19 08:44:14,407] [INFO] [<frozen importlib] -   Precision: 0.2509
[2025-11-19 08:44:14,407] [INFO] [<frozen importlib] -   Recall: 0.2934
[2025-11-19 08:44:14,407] [INFO] [<frozen importlib] -   F1 Score: 0.2705
[2025-11-19 08:44:14,407] [INFO] [<frozen importlib] -   AUROC: 0.7183
[2025-11-19 08:44:14,407] [INFO] [<frozen importlib] -   AUPRC: 0.2222
[2025-11-19 08:44:14,407] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:44:14,407] [INFO] [<frozen importlib] -     TN=16173, FP=1272
[2025-11-19 08:44:14,407] [INFO] [<frozen importlib] -     FN=1026, TP=426
[2025-11-19 08:44:14,434] [INFO] [<frozen importlib] - Trial 144: AUPRC=0.2222, F1=0.4492, Prec=0.3828, Rec=0.5434 | Optimizing auprc=0.2222
                                                                                          Best trial: 140. Best value: 0.237476:  29%|██▉       | 144/500 [22:12<1:11:45, 12.09s/it]Best trial: 140. Best value: 0.237476:  29%|██▉       | 144/500 [22:12<1:11:45, 12.09s/it]Best trial: 140. Best value: 0.237476:  29%|██▉       | 145/500 [22:12<52:04,  8.80s/it]  [2025-11-19 08:44:14,443] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.284015411955716
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   gamma: 0.41151468395994234
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   alpha: 1.1038703086917838
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   lambda: 1.780871647229604
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   learning_rate: 0.04361247921830704
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   subsample: 0.7639539799343994
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   colsample_bytree: 0.6279797749221275
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5665053112611619
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   colsample_bynode: 0.7010822896442698
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:44:14,443] [INFO] [<frozen importlib] -   scale_pos_weight: 7.284015411955716
[2025-11-19 08:44:14,515] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:44:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:44:14,434] Trial 144 finished with value: 0.22220945159682223 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.34884258411001384, 'learning_rate': 0.04479700539438954, 'n_estimators': 500, 'alpha': 0.9343173011817546, 'lambda': 1.9797617078107308, 'subsample': 0.7516273628922491, 'colsample_bytree': 0.5781329004657219, 'colsample_bylevel': 0.5506132643574408, 'colsample_bynode': 0.7314693555807015, 'scale_pos_weight': 6.813664133900415}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.71316	train-auc:0.65230	train-aucpr:0.24793	val-logloss:0.71265	val-auc:0.53382	val-aucpr:0.08083
[10]	train-logloss:0.68469	train-auc:0.68204	train-aucpr:0.29473	val-logloss:0.63860	val-auc:0.66805	val-aucpr:0.18290
[20]	train-logloss:0.66841	train-auc:0.69150	train-aucpr:0.29912	val-logloss:0.59082	val-auc:0.68585	val-aucpr:0.19518
[30]	train-logloss:0.65728	train-auc:0.69891	train-aucpr:0.30868	val-logloss:0.56041	val-auc:0.67158	val-aucpr:0.19904
[40]	train-logloss:0.65004	train-auc:0.70346	train-aucpr:0.31130	val-logloss:0.54747	val-auc:0.67919	val-aucpr:0.20635
[50]	train-logloss:0.64375	train-auc:0.70887	train-aucpr:0.31705	val-logloss:0.53865	val-auc:0.68835	val-aucpr:0.20611
[60]	train-logloss:0.63904	train-auc:0.71241	train-aucpr:0.32173	val-logloss:0.53330	val-auc:0.69641	val-aucpr:0.21393
[70]	train-logloss:0.63551	train-auc:0.71566	train-aucpr:0.32537	val-logloss:0.52522	val-auc:0.69321	val-aucpr:0.21166
[80]	train-logloss:0.63283	train-auc:0.71897	train-aucpr:0.32847	val-logloss:0.51761	val-auc:0.69436	val-aucpr:0.21101
[85]	train-logloss:0.63138	train-auc:0.72054	train-aucpr:0.33057	val-logloss:0.51533	val-auc:0.69787	val-aucpr:0.21065
[2025-11-19 08:44:14,760] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 08:44:14,760] [INFO] [<frozen importlib] - Best train loss: 0.6409
[2025-11-19 08:44:14,760] [INFO] [<frozen importlib] - Best val loss: 0.5327
[2025-11-19 08:44:14,760] [INFO] [<frozen importlib] - Best val AUC: 0.6938
[2025-11-19 08:44:14,760] [INFO] [<frozen importlib] - Best val AUCPR: 0.2146
[2025-11-19 08:44:14,766] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:44:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:44:27,872] [INFO] [<frozen importlib] - Optimal threshold: 0.5216
[2025-11-19 08:44:27,872] [INFO] [<frozen importlib] - Best f1: 0.2664
[2025-11-19 08:44:27,872] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:44:27,915] [INFO] [<frozen importlib] - Validation Results (threshold=0.5216):
[2025-11-19 08:44:27,915] [INFO] [<frozen importlib] -   Accuracy: 0.8968
[2025-11-19 08:44:27,915] [INFO] [<frozen importlib] -   Precision: 0.2935
[2025-11-19 08:44:27,915] [INFO] [<frozen importlib] -   Recall: 0.2438
[2025-11-19 08:44:27,915] [INFO] [<frozen importlib] -   F1 Score: 0.2664
[2025-11-19 08:44:27,915] [INFO] [<frozen importlib] -   AUROC: 0.6938
[2025-11-19 08:44:27,915] [INFO] [<frozen importlib] -   AUPRC: 0.2149
[2025-11-19 08:44:27,915] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:44:27,915] [INFO] [<frozen importlib] -     TN=16593, FP=852
[2025-11-19 08:44:27,915] [INFO] [<frozen importlib] -     FN=1098, TP=354
[2025-11-19 08:44:27,938] [INFO] [<frozen importlib] - Trial 145: AUPRC=0.2149, F1=0.4469, Prec=0.4376, Rec=0.4566 | Optimizing auprc=0.2149
[2025-11-19 08:44:27,938] [INFO] [<frozen importlib] - Trial 145 pruned.
[2025-11-19 08:44:27,938] [ERROR] [<frozen importlib] - Trial 145 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  29%|██▉       | 145/500 [22:25<52:04,  8.80s/it]Best trial: 140. Best value: 0.237476:  29%|██▉       | 145/500 [22:25<52:04,  8.80s/it]Best trial: 140. Best value: 0.237476:  29%|██▉       | 146/500 [22:25<1:00:15, 10.21s/it][2025-11-19 08:44:27,953] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.91377958385365
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   gamma: 0.30250030489693636
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   alpha: 1.1242030976972073
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   lambda: 1.5406549943189283
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   learning_rate: 0.03940205507109272
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   subsample: 0.7770623255958713
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   colsample_bytree: 0.5933020977867666
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5769943476909966
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   colsample_bynode: 0.6897674713896836
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:44:27,953] [INFO] [<frozen importlib] -   scale_pos_weight: 7.91377958385365
[2025-11-19 08:44:28,028] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:44:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:44:27,938] Trial 145 pruned. 
[0]	train-logloss:0.74691	train-auc:0.63654	train-aucpr:0.23336	val-logloss:0.74964	val-auc:0.59441	val-aucpr:0.12170
[10]	train-logloss:0.71831	train-auc:0.68455	train-aucpr:0.29189	val-logloss:0.69589	val-auc:0.66018	val-aucpr:0.17726
[20]	train-logloss:0.70146	train-auc:0.69170	train-aucpr:0.29819	val-logloss:0.65613	val-auc:0.68913	val-aucpr:0.20021
[30]	train-logloss:0.68996	train-auc:0.69657	train-aucpr:0.30296	val-logloss:0.61765	val-auc:0.69703	val-aucpr:0.21916
[40]	train-logloss:0.68192	train-auc:0.70051	train-aucpr:0.30866	val-logloss:0.59912	val-auc:0.70406	val-aucpr:0.22124
[50]	train-logloss:0.67539	train-auc:0.70421	train-aucpr:0.31263	val-logloss:0.59258	val-auc:0.70390	val-aucpr:0.22145
[60]	train-logloss:0.67108	train-auc:0.70744	train-aucpr:0.31680	val-logloss:0.57940	val-auc:0.70444	val-aucpr:0.22572
[70]	train-logloss:0.66744	train-auc:0.71149	train-aucpr:0.32093	val-logloss:0.57482	val-auc:0.70417	val-aucpr:0.22369
[80]	train-logloss:0.66378	train-auc:0.71517	train-aucpr:0.32542	val-logloss:0.56942	val-auc:0.69997	val-aucpr:0.21429
[90]	train-logloss:0.66099	train-auc:0.71891	train-aucpr:0.32880	val-logloss:0.56801	val-auc:0.69389	val-aucpr:0.20471
[91]	train-logloss:0.66079	train-auc:0.71953	train-aucpr:0.32915	val-logloss:0.56584	val-auc:0.69344	val-aucpr:0.20407
[2025-11-19 08:44:28,291] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 08:44:28,291] [INFO] [<frozen importlib] - Best train loss: 0.6703
[2025-11-19 08:44:28,291] [INFO] [<frozen importlib] - Best val loss: 0.5746
[2025-11-19 08:44:28,291] [INFO] [<frozen importlib] - Best val AUC: 0.7063
[2025-11-19 08:44:28,291] [INFO] [<frozen importlib] - Best val AUCPR: 0.2269
[2025-11-19 08:44:28,295] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:44:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:44:41,496] [INFO] [<frozen importlib] - Optimal threshold: 0.5288
[2025-11-19 08:44:41,496] [INFO] [<frozen importlib] - Best f1: 0.2761
[2025-11-19 08:44:41,496] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:44:41,546] [INFO] [<frozen importlib] - Validation Results (threshold=0.5288):
[2025-11-19 08:44:41,546] [INFO] [<frozen importlib] -   Accuracy: 0.8929
[2025-11-19 08:44:41,546] [INFO] [<frozen importlib] -   Precision: 0.2872
[2025-11-19 08:44:41,546] [INFO] [<frozen importlib] -   Recall: 0.2658
[2025-11-19 08:44:41,546] [INFO] [<frozen importlib] -   F1 Score: 0.2761
[2025-11-19 08:44:41,546] [INFO] [<frozen importlib] -   AUROC: 0.7063
[2025-11-19 08:44:41,546] [INFO] [<frozen importlib] -   AUPRC: 0.2273
[2025-11-19 08:44:41,546] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:44:41,546] [INFO] [<frozen importlib] -     TN=16487, FP=958
[2025-11-19 08:44:41,546] [INFO] [<frozen importlib] -     FN=1066, TP=386
[2025-11-19 08:44:41,568] [INFO] [<frozen importlib] - Trial 146: AUPRC=0.2273, F1=0.4531, Prec=0.4243, Rec=0.4862 | Optimizing auprc=0.2273
                                                                                          Best trial: 140. Best value: 0.237476:  29%|██▉       | 146/500 [22:39<1:00:15, 10.21s/it]Best trial: 140. Best value: 0.237476:  29%|██▉       | 146/500 [22:39<1:00:15, 10.21s/it]Best trial: 140. Best value: 0.237476:  29%|██▉       | 147/500 [22:39<1:06:06, 11.24s/it][2025-11-19 08:44:41,579] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.070479737032163
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   gamma: 0.339443063267389
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   alpha: 0.8919669310219163
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   lambda: 1.6907972048075104
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   learning_rate: 0.04265408853359138
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   subsample: 0.9230426239770543
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   colsample_bytree: 0.6124519494690605
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5528135988658024
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   colsample_bynode: 0.7128847639751358
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:44:41,579] [INFO] [<frozen importlib] -   scale_pos_weight: 7.070479737032163
[2025-11-19 08:44:41,657] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:44:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:44:41,569] Trial 146 finished with value: 0.2272500931602069 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.30250030489693636, 'learning_rate': 0.03940205507109272, 'n_estimators': 500, 'alpha': 1.1242030976972073, 'lambda': 1.5406549943189283, 'subsample': 0.7770623255958713, 'colsample_bytree': 0.5933020977867666, 'colsample_bylevel': 0.5769943476909966, 'colsample_bynode': 0.6897674713896836, 'scale_pos_weight': 7.91377958385365}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.70207	train-auc:0.65225	train-aucpr:0.23689	val-logloss:0.69918	val-auc:0.60296	val-aucpr:0.10121
[10]	train-logloss:0.67436	train-auc:0.68429	train-aucpr:0.29201	val-logloss:0.62827	val-auc:0.69429	val-aucpr:0.19009
[20]	train-logloss:0.65833	train-auc:0.69162	train-aucpr:0.30015	val-logloss:0.59429	val-auc:0.69751	val-aucpr:0.20790
[30]	train-logloss:0.64763	train-auc:0.69613	train-aucpr:0.30716	val-logloss:0.56554	val-auc:0.69931	val-aucpr:0.21382
[40]	train-logloss:0.64029	train-auc:0.69998	train-aucpr:0.31222	val-logloss:0.54323	val-auc:0.70024	val-aucpr:0.21581
[50]	train-logloss:0.63480	train-auc:0.70337	train-aucpr:0.31658	val-logloss:0.54067	val-auc:0.70061	val-aucpr:0.21566
[60]	train-logloss:0.63053	train-auc:0.70863	train-aucpr:0.32130	val-logloss:0.53810	val-auc:0.69141	val-aucpr:0.20980
[63]	train-logloss:0.62936	train-auc:0.71047	train-aucpr:0.32277	val-logloss:0.53598	val-auc:0.69107	val-aucpr:0.21109
[2025-11-19 08:44:41,848] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:44:41,848] [INFO] [<frozen importlib] - Best train loss: 0.6444
[2025-11-19 08:44:41,848] [INFO] [<frozen importlib] - Best val loss: 0.5530
[2025-11-19 08:44:41,848] [INFO] [<frozen importlib] - Best val AUC: 0.6980
[2025-11-19 08:44:41,848] [INFO] [<frozen importlib] - Best val AUCPR: 0.2174
[2025-11-19 08:44:41,853] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:44:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:44:48,452] [INFO] [<frozen importlib] - Optimal threshold: 0.5025
[2025-11-19 08:44:48,452] [INFO] [<frozen importlib] - Best f1: 0.2632
[2025-11-19 08:44:48,452] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:44:48,500] [INFO] [<frozen importlib] - Validation Results (threshold=0.5025):
[2025-11-19 08:44:48,500] [INFO] [<frozen importlib] -   Accuracy: 0.8984
[2025-11-19 08:44:48,500] [INFO] [<frozen importlib] -   Precision: 0.2972
[2025-11-19 08:44:48,500] [INFO] [<frozen importlib] -   Recall: 0.2362
[2025-11-19 08:44:48,500] [INFO] [<frozen importlib] -   F1 Score: 0.2632
[2025-11-19 08:44:48,500] [INFO] [<frozen importlib] -   AUROC: 0.6980
[2025-11-19 08:44:48,500] [INFO] [<frozen importlib] -   AUPRC: 0.2178
[2025-11-19 08:44:48,500] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:44:48,500] [INFO] [<frozen importlib] -     TN=16634, FP=811
[2025-11-19 08:44:48,500] [INFO] [<frozen importlib] -     FN=1109, TP=343
[2025-11-19 08:44:48,523] [INFO] [<frozen importlib] - Trial 147: AUPRC=0.2178, F1=0.4312, Prec=0.4341, Rec=0.4284 | Optimizing auprc=0.2178
[2025-11-19 08:44:48,524] [INFO] [<frozen importlib] - Trial 147 pruned.
[2025-11-19 08:44:48,524] [ERROR] [<frozen importlib] - Trial 147 failed with error: 
                                                                                          Best trial: 140. Best value: 0.237476:  29%|██▉       | 147/500 [22:46<1:06:06, 11.24s/it]Best trial: 140. Best value: 0.237476:  29%|██▉       | 147/500 [22:46<1:06:06, 11.24s/it]Best trial: 140. Best value: 0.237476:  30%|██▉       | 148/500 [22:46<58:23,  9.95s/it]  [2025-11-19 08:44:48,535] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.742392683805129
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   gamma: 0.23738485882345814
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   alpha: 1.0772065915494133
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   lambda: 1.9020383813709087
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   learning_rate: 0.07264326726228074
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   subsample: 0.7593884819183857
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   colsample_bytree: 0.5774862608754032
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5375292746421465
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   colsample_bynode: 0.7353071788147908
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:44:48,535] [INFO] [<frozen importlib] -   scale_pos_weight: 6.742392683805129
[2025-11-19 08:44:48,604] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:44:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:44:48,524] Trial 147 pruned. 
[0]	train-logloss:0.68239	train-auc:0.63666	train-aucpr:0.22684	val-logloss:0.67511	val-auc:0.59230	val-aucpr:0.11660
[10]	train-logloss:0.64474	train-auc:0.68585	train-aucpr:0.29463	val-logloss:0.58650	val-auc:0.70019	val-aucpr:0.22274
[20]	train-logloss:0.62800	train-auc:0.69638	train-aucpr:0.30819	val-logloss:0.55411	val-auc:0.70578	val-aucpr:0.22955
[30]	train-logloss:0.61784	train-auc:0.70580	train-aucpr:0.31699	val-logloss:0.54408	val-auc:0.69278	val-aucpr:0.20557
[40]	train-logloss:0.61098	train-auc:0.71423	train-aucpr:0.32478	val-logloss:0.50962	val-auc:0.69552	val-aucpr:0.21246
[50]	train-logloss:0.60540	train-auc:0.72108	train-aucpr:0.33146	val-logloss:0.47484	val-auc:0.69233	val-aucpr:0.20811
[2025-11-19 08:44:48,765] [INFO] [<frozen importlib] - Training completed at iteration 20
[2025-11-19 08:44:48,765] [INFO] [<frozen importlib] - Best train loss: 0.6280
[2025-11-19 08:44:48,765] [INFO] [<frozen importlib] - Best val loss: 0.5541
[2025-11-19 08:44:48,765] [INFO] [<frozen importlib] - Best val AUC: 0.7058
[2025-11-19 08:44:48,765] [INFO] [<frozen importlib] - Best val AUCPR: 0.2296
[2025-11-19 08:44:48,770] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:44:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:44:55,427] [INFO] [<frozen importlib] - Optimal threshold: 0.4912
[2025-11-19 08:44:55,428] [INFO] [<frozen importlib] - Best f1: 0.2793
[2025-11-19 08:44:55,428] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:44:55,469] [INFO] [<frozen importlib] - Validation Results (threshold=0.4912):
[2025-11-19 08:44:55,469] [INFO] [<frozen importlib] -   Accuracy: 0.8946
[2025-11-19 08:44:55,469] [INFO] [<frozen importlib] -   Precision: 0.2942
[2025-11-19 08:44:55,469] [INFO] [<frozen importlib] -   Recall: 0.2658
[2025-11-19 08:44:55,469] [INFO] [<frozen importlib] -   F1 Score: 0.2793
[2025-11-19 08:44:55,469] [INFO] [<frozen importlib] -   AUROC: 0.7058
[2025-11-19 08:44:55,469] [INFO] [<frozen importlib] -   AUPRC: 0.2298
[2025-11-19 08:44:55,469] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:44:55,469] [INFO] [<frozen importlib] -     TN=16519, FP=926
[2025-11-19 08:44:55,469] [INFO] [<frozen importlib] -     FN=1066, TP=386
[2025-11-19 08:44:55,491] [INFO] [<frozen importlib] - Trial 148: AUPRC=0.2298, F1=0.4508, Prec=0.4277, Rec=0.4766 | Optimizing auprc=0.2298
                                                                                        Best trial: 140. Best value: 0.237476:  30%|██▉       | 148/500 [22:53<58:23,  9.95s/it]Best trial: 140. Best value: 0.237476:  30%|██▉       | 148/500 [22:53<58:23,  9.95s/it]Best trial: 140. Best value: 0.237476:  30%|██▉       | 149/500 [22:53<52:59,  9.06s/it][2025-11-19 08:44:55,500] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.532761573629041
[2025-11-19 08:44:55,500] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:44:55,500] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:44:55,500] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   gamma: 0.3145273626065888
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   alpha: 1.0689500558386167
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   lambda: 1.9158587713832025
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   learning_rate: 0.07561935395386271
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   subsample: 0.7598648768661452
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   colsample_bytree: 0.5845846436104929
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5927438455885718
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   colsample_bynode: 0.7354826367093242
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:44:55,501] [INFO] [<frozen importlib] -   scale_pos_weight: 6.532761573629041
[2025-11-19 08:44:55,574] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:44:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:44:55,491] Trial 148 finished with value: 0.22983386786711607 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.23738485882345814, 'learning_rate': 0.07264326726228074, 'n_estimators': 500, 'alpha': 1.0772065915494133, 'lambda': 1.9020383813709087, 'subsample': 0.7593884819183857, 'colsample_bytree': 0.5774862608754032, 'colsample_bylevel': 0.5375292746421465, 'colsample_bynode': 0.7353071788147908, 'scale_pos_weight': 6.742392683805129}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.67062	train-auc:0.64326	train-aucpr:0.22662	val-logloss:0.66038	val-auc:0.66740	val-aucpr:0.15793
[10]	train-logloss:0.63352	train-auc:0.68637	train-aucpr:0.29191	val-logloss:0.57304	val-auc:0.67704	val-aucpr:0.20925
[20]	train-logloss:0.61738	train-auc:0.69714	train-aucpr:0.30600	val-logloss:0.53879	val-auc:0.70613	val-aucpr:0.22020
[30]	train-logloss:0.60722	train-auc:0.70701	train-aucpr:0.31528	val-logloss:0.52255	val-auc:0.70468	val-aucpr:0.21772
[40]	train-logloss:0.60095	train-auc:0.71289	train-aucpr:0.32481	val-logloss:0.50891	val-auc:0.70505	val-aucpr:0.21796
[46]	train-logloss:0.59673	train-auc:0.71889	train-aucpr:0.33011	val-logloss:0.48590	val-auc:0.70099	val-aucpr:0.21199
[2025-11-19 08:44:55,723] [INFO] [<frozen importlib] - Training completed at iteration 16
[2025-11-19 08:44:55,723] [INFO] [<frozen importlib] - Best train loss: 0.6225
[2025-11-19 08:44:55,723] [INFO] [<frozen importlib] - Best val loss: 0.5528
[2025-11-19 08:44:55,723] [INFO] [<frozen importlib] - Best val AUC: 0.7018
[2025-11-19 08:44:55,723] [INFO] [<frozen importlib] - Best val AUCPR: 0.2212
[2025-11-19 08:44:55,727] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:44:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:44:59,053] [INFO] [<frozen importlib] - Optimal threshold: 0.4950
[2025-11-19 08:44:59,053] [INFO] [<frozen importlib] - Best f1: 0.2688
[2025-11-19 08:44:59,053] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:44:59,073] [INFO] [<frozen importlib] - Validation Results (threshold=0.4950):
[2025-11-19 08:44:59,073] [INFO] [<frozen importlib] -   Accuracy: 0.8937
[2025-11-19 08:44:59,073] [INFO] [<frozen importlib] -   Precision: 0.2852
[2025-11-19 08:44:59,073] [INFO] [<frozen importlib] -   Recall: 0.2541
[2025-11-19 08:44:59,073] [INFO] [<frozen importlib] -   F1 Score: 0.2688
[2025-11-19 08:44:59,073] [INFO] [<frozen importlib] -   AUROC: 0.7018
[2025-11-19 08:44:59,073] [INFO] [<frozen importlib] -   AUPRC: 0.2204
[2025-11-19 08:44:59,073] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:44:59,073] [INFO] [<frozen importlib] -     TN=16520, FP=925
[2025-11-19 08:44:59,073] [INFO] [<frozen importlib] -     FN=1083, TP=369
[2025-11-19 08:44:59,096] [INFO] [<frozen importlib] - Trial 149: AUPRC=0.2204, F1=0.4331, Prec=0.4153, Rec=0.4525 | Optimizing auprc=0.2204
                                                                                        Best trial: 140. Best value: 0.237476:  30%|██▉       | 149/500 [22:57<52:59,  9.06s/it]Best trial: 140. Best value: 0.237476:  30%|██▉       | 149/500 [22:57<52:59,  9.06s/it]Best trial: 140. Best value: 0.237476:  30%|███       | 150/500 [22:57<43:17,  7.42s/it][2025-11-19 08:44:59,105] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.535875580356073
[2025-11-19 08:44:59,105] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:44:59,105] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:44:59,105] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:44:59,105] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:44:59,105] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:44:59,105] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:44:59,105] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:44:59,105] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:44:59,105] [INFO] [<frozen importlib] -   gamma: 0.28953658673207106
[2025-11-19 08:44:59,106] [INFO] [<frozen importlib] -   alpha: 0.9654282591775849
[2025-11-19 08:44:59,106] [INFO] [<frozen importlib] -   lambda: 0.5822936601405417
[2025-11-19 08:44:59,106] [INFO] [<frozen importlib] -   learning_rate: 0.07201450303333223
[2025-11-19 08:44:59,106] [INFO] [<frozen importlib] -   subsample: 0.7840661438002458
[2025-11-19 08:44:59,106] [INFO] [<frozen importlib] -   colsample_bytree: 0.576394141397327
[2025-11-19 08:44:59,106] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5399648950965269
[2025-11-19 08:44:59,106] [INFO] [<frozen importlib] -   colsample_bynode: 0.755878517950258
[2025-11-19 08:44:59,106] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:44:59,106] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:44:59,106] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:44:59,106] [INFO] [<frozen importlib] -   scale_pos_weight: 7.535875580356073
[2025-11-19 08:44:59,184] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:44:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:44:59,096] Trial 149 finished with value: 0.2204450850326616 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.3145273626065888, 'learning_rate': 0.07561935395386271, 'n_estimators': 500, 'alpha': 1.0689500558386167, 'lambda': 1.9158587713832025, 'subsample': 0.7598648768661452, 'colsample_bytree': 0.5845846436104929, 'colsample_bylevel': 0.5927438455885718, 'colsample_bynode': 0.7354826367093242, 'scale_pos_weight': 6.532761573629041}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.72444	train-auc:0.63444	train-aucpr:0.22962	val-logloss:0.72379	val-auc:0.59775	val-aucpr:0.11608
[10]	train-logloss:0.68392	train-auc:0.68772	train-aucpr:0.29749	val-logloss:0.62685	val-auc:0.69924	val-aucpr:0.22427
[20]	train-logloss:0.66561	train-auc:0.69783	train-aucpr:0.31068	val-logloss:0.57448	val-auc:0.70539	val-aucpr:0.23035
[30]	train-logloss:0.65492	train-auc:0.70555	train-aucpr:0.31836	val-logloss:0.55698	val-auc:0.69815	val-aucpr:0.22840
[40]	train-logloss:0.64807	train-auc:0.71283	train-aucpr:0.32473	val-logloss:0.54398	val-auc:0.70230	val-aucpr:0.22132
[45]	train-logloss:0.64451	train-auc:0.71710	train-aucpr:0.32863	val-logloss:0.50763	val-auc:0.70579	val-aucpr:0.22254
[2025-11-19 08:44:59,337] [INFO] [<frozen importlib] - Training completed at iteration 16
[2025-11-19 08:44:59,337] [INFO] [<frozen importlib] - Best train loss: 0.6721
[2025-11-19 08:44:59,337] [INFO] [<frozen importlib] - Best val loss: 0.5976
[2025-11-19 08:44:59,337] [INFO] [<frozen importlib] - Best val AUC: 0.7077
[2025-11-19 08:44:59,337] [INFO] [<frozen importlib] - Best val AUCPR: 0.2342
[2025-11-19 08:44:59,342] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:44:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:45:05,074] [INFO] [<frozen importlib] - Optimal threshold: 0.5192
[2025-11-19 08:45:05,074] [INFO] [<frozen importlib] - Best f1: 0.2827
[2025-11-19 08:45:05,074] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:45:05,118] [INFO] [<frozen importlib] - Validation Results (threshold=0.5192):
[2025-11-19 08:45:05,118] [INFO] [<frozen importlib] -   Accuracy: 0.8934
[2025-11-19 08:45:05,118] [INFO] [<frozen importlib] -   Precision: 0.2926
[2025-11-19 08:45:05,118] [INFO] [<frozen importlib] -   Recall: 0.2734
[2025-11-19 08:45:05,118] [INFO] [<frozen importlib] -   F1 Score: 0.2827
[2025-11-19 08:45:05,118] [INFO] [<frozen importlib] -   AUROC: 0.7077
[2025-11-19 08:45:05,118] [INFO] [<frozen importlib] -   AUPRC: 0.2346
[2025-11-19 08:45:05,118] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:45:05,118] [INFO] [<frozen importlib] -     TN=16485, FP=960
[2025-11-19 08:45:05,118] [INFO] [<frozen importlib] -     FN=1055, TP=397
[2025-11-19 08:45:05,141] [INFO] [<frozen importlib] - Trial 150: AUPRC=0.2346, F1=0.4509, Prec=0.4224, Rec=0.4835 | Optimizing auprc=0.2346
                                                                                        Best trial: 140. Best value: 0.237476:  30%|███       | 150/500 [23:03<43:17,  7.42s/it]Best trial: 140. Best value: 0.237476:  30%|███       | 150/500 [23:03<43:17,  7.42s/it]Best trial: 140. Best value: 0.237476:  30%|███       | 151/500 [23:03<40:46,  7.01s/it][2025-11-19 08:45:05,151] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.563641899088897
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   gamma: 0.2904466743598715
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   alpha: 0.9786948582561619
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   lambda: 0.47221059108691327
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   learning_rate: 0.07179127004935908
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   subsample: 0.7278225951476032
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   colsample_bytree: 0.5736164249687749
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   colsample_bylevel: 0.539988805855454
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   colsample_bynode: 0.7625189349221245
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:45:05,151] [INFO] [<frozen importlib] -   scale_pos_weight: 7.563641899088897
[2025-11-19 08:45:05,224] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:45:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:45:05,141] Trial 150 finished with value: 0.2346340658721259 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.28953658673207106, 'learning_rate': 0.07201450303333223, 'n_estimators': 500, 'alpha': 0.9654282591775849, 'lambda': 0.5822936601405417, 'subsample': 0.7840661438002458, 'colsample_bytree': 0.576394141397327, 'colsample_bylevel': 0.5399648950965269, 'colsample_bynode': 0.755878517950258, 'scale_pos_weight': 7.535875580356073}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.72597	train-auc:0.63337	train-aucpr:0.22230	val-logloss:0.72160	val-auc:0.62089	val-aucpr:0.12080
[10]	train-logloss:0.68558	train-auc:0.68769	train-aucpr:0.29491	val-logloss:0.61741	val-auc:0.70067	val-aucpr:0.20080
[20]	train-logloss:0.66738	train-auc:0.69612	train-aucpr:0.30581	val-logloss:0.56022	val-auc:0.69677	val-aucpr:0.20501
[30]	train-logloss:0.65711	train-auc:0.70339	train-aucpr:0.31517	val-logloss:0.52980	val-auc:0.69942	val-aucpr:0.20520
[40]	train-logloss:0.65001	train-auc:0.71144	train-aucpr:0.32303	val-logloss:0.51469	val-auc:0.70477	val-aucpr:0.20738
[50]	train-logloss:0.64397	train-auc:0.71954	train-aucpr:0.33112	val-logloss:0.48209	val-auc:0.69913	val-aucpr:0.20212
[60]	train-logloss:0.63908	train-auc:0.72715	train-aucpr:0.33735	val-logloss:0.47912	val-auc:0.69561	val-aucpr:0.19523
[64]	train-logloss:0.63717	train-auc:0.72950	train-aucpr:0.33975	val-logloss:0.48593	val-auc:0.68860	val-aucpr:0.18476
[2025-11-19 08:45:05,418] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:45:05,418] [INFO] [<frozen importlib] - Best train loss: 0.6543
[2025-11-19 08:45:05,418] [INFO] [<frozen importlib] - Best val loss: 0.5248
[2025-11-19 08:45:05,418] [INFO] [<frozen importlib] - Best val AUC: 0.7029
[2025-11-19 08:45:05,418] [INFO] [<frozen importlib] - Best val AUCPR: 0.2105
[2025-11-19 08:45:05,423] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:45:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:45:16,995] [INFO] [<frozen importlib] - Optimal threshold: 0.5359
[2025-11-19 08:45:16,995] [INFO] [<frozen importlib] - Best f1: 0.2557
[2025-11-19 08:45:16,995] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:45:17,044] [INFO] [<frozen importlib] - Validation Results (threshold=0.5359):
[2025-11-19 08:45:17,044] [INFO] [<frozen importlib] -   Accuracy: 0.8931
[2025-11-19 08:45:17,044] [INFO] [<frozen importlib] -   Precision: 0.2750
[2025-11-19 08:45:17,044] [INFO] [<frozen importlib] -   Recall: 0.2390
[2025-11-19 08:45:17,044] [INFO] [<frozen importlib] -   F1 Score: 0.2557
[2025-11-19 08:45:17,044] [INFO] [<frozen importlib] -   AUROC: 0.7029
[2025-11-19 08:45:17,044] [INFO] [<frozen importlib] -   AUPRC: 0.2109
[2025-11-19 08:45:17,044] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:45:17,044] [INFO] [<frozen importlib] -     TN=16530, FP=915
[2025-11-19 08:45:17,044] [INFO] [<frozen importlib] -     FN=1105, TP=347
[2025-11-19 08:45:17,069] [INFO] [<frozen importlib] - Trial 151: AUPRC=0.2109, F1=0.4199, Prec=0.4074, Rec=0.4332 | Optimizing auprc=0.2109
[2025-11-19 08:45:17,069] [INFO] [<frozen importlib] - Trial 151 pruned.
[2025-11-19 08:45:17,069] [ERROR] [<frozen importlib] - Trial 151 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  30%|███       | 151/500 [23:15<40:46,  7.01s/it]Best trial: 140. Best value: 0.237476:  30%|███       | 151/500 [23:15<40:46,  7.01s/it]Best trial: 140. Best value: 0.237476:  30%|███       | 152/500 [23:15<49:12,  8.48s/it][2025-11-19 08:45:17,085] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.3540082366155675
[2025-11-19 08:45:17,085] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:45:17,085] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:45:17,085] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:45:17,085] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:45:17,085] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:45:17,085] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:45:17,085] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:45:17,085] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:45:17,085] [INFO] [<frozen importlib] -   gamma: 0.24512545611382736
[2025-11-19 08:45:17,085] [INFO] [<frozen importlib] -   alpha: 1.1253246782476622
[2025-11-19 08:45:17,086] [INFO] [<frozen importlib] -   lambda: 0.5763780841320347
[2025-11-19 08:45:17,086] [INFO] [<frozen importlib] -   learning_rate: 0.07799307131973908
[2025-11-19 08:45:17,086] [INFO] [<frozen importlib] -   subsample: 0.7898345001919785
[2025-11-19 08:45:17,086] [INFO] [<frozen importlib] -   colsample_bytree: 0.6021848202174861
[2025-11-19 08:45:17,086] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5603973781368077
[2025-11-19 08:45:17,086] [INFO] [<frozen importlib] -   colsample_bynode: 0.7281113705382304
[2025-11-19 08:45:17,086] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:45:17,086] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:45:17,086] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:45:17,086] [INFO] [<frozen importlib] -   scale_pos_weight: 7.3540082366155675
[2025-11-19 08:45:17,171] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:45:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:45:17,069] Trial 151 pruned. 
[0]	train-logloss:0.71394	train-auc:0.65252	train-aucpr:0.23726	val-logloss:0.70482	val-auc:0.65909	val-aucpr:0.16395
[10]	train-logloss:0.67234	train-auc:0.69000	train-aucpr:0.29652	val-logloss:0.59409	val-auc:0.69105	val-aucpr:0.20191
[20]	train-logloss:0.65492	train-auc:0.70166	train-aucpr:0.30797	val-logloss:0.54605	val-auc:0.69086	val-aucpr:0.21145
[30]	train-logloss:0.64480	train-auc:0.70832	train-aucpr:0.31951	val-logloss:0.54130	val-auc:0.69159	val-aucpr:0.21209
[40]	train-logloss:0.63819	train-auc:0.71659	train-aucpr:0.32671	val-logloss:0.51709	val-auc:0.68733	val-aucpr:0.20455
[50]	train-logloss:0.63189	train-auc:0.72488	train-aucpr:0.33464	val-logloss:0.48470	val-auc:0.67955	val-aucpr:0.18831
[52]	train-logloss:0.63090	train-auc:0.72662	train-aucpr:0.33598	val-logloss:0.48500	val-auc:0.67779	val-aucpr:0.18670
[2025-11-19 08:45:17,341] [INFO] [<frozen importlib] - Training completed at iteration 23
[2025-11-19 08:45:17,341] [INFO] [<frozen importlib] - Best train loss: 0.6514
[2025-11-19 08:45:17,341] [INFO] [<frozen importlib] - Best val loss: 0.5431
[2025-11-19 08:45:17,341] [INFO] [<frozen importlib] - Best val AUC: 0.6955
[2025-11-19 08:45:17,341] [INFO] [<frozen importlib] - Best val AUCPR: 0.2183
[2025-11-19 08:45:17,346] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:45:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:45:23,343] [INFO] [<frozen importlib] - Optimal threshold: 0.5040
[2025-11-19 08:45:23,343] [INFO] [<frozen importlib] - Best f1: 0.2746
[2025-11-19 08:45:23,343] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:45:23,385] [INFO] [<frozen importlib] - Validation Results (threshold=0.5040):
[2025-11-19 08:45:23,385] [INFO] [<frozen importlib] -   Accuracy: 0.9013
[2025-11-19 08:45:23,385] [INFO] [<frozen importlib] -   Precision: 0.3155
[2025-11-19 08:45:23,385] [INFO] [<frozen importlib] -   Recall: 0.2431
[2025-11-19 08:45:23,385] [INFO] [<frozen importlib] -   F1 Score: 0.2746
[2025-11-19 08:45:23,385] [INFO] [<frozen importlib] -   AUROC: 0.6955
[2025-11-19 08:45:23,385] [INFO] [<frozen importlib] -   AUPRC: 0.2186
[2025-11-19 08:45:23,385] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:45:23,385] [INFO] [<frozen importlib] -     TN=16679, FP=766
[2025-11-19 08:45:23,385] [INFO] [<frozen importlib] -     FN=1099, TP=353
[2025-11-19 08:45:23,410] [INFO] [<frozen importlib] - Trial 152: AUPRC=0.2186, F1=0.4419, Prec=0.4509, Rec=0.4332 | Optimizing auprc=0.2186
                                                                                        Best trial: 140. Best value: 0.237476:  30%|███       | 152/500 [23:21<49:12,  8.48s/it]Best trial: 140. Best value: 0.237476:  30%|███       | 152/500 [23:21<49:12,  8.48s/it]Best trial: 140. Best value: 0.237476:  31%|███       | 153/500 [23:21<45:20,  7.84s/it][2025-11-19 08:45:23,420] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.687066058272936
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   gamma: 0.3674689921895116
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   alpha: 1.0664252174188713
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   lambda: 0.3810393524118987
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   learning_rate: 0.0829460067154382
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   subsample: 0.7712149704276811
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   colsample_bytree: 0.5868920247911632
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5441826273670283
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   colsample_bynode: 0.75520799223448
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:45:23,420] [INFO] [<frozen importlib] -   scale_pos_weight: 6.687066058272936
[2025-11-19 08:45:23,493] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:45:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:45:23,410] Trial 152 finished with value: 0.21855301991306736 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.24512545611382736, 'learning_rate': 0.07799307131973908, 'n_estimators': 500, 'alpha': 1.1253246782476622, 'lambda': 0.5763780841320347, 'subsample': 0.7898345001919785, 'colsample_bytree': 0.6021848202174861, 'colsample_bylevel': 0.5603973781368077, 'colsample_bynode': 0.7281113705382304, 'scale_pos_weight': 7.3540082366155675}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.67852	train-auc:0.63632	train-aucpr:0.22715	val-logloss:0.66987	val-auc:0.61947	val-aucpr:0.12018
[10]	train-logloss:0.63951	train-auc:0.68361	train-aucpr:0.29331	val-logloss:0.58292	val-auc:0.66017	val-aucpr:0.18771
[20]	train-logloss:0.62195	train-auc:0.69961	train-aucpr:0.31077	val-logloss:0.52873	val-auc:0.69451	val-aucpr:0.21700
[30]	train-logloss:0.61229	train-auc:0.70760	train-aucpr:0.32119	val-logloss:0.51143	val-auc:0.69207	val-aucpr:0.21171
[40]	train-logloss:0.60581	train-auc:0.71858	train-aucpr:0.33048	val-logloss:0.47964	val-auc:0.70650	val-aucpr:0.20486
[50]	train-logloss:0.59994	train-auc:0.72679	train-aucpr:0.33810	val-logloss:0.48770	val-auc:0.69393	val-aucpr:0.18895
[2025-11-19 08:45:23,658] [INFO] [<frozen importlib] - Training completed at iteration 20
[2025-11-19 08:45:23,658] [INFO] [<frozen importlib] - Best train loss: 0.6219
[2025-11-19 08:45:23,658] [INFO] [<frozen importlib] - Best val loss: 0.5287
[2025-11-19 08:45:23,658] [INFO] [<frozen importlib] - Best val AUC: 0.6945
[2025-11-19 08:45:23,658] [INFO] [<frozen importlib] - Best val AUCPR: 0.2170
[2025-11-19 08:45:23,663] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:45:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:45:29,854] [INFO] [<frozen importlib] - Optimal threshold: 0.4945
[2025-11-19 08:45:29,854] [INFO] [<frozen importlib] - Best f1: 0.2720
[2025-11-19 08:45:29,854] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:45:29,904] [INFO] [<frozen importlib] - Validation Results (threshold=0.4945):
[2025-11-19 08:45:29,904] [INFO] [<frozen importlib] -   Accuracy: 0.8991
[2025-11-19 08:45:29,904] [INFO] [<frozen importlib] -   Precision: 0.3053
[2025-11-19 08:45:29,904] [INFO] [<frozen importlib] -   Recall: 0.2452
[2025-11-19 08:45:29,904] [INFO] [<frozen importlib] -   F1 Score: 0.2720
[2025-11-19 08:45:29,904] [INFO] [<frozen importlib] -   AUROC: 0.6945
[2025-11-19 08:45:29,904] [INFO] [<frozen importlib] -   AUPRC: 0.2174
[2025-11-19 08:45:29,904] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:45:29,904] [INFO] [<frozen importlib] -     TN=16635, FP=810
[2025-11-19 08:45:29,904] [INFO] [<frozen importlib] -     FN=1096, TP=356
[2025-11-19 08:45:29,928] [INFO] [<frozen importlib] - Trial 153: AUPRC=0.2174, F1=0.4475, Prec=0.4460, Rec=0.4490 | Optimizing auprc=0.2174
[2025-11-19 08:45:29,928] [INFO] [<frozen importlib] - Trial 153 pruned.
[2025-11-19 08:45:29,928] [ERROR] [<frozen importlib] - Trial 153 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  31%|███       | 153/500 [23:27<45:20,  7.84s/it]Best trial: 140. Best value: 0.237476:  31%|███       | 153/500 [23:27<45:20,  7.84s/it]Best trial: 140. Best value: 0.237476:  31%|███       | 154/500 [23:27<42:55,  7.44s/it][2025-11-19 08:45:29,937] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.935208483317326
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   gamma: 0.5199076413989617
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   alpha: 0.9397970468126527
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   lambda: 0.6736175982280488
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   learning_rate: 0.06821945850268613
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   subsample: 0.7522081270075108
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   colsample_bytree: 0.5732242720666957
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5744926750412341
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   colsample_bynode: 0.7411456599305075
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:45:29,938] [INFO] [<frozen importlib] -   scale_pos_weight: 5.935208483317326
[2025-11-19 08:45:30,011] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:45:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:45:29,928] Trial 153 pruned. 
[0]	train-logloss:0.63816	train-auc:0.64310	train-aucpr:0.22646	val-logloss:0.62711	val-auc:0.60127	val-aucpr:0.11255
[10]	train-logloss:0.60564	train-auc:0.68542	train-aucpr:0.28997	val-logloss:0.55892	val-auc:0.67059	val-aucpr:0.18330
[20]	train-logloss:0.58989	train-auc:0.69662	train-aucpr:0.30574	val-logloss:0.49998	val-auc:0.68674	val-aucpr:0.20677
[30]	train-logloss:0.58038	train-auc:0.70411	train-aucpr:0.31415	val-logloss:0.50051	val-auc:0.68593	val-aucpr:0.20752
[40]	train-logloss:0.57470	train-auc:0.70964	train-aucpr:0.32016	val-logloss:0.48465	val-auc:0.68867	val-aucpr:0.21660
[50]	train-logloss:0.56907	train-auc:0.71852	train-aucpr:0.32866	val-logloss:0.45209	val-auc:0.68623	val-aucpr:0.19282
[60]	train-logloss:0.56481	train-auc:0.72528	train-aucpr:0.33599	val-logloss:0.43150	val-auc:0.69538	val-aucpr:0.20093
[68]	train-logloss:0.56157	train-auc:0.73164	train-aucpr:0.34186	val-logloss:0.42628	val-auc:0.68293	val-aucpr:0.18555
[2025-11-19 08:45:30,218] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 08:45:30,218] [INFO] [<frozen importlib] - Best train loss: 0.5752
[2025-11-19 08:45:30,218] [INFO] [<frozen importlib] - Best val loss: 0.4881
[2025-11-19 08:45:30,218] [INFO] [<frozen importlib] - Best val AUC: 0.6893
[2025-11-19 08:45:30,218] [INFO] [<frozen importlib] - Best val AUCPR: 0.2173
[2025-11-19 08:45:30,223] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:45:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:45:42,546] [INFO] [<frozen importlib] - Optimal threshold: 0.4754
[2025-11-19 08:45:42,546] [INFO] [<frozen importlib] - Best f1: 0.2704
[2025-11-19 08:45:42,546] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:45:42,591] [INFO] [<frozen importlib] - Validation Results (threshold=0.4754):
[2025-11-19 08:45:42,591] [INFO] [<frozen importlib] -   Accuracy: 0.8980
[2025-11-19 08:45:42,591] [INFO] [<frozen importlib] -   Precision: 0.3003
[2025-11-19 08:45:42,591] [INFO] [<frozen importlib] -   Recall: 0.2459
[2025-11-19 08:45:42,591] [INFO] [<frozen importlib] -   F1 Score: 0.2704
[2025-11-19 08:45:42,591] [INFO] [<frozen importlib] -   AUROC: 0.6893
[2025-11-19 08:45:42,591] [INFO] [<frozen importlib] -   AUPRC: 0.2179
[2025-11-19 08:45:42,591] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:45:42,591] [INFO] [<frozen importlib] -     TN=16613, FP=832
[2025-11-19 08:45:42,591] [INFO] [<frozen importlib] -     FN=1095, TP=357
[2025-11-19 08:45:42,616] [INFO] [<frozen importlib] - Trial 154: AUPRC=0.2179, F1=0.4489, Prec=0.4427, Rec=0.4552 | Optimizing auprc=0.2179
                                                                                        Best trial: 140. Best value: 0.237476:  31%|███       | 154/500 [23:40<42:55,  7.44s/it]Best trial: 140. Best value: 0.237476:  31%|███       | 154/500 [23:40<42:55,  7.44s/it]Best trial: 140. Best value: 0.237476:  31%|███       | 155/500 [23:40<51:51,  9.02s/it][2025-11-19 08:45:42,628] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.415259632619462
[2025-11-19 08:45:42,628] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:45:42,628] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:45:42,628] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:45:42,628] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:45:42,628] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:45:42,628] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:45:42,628] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:45:42,628] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:45:42,628] [INFO] [<frozen importlib] -   gamma: 0.32953308245205887
[2025-11-19 08:45:42,629] [INFO] [<frozen importlib] -   alpha: 0.9886563180234607
[2025-11-19 08:45:42,629] [INFO] [<frozen importlib] -   lambda: 0.19402178984345442
[2025-11-19 08:45:42,629] [INFO] [<frozen importlib] -   learning_rate: 0.09150430604999908
[2025-11-19 08:45:42,629] [INFO] [<frozen importlib] -   subsample: 0.7775382070417286
[2025-11-19 08:45:42,629] [INFO] [<frozen importlib] -   colsample_bytree: 0.5657516917870412
[2025-11-19 08:45:42,629] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5352991619284959
[2025-11-19 08:45:42,629] [INFO] [<frozen importlib] -   colsample_bynode: 0.7479478677018476
[2025-11-19 08:45:42,629] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:45:42,629] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:45:42,629] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:45:42,629] [INFO] [<frozen importlib] -   scale_pos_weight: 8.415259632619462
[2025-11-19 08:45:42,699] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:45:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:45:42,617] Trial 154 finished with value: 0.21793419231566885 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.5199076413989617, 'learning_rate': 0.06821945850268613, 'n_estimators': 500, 'alpha': 0.9397970468126527, 'lambda': 0.6736175982280488, 'subsample': 0.7522081270075108, 'colsample_bytree': 0.5732242720666957, 'colsample_bylevel': 0.5744926750412341, 'colsample_bynode': 0.7411456599305075, 'scale_pos_weight': 5.935208483317326}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.76700	train-auc:0.63775	train-aucpr:0.22654	val-logloss:0.76694	val-auc:0.61209	val-aucpr:0.11337
[10]	train-logloss:0.71886	train-auc:0.68856	train-aucpr:0.29554	val-logloss:0.62458	val-auc:0.68094	val-aucpr:0.19352
[20]	train-logloss:0.70028	train-auc:0.70033	train-aucpr:0.30939	val-logloss:0.57931	val-auc:0.69876	val-aucpr:0.21768
[30]	train-logloss:0.68992	train-auc:0.70843	train-aucpr:0.31996	val-logloss:0.55437	val-auc:0.68779	val-aucpr:0.21227
[40]	train-logloss:0.68192	train-auc:0.71951	train-aucpr:0.32994	val-logloss:0.52579	val-auc:0.69016	val-aucpr:0.19454
[50]	train-logloss:0.67564	train-auc:0.72739	train-aucpr:0.33721	val-logloss:0.49111	val-auc:0.68947	val-aucpr:0.19244
[55]	train-logloss:0.67260	train-auc:0.73181	train-aucpr:0.34167	val-logloss:0.47666	val-auc:0.68721	val-aucpr:0.18288
[2025-11-19 08:45:42,879] [INFO] [<frozen importlib] - Training completed at iteration 26
[2025-11-19 08:45:42,879] [INFO] [<frozen importlib] - Best train loss: 0.6930
[2025-11-19 08:45:42,879] [INFO] [<frozen importlib] - Best val loss: 0.5648
[2025-11-19 08:45:42,879] [INFO] [<frozen importlib] - Best val AUC: 0.7052
[2025-11-19 08:45:42,879] [INFO] [<frozen importlib] - Best val AUCPR: 0.2260
[2025-11-19 08:45:42,885] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:45:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:45:52,538] [INFO] [<frozen importlib] - Optimal threshold: 0.5389
[2025-11-19 08:45:52,538] [INFO] [<frozen importlib] - Best f1: 0.2799
[2025-11-19 08:45:52,538] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:45:52,584] [INFO] [<frozen importlib] - Validation Results (threshold=0.5389):
[2025-11-19 08:45:52,585] [INFO] [<frozen importlib] -   Accuracy: 0.9009
[2025-11-19 08:45:52,585] [INFO] [<frozen importlib] -   Precision: 0.3168
[2025-11-19 08:45:52,585] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 08:45:52,585] [INFO] [<frozen importlib] -   F1 Score: 0.2799
[2025-11-19 08:45:52,585] [INFO] [<frozen importlib] -   AUROC: 0.7052
[2025-11-19 08:45:52,585] [INFO] [<frozen importlib] -   AUPRC: 0.2262
[2025-11-19 08:45:52,585] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:45:52,585] [INFO] [<frozen importlib] -     TN=16660, FP=785
[2025-11-19 08:45:52,585] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 08:45:52,610] [INFO] [<frozen importlib] - Trial 155: AUPRC=0.2262, F1=0.4647, Prec=0.4631, Rec=0.4663 | Optimizing auprc=0.2262
                                                                                        Best trial: 140. Best value: 0.237476:  31%|███       | 155/500 [23:50<51:51,  9.02s/it]Best trial: 140. Best value: 0.237476:  31%|███       | 155/500 [23:50<51:51,  9.02s/it]Best trial: 140. Best value: 0.237476:  31%|███       | 156/500 [23:50<53:22,  9.31s/it][2025-11-19 08:45:52,620] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.188336633270636
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   gamma: 0.2263273386606523
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   alpha: 0.06400906249869082
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   lambda: 1.8528742930428137
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   learning_rate: 0.07349628572118831
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   subsample: 0.8038846221092176
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   colsample_bytree: 0.5867015044788397
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5580170935051775
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   colsample_bynode: 0.7071968253163186
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:45:52,620] [INFO] [<frozen importlib] -   scale_pos_weight: 8.188336633270636
[2025-11-19 08:45:52,698] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:45:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:45:52,611] Trial 155 finished with value: 0.22623565567899706 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.32953308245205887, 'learning_rate': 0.09150430604999908, 'n_estimators': 500, 'alpha': 0.9886563180234607, 'lambda': 0.19402178984345442, 'subsample': 0.7775382070417286, 'colsample_bytree': 0.5657516917870412, 'colsample_bylevel': 0.5352991619284959, 'colsample_bynode': 0.7479478677018476, 'scale_pos_weight': 8.415259632619462}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.75736	train-auc:0.64108	train-aucpr:0.22466	val-logloss:0.75680	val-auc:0.62151	val-aucpr:0.12232
[10]	train-logloss:0.71444	train-auc:0.68563	train-aucpr:0.29539	val-logloss:0.66843	val-auc:0.65465	val-aucpr:0.17640
[20]	train-logloss:0.69654	train-auc:0.69744	train-aucpr:0.30478	val-logloss:0.62242	val-auc:0.69435	val-aucpr:0.20881
[30]	train-logloss:0.68487	train-auc:0.70698	train-aucpr:0.31554	val-logloss:0.59521	val-auc:0.68894	val-aucpr:0.21127
[40]	train-logloss:0.67670	train-auc:0.71645	train-aucpr:0.32603	val-logloss:0.58736	val-auc:0.67018	val-aucpr:0.18085
[47]	train-logloss:0.67196	train-auc:0.71961	train-aucpr:0.32941	val-logloss:0.57904	val-auc:0.67118	val-aucpr:0.17961
[2025-11-19 08:45:52,848] [INFO] [<frozen importlib] - Training completed at iteration 17
[2025-11-19 08:45:52,848] [INFO] [<frozen importlib] - Best train loss: 0.7009
[2025-11-19 08:45:52,848] [INFO] [<frozen importlib] - Best val loss: 0.6324
[2025-11-19 08:45:52,848] [INFO] [<frozen importlib] - Best val AUC: 0.6936
[2025-11-19 08:45:52,848] [INFO] [<frozen importlib] - Best val AUCPR: 0.2134
[2025-11-19 08:45:52,853] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:45:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:45:56,323] [INFO] [<frozen importlib] - Optimal threshold: 0.5448
[2025-11-19 08:45:56,323] [INFO] [<frozen importlib] - Best f1: 0.2636
[2025-11-19 08:45:56,323] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:45:56,369] [INFO] [<frozen importlib] - Validation Results (threshold=0.5448):
[2025-11-19 08:45:56,369] [INFO] [<frozen importlib] -   Accuracy: 0.8959
[2025-11-19 08:45:56,369] [INFO] [<frozen importlib] -   Precision: 0.2888
[2025-11-19 08:45:56,369] [INFO] [<frozen importlib] -   Recall: 0.2424
[2025-11-19 08:45:56,369] [INFO] [<frozen importlib] -   F1 Score: 0.2636
[2025-11-19 08:45:56,369] [INFO] [<frozen importlib] -   AUROC: 0.6936
[2025-11-19 08:45:56,369] [INFO] [<frozen importlib] -   AUPRC: 0.2125
[2025-11-19 08:45:56,369] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:45:56,369] [INFO] [<frozen importlib] -     TN=16578, FP=867
[2025-11-19 08:45:56,369] [INFO] [<frozen importlib] -     FN=1100, TP=352
[2025-11-19 08:45:56,393] [INFO] [<frozen importlib] - Trial 156: AUPRC=0.2125, F1=0.4535, Prec=0.4396, Rec=0.4683 | Optimizing auprc=0.2125
[2025-11-19 08:45:56,393] [INFO] [<frozen importlib] - Trial 156 pruned.
[2025-11-19 08:45:56,393] [ERROR] [<frozen importlib] - Trial 156 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  31%|███       | 156/500 [23:54<53:22,  9.31s/it]Best trial: 140. Best value: 0.237476:  31%|███       | 156/500 [23:54<53:22,  9.31s/it]Best trial: 140. Best value: 0.237476:  31%|███▏      | 157/500 [23:54<43:44,  7.65s/it][2025-11-19 08:45:56,410] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.8163769700344
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   gamma: 0.25733853932989054
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   alpha: 0.752575382663648
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   lambda: 0.9261792693551013
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   learning_rate: 0.036958724433212346
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   subsample: 0.7882243331931591
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   colsample_bytree: 0.5769999759237052
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   colsample_bylevel: 0.587231520452814
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   colsample_bynode: 0.7670630140693191
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:45:56,410] [INFO] [<frozen importlib] -   scale_pos_weight: 7.8163769700344
[2025-11-19 08:45:56,491] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:45:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:45:56,393] Trial 156 pruned. 
[0]	train-logloss:0.74170	train-auc:0.64477	train-aucpr:0.23075	val-logloss:0.74481	val-auc:0.63183	val-aucpr:0.11552
[10]	train-logloss:0.71494	train-auc:0.68031	train-aucpr:0.29200	val-logloss:0.67637	val-auc:0.66769	val-aucpr:0.18057
[20]	train-logloss:0.69843	train-auc:0.68848	train-aucpr:0.29908	val-logloss:0.62782	val-auc:0.69942	val-aucpr:0.21469
[30]	train-logloss:0.68734	train-auc:0.69365	train-aucpr:0.30491	val-logloss:0.59984	val-auc:0.69729	val-aucpr:0.21790
[40]	train-logloss:0.67954	train-auc:0.69880	train-aucpr:0.30880	val-logloss:0.57832	val-auc:0.70717	val-aucpr:0.21320
[50]	train-logloss:0.67260	train-auc:0.70335	train-aucpr:0.31442	val-logloss:0.56685	val-auc:0.70370	val-aucpr:0.21130
[60]	train-logloss:0.66784	train-auc:0.70701	train-aucpr:0.31868	val-logloss:0.55088	val-auc:0.70548	val-aucpr:0.21902
[70]	train-logloss:0.66430	train-auc:0.71087	train-aucpr:0.32159	val-logloss:0.53847	val-auc:0.70094	val-aucpr:0.21212
[80]	train-logloss:0.66061	train-auc:0.71532	train-aucpr:0.32493	val-logloss:0.53123	val-auc:0.70144	val-aucpr:0.21291
[89]	train-logloss:0.65774	train-auc:0.71889	train-aucpr:0.32855	val-logloss:0.50736	val-auc:0.69252	val-aucpr:0.20706
[2025-11-19 08:45:56,751] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:45:56,751] [INFO] [<frozen importlib] - Best train loss: 0.6678
[2025-11-19 08:45:56,751] [INFO] [<frozen importlib] - Best val loss: 0.5509
[2025-11-19 08:45:56,751] [INFO] [<frozen importlib] - Best val AUC: 0.7055
[2025-11-19 08:45:56,751] [INFO] [<frozen importlib] - Best val AUCPR: 0.2190
[2025-11-19 08:45:56,757] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:45:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:46:09,549] [INFO] [<frozen importlib] - Optimal threshold: 0.5176
[2025-11-19 08:46:09,550] [INFO] [<frozen importlib] - Best f1: 0.2636
[2025-11-19 08:46:09,550] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:46:09,573] [INFO] [<frozen importlib] - Validation Results (threshold=0.5176):
[2025-11-19 08:46:09,573] [INFO] [<frozen importlib] -   Accuracy: 0.8909
[2025-11-19 08:46:09,573] [INFO] [<frozen importlib] -   Precision: 0.2737
[2025-11-19 08:46:09,573] [INFO] [<frozen importlib] -   Recall: 0.2541
[2025-11-19 08:46:09,574] [INFO] [<frozen importlib] -   F1 Score: 0.2636
[2025-11-19 08:46:09,574] [INFO] [<frozen importlib] -   AUROC: 0.7055
[2025-11-19 08:46:09,574] [INFO] [<frozen importlib] -   AUPRC: 0.2195
[2025-11-19 08:46:09,574] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:46:09,574] [INFO] [<frozen importlib] -     TN=16466, FP=979
[2025-11-19 08:46:09,574] [INFO] [<frozen importlib] -     FN=1083, TP=369
[2025-11-19 08:46:09,599] [INFO] [<frozen importlib] - Trial 157: AUPRC=0.2195, F1=0.4362, Prec=0.4092, Rec=0.4669 | Optimizing auprc=0.2195
[2025-11-19 08:46:09,600] [INFO] [<frozen importlib] - Trial 157 pruned.
[2025-11-19 08:46:09,600] [ERROR] [<frozen importlib] - Trial 157 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  31%|███▏      | 157/500 [24:07<43:44,  7.65s/it]Best trial: 140. Best value: 0.237476:  31%|███▏      | 157/500 [24:07<43:44,  7.65s/it]Best trial: 140. Best value: 0.237476:  32%|███▏      | 158/500 [24:07<53:06,  9.32s/it][2025-11-19 08:46:09,616] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.3712953687222855
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   gamma: 0.28998035851524356
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   alpha: 1.2556480883130146
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   lambda: 2.0906779052002777
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   learning_rate: 0.06419957860606443
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   subsample: 0.7596331278277162
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   colsample_bytree: 0.6400836805711114
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7218914100505335
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   colsample_bynode: 0.7238712811158474
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:46:09,616] [INFO] [<frozen importlib] -   scale_pos_weight: 5.3712953687222855
[2025-11-19 08:46:09,700] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:46:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:46:09,600] Trial 157 pruned. 
[0]	train-logloss:0.60662	train-auc:0.63845	train-aucpr:0.23639	val-logloss:0.59188	val-auc:0.60915	val-aucpr:0.10525
[10]	train-logloss:0.57627	train-auc:0.68326	train-aucpr:0.29444	val-logloss:0.51136	val-auc:0.70751	val-aucpr:0.20111
[20]	train-logloss:0.56152	train-auc:0.69495	train-aucpr:0.30840	val-logloss:0.47138	val-auc:0.70583	val-aucpr:0.21448
[30]	train-logloss:0.55265	train-auc:0.70259	train-aucpr:0.31572	val-logloss:0.44472	val-auc:0.70209	val-aucpr:0.21717
[40]	train-logloss:0.54707	train-auc:0.70803	train-aucpr:0.32243	val-logloss:0.44063	val-auc:0.70177	val-aucpr:0.21281
[50]	train-logloss:0.54213	train-auc:0.71520	train-aucpr:0.32953	val-logloss:0.43305	val-auc:0.69399	val-aucpr:0.21097
[55]	train-logloss:0.54031	train-auc:0.71895	train-aucpr:0.33257	val-logloss:0.42974	val-auc:0.69473	val-aucpr:0.21345
[2025-11-19 08:46:09,880] [INFO] [<frozen importlib] - Training completed at iteration 26
[2025-11-19 08:46:09,880] [INFO] [<frozen importlib] - Best train loss: 0.5559
[2025-11-19 08:46:09,880] [INFO] [<frozen importlib] - Best val loss: 0.4530
[2025-11-19 08:46:09,880] [INFO] [<frozen importlib] - Best val AUC: 0.7081
[2025-11-19 08:46:09,880] [INFO] [<frozen importlib] - Best val AUCPR: 0.2243
[2025-11-19 08:46:09,885] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:46:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:46:16,485] [INFO] [<frozen importlib] - Optimal threshold: 0.4326
[2025-11-19 08:46:16,486] [INFO] [<frozen importlib] - Best f1: 0.2702
[2025-11-19 08:46:16,486] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:46:16,530] [INFO] [<frozen importlib] - Validation Results (threshold=0.4326):
[2025-11-19 08:46:16,530] [INFO] [<frozen importlib] -   Accuracy: 0.9011
[2025-11-19 08:46:16,530] [INFO] [<frozen importlib] -   Precision: 0.3120
[2025-11-19 08:46:16,530] [INFO] [<frozen importlib] -   Recall: 0.2383
[2025-11-19 08:46:16,530] [INFO] [<frozen importlib] -   F1 Score: 0.2702
[2025-11-19 08:46:16,530] [INFO] [<frozen importlib] -   AUROC: 0.7081
[2025-11-19 08:46:16,530] [INFO] [<frozen importlib] -   AUPRC: 0.2246
[2025-11-19 08:46:16,530] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:46:16,530] [INFO] [<frozen importlib] -     TN=16682, FP=763
[2025-11-19 08:46:16,530] [INFO] [<frozen importlib] -     FN=1106, TP=346
[2025-11-19 08:46:16,553] [INFO] [<frozen importlib] - Trial 158: AUPRC=0.2246, F1=0.4330, Prec=0.4451, Rec=0.4215 | Optimizing auprc=0.2246
                                                                                        Best trial: 140. Best value: 0.237476:  32%|███▏      | 158/500 [24:14<53:06,  9.32s/it]Best trial: 140. Best value: 0.237476:  32%|███▏      | 158/500 [24:14<53:06,  9.32s/it]Best trial: 140. Best value: 0.237476:  32%|███▏      | 159/500 [24:14<48:55,  8.61s/it][2025-11-19 08:46:16,568] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.303921492773258
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   gamma: 0.38870113703700576
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   alpha: 0.9009924105747644
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   lambda: 1.6228931591806033
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   learning_rate: 0.04014335828719078
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   subsample: 0.8117870536153472
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   colsample_bytree: 0.560739769925303
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   colsample_bylevel: 0.603948169136861
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   colsample_bynode: 0.7819706844729757
[2025-11-19 08:46:16,568] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:46:16,569] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:46:16,569] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:46:16,569] [INFO] [<frozen importlib] -   scale_pos_weight: 6.303921492773258
[2025-11-19 08:46:16,646] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:46:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:46:16,554] Trial 158 finished with value: 0.22458290431557293 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.28998035851524356, 'learning_rate': 0.06419957860606443, 'n_estimators': 500, 'alpha': 1.2556480883130146, 'lambda': 2.0906779052002777, 'subsample': 0.7596331278277162, 'colsample_bytree': 0.6400836805711114, 'colsample_bylevel': 0.7218914100505335, 'colsample_bynode': 0.7238712811158474, 'scale_pos_weight': 5.3712953687222855}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.66072	train-auc:0.64527	train-aucpr:0.22923	val-logloss:0.65382	val-auc:0.63101	val-aucpr:0.10555
[10]	train-logloss:0.63635	train-auc:0.68558	train-aucpr:0.29344	val-logloss:0.60343	val-auc:0.65378	val-aucpr:0.16700
[20]	train-logloss:0.62156	train-auc:0.69069	train-aucpr:0.30016	val-logloss:0.56351	val-auc:0.68950	val-aucpr:0.20878
[30]	train-logloss:0.61181	train-auc:0.69494	train-aucpr:0.30726	val-logloss:0.53530	val-auc:0.70251	val-aucpr:0.21639
[40]	train-logloss:0.60473	train-auc:0.69983	train-aucpr:0.31312	val-logloss:0.51369	val-auc:0.70442	val-aucpr:0.21862
[50]	train-logloss:0.59887	train-auc:0.70453	train-aucpr:0.31803	val-logloss:0.49479	val-auc:0.70523	val-aucpr:0.21915
[60]	train-logloss:0.59462	train-auc:0.70930	train-aucpr:0.32294	val-logloss:0.47532	val-auc:0.70480	val-aucpr:0.22011
[70]	train-logloss:0.59137	train-auc:0.71260	train-aucpr:0.32697	val-logloss:0.47632	val-auc:0.70222	val-aucpr:0.21943
[80]	train-logloss:0.58800	train-auc:0.71737	train-aucpr:0.33148	val-logloss:0.46552	val-auc:0.70111	val-aucpr:0.21312
[86]	train-logloss:0.58614	train-auc:0.72000	train-aucpr:0.33390	val-logloss:0.45861	val-auc:0.69236	val-aucpr:0.20740
[2025-11-19 08:46:16,896] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 08:46:16,896] [INFO] [<frozen importlib] - Best train loss: 0.5966
[2025-11-19 08:46:16,896] [INFO] [<frozen importlib] - Best val loss: 0.4861
[2025-11-19 08:46:16,896] [INFO] [<frozen importlib] - Best val AUC: 0.7056
[2025-11-19 08:46:16,896] [INFO] [<frozen importlib] - Best val AUCPR: 0.2210
[2025-11-19 08:46:16,901] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:46:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:46:29,446] [INFO] [<frozen importlib] - Optimal threshold: 0.4777
[2025-11-19 08:46:29,446] [INFO] [<frozen importlib] - Best f1: 0.2655
[2025-11-19 08:46:29,446] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:46:29,497] [INFO] [<frozen importlib] - Validation Results (threshold=0.4777):
[2025-11-19 08:46:29,497] [INFO] [<frozen importlib] -   Accuracy: 0.9019
[2025-11-19 08:46:29,497] [INFO] [<frozen importlib] -   Precision: 0.3125
[2025-11-19 08:46:29,497] [INFO] [<frozen importlib] -   Recall: 0.2307
[2025-11-19 08:46:29,497] [INFO] [<frozen importlib] -   F1 Score: 0.2655
[2025-11-19 08:46:29,497] [INFO] [<frozen importlib] -   AUROC: 0.7056
[2025-11-19 08:46:29,497] [INFO] [<frozen importlib] -   AUPRC: 0.2215
[2025-11-19 08:46:29,497] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:46:29,497] [INFO] [<frozen importlib] -     TN=16708, FP=737
[2025-11-19 08:46:29,497] [INFO] [<frozen importlib] -     FN=1117, TP=335
[2025-11-19 08:46:29,522] [INFO] [<frozen importlib] - Trial 159: AUPRC=0.2215, F1=0.4486, Prec=0.4620, Rec=0.4360 | Optimizing auprc=0.2215
[2025-11-19 08:46:29,523] [INFO] [<frozen importlib] - Trial 159 pruned.
[2025-11-19 08:46:29,523] [ERROR] [<frozen importlib] - Trial 159 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  32%|███▏      | 159/500 [24:27<48:55,  8.61s/it]Best trial: 140. Best value: 0.237476:  32%|███▏      | 159/500 [24:27<48:55,  8.61s/it]Best trial: 140. Best value: 0.237476:  32%|███▏      | 160/500 [24:27<56:11,  9.92s/it][2025-11-19 08:46:29,533] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.840101907521781
[2025-11-19 08:46:29,533] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:46:29,533] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:46:29,533] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:46:29,533] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:46:29,533] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   gamma: 0.42412567713626514
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   alpha: 0.8494033953937739
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   lambda: 1.3386371691555143
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   learning_rate: 0.07970000556743352
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   subsample: 0.7347699429347306
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   colsample_bytree: 0.609607274597661
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5670577075133094
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   colsample_bynode: 0.7759607306485026
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:46:29,534] [INFO] [<frozen importlib] -   scale_pos_weight: 6.840101907521781
[2025-11-19 08:46:29,614] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:46:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:46:29,523] Trial 159 pruned. 
[0]	train-logloss:0.68658	train-auc:0.65084	train-aucpr:0.23795	val-logloss:0.67696	val-auc:0.61481	val-aucpr:0.10797
[10]	train-logloss:0.64696	train-auc:0.68720	train-aucpr:0.29836	val-logloss:0.58110	val-auc:0.67841	val-aucpr:0.20572
[20]	train-logloss:0.62938	train-auc:0.69965	train-aucpr:0.31031	val-logloss:0.53911	val-auc:0.68807	val-aucpr:0.21087
[30]	train-logloss:0.61985	train-auc:0.70786	train-aucpr:0.31936	val-logloss:0.52492	val-auc:0.68211	val-aucpr:0.20587
[40]	train-logloss:0.61403	train-auc:0.71578	train-aucpr:0.32550	val-logloss:0.50271	val-auc:0.68549	val-aucpr:0.20547
[46]	train-logloss:0.60994	train-auc:0.72009	train-aucpr:0.33061	val-logloss:0.49059	val-auc:0.67779	val-aucpr:0.19349
[2025-11-19 08:46:29,771] [INFO] [<frozen importlib] - Training completed at iteration 17
[2025-11-19 08:46:29,771] [INFO] [<frozen importlib] - Best train loss: 0.6333
[2025-11-19 08:46:29,771] [INFO] [<frozen importlib] - Best val loss: 0.5448
[2025-11-19 08:46:29,771] [INFO] [<frozen importlib] - Best val AUC: 0.6910
[2025-11-19 08:46:29,771] [INFO] [<frozen importlib] - Best val AUCPR: 0.2150
[2025-11-19 08:46:29,776] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:46:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:46:33,327] [INFO] [<frozen importlib] - Optimal threshold: 0.4862
[2025-11-19 08:46:33,327] [INFO] [<frozen importlib] - Best f1: 0.2600
[2025-11-19 08:46:33,327] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:46:33,372] [INFO] [<frozen importlib] - Validation Results (threshold=0.4862):
[2025-11-19 08:46:33,372] [INFO] [<frozen importlib] -   Accuracy: 0.8922
[2025-11-19 08:46:33,372] [INFO] [<frozen importlib] -   Precision: 0.2750
[2025-11-19 08:46:33,372] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 08:46:33,372] [INFO] [<frozen importlib] -   F1 Score: 0.2600
[2025-11-19 08:46:33,372] [INFO] [<frozen importlib] -   AUROC: 0.6910
[2025-11-19 08:46:33,372] [INFO] [<frozen importlib] -   AUPRC: 0.2142
[2025-11-19 08:46:33,372] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:46:33,372] [INFO] [<frozen importlib] -     TN=16501, FP=944
[2025-11-19 08:46:33,372] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 08:46:33,395] [INFO] [<frozen importlib] - Trial 160: AUPRC=0.2142, F1=0.4527, Prec=0.4261, Rec=0.4828 | Optimizing auprc=0.2142
[2025-11-19 08:46:33,395] [INFO] [<frozen importlib] - Trial 160 pruned.
[2025-11-19 08:46:33,395] [ERROR] [<frozen importlib] - Trial 160 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  32%|███▏      | 160/500 [24:31<56:11,  9.92s/it]Best trial: 140. Best value: 0.237476:  32%|███▏      | 160/500 [24:31<56:11,  9.92s/it]Best trial: 140. Best value: 0.237476:  32%|███▏      | 161/500 [24:31<45:47,  8.10s/it][2025-11-19 08:46:33,405] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.1848735986225405
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   gamma: 0.22976335693261618
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   alpha: 0.7858619627924954
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   lambda: 0.777799717265122
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   learning_rate: 0.06077056680224876
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   subsample: 0.8793318329003984
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   colsample_bytree: 0.5443727818070714
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   colsample_bylevel: 0.511366366277238
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   colsample_bynode: 0.7568230974800932
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:46:33,405] [INFO] [<frozen importlib] -   scale_pos_weight: 7.1848735986225405
[2025-11-19 08:46:33,484] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:46:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:46:33,396] Trial 160 pruned. 
[0]	train-logloss:0.70703	train-auc:0.64074	train-aucpr:0.22884	val-logloss:0.70514	val-auc:0.61992	val-aucpr:0.11275
[10]	train-logloss:0.67250	train-auc:0.68173	train-aucpr:0.28885	val-logloss:0.61664	val-auc:0.70097	val-aucpr:0.18704
[20]	train-logloss:0.65508	train-auc:0.69299	train-aucpr:0.30109	val-logloss:0.56495	val-auc:0.70648	val-aucpr:0.21372
[30]	train-logloss:0.64442	train-auc:0.70014	train-aucpr:0.31090	val-logloss:0.54533	val-auc:0.70835	val-aucpr:0.22912
[40]	train-logloss:0.63730	train-auc:0.70677	train-aucpr:0.31728	val-logloss:0.52793	val-auc:0.71401	val-aucpr:0.21402
[50]	train-logloss:0.63173	train-auc:0.71322	train-aucpr:0.32323	val-logloss:0.50456	val-auc:0.71207	val-aucpr:0.20928
[60]	train-logloss:0.62830	train-auc:0.71761	train-aucpr:0.32806	val-logloss:0.47924	val-auc:0.71137	val-aucpr:0.20534
[61]	train-logloss:0.62784	train-auc:0.71819	train-aucpr:0.32829	val-logloss:0.47526	val-auc:0.70921	val-aucpr:0.20232
[2025-11-19 08:46:33,675] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 08:46:33,675] [INFO] [<frozen importlib] - Best train loss: 0.6437
[2025-11-19 08:46:33,675] [INFO] [<frozen importlib] - Best val loss: 0.5435
[2025-11-19 08:46:33,675] [INFO] [<frozen importlib] - Best val AUC: 0.7076
[2025-11-19 08:46:33,675] [INFO] [<frozen importlib] - Best val AUCPR: 0.2295
[2025-11-19 08:46:33,680] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:46:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:46:40,402] [INFO] [<frozen importlib] - Optimal threshold: 0.5113
[2025-11-19 08:46:40,402] [INFO] [<frozen importlib] - Best f1: 0.2873
[2025-11-19 08:46:40,402] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:46:40,446] [INFO] [<frozen importlib] - Validation Results (threshold=0.5113):
[2025-11-19 08:46:40,446] [INFO] [<frozen importlib] -   Accuracy: 0.8981
[2025-11-19 08:46:40,446] [INFO] [<frozen importlib] -   Precision: 0.3106
[2025-11-19 08:46:40,446] [INFO] [<frozen importlib] -   Recall: 0.2672
[2025-11-19 08:46:40,446] [INFO] [<frozen importlib] -   F1 Score: 0.2873
[2025-11-19 08:46:40,446] [INFO] [<frozen importlib] -   AUROC: 0.7076
[2025-11-19 08:46:40,446] [INFO] [<frozen importlib] -   AUPRC: 0.2297
[2025-11-19 08:46:40,446] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:46:40,446] [INFO] [<frozen importlib] -     TN=16584, FP=861
[2025-11-19 08:46:40,446] [INFO] [<frozen importlib] -     FN=1064, TP=388
[2025-11-19 08:46:40,469] [INFO] [<frozen importlib] - Trial 161: AUPRC=0.2297, F1=0.4393, Prec=0.4306, Rec=0.4483 | Optimizing auprc=0.2297
                                                                                        Best trial: 140. Best value: 0.237476:  32%|███▏      | 161/500 [24:38<45:47,  8.10s/it]Best trial: 140. Best value: 0.237476:  32%|███▏      | 161/500 [24:38<45:47,  8.10s/it]Best trial: 140. Best value: 0.237476:  32%|███▏      | 162/500 [24:38<43:54,  7.79s/it][2025-11-19 08:46:40,478] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.128213172902238
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   gamma: 0.2370463554919241
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   alpha: 0.8008363426038692
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   lambda: 0.7247139083995466
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   learning_rate: 0.0612780878303912
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   subsample: 0.8802143066752149
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   colsample_bytree: 0.5463435259393525
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5073672520943193
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   colsample_bynode: 0.7554577118269222
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:46:40,478] [INFO] [<frozen importlib] -   scale_pos_weight: 7.128213172902238
[2025-11-19 08:46:40,552] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:46:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:46:40,469] Trial 161 finished with value: 0.2296865674333259 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.22976335693261618, 'learning_rate': 0.06077056680224876, 'n_estimators': 450, 'alpha': 0.7858619627924954, 'lambda': 0.777799717265122, 'subsample': 0.8793318329003984, 'colsample_bytree': 0.5443727818070714, 'colsample_bylevel': 0.511366366277238, 'colsample_bynode': 0.7568230974800932, 'scale_pos_weight': 7.1848735986225405}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.70360	train-auc:0.64314	train-aucpr:0.23191	val-logloss:0.69752	val-auc:0.61110	val-aucpr:0.13553
[10]	train-logloss:0.66936	train-auc:0.68489	train-aucpr:0.28883	val-logloss:0.61938	val-auc:0.66861	val-aucpr:0.20695
[20]	train-logloss:0.65213	train-auc:0.69536	train-aucpr:0.30294	val-logloss:0.58872	val-auc:0.68198	val-aucpr:0.21539
[30]	train-logloss:0.64198	train-auc:0.70089	train-aucpr:0.31044	val-logloss:0.56242	val-auc:0.69137	val-aucpr:0.22674
[40]	train-logloss:0.63527	train-auc:0.70712	train-aucpr:0.31632	val-logloss:0.55419	val-auc:0.69834	val-aucpr:0.21970
[50]	train-logloss:0.62960	train-auc:0.71407	train-aucpr:0.32253	val-logloss:0.54354	val-auc:0.69955	val-aucpr:0.21452
[59]	train-logloss:0.62591	train-auc:0.71824	train-aucpr:0.32822	val-logloss:0.51122	val-auc:0.69686	val-aucpr:0.21516
[2025-11-19 08:46:40,735] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:46:40,735] [INFO] [<frozen importlib] - Best train loss: 0.6428
[2025-11-19 08:46:40,735] [INFO] [<frozen importlib] - Best val loss: 0.5680
[2025-11-19 08:46:40,735] [INFO] [<frozen importlib] - Best val AUC: 0.6916
[2025-11-19 08:46:40,735] [INFO] [<frozen importlib] - Best val AUCPR: 0.2289
[2025-11-19 08:46:40,739] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:46:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:46:47,771] [INFO] [<frozen importlib] - Optimal threshold: 0.5227
[2025-11-19 08:46:47,771] [INFO] [<frozen importlib] - Best f1: 0.2749
[2025-11-19 08:46:47,771] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:46:47,817] [INFO] [<frozen importlib] - Validation Results (threshold=0.5227):
[2025-11-19 08:46:47,817] [INFO] [<frozen importlib] -   Accuracy: 0.8947
[2025-11-19 08:46:47,817] [INFO] [<frozen importlib] -   Precision: 0.2920
[2025-11-19 08:46:47,817] [INFO] [<frozen importlib] -   Recall: 0.2596
[2025-11-19 08:46:47,817] [INFO] [<frozen importlib] -   F1 Score: 0.2749
[2025-11-19 08:46:47,817] [INFO] [<frozen importlib] -   AUROC: 0.6916
[2025-11-19 08:46:47,817] [INFO] [<frozen importlib] -   AUPRC: 0.2291
[2025-11-19 08:46:47,817] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:46:47,817] [INFO] [<frozen importlib] -     TN=16531, FP=914
[2025-11-19 08:46:47,817] [INFO] [<frozen importlib] -     FN=1075, TP=377
[2025-11-19 08:46:47,842] [INFO] [<frozen importlib] - Trial 162: AUPRC=0.2291, F1=0.4295, Prec=0.4145, Rec=0.4456 | Optimizing auprc=0.2291
                                                                                        Best trial: 140. Best value: 0.237476:  32%|███▏      | 162/500 [24:45<43:54,  7.79s/it]Best trial: 140. Best value: 0.237476:  32%|███▏      | 162/500 [24:45<43:54,  7.79s/it]Best trial: 140. Best value: 0.237476:  33%|███▎      | 163/500 [24:45<43:04,  7.67s/it][2025-11-19 08:46:47,859] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.707998293223288
[2025-11-19 08:46:47,859] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:46:47,859] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:46:47,859] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:46:47,859] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   gamma: 0.3113121478673275
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   alpha: 0.9513458906426157
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   lambda: 0.7892345761262007
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   learning_rate: 0.056939359099442415
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   subsample: 0.8725897616623706
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   colsample_bytree: 0.5320926254905373
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5358362568929453
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   colsample_bynode: 0.7392216004283387
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:46:47,860] [INFO] [<frozen importlib] -   scale_pos_weight: 5.707998293223288
[2025-11-19 08:46:47,940] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:46:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:46:47,843] Trial 162 finished with value: 0.22911150471173608 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.2370463554919241, 'learning_rate': 0.0612780878303912, 'n_estimators': 450, 'alpha': 0.8008363426038692, 'lambda': 0.7247139083995466, 'subsample': 0.8802143066752149, 'colsample_bytree': 0.5463435259393525, 'colsample_bylevel': 0.5073672520943193, 'colsample_bynode': 0.7554577118269222, 'scale_pos_weight': 7.128213172902238}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.62643	train-auc:0.63571	train-aucpr:0.22868	val-logloss:0.61317	val-auc:0.64325	val-aucpr:0.13624
[10]	train-logloss:0.59805	train-auc:0.68080	train-aucpr:0.29403	val-logloss:0.54783	val-auc:0.68768	val-aucpr:0.19767
[20]	train-logloss:0.58271	train-auc:0.69059	train-aucpr:0.30736	val-logloss:0.50820	val-auc:0.70313	val-aucpr:0.21624
[30]	train-logloss:0.57421	train-auc:0.69635	train-aucpr:0.31108	val-logloss:0.47642	val-auc:0.70306	val-aucpr:0.21719
[40]	train-logloss:0.56778	train-auc:0.70532	train-aucpr:0.31790	val-logloss:0.46066	val-auc:0.69630	val-aucpr:0.20772
[50]	train-logloss:0.56292	train-auc:0.71083	train-aucpr:0.32307	val-logloss:0.44976	val-auc:0.69082	val-aucpr:0.20054
[60]	train-logloss:0.55906	train-auc:0.71724	train-aucpr:0.32979	val-logloss:0.44181	val-auc:0.69354	val-aucpr:0.20493
[64]	train-logloss:0.55786	train-auc:0.71897	train-aucpr:0.33203	val-logloss:0.44190	val-auc:0.68753	val-aucpr:0.19866
[2025-11-19 08:46:48,139] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:46:48,139] [INFO] [<frozen importlib] - Best train loss: 0.5717
[2025-11-19 08:46:48,139] [INFO] [<frozen importlib] - Best val loss: 0.4676
[2025-11-19 08:46:48,139] [INFO] [<frozen importlib] - Best val AUC: 0.7051
[2025-11-19 08:46:48,139] [INFO] [<frozen importlib] - Best val AUCPR: 0.2190
[2025-11-19 08:46:48,144] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:46:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:46:57,689] [INFO] [<frozen importlib] - Optimal threshold: 0.4350
[2025-11-19 08:46:57,690] [INFO] [<frozen importlib] - Best f1: 0.2672
[2025-11-19 08:46:57,690] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:46:57,733] [INFO] [<frozen importlib] - Validation Results (threshold=0.4350):
[2025-11-19 08:46:57,733] [INFO] [<frozen importlib] -   Accuracy: 0.8923
[2025-11-19 08:46:57,733] [INFO] [<frozen importlib] -   Precision: 0.2800
[2025-11-19 08:46:57,733] [INFO] [<frozen importlib] -   Recall: 0.2555
[2025-11-19 08:46:57,733] [INFO] [<frozen importlib] -   F1 Score: 0.2672
[2025-11-19 08:46:57,733] [INFO] [<frozen importlib] -   AUROC: 0.7051
[2025-11-19 08:46:57,733] [INFO] [<frozen importlib] -   AUPRC: 0.2195
[2025-11-19 08:46:57,733] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:46:57,733] [INFO] [<frozen importlib] -     TN=16491, FP=954
[2025-11-19 08:46:57,733] [INFO] [<frozen importlib] -     FN=1081, TP=371
[2025-11-19 08:46:57,761] [INFO] [<frozen importlib] - Trial 163: AUPRC=0.2195, F1=0.4457, Prec=0.4197, Rec=0.4752 | Optimizing auprc=0.2195
[2025-11-19 08:46:57,761] [INFO] [<frozen importlib] - Trial 163 pruned.
[2025-11-19 08:46:57,761] [ERROR] [<frozen importlib] - Trial 163 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  33%|███▎      | 163/500 [24:55<43:04,  7.67s/it]Best trial: 140. Best value: 0.237476:  33%|███▎      | 163/500 [24:55<43:04,  7.67s/it]Best trial: 140. Best value: 0.237476:  33%|███▎      | 164/500 [24:55<46:43,  8.34s/it][2025-11-19 08:46:57,770] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.504242241747037
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   gamma: 0.20377646788218506
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   alpha: 0.7626766022201227
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   lambda: 0.5694459445984175
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   learning_rate: 0.06852724633911228
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   subsample: 0.8867065321845927
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   colsample_bytree: 0.5264830230103107
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5126420717667928
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   colsample_bynode: 0.7646944137772764
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:46:57,770] [INFO] [<frozen importlib] -   scale_pos_weight: 7.504242241747037
[2025-11-19 08:46:57,841] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:46:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:46:57,761] Trial 163 pruned. 
[0]	train-logloss:0.72356	train-auc:0.63227	train-aucpr:0.22153	val-logloss:0.72020	val-auc:0.64524	val-aucpr:0.12193
[10]	train-logloss:0.68578	train-auc:0.68398	train-aucpr:0.28959	val-logloss:0.63757	val-auc:0.66376	val-aucpr:0.16455
[20]	train-logloss:0.66766	train-auc:0.69488	train-aucpr:0.30316	val-logloss:0.59798	val-auc:0.67888	val-aucpr:0.19217
[30]	train-logloss:0.65781	train-auc:0.69965	train-aucpr:0.31186	val-logloss:0.56154	val-auc:0.70232	val-aucpr:0.21062
[40]	train-logloss:0.65050	train-auc:0.70708	train-aucpr:0.31927	val-logloss:0.55961	val-auc:0.68917	val-aucpr:0.19665
[50]	train-logloss:0.64452	train-auc:0.71507	train-aucpr:0.32707	val-logloss:0.54479	val-auc:0.67154	val-aucpr:0.17039
[59]	train-logloss:0.64010	train-auc:0.72209	train-aucpr:0.33542	val-logloss:0.53881	val-auc:0.67085	val-aucpr:0.17261
[2025-11-19 08:46:58,031] [INFO] [<frozen importlib] - Training completed at iteration 30
[2025-11-19 08:46:58,031] [INFO] [<frozen importlib] - Best train loss: 0.6578
[2025-11-19 08:46:58,031] [INFO] [<frozen importlib] - Best val loss: 0.5615
[2025-11-19 08:46:58,031] [INFO] [<frozen importlib] - Best val AUC: 0.7023
[2025-11-19 08:46:58,031] [INFO] [<frozen importlib] - Best val AUCPR: 0.2106
[2025-11-19 08:46:58,036] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:46:58] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:47:05,678] [INFO] [<frozen importlib] - Optimal threshold: 0.5195
[2025-11-19 08:47:05,679] [INFO] [<frozen importlib] - Best f1: 0.2644
[2025-11-19 08:47:05,679] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:47:05,720] [INFO] [<frozen importlib] - Validation Results (threshold=0.5195):
[2025-11-19 08:47:05,720] [INFO] [<frozen importlib] -   Accuracy: 0.8848
[2025-11-19 08:47:05,720] [INFO] [<frozen importlib] -   Precision: 0.2596
[2025-11-19 08:47:05,720] [INFO] [<frozen importlib] -   Recall: 0.2693
[2025-11-19 08:47:05,720] [INFO] [<frozen importlib] -   F1 Score: 0.2644
[2025-11-19 08:47:05,720] [INFO] [<frozen importlib] -   AUROC: 0.7023
[2025-11-19 08:47:05,720] [INFO] [<frozen importlib] -   AUPRC: 0.2113
[2025-11-19 08:47:05,720] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:47:05,720] [INFO] [<frozen importlib] -     TN=16330, FP=1115
[2025-11-19 08:47:05,720] [INFO] [<frozen importlib] -     FN=1061, TP=391
[2025-11-19 08:47:05,743] [INFO] [<frozen importlib] - Trial 164: AUPRC=0.2113, F1=0.4550, Prec=0.4041, Rec=0.5207 | Optimizing auprc=0.2113
[2025-11-19 08:47:05,743] [INFO] [<frozen importlib] - Trial 164 pruned.
[2025-11-19 08:47:05,743] [ERROR] [<frozen importlib] - Trial 164 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  33%|███▎      | 164/500 [25:03<46:43,  8.34s/it]Best trial: 140. Best value: 0.237476:  33%|███▎      | 164/500 [25:03<46:43,  8.34s/it]Best trial: 140. Best value: 0.237476:  33%|███▎      | 165/500 [25:03<45:58,  8.23s/it][2025-11-19 08:47:05,752] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.501916515635108
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] -   gamma: 0.2610963130983135
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] -   alpha: 0.8575454287097788
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] -   lambda: 0.2547060082168161
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] -   learning_rate: 0.04176336929788586
[2025-11-19 08:47:05,752] [INFO] [<frozen importlib] -   subsample: 0.7790921015841327
[2025-11-19 08:47:05,753] [INFO] [<frozen importlib] -   colsample_bytree: 0.541708992903582
[2025-11-19 08:47:05,753] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5525050143870874
[2025-11-19 08:47:05,753] [INFO] [<frozen importlib] -   colsample_bynode: 0.6763779297785898
[2025-11-19 08:47:05,753] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:47:05,753] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:47:05,753] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:47:05,753] [INFO] [<frozen importlib] -   scale_pos_weight: 6.501916515635108
[2025-11-19 08:47:05,825] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:47:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:47:05,743] Trial 164 pruned. 
[0]	train-logloss:0.67124	train-auc:0.64730	train-aucpr:0.23883	val-logloss:0.66276	val-auc:0.61767	val-aucpr:0.13450
[10]	train-logloss:0.64664	train-auc:0.67781	train-aucpr:0.29034	val-logloss:0.59880	val-auc:0.69158	val-aucpr:0.18353
[20]	train-logloss:0.63155	train-auc:0.68769	train-aucpr:0.29945	val-logloss:0.55972	val-auc:0.70373	val-aucpr:0.20727
[30]	train-logloss:0.62162	train-auc:0.69279	train-aucpr:0.30666	val-logloss:0.52476	val-auc:0.70635	val-aucpr:0.21744
[40]	train-logloss:0.61436	train-auc:0.69803	train-aucpr:0.31158	val-logloss:0.52152	val-auc:0.70584	val-aucpr:0.22289
[50]	train-logloss:0.60881	train-auc:0.70275	train-aucpr:0.31560	val-logloss:0.51200	val-auc:0.70568	val-aucpr:0.22642
[60]	train-logloss:0.60483	train-auc:0.70709	train-aucpr:0.31895	val-logloss:0.51026	val-auc:0.70433	val-aucpr:0.22330
[70]	train-logloss:0.60167	train-auc:0.71069	train-aucpr:0.32213	val-logloss:0.49410	val-auc:0.70087	val-aucpr:0.21724
[75]	train-logloss:0.60057	train-auc:0.71260	train-aucpr:0.32430	val-logloss:0.48701	val-auc:0.69523	val-aucpr:0.21998
[2025-11-19 08:47:06,053] [INFO] [<frozen importlib] - Training completed at iteration 46
[2025-11-19 08:47:06,053] [INFO] [<frozen importlib] - Best train loss: 0.6106
[2025-11-19 08:47:06,053] [INFO] [<frozen importlib] - Best val loss: 0.5145
[2025-11-19 08:47:06,053] [INFO] [<frozen importlib] - Best val AUC: 0.7072
[2025-11-19 08:47:06,053] [INFO] [<frozen importlib] - Best val AUCPR: 0.2274
[2025-11-19 08:47:06,059] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:47:06] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:47:17,299] [INFO] [<frozen importlib] - Optimal threshold: 0.4939
[2025-11-19 08:47:17,299] [INFO] [<frozen importlib] - Best f1: 0.2623
[2025-11-19 08:47:17,299] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:47:17,346] [INFO] [<frozen importlib] - Validation Results (threshold=0.4939):
[2025-11-19 08:47:17,346] [INFO] [<frozen importlib] -   Accuracy: 0.8970
[2025-11-19 08:47:17,346] [INFO] [<frozen importlib] -   Precision: 0.2917
[2025-11-19 08:47:17,346] [INFO] [<frozen importlib] -   Recall: 0.2383
[2025-11-19 08:47:17,346] [INFO] [<frozen importlib] -   F1 Score: 0.2623
[2025-11-19 08:47:17,346] [INFO] [<frozen importlib] -   AUROC: 0.7072
[2025-11-19 08:47:17,346] [INFO] [<frozen importlib] -   AUPRC: 0.2278
[2025-11-19 08:47:17,346] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:47:17,346] [INFO] [<frozen importlib] -     TN=16605, FP=840
[2025-11-19 08:47:17,346] [INFO] [<frozen importlib] -     FN=1106, TP=346
[2025-11-19 08:47:17,369] [INFO] [<frozen importlib] - Trial 165: AUPRC=0.2278, F1=0.4493, Prec=0.4415, Rec=0.4573 | Optimizing auprc=0.2278
                                                                                        Best trial: 140. Best value: 0.237476:  33%|███▎      | 165/500 [25:15<45:58,  8.23s/it]Best trial: 140. Best value: 0.237476:  33%|███▎      | 165/500 [25:15<45:58,  8.23s/it]Best trial: 140. Best value: 0.237476:  33%|███▎      | 166/500 [25:15<51:30,  9.25s/it][2025-11-19 08:47:17,380] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.950816814850659
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   gamma: 0.3496818018683129
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   alpha: 1.2079715646052807
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   lambda: 1.8040551623712648
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   learning_rate: 0.05941246449383231
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   subsample: 0.7646635483196514
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   colsample_bytree: 0.5983753611437661
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5312422948624258
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   colsample_bynode: 0.7466129118871441
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:47:17,380] [INFO] [<frozen importlib] -   scale_pos_weight: 5.950816814850659
[2025-11-19 08:47:17,454] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:47:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:47:17,370] Trial 165 finished with value: 0.2277723166228866 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.2610963130983135, 'learning_rate': 0.04176336929788586, 'n_estimators': 450, 'alpha': 0.8575454287097788, 'lambda': 0.2547060082168161, 'subsample': 0.7790921015841327, 'colsample_bytree': 0.541708992903582, 'colsample_bylevel': 0.5525050143870874, 'colsample_bynode': 0.6763779297785898, 'scale_pos_weight': 6.501916515635108}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.63939	train-auc:0.64695	train-aucpr:0.24175	val-logloss:0.62574	val-auc:0.65820	val-aucpr:0.15038
[10]	train-logloss:0.60921	train-auc:0.68628	train-aucpr:0.29440	val-logloss:0.56075	val-auc:0.68406	val-aucpr:0.19055
[20]	train-logloss:0.59385	train-auc:0.69444	train-aucpr:0.30607	val-logloss:0.52382	val-auc:0.70700	val-aucpr:0.22134
[30]	train-logloss:0.58427	train-auc:0.70081	train-aucpr:0.31365	val-logloss:0.49627	val-auc:0.71871	val-aucpr:0.22321
[40]	train-logloss:0.57786	train-auc:0.70854	train-aucpr:0.31989	val-logloss:0.49112	val-auc:0.71824	val-aucpr:0.21888
[50]	train-logloss:0.57280	train-auc:0.71494	train-aucpr:0.32586	val-logloss:0.48240	val-auc:0.71208	val-aucpr:0.21498
[59]	train-logloss:0.56953	train-auc:0.71983	train-aucpr:0.33104	val-logloss:0.46900	val-auc:0.69656	val-aucpr:0.20407
[2025-11-19 08:47:17,638] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:47:17,638] [INFO] [<frozen importlib] - Best train loss: 0.5851
[2025-11-19 08:47:17,638] [INFO] [<frozen importlib] - Best val loss: 0.4980
[2025-11-19 08:47:17,638] [INFO] [<frozen importlib] - Best val AUC: 0.7181
[2025-11-19 08:47:17,638] [INFO] [<frozen importlib] - Best val AUCPR: 0.2239
[2025-11-19 08:47:17,642] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:47:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:47:25,232] [INFO] [<frozen importlib] - Optimal threshold: 0.4636
[2025-11-19 08:47:25,232] [INFO] [<frozen importlib] - Best f1: 0.2866
[2025-11-19 08:47:25,232] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:47:25,279] [INFO] [<frozen importlib] - Validation Results (threshold=0.4636):
[2025-11-19 08:47:25,279] [INFO] [<frozen importlib] -   Accuracy: 0.8917
[2025-11-19 08:47:25,279] [INFO] [<frozen importlib] -   Precision: 0.2903
[2025-11-19 08:47:25,279] [INFO] [<frozen importlib] -   Recall: 0.2831
[2025-11-19 08:47:25,279] [INFO] [<frozen importlib] -   F1 Score: 0.2866
[2025-11-19 08:47:25,279] [INFO] [<frozen importlib] -   AUROC: 0.7181
[2025-11-19 08:47:25,279] [INFO] [<frozen importlib] -   AUPRC: 0.2244
[2025-11-19 08:47:25,279] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:47:25,279] [INFO] [<frozen importlib] -     TN=16440, FP=1005
[2025-11-19 08:47:25,279] [INFO] [<frozen importlib] -     FN=1041, TP=411
[2025-11-19 08:47:25,302] [INFO] [<frozen importlib] - Trial 166: AUPRC=0.2244, F1=0.4518, Prec=0.4164, Rec=0.4938 | Optimizing auprc=0.2244
[2025-11-19 08:47:25,303] [INFO] [<frozen importlib] - Trial 166 pruned.
[2025-11-19 08:47:25,303] [ERROR] [<frozen importlib] - Trial 166 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  33%|███▎      | 166/500 [25:23<51:30,  9.25s/it]Best trial: 140. Best value: 0.237476:  33%|███▎      | 166/500 [25:23<51:30,  9.25s/it]Best trial: 140. Best value: 0.237476:  33%|███▎      | 167/500 [25:23<49:09,  8.86s/it][2025-11-19 08:47:25,314] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.889478883634689
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   gamma: 0.2851110670555834
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   alpha: 0.7251452283362643
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   lambda: 0.8972808208444727
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   learning_rate: 0.03829443321335282
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   subsample: 0.7987918866767152
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   colsample_bytree: 0.5618120009685518
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5425495813773773
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   colsample_bynode: 0.775955812003653
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:47:25,314] [INFO] [<frozen importlib] -   scale_pos_weight: 6.889478883634689
[2025-11-19 08:47:25,391] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:47:25] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:47:25,303] Trial 166 pruned. 
[0]	train-logloss:0.69286	train-auc:0.63981	train-aucpr:0.23116	val-logloss:0.68960	val-auc:0.62879	val-aucpr:0.12771
[10]	train-logloss:0.66857	train-auc:0.68119	train-aucpr:0.28890	val-logloss:0.62558	val-auc:0.66769	val-aucpr:0.17153
[20]	train-logloss:0.65348	train-auc:0.68758	train-aucpr:0.29647	val-logloss:0.58647	val-auc:0.69101	val-aucpr:0.20633
[30]	train-logloss:0.64277	train-auc:0.69338	train-aucpr:0.30532	val-logloss:0.55907	val-auc:0.68461	val-aucpr:0.21518
[40]	train-logloss:0.63510	train-auc:0.69827	train-aucpr:0.31008	val-logloss:0.53317	val-auc:0.69002	val-aucpr:0.22095
[50]	train-logloss:0.62936	train-auc:0.70238	train-aucpr:0.31414	val-logloss:0.52667	val-auc:0.69800	val-aucpr:0.22903
[60]	train-logloss:0.62485	train-auc:0.70664	train-aucpr:0.31800	val-logloss:0.52498	val-auc:0.70106	val-aucpr:0.23159
[70]	train-logloss:0.62122	train-auc:0.71099	train-aucpr:0.32153	val-logloss:0.52555	val-auc:0.69456	val-aucpr:0.21723
[80]	train-logloss:0.61784	train-auc:0.71451	train-aucpr:0.32632	val-logloss:0.51413	val-auc:0.69462	val-aucpr:0.21446
[87]	train-logloss:0.61582	train-auc:0.71672	train-aucpr:0.32912	val-logloss:0.51399	val-auc:0.69386	val-aucpr:0.21468
[2025-11-19 08:47:25,645] [INFO] [<frozen importlib] - Training completed at iteration 57
[2025-11-19 08:47:25,645] [INFO] [<frozen importlib] - Best train loss: 0.6263
[2025-11-19 08:47:25,645] [INFO] [<frozen importlib] - Best val loss: 0.5255
[2025-11-19 08:47:25,645] [INFO] [<frozen importlib] - Best val AUC: 0.7013
[2025-11-19 08:47:25,645] [INFO] [<frozen importlib] - Best val AUCPR: 0.2316
[2025-11-19 08:47:25,650] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:47:25] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:47:37,780] [INFO] [<frozen importlib] - Optimal threshold: 0.5139
[2025-11-19 08:47:37,780] [INFO] [<frozen importlib] - Best f1: 0.2748
[2025-11-19 08:47:37,780] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:47:37,827] [INFO] [<frozen importlib] - Validation Results (threshold=0.5139):
[2025-11-19 08:47:37,827] [INFO] [<frozen importlib] -   Accuracy: 0.9087
[2025-11-19 08:47:37,827] [INFO] [<frozen importlib] -   Precision: 0.3524
[2025-11-19 08:47:37,827] [INFO] [<frozen importlib] -   Recall: 0.2252
[2025-11-19 08:47:37,827] [INFO] [<frozen importlib] -   F1 Score: 0.2748
[2025-11-19 08:47:37,827] [INFO] [<frozen importlib] -   AUROC: 0.7013
[2025-11-19 08:47:37,827] [INFO] [<frozen importlib] -   AUPRC: 0.2320
[2025-11-19 08:47:37,827] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:47:37,827] [INFO] [<frozen importlib] -     TN=16844, FP=601
[2025-11-19 08:47:37,827] [INFO] [<frozen importlib] -     FN=1125, TP=327
[2025-11-19 08:47:37,851] [INFO] [<frozen importlib] - Trial 167: AUPRC=0.2320, F1=0.4541, Prec=0.5008, Rec=0.4153 | Optimizing auprc=0.2320
                                                                                        Best trial: 140. Best value: 0.237476:  33%|███▎      | 167/500 [25:35<49:09,  8.86s/it]Best trial: 140. Best value: 0.237476:  33%|███▎      | 167/500 [25:35<49:09,  8.86s/it]Best trial: 140. Best value: 0.237476:  34%|███▎      | 168/500 [25:35<55:08,  9.96s/it][2025-11-19 08:47:37,861] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.200922947349408
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   gamma: 0.28790878334614467
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   alpha: 0.7061298463812362
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   lambda: 0.9248703487300352
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   learning_rate: 0.03846184388583397
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   subsample: 0.7982498702448033
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   colsample_bytree: 0.8104244053764598
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   colsample_bylevel: 0.546967870193813
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   colsample_bynode: 0.5133046809822561
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:47:37,862] [INFO] [<frozen importlib] -   scale_pos_weight: 7.200922947349408
[2025-11-19 08:47:37,935] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:47:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:47:37,852] Trial 167 finished with value: 0.23195720487558055 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.2851110670555834, 'learning_rate': 0.03829443321335282, 'n_estimators': 450, 'alpha': 0.7251452283362643, 'lambda': 0.8972808208444727, 'subsample': 0.7987918866767152, 'colsample_bytree': 0.5618120009685518, 'colsample_bylevel': 0.5425495813773773, 'colsample_bynode': 0.775955812003653, 'scale_pos_weight': 6.889478883634689}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.70955	train-auc:0.64701	train-aucpr:0.23551	val-logloss:0.70812	val-auc:0.57617	val-aucpr:0.09688
[10]	train-logloss:0.68397	train-auc:0.67744	train-aucpr:0.28373	val-logloss:0.64316	val-auc:0.70008	val-aucpr:0.20259
[20]	train-logloss:0.66798	train-auc:0.68655	train-aucpr:0.29582	val-logloss:0.60128	val-auc:0.69592	val-aucpr:0.21015
[30]	train-logloss:0.65715	train-auc:0.69185	train-aucpr:0.30257	val-logloss:0.57198	val-auc:0.70641	val-aucpr:0.21775
[40]	train-logloss:0.64939	train-auc:0.69785	train-aucpr:0.30770	val-logloss:0.55345	val-auc:0.70541	val-aucpr:0.21864
[50]	train-logloss:0.64315	train-auc:0.70390	train-aucpr:0.31241	val-logloss:0.53739	val-auc:0.70038	val-aucpr:0.21057
[60]	train-logloss:0.63876	train-auc:0.70781	train-aucpr:0.31683	val-logloss:0.53330	val-auc:0.70128	val-aucpr:0.21803
[68]	train-logloss:0.63565	train-auc:0.71174	train-aucpr:0.32072	val-logloss:0.52289	val-auc:0.69296	val-aucpr:0.21873
[2025-11-19 08:47:38,141] [INFO] [<frozen importlib] - Training completed at iteration 38
[2025-11-19 08:47:38,141] [INFO] [<frozen importlib] - Best train loss: 0.6506
[2025-11-19 08:47:38,141] [INFO] [<frozen importlib] - Best val loss: 0.5513
[2025-11-19 08:47:38,141] [INFO] [<frozen importlib] - Best val AUC: 0.7072
[2025-11-19 08:47:38,141] [INFO] [<frozen importlib] - Best val AUCPR: 0.2224
[2025-11-19 08:47:38,146] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:47:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:47:46,536] [INFO] [<frozen importlib] - Optimal threshold: 0.4984
[2025-11-19 08:47:46,536] [INFO] [<frozen importlib] - Best f1: 0.2732
[2025-11-19 08:47:46,536] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:47:46,591] [INFO] [<frozen importlib] - Validation Results (threshold=0.4984):
[2025-11-19 08:47:46,591] [INFO] [<frozen importlib] -   Accuracy: 0.8882
[2025-11-19 08:47:46,591] [INFO] [<frozen importlib] -   Precision: 0.2730
[2025-11-19 08:47:46,591] [INFO] [<frozen importlib] -   Recall: 0.2734
[2025-11-19 08:47:46,591] [INFO] [<frozen importlib] -   F1 Score: 0.2732
[2025-11-19 08:47:46,591] [INFO] [<frozen importlib] -   AUROC: 0.7072
[2025-11-19 08:47:46,591] [INFO] [<frozen importlib] -   AUPRC: 0.2227
[2025-11-19 08:47:46,591] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:47:46,591] [INFO] [<frozen importlib] -     TN=16388, FP=1057
[2025-11-19 08:47:46,591] [INFO] [<frozen importlib] -     FN=1055, TP=397
[2025-11-19 08:47:46,616] [INFO] [<frozen importlib] - Trial 168: AUPRC=0.2227, F1=0.4612, Prec=0.4157, Rec=0.5179 | Optimizing auprc=0.2227
                                                                                        Best trial: 140. Best value: 0.237476:  34%|███▎      | 168/500 [25:44<55:08,  9.96s/it]Best trial: 140. Best value: 0.237476:  34%|███▎      | 168/500 [25:44<55:08,  9.96s/it]Best trial: 140. Best value: 0.237476:  34%|███▍      | 169/500 [25:44<52:59,  9.60s/it][2025-11-19 08:47:46,628] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.875073719866693
[2025-11-19 08:47:46,628] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:47:46,628] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:47:46,628] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:47:46,628] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   gamma: 0.17016141574430343
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   alpha: 1.004142597390739
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   lambda: 1.0239712123528615
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   learning_rate: 0.03557620226667206
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   subsample: 0.7849571185009926
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   colsample_bytree: 0.5598452576817794
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5176811647533737
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   colsample_bynode: 0.7310409294230651
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:47:46,629] [INFO] [<frozen importlib] -   scale_pos_weight: 7.875073719866693
[2025-11-19 08:47:46,705] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:47:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:47:46,617] Trial 168 finished with value: 0.222663102345604 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.28790878334614467, 'learning_rate': 0.03846184388583397, 'n_estimators': 450, 'alpha': 0.7061298463812362, 'lambda': 0.9248703487300352, 'subsample': 0.7982498702448033, 'colsample_bytree': 0.8104244053764598, 'colsample_bylevel': 0.546967870193813, 'colsample_bynode': 0.5133046809822561, 'scale_pos_weight': 7.200922947349408}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.74480	train-auc:0.64421	train-aucpr:0.22269	val-logloss:0.74780	val-auc:0.62678	val-aucpr:0.11446
[10]	train-logloss:0.71888	train-auc:0.68149	train-aucpr:0.29128	val-logloss:0.68315	val-auc:0.69201	val-aucpr:0.20050
[20]	train-logloss:0.70305	train-auc:0.68680	train-aucpr:0.29672	val-logloss:0.64168	val-auc:0.69004	val-aucpr:0.20675
[30]	train-logloss:0.69205	train-auc:0.69164	train-aucpr:0.30149	val-logloss:0.62073	val-auc:0.68875	val-aucpr:0.21336
[40]	train-logloss:0.68391	train-auc:0.69679	train-aucpr:0.30497	val-logloss:0.58447	val-auc:0.69859	val-aucpr:0.21684
[50]	train-logloss:0.67764	train-auc:0.70046	train-aucpr:0.30956	val-logloss:0.56705	val-auc:0.70522	val-aucpr:0.21637
[60]	train-logloss:0.67299	train-auc:0.70445	train-aucpr:0.31354	val-logloss:0.56193	val-auc:0.70913	val-aucpr:0.22227
[70]	train-logloss:0.66885	train-auc:0.70882	train-aucpr:0.31702	val-logloss:0.55349	val-auc:0.70357	val-aucpr:0.21518
[80]	train-logloss:0.66500	train-auc:0.71312	train-aucpr:0.32187	val-logloss:0.54057	val-auc:0.69808	val-aucpr:0.20731
[89]	train-logloss:0.66242	train-auc:0.71585	train-aucpr:0.32482	val-logloss:0.53674	val-auc:0.68481	val-aucpr:0.19040
[2025-11-19 08:47:46,967] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:47:46,967] [INFO] [<frozen importlib] - Best train loss: 0.6730
[2025-11-19 08:47:46,967] [INFO] [<frozen importlib] - Best val loss: 0.5619
[2025-11-19 08:47:46,967] [INFO] [<frozen importlib] - Best val AUC: 0.7091
[2025-11-19 08:47:46,967] [INFO] [<frozen importlib] - Best val AUCPR: 0.2223
[2025-11-19 08:47:46,974] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:47:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:47:59,969] [INFO] [<frozen importlib] - Optimal threshold: 0.5287
[2025-11-19 08:47:59,969] [INFO] [<frozen importlib] - Best f1: 0.2733
[2025-11-19 08:47:59,970] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:48:00,012] [INFO] [<frozen importlib] - Validation Results (threshold=0.5287):
[2025-11-19 08:48:00,012] [INFO] [<frozen importlib] -   Accuracy: 0.9029
[2025-11-19 08:48:00,012] [INFO] [<frozen importlib] -   Precision: 0.3215
[2025-11-19 08:48:00,012] [INFO] [<frozen importlib] -   Recall: 0.2376
[2025-11-19 08:48:00,012] [INFO] [<frozen importlib] -   F1 Score: 0.2733
[2025-11-19 08:48:00,012] [INFO] [<frozen importlib] -   AUROC: 0.7091
[2025-11-19 08:48:00,012] [INFO] [<frozen importlib] -   AUPRC: 0.2229
[2025-11-19 08:48:00,012] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:48:00,012] [INFO] [<frozen importlib] -     TN=16717, FP=728
[2025-11-19 08:48:00,012] [INFO] [<frozen importlib] -     FN=1107, TP=345
[2025-11-19 08:48:00,035] [INFO] [<frozen importlib] - Trial 169: AUPRC=0.2229, F1=0.4490, Prec=0.4643, Rec=0.4346 | Optimizing auprc=0.2229
[2025-11-19 08:48:00,036] [INFO] [<frozen importlib] - Trial 169 pruned.
[2025-11-19 08:48:00,036] [ERROR] [<frozen importlib] - Trial 169 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  34%|███▍      | 169/500 [25:58<52:59,  9.60s/it]Best trial: 140. Best value: 0.237476:  34%|███▍      | 169/500 [25:58<52:59,  9.60s/it]Best trial: 140. Best value: 0.237476:  34%|███▍      | 170/500 [25:58<59:07, 10.75s/it][2025-11-19 08:48:00,045] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 13.416518261327672
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   gamma: 0.2715637937833907
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   alpha: 1.0518486851935678
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   lambda: 1.1553594394678413
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   learning_rate: 0.06547920455177304
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   subsample: 0.7691144636072375
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   colsample_bytree: 0.5779038393134514
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   colsample_bylevel: 0.541716773829935
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   colsample_bynode: 0.756498999065482
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:48:00,045] [INFO] [<frozen importlib] -   scale_pos_weight: 13.416518261327672
[2025-11-19 08:48:00,125] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:48:00] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:48:00,036] Trial 169 pruned. 
[0]	train-logloss:0.97886	train-auc:0.64143	train-aucpr:0.21581	val-logloss:1.00122	val-auc:0.56654	val-aucpr:0.11060
[10]	train-logloss:0.92875	train-auc:0.68470	train-aucpr:0.28910	val-logloss:0.86226	val-auc:0.69949	val-aucpr:0.21083
[20]	train-logloss:0.90578	train-auc:0.69393	train-aucpr:0.30490	val-logloss:0.80608	val-auc:0.71486	val-aucpr:0.22800
[30]	train-logloss:0.89195	train-auc:0.70113	train-aucpr:0.31422	val-logloss:0.77283	val-auc:0.71193	val-aucpr:0.22253
[40]	train-logloss:0.88342	train-auc:0.70785	train-aucpr:0.31952	val-logloss:0.73135	val-auc:0.68732	val-aucpr:0.18741
[45]	train-logloss:0.87909	train-auc:0.71111	train-aucpr:0.32223	val-logloss:0.72419	val-auc:0.68772	val-aucpr:0.18921
[2025-11-19 08:48:00,346] [INFO] [<frozen importlib] - Training completed at iteration 16
[2025-11-19 08:48:00,346] [INFO] [<frozen importlib] - Best train loss: 0.9142
[2025-11-19 08:48:00,346] [INFO] [<frozen importlib] - Best val loss: 0.8226
[2025-11-19 08:48:00,346] [INFO] [<frozen importlib] - Best val AUC: 0.7137
[2025-11-19 08:48:00,346] [INFO] [<frozen importlib] - Best val AUCPR: 0.2303
[2025-11-19 08:48:00,352] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:48:00] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:48:04,991] [INFO] [<frozen importlib] - Optimal threshold: 0.6509
[2025-11-19 08:48:04,991] [INFO] [<frozen importlib] - Best f1: 0.2821
[2025-11-19 08:48:04,991] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:48:05,042] [INFO] [<frozen importlib] - Validation Results (threshold=0.6509):
[2025-11-19 08:48:05,042] [INFO] [<frozen importlib] -   Accuracy: 0.8952
[2025-11-19 08:48:05,042] [INFO] [<frozen importlib] -   Precision: 0.2979
[2025-11-19 08:48:05,042] [INFO] [<frozen importlib] -   Recall: 0.2679
[2025-11-19 08:48:05,042] [INFO] [<frozen importlib] -   F1 Score: 0.2821
[2025-11-19 08:48:05,042] [INFO] [<frozen importlib] -   AUROC: 0.7137
[2025-11-19 08:48:05,042] [INFO] [<frozen importlib] -   AUPRC: 0.2307
[2025-11-19 08:48:05,042] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:48:05,042] [INFO] [<frozen importlib] -     TN=16528, FP=917
[2025-11-19 08:48:05,042] [INFO] [<frozen importlib] -     FN=1063, TP=389
[2025-11-19 08:48:05,065] [INFO] [<frozen importlib] - Trial 170: AUPRC=0.2307, F1=0.4736, Prec=0.4449, Rec=0.5062 | Optimizing auprc=0.2307
                                                                                        Best trial: 140. Best value: 0.237476:  34%|███▍      | 170/500 [26:03<59:07, 10.75s/it]Best trial: 140. Best value: 0.237476:  34%|███▍      | 170/500 [26:03<59:07, 10.75s/it]Best trial: 140. Best value: 0.237476:  34%|███▍      | 171/500 [26:03<49:31,  9.03s/it][2025-11-19 08:48:05,075] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 13.306173554084202
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   gamma: 0.2729744543431274
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   alpha: 1.1548641487766038
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   lambda: 0.8905351602105048
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   learning_rate: 0.06720932695765558
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   subsample: 0.7495910317285125
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   colsample_bytree: 0.5799602273286059
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5375177219049658
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   colsample_bynode: 0.7736245397463903
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:48:05,075] [INFO] [<frozen importlib] -   scale_pos_weight: 13.306173554084202
[2025-11-19 08:48:05,147] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:48:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:48:05,065] Trial 170 finished with value: 0.2307006096217134 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.2715637937833907, 'learning_rate': 0.06547920455177304, 'n_estimators': 400, 'alpha': 1.0518486851935678, 'lambda': 1.1553594394678413, 'subsample': 0.7691144636072375, 'colsample_bytree': 0.5779038393134514, 'colsample_bylevel': 0.541716773829935, 'colsample_bynode': 0.756498999065482, 'scale_pos_weight': 13.416518261327672}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.97464	train-auc:0.64202	train-aucpr:0.21693	val-logloss:0.99891	val-auc:0.60447	val-aucpr:0.11497
[10]	train-logloss:0.92365	train-auc:0.68385	train-aucpr:0.28944	val-logloss:0.86315	val-auc:0.68953	val-aucpr:0.21439
[20]	train-logloss:0.90197	train-auc:0.69467	train-aucpr:0.30133	val-logloss:0.78440	val-auc:0.70644	val-aucpr:0.21969
[30]	train-logloss:0.88813	train-auc:0.70234	train-aucpr:0.31062	val-logloss:0.76864	val-auc:0.70525	val-aucpr:0.20575
[40]	train-logloss:0.87912	train-auc:0.70919	train-aucpr:0.31793	val-logloss:0.71929	val-auc:0.67497	val-aucpr:0.18066
[50]	train-logloss:0.87079	train-auc:0.71628	train-aucpr:0.32483	val-logloss:0.68254	val-auc:0.65312	val-aucpr:0.15541
[53]	train-logloss:0.86853	train-auc:0.71840	train-aucpr:0.32667	val-logloss:0.68047	val-auc:0.65506	val-aucpr:0.15960
[2025-11-19 08:48:05,316] [INFO] [<frozen importlib] - Training completed at iteration 23
[2025-11-19 08:48:05,316] [INFO] [<frozen importlib] - Best train loss: 0.8966
[2025-11-19 08:48:05,316] [INFO] [<frozen importlib] - Best val loss: 0.7730
[2025-11-19 08:48:05,316] [INFO] [<frozen importlib] - Best val AUC: 0.7112
[2025-11-19 08:48:05,316] [INFO] [<frozen importlib] - Best val AUCPR: 0.2246
[2025-11-19 08:48:05,320] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:48:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:48:13,021] [INFO] [<frozen importlib] - Optimal threshold: 0.6468
[2025-11-19 08:48:13,021] [INFO] [<frozen importlib] - Best f1: 0.2651
[2025-11-19 08:48:13,021] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:48:13,068] [INFO] [<frozen importlib] - Validation Results (threshold=0.6468):
[2025-11-19 08:48:13,068] [INFO] [<frozen importlib] -   Accuracy: 0.8932
[2025-11-19 08:48:13,068] [INFO] [<frozen importlib] -   Precision: 0.2813
[2025-11-19 08:48:13,068] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 08:48:13,068] [INFO] [<frozen importlib] -   F1 Score: 0.2651
[2025-11-19 08:48:13,068] [INFO] [<frozen importlib] -   AUROC: 0.7112
[2025-11-19 08:48:13,068] [INFO] [<frozen importlib] -   AUPRC: 0.2248
[2025-11-19 08:48:13,069] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:48:13,069] [INFO] [<frozen importlib] -     TN=16515, FP=930
[2025-11-19 08:48:13,069] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 08:48:13,094] [INFO] [<frozen importlib] - Trial 171: AUPRC=0.2248, F1=0.4578, Prec=0.4319, Rec=0.4869 | Optimizing auprc=0.2248
                                                                                        Best trial: 140. Best value: 0.237476:  34%|███▍      | 171/500 [26:11<49:31,  9.03s/it]Best trial: 140. Best value: 0.237476:  34%|███▍      | 171/500 [26:11<49:31,  9.03s/it]Best trial: 140. Best value: 0.237476:  34%|███▍      | 172/500 [26:11<47:44,  8.73s/it][2025-11-19 08:48:13,112] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 14.401410165586997
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   gamma: 0.2280681531030625
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   alpha: 1.0627181585396703
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   lambda: 1.1211727257594712
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   learning_rate: 0.0623014391711062
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   subsample: 0.7737409879283614
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   colsample_bytree: 0.57172261736708
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5003823912855426
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   colsample_bynode: 0.7550176802175881
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:48:13,112] [INFO] [<frozen importlib] -   scale_pos_weight: 14.401410165586997
[2025-11-19 08:48:13,198] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:48:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:48:13,095] Trial 171 finished with value: 0.22475500001572635 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.2729744543431274, 'learning_rate': 0.06720932695765558, 'n_estimators': 400, 'alpha': 1.1548641487766038, 'lambda': 0.8905351602105048, 'subsample': 0.7495910317285125, 'colsample_bytree': 0.5799602273286059, 'colsample_bylevel': 0.5375177219049658, 'colsample_bynode': 0.7736245397463903, 'scale_pos_weight': 13.306173554084202}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:1.01181	train-auc:0.64740	train-aucpr:0.22493	val-logloss:1.03064	val-auc:0.66665	val-aucpr:0.14556
[10]	train-logloss:0.96306	train-auc:0.68668	train-aucpr:0.28511	val-logloss:0.88624	val-auc:0.70080	val-aucpr:0.20348
[20]	train-logloss:0.94255	train-auc:0.69320	train-aucpr:0.29559	val-logloss:0.81396	val-auc:0.69503	val-aucpr:0.20134
[30]	train-logloss:0.92860	train-auc:0.70049	train-aucpr:0.30632	val-logloss:0.76900	val-auc:0.70628	val-aucpr:0.21519
[40]	train-logloss:0.91965	train-auc:0.70637	train-aucpr:0.31311	val-logloss:0.74155	val-auc:0.70828	val-aucpr:0.21740
[50]	train-logloss:0.91072	train-auc:0.71370	train-aucpr:0.32216	val-logloss:0.73584	val-auc:0.70880	val-aucpr:0.22131
[60]	train-logloss:0.90487	train-auc:0.71988	train-aucpr:0.32755	val-logloss:0.73478	val-auc:0.70296	val-aucpr:0.21264
[70]	train-logloss:0.89848	train-auc:0.72712	train-aucpr:0.33472	val-logloss:0.66700	val-auc:0.68732	val-aucpr:0.17860
[80]	train-logloss:0.89287	train-auc:0.73339	train-aucpr:0.34021	val-logloss:0.65820	val-auc:0.68415	val-aucpr:0.17018
[83]	train-logloss:0.89093	train-auc:0.73536	train-aucpr:0.34235	val-logloss:0.65012	val-auc:0.68482	val-aucpr:0.16952
[2025-11-19 08:48:13,451] [INFO] [<frozen importlib] - Training completed at iteration 54
[2025-11-19 08:48:13,451] [INFO] [<frozen importlib] - Best train loss: 0.9080
[2025-11-19 08:48:13,451] [INFO] [<frozen importlib] - Best val loss: 0.7356
[2025-11-19 08:48:13,451] [INFO] [<frozen importlib] - Best val AUC: 0.7072
[2025-11-19 08:48:13,451] [INFO] [<frozen importlib] - Best val AUCPR: 0.2223
[2025-11-19 08:48:13,456] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:48:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:48:26,947] [INFO] [<frozen importlib] - Optimal threshold: 0.6884
[2025-11-19 08:48:26,947] [INFO] [<frozen importlib] - Best f1: 0.2569
[2025-11-19 08:48:26,947] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:48:26,996] [INFO] [<frozen importlib] - Validation Results (threshold=0.6884):
[2025-11-19 08:48:26,996] [INFO] [<frozen importlib] -   Accuracy: 0.9038
[2025-11-19 08:48:26,996] [INFO] [<frozen importlib] -   Precision: 0.3162
[2025-11-19 08:48:26,996] [INFO] [<frozen importlib] -   Recall: 0.2163
[2025-11-19 08:48:26,996] [INFO] [<frozen importlib] -   F1 Score: 0.2569
[2025-11-19 08:48:26,996] [INFO] [<frozen importlib] -   AUROC: 0.7072
[2025-11-19 08:48:26,997] [INFO] [<frozen importlib] -   AUPRC: 0.2227
[2025-11-19 08:48:26,997] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:48:26,997] [INFO] [<frozen importlib] -     TN=16766, FP=679
[2025-11-19 08:48:26,997] [INFO] [<frozen importlib] -     FN=1138, TP=314
[2025-11-19 08:48:27,023] [INFO] [<frozen importlib] - Trial 172: AUPRC=0.2227, F1=0.4614, Prec=0.4848, Rec=0.4401 | Optimizing auprc=0.2227
[2025-11-19 08:48:27,023] [INFO] [<frozen importlib] - Trial 172 pruned.
[2025-11-19 08:48:27,023] [ERROR] [<frozen importlib] - Trial 172 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  34%|███▍      | 172/500 [26:24<47:44,  8.73s/it]Best trial: 140. Best value: 0.237476:  34%|███▍      | 172/500 [26:24<47:44,  8.73s/it]Best trial: 140. Best value: 0.237476:  35%|███▍      | 173/500 [26:24<56:05, 10.29s/it][2025-11-19 08:48:27,032] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 12.70060398508752
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   gamma: 0.2555772555519714
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   alpha: 0.9184589233794862
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   lambda: 0.7294455540947944
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   learning_rate: 0.07177731130885052
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   subsample: 0.766601102903065
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   colsample_bytree: 0.5922765536654767
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5446157945090739
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   colsample_bynode: 0.7615028623916476
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:48:27,033] [INFO] [<frozen importlib] -   scale_pos_weight: 12.70060398508752
[2025-11-19 08:48:27,109] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:48:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:48:27,024] Trial 172 pruned. 
[0]	train-logloss:0.95165	train-auc:0.64475	train-aucpr:0.22419	val-logloss:0.96360	val-auc:0.58533	val-aucpr:0.11227
[10]	train-logloss:0.90022	train-auc:0.68761	train-aucpr:0.28411	val-logloss:0.83989	val-auc:0.69243	val-aucpr:0.19246
[20]	train-logloss:0.87751	train-auc:0.70011	train-aucpr:0.30458	val-logloss:0.79310	val-auc:0.69340	val-aucpr:0.21390
[30]	train-logloss:0.86342	train-auc:0.70724	train-aucpr:0.31553	val-logloss:0.73666	val-auc:0.69776	val-aucpr:0.21633
[40]	train-logloss:0.85513	train-auc:0.71344	train-aucpr:0.32162	val-logloss:0.70628	val-auc:0.70564	val-aucpr:0.21490
[50]	train-logloss:0.84620	train-auc:0.72155	train-aucpr:0.32834	val-logloss:0.67938	val-auc:0.70386	val-aucpr:0.20893
[52]	train-logloss:0.84444	train-auc:0.72351	train-aucpr:0.32976	val-logloss:0.64469	val-auc:0.69997	val-aucpr:0.20043
[2025-11-19 08:48:27,279] [INFO] [<frozen importlib] - Training completed at iteration 23
[2025-11-19 08:48:27,279] [INFO] [<frozen importlib] - Best train loss: 0.8728
[2025-11-19 08:48:27,279] [INFO] [<frozen importlib] - Best val loss: 0.7794
[2025-11-19 08:48:27,279] [INFO] [<frozen importlib] - Best val AUC: 0.6970
[2025-11-19 08:48:27,279] [INFO] [<frozen importlib] - Best val AUCPR: 0.2204
[2025-11-19 08:48:27,285] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:48:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:48:32,066] [INFO] [<frozen importlib] - Optimal threshold: 0.6453
[2025-11-19 08:48:32,066] [INFO] [<frozen importlib] - Best f1: 0.2616
[2025-11-19 08:48:32,066] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:48:32,112] [INFO] [<frozen importlib] - Validation Results (threshold=0.6453):
[2025-11-19 08:48:32,112] [INFO] [<frozen importlib] -   Accuracy: 0.8904
[2025-11-19 08:48:32,112] [INFO] [<frozen importlib] -   Precision: 0.2710
[2025-11-19 08:48:32,112] [INFO] [<frozen importlib] -   Recall: 0.2528
[2025-11-19 08:48:32,112] [INFO] [<frozen importlib] -   F1 Score: 0.2616
[2025-11-19 08:48:32,112] [INFO] [<frozen importlib] -   AUROC: 0.6970
[2025-11-19 08:48:32,112] [INFO] [<frozen importlib] -   AUPRC: 0.2203
[2025-11-19 08:48:32,112] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:48:32,112] [INFO] [<frozen importlib] -     TN=16458, FP=987
[2025-11-19 08:48:32,112] [INFO] [<frozen importlib] -     FN=1085, TP=367
[2025-11-19 08:48:32,135] [INFO] [<frozen importlib] - Trial 173: AUPRC=0.2203, F1=0.4410, Prec=0.4114, Rec=0.4752 | Optimizing auprc=0.2203
                                                                                        Best trial: 140. Best value: 0.237476:  35%|███▍      | 173/500 [26:30<56:05, 10.29s/it]Best trial: 140. Best value: 0.237476:  35%|███▍      | 173/500 [26:30<56:05, 10.29s/it]Best trial: 140. Best value: 0.237476:  35%|███▍      | 174/500 [26:30<47:28,  8.74s/it][2025-11-19 08:48:32,151] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 14.115251234132568
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   gamma: 0.21425707166534713
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   alpha: 1.0344200385733955
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   lambda: 1.508588216979837
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   learning_rate: 0.06546791589486702
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   subsample: 0.8016070627717289
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   colsample_bytree: 0.5838993533257187
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5281424868198069
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   colsample_bynode: 0.7791267648446465
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:48:32,151] [INFO] [<frozen importlib] -   scale_pos_weight: 14.115251234132568
[2025-11-19 08:48:32,225] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:48:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:48:32,135] Trial 173 finished with value: 0.220273247545031 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.2555772555519714, 'learning_rate': 0.07177731130885052, 'n_estimators': 450, 'alpha': 0.9184589233794862, 'lambda': 0.7294455540947944, 'subsample': 0.766601102903065, 'colsample_bytree': 0.5922765536654767, 'colsample_bylevel': 0.5446157945090739, 'colsample_bynode': 0.7615028623916476, 'scale_pos_weight': 12.70060398508752}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:1.00167	train-auc:0.64770	train-aucpr:0.22583	val-logloss:1.02111	val-auc:0.62950	val-aucpr:0.13357
[10]	train-logloss:0.95161	train-auc:0.68320	train-aucpr:0.28823	val-logloss:0.87560	val-auc:0.68005	val-aucpr:0.19446
[20]	train-logloss:0.93071	train-auc:0.69451	train-aucpr:0.30221	val-logloss:0.81724	val-auc:0.68606	val-aucpr:0.21647
[30]	train-logloss:0.91818	train-auc:0.70210	train-aucpr:0.30992	val-logloss:0.76772	val-auc:0.69128	val-aucpr:0.21998
[40]	train-logloss:0.90884	train-auc:0.70801	train-aucpr:0.31733	val-logloss:0.75365	val-auc:0.69612	val-aucpr:0.21804
[50]	train-logloss:0.89935	train-auc:0.71757	train-aucpr:0.32671	val-logloss:0.69651	val-auc:0.69225	val-aucpr:0.20561
[59]	train-logloss:0.89332	train-auc:0.72451	train-aucpr:0.33221	val-logloss:0.68842	val-auc:0.68714	val-aucpr:0.19711
[2025-11-19 08:48:32,411] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:48:32,411] [INFO] [<frozen importlib] - Best train loss: 0.9192
[2025-11-19 08:48:32,411] [INFO] [<frozen importlib] - Best val loss: 0.7730
[2025-11-19 08:48:32,411] [INFO] [<frozen importlib] - Best val AUC: 0.6881
[2025-11-19 08:48:32,411] [INFO] [<frozen importlib] - Best val AUCPR: 0.2212
[2025-11-19 08:48:32,416] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:48:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:48:39,367] [INFO] [<frozen importlib] - Optimal threshold: 0.6555
[2025-11-19 08:48:39,367] [INFO] [<frozen importlib] - Best f1: 0.2646
[2025-11-19 08:48:39,367] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:48:39,413] [INFO] [<frozen importlib] - Validation Results (threshold=0.6555):
[2025-11-19 08:48:39,414] [INFO] [<frozen importlib] -   Accuracy: 0.8885
[2025-11-19 08:48:39,414] [INFO] [<frozen importlib] -   Precision: 0.2682
[2025-11-19 08:48:39,414] [INFO] [<frozen importlib] -   Recall: 0.2610
[2025-11-19 08:48:39,414] [INFO] [<frozen importlib] -   F1 Score: 0.2646
[2025-11-19 08:48:39,414] [INFO] [<frozen importlib] -   AUROC: 0.6881
[2025-11-19 08:48:39,414] [INFO] [<frozen importlib] -   AUPRC: 0.2214
[2025-11-19 08:48:39,414] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:48:39,414] [INFO] [<frozen importlib] -     TN=16411, FP=1034
[2025-11-19 08:48:39,414] [INFO] [<frozen importlib] -     FN=1073, TP=379
[2025-11-19 08:48:39,437] [INFO] [<frozen importlib] - Trial 174: AUPRC=0.2214, F1=0.4496, Prec=0.4108, Rec=0.4966 | Optimizing auprc=0.2214
[2025-11-19 08:48:39,438] [INFO] [<frozen importlib] - Trial 174 pruned.
[2025-11-19 08:48:39,438] [ERROR] [<frozen importlib] - Trial 174 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  35%|███▍      | 174/500 [26:37<47:28,  8.74s/it]Best trial: 140. Best value: 0.237476:  35%|███▍      | 174/500 [26:37<47:28,  8.74s/it]Best trial: 140. Best value: 0.237476:  35%|███▌      | 175/500 [26:37<44:59,  8.31s/it][2025-11-19 08:48:39,450] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 13.569951866859281
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   gamma: 0.30238163225011416
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   alpha: 0.6737829579320513
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   lambda: 0.9983405926738614
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   learning_rate: 0.06024183722140364
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   subsample: 0.7907651498563006
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   colsample_bytree: 0.5661310746905908
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5559055844799172
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   colsample_bynode: 0.7434606552252176
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:48:39,450] [INFO] [<frozen importlib] -   scale_pos_weight: 13.569951866859281
[2025-11-19 08:48:39,528] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:48:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:48:39,438] Trial 174 pruned. 
[0]	train-logloss:0.98515	train-auc:0.63361	train-aucpr:0.21143	val-logloss:1.01012	val-auc:0.58845	val-aucpr:0.11102
[10]	train-logloss:0.93843	train-auc:0.68593	train-aucpr:0.28734	val-logloss:0.90108	val-auc:0.67013	val-aucpr:0.18730
[20]	train-logloss:0.91650	train-auc:0.69369	train-aucpr:0.29841	val-logloss:0.82911	val-auc:0.68435	val-aucpr:0.20750
[30]	train-logloss:0.90210	train-auc:0.70417	train-aucpr:0.30685	val-logloss:0.80863	val-auc:0.66653	val-aucpr:0.18522
[40]	train-logloss:0.89063	train-auc:0.71312	train-aucpr:0.31475	val-logloss:0.79155	val-auc:0.65246	val-aucpr:0.15780
[50]	train-logloss:0.88219	train-auc:0.71883	train-aucpr:0.32115	val-logloss:0.73748	val-auc:0.65179	val-aucpr:0.15295
[2025-11-19 08:48:39,692] [INFO] [<frozen importlib] - Training completed at iteration 20
[2025-11-19 08:48:39,692] [INFO] [<frozen importlib] - Best train loss: 0.9165
[2025-11-19 08:48:39,692] [INFO] [<frozen importlib] - Best val loss: 0.8291
[2025-11-19 08:48:39,692] [INFO] [<frozen importlib] - Best val AUC: 0.6844
[2025-11-19 08:48:39,692] [INFO] [<frozen importlib] - Best val AUCPR: 0.2075
[2025-11-19 08:48:39,697] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:48:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:48:44,407] [INFO] [<frozen importlib] - Optimal threshold: 0.6626
[2025-11-19 08:48:44,407] [INFO] [<frozen importlib] - Best f1: 0.2517
[2025-11-19 08:48:44,407] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:48:44,451] [INFO] [<frozen importlib] - Validation Results (threshold=0.6626):
[2025-11-19 08:48:44,451] [INFO] [<frozen importlib] -   Accuracy: 0.8974
[2025-11-19 08:48:44,451] [INFO] [<frozen importlib] -   Precision: 0.2865
[2025-11-19 08:48:44,451] [INFO] [<frozen importlib] -   Recall: 0.2245
[2025-11-19 08:48:44,451] [INFO] [<frozen importlib] -   F1 Score: 0.2517
[2025-11-19 08:48:44,451] [INFO] [<frozen importlib] -   AUROC: 0.6844
[2025-11-19 08:48:44,451] [INFO] [<frozen importlib] -   AUPRC: 0.2071
[2025-11-19 08:48:44,451] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:48:44,451] [INFO] [<frozen importlib] -     TN=16633, FP=812
[2025-11-19 08:48:44,451] [INFO] [<frozen importlib] -     FN=1126, TP=326
[2025-11-19 08:48:44,474] [INFO] [<frozen importlib] - Trial 175: AUPRC=0.2071, F1=0.4467, Prec=0.4450, Rec=0.4483 | Optimizing auprc=0.2071
[2025-11-19 08:48:44,474] [INFO] [<frozen importlib] - Trial 175 pruned.
[2025-11-19 08:48:44,474] [ERROR] [<frozen importlib] - Trial 175 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  35%|███▌      | 175/500 [26:42<44:59,  8.31s/it]Best trial: 140. Best value: 0.237476:  35%|███▌      | 175/500 [26:42<44:59,  8.31s/it]Best trial: 140. Best value: 0.237476:  35%|███▌      | 176/500 [26:42<39:33,  7.33s/it][2025-11-19 08:48:44,484] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.922643360363983
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   gamma: 0.24718341928546514
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   alpha: 0.982199231669938
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   lambda: 1.3707481514847109
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   learning_rate: 0.06970332200379023
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   subsample: 0.8634733537358333
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   colsample_bytree: 0.560182110884222
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5127701162063599
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   colsample_bynode: 0.7190257840208532
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:48:44,484] [INFO] [<frozen importlib] -   scale_pos_weight: 11.922643360363983
[2025-11-19 08:48:44,558] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:48:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:48:44,475] Trial 175 pruned. 
[0]	train-logloss:0.92272	train-auc:0.64369	train-aucpr:0.22240	val-logloss:0.93828	val-auc:0.63536	val-aucpr:0.13120
[10]	train-logloss:0.87378	train-auc:0.68761	train-aucpr:0.29177	val-logloss:0.80520	val-auc:0.67136	val-aucpr:0.19004
[20]	train-logloss:0.85182	train-auc:0.69441	train-aucpr:0.30297	val-logloss:0.73406	val-auc:0.68788	val-aucpr:0.21367
[30]	train-logloss:0.83897	train-auc:0.70268	train-aucpr:0.31169	val-logloss:0.71545	val-auc:0.68984	val-aucpr:0.21263
[40]	train-logloss:0.82945	train-auc:0.71009	train-aucpr:0.31927	val-logloss:0.69526	val-auc:0.69229	val-aucpr:0.20690
[50]	train-logloss:0.82193	train-auc:0.71768	train-aucpr:0.32660	val-logloss:0.65014	val-auc:0.67987	val-aucpr:0.18448
[60]	train-logloss:0.81657	train-auc:0.72441	train-aucpr:0.33226	val-logloss:0.64533	val-auc:0.68411	val-aucpr:0.18892
[70]	train-logloss:0.81058	train-auc:0.73174	train-aucpr:0.34001	val-logloss:0.62976	val-auc:0.67615	val-aucpr:0.17481
[77]	train-logloss:0.80671	train-auc:0.73655	train-aucpr:0.34504	val-logloss:0.60861	val-auc:0.66694	val-aucpr:0.15840
[2025-11-19 08:48:44,785] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 08:48:44,785] [INFO] [<frozen importlib] - Best train loss: 0.8240
[2025-11-19 08:48:44,785] [INFO] [<frozen importlib] - Best val loss: 0.6747
[2025-11-19 08:48:44,785] [INFO] [<frozen importlib] - Best val AUC: 0.6952
[2025-11-19 08:48:44,785] [INFO] [<frozen importlib] - Best val AUCPR: 0.2162
[2025-11-19 08:48:44,790] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:48:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:48:58,230] [INFO] [<frozen importlib] - Optimal threshold: 0.6383
[2025-11-19 08:48:58,230] [INFO] [<frozen importlib] - Best f1: 0.2599
[2025-11-19 08:48:58,230] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:48:58,276] [INFO] [<frozen importlib] - Validation Results (threshold=0.6383):
[2025-11-19 08:48:58,276] [INFO] [<frozen importlib] -   Accuracy: 0.9108
[2025-11-19 08:48:58,276] [INFO] [<frozen importlib] -   Precision: 0.3584
[2025-11-19 08:48:58,276] [INFO] [<frozen importlib] -   Recall: 0.2039
[2025-11-19 08:48:58,276] [INFO] [<frozen importlib] -   F1 Score: 0.2599
[2025-11-19 08:48:58,276] [INFO] [<frozen importlib] -   AUROC: 0.6952
[2025-11-19 08:48:58,276] [INFO] [<frozen importlib] -   AUPRC: 0.2166
[2025-11-19 08:48:58,276] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:48:58,276] [INFO] [<frozen importlib] -     TN=16915, FP=530
[2025-11-19 08:48:58,276] [INFO] [<frozen importlib] -     FN=1156, TP=296
[2025-11-19 08:48:58,301] [INFO] [<frozen importlib] - Trial 176: AUPRC=0.2166, F1=0.4701, Prec=0.5347, Rec=0.4194 | Optimizing auprc=0.2166
[2025-11-19 08:48:58,301] [INFO] [<frozen importlib] - Trial 176 pruned.
[2025-11-19 08:48:58,301] [ERROR] [<frozen importlib] - Trial 176 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  35%|███▌      | 176/500 [26:56<39:33,  7.33s/it]Best trial: 140. Best value: 0.237476:  35%|███▌      | 176/500 [26:56<39:33,  7.33s/it]Best trial: 140. Best value: 0.237476:  35%|███▌      | 177/500 [26:56<49:56,  9.28s/it][2025-11-19 08:48:58,311] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 15.256438282183119
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   gamma: 0.27691704063088224
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   alpha: 0.8238272006980873
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   lambda: 1.1704251047743148
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   learning_rate: 0.03850465924126955
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   subsample: 0.7569563054814714
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   colsample_bytree: 0.5510905787682727
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5312841913405487
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   colsample_bynode: 0.7549322558803734
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:48:58,311] [INFO] [<frozen importlib] -   scale_pos_weight: 15.256438282183119
[2025-11-19 08:48:58,386] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:48:58] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:48:58,302] Trial 176 pruned. 
[0]	train-logloss:1.04311	train-auc:0.63283	train-aucpr:0.20552	val-logloss:1.07490	val-auc:0.58979	val-aucpr:0.13314
[10]	train-logloss:1.00700	train-auc:0.67733	train-aucpr:0.27915	val-logloss:0.98208	val-auc:0.68142	val-aucpr:0.17464
[20]	train-logloss:0.98686	train-auc:0.68535	train-aucpr:0.29443	val-logloss:0.91529	val-auc:0.69214	val-aucpr:0.20510
[30]	train-logloss:0.97263	train-auc:0.69288	train-aucpr:0.30086	val-logloss:0.88191	val-auc:0.69662	val-aucpr:0.21371
[40]	train-logloss:0.96338	train-auc:0.69726	train-aucpr:0.30490	val-logloss:0.84884	val-auc:0.69832	val-aucpr:0.21767
[50]	train-logloss:0.95539	train-auc:0.70192	train-aucpr:0.31004	val-logloss:0.83287	val-auc:0.68912	val-aucpr:0.20927
[60]	train-logloss:0.94920	train-auc:0.70621	train-aucpr:0.31458	val-logloss:0.82059	val-auc:0.69169	val-aucpr:0.21692
[69]	train-logloss:0.94357	train-auc:0.71098	train-aucpr:0.31759	val-logloss:0.80325	val-auc:0.69750	val-aucpr:0.21555
[2025-11-19 08:48:58,606] [INFO] [<frozen importlib] - Training completed at iteration 40
[2025-11-19 08:48:58,606] [INFO] [<frozen importlib] - Best train loss: 0.9634
[2025-11-19 08:48:58,606] [INFO] [<frozen importlib] - Best val loss: 0.8488
[2025-11-19 08:48:58,606] [INFO] [<frozen importlib] - Best val AUC: 0.6983
[2025-11-19 08:48:58,606] [INFO] [<frozen importlib] - Best val AUCPR: 0.2177
[2025-11-19 08:48:58,611] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:48:58] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:49:08,002] [INFO] [<frozen importlib] - Optimal threshold: 0.6730
[2025-11-19 08:49:08,002] [INFO] [<frozen importlib] - Best f1: 0.2646
[2025-11-19 08:49:08,003] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:49:08,044] [INFO] [<frozen importlib] - Validation Results (threshold=0.6730):
[2025-11-19 08:49:08,044] [INFO] [<frozen importlib] -   Accuracy: 0.8762
[2025-11-19 08:49:08,044] [INFO] [<frozen importlib] -   Precision: 0.2434
[2025-11-19 08:49:08,044] [INFO] [<frozen importlib] -   Recall: 0.2899
[2025-11-19 08:49:08,044] [INFO] [<frozen importlib] -   F1 Score: 0.2646
[2025-11-19 08:49:08,044] [INFO] [<frozen importlib] -   AUROC: 0.6983
[2025-11-19 08:49:08,044] [INFO] [<frozen importlib] -   AUPRC: 0.2181
[2025-11-19 08:49:08,044] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:49:08,044] [INFO] [<frozen importlib] -     TN=16136, FP=1309
[2025-11-19 08:49:08,044] [INFO] [<frozen importlib] -     FN=1031, TP=421
[2025-11-19 08:49:08,066] [INFO] [<frozen importlib] - Trial 177: AUPRC=0.2181, F1=0.4335, Prec=0.3685, Rec=0.5262 | Optimizing auprc=0.2181
[2025-11-19 08:49:08,066] [INFO] [<frozen importlib] - Trial 177 pruned.
[2025-11-19 08:49:08,067] [ERROR] [<frozen importlib] - Trial 177 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  35%|███▌      | 177/500 [27:06<49:56,  9.28s/it]Best trial: 140. Best value: 0.237476:  35%|███▌      | 177/500 [27:06<49:56,  9.28s/it]Best trial: 140. Best value: 0.237476:  36%|███▌      | 178/500 [27:06<50:34,  9.42s/it][2025-11-19 08:49:08,076] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.91281572834424
[2025-11-19 08:49:08,076] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:49:08,076] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:49:08,076] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:49:08,076] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:49:08,076] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   gamma: 0.327564271151811
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   alpha: 1.1053801455160053
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   lambda: 2.626979009678233
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   learning_rate: 0.04088149320718087
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   subsample: 0.7475771721245699
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   colsample_bytree: 0.7019906529786518
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5697634492156112
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   colsample_bynode: 0.7683964670521628
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:49:08,077] [INFO] [<frozen importlib] -   scale_pos_weight: 6.91281572834424
[2025-11-19 08:49:08,143] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:49:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:49:08,067] Trial 177 pruned. 
[0]	train-logloss:0.69386	train-auc:0.63918	train-aucpr:0.24427	val-logloss:0.69028	val-auc:0.60204	val-aucpr:0.13776
[10]	train-logloss:0.66701	train-auc:0.68276	train-aucpr:0.29318	val-logloss:0.64076	val-auc:0.69117	val-aucpr:0.19830
[20]	train-logloss:0.65152	train-auc:0.68971	train-aucpr:0.29944	val-logloss:0.59169	val-auc:0.69629	val-aucpr:0.21323
[30]	train-logloss:0.64100	train-auc:0.69639	train-aucpr:0.30534	val-logloss:0.56194	val-auc:0.70083	val-aucpr:0.21350
[40]	train-logloss:0.63358	train-auc:0.70172	train-aucpr:0.31176	val-logloss:0.54364	val-auc:0.69737	val-aucpr:0.20866
[50]	train-logloss:0.62769	train-auc:0.70587	train-aucpr:0.31580	val-logloss:0.52880	val-auc:0.69445	val-aucpr:0.21065
[60]	train-logloss:0.62294	train-auc:0.71015	train-aucpr:0.32109	val-logloss:0.52183	val-auc:0.69404	val-aucpr:0.21252
[2025-11-19 08:49:08,334] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 08:49:08,334] [INFO] [<frozen importlib] - Best train loss: 0.6402
[2025-11-19 08:49:08,334] [INFO] [<frozen importlib] - Best val loss: 0.5604
[2025-11-19 08:49:08,334] [INFO] [<frozen importlib] - Best val AUC: 0.7013
[2025-11-19 08:49:08,334] [INFO] [<frozen importlib] - Best val AUCPR: 0.2137
[2025-11-19 08:49:08,338] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:49:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:49:14,562] [INFO] [<frozen importlib] - Optimal threshold: 0.4943
[2025-11-19 08:49:14,562] [INFO] [<frozen importlib] - Best f1: 0.2648
[2025-11-19 08:49:14,562] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:49:14,608] [INFO] [<frozen importlib] - Validation Results (threshold=0.4943):
[2025-11-19 08:49:14,609] [INFO] [<frozen importlib] -   Accuracy: 0.8874
[2025-11-19 08:49:14,609] [INFO] [<frozen importlib] -   Precision: 0.2658
[2025-11-19 08:49:14,609] [INFO] [<frozen importlib] -   Recall: 0.2638
[2025-11-19 08:49:14,609] [INFO] [<frozen importlib] -   F1 Score: 0.2648
[2025-11-19 08:49:14,609] [INFO] [<frozen importlib] -   AUROC: 0.7013
[2025-11-19 08:49:14,609] [INFO] [<frozen importlib] -   AUPRC: 0.2143
[2025-11-19 08:49:14,609] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:49:14,609] [INFO] [<frozen importlib] -     TN=16387, FP=1058
[2025-11-19 08:49:14,609] [INFO] [<frozen importlib] -     FN=1069, TP=383
[2025-11-19 08:49:14,634] [INFO] [<frozen importlib] - Trial 178: AUPRC=0.2143, F1=0.4405, Prec=0.4012, Rec=0.4883 | Optimizing auprc=0.2143
[2025-11-19 08:49:14,634] [INFO] [<frozen importlib] - Trial 178 pruned.
[2025-11-19 08:49:14,634] [ERROR] [<frozen importlib] - Trial 178 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  36%|███▌      | 178/500 [27:12<50:34,  9.42s/it]Best trial: 140. Best value: 0.237476:  36%|███▌      | 178/500 [27:12<50:34,  9.42s/it]Best trial: 140. Best value: 0.237476:  36%|███▌      | 179/500 [27:12<45:49,  8.57s/it][2025-11-19 08:49:14,651] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.263686821681529
[2025-11-19 08:49:14,651] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:49:14,651] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:49:14,651] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:49:14,651] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:49:14,651] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:49:14,651] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:49:14,651] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   gamma: 0.19795496697395074
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   alpha: 1.038807034685328
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   lambda: 0.7957140734784489
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   learning_rate: 0.06325709184724898
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   subsample: 0.8994986567776233
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   colsample_bytree: 0.574221115959848
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5446659260415149
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   colsample_bynode: 0.7338702311338812
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:49:14,652] [INFO] [<frozen importlib] -   scale_pos_weight: 6.263686821681529
[2025-11-19 08:49:14,728] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:49:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:49:14,634] Trial 178 pruned. 
[0]	train-logloss:0.65691	train-auc:0.63684	train-aucpr:0.23238	val-logloss:0.64771	val-auc:0.61088	val-aucpr:0.12361
[10]	train-logloss:0.62466	train-auc:0.68598	train-aucpr:0.29350	val-logloss:0.56099	val-auc:0.67985	val-aucpr:0.21143
[20]	train-logloss:0.60837	train-auc:0.69527	train-aucpr:0.30381	val-logloss:0.52792	val-auc:0.69865	val-aucpr:0.22141
[30]	train-logloss:0.59852	train-auc:0.70297	train-aucpr:0.31314	val-logloss:0.52112	val-auc:0.69019	val-aucpr:0.22506
[40]	train-logloss:0.59230	train-auc:0.70907	train-aucpr:0.31920	val-logloss:0.51864	val-auc:0.69277	val-aucpr:0.21639
[50]	train-logloss:0.58687	train-auc:0.71567	train-aucpr:0.32640	val-logloss:0.50153	val-auc:0.68618	val-aucpr:0.19932
[57]	train-logloss:0.58470	train-auc:0.71917	train-aucpr:0.33022	val-logloss:0.49410	val-auc:0.68406	val-aucpr:0.19848
[2025-11-19 08:49:14,913] [INFO] [<frozen importlib] - Training completed at iteration 28
[2025-11-19 08:49:14,913] [INFO] [<frozen importlib] - Best train loss: 0.6001
[2025-11-19 08:49:14,913] [INFO] [<frozen importlib] - Best val loss: 0.5263
[2025-11-19 08:49:14,913] [INFO] [<frozen importlib] - Best val AUC: 0.6962
[2025-11-19 08:49:14,913] [INFO] [<frozen importlib] - Best val AUCPR: 0.2271
[2025-11-19 08:49:14,919] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:49:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:49:22,405] [INFO] [<frozen importlib] - Optimal threshold: 0.4861
[2025-11-19 08:49:22,405] [INFO] [<frozen importlib] - Best f1: 0.2719
[2025-11-19 08:49:22,405] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:49:22,448] [INFO] [<frozen importlib] - Validation Results (threshold=0.4861):
[2025-11-19 08:49:22,448] [INFO] [<frozen importlib] -   Accuracy: 0.9039
[2025-11-19 08:49:22,448] [INFO] [<frozen importlib] -   Precision: 0.3253
[2025-11-19 08:49:22,448] [INFO] [<frozen importlib] -   Recall: 0.2335
[2025-11-19 08:49:22,448] [INFO] [<frozen importlib] -   F1 Score: 0.2719
[2025-11-19 08:49:22,448] [INFO] [<frozen importlib] -   AUROC: 0.6962
[2025-11-19 08:49:22,448] [INFO] [<frozen importlib] -   AUPRC: 0.2276
[2025-11-19 08:49:22,448] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:49:22,448] [INFO] [<frozen importlib] -     TN=16742, FP=703
[2025-11-19 08:49:22,448] [INFO] [<frozen importlib] -     FN=1113, TP=339
[2025-11-19 08:49:22,472] [INFO] [<frozen importlib] - Trial 179: AUPRC=0.2276, F1=0.4558, Prec=0.4750, Rec=0.4380 | Optimizing auprc=0.2276
                                                                                        Best trial: 140. Best value: 0.237476:  36%|███▌      | 179/500 [27:20<45:49,  8.57s/it]Best trial: 140. Best value: 0.237476:  36%|███▌      | 179/500 [27:20<45:49,  8.57s/it]Best trial: 140. Best value: 0.237476:  36%|███▌      | 180/500 [27:20<44:31,  8.35s/it][2025-11-19 08:49:22,483] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.5065923774457755
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   gamma: 0.2860222577696291
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   alpha: 0.8908521513661889
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   lambda: 1.7309189997117373
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   learning_rate: 0.037124992000265256
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   subsample: 0.782680717099302
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   colsample_bytree: 0.6025717715308601
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5178153634783489
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   colsample_bynode: 0.7793522069974452
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:49:22,483] [INFO] [<frozen importlib] -   scale_pos_weight: 7.5065923774457755
[2025-11-19 08:49:22,555] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:49:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:49:22,473] Trial 179 finished with value: 0.22764395426768308 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.19795496697395074, 'learning_rate': 0.06325709184724898, 'n_estimators': 450, 'alpha': 1.038807034685328, 'lambda': 0.7957140734784489, 'subsample': 0.8994986567776233, 'colsample_bytree': 0.574221115959848, 'colsample_bylevel': 0.5446659260415149, 'colsample_bynode': 0.7338702311338812, 'scale_pos_weight': 6.263686821681529}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.72568	train-auc:0.64326	train-aucpr:0.24963	val-logloss:0.72770	val-auc:0.59035	val-aucpr:0.13667
[10]	train-logloss:0.69937	train-auc:0.68255	train-aucpr:0.29155	val-logloss:0.65992	val-auc:0.68809	val-aucpr:0.19960
[20]	train-logloss:0.68333	train-auc:0.69078	train-aucpr:0.29854	val-logloss:0.61753	val-auc:0.69821	val-aucpr:0.20456
[30]	train-logloss:0.67269	train-auc:0.69402	train-aucpr:0.30392	val-logloss:0.59200	val-auc:0.70238	val-aucpr:0.21270
[40]	train-logloss:0.66512	train-auc:0.69767	train-aucpr:0.30755	val-logloss:0.56775	val-auc:0.70730	val-aucpr:0.22129
[50]	train-logloss:0.65898	train-auc:0.70167	train-aucpr:0.31088	val-logloss:0.54580	val-auc:0.70918	val-aucpr:0.22467
[60]	train-logloss:0.65432	train-auc:0.70599	train-aucpr:0.31467	val-logloss:0.54416	val-auc:0.70805	val-aucpr:0.22504
[70]	train-logloss:0.65059	train-auc:0.71007	train-aucpr:0.31855	val-logloss:0.53744	val-auc:0.70983	val-aucpr:0.22145
[80]	train-logloss:0.64729	train-auc:0.71337	train-aucpr:0.32312	val-logloss:0.52788	val-auc:0.70614	val-aucpr:0.22464
[84]	train-logloss:0.64598	train-auc:0.71449	train-aucpr:0.32466	val-logloss:0.51952	val-auc:0.70078	val-aucpr:0.21142
[2025-11-19 08:49:22,804] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 08:49:22,804] [INFO] [<frozen importlib] - Best train loss: 0.6570
[2025-11-19 08:49:22,804] [INFO] [<frozen importlib] - Best val loss: 0.5429
[2025-11-19 08:49:22,804] [INFO] [<frozen importlib] - Best val AUC: 0.7075
[2025-11-19 08:49:22,804] [INFO] [<frozen importlib] - Best val AUCPR: 0.2253
[2025-11-19 08:49:22,810] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:49:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:49:35,463] [INFO] [<frozen importlib] - Optimal threshold: 0.5061
[2025-11-19 08:49:35,464] [INFO] [<frozen importlib] - Best f1: 0.2777
[2025-11-19 08:49:35,464] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:49:35,509] [INFO] [<frozen importlib] - Validation Results (threshold=0.5061):
[2025-11-19 08:49:35,509] [INFO] [<frozen importlib] -   Accuracy: 0.8976
[2025-11-19 08:49:35,509] [INFO] [<frozen importlib] -   Precision: 0.3032
[2025-11-19 08:49:35,509] [INFO] [<frozen importlib] -   Recall: 0.2562
[2025-11-19 08:49:35,509] [INFO] [<frozen importlib] -   F1 Score: 0.2777
[2025-11-19 08:49:35,509] [INFO] [<frozen importlib] -   AUROC: 0.7075
[2025-11-19 08:49:35,509] [INFO] [<frozen importlib] -   AUPRC: 0.2257
[2025-11-19 08:49:35,509] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:49:35,509] [INFO] [<frozen importlib] -     TN=16590, FP=855
[2025-11-19 08:49:35,509] [INFO] [<frozen importlib] -     FN=1080, TP=372
[2025-11-19 08:49:35,533] [INFO] [<frozen importlib] - Trial 180: AUPRC=0.2257, F1=0.4630, Prec=0.4484, Rec=0.4787 | Optimizing auprc=0.2257
                                                                                        Best trial: 140. Best value: 0.237476:  36%|███▌      | 180/500 [27:33<44:31,  8.35s/it]Best trial: 140. Best value: 0.237476:  36%|███▌      | 180/500 [27:33<44:31,  8.35s/it]Best trial: 140. Best value: 0.237476:  36%|███▌      | 181/500 [27:33<51:54,  9.76s/it][2025-11-19 08:49:35,544] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.746599230792044
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   gamma: 0.31348555812966966
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   alpha: 0.7093561596016112
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   lambda: 0.6638078549477107
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   learning_rate: 0.04425285498837156
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   subsample: 0.8388720160832469
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   colsample_bytree: 0.5228967723436473
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5575233573253946
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   colsample_bynode: 0.7632077687761446
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:49:35,545] [INFO] [<frozen importlib] -   scale_pos_weight: 6.746599230792044
[2025-11-19 08:49:35,621] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:49:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:49:35,533] Trial 180 finished with value: 0.22566376095228802 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.2860222577696291, 'learning_rate': 0.037124992000265256, 'n_estimators': 450, 'alpha': 0.8908521513661889, 'lambda': 1.7309189997117373, 'subsample': 0.782680717099302, 'colsample_bytree': 0.6025717715308601, 'colsample_bylevel': 0.5178153634783489, 'colsample_bynode': 0.7793522069974452, 'scale_pos_weight': 7.5065923774457755}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.68505	train-auc:0.63425	train-aucpr:0.23040	val-logloss:0.68109	val-auc:0.63871	val-aucpr:0.14585
[10]	train-logloss:0.65819	train-auc:0.68189	train-aucpr:0.28485	val-logloss:0.61548	val-auc:0.68432	val-aucpr:0.19906
[20]	train-logloss:0.64245	train-auc:0.68907	train-aucpr:0.30071	val-logloss:0.57249	val-auc:0.69974	val-aucpr:0.21526
[30]	train-logloss:0.63219	train-auc:0.69399	train-aucpr:0.30658	val-logloss:0.54423	val-auc:0.69073	val-aucpr:0.21988
[40]	train-logloss:0.62446	train-auc:0.69936	train-aucpr:0.31226	val-logloss:0.52417	val-auc:0.70493	val-aucpr:0.22358
[50]	train-logloss:0.61888	train-auc:0.70454	train-aucpr:0.31660	val-logloss:0.51398	val-auc:0.70042	val-aucpr:0.21255
[60]	train-logloss:0.61487	train-auc:0.70837	train-aucpr:0.32182	val-logloss:0.51162	val-auc:0.70213	val-aucpr:0.21734
[70]	train-logloss:0.61129	train-auc:0.71411	train-aucpr:0.32619	val-logloss:0.49007	val-auc:0.69780	val-aucpr:0.21066
[73]	train-logloss:0.61024	train-auc:0.71575	train-aucpr:0.32786	val-logloss:0.47752	val-auc:0.69644	val-aucpr:0.20764
[2025-11-19 08:49:35,851] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 08:49:35,851] [INFO] [<frozen importlib] - Best train loss: 0.6222
[2025-11-19 08:49:35,851] [INFO] [<frozen importlib] - Best val loss: 0.5189
[2025-11-19 08:49:35,851] [INFO] [<frozen importlib] - Best val AUC: 0.7076
[2025-11-19 08:49:35,851] [INFO] [<frozen importlib] - Best val AUCPR: 0.2276
[2025-11-19 08:49:35,856] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:49:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:49:45,842] [INFO] [<frozen importlib] - Optimal threshold: 0.4870
[2025-11-19 08:49:45,842] [INFO] [<frozen importlib] - Best f1: 0.2754
[2025-11-19 08:49:45,842] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:49:45,888] [INFO] [<frozen importlib] - Validation Results (threshold=0.4870):
[2025-11-19 08:49:45,888] [INFO] [<frozen importlib] -   Accuracy: 0.8870
[2025-11-19 08:49:45,888] [INFO] [<frozen importlib] -   Precision: 0.2714
[2025-11-19 08:49:45,888] [INFO] [<frozen importlib] -   Recall: 0.2796
[2025-11-19 08:49:45,888] [INFO] [<frozen importlib] -   F1 Score: 0.2754
[2025-11-19 08:49:45,888] [INFO] [<frozen importlib] -   AUROC: 0.7076
[2025-11-19 08:49:45,888] [INFO] [<frozen importlib] -   AUPRC: 0.2280
[2025-11-19 08:49:45,888] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:49:45,888] [INFO] [<frozen importlib] -     TN=16355, FP=1090
[2025-11-19 08:49:45,888] [INFO] [<frozen importlib] -     FN=1046, TP=406
[2025-11-19 08:49:45,910] [INFO] [<frozen importlib] - Trial 181: AUPRC=0.2280, F1=0.4429, Prec=0.3988, Rec=0.4979 | Optimizing auprc=0.2280
                                                                                        Best trial: 140. Best value: 0.237476:  36%|███▌      | 181/500 [27:43<51:54,  9.76s/it]Best trial: 140. Best value: 0.237476:  36%|███▌      | 181/500 [27:43<51:54,  9.76s/it]Best trial: 140. Best value: 0.237476:  36%|███▋      | 182/500 [27:43<52:42,  9.95s/it][2025-11-19 08:49:45,919] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.574836977627559
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   gamma: 0.3440002585989372
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   alpha: 0.7758004385476185
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   lambda: 0.4242836138125237
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   learning_rate: 0.043002506540838634
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   subsample: 0.808087657937669
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   colsample_bytree: 0.5423118445656077
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8103422955968029
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   colsample_bynode: 0.7836080938660812
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:49:45,919] [INFO] [<frozen importlib] -   scale_pos_weight: 5.574836977627559
[2025-11-19 08:49:45,999] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:49:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:49:45,910] Trial 181 finished with value: 0.22796166485880384 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.31348555812966966, 'learning_rate': 0.04425285498837156, 'n_estimators': 500, 'alpha': 0.7093561596016112, 'lambda': 0.6638078549477107, 'subsample': 0.8388720160832469, 'colsample_bytree': 0.5228967723436473, 'colsample_bylevel': 0.5575233573253946, 'colsample_bynode': 0.7632077687761446, 'scale_pos_weight': 6.746599230792044}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.61950	train-auc:0.63687	train-aucpr:0.23565	val-logloss:0.60467	val-auc:0.61143	val-aucpr:0.12152
[10]	train-logloss:0.59537	train-auc:0.68248	train-aucpr:0.29110	val-logloss:0.55852	val-auc:0.68940	val-aucpr:0.18551
[20]	train-logloss:0.58156	train-auc:0.69199	train-aucpr:0.30127	val-logloss:0.52888	val-auc:0.69558	val-aucpr:0.19838
[30]	train-logloss:0.57193	train-auc:0.69699	train-aucpr:0.30866	val-logloss:0.49798	val-auc:0.69380	val-aucpr:0.21089
[40]	train-logloss:0.56569	train-auc:0.70148	train-aucpr:0.31408	val-logloss:0.48149	val-auc:0.69874	val-aucpr:0.21695
[50]	train-logloss:0.56034	train-auc:0.70641	train-aucpr:0.31961	val-logloss:0.47704	val-auc:0.70282	val-aucpr:0.21863
[60]	train-logloss:0.55637	train-auc:0.71149	train-aucpr:0.32488	val-logloss:0.46740	val-auc:0.71048	val-aucpr:0.22268
[70]	train-logloss:0.55326	train-auc:0.71526	train-aucpr:0.32967	val-logloss:0.45595	val-auc:0.70968	val-aucpr:0.21795
[80]	train-logloss:0.55056	train-auc:0.71912	train-aucpr:0.33374	val-logloss:0.44757	val-auc:0.70758	val-aucpr:0.21654
[86]	train-logloss:0.54896	train-auc:0.72180	train-aucpr:0.33627	val-logloss:0.43676	val-auc:0.70244	val-aucpr:0.20812
[2025-11-19 08:49:46,251] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 08:49:46,251] [INFO] [<frozen importlib] - Best train loss: 0.5582
[2025-11-19 08:49:46,251] [INFO] [<frozen importlib] - Best val loss: 0.4690
[2025-11-19 08:49:46,251] [INFO] [<frozen importlib] - Best val AUC: 0.7087
[2025-11-19 08:49:46,251] [INFO] [<frozen importlib] - Best val AUCPR: 0.2235
[2025-11-19 08:49:46,256] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:49:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:49:58,369] [INFO] [<frozen importlib] - Optimal threshold: 0.4525
[2025-11-19 08:49:58,369] [INFO] [<frozen importlib] - Best f1: 0.2780
[2025-11-19 08:49:58,369] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:49:58,412] [INFO] [<frozen importlib] - Validation Results (threshold=0.4525):
[2025-11-19 08:49:58,412] [INFO] [<frozen importlib] -   Accuracy: 0.8991
[2025-11-19 08:49:58,412] [INFO] [<frozen importlib] -   Precision: 0.3089
[2025-11-19 08:49:58,412] [INFO] [<frozen importlib] -   Recall: 0.2528
[2025-11-19 08:49:58,412] [INFO] [<frozen importlib] -   F1 Score: 0.2780
[2025-11-19 08:49:58,412] [INFO] [<frozen importlib] -   AUROC: 0.7087
[2025-11-19 08:49:58,412] [INFO] [<frozen importlib] -   AUPRC: 0.2240
[2025-11-19 08:49:58,412] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:49:58,413] [INFO] [<frozen importlib] -     TN=16624, FP=821
[2025-11-19 08:49:58,413] [INFO] [<frozen importlib] -     FN=1085, TP=367
[2025-11-19 08:49:58,438] [INFO] [<frozen importlib] - Trial 182: AUPRC=0.2240, F1=0.4516, Prec=0.4468, Rec=0.4566 | Optimizing auprc=0.2240
[2025-11-19 08:49:58,438] [INFO] [<frozen importlib] - Trial 182 pruned.
[2025-11-19 08:49:58,438] [ERROR] [<frozen importlib] - Trial 182 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  36%|███▋      | 182/500 [27:56<52:42,  9.95s/it]Best trial: 140. Best value: 0.237476:  36%|███▋      | 182/500 [27:56<52:42,  9.95s/it]Best trial: 140. Best value: 0.237476:  37%|███▋      | 183/500 [27:56<56:38, 10.72s/it][2025-11-19 08:49:58,447] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.2398657314733175
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   gamma: 0.26691972973805356
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   alpha: 0.6373336350967123
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   lambda: 1.9089491628418787
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   learning_rate: 0.057970778191895035
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   subsample: 0.8579743171002427
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   colsample_bytree: 0.5544838027204805
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   colsample_bylevel: 0.834165463837696
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   colsample_bynode: 0.7494918955982199
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:49:58,447] [INFO] [<frozen importlib] -   scale_pos_weight: 7.2398657314733175
[2025-11-19 08:49:58,524] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:49:58] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:49:58,438] Trial 182 pruned. 
[0]	train-logloss:0.70973	train-auc:0.64601	train-aucpr:0.23446	val-logloss:0.70347	val-auc:0.67724	val-aucpr:0.13649
[10]	train-logloss:0.67531	train-auc:0.68381	train-aucpr:0.29264	val-logloss:0.61916	val-auc:0.68577	val-aucpr:0.17987
[20]	train-logloss:0.65734	train-auc:0.69584	train-aucpr:0.30457	val-logloss:0.57091	val-auc:0.69493	val-aucpr:0.20458
[30]	train-logloss:0.64647	train-auc:0.70169	train-aucpr:0.31331	val-logloss:0.54892	val-auc:0.69835	val-aucpr:0.21310
[40]	train-logloss:0.63965	train-auc:0.70657	train-aucpr:0.31986	val-logloss:0.53467	val-auc:0.70738	val-aucpr:0.21928
[50]	train-logloss:0.63400	train-auc:0.71334	train-aucpr:0.32579	val-logloss:0.51334	val-auc:0.70583	val-aucpr:0.20858
[60]	train-logloss:0.62917	train-auc:0.72031	train-aucpr:0.33224	val-logloss:0.50692	val-auc:0.70803	val-aucpr:0.21538
[69]	train-logloss:0.62594	train-auc:0.72505	train-aucpr:0.33775	val-logloss:0.48715	val-auc:0.68065	val-aucpr:0.17575
[2025-11-19 08:49:58,737] [INFO] [<frozen importlib] - Training completed at iteration 40
[2025-11-19 08:49:58,737] [INFO] [<frozen importlib] - Best train loss: 0.6396
[2025-11-19 08:49:58,737] [INFO] [<frozen importlib] - Best val loss: 0.5347
[2025-11-19 08:49:58,737] [INFO] [<frozen importlib] - Best val AUC: 0.7074
[2025-11-19 08:49:58,737] [INFO] [<frozen importlib] - Best val AUCPR: 0.2193
[2025-11-19 08:49:58,742] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:49:58] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:50:09,680] [INFO] [<frozen importlib] - Optimal threshold: 0.5063
[2025-11-19 08:50:09,680] [INFO] [<frozen importlib] - Best f1: 0.2828
[2025-11-19 08:50:09,680] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:50:09,729] [INFO] [<frozen importlib] - Validation Results (threshold=0.5063):
[2025-11-19 08:50:09,729] [INFO] [<frozen importlib] -   Accuracy: 0.8951
[2025-11-19 08:50:09,729] [INFO] [<frozen importlib] -   Precision: 0.2978
[2025-11-19 08:50:09,729] [INFO] [<frozen importlib] -   Recall: 0.2693
[2025-11-19 08:50:09,729] [INFO] [<frozen importlib] -   F1 Score: 0.2828
[2025-11-19 08:50:09,729] [INFO] [<frozen importlib] -   AUROC: 0.7074
[2025-11-19 08:50:09,729] [INFO] [<frozen importlib] -   AUPRC: 0.2198
[2025-11-19 08:50:09,729] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:50:09,729] [INFO] [<frozen importlib] -     TN=16523, FP=922
[2025-11-19 08:50:09,729] [INFO] [<frozen importlib] -     FN=1061, TP=391
[2025-11-19 08:50:09,754] [INFO] [<frozen importlib] - Trial 183: AUPRC=0.2198, F1=0.4589, Prec=0.4340, Rec=0.4869 | Optimizing auprc=0.2198
[2025-11-19 08:50:09,754] [INFO] [<frozen importlib] - Trial 183 pruned.
[2025-11-19 08:50:09,754] [ERROR] [<frozen importlib] - Trial 183 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  37%|███▋      | 183/500 [28:07<56:38, 10.72s/it]Best trial: 140. Best value: 0.237476:  37%|███▋      | 183/500 [28:07<56:38, 10.72s/it]Best trial: 140. Best value: 0.237476:  37%|███▋      | 184/500 [28:07<57:24, 10.90s/it][2025-11-19 08:50:09,765] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.57660062293925
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   gamma: 0.30516418549208985
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   alpha: 0.7417747668632374
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   lambda: 2.0326817849208765
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   learning_rate: 0.04539082798127437
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   subsample: 0.8197091008940238
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   colsample_bytree: 0.534194290847984
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5792847178177487
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   colsample_bynode: 0.8006657870956985
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:50:09,765] [INFO] [<frozen importlib] -   scale_pos_weight: 6.57660062293925
[2025-11-19 08:50:09,843] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:50:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:50:09,754] Trial 183 pruned. 
[0]	train-logloss:0.67554	train-auc:0.63385	train-aucpr:0.23735	val-logloss:0.67017	val-auc:0.63582	val-aucpr:0.14659
[10]	train-logloss:0.64825	train-auc:0.68168	train-aucpr:0.29233	val-logloss:0.60461	val-auc:0.67464	val-aucpr:0.17367
[20]	train-logloss:0.63214	train-auc:0.68991	train-aucpr:0.30457	val-logloss:0.56054	val-auc:0.68716	val-aucpr:0.21107
[30]	train-logloss:0.62231	train-auc:0.69471	train-aucpr:0.30925	val-logloss:0.53823	val-auc:0.70750	val-aucpr:0.22299
[40]	train-logloss:0.61520	train-auc:0.69999	train-aucpr:0.31343	val-logloss:0.52627	val-auc:0.71235	val-aucpr:0.22367
[50]	train-logloss:0.60994	train-auc:0.70421	train-aucpr:0.31696	val-logloss:0.51487	val-auc:0.70663	val-aucpr:0.22161
[60]	train-logloss:0.60566	train-auc:0.71005	train-aucpr:0.32264	val-logloss:0.50661	val-auc:0.70535	val-aucpr:0.22029
[70]	train-logloss:0.60233	train-auc:0.71447	train-aucpr:0.32766	val-logloss:0.50332	val-auc:0.69111	val-aucpr:0.21207
[80]	train-logloss:0.59919	train-auc:0.71961	train-aucpr:0.33243	val-logloss:0.50556	val-auc:0.69179	val-aucpr:0.20591
[85]	train-logloss:0.59776	train-auc:0.72169	train-aucpr:0.33376	val-logloss:0.50797	val-auc:0.68978	val-aucpr:0.20146
[2025-11-19 08:50:10,087] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 08:50:10,087] [INFO] [<frozen importlib] - Best train loss: 0.6078
[2025-11-19 08:50:10,087] [INFO] [<frozen importlib] - Best val loss: 0.5083
[2025-11-19 08:50:10,087] [INFO] [<frozen importlib] - Best val AUC: 0.7074
[2025-11-19 08:50:10,087] [INFO] [<frozen importlib] - Best val AUCPR: 0.2248
[2025-11-19 08:50:10,092] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:50:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:50:22,838] [INFO] [<frozen importlib] - Optimal threshold: 0.4977
[2025-11-19 08:50:22,838] [INFO] [<frozen importlib] - Best f1: 0.2770
[2025-11-19 08:50:22,838] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:50:22,883] [INFO] [<frozen importlib] - Validation Results (threshold=0.4977):
[2025-11-19 08:50:22,883] [INFO] [<frozen importlib] -   Accuracy: 0.9069
[2025-11-19 08:50:22,883] [INFO] [<frozen importlib] -   Precision: 0.3435
[2025-11-19 08:50:22,883] [INFO] [<frozen importlib] -   Recall: 0.2321
[2025-11-19 08:50:22,883] [INFO] [<frozen importlib] -   F1 Score: 0.2770
[2025-11-19 08:50:22,883] [INFO] [<frozen importlib] -   AUROC: 0.7074
[2025-11-19 08:50:22,883] [INFO] [<frozen importlib] -   AUPRC: 0.2252
[2025-11-19 08:50:22,883] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:50:22,883] [INFO] [<frozen importlib] -     TN=16801, FP=644
[2025-11-19 08:50:22,883] [INFO] [<frozen importlib] -     FN=1115, TP=337
[2025-11-19 08:50:22,909] [INFO] [<frozen importlib] - Trial 184: AUPRC=0.2252, F1=0.4503, Prec=0.4860, Rec=0.4194 | Optimizing auprc=0.2252
[2025-11-19 08:50:22,909] [INFO] [<frozen importlib] - Trial 184 pruned.
[2025-11-19 08:50:22,909] [ERROR] [<frozen importlib] - Trial 184 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  37%|███▋      | 184/500 [28:20<57:24, 10.90s/it]Best trial: 140. Best value: 0.237476:  37%|███▋      | 184/500 [28:20<57:24, 10.90s/it]Best trial: 140. Best value: 0.237476:  37%|███▋      | 185/500 [28:20<1:00:46, 11.58s/it][2025-11-19 08:50:22,919] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 12.23424088504707
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   gamma: 0.22923590315999276
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   alpha: 0.9521752010312486
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   lambda: 0.6154481005175945
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   learning_rate: 0.040593470824239926
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   subsample: 0.8720184712758217
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   colsample_bytree: 0.5928235248772096
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   colsample_bylevel: 0.688486945018967
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   colsample_bynode: 0.7709573457296627
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:50:22,919] [INFO] [<frozen importlib] -   scale_pos_weight: 12.23424088504707
[2025-11-19 08:50:22,999] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:50:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:50:22,909] Trial 184 pruned. 
[0]	train-logloss:0.93795	train-auc:0.64929	train-aucpr:0.21642	val-logloss:0.95885	val-auc:0.63960	val-aucpr:0.14182
[10]	train-logloss:0.90053	train-auc:0.68651	train-aucpr:0.28702	val-logloss:0.86472	val-auc:0.68403	val-aucpr:0.19546
[20]	train-logloss:0.87990	train-auc:0.69120	train-aucpr:0.29631	val-logloss:0.79901	val-auc:0.70146	val-aucpr:0.20938
[30]	train-logloss:0.86669	train-auc:0.69600	train-aucpr:0.30205	val-logloss:0.75270	val-auc:0.70081	val-aucpr:0.22025
[40]	train-logloss:0.85743	train-auc:0.69905	train-aucpr:0.30724	val-logloss:0.72286	val-auc:0.70029	val-aucpr:0.22260
[50]	train-logloss:0.85012	train-auc:0.70261	train-aucpr:0.31253	val-logloss:0.69812	val-auc:0.70435	val-aucpr:0.22331
[60]	train-logloss:0.84441	train-auc:0.70683	train-aucpr:0.31727	val-logloss:0.68959	val-auc:0.70613	val-aucpr:0.22587
[70]	train-logloss:0.83923	train-auc:0.71207	train-aucpr:0.32139	val-logloss:0.66129	val-auc:0.67935	val-aucpr:0.20190
[80]	train-logloss:0.83441	train-auc:0.71782	train-aucpr:0.32771	val-logloss:0.63953	val-auc:0.67304	val-aucpr:0.17838
[84]	train-logloss:0.83266	train-auc:0.71880	train-aucpr:0.32913	val-logloss:0.64507	val-auc:0.66798	val-aucpr:0.17020
[2025-11-19 08:50:23,248] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 08:50:23,248] [INFO] [<frozen importlib] - Best train loss: 0.8477
[2025-11-19 08:50:23,248] [INFO] [<frozen importlib] - Best val loss: 0.6923
[2025-11-19 08:50:23,248] [INFO] [<frozen importlib] - Best val AUC: 0.7050
[2025-11-19 08:50:23,248] [INFO] [<frozen importlib] - Best val AUCPR: 0.2260
[2025-11-19 08:50:23,253] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:50:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:50:34,528] [INFO] [<frozen importlib] - Optimal threshold: 0.6303
[2025-11-19 08:50:34,528] [INFO] [<frozen importlib] - Best f1: 0.2713
[2025-11-19 08:50:34,528] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:50:34,575] [INFO] [<frozen importlib] - Validation Results (threshold=0.6303):
[2025-11-19 08:50:34,575] [INFO] [<frozen importlib] -   Accuracy: 0.8997
[2025-11-19 08:50:34,575] [INFO] [<frozen importlib] -   Precision: 0.3070
[2025-11-19 08:50:34,575] [INFO] [<frozen importlib] -   Recall: 0.2431
[2025-11-19 08:50:34,575] [INFO] [<frozen importlib] -   F1 Score: 0.2713
[2025-11-19 08:50:34,575] [INFO] [<frozen importlib] -   AUROC: 0.7050
[2025-11-19 08:50:34,575] [INFO] [<frozen importlib] -   AUPRC: 0.2263
[2025-11-19 08:50:34,575] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:50:34,575] [INFO] [<frozen importlib] -     TN=16648, FP=797
[2025-11-19 08:50:34,575] [INFO] [<frozen importlib] -     FN=1099, TP=353
[2025-11-19 08:50:34,598] [INFO] [<frozen importlib] - Trial 185: AUPRC=0.2263, F1=0.4559, Prec=0.4545, Rec=0.4573 | Optimizing auprc=0.2263
                                                                                          Best trial: 140. Best value: 0.237476:  37%|███▋      | 185/500 [28:32<1:00:46, 11.58s/it]Best trial: 140. Best value: 0.237476:  37%|███▋      | 185/500 [28:32<1:00:46, 11.58s/it]Best trial: 140. Best value: 0.237476:  37%|███▋      | 186/500 [28:32<1:00:45, 11.61s/it][2025-11-19 08:50:34,607] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.080837920657657
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   gamma: 0.32301548875500535
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   alpha: 0.8660819069499543
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   lambda: 0.8518312758180665
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   learning_rate: 0.0748815935705004
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   subsample: 0.7948757537607137
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   colsample_bytree: 0.579397914347939
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7895063663578731
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   colsample_bynode: 0.7889588932593974
[2025-11-19 08:50:34,607] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:50:34,608] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:50:34,608] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:50:34,608] [INFO] [<frozen importlib] -   scale_pos_weight: 6.080837920657657
[2025-11-19 08:50:34,681] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:50:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:50:34,598] Trial 185 finished with value: 0.22627018862296822 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.22923590315999276, 'learning_rate': 0.040593470824239926, 'n_estimators': 500, 'alpha': 0.9521752010312486, 'lambda': 0.6154481005175945, 'subsample': 0.8720184712758217, 'colsample_bytree': 0.5928235248772096, 'colsample_bylevel': 0.688486945018967, 'colsample_bynode': 0.7709573457296627, 'scale_pos_weight': 12.23424088504707}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.64575	train-auc:0.63832	train-aucpr:0.22654	val-logloss:0.63172	val-auc:0.60790	val-aucpr:0.12112
[10]	train-logloss:0.60975	train-auc:0.68719	train-aucpr:0.29549	val-logloss:0.54199	val-auc:0.68253	val-aucpr:0.18504
[20]	train-logloss:0.59389	train-auc:0.69678	train-aucpr:0.30760	val-logloss:0.50235	val-auc:0.70203	val-aucpr:0.19613
[30]	train-logloss:0.58478	train-auc:0.70360	train-aucpr:0.31768	val-logloss:0.48193	val-auc:0.70540	val-aucpr:0.20387
[40]	train-logloss:0.57861	train-auc:0.71392	train-aucpr:0.32616	val-logloss:0.47310	val-auc:0.70156	val-aucpr:0.20017
[50]	train-logloss:0.57256	train-auc:0.72298	train-aucpr:0.33530	val-logloss:0.44169	val-auc:0.67557	val-aucpr:0.17287
[56]	train-logloss:0.56983	train-auc:0.72789	train-aucpr:0.33951	val-logloss:0.43504	val-auc:0.67442	val-aucpr:0.16712
[2025-11-19 08:50:34,858] [INFO] [<frozen importlib] - Training completed at iteration 27
[2025-11-19 08:50:34,858] [INFO] [<frozen importlib] - Best train loss: 0.5874
[2025-11-19 08:50:34,858] [INFO] [<frozen importlib] - Best val loss: 0.4873
[2025-11-19 08:50:34,858] [INFO] [<frozen importlib] - Best val AUC: 0.7064
[2025-11-19 08:50:34,858] [INFO] [<frozen importlib] - Best val AUCPR: 0.2092
[2025-11-19 08:50:34,862] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:50:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:50:39,779] [INFO] [<frozen importlib] - Optimal threshold: 0.4791
[2025-11-19 08:50:39,779] [INFO] [<frozen importlib] - Best f1: 0.2644
[2025-11-19 08:50:39,779] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:50:39,818] [INFO] [<frozen importlib] - Validation Results (threshold=0.4791):
[2025-11-19 08:50:39,818] [INFO] [<frozen importlib] -   Accuracy: 0.8928
[2025-11-19 08:50:39,818] [INFO] [<frozen importlib] -   Precision: 0.2798
[2025-11-19 08:50:39,818] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 08:50:39,818] [INFO] [<frozen importlib] -   F1 Score: 0.2644
[2025-11-19 08:50:39,818] [INFO] [<frozen importlib] -   AUROC: 0.7064
[2025-11-19 08:50:39,818] [INFO] [<frozen importlib] -   AUPRC: 0.2095
[2025-11-19 08:50:39,818] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:50:39,818] [INFO] [<frozen importlib] -     TN=16508, FP=937
[2025-11-19 08:50:39,818] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 08:50:39,842] [INFO] [<frozen importlib] - Trial 186: AUPRC=0.2095, F1=0.4288, Prec=0.4103, Rec=0.4490 | Optimizing auprc=0.2095
[2025-11-19 08:50:39,842] [INFO] [<frozen importlib] - Trial 186 pruned.
[2025-11-19 08:50:39,842] [ERROR] [<frozen importlib] - Trial 186 failed with error: 
                                                                                          Best trial: 140. Best value: 0.237476:  37%|███▋      | 186/500 [28:37<1:00:45, 11.61s/it]Best trial: 140. Best value: 0.237476:  37%|███▋      | 186/500 [28:37<1:00:45, 11.61s/it]Best trial: 140. Best value: 0.237476:  37%|███▋      | 187/500 [28:37<50:36,  9.70s/it]  [2025-11-19 08:50:39,853] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.048714686190509
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   min_child_weight: 2
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   gamma: 0.24304076434514976
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   alpha: 0.7837219109772259
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   lambda: 1.648605246686426
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   learning_rate: 0.05434522793632133
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   subsample: 0.7727588952477484
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   colsample_bytree: 0.5684707947340637
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5654297586122974
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   colsample_bynode: 0.7385213975413597
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:50:39,853] [INFO] [<frozen importlib] -   scale_pos_weight: 7.048714686190509
[2025-11-19 08:50:39,931] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:50:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:50:39,842] Trial 186 pruned. 
[0]	train-logloss:0.70018	train-auc:0.64275	train-aucpr:0.22627	val-logloss:0.69795	val-auc:0.60120	val-aucpr:0.11254
[10]	train-logloss:0.66837	train-auc:0.68438	train-aucpr:0.28705	val-logloss:0.61984	val-auc:0.69631	val-aucpr:0.20636
[20]	train-logloss:0.65101	train-auc:0.69587	train-aucpr:0.30243	val-logloss:0.58254	val-auc:0.70268	val-aucpr:0.20603
[30]	train-logloss:0.64009	train-auc:0.70183	train-aucpr:0.31090	val-logloss:0.56286	val-auc:0.70528	val-aucpr:0.21212
[40]	train-logloss:0.63333	train-auc:0.70524	train-aucpr:0.31552	val-logloss:0.54592	val-auc:0.70536	val-aucpr:0.21758
[50]	train-logloss:0.62718	train-auc:0.71282	train-aucpr:0.32232	val-logloss:0.53313	val-auc:0.70297	val-aucpr:0.21652
[60]	train-logloss:0.62290	train-auc:0.71778	train-aucpr:0.32712	val-logloss:0.52980	val-auc:0.69579	val-aucpr:0.21204
[69]	train-logloss:0.61950	train-auc:0.72298	train-aucpr:0.33227	val-logloss:0.50557	val-auc:0.68997	val-aucpr:0.19540
[2025-11-19 08:50:40,142] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 08:50:40,142] [INFO] [<frozen importlib] - Best train loss: 0.6338
[2025-11-19 08:50:40,142] [INFO] [<frozen importlib] - Best val loss: 0.5473
[2025-11-19 08:50:40,142] [INFO] [<frozen importlib] - Best val AUC: 0.7059
[2025-11-19 08:50:40,142] [INFO] [<frozen importlib] - Best val AUCPR: 0.2182
[2025-11-19 08:50:40,147] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:50:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:50:50,841] [INFO] [<frozen importlib] - Optimal threshold: 0.5290
[2025-11-19 08:50:50,841] [INFO] [<frozen importlib] - Best f1: 0.2617
[2025-11-19 08:50:50,841] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:50:50,889] [INFO] [<frozen importlib] - Validation Results (threshold=0.5290):
[2025-11-19 08:50:50,889] [INFO] [<frozen importlib] -   Accuracy: 0.9006
[2025-11-19 08:50:50,889] [INFO] [<frozen importlib] -   Precision: 0.3047
[2025-11-19 08:50:50,889] [INFO] [<frozen importlib] -   Recall: 0.2293
[2025-11-19 08:50:50,889] [INFO] [<frozen importlib] -   F1 Score: 0.2617
[2025-11-19 08:50:50,889] [INFO] [<frozen importlib] -   AUROC: 0.7059
[2025-11-19 08:50:50,889] [INFO] [<frozen importlib] -   AUPRC: 0.2187
[2025-11-19 08:50:50,889] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:50:50,889] [INFO] [<frozen importlib] -     TN=16685, FP=760
[2025-11-19 08:50:50,889] [INFO] [<frozen importlib] -     FN=1119, TP=333
[2025-11-19 08:50:50,914] [INFO] [<frozen importlib] - Trial 187: AUPRC=0.2187, F1=0.4461, Prec=0.4552, Rec=0.4373 | Optimizing auprc=0.2187
                                                                                        Best trial: 140. Best value: 0.237476:  37%|███▋      | 187/500 [28:48<50:36,  9.70s/it]Best trial: 140. Best value: 0.237476:  37%|███▋      | 187/500 [28:48<50:36,  9.70s/it]Best trial: 140. Best value: 0.237476:  38%|███▊      | 188/500 [28:48<52:34, 10.11s/it][2025-11-19 08:50:50,925] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.574170357811665
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   gamma: 0.36062567150927904
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   alpha: 0.6770883832603792
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   lambda: 1.7698571706805735
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   learning_rate: 0.04692056865469038
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   subsample: 0.7641980368619289
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   colsample_bytree: 0.5222471290184738
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5372933229971876
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   colsample_bynode: 0.7238175413805497
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:50:50,925] [INFO] [<frozen importlib] -   scale_pos_weight: 7.574170357811665
[2025-11-19 08:50:51,001] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:50:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:50:50,914] Trial 187 finished with value: 0.2186885158083674 and parameters: {'max_depth': 4, 'min_child_weight': 2, 'gamma': 0.24304076434514976, 'learning_rate': 0.05434522793632133, 'n_estimators': 500, 'alpha': 0.7837219109772259, 'lambda': 1.648605246686426, 'subsample': 0.7727588952477484, 'colsample_bytree': 0.5684707947340637, 'colsample_bylevel': 0.5654297586122974, 'colsample_bynode': 0.7385213975413597, 'scale_pos_weight': 7.048714686190509}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.72846	train-auc:0.63462	train-aucpr:0.22325	val-logloss:0.73039	val-auc:0.63960	val-aucpr:0.14215
[10]	train-logloss:0.69806	train-auc:0.68445	train-aucpr:0.29087	val-logloss:0.65199	val-auc:0.66912	val-aucpr:0.18237
[20]	train-logloss:0.68078	train-auc:0.68899	train-aucpr:0.29994	val-logloss:0.61439	val-auc:0.70668	val-aucpr:0.21333
[30]	train-logloss:0.67014	train-auc:0.69444	train-aucpr:0.30667	val-logloss:0.57754	val-auc:0.70848	val-aucpr:0.23023
[40]	train-logloss:0.66203	train-auc:0.70085	train-aucpr:0.31364	val-logloss:0.55251	val-auc:0.71018	val-aucpr:0.22373
[50]	train-logloss:0.65602	train-auc:0.70728	train-aucpr:0.31839	val-logloss:0.54567	val-auc:0.70080	val-aucpr:0.21897
[60]	train-logloss:0.65133	train-auc:0.71175	train-aucpr:0.32363	val-logloss:0.54970	val-auc:0.70133	val-aucpr:0.21510
[2025-11-19 08:50:51,202] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 08:50:51,202] [INFO] [<frozen importlib] - Best train loss: 0.6691
[2025-11-19 08:50:51,202] [INFO] [<frozen importlib] - Best val loss: 0.5740
[2025-11-19 08:50:51,202] [INFO] [<frozen importlib] - Best val AUC: 0.7107
[2025-11-19 08:50:51,202] [INFO] [<frozen importlib] - Best val AUCPR: 0.2306
[2025-11-19 08:50:51,207] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:50:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:50:58,953] [INFO] [<frozen importlib] - Optimal threshold: 0.5181
[2025-11-19 08:50:58,953] [INFO] [<frozen importlib] - Best f1: 0.2790
[2025-11-19 08:50:58,953] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:50:58,996] [INFO] [<frozen importlib] - Validation Results (threshold=0.5181):
[2025-11-19 08:50:58,996] [INFO] [<frozen importlib] -   Accuracy: 0.9007
[2025-11-19 08:50:58,996] [INFO] [<frozen importlib] -   Precision: 0.3157
[2025-11-19 08:50:58,996] [INFO] [<frozen importlib] -   Recall: 0.2500
[2025-11-19 08:50:58,996] [INFO] [<frozen importlib] -   F1 Score: 0.2790
[2025-11-19 08:50:58,996] [INFO] [<frozen importlib] -   AUROC: 0.7107
[2025-11-19 08:50:58,996] [INFO] [<frozen importlib] -   AUPRC: 0.2310
[2025-11-19 08:50:58,996] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:50:58,996] [INFO] [<frozen importlib] -     TN=16658, FP=787
[2025-11-19 08:50:58,996] [INFO] [<frozen importlib] -     FN=1089, TP=363
[2025-11-19 08:50:59,022] [INFO] [<frozen importlib] - Trial 188: AUPRC=0.2310, F1=0.4354, Prec=0.4418, Rec=0.4291 | Optimizing auprc=0.2310
                                                                                        Best trial: 140. Best value: 0.237476:  38%|███▊      | 188/500 [28:56<52:34, 10.11s/it]Best trial: 140. Best value: 0.237476:  38%|███▊      | 188/500 [28:56<52:34, 10.11s/it]Best trial: 140. Best value: 0.237476:  38%|███▊      | 189/500 [28:56<49:17,  9.51s/it][2025-11-19 08:50:59,032] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.80849672165991
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   gamma: 0.4645717097169953
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   alpha: 0.5830419018250849
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   lambda: 1.7454816609645951
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   learning_rate: 0.04684093604973234
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   subsample: 0.7578314888019448
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   colsample_bytree: 0.5177795578965447
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5359695716648969
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   colsample_bynode: 0.7248439996126596
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:50:59,032] [INFO] [<frozen importlib] -   scale_pos_weight: 7.80849672165991
[2025-11-19 08:50:59,105] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:50:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:50:59,022] Trial 188 finished with value: 0.23097677942500755 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.36062567150927904, 'learning_rate': 0.04692056865469038, 'n_estimators': 450, 'alpha': 0.6770883832603792, 'lambda': 1.7698571706805735, 'subsample': 0.7641980368619289, 'colsample_bytree': 0.5222471290184738, 'colsample_bylevel': 0.5372933229971876, 'colsample_bynode': 0.7238175413805497, 'scale_pos_weight': 7.574170357811665}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.74060	train-auc:0.63429	train-aucpr:0.22144	val-logloss:0.74400	val-auc:0.63587	val-aucpr:0.13760
[10]	train-logloss:0.70952	train-auc:0.68448	train-aucpr:0.29143	val-logloss:0.66589	val-auc:0.66080	val-aucpr:0.17576
[20]	train-logloss:0.69182	train-auc:0.68970	train-aucpr:0.30023	val-logloss:0.62670	val-auc:0.69699	val-aucpr:0.21320
[30]	train-logloss:0.68087	train-auc:0.69433	train-aucpr:0.30702	val-logloss:0.58863	val-auc:0.70749	val-aucpr:0.22872
[40]	train-logloss:0.67268	train-auc:0.70074	train-aucpr:0.31357	val-logloss:0.56403	val-auc:0.70985	val-aucpr:0.22060
[50]	train-logloss:0.66658	train-auc:0.70651	train-aucpr:0.31882	val-logloss:0.55653	val-auc:0.70588	val-aucpr:0.21959
[60]	train-logloss:0.66173	train-auc:0.71117	train-aucpr:0.32430	val-logloss:0.55360	val-auc:0.70543	val-aucpr:0.21625
[2025-11-19 08:50:59,291] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 08:50:59,291] [INFO] [<frozen importlib] - Best train loss: 0.6798
[2025-11-19 08:50:59,291] [INFO] [<frozen importlib] - Best val loss: 0.5849
[2025-11-19 08:50:59,291] [INFO] [<frozen importlib] - Best val AUC: 0.7094
[2025-11-19 08:50:59,291] [INFO] [<frozen importlib] - Best val AUCPR: 0.2293
[2025-11-19 08:50:59,295] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:50:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:51:07,446] [INFO] [<frozen importlib] - Optimal threshold: 0.5362
[2025-11-19 08:51:07,446] [INFO] [<frozen importlib] - Best f1: 0.2760
[2025-11-19 08:51:07,446] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:51:07,487] [INFO] [<frozen importlib] - Validation Results (threshold=0.5362):
[2025-11-19 08:51:07,488] [INFO] [<frozen importlib] -   Accuracy: 0.9076
[2025-11-19 08:51:07,488] [INFO] [<frozen importlib] -   Precision: 0.3465
[2025-11-19 08:51:07,488] [INFO] [<frozen importlib] -   Recall: 0.2293
[2025-11-19 08:51:07,488] [INFO] [<frozen importlib] -   F1 Score: 0.2760
[2025-11-19 08:51:07,488] [INFO] [<frozen importlib] -   AUROC: 0.7094
[2025-11-19 08:51:07,488] [INFO] [<frozen importlib] -   AUPRC: 0.2296
[2025-11-19 08:51:07,488] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:51:07,488] [INFO] [<frozen importlib] -     TN=16817, FP=628
[2025-11-19 08:51:07,488] [INFO] [<frozen importlib] -     FN=1119, TP=333
[2025-11-19 08:51:07,513] [INFO] [<frozen importlib] - Trial 189: AUPRC=0.2296, F1=0.4587, Prec=0.4964, Rec=0.4263 | Optimizing auprc=0.2296
                                                                                        Best trial: 140. Best value: 0.237476:  38%|███▊      | 189/500 [29:05<49:17,  9.51s/it]Best trial: 140. Best value: 0.237476:  38%|███▊      | 189/500 [29:05<49:17,  9.51s/it]Best trial: 140. Best value: 0.237476:  38%|███▊      | 190/500 [29:05<47:33,  9.20s/it][2025-11-19 08:51:07,530] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.066294393023457
[2025-11-19 08:51:07,530] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:51:07,530] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   gamma: 0.3700129334360577
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   alpha: 0.6677202036723779
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   lambda: 1.8866054192741524
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   learning_rate: 0.042594639286094395
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   subsample: 0.7701797613370771
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   colsample_bytree: 0.5094740567488328
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5285162270429858
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   colsample_bynode: 0.7103656154651625
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:51:07,531] [INFO] [<frozen importlib] -   scale_pos_weight: 8.066294393023457
[2025-11-19 08:51:07,606] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:51:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:51:07,513] Trial 189 finished with value: 0.22961718713146007 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.4645717097169953, 'learning_rate': 0.04684093604973234, 'n_estimators': 450, 'alpha': 0.5830419018250849, 'lambda': 1.7454816609645951, 'subsample': 0.7578314888019448, 'colsample_bytree': 0.5177795578965447, 'colsample_bylevel': 0.5359695716648969, 'colsample_bynode': 0.7248439996126596, 'scale_pos_weight': 7.80849672165991}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.75444	train-auc:0.63240	train-aucpr:0.22155	val-logloss:0.75746	val-auc:0.64524	val-aucpr:0.12193
[10]	train-logloss:0.72511	train-auc:0.68169	train-aucpr:0.28970	val-logloss:0.69249	val-auc:0.66902	val-aucpr:0.17663
[20]	train-logloss:0.70763	train-auc:0.68967	train-aucpr:0.29792	val-logloss:0.64310	val-auc:0.70534	val-aucpr:0.21291
[30]	train-logloss:0.69618	train-auc:0.69307	train-aucpr:0.30390	val-logloss:0.60924	val-auc:0.70752	val-aucpr:0.21399
[40]	train-logloss:0.68794	train-auc:0.69881	train-aucpr:0.30822	val-logloss:0.59166	val-auc:0.70263	val-aucpr:0.21538
[50]	train-logloss:0.68173	train-auc:0.70285	train-aucpr:0.31247	val-logloss:0.58028	val-auc:0.70169	val-aucpr:0.22021
[60]	train-logloss:0.67702	train-auc:0.70612	train-aucpr:0.31581	val-logloss:0.57459	val-auc:0.70682	val-aucpr:0.22164
[70]	train-logloss:0.67312	train-auc:0.71091	train-aucpr:0.32013	val-logloss:0.58038	val-auc:0.69793	val-aucpr:0.21353
[80]	train-logloss:0.66983	train-auc:0.71445	train-aucpr:0.32497	val-logloss:0.56843	val-auc:0.69679	val-aucpr:0.21266
[87]	train-logloss:0.66771	train-auc:0.71693	train-aucpr:0.32703	val-logloss:0.57253	val-auc:0.69527	val-aucpr:0.21175
[2025-11-19 08:51:07,857] [INFO] [<frozen importlib] - Training completed at iteration 58
[2025-11-19 08:51:07,857] [INFO] [<frozen importlib] - Best train loss: 0.6779
[2025-11-19 08:51:07,857] [INFO] [<frozen importlib] - Best val loss: 0.5744
[2025-11-19 08:51:07,857] [INFO] [<frozen importlib] - Best val AUC: 0.7050
[2025-11-19 08:51:07,857] [INFO] [<frozen importlib] - Best val AUCPR: 0.2243
[2025-11-19 08:51:07,863] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:51:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:51:20,916] [INFO] [<frozen importlib] - Optimal threshold: 0.5478
[2025-11-19 08:51:20,916] [INFO] [<frozen importlib] - Best f1: 0.2670
[2025-11-19 08:51:20,916] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:51:20,962] [INFO] [<frozen importlib] - Validation Results (threshold=0.5478):
[2025-11-19 08:51:20,962] [INFO] [<frozen importlib] -   Accuracy: 0.9015
[2025-11-19 08:51:20,962] [INFO] [<frozen importlib] -   Precision: 0.3119
[2025-11-19 08:51:20,962] [INFO] [<frozen importlib] -   Recall: 0.2335
[2025-11-19 08:51:20,962] [INFO] [<frozen importlib] -   F1 Score: 0.2670
[2025-11-19 08:51:20,962] [INFO] [<frozen importlib] -   AUROC: 0.7050
[2025-11-19 08:51:20,962] [INFO] [<frozen importlib] -   AUPRC: 0.2247
[2025-11-19 08:51:20,962] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:51:20,962] [INFO] [<frozen importlib] -     TN=16697, FP=748
[2025-11-19 08:51:20,962] [INFO] [<frozen importlib] -     FN=1113, TP=339
[2025-11-19 08:51:20,985] [INFO] [<frozen importlib] - Trial 190: AUPRC=0.2247, F1=0.4408, Prec=0.4540, Rec=0.4284 | Optimizing auprc=0.2247
                                                                                        Best trial: 140. Best value: 0.237476:  38%|███▊      | 190/500 [29:18<47:33,  9.20s/it]Best trial: 140. Best value: 0.237476:  38%|███▊      | 190/500 [29:18<47:33,  9.20s/it]Best trial: 140. Best value: 0.237476:  38%|███▊      | 191/500 [29:18<53:59, 10.49s/it][2025-11-19 08:51:20,998] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.633037228785017
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   gamma: 0.35623648992228046
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   alpha: 0.5805812123019232
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   lambda: 1.5724718315184791
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   learning_rate: 0.048045218431687534
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   subsample: 0.7558677176298811
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   colsample_bytree: 0.5226946543477329
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   colsample_bylevel: 0.536763511854611
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   colsample_bynode: 0.7198976334717418
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:51:20,998] [INFO] [<frozen importlib] -   scale_pos_weight: 7.633037228785017
[2025-11-19 08:51:21,073] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:51:21] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:51:20,986] Trial 190 finished with value: 0.22472262737896462 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.3700129334360577, 'learning_rate': 0.042594639286094395, 'n_estimators': 450, 'alpha': 0.6677202036723779, 'lambda': 1.8866054192741524, 'subsample': 0.7701797613370771, 'colsample_bytree': 0.5094740567488328, 'colsample_bylevel': 0.5285162270429858, 'colsample_bynode': 0.7103656154651625, 'scale_pos_weight': 8.066294393023457}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.73144	train-auc:0.63429	train-aucpr:0.22144	val-logloss:0.73369	val-auc:0.63587	val-aucpr:0.13760
[10]	train-logloss:0.70034	train-auc:0.68434	train-aucpr:0.29139	val-logloss:0.65555	val-auc:0.66062	val-aucpr:0.17615
[20]	train-logloss:0.68293	train-auc:0.68940	train-aucpr:0.30008	val-logloss:0.61847	val-auc:0.69437	val-aucpr:0.21236
[30]	train-logloss:0.67216	train-auc:0.69430	train-aucpr:0.30664	val-logloss:0.58174	val-auc:0.69669	val-aucpr:0.22551
[40]	train-logloss:0.66405	train-auc:0.70138	train-aucpr:0.31326	val-logloss:0.56419	val-auc:0.70506	val-aucpr:0.21261
[50]	train-logloss:0.65824	train-auc:0.70669	train-aucpr:0.31788	val-logloss:0.56274	val-auc:0.69840	val-aucpr:0.21157
[60]	train-logloss:0.65355	train-auc:0.71125	train-aucpr:0.32352	val-logloss:0.55599	val-auc:0.69905	val-aucpr:0.21278
[61]	train-logloss:0.65329	train-auc:0.71172	train-aucpr:0.32370	val-logloss:0.55353	val-auc:0.69909	val-aucpr:0.21277
[2025-11-19 08:51:21,267] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 08:51:21,267] [INFO] [<frozen importlib] - Best train loss: 0.6711
[2025-11-19 08:51:21,267] [INFO] [<frozen importlib] - Best val loss: 0.5791
[2025-11-19 08:51:21,267] [INFO] [<frozen importlib] - Best val AUC: 0.6976
[2025-11-19 08:51:21,267] [INFO] [<frozen importlib] - Best val AUCPR: 0.2259
[2025-11-19 08:51:21,272] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:51:21] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:51:29,188] [INFO] [<frozen importlib] - Optimal threshold: 0.5210
[2025-11-19 08:51:29,188] [INFO] [<frozen importlib] - Best f1: 0.2775
[2025-11-19 08:51:29,188] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:51:29,231] [INFO] [<frozen importlib] - Validation Results (threshold=0.5210):
[2025-11-19 08:51:29,232] [INFO] [<frozen importlib] -   Accuracy: 0.9011
[2025-11-19 08:51:29,232] [INFO] [<frozen importlib] -   Precision: 0.3163
[2025-11-19 08:51:29,232] [INFO] [<frozen importlib] -   Recall: 0.2472
[2025-11-19 08:51:29,232] [INFO] [<frozen importlib] -   F1 Score: 0.2775
[2025-11-19 08:51:29,232] [INFO] [<frozen importlib] -   AUROC: 0.6976
[2025-11-19 08:51:29,232] [INFO] [<frozen importlib] -   AUPRC: 0.2263
[2025-11-19 08:51:29,232] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:51:29,232] [INFO] [<frozen importlib] -     TN=16669, FP=776
[2025-11-19 08:51:29,232] [INFO] [<frozen importlib] -     FN=1093, TP=359
[2025-11-19 08:51:29,255] [INFO] [<frozen importlib] - Trial 191: AUPRC=0.2263, F1=0.4387, Prec=0.4465, Rec=0.4311 | Optimizing auprc=0.2263
                                                                                        Best trial: 140. Best value: 0.237476:  38%|███▊      | 191/500 [29:27<53:59, 10.49s/it]Best trial: 140. Best value: 0.237476:  38%|███▊      | 191/500 [29:27<53:59, 10.49s/it]Best trial: 140. Best value: 0.237476:  38%|███▊      | 192/500 [29:27<50:24,  9.82s/it][2025-11-19 08:51:29,265] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.57183688947567
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   gamma: 0.3913912471403378
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   alpha: 0.6166786589235441
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   lambda: 1.757622636686087
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   learning_rate: 0.046419359458542454
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   subsample: 0.7422056917876613
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   colsample_bytree: 0.5186826932144636
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5511046402212567
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   colsample_bynode: 0.7262619721136
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:51:29,265] [INFO] [<frozen importlib] -   scale_pos_weight: 8.57183688947567
[2025-11-19 08:51:29,338] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:51:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:51:29,255] Trial 191 finished with value: 0.2262899142610058 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.35623648992228046, 'learning_rate': 0.048045218431687534, 'n_estimators': 450, 'alpha': 0.5805812123019232, 'lambda': 1.5724718315184791, 'subsample': 0.7558677176298811, 'colsample_bytree': 0.5226946543477329, 'colsample_bylevel': 0.536763511854611, 'colsample_bynode': 0.7198976334717418, 'scale_pos_weight': 7.633037228785017}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.77919	train-auc:0.63425	train-aucpr:0.23015	val-logloss:0.78640	val-auc:0.63871	val-aucpr:0.14614
[10]	train-logloss:0.74657	train-auc:0.68465	train-aucpr:0.28439	val-logloss:0.72307	val-auc:0.68540	val-aucpr:0.19222
[20]	train-logloss:0.72766	train-auc:0.69080	train-aucpr:0.29988	val-logloss:0.67587	val-auc:0.71063	val-aucpr:0.20299
[30]	train-logloss:0.71583	train-auc:0.69500	train-aucpr:0.30720	val-logloss:0.62850	val-auc:0.71216	val-aucpr:0.22129
[40]	train-logloss:0.70718	train-auc:0.70121	train-aucpr:0.31243	val-logloss:0.60427	val-auc:0.70808	val-aucpr:0.22185
[50]	train-logloss:0.70145	train-auc:0.70517	train-aucpr:0.31577	val-logloss:0.59260	val-auc:0.70775	val-aucpr:0.21754
[60]	train-logloss:0.69636	train-auc:0.70942	train-aucpr:0.32114	val-logloss:0.59746	val-auc:0.70532	val-aucpr:0.21780
[65]	train-logloss:0.69426	train-auc:0.71095	train-aucpr:0.32306	val-logloss:0.59793	val-auc:0.70042	val-aucpr:0.21067
[2025-11-19 08:51:29,534] [INFO] [<frozen importlib] - Training completed at iteration 35
[2025-11-19 08:51:29,534] [INFO] [<frozen importlib] - Best train loss: 0.7113
[2025-11-19 08:51:29,534] [INFO] [<frozen importlib] - Best val loss: 0.6101
[2025-11-19 08:51:29,534] [INFO] [<frozen importlib] - Best val AUC: 0.7126
[2025-11-19 08:51:29,534] [INFO] [<frozen importlib] - Best val AUCPR: 0.2240
[2025-11-19 08:51:29,538] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:51:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:51:39,060] [INFO] [<frozen importlib] - Optimal threshold: 0.5512
[2025-11-19 08:51:39,060] [INFO] [<frozen importlib] - Best f1: 0.2784
[2025-11-19 08:51:39,060] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:51:39,100] [INFO] [<frozen importlib] - Validation Results (threshold=0.5512):
[2025-11-19 08:51:39,100] [INFO] [<frozen importlib] -   Accuracy: 0.9059
[2025-11-19 08:51:39,100] [INFO] [<frozen importlib] -   Precision: 0.3389
[2025-11-19 08:51:39,100] [INFO] [<frozen importlib] -   Recall: 0.2362
[2025-11-19 08:51:39,100] [INFO] [<frozen importlib] -   F1 Score: 0.2784
[2025-11-19 08:51:39,101] [INFO] [<frozen importlib] -   AUROC: 0.7126
[2025-11-19 08:51:39,101] [INFO] [<frozen importlib] -   AUPRC: 0.2244
[2025-11-19 08:51:39,101] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:51:39,101] [INFO] [<frozen importlib] -     TN=16776, FP=669
[2025-11-19 08:51:39,101] [INFO] [<frozen importlib] -     FN=1109, TP=343
[2025-11-19 08:51:39,129] [INFO] [<frozen importlib] - Trial 192: AUPRC=0.2244, F1=0.4630, Prec=0.4885, Rec=0.4401 | Optimizing auprc=0.2244
                                                                                        Best trial: 140. Best value: 0.237476:  38%|███▊      | 192/500 [29:37<50:24,  9.82s/it]Best trial: 140. Best value: 0.237476:  38%|███▊      | 192/500 [29:37<50:24,  9.82s/it]Best trial: 140. Best value: 0.237476:  39%|███▊      | 193/500 [29:37<50:19,  9.84s/it][2025-11-19 08:51:39,139] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.806539172684913
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   gamma: 0.48085317593476784
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   alpha: 0.5189052142077939
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   lambda: 1.9573218595723791
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   learning_rate: 0.039113068236966565
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   subsample: 0.7626023854586788
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   colsample_bytree: 0.5267202288008006
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5404489586989976
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   colsample_bynode: 0.7493230576436064
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:51:39,139] [INFO] [<frozen importlib] -   scale_pos_weight: 7.806539172684913
[2025-11-19 08:51:39,213] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:51:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:51:39,130] Trial 192 finished with value: 0.22437078102143665 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.3913912471403378, 'learning_rate': 0.046419359458542454, 'n_estimators': 450, 'alpha': 0.6166786589235441, 'lambda': 1.757622636686087, 'subsample': 0.7422056917876613, 'colsample_bytree': 0.5186826932144636, 'colsample_bylevel': 0.5511046402212567, 'colsample_bynode': 0.7262619721136, 'scale_pos_weight': 8.57183688947567}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.74114	train-auc:0.63458	train-aucpr:0.22324	val-logloss:0.74509	val-auc:0.63932	val-aucpr:0.14213
[10]	train-logloss:0.71383	train-auc:0.68422	train-aucpr:0.28970	val-logloss:0.67991	val-auc:0.68474	val-aucpr:0.20246
[20]	train-logloss:0.69663	train-auc:0.69002	train-aucpr:0.30186	val-logloss:0.63226	val-auc:0.70861	val-aucpr:0.21659
[30]	train-logloss:0.68563	train-auc:0.69328	train-aucpr:0.30621	val-logloss:0.60014	val-auc:0.69988	val-aucpr:0.22495
[40]	train-logloss:0.67748	train-auc:0.69791	train-aucpr:0.31118	val-logloss:0.57801	val-auc:0.70956	val-aucpr:0.23041
[50]	train-logloss:0.67140	train-auc:0.70268	train-aucpr:0.31377	val-logloss:0.56195	val-auc:0.70818	val-aucpr:0.22473
[60]	train-logloss:0.66658	train-auc:0.70660	train-aucpr:0.31751	val-logloss:0.55183	val-auc:0.70909	val-aucpr:0.22690
[69]	train-logloss:0.66322	train-auc:0.71004	train-aucpr:0.32124	val-logloss:0.54704	val-auc:0.70683	val-aucpr:0.22743
[2025-11-19 08:51:39,418] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 08:51:39,418] [INFO] [<frozen importlib] - Best train loss: 0.6784
[2025-11-19 08:51:39,418] [INFO] [<frozen importlib] - Best val loss: 0.5773
[2025-11-19 08:51:39,418] [INFO] [<frozen importlib] - Best val AUC: 0.7086
[2025-11-19 08:51:39,418] [INFO] [<frozen importlib] - Best val AUCPR: 0.2306
[2025-11-19 08:51:39,422] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:51:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:51:49,303] [INFO] [<frozen importlib] - Optimal threshold: 0.5238
[2025-11-19 08:51:49,303] [INFO] [<frozen importlib] - Best f1: 0.2766
[2025-11-19 08:51:49,303] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:51:49,348] [INFO] [<frozen importlib] - Validation Results (threshold=0.5238):
[2025-11-19 08:51:49,349] [INFO] [<frozen importlib] -   Accuracy: 0.8871
[2025-11-19 08:51:49,349] [INFO] [<frozen importlib] -   Precision: 0.2724
[2025-11-19 08:51:49,349] [INFO] [<frozen importlib] -   Recall: 0.2810
[2025-11-19 08:51:49,349] [INFO] [<frozen importlib] -   F1 Score: 0.2766
[2025-11-19 08:51:49,349] [INFO] [<frozen importlib] -   AUROC: 0.7086
[2025-11-19 08:51:49,349] [INFO] [<frozen importlib] -   AUPRC: 0.2309
[2025-11-19 08:51:49,349] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:51:49,349] [INFO] [<frozen importlib] -     TN=16355, FP=1090
[2025-11-19 08:51:49,349] [INFO] [<frozen importlib] -     FN=1044, TP=408
[2025-11-19 08:51:49,374] [INFO] [<frozen importlib] - Trial 193: AUPRC=0.2309, F1=0.4495, Prec=0.4034, Rec=0.5076 | Optimizing auprc=0.2309
                                                                                        Best trial: 140. Best value: 0.237476:  39%|███▊      | 193/500 [29:47<50:19,  9.84s/it]Best trial: 140. Best value: 0.237476:  39%|███▊      | 193/500 [29:47<50:19,  9.84s/it]Best trial: 140. Best value: 0.237476:  39%|███▉      | 194/500 [29:47<50:47,  9.96s/it][2025-11-19 08:51:49,384] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.189482876470565
[2025-11-19 08:51:49,384] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:51:49,384] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:51:49,384] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:51:49,384] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:51:49,384] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   gamma: 0.2798598650891349
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   alpha: 0.6901918668374203
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   lambda: 1.9662569232277112
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   learning_rate: 0.03989255877934106
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   subsample: 0.7666750678660221
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   colsample_bytree: 0.529888394671232
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5182741406292476
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   colsample_bynode: 0.7577856748640194
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:51:49,385] [INFO] [<frozen importlib] -   scale_pos_weight: 8.189482876470565
[2025-11-19 08:51:49,455] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:51:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:51:49,374] Trial 193 finished with value: 0.23094569189513384 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.48085317593476784, 'learning_rate': 0.039113068236966565, 'n_estimators': 450, 'alpha': 0.5189052142077939, 'lambda': 1.9573218595723791, 'subsample': 0.7626023854586788, 'colsample_bytree': 0.5267202288008006, 'colsample_bylevel': 0.5404489586989976, 'colsample_bynode': 0.7493230576436064, 'scale_pos_weight': 7.806539172684913}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.76085	train-auc:0.63240	train-aucpr:0.22155	val-logloss:0.76491	val-auc:0.64524	val-aucpr:0.12193
[10]	train-logloss:0.73242	train-auc:0.67698	train-aucpr:0.28401	val-logloss:0.69384	val-auc:0.69740	val-aucpr:0.19978
[20]	train-logloss:0.71549	train-auc:0.68611	train-aucpr:0.29676	val-logloss:0.65063	val-auc:0.69820	val-aucpr:0.21404
[30]	train-logloss:0.70421	train-auc:0.69042	train-aucpr:0.30333	val-logloss:0.61636	val-auc:0.69381	val-aucpr:0.21529
[40]	train-logloss:0.69587	train-auc:0.69558	train-aucpr:0.30769	val-logloss:0.60627	val-auc:0.70582	val-aucpr:0.22028
[50]	train-logloss:0.68929	train-auc:0.70268	train-aucpr:0.31256	val-logloss:0.58725	val-auc:0.70408	val-aucpr:0.21617
[60]	train-logloss:0.68422	train-auc:0.70677	train-aucpr:0.31587	val-logloss:0.57783	val-auc:0.69721	val-aucpr:0.21260
[70]	train-logloss:0.68024	train-auc:0.70982	train-aucpr:0.31931	val-logloss:0.58328	val-auc:0.69515	val-aucpr:0.20804
[75]	train-logloss:0.67906	train-auc:0.71124	train-aucpr:0.32073	val-logloss:0.58711	val-auc:0.69726	val-aucpr:0.20931
[2025-11-19 08:51:49,674] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 08:51:49,674] [INFO] [<frozen importlib] - Best train loss: 0.6924
[2025-11-19 08:51:49,674] [INFO] [<frozen importlib] - Best val loss: 0.5986
[2025-11-19 08:51:49,674] [INFO] [<frozen importlib] - Best val AUC: 0.7081
[2025-11-19 08:51:49,674] [INFO] [<frozen importlib] - Best val AUCPR: 0.2258
[2025-11-19 08:51:49,678] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:51:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:52:00,279] [INFO] [<frozen importlib] - Optimal threshold: 0.5458
[2025-11-19 08:52:00,279] [INFO] [<frozen importlib] - Best f1: 0.2817
[2025-11-19 08:52:00,279] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:52:00,325] [INFO] [<frozen importlib] - Validation Results (threshold=0.5458):
[2025-11-19 08:52:00,325] [INFO] [<frozen importlib] -   Accuracy: 0.8969
[2025-11-19 08:52:00,325] [INFO] [<frozen importlib] -   Precision: 0.3032
[2025-11-19 08:52:00,325] [INFO] [<frozen importlib] -   Recall: 0.2631
[2025-11-19 08:52:00,325] [INFO] [<frozen importlib] -   F1 Score: 0.2817
[2025-11-19 08:52:00,325] [INFO] [<frozen importlib] -   AUROC: 0.7081
[2025-11-19 08:52:00,325] [INFO] [<frozen importlib] -   AUPRC: 0.2262
[2025-11-19 08:52:00,325] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:52:00,325] [INFO] [<frozen importlib] -     TN=16567, FP=878
[2025-11-19 08:52:00,325] [INFO] [<frozen importlib] -     FN=1070, TP=382
[2025-11-19 08:52:00,350] [INFO] [<frozen importlib] - Trial 194: AUPRC=0.2262, F1=0.4487, Prec=0.4343, Rec=0.4642 | Optimizing auprc=0.2262
[2025-11-19 08:52:00,350] [INFO] [<frozen importlib] - Trial 194 pruned.
[2025-11-19 08:52:00,350] [ERROR] [<frozen importlib] - Trial 194 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  39%|███▉      | 194/500 [29:58<50:47,  9.96s/it]Best trial: 140. Best value: 0.237476:  39%|███▉      | 194/500 [29:58<50:47,  9.96s/it]Best trial: 140. Best value: 0.237476:  39%|███▉      | 195/500 [29:58<52:11, 10.27s/it][2025-11-19 08:52:00,374] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.778285809900618
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   gamma: 0.4595778211012252
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   alpha: 1.0731452578558371
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   lambda: 2.4215480438542563
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   learning_rate: 0.03924558964202467
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   subsample: 0.7301067659903293
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   colsample_bytree: 0.5086546370211552
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5427258530199257
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   colsample_bynode: 0.7441825900969556
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:52:00,374] [INFO] [<frozen importlib] -   scale_pos_weight: 7.778285809900618
[2025-11-19 08:52:00,447] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:52:00] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:52:00,356] Trial 194 pruned. 
[0]	train-logloss:0.73970	train-auc:0.63807	train-aucpr:0.22437	val-logloss:0.74196	val-auc:0.65412	val-aucpr:0.13014
[10]	train-logloss:0.71335	train-auc:0.68106	train-aucpr:0.28223	val-logloss:0.67823	val-auc:0.70238	val-aucpr:0.21473
[20]	train-logloss:0.69628	train-auc:0.68718	train-aucpr:0.29808	val-logloss:0.63616	val-auc:0.71483	val-aucpr:0.22430
[30]	train-logloss:0.68508	train-auc:0.69269	train-aucpr:0.30367	val-logloss:0.60252	val-auc:0.70520	val-aucpr:0.22727
[40]	train-logloss:0.67699	train-auc:0.69765	train-aucpr:0.30956	val-logloss:0.56967	val-auc:0.69333	val-aucpr:0.22392
[50]	train-logloss:0.67084	train-auc:0.70147	train-aucpr:0.31277	val-logloss:0.55507	val-auc:0.69898	val-aucpr:0.22706
[60]	train-logloss:0.66624	train-auc:0.70530	train-aucpr:0.31746	val-logloss:0.54432	val-auc:0.70361	val-aucpr:0.22928
[70]	train-logloss:0.66215	train-auc:0.70960	train-aucpr:0.32105	val-logloss:0.53538	val-auc:0.69604	val-aucpr:0.22271
[80]	train-logloss:0.65844	train-auc:0.71400	train-aucpr:0.32560	val-logloss:0.52067	val-auc:0.69306	val-aucpr:0.21630
[89]	train-logloss:0.65639	train-auc:0.71661	train-aucpr:0.32846	val-logloss:0.52010	val-auc:0.68325	val-aucpr:0.20229
[2025-11-19 08:52:00,703] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:52:00,703] [INFO] [<frozen importlib] - Best train loss: 0.6662
[2025-11-19 08:52:00,703] [INFO] [<frozen importlib] - Best val loss: 0.5443
[2025-11-19 08:52:00,703] [INFO] [<frozen importlib] - Best val AUC: 0.7036
[2025-11-19 08:52:00,703] [INFO] [<frozen importlib] - Best val AUCPR: 0.2293
[2025-11-19 08:52:00,708] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:52:00] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:52:14,172] [INFO] [<frozen importlib] - Optimal threshold: 0.5126
[2025-11-19 08:52:14,172] [INFO] [<frozen importlib] - Best f1: 0.2690
[2025-11-19 08:52:14,172] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:52:14,217] [INFO] [<frozen importlib] - Validation Results (threshold=0.5126):
[2025-11-19 08:52:14,217] [INFO] [<frozen importlib] -   Accuracy: 0.8936
[2025-11-19 08:52:14,217] [INFO] [<frozen importlib] -   Precision: 0.2848
[2025-11-19 08:52:14,217] [INFO] [<frozen importlib] -   Recall: 0.2548
[2025-11-19 08:52:14,217] [INFO] [<frozen importlib] -   F1 Score: 0.2690
[2025-11-19 08:52:14,217] [INFO] [<frozen importlib] -   AUROC: 0.7036
[2025-11-19 08:52:14,217] [INFO] [<frozen importlib] -   AUPRC: 0.2297
[2025-11-19 08:52:14,217] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:52:14,217] [INFO] [<frozen importlib] -     TN=16516, FP=929
[2025-11-19 08:52:14,217] [INFO] [<frozen importlib] -     FN=1082, TP=370
[2025-11-19 08:52:14,242] [INFO] [<frozen importlib] - Trial 195: AUPRC=0.2297, F1=0.4356, Prec=0.4165, Rec=0.4566 | Optimizing auprc=0.2297
                                                                                        Best trial: 140. Best value: 0.237476:  39%|███▉      | 195/500 [30:12<52:11, 10.27s/it]Best trial: 140. Best value: 0.237476:  39%|███▉      | 195/500 [30:12<52:11, 10.27s/it]Best trial: 140. Best value: 0.237476:  39%|███▉      | 196/500 [30:12<57:31, 11.35s/it][2025-11-19 08:52:14,260] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.4323135426911575
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   gamma: 0.4652389231190298
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   alpha: 0.28165992210630064
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   lambda: 2.1473293654776326
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   learning_rate: 0.03719628454434705
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   subsample: 0.728196083598626
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   colsample_bytree: 0.5086590485812622
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5425869544264309
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   colsample_bynode: 0.7521361218382983
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:52:14,260] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:52:14,261] [INFO] [<frozen importlib] -   scale_pos_weight: 7.4323135426911575
[2025-11-19 08:52:14,345] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:52:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:52:14,243] Trial 195 finished with value: 0.22969199667299994 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.4595778211012252, 'learning_rate': 0.03924558964202467, 'n_estimators': 400, 'alpha': 1.0731452578558371, 'lambda': 2.4215480438542563, 'subsample': 0.7301067659903293, 'colsample_bytree': 0.5086546370211552, 'colsample_bylevel': 0.5427258530199257, 'colsample_bynode': 0.7441825900969556, 'scale_pos_weight': 7.778285809900618}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.72188	train-auc:0.63748	train-aucpr:0.22560	val-logloss:0.72230	val-auc:0.64781	val-aucpr:0.12884
[10]	train-logloss:0.69724	train-auc:0.68185	train-aucpr:0.28354	val-logloss:0.66323	val-auc:0.69955	val-aucpr:0.21417
[20]	train-logloss:0.68095	train-auc:0.68704	train-aucpr:0.29793	val-logloss:0.62358	val-auc:0.71213	val-aucpr:0.22268
[30]	train-logloss:0.67008	train-auc:0.69185	train-aucpr:0.30392	val-logloss:0.59097	val-auc:0.70499	val-aucpr:0.22716
[40]	train-logloss:0.66228	train-auc:0.69574	train-aucpr:0.30856	val-logloss:0.56874	val-auc:0.69984	val-aucpr:0.22352
[50]	train-logloss:0.65637	train-auc:0.70074	train-aucpr:0.31156	val-logloss:0.55572	val-auc:0.70053	val-aucpr:0.22446
[60]	train-logloss:0.65181	train-auc:0.70377	train-aucpr:0.31602	val-logloss:0.54325	val-auc:0.70325	val-aucpr:0.22730
[70]	train-logloss:0.64795	train-auc:0.70787	train-aucpr:0.31975	val-logloss:0.54229	val-auc:0.70100	val-aucpr:0.22335
[80]	train-logloss:0.64441	train-auc:0.71228	train-aucpr:0.32389	val-logloss:0.53037	val-auc:0.69426	val-aucpr:0.21815
[88]	train-logloss:0.64231	train-auc:0.71480	train-aucpr:0.32676	val-logloss:0.51194	val-auc:0.69294	val-aucpr:0.21843
[2025-11-19 08:52:14,603] [INFO] [<frozen importlib] - Training completed at iteration 58
[2025-11-19 08:52:14,603] [INFO] [<frozen importlib] - Best train loss: 0.6526
[2025-11-19 08:52:14,603] [INFO] [<frozen importlib] - Best val loss: 0.5440
[2025-11-19 08:52:14,603] [INFO] [<frozen importlib] - Best val AUC: 0.7044
[2025-11-19 08:52:14,603] [INFO] [<frozen importlib] - Best val AUCPR: 0.2281
[2025-11-19 08:52:14,608] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:52:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:52:28,034] [INFO] [<frozen importlib] - Optimal threshold: 0.4982
[2025-11-19 08:52:28,034] [INFO] [<frozen importlib] - Best f1: 0.2728
[2025-11-19 08:52:28,034] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:52:28,080] [INFO] [<frozen importlib] - Validation Results (threshold=0.4982):
[2025-11-19 08:52:28,080] [INFO] [<frozen importlib] -   Accuracy: 0.8877
[2025-11-19 08:52:28,080] [INFO] [<frozen importlib] -   Precision: 0.2715
[2025-11-19 08:52:28,080] [INFO] [<frozen importlib] -   Recall: 0.2741
[2025-11-19 08:52:28,080] [INFO] [<frozen importlib] -   F1 Score: 0.2728
[2025-11-19 08:52:28,080] [INFO] [<frozen importlib] -   AUROC: 0.7044
[2025-11-19 08:52:28,080] [INFO] [<frozen importlib] -   AUPRC: 0.2284
[2025-11-19 08:52:28,080] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:52:28,080] [INFO] [<frozen importlib] -     TN=16377, FP=1068
[2025-11-19 08:52:28,080] [INFO] [<frozen importlib] -     FN=1054, TP=398
[2025-11-19 08:52:28,105] [INFO] [<frozen importlib] - Trial 196: AUPRC=0.2284, F1=0.4299, Prec=0.3925, Rec=0.4752 | Optimizing auprc=0.2284
                                                                                        Best trial: 140. Best value: 0.237476:  39%|███▉      | 196/500 [30:26<57:31, 11.35s/it]Best trial: 140. Best value: 0.237476:  39%|███▉      | 196/500 [30:26<57:31, 11.35s/it]Best trial: 140. Best value: 0.237476:  39%|███▉      | 197/500 [30:26<1:01:07, 12.11s/it][2025-11-19 08:52:28,116] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.8622028482153
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   gamma: 0.4884836497553385
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   alpha: 0.5265404212172229
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   lambda: 2.331278451399328
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   learning_rate: 0.039157318975736044
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   subsample: 0.7822975979430966
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   colsample_bytree: 0.5092186157194698
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5251929725078327
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   colsample_bynode: 0.7481318474326818
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:52:28,116] [INFO] [<frozen importlib] -   scale_pos_weight: 7.8622028482153
[2025-11-19 08:52:28,190] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:52:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:52:28,105] Trial 196 finished with value: 0.2284391011262112 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.4652389231190298, 'learning_rate': 0.03719628454434705, 'n_estimators': 400, 'alpha': 0.28165992210630064, 'lambda': 2.1473293654776326, 'subsample': 0.728196083598626, 'colsample_bytree': 0.5086590485812622, 'colsample_bylevel': 0.5425869544264309, 'colsample_bynode': 0.7521361218382983, 'scale_pos_weight': 7.4323135426911575}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.74433	train-auc:0.63236	train-aucpr:0.22249	val-logloss:0.74660	val-auc:0.64881	val-aucpr:0.13202
[10]	train-logloss:0.71718	train-auc:0.68121	train-aucpr:0.28863	val-logloss:0.69620	val-auc:0.68495	val-aucpr:0.19477
[20]	train-logloss:0.70031	train-auc:0.68897	train-aucpr:0.29729	val-logloss:0.65077	val-auc:0.70935	val-aucpr:0.21956
[30]	train-logloss:0.68938	train-auc:0.69280	train-aucpr:0.30251	val-logloss:0.62171	val-auc:0.70849	val-aucpr:0.22195
[40]	train-logloss:0.68097	train-auc:0.69831	train-aucpr:0.30735	val-logloss:0.60763	val-auc:0.70528	val-aucpr:0.22241
[50]	train-logloss:0.67454	train-auc:0.70244	train-aucpr:0.31065	val-logloss:0.59146	val-auc:0.70587	val-aucpr:0.22248
[60]	train-logloss:0.66986	train-auc:0.70588	train-aucpr:0.31468	val-logloss:0.57805	val-auc:0.70613	val-aucpr:0.22313
[70]	train-logloss:0.66564	train-auc:0.71116	train-aucpr:0.31932	val-logloss:0.57809	val-auc:0.70152	val-aucpr:0.21368
[2025-11-19 08:52:28,404] [INFO] [<frozen importlib] - Training completed at iteration 41
[2025-11-19 08:52:28,404] [INFO] [<frozen importlib] - Best train loss: 0.6803
[2025-11-19 08:52:28,404] [INFO] [<frozen importlib] - Best val loss: 0.6034
[2025-11-19 08:52:28,404] [INFO] [<frozen importlib] - Best val AUC: 0.7063
[2025-11-19 08:52:28,404] [INFO] [<frozen importlib] - Best val AUCPR: 0.2246
[2025-11-19 08:52:28,409] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:52:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:52:39,607] [INFO] [<frozen importlib] - Optimal threshold: 0.5446
[2025-11-19 08:52:39,607] [INFO] [<frozen importlib] - Best f1: 0.2650
[2025-11-19 08:52:39,607] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:52:39,652] [INFO] [<frozen importlib] - Validation Results (threshold=0.5446):
[2025-11-19 08:52:39,652] [INFO] [<frozen importlib] -   Accuracy: 0.8990
[2025-11-19 08:52:39,652] [INFO] [<frozen importlib] -   Precision: 0.3007
[2025-11-19 08:52:39,652] [INFO] [<frozen importlib] -   Recall: 0.2369
[2025-11-19 08:52:39,652] [INFO] [<frozen importlib] -   F1 Score: 0.2650
[2025-11-19 08:52:39,652] [INFO] [<frozen importlib] -   AUROC: 0.7063
[2025-11-19 08:52:39,652] [INFO] [<frozen importlib] -   AUPRC: 0.2249
[2025-11-19 08:52:39,652] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:52:39,652] [INFO] [<frozen importlib] -     TN=16645, FP=800
[2025-11-19 08:52:39,652] [INFO] [<frozen importlib] -     FN=1108, TP=344
[2025-11-19 08:52:39,675] [INFO] [<frozen importlib] - Trial 197: AUPRC=0.2249, F1=0.4469, Prec=0.4475, Rec=0.4463 | Optimizing auprc=0.2249
                                                                                          Best trial: 140. Best value: 0.237476:  39%|███▉      | 197/500 [30:37<1:01:07, 12.11s/it]Best trial: 140. Best value: 0.237476:  39%|███▉      | 197/500 [30:37<1:01:07, 12.11s/it]Best trial: 140. Best value: 0.237476:  40%|███▉      | 198/500 [30:37<1:00:07, 11.94s/it][2025-11-19 08:52:39,688] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.217962844190753
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   gamma: 0.2576677796139915
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   alpha: 0.4114494286427991
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   lambda: 2.8869876521766047
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   learning_rate: 0.03806151044786652
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   subsample: 0.8839127501403314
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   colsample_bytree: 0.5306354121409373
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5098106777361379
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   colsample_bynode: 0.7664110201687324
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:52:39,688] [INFO] [<frozen importlib] -   scale_pos_weight: 8.217962844190753
[2025-11-19 08:52:39,763] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:52:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:52:39,675] Trial 197 finished with value: 0.2248733454224756 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.4884836497553385, 'learning_rate': 0.039157318975736044, 'n_estimators': 400, 'alpha': 0.5265404212172229, 'lambda': 2.331278451399328, 'subsample': 0.7822975979430966, 'colsample_bytree': 0.5092186157194698, 'colsample_bylevel': 0.5251929725078327, 'colsample_bynode': 0.7481318474326818, 'scale_pos_weight': 7.8622028482153}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.76248	train-auc:0.63194	train-aucpr:0.22097	val-logloss:0.76687	val-auc:0.64519	val-aucpr:0.12186
[10]	train-logloss:0.73492	train-auc:0.68229	train-aucpr:0.28560	val-logloss:0.70430	val-auc:0.66691	val-aucpr:0.18128
[20]	train-logloss:0.71791	train-auc:0.68908	train-aucpr:0.29608	val-logloss:0.65777	val-auc:0.67455	val-aucpr:0.19490
[30]	train-logloss:0.70678	train-auc:0.69271	train-aucpr:0.30200	val-logloss:0.63198	val-auc:0.68148	val-aucpr:0.20584
[40]	train-logloss:0.69836	train-auc:0.69591	train-aucpr:0.30659	val-logloss:0.61145	val-auc:0.70354	val-aucpr:0.21050
[50]	train-logloss:0.69196	train-auc:0.70050	train-aucpr:0.31096	val-logloss:0.60181	val-auc:0.70689	val-aucpr:0.21460
[60]	train-logloss:0.68712	train-auc:0.70448	train-aucpr:0.31445	val-logloss:0.58898	val-auc:0.69819	val-aucpr:0.21123
[70]	train-logloss:0.68283	train-auc:0.70894	train-aucpr:0.31878	val-logloss:0.58836	val-auc:0.69694	val-aucpr:0.20925
[75]	train-logloss:0.68142	train-auc:0.71044	train-aucpr:0.32031	val-logloss:0.59123	val-auc:0.69697	val-aucpr:0.21084
[2025-11-19 08:52:39,984] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 08:52:39,984] [INFO] [<frozen importlib] - Best train loss: 0.6951
[2025-11-19 08:52:39,984] [INFO] [<frozen importlib] - Best val loss: 0.6061
[2025-11-19 08:52:39,984] [INFO] [<frozen importlib] - Best val AUC: 0.7078
[2025-11-19 08:52:39,984] [INFO] [<frozen importlib] - Best val AUCPR: 0.2195
[2025-11-19 08:52:39,989] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:52:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:52:48,926] [INFO] [<frozen importlib] - Optimal threshold: 0.5521
[2025-11-19 08:52:48,926] [INFO] [<frozen importlib] - Best f1: 0.2753
[2025-11-19 08:52:48,927] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:52:48,968] [INFO] [<frozen importlib] - Validation Results (threshold=0.5521):
[2025-11-19 08:52:48,968] [INFO] [<frozen importlib] -   Accuracy: 0.8997
[2025-11-19 08:52:48,968] [INFO] [<frozen importlib] -   Precision: 0.3095
[2025-11-19 08:52:48,968] [INFO] [<frozen importlib] -   Recall: 0.2479
[2025-11-19 08:52:48,968] [INFO] [<frozen importlib] -   F1 Score: 0.2753
[2025-11-19 08:52:48,968] [INFO] [<frozen importlib] -   AUROC: 0.7078
[2025-11-19 08:52:48,968] [INFO] [<frozen importlib] -   AUPRC: 0.2199
[2025-11-19 08:52:48,968] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:52:48,968] [INFO] [<frozen importlib] -     TN=16642, FP=803
[2025-11-19 08:52:48,968] [INFO] [<frozen importlib] -     FN=1092, TP=360
[2025-11-19 08:52:48,991] [INFO] [<frozen importlib] - Trial 198: AUPRC=0.2199, F1=0.4448, Prec=0.4454, Rec=0.4442 | Optimizing auprc=0.2199
[2025-11-19 08:52:48,991] [INFO] [<frozen importlib] - Trial 198 pruned.
[2025-11-19 08:52:48,991] [ERROR] [<frozen importlib] - Trial 198 failed with error: 
                                                                                          Best trial: 140. Best value: 0.237476:  40%|███▉      | 198/500 [30:46<1:00:07, 11.94s/it]Best trial: 140. Best value: 0.237476:  40%|███▉      | 198/500 [30:46<1:00:07, 11.94s/it]Best trial: 140. Best value: 0.237476:  40%|███▉      | 199/500 [30:46<55:57, 11.16s/it]  [2025-11-19 08:52:49,001] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.394455501916403
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   gamma: 0.4588698694260295
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   alpha: 0.9908484624162652
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   lambda: 2.4638764543322935
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   learning_rate: 0.04146398413469229
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   subsample: 0.744974691657118
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   colsample_bytree: 0.5444905631361832
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5446436850388282
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   colsample_bynode: 0.7411844744479726
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:52:49,001] [INFO] [<frozen importlib] -   scale_pos_weight: 7.394455501916403
[2025-11-19 08:52:49,078] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:52:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:52:48,991] Trial 198 pruned. 
[0]	train-logloss:0.71919	train-auc:0.64710	train-aucpr:0.23686	val-logloss:0.71688	val-auc:0.62813	val-aucpr:0.15053
[10]	train-logloss:0.69202	train-auc:0.68239	train-aucpr:0.29119	val-logloss:0.64745	val-auc:0.69753	val-aucpr:0.18590
[20]	train-logloss:0.67547	train-auc:0.68981	train-aucpr:0.29971	val-logloss:0.60627	val-auc:0.70381	val-aucpr:0.20034
[30]	train-logloss:0.66435	train-auc:0.69472	train-aucpr:0.30621	val-logloss:0.56456	val-auc:0.70797	val-aucpr:0.21358
[40]	train-logloss:0.65643	train-auc:0.69983	train-aucpr:0.31139	val-logloss:0.55383	val-auc:0.70572	val-aucpr:0.21637
[50]	train-logloss:0.65042	train-auc:0.70504	train-aucpr:0.31584	val-logloss:0.52813	val-auc:0.70791	val-aucpr:0.22321
[60]	train-logloss:0.64615	train-auc:0.70973	train-aucpr:0.31926	val-logloss:0.52452	val-auc:0.70788	val-aucpr:0.22804
[70]	train-logloss:0.64268	train-auc:0.71307	train-aucpr:0.32360	val-logloss:0.52332	val-auc:0.69981	val-aucpr:0.22023
[80]	train-logloss:0.63954	train-auc:0.71691	train-aucpr:0.32728	val-logloss:0.51666	val-auc:0.69722	val-aucpr:0.21593
[90]	train-logloss:0.63686	train-auc:0.72024	train-aucpr:0.33068	val-logloss:0.51008	val-auc:0.69603	val-aucpr:0.21159
[91]	train-logloss:0.63669	train-auc:0.72090	train-aucpr:0.33121	val-logloss:0.50518	val-auc:0.69172	val-aucpr:0.20793
[2025-11-19 08:52:49,341] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 08:52:49,341] [INFO] [<frozen importlib] - Best train loss: 0.6452
[2025-11-19 08:52:49,341] [INFO] [<frozen importlib] - Best val loss: 0.5195
[2025-11-19 08:52:49,341] [INFO] [<frozen importlib] - Best val AUC: 0.7074
[2025-11-19 08:52:49,341] [INFO] [<frozen importlib] - Best val AUCPR: 0.2290
[2025-11-19 08:52:49,345] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:52:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:53:02,503] [INFO] [<frozen importlib] - Optimal threshold: 0.5058
[2025-11-19 08:53:02,503] [INFO] [<frozen importlib] - Best f1: 0.2674
[2025-11-19 08:53:02,503] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:53:02,546] [INFO] [<frozen importlib] - Validation Results (threshold=0.5058):
[2025-11-19 08:53:02,546] [INFO] [<frozen importlib] -   Accuracy: 0.8950
[2025-11-19 08:53:02,546] [INFO] [<frozen importlib] -   Precision: 0.2882
[2025-11-19 08:53:02,546] [INFO] [<frozen importlib] -   Recall: 0.2493
[2025-11-19 08:53:02,546] [INFO] [<frozen importlib] -   F1 Score: 0.2674
[2025-11-19 08:53:02,546] [INFO] [<frozen importlib] -   AUROC: 0.7074
[2025-11-19 08:53:02,546] [INFO] [<frozen importlib] -   AUPRC: 0.2293
[2025-11-19 08:53:02,546] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:53:02,546] [INFO] [<frozen importlib] -     TN=16551, FP=894
[2025-11-19 08:53:02,546] [INFO] [<frozen importlib] -     FN=1090, TP=362
[2025-11-19 08:53:02,568] [INFO] [<frozen importlib] - Trial 199: AUPRC=0.2293, F1=0.4427, Prec=0.4273, Rec=0.4594 | Optimizing auprc=0.2293
                                                                                        Best trial: 140. Best value: 0.237476:  40%|███▉      | 199/500 [31:00<55:57, 11.16s/it]Best trial: 140. Best value: 0.237476:  40%|███▉      | 199/500 [31:00<55:57, 11.16s/it]Best trial: 140. Best value: 0.237476:  40%|████      | 200/500 [31:00<59:24, 11.88s/it][2025-11-19 08:53:02,578] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.692983294289062
[2025-11-19 08:53:02,578] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   gamma: 0.5033901663638869
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   alpha: 0.9454452926265353
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   lambda: 2.2340862135893724
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   learning_rate: 0.0341594968444613
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   subsample: 0.7239773906752073
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   colsample_bytree: 0.5230882726271324
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5232598778736299
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   colsample_bynode: 0.7606840616864062
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:53:02,579] [INFO] [<frozen importlib] -   scale_pos_weight: 7.692983294289062
[2025-11-19 08:53:02,652] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:53:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:53:02,568] Trial 199 finished with value: 0.22934017597061832 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.4588698694260295, 'learning_rate': 0.04146398413469229, 'n_estimators': 400, 'alpha': 0.9908484624162652, 'lambda': 2.4638764543322935, 'subsample': 0.744974691657118, 'colsample_bytree': 0.5444905631361832, 'colsample_bylevel': 0.5446436850388282, 'colsample_bynode': 0.7411844744479726, 'scale_pos_weight': 7.394455501916403}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.73601	train-auc:0.63275	train-aucpr:0.22445	val-logloss:0.73900	val-auc:0.64622	val-aucpr:0.12302
[10]	train-logloss:0.71149	train-auc:0.68020	train-aucpr:0.28782	val-logloss:0.68482	val-auc:0.65769	val-aucpr:0.16285
[20]	train-logloss:0.69571	train-auc:0.68792	train-aucpr:0.29568	val-logloss:0.63244	val-auc:0.68792	val-aucpr:0.20391
[30]	train-logloss:0.68491	train-auc:0.69067	train-aucpr:0.30138	val-logloss:0.59667	val-auc:0.70225	val-aucpr:0.21217
[40]	train-logloss:0.67650	train-auc:0.69427	train-aucpr:0.30780	val-logloss:0.57646	val-auc:0.70718	val-aucpr:0.21819
[50]	train-logloss:0.67007	train-auc:0.70009	train-aucpr:0.31086	val-logloss:0.56016	val-auc:0.70788	val-aucpr:0.21473
[60]	train-logloss:0.66554	train-auc:0.70265	train-aucpr:0.31341	val-logloss:0.55692	val-auc:0.71160	val-aucpr:0.21684
[70]	train-logloss:0.66117	train-auc:0.70685	train-aucpr:0.31794	val-logloss:0.55171	val-auc:0.71341	val-aucpr:0.22139
[80]	train-logloss:0.65759	train-auc:0.71106	train-aucpr:0.32231	val-logloss:0.54525	val-auc:0.70845	val-aucpr:0.22299
[90]	train-logloss:0.65481	train-auc:0.71414	train-aucpr:0.32574	val-logloss:0.53679	val-auc:0.70224	val-aucpr:0.21573
[100]	train-logloss:0.65239	train-auc:0.71625	train-aucpr:0.32926	val-logloss:0.52989	val-auc:0.70015	val-aucpr:0.21612
[109]	train-logloss:0.65002	train-auc:0.71980	train-aucpr:0.33207	val-logloss:0.51387	val-auc:0.70303	val-aucpr:0.21264
[2025-11-19 08:53:02,957] [INFO] [<frozen importlib] - Training completed at iteration 79
[2025-11-19 08:53:02,957] [INFO] [<frozen importlib] - Best train loss: 0.6579
[2025-11-19 08:53:02,957] [INFO] [<frozen importlib] - Best val loss: 0.5447
[2025-11-19 08:53:02,957] [INFO] [<frozen importlib] - Best val AUC: 0.7104
[2025-11-19 08:53:02,957] [INFO] [<frozen importlib] - Best val AUCPR: 0.2241
[2025-11-19 08:53:02,962] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:53:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:53:17,183] [INFO] [<frozen importlib] - Optimal threshold: 0.5295
[2025-11-19 08:53:17,183] [INFO] [<frozen importlib] - Best f1: 0.2680
[2025-11-19 08:53:17,183] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:53:17,227] [INFO] [<frozen importlib] - Validation Results (threshold=0.5295):
[2025-11-19 08:53:17,227] [INFO] [<frozen importlib] -   Accuracy: 0.9098
[2025-11-19 08:53:17,227] [INFO] [<frozen importlib] -   Precision: 0.3562
[2025-11-19 08:53:17,227] [INFO] [<frozen importlib] -   Recall: 0.2149
[2025-11-19 08:53:17,227] [INFO] [<frozen importlib] -   F1 Score: 0.2680
[2025-11-19 08:53:17,227] [INFO] [<frozen importlib] -   AUROC: 0.7104
[2025-11-19 08:53:17,227] [INFO] [<frozen importlib] -   AUPRC: 0.2245
[2025-11-19 08:53:17,227] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:53:17,227] [INFO] [<frozen importlib] -     TN=16881, FP=564
[2025-11-19 08:53:17,227] [INFO] [<frozen importlib] -     FN=1140, TP=312
[2025-11-19 08:53:17,251] [INFO] [<frozen importlib] - Trial 200: AUPRC=0.2245, F1=0.4727, Prec=0.5253, Rec=0.4298 | Optimizing auprc=0.2245
                                                                                        Best trial: 140. Best value: 0.237476:  40%|████      | 200/500 [31:15<59:24, 11.88s/it]Best trial: 140. Best value: 0.237476:  40%|████      | 200/500 [31:15<59:24, 11.88s/it]Best trial: 140. Best value: 0.237476:  40%|████      | 201/500 [31:15<1:03:24, 12.72s/it][2025-11-19 08:53:17,261] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 18.873507248975997
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   gamma: 0.5224106559596164
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   alpha: 1.1321329696931728
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   lambda: 2.051942748245118
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   learning_rate: 0.04406917454339496
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   subsample: 0.7638854674691083
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   colsample_bytree: 0.5847586285280476
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5578996793069013
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   colsample_bynode: 0.7337050641752537
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:53:17,261] [INFO] [<frozen importlib] -   scale_pos_weight: 18.873507248975997
[2025-11-19 08:53:17,328] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:53:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:53:17,251] Trial 200 finished with value: 0.22452474105595716 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.5033901663638869, 'learning_rate': 0.0341594968444613, 'n_estimators': 450, 'alpha': 0.9454452926265353, 'lambda': 2.2340862135893724, 'subsample': 0.7239773906752073, 'colsample_bytree': 0.5230882726271324, 'colsample_bylevel': 0.5232598778736299, 'colsample_bynode': 0.7606840616864062, 'scale_pos_weight': 7.692983294289062}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:1.14149	train-auc:0.64034	train-aucpr:0.21571	val-logloss:1.17631	val-auc:0.58351	val-aucpr:0.11282
[10]	train-logloss:1.10316	train-auc:0.68117	train-aucpr:0.28174	val-logloss:1.06083	val-auc:0.66551	val-aucpr:0.19453
[20]	train-logloss:1.08557	train-auc:0.68987	train-aucpr:0.29324	val-logloss:0.99950	val-auc:0.69335	val-aucpr:0.20550
[30]	train-logloss:1.07387	train-auc:0.69491	train-aucpr:0.29858	val-logloss:0.94844	val-auc:0.69478	val-aucpr:0.21440
[40]	train-logloss:1.06502	train-auc:0.70161	train-aucpr:0.30336	val-logloss:0.91927	val-auc:0.68904	val-aucpr:0.21452
[50]	train-logloss:1.05677	train-auc:0.70581	train-aucpr:0.30976	val-logloss:0.86395	val-auc:0.69233	val-aucpr:0.20844
[60]	train-logloss:1.05000	train-auc:0.71140	train-aucpr:0.31662	val-logloss:0.85674	val-auc:0.69517	val-aucpr:0.21243
[63]	train-logloss:1.04791	train-auc:0.71364	train-aucpr:0.31824	val-logloss:0.85183	val-auc:0.69340	val-aucpr:0.21024
[2025-11-19 08:53:17,523] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:53:17,523] [INFO] [<frozen importlib] - Best train loss: 1.0702
[2025-11-19 08:53:17,523] [INFO] [<frozen importlib] - Best val loss: 0.9359
[2025-11-19 08:53:17,523] [INFO] [<frozen importlib] - Best val AUC: 0.6978
[2025-11-19 08:53:17,523] [INFO] [<frozen importlib] - Best val AUCPR: 0.2173
[2025-11-19 08:53:17,527] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:53:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:53:25,970] [INFO] [<frozen importlib] - Optimal threshold: 0.7240
[2025-11-19 08:53:25,970] [INFO] [<frozen importlib] - Best f1: 0.2637
[2025-11-19 08:53:25,970] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:53:26,015] [INFO] [<frozen importlib] - Validation Results (threshold=0.7240):
[2025-11-19 08:53:26,015] [INFO] [<frozen importlib] -   Accuracy: 0.8998
[2025-11-19 08:53:26,015] [INFO] [<frozen importlib] -   Precision: 0.3029
[2025-11-19 08:53:26,015] [INFO] [<frozen importlib] -   Recall: 0.2335
[2025-11-19 08:53:26,015] [INFO] [<frozen importlib] -   F1 Score: 0.2637
[2025-11-19 08:53:26,015] [INFO] [<frozen importlib] -   AUROC: 0.6978
[2025-11-19 08:53:26,015] [INFO] [<frozen importlib] -   AUPRC: 0.2176
[2025-11-19 08:53:26,015] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:53:26,015] [INFO] [<frozen importlib] -     TN=16665, FP=780
[2025-11-19 08:53:26,015] [INFO] [<frozen importlib] -     FN=1113, TP=339
[2025-11-19 08:53:26,037] [INFO] [<frozen importlib] - Trial 201: AUPRC=0.2176, F1=0.4370, Prec=0.4444, Rec=0.4298 | Optimizing auprc=0.2176
[2025-11-19 08:53:26,037] [INFO] [<frozen importlib] - Trial 201 pruned.
[2025-11-19 08:53:26,037] [ERROR] [<frozen importlib] - Trial 201 failed with error: 
                                                                                          Best trial: 140. Best value: 0.237476:  40%|████      | 201/500 [31:24<1:03:24, 12.72s/it]Best trial: 140. Best value: 0.237476:  40%|████      | 201/500 [31:24<1:03:24, 12.72s/it]Best trial: 140. Best value: 0.237476:  40%|████      | 202/500 [31:24<57:19, 11.54s/it]  [2025-11-19 08:53:26,047] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.038014851849419
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   gamma: 0.30157196570587136
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   alpha: 1.0326525927815573
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   lambda: 1.862357926718571
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   learning_rate: 0.04210591527813569
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   subsample: 0.7125595509379109
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   colsample_bytree: 0.509399991739852
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5506896968525101
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   colsample_bynode: 0.7455892815059091
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:53:26,048] [INFO] [<frozen importlib] -   scale_pos_weight: 7.038014851849419
[2025-11-19 08:53:26,121] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:53:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:53:26,037] Trial 201 pruned. 
[0]	train-logloss:0.70058	train-auc:0.63732	train-aucpr:0.22465	val-logloss:0.69813	val-auc:0.64764	val-aucpr:0.12766
[10]	train-logloss:0.67493	train-auc:0.68031	train-aucpr:0.28045	val-logloss:0.63638	val-auc:0.69396	val-aucpr:0.21385
[20]	train-logloss:0.65853	train-auc:0.68770	train-aucpr:0.29812	val-logloss:0.59549	val-auc:0.70555	val-aucpr:0.21811
[30]	train-logloss:0.64800	train-auc:0.69275	train-aucpr:0.30444	val-logloss:0.55880	val-auc:0.69355	val-aucpr:0.22109
[40]	train-logloss:0.64054	train-auc:0.69815	train-aucpr:0.30974	val-logloss:0.53028	val-auc:0.69366	val-aucpr:0.22007
[50]	train-logloss:0.63466	train-auc:0.70331	train-aucpr:0.31440	val-logloss:0.51953	val-auc:0.69998	val-aucpr:0.22428
[60]	train-logloss:0.63031	train-auc:0.70716	train-aucpr:0.31910	val-logloss:0.50524	val-auc:0.70334	val-aucpr:0.22633
[70]	train-logloss:0.62679	train-auc:0.71108	train-aucpr:0.32240	val-logloss:0.49245	val-auc:0.70576	val-aucpr:0.22300
[80]	train-logloss:0.62347	train-auc:0.71495	train-aucpr:0.32707	val-logloss:0.48957	val-auc:0.70420	val-aucpr:0.21467
[90]	train-logloss:0.62069	train-auc:0.71896	train-aucpr:0.33043	val-logloss:0.48829	val-auc:0.70199	val-aucpr:0.21223
[92]	train-logloss:0.62013	train-auc:0.72008	train-aucpr:0.33112	val-logloss:0.48636	val-auc:0.70114	val-aucpr:0.21094
[2025-11-19 08:53:26,382] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 08:53:26,382] [INFO] [<frozen importlib] - Best train loss: 0.6296
[2025-11-19 08:53:26,382] [INFO] [<frozen importlib] - Best val loss: 0.4984
[2025-11-19 08:53:26,382] [INFO] [<frozen importlib] - Best val AUC: 0.7101
[2025-11-19 08:53:26,382] [INFO] [<frozen importlib] - Best val AUCPR: 0.2288
[2025-11-19 08:53:26,387] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:53:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:53:40,304] [INFO] [<frozen importlib] - Optimal threshold: 0.4841
[2025-11-19 08:53:40,304] [INFO] [<frozen importlib] - Best f1: 0.2649
[2025-11-19 08:53:40,304] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:53:40,358] [INFO] [<frozen importlib] - Validation Results (threshold=0.4841):
[2025-11-19 08:53:40,358] [INFO] [<frozen importlib] -   Accuracy: 0.8931
[2025-11-19 08:53:40,358] [INFO] [<frozen importlib] -   Precision: 0.2809
[2025-11-19 08:53:40,358] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 08:53:40,358] [INFO] [<frozen importlib] -   F1 Score: 0.2649
[2025-11-19 08:53:40,358] [INFO] [<frozen importlib] -   AUROC: 0.7101
[2025-11-19 08:53:40,358] [INFO] [<frozen importlib] -   AUPRC: 0.2292
[2025-11-19 08:53:40,358] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:53:40,358] [INFO] [<frozen importlib] -     TN=16513, FP=932
[2025-11-19 08:53:40,358] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 08:53:40,381] [INFO] [<frozen importlib] - Trial 202: AUPRC=0.2292, F1=0.4454, Prec=0.4229, Rec=0.4704 | Optimizing auprc=0.2292
                                                                                        Best trial: 140. Best value: 0.237476:  40%|████      | 202/500 [31:38<57:19, 11.54s/it]Best trial: 140. Best value: 0.237476:  40%|████      | 202/500 [31:38<57:19, 11.54s/it]Best trial: 140. Best value: 0.237476:  41%|████      | 203/500 [31:38<1:01:17, 12.38s/it][2025-11-19 08:53:40,391] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.270641997366896
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   gamma: 0.5631019740691998
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   alpha: 1.0843465456784886
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   lambda: 1.6860900593977404
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   learning_rate: 0.04012068919102296
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   subsample: 0.7343028712341296
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   colsample_bytree: 0.5547188372208386
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5352016885960765
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   colsample_bynode: 0.7746342820370663
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:53:40,391] [INFO] [<frozen importlib] -   scale_pos_weight: 7.270641997366896
[2025-11-19 08:53:40,471] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:53:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:53:40,381] Trial 202 finished with value: 0.22915549379485026 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.30157196570587136, 'learning_rate': 0.04210591527813569, 'n_estimators': 400, 'alpha': 1.0326525927815573, 'lambda': 1.862357926718571, 'subsample': 0.7125595509379109, 'colsample_bytree': 0.509399991739852, 'colsample_bylevel': 0.5506896968525101, 'colsample_bynode': 0.7455892815059091, 'scale_pos_weight': 7.038014851849419}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.71309	train-auc:0.63995	train-aucpr:0.22674	val-logloss:0.71139	val-auc:0.62172	val-aucpr:0.12518
[10]	train-logloss:0.68664	train-auc:0.67932	train-aucpr:0.28370	val-logloss:0.65057	val-auc:0.68936	val-aucpr:0.19873
[20]	train-logloss:0.67045	train-auc:0.68764	train-aucpr:0.29743	val-logloss:0.60396	val-auc:0.70145	val-aucpr:0.20499
[30]	train-logloss:0.65961	train-auc:0.69482	train-aucpr:0.30477	val-logloss:0.57474	val-auc:0.69981	val-aucpr:0.22089
[40]	train-logloss:0.65209	train-auc:0.69905	train-aucpr:0.31133	val-logloss:0.56666	val-auc:0.69771	val-aucpr:0.21589
[50]	train-logloss:0.64609	train-auc:0.70373	train-aucpr:0.31517	val-logloss:0.54408	val-auc:0.69627	val-aucpr:0.21669
[60]	train-logloss:0.64158	train-auc:0.70757	train-aucpr:0.31854	val-logloss:0.53435	val-auc:0.69503	val-aucpr:0.22091
[63]	train-logloss:0.64031	train-auc:0.70883	train-aucpr:0.31966	val-logloss:0.52805	val-auc:0.69368	val-aucpr:0.21986
[2025-11-19 08:53:40,670] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:53:40,670] [INFO] [<frozen importlib] - Best train loss: 0.6563
[2025-11-19 08:53:40,670] [INFO] [<frozen importlib] - Best val loss: 0.5688
[2025-11-19 08:53:40,670] [INFO] [<frozen importlib] - Best val AUC: 0.6976
[2025-11-19 08:53:40,670] [INFO] [<frozen importlib] - Best val AUCPR: 0.2219
[2025-11-19 08:53:40,675] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:53:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:53:49,273] [INFO] [<frozen importlib] - Optimal threshold: 0.5060
[2025-11-19 08:53:49,273] [INFO] [<frozen importlib] - Best f1: 0.2686
[2025-11-19 08:53:49,273] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:53:49,317] [INFO] [<frozen importlib] - Validation Results (threshold=0.5060):
[2025-11-19 08:53:49,317] [INFO] [<frozen importlib] -   Accuracy: 0.8896
[2025-11-19 08:53:49,317] [INFO] [<frozen importlib] -   Precision: 0.2736
[2025-11-19 08:53:49,317] [INFO] [<frozen importlib] -   Recall: 0.2638
[2025-11-19 08:53:49,317] [INFO] [<frozen importlib] -   F1 Score: 0.2686
[2025-11-19 08:53:49,317] [INFO] [<frozen importlib] -   AUROC: 0.6976
[2025-11-19 08:53:49,317] [INFO] [<frozen importlib] -   AUPRC: 0.2223
[2025-11-19 08:53:49,317] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:53:49,317] [INFO] [<frozen importlib] -     TN=16428, FP=1017
[2025-11-19 08:53:49,317] [INFO] [<frozen importlib] -     FN=1069, TP=383
[2025-11-19 08:53:49,341] [INFO] [<frozen importlib] - Trial 203: AUPRC=0.2223, F1=0.4344, Prec=0.4025, Rec=0.4718 | Optimizing auprc=0.2223
[2025-11-19 08:53:49,341] [INFO] [<frozen importlib] - Trial 203 pruned.
[2025-11-19 08:53:49,341] [ERROR] [<frozen importlib] - Trial 203 failed with error: 
                                                                                          Best trial: 140. Best value: 0.237476:  41%|████      | 203/500 [31:47<1:01:17, 12.38s/it]Best trial: 140. Best value: 0.237476:  41%|████      | 203/500 [31:47<1:01:17, 12.38s/it]Best trial: 140. Best value: 0.237476:  41%|████      | 204/500 [31:47<56:01, 11.36s/it]  [2025-11-19 08:53:49,352] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.388272652637075
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   gamma: 0.4182484341012522
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   alpha: 1.0803138198416082
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   lambda: 2.440878638506159
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   learning_rate: 0.036363466047879836
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   subsample: 0.7791615321397749
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   colsample_bytree: 0.5350015221473567
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5613688853762661
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   colsample_bynode: 0.7022343790171683
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:53:49,352] [INFO] [<frozen importlib] -   scale_pos_weight: 5.388272652637075
[2025-11-19 08:53:49,427] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:53:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:53:49,341] Trial 203 pruned. 
[0]	train-logloss:0.60964	train-auc:0.64068	train-aucpr:0.22069	val-logloss:0.59445	val-auc:0.68948	val-aucpr:0.16036
[10]	train-logloss:0.58973	train-auc:0.67993	train-aucpr:0.28926	val-logloss:0.54994	val-auc:0.70445	val-aucpr:0.21401
[20]	train-logloss:0.57668	train-auc:0.68659	train-aucpr:0.29912	val-logloss:0.52539	val-auc:0.70945	val-aucpr:0.22629
[30]	train-logloss:0.56819	train-auc:0.68952	train-aucpr:0.30224	val-logloss:0.49716	val-auc:0.70824	val-aucpr:0.22625
[40]	train-logloss:0.56141	train-auc:0.69509	train-aucpr:0.30830	val-logloss:0.47953	val-auc:0.70118	val-aucpr:0.22450
[50]	train-logloss:0.55625	train-auc:0.70024	train-aucpr:0.31371	val-logloss:0.47362	val-auc:0.70399	val-aucpr:0.22956
[60]	train-logloss:0.55233	train-auc:0.70430	train-aucpr:0.31768	val-logloss:0.46294	val-auc:0.70575	val-aucpr:0.23285
[70]	train-logloss:0.54945	train-auc:0.70783	train-aucpr:0.32103	val-logloss:0.46415	val-auc:0.70523	val-aucpr:0.23001
[80]	train-logloss:0.54649	train-auc:0.71154	train-aucpr:0.32517	val-logloss:0.45476	val-auc:0.70365	val-aucpr:0.22899
[90]	train-logloss:0.54427	train-auc:0.71497	train-aucpr:0.32828	val-logloss:0.45539	val-auc:0.70097	val-aucpr:0.22580
[2025-11-19 08:53:49,689] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:53:49,689] [INFO] [<frozen importlib] - Best train loss: 0.5523
[2025-11-19 08:53:49,689] [INFO] [<frozen importlib] - Best val loss: 0.4629
[2025-11-19 08:53:49,689] [INFO] [<frozen importlib] - Best val AUC: 0.7058
[2025-11-19 08:53:49,689] [INFO] [<frozen importlib] - Best val AUCPR: 0.2329
[2025-11-19 08:53:49,695] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:53:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:54:02,318] [INFO] [<frozen importlib] - Optimal threshold: 0.4558
[2025-11-19 08:54:02,318] [INFO] [<frozen importlib] - Best f1: 0.2737
[2025-11-19 08:54:02,318] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:54:02,364] [INFO] [<frozen importlib] - Validation Results (threshold=0.4558):
[2025-11-19 08:54:02,364] [INFO] [<frozen importlib] -   Accuracy: 0.9065
[2025-11-19 08:54:02,364] [INFO] [<frozen importlib] -   Precision: 0.3394
[2025-11-19 08:54:02,364] [INFO] [<frozen importlib] -   Recall: 0.2293
[2025-11-19 08:54:02,364] [INFO] [<frozen importlib] -   F1 Score: 0.2737
[2025-11-19 08:54:02,364] [INFO] [<frozen importlib] -   AUROC: 0.7058
[2025-11-19 08:54:02,364] [INFO] [<frozen importlib] -   AUPRC: 0.2332
[2025-11-19 08:54:02,364] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:54:02,364] [INFO] [<frozen importlib] -     TN=16797, FP=648
[2025-11-19 08:54:02,364] [INFO] [<frozen importlib] -     FN=1119, TP=333
[2025-11-19 08:54:02,389] [INFO] [<frozen importlib] - Trial 204: AUPRC=0.2332, F1=0.4683, Prec=0.4977, Rec=0.4421 | Optimizing auprc=0.2332
                                                                                        Best trial: 140. Best value: 0.237476:  41%|████      | 204/500 [32:00<56:01, 11.36s/it]Best trial: 140. Best value: 0.237476:  41%|████      | 204/500 [32:00<56:01, 11.36s/it]Best trial: 140. Best value: 0.237476:  41%|████      | 205/500 [32:00<58:19, 11.86s/it][2025-11-19 08:54:02,400] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.294382170034073
[2025-11-19 08:54:02,400] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:54:02,400] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:54:02,400] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:54:02,400] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:54:02,400] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:54:02,400] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   gamma: 0.4148168397448551
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   alpha: 1.0805249125058336
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   lambda: 2.3532583432859173
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   learning_rate: 0.035409490192169685
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   subsample: 0.788102450489312
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   colsample_bytree: 0.5351047942298605
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5689683435028946
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   colsample_bynode: 0.7083715718185408
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:54:02,401] [INFO] [<frozen importlib] -   scale_pos_weight: 5.294382170034073
[2025-11-19 08:54:02,474] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:54:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:54:02,389] Trial 204 finished with value: 0.23318553492231 and parameters: {'max_depth': 4, 'min_child_weight': 4, 'gamma': 0.4182484341012522, 'learning_rate': 0.036363466047879836, 'n_estimators': 350, 'alpha': 1.0803138198416082, 'lambda': 2.440878638506159, 'subsample': 0.7791615321397749, 'colsample_bytree': 0.5350015221473567, 'colsample_bylevel': 0.5613688853762661, 'colsample_bynode': 0.7022343790171683, 'scale_pos_weight': 5.388272652637075}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.60426	train-auc:0.63640	train-aucpr:0.22951	val-logloss:0.58895	val-auc:0.63175	val-aucpr:0.13932
[10]	train-logloss:0.58474	train-auc:0.68123	train-aucpr:0.29350	val-logloss:0.54526	val-auc:0.69282	val-aucpr:0.20824
[20]	train-logloss:0.57183	train-auc:0.68831	train-aucpr:0.30220	val-logloss:0.51718	val-auc:0.69763	val-aucpr:0.21648
[30]	train-logloss:0.56351	train-auc:0.69043	train-aucpr:0.30604	val-logloss:0.49446	val-auc:0.69210	val-aucpr:0.21508
[40]	train-logloss:0.55688	train-auc:0.69616	train-aucpr:0.31095	val-logloss:0.48018	val-auc:0.70251	val-aucpr:0.21457
[50]	train-logloss:0.55192	train-auc:0.70091	train-aucpr:0.31350	val-logloss:0.46845	val-auc:0.69557	val-aucpr:0.21333
[58]	train-logloss:0.54899	train-auc:0.70320	train-aucpr:0.31637	val-logloss:0.46067	val-auc:0.69872	val-aucpr:0.21492
[2025-11-19 08:54:02,658] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:54:02,658] [INFO] [<frozen importlib] - Best train loss: 0.5643
[2025-11-19 08:54:02,658] [INFO] [<frozen importlib] - Best val loss: 0.4960
[2025-11-19 08:54:02,658] [INFO] [<frozen importlib] - Best val AUC: 0.6935
[2025-11-19 08:54:02,658] [INFO] [<frozen importlib] - Best val AUCPR: 0.2172
[2025-11-19 08:54:02,663] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:54:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:54:08,443] [INFO] [<frozen importlib] - Optimal threshold: 0.4241
[2025-11-19 08:54:08,443] [INFO] [<frozen importlib] - Best f1: 0.2745
[2025-11-19 08:54:08,443] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:54:08,486] [INFO] [<frozen importlib] - Validation Results (threshold=0.4241):
[2025-11-19 08:54:08,486] [INFO] [<frozen importlib] -   Accuracy: 0.8764
[2025-11-19 08:54:08,486] [INFO] [<frozen importlib] -   Precision: 0.2500
[2025-11-19 08:54:08,486] [INFO] [<frozen importlib] -   Recall: 0.3044
[2025-11-19 08:54:08,486] [INFO] [<frozen importlib] -   F1 Score: 0.2745
[2025-11-19 08:54:08,486] [INFO] [<frozen importlib] -   AUROC: 0.6935
[2025-11-19 08:54:08,486] [INFO] [<frozen importlib] -   AUPRC: 0.2174
[2025-11-19 08:54:08,486] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:54:08,486] [INFO] [<frozen importlib] -     TN=16119, FP=1326
[2025-11-19 08:54:08,486] [INFO] [<frozen importlib] -     FN=1010, TP=442
[2025-11-19 08:54:08,508] [INFO] [<frozen importlib] - Trial 205: AUPRC=0.2174, F1=0.4247, Prec=0.3610, Rec=0.5158 | Optimizing auprc=0.2174
[2025-11-19 08:54:08,508] [INFO] [<frozen importlib] - Trial 205 pruned.
[2025-11-19 08:54:08,508] [ERROR] [<frozen importlib] - Trial 205 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  41%|████      | 205/500 [32:06<58:19, 11.86s/it]Best trial: 140. Best value: 0.237476:  41%|████      | 205/500 [32:06<58:19, 11.86s/it]Best trial: 140. Best value: 0.237476:  41%|████      | 206/500 [32:06<49:41, 10.14s/it][2025-11-19 08:54:08,523] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.467568998538025
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   gamma: 0.42903024085724084
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   alpha: 1.0089790027241947
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   lambda: 2.5531483272820035
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   learning_rate: 0.03735013019176397
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   subsample: 0.7763972650978912
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   colsample_bytree: 0.5269256145478134
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5002835944909398
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   colsample_bynode: 0.7046939080974729
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:54:08,523] [INFO] [<frozen importlib] -   scale_pos_weight: 5.467568998538025
[2025-11-19 08:54:08,596] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:54:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:54:08,508] Trial 205 pruned. 
[0]	train-logloss:0.61417	train-auc:0.63271	train-aucpr:0.21895	val-logloss:0.60131	val-auc:0.63668	val-aucpr:0.14852
[10]	train-logloss:0.59415	train-auc:0.68226	train-aucpr:0.28579	val-logloss:0.56020	val-auc:0.70616	val-aucpr:0.21344
[20]	train-logloss:0.58120	train-auc:0.68565	train-aucpr:0.29530	val-logloss:0.52581	val-auc:0.71277	val-aucpr:0.21974
[30]	train-logloss:0.57256	train-auc:0.69039	train-aucpr:0.30055	val-logloss:0.49862	val-auc:0.69929	val-aucpr:0.22036
[40]	train-logloss:0.56583	train-auc:0.69497	train-aucpr:0.30668	val-logloss:0.48338	val-auc:0.70473	val-aucpr:0.22013
[50]	train-logloss:0.56095	train-auc:0.69956	train-aucpr:0.31143	val-logloss:0.47043	val-auc:0.70210	val-aucpr:0.22266
[60]	train-logloss:0.55670	train-auc:0.70425	train-aucpr:0.31588	val-logloss:0.46761	val-auc:0.70670	val-aucpr:0.22200
[70]	train-logloss:0.55344	train-auc:0.70744	train-aucpr:0.32017	val-logloss:0.46634	val-auc:0.70783	val-aucpr:0.21912
[75]	train-logloss:0.55248	train-auc:0.70892	train-aucpr:0.32194	val-logloss:0.47057	val-auc:0.70492	val-aucpr:0.21685
[2025-11-19 08:54:08,816] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 08:54:08,816] [INFO] [<frozen importlib] - Best train loss: 0.5633
[2025-11-19 08:54:08,816] [INFO] [<frozen importlib] - Best val loss: 0.4747
[2025-11-19 08:54:08,816] [INFO] [<frozen importlib] - Best val AUC: 0.7073
[2025-11-19 08:54:08,816] [INFO] [<frozen importlib] - Best val AUCPR: 0.2243
[2025-11-19 08:54:08,820] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:54:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:54:21,136] [INFO] [<frozen importlib] - Optimal threshold: 0.4440
[2025-11-19 08:54:21,136] [INFO] [<frozen importlib] - Best f1: 0.2828
[2025-11-19 08:54:21,136] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:54:21,183] [INFO] [<frozen importlib] - Validation Results (threshold=0.4440):
[2025-11-19 08:54:21,183] [INFO] [<frozen importlib] -   Accuracy: 0.9031
[2025-11-19 08:54:21,183] [INFO] [<frozen importlib] -   Precision: 0.3279
[2025-11-19 08:54:21,183] [INFO] [<frozen importlib] -   Recall: 0.2486
[2025-11-19 08:54:21,183] [INFO] [<frozen importlib] -   F1 Score: 0.2828
[2025-11-19 08:54:21,183] [INFO] [<frozen importlib] -   AUROC: 0.7073
[2025-11-19 08:54:21,183] [INFO] [<frozen importlib] -   AUPRC: 0.2248
[2025-11-19 08:54:21,183] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:54:21,183] [INFO] [<frozen importlib] -     TN=16705, FP=740
[2025-11-19 08:54:21,183] [INFO] [<frozen importlib] -     FN=1091, TP=361
[2025-11-19 08:54:21,206] [INFO] [<frozen importlib] - Trial 206: AUPRC=0.2248, F1=0.4404, Prec=0.4555, Rec=0.4263 | Optimizing auprc=0.2248
[2025-11-19 08:54:21,206] [INFO] [<frozen importlib] - Trial 206 pruned.
[2025-11-19 08:54:21,206] [ERROR] [<frozen importlib] - Trial 206 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  41%|████      | 206/500 [32:19<49:41, 10.14s/it]Best trial: 140. Best value: 0.237476:  41%|████      | 206/500 [32:19<49:41, 10.14s/it]Best trial: 140. Best value: 0.237476:  41%|████▏     | 207/500 [32:19<53:15, 10.91s/it][2025-11-19 08:54:21,216] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.7361486984801
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   gamma: 0.4810343565172449
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   alpha: 0.6544104842958701
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   lambda: 2.682417485863696
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   learning_rate: 0.03597652065478734
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   subsample: 0.799734660949964
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   colsample_bytree: 0.545369225315038
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5300174175463951
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   colsample_bynode: 0.7575328874736041
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:54:21,216] [INFO] [<frozen importlib] -   scale_pos_weight: 5.7361486984801
[2025-11-19 08:54:21,290] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:54:21] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:54:21,206] Trial 206 pruned. 
[0]	train-logloss:0.62903	train-auc:0.64743	train-aucpr:0.23712	val-logloss:0.61598	val-auc:0.62834	val-aucpr:0.14899
[10]	train-logloss:0.60815	train-auc:0.68030	train-aucpr:0.29130	val-logloss:0.56575	val-auc:0.67655	val-aucpr:0.19775
[20]	train-logloss:0.59509	train-auc:0.68540	train-aucpr:0.29965	val-logloss:0.53320	val-auc:0.70768	val-aucpr:0.21286
[30]	train-logloss:0.58613	train-auc:0.69185	train-aucpr:0.30501	val-logloss:0.50493	val-auc:0.70345	val-aucpr:0.21593
[40]	train-logloss:0.57955	train-auc:0.69577	train-aucpr:0.30970	val-logloss:0.49337	val-auc:0.70403	val-aucpr:0.21890
[50]	train-logloss:0.57396	train-auc:0.70087	train-aucpr:0.31409	val-logloss:0.48161	val-auc:0.71121	val-aucpr:0.22626
[60]	train-logloss:0.57020	train-auc:0.70449	train-aucpr:0.31682	val-logloss:0.47676	val-auc:0.71002	val-aucpr:0.22914
[70]	train-logloss:0.56693	train-auc:0.70788	train-aucpr:0.32017	val-logloss:0.47012	val-auc:0.69947	val-aucpr:0.22043
[80]	train-logloss:0.56436	train-auc:0.71002	train-aucpr:0.32366	val-logloss:0.46616	val-auc:0.69655	val-aucpr:0.21575
[90]	train-logloss:0.56207	train-auc:0.71280	train-aucpr:0.32659	val-logloss:0.45801	val-auc:0.69862	val-aucpr:0.21224
[2025-11-19 08:54:21,550] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:54:21,550] [INFO] [<frozen importlib] - Best train loss: 0.5702
[2025-11-19 08:54:21,550] [INFO] [<frozen importlib] - Best val loss: 0.4768
[2025-11-19 08:54:21,550] [INFO] [<frozen importlib] - Best val AUC: 0.7100
[2025-11-19 08:54:21,550] [INFO] [<frozen importlib] - Best val AUCPR: 0.2291
[2025-11-19 08:54:21,555] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:54:21] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:54:34,436] [INFO] [<frozen importlib] - Optimal threshold: 0.4509
[2025-11-19 08:54:34,437] [INFO] [<frozen importlib] - Best f1: 0.2806
[2025-11-19 08:54:34,437] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:54:34,481] [INFO] [<frozen importlib] - Validation Results (threshold=0.4509):
[2025-11-19 08:54:34,481] [INFO] [<frozen importlib] -   Accuracy: 0.9050
[2025-11-19 08:54:34,481] [INFO] [<frozen importlib] -   Precision: 0.3356
[2025-11-19 08:54:34,481] [INFO] [<frozen importlib] -   Recall: 0.2410
[2025-11-19 08:54:34,481] [INFO] [<frozen importlib] -   F1 Score: 0.2806
[2025-11-19 08:54:34,481] [INFO] [<frozen importlib] -   AUROC: 0.7100
[2025-11-19 08:54:34,481] [INFO] [<frozen importlib] -   AUPRC: 0.2295
[2025-11-19 08:54:34,481] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:54:34,481] [INFO] [<frozen importlib] -     TN=16752, FP=693
[2025-11-19 08:54:34,481] [INFO] [<frozen importlib] -     FN=1102, TP=350
[2025-11-19 08:54:34,504] [INFO] [<frozen importlib] - Trial 207: AUPRC=0.2295, F1=0.4366, Prec=0.4636, Rec=0.4125 | Optimizing auprc=0.2295
                                                                                        Best trial: 140. Best value: 0.237476:  41%|████▏     | 207/500 [32:32<53:15, 10.91s/it]Best trial: 140. Best value: 0.237476:  41%|████▏     | 207/500 [32:32<53:15, 10.91s/it]Best trial: 140. Best value: 0.237476:  42%|████▏     | 208/500 [32:32<56:34, 11.62s/it][2025-11-19 08:54:34,514] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.128342839269786
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   gamma: 0.21119430908603737
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   alpha: 1.181666971931024
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   lambda: 2.477778865033186
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   learning_rate: 0.03346322948374959
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   subsample: 0.7753179351629966
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   colsample_bytree: 0.5016129986614368
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5598938766976953
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   colsample_bynode: 0.5454964957060084
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:54:34,514] [INFO] [<frozen importlib] -   scale_pos_weight: 5.128342839269786
[2025-11-19 08:54:34,589] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:54:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:54:34,504] Trial 207 finished with value: 0.22951622879966127 and parameters: {'max_depth': 4, 'min_child_weight': 4, 'gamma': 0.4810343565172449, 'learning_rate': 0.03597652065478734, 'n_estimators': 300, 'alpha': 0.6544104842958701, 'lambda': 2.682417485863696, 'subsample': 0.799734660949964, 'colsample_bytree': 0.545369225315038, 'colsample_bylevel': 0.5300174175463951, 'colsample_bynode': 0.7575328874736041, 'scale_pos_weight': 5.7361486984801}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.59510	train-auc:0.63325	train-aucpr:0.21348	val-logloss:0.57958	val-auc:0.63294	val-aucpr:0.11159
[10]	train-logloss:0.57804	train-auc:0.67251	train-aucpr:0.28054	val-logloss:0.55053	val-auc:0.66963	val-aucpr:0.16599
[20]	train-logloss:0.56644	train-auc:0.68169	train-aucpr:0.29056	val-logloss:0.52780	val-auc:0.67662	val-aucpr:0.18733
[30]	train-logloss:0.55823	train-auc:0.68647	train-aucpr:0.29865	val-logloss:0.50205	val-auc:0.69194	val-aucpr:0.21137
[40]	train-logloss:0.55162	train-auc:0.69129	train-aucpr:0.30572	val-logloss:0.48178	val-auc:0.70064	val-aucpr:0.21653
[50]	train-logloss:0.54646	train-auc:0.69546	train-aucpr:0.31059	val-logloss:0.46504	val-auc:0.70314	val-aucpr:0.22311
[60]	train-logloss:0.54253	train-auc:0.70019	train-aucpr:0.31388	val-logloss:0.45516	val-auc:0.70579	val-aucpr:0.22661
[70]	train-logloss:0.53924	train-auc:0.70501	train-aucpr:0.31781	val-logloss:0.46455	val-auc:0.70216	val-aucpr:0.22528
[80]	train-logloss:0.53633	train-auc:0.70978	train-aucpr:0.32148	val-logloss:0.45916	val-auc:0.70043	val-aucpr:0.22309
[90]	train-logloss:0.53382	train-auc:0.71321	train-aucpr:0.32490	val-logloss:0.45344	val-auc:0.69934	val-aucpr:0.22312
[2025-11-19 08:54:34,846] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:54:34,846] [INFO] [<frozen importlib] - Best train loss: 0.5425
[2025-11-19 08:54:34,846] [INFO] [<frozen importlib] - Best val loss: 0.4552
[2025-11-19 08:54:34,846] [INFO] [<frozen importlib] - Best val AUC: 0.7058
[2025-11-19 08:54:34,846] [INFO] [<frozen importlib] - Best val AUCPR: 0.2266
[2025-11-19 08:54:34,851] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:54:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:54:47,975] [INFO] [<frozen importlib] - Optimal threshold: 0.4336
[2025-11-19 08:54:47,975] [INFO] [<frozen importlib] - Best f1: 0.2742
[2025-11-19 08:54:47,975] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:54:48,017] [INFO] [<frozen importlib] - Validation Results (threshold=0.4336):
[2025-11-19 08:54:48,017] [INFO] [<frozen importlib] -   Accuracy: 0.9056
[2025-11-19 08:54:48,017] [INFO] [<frozen importlib] -   Precision: 0.3350
[2025-11-19 08:54:48,017] [INFO] [<frozen importlib] -   Recall: 0.2321
[2025-11-19 08:54:48,017] [INFO] [<frozen importlib] -   F1 Score: 0.2742
[2025-11-19 08:54:48,017] [INFO] [<frozen importlib] -   AUROC: 0.7058
[2025-11-19 08:54:48,017] [INFO] [<frozen importlib] -   AUPRC: 0.2270
[2025-11-19 08:54:48,017] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:54:48,017] [INFO] [<frozen importlib] -     TN=16776, FP=669
[2025-11-19 08:54:48,017] [INFO] [<frozen importlib] -     FN=1115, TP=337
[2025-11-19 08:54:48,040] [INFO] [<frozen importlib] - Trial 208: AUPRC=0.2270, F1=0.4467, Prec=0.4769, Rec=0.4201 | Optimizing auprc=0.2270
[2025-11-19 08:54:48,040] [INFO] [<frozen importlib] - Trial 208 pruned.
[2025-11-19 08:54:48,040] [ERROR] [<frozen importlib] - Trial 208 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  42%|████▏     | 208/500 [32:46<56:34, 11.62s/it]Best trial: 140. Best value: 0.237476:  42%|████▏     | 208/500 [32:46<56:34, 11.62s/it]Best trial: 140. Best value: 0.237476:  42%|████▏     | 209/500 [32:46<59:09, 12.20s/it][2025-11-19 08:54:48,051] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.842832268228083
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   gamma: 0.2845269592764831
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   alpha: 0.5164640724007252
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   lambda: 0.7943173197425865
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   learning_rate: 0.038512192554422724
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   subsample: 0.811419553802882
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   colsample_bytree: 0.5178598026294733
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5127900801256345
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   colsample_bynode: 0.6940256888959443
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:54:48,051] [INFO] [<frozen importlib] -   scale_pos_weight: 5.842832268228083
[2025-11-19 08:54:48,125] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:54:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:54:48,040] Trial 208 pruned. 
[0]	train-logloss:0.63530	train-auc:0.63906	train-aucpr:0.21689	val-logloss:0.62486	val-auc:0.66575	val-aucpr:0.14283
[10]	train-logloss:0.61337	train-auc:0.68272	train-aucpr:0.28828	val-logloss:0.58650	val-auc:0.71205	val-aucpr:0.20479
[20]	train-logloss:0.59985	train-auc:0.68977	train-aucpr:0.29833	val-logloss:0.54076	val-auc:0.72608	val-aucpr:0.23244
[30]	train-logloss:0.59050	train-auc:0.69185	train-aucpr:0.30461	val-logloss:0.50744	val-auc:0.72604	val-aucpr:0.23264
[40]	train-logloss:0.58379	train-auc:0.69567	train-aucpr:0.30990	val-logloss:0.48648	val-auc:0.72553	val-aucpr:0.23410
[50]	train-logloss:0.57854	train-auc:0.69998	train-aucpr:0.31350	val-logloss:0.47580	val-auc:0.71454	val-aucpr:0.22450
[53]	train-logloss:0.57731	train-auc:0.70093	train-aucpr:0.31505	val-logloss:0.47337	val-auc:0.71565	val-aucpr:0.22456
[2025-11-19 08:54:48,299] [INFO] [<frozen importlib] - Training completed at iteration 24
[2025-11-19 08:54:48,299] [INFO] [<frozen importlib] - Best train loss: 0.5958
[2025-11-19 08:54:48,299] [INFO] [<frozen importlib] - Best val loss: 0.5272
[2025-11-19 08:54:48,299] [INFO] [<frozen importlib] - Best val AUC: 0.7270
[2025-11-19 08:54:48,299] [INFO] [<frozen importlib] - Best val AUCPR: 0.2353
[2025-11-19 08:54:48,303] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:54:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:54:56,092] [INFO] [<frozen importlib] - Optimal threshold: 0.4572
[2025-11-19 08:54:56,092] [INFO] [<frozen importlib] - Best f1: 0.2849
[2025-11-19 08:54:56,092] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:54:56,136] [INFO] [<frozen importlib] - Validation Results (threshold=0.4572):
[2025-11-19 08:54:56,136] [INFO] [<frozen importlib] -   Accuracy: 0.9052
[2025-11-19 08:54:56,136] [INFO] [<frozen importlib] -   Precision: 0.3387
[2025-11-19 08:54:56,136] [INFO] [<frozen importlib] -   Recall: 0.2459
[2025-11-19 08:54:56,136] [INFO] [<frozen importlib] -   F1 Score: 0.2849
[2025-11-19 08:54:56,136] [INFO] [<frozen importlib] -   AUROC: 0.7270
[2025-11-19 08:54:56,136] [INFO] [<frozen importlib] -   AUPRC: 0.2357
[2025-11-19 08:54:56,136] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:54:56,136] [INFO] [<frozen importlib] -     TN=16748, FP=697
[2025-11-19 08:54:56,136] [INFO] [<frozen importlib] -     FN=1095, TP=357
[2025-11-19 08:54:56,163] [INFO] [<frozen importlib] - Trial 209: AUPRC=0.2357, F1=0.4489, Prec=0.4716, Rec=0.4284 | Optimizing auprc=0.2357
                                                                                        Best trial: 140. Best value: 0.237476:  42%|████▏     | 209/500 [32:54<59:09, 12.20s/it]Best trial: 140. Best value: 0.237476:  42%|████▏     | 209/500 [32:54<59:09, 12.20s/it]Best trial: 140. Best value: 0.237476:  42%|████▏     | 210/500 [32:54<53:02, 10.98s/it][2025-11-19 08:54:56,173] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.061623778265025
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   gamma: 0.2668547333428915
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   alpha: 0.5011829602441203
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   lambda: 0.7678134514196201
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   learning_rate: 0.03916654896649234
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   subsample: 0.8069547507795736
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   colsample_bytree: 0.51575890898841
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5097021265986407
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   colsample_bynode: 0.7024221524715978
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:54:56,173] [INFO] [<frozen importlib] -   scale_pos_weight: 6.061623778265025
[2025-11-19 08:54:56,248] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:54:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:54:56,164] Trial 209 finished with value: 0.23574328594235303 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.2845269592764831, 'learning_rate': 0.038512192554422724, 'n_estimators': 450, 'alpha': 0.5164640724007252, 'lambda': 0.7943173197425865, 'subsample': 0.811419553802882, 'colsample_bytree': 0.5178598026294733, 'colsample_bylevel': 0.5127900801256345, 'colsample_bynode': 0.6940256888959443, 'scale_pos_weight': 5.842832268228083}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.64745	train-auc:0.63899	train-aucpr:0.22075	val-logloss:0.63870	val-auc:0.66940	val-aucpr:0.15306
[10]	train-logloss:0.62541	train-auc:0.68137	train-aucpr:0.28547	val-logloss:0.58747	val-auc:0.67325	val-aucpr:0.18011
[20]	train-logloss:0.61144	train-auc:0.68690	train-aucpr:0.29627	val-logloss:0.55185	val-auc:0.70857	val-aucpr:0.21106
[30]	train-logloss:0.60201	train-auc:0.69208	train-aucpr:0.30228	val-logloss:0.52224	val-auc:0.70288	val-aucpr:0.21607
[40]	train-logloss:0.59487	train-auc:0.69749	train-aucpr:0.30810	val-logloss:0.52569	val-auc:0.70981	val-aucpr:0.22215
[50]	train-logloss:0.58918	train-auc:0.70339	train-aucpr:0.31291	val-logloss:0.51027	val-auc:0.71025	val-aucpr:0.22449
[60]	train-logloss:0.58526	train-auc:0.70613	train-aucpr:0.31643	val-logloss:0.49341	val-auc:0.71021	val-aucpr:0.22522
[70]	train-logloss:0.58199	train-auc:0.70999	train-aucpr:0.32033	val-logloss:0.50002	val-auc:0.70801	val-aucpr:0.21878
[80]	train-logloss:0.57885	train-auc:0.71358	train-aucpr:0.32441	val-logloss:0.49976	val-auc:0.69981	val-aucpr:0.20798
[88]	train-logloss:0.57693	train-auc:0.71587	train-aucpr:0.32664	val-logloss:0.48365	val-auc:0.69621	val-aucpr:0.20296
[2025-11-19 08:54:56,508] [INFO] [<frozen importlib] - Training completed at iteration 58
[2025-11-19 08:54:56,508] [INFO] [<frozen importlib] - Best train loss: 0.5860
[2025-11-19 08:54:56,508] [INFO] [<frozen importlib] - Best val loss: 0.4948
[2025-11-19 08:54:56,508] [INFO] [<frozen importlib] - Best val AUC: 0.7105
[2025-11-19 08:54:56,508] [INFO] [<frozen importlib] - Best val AUCPR: 0.2256
[2025-11-19 08:54:56,512] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:54:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:55:09,651] [INFO] [<frozen importlib] - Optimal threshold: 0.4627
[2025-11-19 08:55:09,651] [INFO] [<frozen importlib] - Best f1: 0.2767
[2025-11-19 08:55:09,651] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:55:09,695] [INFO] [<frozen importlib] - Validation Results (threshold=0.4627):
[2025-11-19 08:55:09,695] [INFO] [<frozen importlib] -   Accuracy: 0.8805
[2025-11-19 08:55:09,695] [INFO] [<frozen importlib] -   Precision: 0.2585
[2025-11-19 08:55:09,695] [INFO] [<frozen importlib] -   Recall: 0.2975
[2025-11-19 08:55:09,695] [INFO] [<frozen importlib] -   F1 Score: 0.2767
[2025-11-19 08:55:09,695] [INFO] [<frozen importlib] -   AUROC: 0.7105
[2025-11-19 08:55:09,695] [INFO] [<frozen importlib] -   AUPRC: 0.2262
[2025-11-19 08:55:09,695] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:55:09,695] [INFO] [<frozen importlib] -     TN=16206, FP=1239
[2025-11-19 08:55:09,695] [INFO] [<frozen importlib] -     FN=1020, TP=432
[2025-11-19 08:55:09,718] [INFO] [<frozen importlib] - Trial 210: AUPRC=0.2262, F1=0.4543, Prec=0.3897, Rec=0.5448 | Optimizing auprc=0.2262
[2025-11-19 08:55:09,718] [INFO] [<frozen importlib] - Trial 210 pruned.
[2025-11-19 08:55:09,718] [ERROR] [<frozen importlib] - Trial 210 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  42%|████▏     | 210/500 [33:07<53:02, 10.98s/it]Best trial: 140. Best value: 0.237476:  42%|████▏     | 210/500 [33:07<53:02, 10.98s/it]Best trial: 140. Best value: 0.237476:  42%|████▏     | 211/500 [33:07<56:35, 11.75s/it][2025-11-19 08:55:09,728] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.713736009395012
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   gamma: 0.43718514098777256
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   alpha: 0.460421334708324
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   lambda: 0.9599490573607465
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   learning_rate: 0.03858583043187173
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   subsample: 0.7904894636845072
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   colsample_bytree: 0.5223195354207167
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5228629802441186
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   colsample_bynode: 0.676121144516904
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:55:09,728] [INFO] [<frozen importlib] -   scale_pos_weight: 5.713736009395012
[2025-11-19 08:55:09,803] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:55:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:55:09,718] Trial 210 pruned. 
[0]	train-logloss:0.62803	train-auc:0.63274	train-aucpr:0.22476	val-logloss:0.61630	val-auc:0.64748	val-aucpr:0.12399
[10]	train-logloss:0.60670	train-auc:0.67801	train-aucpr:0.28717	val-logloss:0.56454	val-auc:0.66972	val-aucpr:0.19409
[20]	train-logloss:0.59327	train-auc:0.68741	train-aucpr:0.29716	val-logloss:0.52993	val-auc:0.71022	val-aucpr:0.21764
[30]	train-logloss:0.58422	train-auc:0.69122	train-aucpr:0.30261	val-logloss:0.51153	val-auc:0.70922	val-aucpr:0.22051
[40]	train-logloss:0.57734	train-auc:0.69533	train-aucpr:0.30799	val-logloss:0.49169	val-auc:0.70562	val-aucpr:0.22210
[50]	train-logloss:0.57211	train-auc:0.69968	train-aucpr:0.31142	val-logloss:0.47480	val-auc:0.71052	val-aucpr:0.22558
[60]	train-logloss:0.56837	train-auc:0.70345	train-aucpr:0.31519	val-logloss:0.47093	val-auc:0.71125	val-aucpr:0.22446
[70]	train-logloss:0.56529	train-auc:0.70792	train-aucpr:0.31899	val-logloss:0.47776	val-auc:0.70701	val-aucpr:0.21697
[77]	train-logloss:0.56314	train-auc:0.71101	train-aucpr:0.32187	val-logloss:0.46588	val-auc:0.71316	val-aucpr:0.22071
[2025-11-19 08:55:10,032] [INFO] [<frozen importlib] - Training completed at iteration 48
[2025-11-19 08:55:10,032] [INFO] [<frozen importlib] - Best train loss: 0.5730
[2025-11-19 08:55:10,032] [INFO] [<frozen importlib] - Best val loss: 0.4766
[2025-11-19 08:55:10,032] [INFO] [<frozen importlib] - Best val AUC: 0.7118
[2025-11-19 08:55:10,032] [INFO] [<frozen importlib] - Best val AUCPR: 0.2265
[2025-11-19 08:55:10,036] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:55:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:55:20,621] [INFO] [<frozen importlib] - Optimal threshold: 0.4457
[2025-11-19 08:55:20,621] [INFO] [<frozen importlib] - Best f1: 0.2787
[2025-11-19 08:55:20,621] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:55:20,663] [INFO] [<frozen importlib] - Validation Results (threshold=0.4457):
[2025-11-19 08:55:20,663] [INFO] [<frozen importlib] -   Accuracy: 0.8973
[2025-11-19 08:55:20,663] [INFO] [<frozen importlib] -   Precision: 0.3027
[2025-11-19 08:55:20,663] [INFO] [<frozen importlib] -   Recall: 0.2583
[2025-11-19 08:55:20,663] [INFO] [<frozen importlib] -   F1 Score: 0.2787
[2025-11-19 08:55:20,663] [INFO] [<frozen importlib] -   AUROC: 0.7118
[2025-11-19 08:55:20,664] [INFO] [<frozen importlib] -   AUPRC: 0.2270
[2025-11-19 08:55:20,664] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:55:20,664] [INFO] [<frozen importlib] -     TN=16581, FP=864
[2025-11-19 08:55:20,664] [INFO] [<frozen importlib] -     FN=1077, TP=375
[2025-11-19 08:55:20,690] [INFO] [<frozen importlib] - Trial 211: AUPRC=0.2270, F1=0.4545, Prec=0.4408, Rec=0.4690 | Optimizing auprc=0.2270
                                                                                        Best trial: 140. Best value: 0.237476:  42%|████▏     | 211/500 [33:18<56:35, 11.75s/it]Best trial: 140. Best value: 0.237476:  42%|████▏     | 211/500 [33:18<56:35, 11.75s/it]Best trial: 140. Best value: 0.237476:  42%|████▏     | 212/500 [33:18<55:16, 11.52s/it][2025-11-19 08:55:20,700] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.379440107041821
[2025-11-19 08:55:20,700] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:55:20,700] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   gamma: 0.45355875246161603
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   alpha: 0.5661989207860677
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   lambda: 0.8409555955135396
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   learning_rate: 0.060823260775011954
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   subsample: 0.8105763220722634
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   colsample_bytree: 0.5338611749708339
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8707972257899692
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   colsample_bynode: 0.685999570830461
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:55:20,701] [INFO] [<frozen importlib] -   scale_pos_weight: 5.379440107041821
[2025-11-19 08:55:20,778] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:55:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:55:20,690] Trial 211 finished with value: 0.2269636749407122 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.43718514098777256, 'learning_rate': 0.03858583043187173, 'n_estimators': 450, 'alpha': 0.460421334708324, 'lambda': 0.9599490573607465, 'subsample': 0.7904894636845072, 'colsample_bytree': 0.5223195354207167, 'colsample_bylevel': 0.5228629802441186, 'colsample_bynode': 0.676121144516904, 'scale_pos_weight': 5.713736009395012}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.60684	train-auc:0.65353	train-aucpr:0.23209	val-logloss:0.58637	val-auc:0.64735	val-aucpr:0.14047
[10]	train-logloss:0.57880	train-auc:0.68522	train-aucpr:0.29231	val-logloss:0.51487	val-auc:0.65827	val-aucpr:0.18476
[20]	train-logloss:0.56383	train-auc:0.69439	train-aucpr:0.30552	val-logloss:0.48226	val-auc:0.69180	val-aucpr:0.20782
[30]	train-logloss:0.55482	train-auc:0.70022	train-aucpr:0.31303	val-logloss:0.45656	val-auc:0.69663	val-aucpr:0.20981
[40]	train-logloss:0.54882	train-auc:0.70713	train-aucpr:0.32158	val-logloss:0.44523	val-auc:0.69705	val-aucpr:0.20340
[50]	train-logloss:0.54414	train-auc:0.71247	train-aucpr:0.32689	val-logloss:0.44339	val-auc:0.69618	val-aucpr:0.19789
[57]	train-logloss:0.54192	train-auc:0.71596	train-aucpr:0.33045	val-logloss:0.43539	val-auc:0.69761	val-aucpr:0.19602
[2025-11-19 08:55:20,953] [INFO] [<frozen importlib] - Training completed at iteration 27
[2025-11-19 08:55:20,953] [INFO] [<frozen importlib] - Best train loss: 0.5571
[2025-11-19 08:55:20,953] [INFO] [<frozen importlib] - Best val loss: 0.4643
[2025-11-19 08:55:20,953] [INFO] [<frozen importlib] - Best val AUC: 0.6996
[2025-11-19 08:55:20,953] [INFO] [<frozen importlib] - Best val AUCPR: 0.2127
[2025-11-19 08:55:20,958] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:55:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:55:27,683] [INFO] [<frozen importlib] - Optimal threshold: 0.4232
[2025-11-19 08:55:27,684] [INFO] [<frozen importlib] - Best f1: 0.2790
[2025-11-19 08:55:27,684] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:55:27,723] [INFO] [<frozen importlib] - Validation Results (threshold=0.4232):
[2025-11-19 08:55:27,723] [INFO] [<frozen importlib] -   Accuracy: 0.8900
[2025-11-19 08:55:27,723] [INFO] [<frozen importlib] -   Precision: 0.2811
[2025-11-19 08:55:27,723] [INFO] [<frozen importlib] -   Recall: 0.2769
[2025-11-19 08:55:27,723] [INFO] [<frozen importlib] -   F1 Score: 0.2790
[2025-11-19 08:55:27,723] [INFO] [<frozen importlib] -   AUROC: 0.6996
[2025-11-19 08:55:27,723] [INFO] [<frozen importlib] -   AUPRC: 0.2131
[2025-11-19 08:55:27,723] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:55:27,724] [INFO] [<frozen importlib] -     TN=16417, FP=1028
[2025-11-19 08:55:27,724] [INFO] [<frozen importlib] -     FN=1050, TP=402
[2025-11-19 08:55:27,745] [INFO] [<frozen importlib] - Trial 212: AUPRC=0.2131, F1=0.4524, Prec=0.4136, Rec=0.4993 | Optimizing auprc=0.2131
                                                                                        Best trial: 140. Best value: 0.237476:  42%|████▏     | 212/500 [33:25<55:16, 11.52s/it]Best trial: 140. Best value: 0.237476:  42%|████▏     | 212/500 [33:25<55:16, 11.52s/it]Best trial: 140. Best value: 0.237476:  43%|████▎     | 213/500 [33:25<48:40, 10.18s/it][2025-11-19 08:55:27,755] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.3901410995778525
[2025-11-19 08:55:27,755] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:55:27,755] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:55:27,755] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:55:27,755] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:55:27,755] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:55:27,755] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   gamma: 0.2909913912278734
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   alpha: 0.17106394249189516
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   lambda: 0.6722219008775598
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   learning_rate: 0.03659977895656792
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   subsample: 0.7818760643115209
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   colsample_bytree: 0.500077625295112
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5398845611649645
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   colsample_bynode: 0.6627829792829998
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:55:27,756] [INFO] [<frozen importlib] -   scale_pos_weight: 6.3901410995778525
[2025-11-19 08:55:27,829] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:55:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:55:27,745] Trial 212 finished with value: 0.21309349407363834 and parameters: {'max_depth': 4, 'min_child_weight': 4, 'gamma': 0.45355875246161603, 'learning_rate': 0.060823260775011954, 'n_estimators': 450, 'alpha': 0.5661989207860677, 'lambda': 0.8409555955135396, 'subsample': 0.8105763220722634, 'colsample_bytree': 0.5338611749708339, 'colsample_bylevel': 0.8707972257899692, 'colsample_bynode': 0.685999570830461, 'scale_pos_weight': 5.379440107041821}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.66604	train-auc:0.63224	train-aucpr:0.22231	val-logloss:0.65890	val-auc:0.64881	val-aucpr:0.13202
[10]	train-logloss:0.64387	train-auc:0.67972	train-aucpr:0.29234	val-logloss:0.61036	val-auc:0.66556	val-aucpr:0.16036
[20]	train-logloss:0.62990	train-auc:0.68714	train-aucpr:0.29752	val-logloss:0.56756	val-auc:0.70937	val-aucpr:0.22535
[30]	train-logloss:0.61995	train-auc:0.69211	train-aucpr:0.30352	val-logloss:0.53645	val-auc:0.71126	val-aucpr:0.22752
[40]	train-logloss:0.61258	train-auc:0.69614	train-aucpr:0.30832	val-logloss:0.51556	val-auc:0.71026	val-aucpr:0.22538
[50]	train-logloss:0.60665	train-auc:0.70025	train-aucpr:0.31306	val-logloss:0.50082	val-auc:0.71125	val-aucpr:0.22601
[56]	train-logloss:0.60395	train-auc:0.70179	train-aucpr:0.31449	val-logloss:0.49795	val-auc:0.71187	val-aucpr:0.22735
[2025-11-19 08:55:28,008] [INFO] [<frozen importlib] - Training completed at iteration 27
[2025-11-19 08:55:28,008] [INFO] [<frozen importlib] - Best train loss: 0.6227
[2025-11-19 08:55:28,008] [INFO] [<frozen importlib] - Best val loss: 0.5456
[2025-11-19 08:55:28,008] [INFO] [<frozen importlib] - Best val AUC: 0.7148
[2025-11-19 08:55:28,008] [INFO] [<frozen importlib] - Best val AUCPR: 0.2293
[2025-11-19 08:55:28,012] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:55:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:55:36,093] [INFO] [<frozen importlib] - Optimal threshold: 0.4742
[2025-11-19 08:55:36,093] [INFO] [<frozen importlib] - Best f1: 0.2741
[2025-11-19 08:55:36,093] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:55:36,143] [INFO] [<frozen importlib] - Validation Results (threshold=0.4742):
[2025-11-19 08:55:36,143] [INFO] [<frozen importlib] -   Accuracy: 0.8977
[2025-11-19 08:55:36,143] [INFO] [<frozen importlib] -   Precision: 0.3014
[2025-11-19 08:55:36,143] [INFO] [<frozen importlib] -   Recall: 0.2514
[2025-11-19 08:55:36,143] [INFO] [<frozen importlib] -   F1 Score: 0.2741
[2025-11-19 08:55:36,143] [INFO] [<frozen importlib] -   AUROC: 0.7148
[2025-11-19 08:55:36,143] [INFO] [<frozen importlib] -   AUPRC: 0.2297
[2025-11-19 08:55:36,143] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:55:36,143] [INFO] [<frozen importlib] -     TN=16599, FP=846
[2025-11-19 08:55:36,143] [INFO] [<frozen importlib] -     FN=1087, TP=365
[2025-11-19 08:55:36,167] [INFO] [<frozen importlib] - Trial 213: AUPRC=0.2297, F1=0.4426, Prec=0.4356, Rec=0.4497 | Optimizing auprc=0.2297
                                                                                        Best trial: 140. Best value: 0.237476:  43%|████▎     | 213/500 [33:34<48:40, 10.18s/it]Best trial: 140. Best value: 0.237476:  43%|████▎     | 213/500 [33:34<48:40, 10.18s/it]Best trial: 140. Best value: 0.237476:  43%|████▎     | 214/500 [33:34<46:00,  9.65s/it][2025-11-19 08:55:36,180] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 12.96409040054279
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   gamma: 0.2886567570015872
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   alpha: 0.17520966066531246
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   lambda: 0.5620183244680634
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   learning_rate: 0.03664047479135441
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   subsample: 0.7859559430484095
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   colsample_bytree: 0.5009140411357542
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5132542733669307
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   colsample_bynode: 0.659053828353972
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:55:36,180] [INFO] [<frozen importlib] -   scale_pos_weight: 12.96409040054279
[2025-11-19 08:55:36,254] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:55:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:55:36,167] Trial 213 finished with value: 0.2296566378567304 and parameters: {'max_depth': 4, 'min_child_weight': 4, 'gamma': 0.2909913912278734, 'learning_rate': 0.03659977895656792, 'n_estimators': 450, 'alpha': 0.17106394249189516, 'lambda': 0.6722219008775598, 'subsample': 0.7818760643115209, 'colsample_bytree': 0.500077625295112, 'colsample_bylevel': 0.5398845611649645, 'colsample_bynode': 0.6627829792829998, 'scale_pos_weight': 6.3901410995778525}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.96617	train-auc:0.63758	train-aucpr:0.21766	val-logloss:0.99277	val-auc:0.64080	val-aucpr:0.12405
[10]	train-logloss:0.93279	train-auc:0.68642	train-aucpr:0.28639	val-logloss:0.91195	val-auc:0.69155	val-aucpr:0.19751
[20]	train-logloss:0.91312	train-auc:0.69087	train-aucpr:0.29173	val-logloss:0.85273	val-auc:0.70045	val-aucpr:0.20297
[30]	train-logloss:0.89955	train-auc:0.69471	train-aucpr:0.29747	val-logloss:0.80269	val-auc:0.70707	val-aucpr:0.21894
[40]	train-logloss:0.88953	train-auc:0.69835	train-aucpr:0.30295	val-logloss:0.77117	val-auc:0.70432	val-aucpr:0.21459
[50]	train-logloss:0.88074	train-auc:0.70264	train-aucpr:0.30779	val-logloss:0.73358	val-auc:0.69949	val-aucpr:0.21351
[59]	train-logloss:0.87577	train-auc:0.70428	train-aucpr:0.31148	val-logloss:0.72458	val-auc:0.70035	val-aucpr:0.21667
[2025-11-19 08:55:36,452] [INFO] [<frozen importlib] - Training completed at iteration 30
[2025-11-19 08:55:36,452] [INFO] [<frozen importlib] - Best train loss: 0.8995
[2025-11-19 08:55:36,452] [INFO] [<frozen importlib] - Best val loss: 0.8027
[2025-11-19 08:55:36,452] [INFO] [<frozen importlib] - Best val AUC: 0.7071
[2025-11-19 08:55:36,452] [INFO] [<frozen importlib] - Best val AUCPR: 0.2189
[2025-11-19 08:55:36,457] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:55:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:55:46,539] [INFO] [<frozen importlib] - Optimal threshold: 0.6346
[2025-11-19 08:55:46,539] [INFO] [<frozen importlib] - Best f1: 0.2609
[2025-11-19 08:55:46,539] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:55:46,585] [INFO] [<frozen importlib] - Validation Results (threshold=0.6346):
[2025-11-19 08:55:46,585] [INFO] [<frozen importlib] -   Accuracy: 0.8843
[2025-11-19 08:55:46,585] [INFO] [<frozen importlib] -   Precision: 0.2561
[2025-11-19 08:55:46,585] [INFO] [<frozen importlib] -   Recall: 0.2658
[2025-11-19 08:55:46,585] [INFO] [<frozen importlib] -   F1 Score: 0.2609
[2025-11-19 08:55:46,585] [INFO] [<frozen importlib] -   AUROC: 0.7071
[2025-11-19 08:55:46,585] [INFO] [<frozen importlib] -   AUPRC: 0.2193
[2025-11-19 08:55:46,585] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:55:46,585] [INFO] [<frozen importlib] -     TN=16324, FP=1121
[2025-11-19 08:55:46,585] [INFO] [<frozen importlib] -     FN=1066, TP=386
[2025-11-19 08:55:46,611] [INFO] [<frozen importlib] - Trial 214: AUPRC=0.2193, F1=0.4325, Prec=0.3878, Rec=0.4890 | Optimizing auprc=0.2193
[2025-11-19 08:55:46,611] [INFO] [<frozen importlib] - Trial 214 pruned.
[2025-11-19 08:55:46,612] [ERROR] [<frozen importlib] - Trial 214 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  43%|████▎     | 214/500 [33:44<46:00,  9.65s/it]Best trial: 140. Best value: 0.237476:  43%|████▎     | 214/500 [33:44<46:00,  9.65s/it]Best trial: 140. Best value: 0.237476:  43%|████▎     | 215/500 [33:44<46:58,  9.89s/it][2025-11-19 08:55:46,631] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.32873819107759
[2025-11-19 08:55:46,631] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:55:46,631] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:55:46,631] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   gamma: 0.23981248442991696
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   alpha: 0.1427444554315364
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   lambda: 0.6874028127667255
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   learning_rate: 0.03472233802179621
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   subsample: 0.8007456335755623
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   colsample_bytree: 0.511926287265764
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5399893904284804
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   colsample_bynode: 0.6721197574182354
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:55:46,632] [INFO] [<frozen importlib] -   scale_pos_weight: 6.32873819107759
[2025-11-19 08:55:46,708] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:55:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:55:46,612] Trial 214 pruned. 
[0]	train-logloss:0.66272	train-auc:0.63365	train-aucpr:0.22881	val-logloss:0.65599	val-auc:0.65680	val-aucpr:0.14965
[10]	train-logloss:0.64199	train-auc:0.67816	train-aucpr:0.28682	val-logloss:0.60979	val-auc:0.68518	val-aucpr:0.18628
[20]	train-logloss:0.62804	train-auc:0.68552	train-aucpr:0.29573	val-logloss:0.57398	val-auc:0.70875	val-aucpr:0.21385
[30]	train-logloss:0.61849	train-auc:0.69052	train-aucpr:0.30103	val-logloss:0.54468	val-auc:0.70795	val-aucpr:0.21820
[40]	train-logloss:0.61122	train-auc:0.69471	train-aucpr:0.30595	val-logloss:0.52654	val-auc:0.70890	val-aucpr:0.21930
[50]	train-logloss:0.60520	train-auc:0.69939	train-aucpr:0.31069	val-logloss:0.51392	val-auc:0.71072	val-aucpr:0.22262
[60]	train-logloss:0.60087	train-auc:0.70276	train-aucpr:0.31454	val-logloss:0.50328	val-auc:0.71279	val-aucpr:0.22719
[70]	train-logloss:0.59731	train-auc:0.70719	train-aucpr:0.31865	val-logloss:0.50100	val-auc:0.70267	val-aucpr:0.21651
[80]	train-logloss:0.59451	train-auc:0.70950	train-aucpr:0.32156	val-logloss:0.49795	val-auc:0.70302	val-aucpr:0.21714
[87]	train-logloss:0.59250	train-auc:0.71206	train-aucpr:0.32384	val-logloss:0.49021	val-auc:0.70997	val-aucpr:0.21545
[2025-11-19 08:55:46,977] [INFO] [<frozen importlib] - Training completed at iteration 57
[2025-11-19 08:55:46,977] [INFO] [<frozen importlib] - Best train loss: 0.6021
[2025-11-19 08:55:46,977] [INFO] [<frozen importlib] - Best val loss: 0.5047
[2025-11-19 08:55:46,977] [INFO] [<frozen importlib] - Best val AUC: 0.7135
[2025-11-19 08:55:46,977] [INFO] [<frozen importlib] - Best val AUCPR: 0.2273
[2025-11-19 08:55:46,982] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:55:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:55:59,950] [INFO] [<frozen importlib] - Optimal threshold: 0.4675
[2025-11-19 08:55:59,951] [INFO] [<frozen importlib] - Best f1: 0.2730
[2025-11-19 08:55:59,951] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:55:59,992] [INFO] [<frozen importlib] - Validation Results (threshold=0.4675):
[2025-11-19 08:55:59,992] [INFO] [<frozen importlib] -   Accuracy: 0.8847
[2025-11-19 08:55:59,992] [INFO] [<frozen importlib] -   Precision: 0.2649
[2025-11-19 08:55:59,992] [INFO] [<frozen importlib] -   Recall: 0.2817
[2025-11-19 08:55:59,992] [INFO] [<frozen importlib] -   F1 Score: 0.2730
[2025-11-19 08:55:59,992] [INFO] [<frozen importlib] -   AUROC: 0.7135
[2025-11-19 08:55:59,992] [INFO] [<frozen importlib] -   AUPRC: 0.2277
[2025-11-19 08:55:59,992] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:55:59,992] [INFO] [<frozen importlib] -     TN=16310, FP=1135
[2025-11-19 08:55:59,992] [INFO] [<frozen importlib] -     FN=1043, TP=409
[2025-11-19 08:56:00,015] [INFO] [<frozen importlib] - Trial 215: AUPRC=0.2277, F1=0.4345, Prec=0.3875, Rec=0.4945 | Optimizing auprc=0.2277
[2025-11-19 08:56:00,015] [INFO] [<frozen importlib] - Trial 215 pruned.
[2025-11-19 08:56:00,015] [ERROR] [<frozen importlib] - Trial 215 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  43%|████▎     | 215/500 [33:57<46:58,  9.89s/it]Best trial: 140. Best value: 0.237476:  43%|████▎     | 215/500 [33:57<46:58,  9.89s/it]Best trial: 140. Best value: 0.237476:  43%|████▎     | 216/500 [33:57<51:47, 10.94s/it][2025-11-19 08:56:00,025] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.475254293816709
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   gamma: 0.2646812741540961
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   alpha: 0.5464344041853088
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   lambda: 0.7337538076289679
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   learning_rate: 0.03742375685069804
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   subsample: 0.7663299230122954
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   colsample_bytree: 0.5001417837559637
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5285532664590715
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   colsample_bynode: 0.6864365945537237
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:56:00,025] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:56:00,026] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:56:00,026] [INFO] [<frozen importlib] -   scale_pos_weight: 6.475254293816709
[2025-11-19 08:56:00,103] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:56:00] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:56:00,015] Trial 215 pruned. 
[0]	train-logloss:0.67047	train-auc:0.63959	train-aucpr:0.22122	val-logloss:0.66467	val-auc:0.65607	val-aucpr:0.14006
[10]	train-logloss:0.64784	train-auc:0.68288	train-aucpr:0.28804	val-logloss:0.60556	val-auc:0.70150	val-aucpr:0.21419
[20]	train-logloss:0.63391	train-auc:0.68915	train-aucpr:0.29554	val-logloss:0.57446	val-auc:0.71487	val-aucpr:0.22340
[30]	train-logloss:0.62336	train-auc:0.69306	train-aucpr:0.30277	val-logloss:0.54405	val-auc:0.71294	val-aucpr:0.22794
[40]	train-logloss:0.61603	train-auc:0.69788	train-aucpr:0.30801	val-logloss:0.51901	val-auc:0.70779	val-aucpr:0.22503
[50]	train-logloss:0.61014	train-auc:0.70182	train-aucpr:0.31314	val-logloss:0.49950	val-auc:0.71185	val-aucpr:0.22970
[60]	train-logloss:0.60609	train-auc:0.70427	train-aucpr:0.31690	val-logloss:0.48945	val-auc:0.71286	val-aucpr:0.22971
[70]	train-logloss:0.60236	train-auc:0.70893	train-aucpr:0.32102	val-logloss:0.47201	val-auc:0.70988	val-aucpr:0.22473
[80]	train-logloss:0.59975	train-auc:0.71197	train-aucpr:0.32390	val-logloss:0.46759	val-auc:0.71352	val-aucpr:0.22514
[90]	train-logloss:0.59723	train-auc:0.71545	train-aucpr:0.32716	val-logloss:0.44803	val-auc:0.71371	val-aucpr:0.22670
[92]	train-logloss:0.59671	train-auc:0.71623	train-aucpr:0.32773	val-logloss:0.44603	val-auc:0.70842	val-aucpr:0.21681
[2025-11-19 08:56:00,368] [INFO] [<frozen importlib] - Training completed at iteration 63
[2025-11-19 08:56:00,368] [INFO] [<frozen importlib] - Best train loss: 0.6048
[2025-11-19 08:56:00,368] [INFO] [<frozen importlib] - Best val loss: 0.4860
[2025-11-19 08:56:00,368] [INFO] [<frozen importlib] - Best val AUC: 0.7173
[2025-11-19 08:56:00,368] [INFO] [<frozen importlib] - Best val AUCPR: 0.2319
[2025-11-19 08:56:00,372] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:56:00] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:56:13,791] [INFO] [<frozen importlib] - Optimal threshold: 0.4729
[2025-11-19 08:56:13,791] [INFO] [<frozen importlib] - Best f1: 0.2718
[2025-11-19 08:56:13,791] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:56:13,837] [INFO] [<frozen importlib] - Validation Results (threshold=0.4729):
[2025-11-19 08:56:13,837] [INFO] [<frozen importlib] -   Accuracy: 0.8911
[2025-11-19 08:56:13,837] [INFO] [<frozen importlib] -   Precision: 0.2795
[2025-11-19 08:56:13,837] [INFO] [<frozen importlib] -   Recall: 0.2645
[2025-11-19 08:56:13,837] [INFO] [<frozen importlib] -   F1 Score: 0.2718
[2025-11-19 08:56:13,837] [INFO] [<frozen importlib] -   AUROC: 0.7173
[2025-11-19 08:56:13,837] [INFO] [<frozen importlib] -   AUPRC: 0.2322
[2025-11-19 08:56:13,837] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:56:13,837] [INFO] [<frozen importlib] -     TN=16455, FP=990
[2025-11-19 08:56:13,837] [INFO] [<frozen importlib] -     FN=1068, TP=384
[2025-11-19 08:56:13,860] [INFO] [<frozen importlib] - Trial 216: AUPRC=0.2322, F1=0.4446, Prec=0.4135, Rec=0.4807 | Optimizing auprc=0.2322
                                                                                        Best trial: 140. Best value: 0.237476:  43%|████▎     | 216/500 [34:11<51:47, 10.94s/it]Best trial: 140. Best value: 0.237476:  43%|████▎     | 216/500 [34:11<51:47, 10.94s/it]Best trial: 140. Best value: 0.237476:  43%|████▎     | 217/500 [34:11<55:43, 11.81s/it][2025-11-19 08:56:13,871] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.890209359085144
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   gamma: 0.2647126495064213
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   alpha: 0.5324856997555639
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   lambda: 1.0549484757685068
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   learning_rate: 0.03843098710323767
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   subsample: 0.7665519884129319
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   colsample_bytree: 0.5208275446159358
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5169363867985866
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   colsample_bynode: 0.6921729803947747
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:56:13,871] [INFO] [<frozen importlib] -   scale_pos_weight: 6.890209359085144
[2025-11-19 08:56:13,943] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:56:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:56:13,860] Trial 216 finished with value: 0.2322136233459054 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.2646812741540961, 'learning_rate': 0.03742375685069804, 'n_estimators': 450, 'alpha': 0.5464344041853088, 'lambda': 0.7337538076289679, 'subsample': 0.7663299230122954, 'colsample_bytree': 0.5001417837559637, 'colsample_bylevel': 0.5285532664590715, 'colsample_bynode': 0.6864365945537237, 'scale_pos_weight': 6.475254293816709}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.69321	train-auc:0.63292	train-aucpr:0.22608	val-logloss:0.69055	val-auc:0.65105	val-aucpr:0.13442
[10]	train-logloss:0.66856	train-auc:0.68138	train-aucpr:0.29110	val-logloss:0.63018	val-auc:0.68110	val-aucpr:0.20097
[20]	train-logloss:0.65357	train-auc:0.68809	train-aucpr:0.29660	val-logloss:0.59196	val-auc:0.70970	val-aucpr:0.21578
[30]	train-logloss:0.64335	train-auc:0.69098	train-aucpr:0.30327	val-logloss:0.55911	val-auc:0.71081	val-aucpr:0.21711
[40]	train-logloss:0.63547	train-auc:0.69605	train-aucpr:0.30832	val-logloss:0.54661	val-auc:0.70360	val-aucpr:0.21500
[50]	train-logloss:0.62956	train-auc:0.70045	train-aucpr:0.31174	val-logloss:0.52830	val-auc:0.70679	val-aucpr:0.21905
[60]	train-logloss:0.62525	train-auc:0.70360	train-aucpr:0.31611	val-logloss:0.52518	val-auc:0.70681	val-aucpr:0.22405
[70]	train-logloss:0.62159	train-auc:0.70856	train-aucpr:0.32093	val-logloss:0.53314	val-auc:0.69734	val-aucpr:0.21180
[80]	train-logloss:0.61856	train-auc:0.71298	train-aucpr:0.32466	val-logloss:0.52606	val-auc:0.69681	val-aucpr:0.20838
[90]	train-logloss:0.61544	train-auc:0.71717	train-aucpr:0.32945	val-logloss:0.51858	val-auc:0.69359	val-aucpr:0.20370
[2025-11-19 08:56:14,199] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 08:56:14,199] [INFO] [<frozen importlib] - Best train loss: 0.6252
[2025-11-19 08:56:14,199] [INFO] [<frozen importlib] - Best val loss: 0.5252
[2025-11-19 08:56:14,199] [INFO] [<frozen importlib] - Best val AUC: 0.7068
[2025-11-19 08:56:14,199] [INFO] [<frozen importlib] - Best val AUCPR: 0.2241
[2025-11-19 08:56:14,204] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:56:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:56:27,362] [INFO] [<frozen importlib] - Optimal threshold: 0.4969
[2025-11-19 08:56:27,363] [INFO] [<frozen importlib] - Best f1: 0.2720
[2025-11-19 08:56:27,363] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:56:27,411] [INFO] [<frozen importlib] - Validation Results (threshold=0.4969):
[2025-11-19 08:56:27,411] [INFO] [<frozen importlib] -   Accuracy: 0.9037
[2025-11-19 08:56:27,411] [INFO] [<frozen importlib] -   Precision: 0.3244
[2025-11-19 08:56:27,411] [INFO] [<frozen importlib] -   Recall: 0.2342
[2025-11-19 08:56:27,411] [INFO] [<frozen importlib] -   F1 Score: 0.2720
[2025-11-19 08:56:27,411] [INFO] [<frozen importlib] -   AUROC: 0.7068
[2025-11-19 08:56:27,411] [INFO] [<frozen importlib] -   AUPRC: 0.2245
[2025-11-19 08:56:27,411] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:56:27,411] [INFO] [<frozen importlib] -     TN=16737, FP=708
[2025-11-19 08:56:27,411] [INFO] [<frozen importlib] -     FN=1112, TP=340
[2025-11-19 08:56:27,437] [INFO] [<frozen importlib] - Trial 217: AUPRC=0.2245, F1=0.4544, Prec=0.4728, Rec=0.4373 | Optimizing auprc=0.2245
[2025-11-19 08:56:27,438] [INFO] [<frozen importlib] - Trial 217 pruned.
[2025-11-19 08:56:27,438] [ERROR] [<frozen importlib] - Trial 217 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  43%|████▎     | 217/500 [34:25<55:43, 11.81s/it]Best trial: 140. Best value: 0.237476:  43%|████▎     | 217/500 [34:25<55:43, 11.81s/it]Best trial: 140. Best value: 0.237476:  44%|████▎     | 218/500 [34:25<58:00, 12.34s/it][2025-11-19 08:56:27,448] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.640755378470664
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   gamma: 0.23047207174968087
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   alpha: 0.49839901583986324
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   lambda: 0.7602864996691577
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   learning_rate: 0.0645358249467328
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   subsample: 0.514580089262665
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   colsample_bytree: 0.5120750234606011
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5287320224566456
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   colsample_bynode: 0.6954666246722447
[2025-11-19 08:56:27,448] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:56:27,449] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:56:27,449] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:56:27,449] [INFO] [<frozen importlib] -   scale_pos_weight: 7.640755378470664
[2025-11-19 08:56:27,525] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:56:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:56:27,438] Trial 217 pruned. 
[0]	train-logloss:0.73068	train-auc:0.63506	train-aucpr:0.22109	val-logloss:0.73086	val-auc:0.65353	val-aucpr:0.15307
[10]	train-logloss:0.69273	train-auc:0.68246	train-aucpr:0.29039	val-logloss:0.63041	val-auc:0.68841	val-aucpr:0.19895
[20]	train-logloss:0.67572	train-auc:0.69181	train-aucpr:0.30144	val-logloss:0.57256	val-auc:0.70333	val-aucpr:0.20899
[30]	train-logloss:0.66540	train-auc:0.70023	train-aucpr:0.30797	val-logloss:0.56282	val-auc:0.69997	val-aucpr:0.21703
[40]	train-logloss:0.65740	train-auc:0.70840	train-aucpr:0.31620	val-logloss:0.54240	val-auc:0.70872	val-aucpr:0.22682
[50]	train-logloss:0.65162	train-auc:0.71540	train-aucpr:0.32254	val-logloss:0.51135	val-auc:0.69561	val-aucpr:0.21700
[60]	train-logloss:0.64530	train-auc:0.72202	train-aucpr:0.32988	val-logloss:0.48697	val-auc:0.69083	val-aucpr:0.20041
[70]	train-logloss:0.64170	train-auc:0.72757	train-aucpr:0.33523	val-logloss:0.49999	val-auc:0.68434	val-aucpr:0.18762
[71]	train-logloss:0.64170	train-auc:0.72808	train-aucpr:0.33556	val-logloss:0.50008	val-auc:0.68493	val-aucpr:0.18817
[2025-11-19 08:56:27,741] [INFO] [<frozen importlib] - Training completed at iteration 42
[2025-11-19 08:56:27,741] [INFO] [<frozen importlib] - Best train loss: 0.6565
[2025-11-19 08:56:27,741] [INFO] [<frozen importlib] - Best val loss: 0.5397
[2025-11-19 08:56:27,741] [INFO] [<frozen importlib] - Best val AUC: 0.7104
[2025-11-19 08:56:27,741] [INFO] [<frozen importlib] - Best val AUCPR: 0.2297
[2025-11-19 08:56:27,746] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:56:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:56:41,707] [INFO] [<frozen importlib] - Optimal threshold: 0.5311
[2025-11-19 08:56:41,708] [INFO] [<frozen importlib] - Best f1: 0.2820
[2025-11-19 08:56:41,708] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:56:41,753] [INFO] [<frozen importlib] - Validation Results (threshold=0.5311):
[2025-11-19 08:56:41,753] [INFO] [<frozen importlib] -   Accuracy: 0.8903
[2025-11-19 08:56:41,753] [INFO] [<frozen importlib] -   Precision: 0.2836
[2025-11-19 08:56:41,753] [INFO] [<frozen importlib] -   Recall: 0.2803
[2025-11-19 08:56:41,753] [INFO] [<frozen importlib] -   F1 Score: 0.2820
[2025-11-19 08:56:41,753] [INFO] [<frozen importlib] -   AUROC: 0.7104
[2025-11-19 08:56:41,753] [INFO] [<frozen importlib] -   AUPRC: 0.2301
[2025-11-19 08:56:41,753] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:56:41,753] [INFO] [<frozen importlib] -     TN=16417, FP=1028
[2025-11-19 08:56:41,753] [INFO] [<frozen importlib] -     FN=1045, TP=407
[2025-11-19 08:56:41,776] [INFO] [<frozen importlib] - Trial 218: AUPRC=0.2301, F1=0.4615, Prec=0.4199, Rec=0.5124 | Optimizing auprc=0.2301
                                                                                        Best trial: 140. Best value: 0.237476:  44%|████▎     | 218/500 [34:39<58:00, 12.34s/it]Best trial: 140. Best value: 0.237476:  44%|████▎     | 218/500 [34:39<58:00, 12.34s/it]Best trial: 140. Best value: 0.237476:  44%|████▍     | 219/500 [34:39<1:00:36, 12.94s/it][2025-11-19 08:56:41,787] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.622253780894814
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   gamma: 0.2498087735234552
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   alpha: 0.44635781592595336
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   lambda: 0.8552573331296798
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   learning_rate: 0.07289004620808548
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   subsample: 0.5012234117236358
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   colsample_bytree: 0.5126058143374156
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5291836879322293
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   colsample_bynode: 0.6492350028909677
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:56:41,787] [INFO] [<frozen importlib] -   scale_pos_weight: 7.622253780894814
[2025-11-19 08:56:41,859] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:56:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:56:41,777] Trial 218 finished with value: 0.2301093666363327 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.23047207174968087, 'learning_rate': 0.0645358249467328, 'n_estimators': 450, 'alpha': 0.49839901583986324, 'lambda': 0.7602864996691577, 'subsample': 0.514580089262665, 'colsample_bytree': 0.5120750234606011, 'colsample_bylevel': 0.5287320224566456, 'colsample_bynode': 0.6954666246722447, 'scale_pos_weight': 7.640755378470664}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.72898	train-auc:0.63374	train-aucpr:0.22049	val-logloss:0.72530	val-auc:0.69652	val-aucpr:0.18440
[10]	train-logloss:0.68850	train-auc:0.68371	train-aucpr:0.28457	val-logloss:0.62504	val-auc:0.67969	val-aucpr:0.19204
[20]	train-logloss:0.67086	train-auc:0.69560	train-aucpr:0.30241	val-logloss:0.57728	val-auc:0.70561	val-aucpr:0.21846
[30]	train-logloss:0.66136	train-auc:0.70326	train-aucpr:0.30865	val-logloss:0.55765	val-auc:0.68994	val-aucpr:0.21163
[40]	train-logloss:0.65352	train-auc:0.71240	train-aucpr:0.31720	val-logloss:0.53170	val-auc:0.70643	val-aucpr:0.22140
[50]	train-logloss:0.64724	train-auc:0.71983	train-aucpr:0.32636	val-logloss:0.51434	val-auc:0.68856	val-aucpr:0.20609
[60]	train-logloss:0.64188	train-auc:0.72543	train-aucpr:0.33305	val-logloss:0.50885	val-auc:0.68837	val-aucpr:0.21005
[70]	train-logloss:0.63772	train-auc:0.73184	train-aucpr:0.34032	val-logloss:0.49677	val-auc:0.68515	val-aucpr:0.20241
[76]	train-logloss:0.63547	train-auc:0.73587	train-aucpr:0.34456	val-logloss:0.49585	val-auc:0.68216	val-aucpr:0.19976
[2025-11-19 08:56:42,085] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 08:56:42,085] [INFO] [<frozen importlib] - Best train loss: 0.6485
[2025-11-19 08:56:42,085] [INFO] [<frozen importlib] - Best val loss: 0.5180
[2025-11-19 08:56:42,085] [INFO] [<frozen importlib] - Best val AUC: 0.7049
[2025-11-19 08:56:42,085] [INFO] [<frozen importlib] - Best val AUCPR: 0.2226
[2025-11-19 08:56:42,091] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:56:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:56:56,574] [INFO] [<frozen importlib] - Optimal threshold: 0.5150
[2025-11-19 08:56:56,574] [INFO] [<frozen importlib] - Best f1: 0.2710
[2025-11-19 08:56:56,574] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:56:56,615] [INFO] [<frozen importlib] - Validation Results (threshold=0.5150):
[2025-11-19 08:56:56,615] [INFO] [<frozen importlib] -   Accuracy: 0.8909
[2025-11-19 08:56:56,615] [INFO] [<frozen importlib] -   Precision: 0.2785
[2025-11-19 08:56:56,615] [INFO] [<frozen importlib] -   Recall: 0.2638
[2025-11-19 08:56:56,615] [INFO] [<frozen importlib] -   F1 Score: 0.2710
[2025-11-19 08:56:56,615] [INFO] [<frozen importlib] -   AUROC: 0.7049
[2025-11-19 08:56:56,615] [INFO] [<frozen importlib] -   AUPRC: 0.2231
[2025-11-19 08:56:56,615] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:56:56,615] [INFO] [<frozen importlib] -     TN=16453, FP=992
[2025-11-19 08:56:56,615] [INFO] [<frozen importlib] -     FN=1069, TP=383
[2025-11-19 08:56:56,640] [INFO] [<frozen importlib] - Trial 219: AUPRC=0.2231, F1=0.4643, Prec=0.4269, Rec=0.5090 | Optimizing auprc=0.2231
[2025-11-19 08:56:56,641] [INFO] [<frozen importlib] - Trial 219 pruned.
[2025-11-19 08:56:56,641] [ERROR] [<frozen importlib] - Trial 219 failed with error: 
                                                                                          Best trial: 140. Best value: 0.237476:  44%|████▍     | 219/500 [34:54<1:00:36, 12.94s/it]Best trial: 140. Best value: 0.237476:  44%|████▍     | 219/500 [34:54<1:00:36, 12.94s/it]Best trial: 140. Best value: 0.237476:  44%|████▍     | 220/500 [34:54<1:03:05, 13.52s/it][2025-11-19 08:56:56,652] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.532835565336963
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   gamma: 0.278446520659442
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   alpha: 0.5091840951431524
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   lambda: 2.4018237412116643
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   learning_rate: 0.06649160477191338
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   subsample: 0.7571083282034463
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   colsample_bytree: 0.5118858344434121
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5316515784242436
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   colsample_bynode: 0.6946017670710595
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:56:56,652] [INFO] [<frozen importlib] -   scale_pos_weight: 8.532835565336963
[2025-11-19 08:56:56,727] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:56:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:56:56,641] Trial 219 pruned. 
[0]	train-logloss:0.77555	train-auc:0.63240	train-aucpr:0.22090	val-logloss:0.77841	val-auc:0.64376	val-aucpr:0.11473
[10]	train-logloss:0.73463	train-auc:0.68524	train-aucpr:0.29245	val-logloss:0.68053	val-auc:0.65115	val-aucpr:0.14270
[20]	train-logloss:0.71503	train-auc:0.69625	train-aucpr:0.30331	val-logloss:0.62124	val-auc:0.67422	val-aucpr:0.20276
[30]	train-logloss:0.70390	train-auc:0.70127	train-aucpr:0.31135	val-logloss:0.58691	val-auc:0.69158	val-aucpr:0.21216
[40]	train-logloss:0.69643	train-auc:0.70870	train-aucpr:0.31836	val-logloss:0.57133	val-auc:0.69849	val-aucpr:0.21104
[50]	train-logloss:0.69025	train-auc:0.71499	train-aucpr:0.32446	val-logloss:0.54254	val-auc:0.67918	val-aucpr:0.19809
[60]	train-logloss:0.68583	train-auc:0.72051	train-aucpr:0.32929	val-logloss:0.53158	val-auc:0.67538	val-aucpr:0.18849
[66]	train-logloss:0.68295	train-auc:0.72465	train-aucpr:0.33271	val-logloss:0.51553	val-auc:0.66803	val-aucpr:0.17541
[2025-11-19 08:56:56,931] [INFO] [<frozen importlib] - Training completed at iteration 37
[2025-11-19 08:56:56,931] [INFO] [<frozen importlib] - Best train loss: 0.6986
[2025-11-19 08:56:56,931] [INFO] [<frozen importlib] - Best val loss: 0.5749
[2025-11-19 08:56:56,931] [INFO] [<frozen importlib] - Best val AUC: 0.6971
[2025-11-19 08:56:56,931] [INFO] [<frozen importlib] - Best val AUCPR: 0.2126
[2025-11-19 08:56:56,936] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:56:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:57:08,306] [INFO] [<frozen importlib] - Optimal threshold: 0.5319
[2025-11-19 08:57:08,306] [INFO] [<frozen importlib] - Best f1: 0.2614
[2025-11-19 08:57:08,306] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:57:08,351] [INFO] [<frozen importlib] - Validation Results (threshold=0.5319):
[2025-11-19 08:57:08,351] [INFO] [<frozen importlib] -   Accuracy: 0.8732
[2025-11-19 08:57:08,351] [INFO] [<frozen importlib] -   Precision: 0.2366
[2025-11-19 08:57:08,351] [INFO] [<frozen importlib] -   Recall: 0.2920
[2025-11-19 08:57:08,351] [INFO] [<frozen importlib] -   F1 Score: 0.2614
[2025-11-19 08:57:08,351] [INFO] [<frozen importlib] -   AUROC: 0.6971
[2025-11-19 08:57:08,351] [INFO] [<frozen importlib] -   AUPRC: 0.2130
[2025-11-19 08:57:08,351] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:57:08,351] [INFO] [<frozen importlib] -     TN=16077, FP=1368
[2025-11-19 08:57:08,351] [INFO] [<frozen importlib] -     FN=1028, TP=424
[2025-11-19 08:57:08,378] [INFO] [<frozen importlib] - Trial 220: AUPRC=0.2130, F1=0.4368, Prec=0.3655, Rec=0.5427 | Optimizing auprc=0.2130
[2025-11-19 08:57:08,379] [INFO] [<frozen importlib] - Trial 220 pruned.
[2025-11-19 08:57:08,379] [ERROR] [<frozen importlib] - Trial 220 failed with error: 
                                                                                          Best trial: 140. Best value: 0.237476:  44%|████▍     | 220/500 [35:06<1:03:05, 13.52s/it]Best trial: 140. Best value: 0.237476:  44%|████▍     | 220/500 [35:06<1:03:05, 13.52s/it]Best trial: 140. Best value: 0.237476:  44%|████▍     | 221/500 [35:06<1:00:22, 12.98s/it][2025-11-19 08:57:08,389] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.008896272109842
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   gamma: 0.2187897425652024
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   alpha: 0.3667011753129797
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   lambda: 0.7535233435670184
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   learning_rate: 0.0593902066194308
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   subsample: 0.7706691672395608
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   colsample_bytree: 0.5256875897595856
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5205021166124116
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   colsample_bynode: 0.6812070342398303
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:57:08,389] [INFO] [<frozen importlib] -   scale_pos_weight: 8.008896272109842
[2025-11-19 08:57:08,465] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:57:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:57:08,379] Trial 220 pruned. 
[0]	train-logloss:0.75014	train-auc:0.63228	train-aucpr:0.22139	val-logloss:0.75078	val-auc:0.64524	val-aucpr:0.12193
[10]	train-logloss:0.71424	train-auc:0.68154	train-aucpr:0.28457	val-logloss:0.67186	val-auc:0.68738	val-aucpr:0.20237
[20]	train-logloss:0.69559	train-auc:0.69269	train-aucpr:0.30037	val-logloss:0.60733	val-auc:0.71210	val-aucpr:0.23034
[30]	train-logloss:0.68494	train-auc:0.69747	train-aucpr:0.30762	val-logloss:0.56650	val-auc:0.71428	val-aucpr:0.22954
[40]	train-logloss:0.67705	train-auc:0.70692	train-aucpr:0.31503	val-logloss:0.57073	val-auc:0.71056	val-aucpr:0.22015
[49]	train-logloss:0.67127	train-auc:0.71180	train-aucpr:0.32004	val-logloss:0.56137	val-auc:0.70889	val-aucpr:0.22196
[2025-11-19 08:57:08,629] [INFO] [<frozen importlib] - Training completed at iteration 20
[2025-11-19 08:57:08,629] [INFO] [<frozen importlib] - Best train loss: 0.6956
[2025-11-19 08:57:08,629] [INFO] [<frozen importlib] - Best val loss: 0.6073
[2025-11-19 08:57:08,629] [INFO] [<frozen importlib] - Best val AUC: 0.7121
[2025-11-19 08:57:08,629] [INFO] [<frozen importlib] - Best val AUCPR: 0.2303
[2025-11-19 08:57:08,635] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:57:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:57:14,148] [INFO] [<frozen importlib] - Optimal threshold: 0.5308
[2025-11-19 08:57:14,148] [INFO] [<frozen importlib] - Best f1: 0.2782
[2025-11-19 08:57:14,148] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:57:14,195] [INFO] [<frozen importlib] - Validation Results (threshold=0.5308):
[2025-11-19 08:57:14,195] [INFO] [<frozen importlib] -   Accuracy: 0.8929
[2025-11-19 08:57:14,195] [INFO] [<frozen importlib] -   Precision: 0.2885
[2025-11-19 08:57:14,195] [INFO] [<frozen importlib] -   Recall: 0.2686
[2025-11-19 08:57:14,195] [INFO] [<frozen importlib] -   F1 Score: 0.2782
[2025-11-19 08:57:14,195] [INFO] [<frozen importlib] -   AUROC: 0.7121
[2025-11-19 08:57:14,195] [INFO] [<frozen importlib] -   AUPRC: 0.2304
[2025-11-19 08:57:14,195] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:57:14,195] [INFO] [<frozen importlib] -     TN=16483, FP=962
[2025-11-19 08:57:14,195] [INFO] [<frozen importlib] -     FN=1062, TP=390
[2025-11-19 08:57:14,219] [INFO] [<frozen importlib] - Trial 221: AUPRC=0.2304, F1=0.4446, Prec=0.4177, Rec=0.4752 | Optimizing auprc=0.2304
                                                                                          Best trial: 140. Best value: 0.237476:  44%|████▍     | 221/500 [35:12<1:00:22, 12.98s/it]Best trial: 140. Best value: 0.237476:  44%|████▍     | 221/500 [35:12<1:00:22, 12.98s/it]Best trial: 140. Best value: 0.237476:  44%|████▍     | 222/500 [35:12<50:13, 10.84s/it]  [2025-11-19 08:57:14,230] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.895162197622303
[2025-11-19 08:57:14,230] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:57:14,230] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:57:14,230] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:57:14,230] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:57:14,230] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:57:14,230] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:57:14,230] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   gamma: 0.22081613617560258
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   alpha: 0.43458174135078054
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   lambda: 0.7662711178461665
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   learning_rate: 0.06463944574451579
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   subsample: 0.5597358124420468
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   colsample_bytree: 0.5227793495659144
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5211199838545968
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   colsample_bynode: 0.6986334644645184
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:57:14,231] [INFO] [<frozen importlib] -   scale_pos_weight: 7.895162197622303
[2025-11-19 08:57:14,310] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:57:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:57:14,220] Trial 221 finished with value: 0.23044236829521905 and parameters: {'max_depth': 4, 'min_child_weight': 4, 'gamma': 0.2187897425652024, 'learning_rate': 0.0593902066194308, 'n_estimators': 450, 'alpha': 0.3667011753129797, 'lambda': 0.7535233435670184, 'subsample': 0.7706691672395608, 'colsample_bytree': 0.5256875897595856, 'colsample_bylevel': 0.5205021166124116, 'colsample_bynode': 0.6812070342398303, 'scale_pos_weight': 8.008896272109842}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.74375	train-auc:0.63368	train-aucpr:0.21917	val-logloss:0.74572	val-auc:0.65010	val-aucpr:0.13491
[10]	train-logloss:0.70487	train-auc:0.68644	train-aucpr:0.28738	val-logloss:0.64949	val-auc:0.65815	val-aucpr:0.18819
[20]	train-logloss:0.68593	train-auc:0.69363	train-aucpr:0.30094	val-logloss:0.60070	val-auc:0.69359	val-aucpr:0.21122
[30]	train-logloss:0.67581	train-auc:0.69970	train-aucpr:0.30851	val-logloss:0.58335	val-auc:0.69627	val-aucpr:0.21109
[40]	train-logloss:0.66854	train-auc:0.70663	train-aucpr:0.31561	val-logloss:0.55730	val-auc:0.69938	val-aucpr:0.21212
[50]	train-logloss:0.66256	train-auc:0.71413	train-aucpr:0.32263	val-logloss:0.54266	val-auc:0.69443	val-aucpr:0.19249
[60]	train-logloss:0.65714	train-auc:0.72031	train-aucpr:0.32885	val-logloss:0.53068	val-auc:0.68882	val-aucpr:0.18986
[64]	train-logloss:0.65546	train-auc:0.72217	train-aucpr:0.33146	val-logloss:0.52375	val-auc:0.68080	val-aucpr:0.17671
[2025-11-19 08:57:14,508] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 08:57:14,508] [INFO] [<frozen importlib] - Best train loss: 0.6724
[2025-11-19 08:57:14,508] [INFO] [<frozen importlib] - Best val loss: 0.5793
[2025-11-19 08:57:14,508] [INFO] [<frozen importlib] - Best val AUC: 0.6995
[2025-11-19 08:57:14,508] [INFO] [<frozen importlib] - Best val AUCPR: 0.2159
[2025-11-19 08:57:14,513] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:57:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:57:26,084] [INFO] [<frozen importlib] - Optimal threshold: 0.5344
[2025-11-19 08:57:26,084] [INFO] [<frozen importlib] - Best f1: 0.2721
[2025-11-19 08:57:26,084] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:57:26,127] [INFO] [<frozen importlib] - Validation Results (threshold=0.5344):
[2025-11-19 08:57:26,128] [INFO] [<frozen importlib] -   Accuracy: 0.8884
[2025-11-19 08:57:26,128] [INFO] [<frozen importlib] -   Precision: 0.2729
[2025-11-19 08:57:26,128] [INFO] [<frozen importlib] -   Recall: 0.2713
[2025-11-19 08:57:26,128] [INFO] [<frozen importlib] -   F1 Score: 0.2721
[2025-11-19 08:57:26,128] [INFO] [<frozen importlib] -   AUROC: 0.6995
[2025-11-19 08:57:26,128] [INFO] [<frozen importlib] -   AUPRC: 0.2163
[2025-11-19 08:57:26,128] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:57:26,128] [INFO] [<frozen importlib] -     TN=16395, FP=1050
[2025-11-19 08:57:26,128] [INFO] [<frozen importlib] -     FN=1058, TP=394
[2025-11-19 08:57:26,151] [INFO] [<frozen importlib] - Trial 222: AUPRC=0.2163, F1=0.4421, Prec=0.4034, Rec=0.4890 | Optimizing auprc=0.2163
[2025-11-19 08:57:26,151] [INFO] [<frozen importlib] - Trial 222 pruned.
[2025-11-19 08:57:26,151] [ERROR] [<frozen importlib] - Trial 222 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  44%|████▍     | 222/500 [35:24<50:13, 10.84s/it]Best trial: 140. Best value: 0.237476:  44%|████▍     | 222/500 [35:24<50:13, 10.84s/it]Best trial: 140. Best value: 0.237476:  45%|████▍     | 223/500 [35:24<51:33, 11.17s/it][2025-11-19 08:57:26,162] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.148298910318514
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   gamma: 0.23937314872677473
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   alpha: 0.33947699229547995
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   lambda: 0.9437134220026261
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   learning_rate: 0.05614834290449908
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   subsample: 0.768960507205793
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   colsample_bytree: 0.5336917900969984
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5393866086513961
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   colsample_bynode: 0.6779768609392212
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:57:26,162] [INFO] [<frozen importlib] -   scale_pos_weight: 8.148298910318514
[2025-11-19 08:57:26,233] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:57:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:57:26,152] Trial 222 pruned. 
[0]	train-logloss:0.75739	train-auc:0.63250	train-aucpr:0.22517	val-logloss:0.75914	val-auc:0.64906	val-aucpr:0.13868
[10]	train-logloss:0.72159	train-auc:0.68188	train-aucpr:0.29019	val-logloss:0.65936	val-auc:0.68979	val-aucpr:0.21136
[20]	train-logloss:0.70287	train-auc:0.69095	train-aucpr:0.30292	val-logloss:0.62637	val-auc:0.68970	val-aucpr:0.21112
[30]	train-logloss:0.69148	train-auc:0.69654	train-aucpr:0.31145	val-logloss:0.59681	val-auc:0.70339	val-aucpr:0.22456
[40]	train-logloss:0.68327	train-auc:0.70505	train-aucpr:0.31923	val-logloss:0.56275	val-auc:0.70066	val-aucpr:0.22055
[50]	train-logloss:0.67724	train-auc:0.71096	train-aucpr:0.32367	val-logloss:0.55924	val-auc:0.69275	val-aucpr:0.20766
[58]	train-logloss:0.67356	train-auc:0.71486	train-aucpr:0.32709	val-logloss:0.55301	val-auc:0.69265	val-aucpr:0.20941
[2025-11-19 08:57:26,417] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:57:26,417] [INFO] [<frozen importlib] - Best train loss: 0.6925
[2025-11-19 08:57:26,417] [INFO] [<frozen importlib] - Best val loss: 0.5995
[2025-11-19 08:57:26,417] [INFO] [<frozen importlib] - Best val AUC: 0.7039
[2025-11-19 08:57:26,417] [INFO] [<frozen importlib] - Best val AUCPR: 0.2248
[2025-11-19 08:57:26,421] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:57:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:57:35,378] [INFO] [<frozen importlib] - Optimal threshold: 0.5303
[2025-11-19 08:57:35,378] [INFO] [<frozen importlib] - Best f1: 0.2726
[2025-11-19 08:57:35,378] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:57:35,429] [INFO] [<frozen importlib] - Validation Results (threshold=0.5303):
[2025-11-19 08:57:35,429] [INFO] [<frozen importlib] -   Accuracy: 0.8856
[2025-11-19 08:57:35,429] [INFO] [<frozen importlib] -   Precision: 0.2666
[2025-11-19 08:57:35,429] [INFO] [<frozen importlib] -   Recall: 0.2789
[2025-11-19 08:57:35,429] [INFO] [<frozen importlib] -   F1 Score: 0.2726
[2025-11-19 08:57:35,429] [INFO] [<frozen importlib] -   AUROC: 0.7039
[2025-11-19 08:57:35,429] [INFO] [<frozen importlib] -   AUPRC: 0.2252
[2025-11-19 08:57:35,429] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:57:35,429] [INFO] [<frozen importlib] -     TN=16331, FP=1114
[2025-11-19 08:57:35,429] [INFO] [<frozen importlib] -     FN=1047, TP=405
[2025-11-19 08:57:35,452] [INFO] [<frozen importlib] - Trial 223: AUPRC=0.2252, F1=0.4339, Prec=0.3896, Rec=0.4897 | Optimizing auprc=0.2252
[2025-11-19 08:57:35,453] [INFO] [<frozen importlib] - Trial 223 pruned.
[2025-11-19 08:57:35,453] [ERROR] [<frozen importlib] - Trial 223 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  45%|████▍     | 223/500 [35:33<51:33, 11.17s/it]Best trial: 140. Best value: 0.237476:  45%|████▍     | 223/500 [35:33<51:33, 11.17s/it]Best trial: 140. Best value: 0.237476:  45%|████▍     | 224/500 [35:33<48:47, 10.61s/it][2025-11-19 08:57:35,464] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.496656012531515
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   gamma: 0.1950178735491516
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   alpha: 0.36510212509190015
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   lambda: 0.5304976279412252
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   learning_rate: 0.06884945502906643
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   subsample: 0.5210799847776675
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   colsample_bytree: 0.5093925480920258
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5223303079984221
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   colsample_bynode: 0.7138592614916797
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:57:35,464] [INFO] [<frozen importlib] -   scale_pos_weight: 7.496656012531515
[2025-11-19 08:57:35,539] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:57:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:57:35,453] Trial 223 pruned. 
[0]	train-logloss:0.72178	train-auc:0.64955	train-aucpr:0.22825	val-logloss:0.72156	val-auc:0.65467	val-aucpr:0.12822
[10]	train-logloss:0.67733	train-auc:0.69649	train-aucpr:0.30773	val-logloss:0.61194	val-auc:0.70646	val-aucpr:0.21242
[20]	train-logloss:0.65516	train-auc:0.71422	train-aucpr:0.32518	val-logloss:0.56587	val-auc:0.69118	val-aucpr:0.19233
[30]	train-logloss:0.64286	train-auc:0.72447	train-aucpr:0.33583	val-logloss:0.54720	val-auc:0.69096	val-aucpr:0.19084
[40]	train-logloss:0.63417	train-auc:0.73372	train-aucpr:0.34483	val-logloss:0.52817	val-auc:0.68989	val-aucpr:0.19110
[2025-11-19 08:57:35,721] [INFO] [<frozen importlib] - Training completed at iteration 10
[2025-11-19 08:57:35,721] [INFO] [<frozen importlib] - Best train loss: 0.6773
[2025-11-19 08:57:35,721] [INFO] [<frozen importlib] - Best val loss: 0.6119
[2025-11-19 08:57:35,721] [INFO] [<frozen importlib] - Best val AUC: 0.7065
[2025-11-19 08:57:35,721] [INFO] [<frozen importlib] - Best val AUCPR: 0.2124
[2025-11-19 08:57:35,727] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:57:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:57:39,456] [INFO] [<frozen importlib] - Optimal threshold: 0.5191
[2025-11-19 08:57:39,456] [INFO] [<frozen importlib] - Best f1: 0.2520
[2025-11-19 08:57:39,456] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:57:39,499] [INFO] [<frozen importlib] - Validation Results (threshold=0.5191):
[2025-11-19 08:57:39,499] [INFO] [<frozen importlib] -   Accuracy: 0.8737
[2025-11-19 08:57:39,499] [INFO] [<frozen importlib] -   Precision: 0.2312
[2025-11-19 08:57:39,499] [INFO] [<frozen importlib] -   Recall: 0.2769
[2025-11-19 08:57:39,499] [INFO] [<frozen importlib] -   F1 Score: 0.2520
[2025-11-19 08:57:39,499] [INFO] [<frozen importlib] -   AUROC: 0.7065
[2025-11-19 08:57:39,499] [INFO] [<frozen importlib] -   AUPRC: 0.2125
[2025-11-19 08:57:39,499] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:57:39,499] [INFO] [<frozen importlib] -     TN=16108, FP=1337
[2025-11-19 08:57:39,499] [INFO] [<frozen importlib] -     FN=1050, TP=402
[2025-11-19 08:57:39,521] [INFO] [<frozen importlib] - Trial 224: AUPRC=0.2125, F1=0.4428, Prec=0.3723, Rec=0.5461 | Optimizing auprc=0.2125
                                                                                        Best trial: 140. Best value: 0.237476:  45%|████▍     | 224/500 [35:37<48:47, 10.61s/it]Best trial: 140. Best value: 0.237476:  45%|████▍     | 224/500 [35:37<48:47, 10.61s/it]Best trial: 140. Best value: 0.237476:  45%|████▌     | 225/500 [35:37<39:37,  8.65s/it][2025-11-19 08:57:39,532] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.8903342191360535
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   gamma: 0.2594837299490291
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   alpha: 0.5527215579018738
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   lambda: 0.6332699489258762
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   learning_rate: 0.06344986737014317
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   subsample: 0.7760908444974964
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   colsample_bytree: 0.5206636283216621
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5316886962118117
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   colsample_bynode: 0.7162171062433942
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:57:39,532] [INFO] [<frozen importlib] -   scale_pos_weight: 5.8903342191360535
[2025-11-19 08:57:39,605] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:57:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:57:39,522] Trial 224 finished with value: 0.21250683692592767 and parameters: {'max_depth': 5, 'min_child_weight': 3, 'gamma': 0.1950178735491516, 'learning_rate': 0.06884945502906643, 'n_estimators': 450, 'alpha': 0.36510212509190015, 'lambda': 0.5304976279412252, 'subsample': 0.5210799847776675, 'colsample_bytree': 0.5093925480920258, 'colsample_bylevel': 0.5223303079984221, 'colsample_bynode': 0.7138592614916797, 'scale_pos_weight': 7.496656012531515}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.63642	train-auc:0.63279	train-aucpr:0.22589	val-logloss:0.62449	val-auc:0.65105	val-aucpr:0.13442
[10]	train-logloss:0.60611	train-auc:0.68316	train-aucpr:0.29138	val-logloss:0.55667	val-auc:0.66151	val-aucpr:0.18144
[20]	train-logloss:0.59047	train-auc:0.69207	train-aucpr:0.30379	val-logloss:0.50523	val-auc:0.68415	val-aucpr:0.20955
[30]	train-logloss:0.58165	train-auc:0.69676	train-aucpr:0.31030	val-logloss:0.47811	val-auc:0.70471	val-aucpr:0.22340
[40]	train-logloss:0.57533	train-auc:0.70515	train-aucpr:0.31783	val-logloss:0.47228	val-auc:0.71231	val-aucpr:0.22454
[50]	train-logloss:0.57054	train-auc:0.71130	train-aucpr:0.32279	val-logloss:0.46285	val-auc:0.70387	val-aucpr:0.21821
[60]	train-logloss:0.56627	train-auc:0.71777	train-aucpr:0.33028	val-logloss:0.43335	val-auc:0.69138	val-aucpr:0.20329
[68]	train-logloss:0.56348	train-auc:0.72325	train-aucpr:0.33543	val-logloss:0.42931	val-auc:0.68201	val-aucpr:0.17629
[2025-11-19 08:57:39,814] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 08:57:39,814] [INFO] [<frozen importlib] - Best train loss: 0.5759
[2025-11-19 08:57:39,814] [INFO] [<frozen importlib] - Best val loss: 0.4642
[2025-11-19 08:57:39,814] [INFO] [<frozen importlib] - Best val AUC: 0.7125
[2025-11-19 08:57:39,814] [INFO] [<frozen importlib] - Best val AUCPR: 0.2254
[2025-11-19 08:57:39,819] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:57:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:57:52,081] [INFO] [<frozen importlib] - Optimal threshold: 0.4393
[2025-11-19 08:57:52,081] [INFO] [<frozen importlib] - Best f1: 0.2725
[2025-11-19 08:57:52,081] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:57:52,124] [INFO] [<frozen importlib] - Validation Results (threshold=0.4393):
[2025-11-19 08:57:52,124] [INFO] [<frozen importlib] -   Accuracy: 0.8856
[2025-11-19 08:57:52,124] [INFO] [<frozen importlib] -   Precision: 0.2664
[2025-11-19 08:57:52,124] [INFO] [<frozen importlib] -   Recall: 0.2789
[2025-11-19 08:57:52,124] [INFO] [<frozen importlib] -   F1 Score: 0.2725
[2025-11-19 08:57:52,124] [INFO] [<frozen importlib] -   AUROC: 0.7125
[2025-11-19 08:57:52,124] [INFO] [<frozen importlib] -   AUPRC: 0.2258
[2025-11-19 08:57:52,124] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:57:52,124] [INFO] [<frozen importlib] -     TN=16330, FP=1115
[2025-11-19 08:57:52,124] [INFO] [<frozen importlib] -     FN=1047, TP=405
[2025-11-19 08:57:52,147] [INFO] [<frozen importlib] - Trial 225: AUPRC=0.2258, F1=0.4371, Prec=0.3917, Rec=0.4945 | Optimizing auprc=0.2258
                                                                                        Best trial: 140. Best value: 0.237476:  45%|████▌     | 225/500 [35:50<39:37,  8.65s/it]Best trial: 140. Best value: 0.237476:  45%|████▌     | 225/500 [35:50<39:37,  8.65s/it]Best trial: 140. Best value: 0.237476:  45%|████▌     | 226/500 [35:50<44:56,  9.84s/it][2025-11-19 08:57:52,158] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.812718573642617
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   gamma: 0.3035497575675124
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   alpha: 0.38261551667545346
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   lambda: 1.9479893205922363
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   learning_rate: 0.039618104873033376
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   subsample: 0.6028095995344732
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   colsample_bytree: 0.5250233866024044
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5471635330108314
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   colsample_bynode: 0.7008183882598976
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:57:52,158] [INFO] [<frozen importlib] -   scale_pos_weight: 7.812718573642617
[2025-11-19 08:57:52,231] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:57:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:57:52,148] Trial 225 finished with value: 0.22578961764801003 and parameters: {'max_depth': 4, 'min_child_weight': 4, 'gamma': 0.2594837299490291, 'learning_rate': 0.06344986737014317, 'n_estimators': 450, 'alpha': 0.5527215579018738, 'lambda': 0.6332699489258762, 'subsample': 0.7760908444974964, 'colsample_bytree': 0.5206636283216621, 'colsample_bylevel': 0.5316886962118117, 'colsample_bynode': 0.7162171062433942, 'scale_pos_weight': 5.8903342191360535}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.74155	train-auc:0.62753	train-aucpr:0.20902	val-logloss:0.74476	val-auc:0.61684	val-aucpr:0.13900
[10]	train-logloss:0.71407	train-auc:0.68071	train-aucpr:0.28127	val-logloss:0.67884	val-auc:0.68021	val-aucpr:0.20104
[20]	train-logloss:0.69684	train-auc:0.68804	train-aucpr:0.29863	val-logloss:0.62869	val-auc:0.69183	val-aucpr:0.21861
[30]	train-logloss:0.68585	train-auc:0.69142	train-aucpr:0.30541	val-logloss:0.60716	val-auc:0.70510	val-aucpr:0.22211
[40]	train-logloss:0.67785	train-auc:0.69721	train-aucpr:0.30955	val-logloss:0.57807	val-auc:0.70821	val-aucpr:0.22388
[50]	train-logloss:0.67178	train-auc:0.70191	train-aucpr:0.31263	val-logloss:0.56819	val-auc:0.70011	val-aucpr:0.22142
[60]	train-logloss:0.66676	train-auc:0.70629	train-aucpr:0.31664	val-logloss:0.56203	val-auc:0.70270	val-aucpr:0.21668
[68]	train-logloss:0.66388	train-auc:0.70957	train-aucpr:0.32035	val-logloss:0.55165	val-auc:0.70587	val-aucpr:0.21862
[2025-11-19 08:57:52,439] [INFO] [<frozen importlib] - Training completed at iteration 38
[2025-11-19 08:57:52,439] [INFO] [<frozen importlib] - Best train loss: 0.6791
[2025-11-19 08:57:52,439] [INFO] [<frozen importlib] - Best val loss: 0.5828
[2025-11-19 08:57:52,439] [INFO] [<frozen importlib] - Best val AUC: 0.7065
[2025-11-19 08:57:52,439] [INFO] [<frozen importlib] - Best val AUCPR: 0.2270
[2025-11-19 08:57:52,445] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:57:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:58:04,345] [INFO] [<frozen importlib] - Optimal threshold: 0.5241
[2025-11-19 08:58:04,346] [INFO] [<frozen importlib] - Best f1: 0.2737
[2025-11-19 08:58:04,346] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:58:04,390] [INFO] [<frozen importlib] - Validation Results (threshold=0.5241):
[2025-11-19 08:58:04,390] [INFO] [<frozen importlib] -   Accuracy: 0.8798
[2025-11-19 08:58:04,390] [INFO] [<frozen importlib] -   Precision: 0.2554
[2025-11-19 08:58:04,390] [INFO] [<frozen importlib] -   Recall: 0.2948
[2025-11-19 08:58:04,390] [INFO] [<frozen importlib] -   F1 Score: 0.2737
[2025-11-19 08:58:04,390] [INFO] [<frozen importlib] -   AUROC: 0.7065
[2025-11-19 08:58:04,390] [INFO] [<frozen importlib] -   AUPRC: 0.2274
[2025-11-19 08:58:04,390] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:58:04,390] [INFO] [<frozen importlib] -     TN=16197, FP=1248
[2025-11-19 08:58:04,390] [INFO] [<frozen importlib] -     FN=1024, TP=428
[2025-11-19 08:58:04,419] [INFO] [<frozen importlib] - Trial 226: AUPRC=0.2274, F1=0.4447, Prec=0.3822, Rec=0.5317 | Optimizing auprc=0.2274
                                                                                        Best trial: 140. Best value: 0.237476:  45%|████▌     | 226/500 [36:02<44:56,  9.84s/it]Best trial: 140. Best value: 0.237476:  45%|████▌     | 226/500 [36:02<44:56,  9.84s/it]Best trial: 140. Best value: 0.237476:  45%|████▌     | 227/500 [36:02<48:05, 10.57s/it][2025-11-19 08:58:04,429] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.377764819749531
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   gamma: 0.5038620001685744
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   alpha: 0.6006896635137295
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   lambda: 2.1550960860557002
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   learning_rate: 0.05817137602765673
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   subsample: 0.7508228558859082
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   colsample_bytree: 0.5090506752701612
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   colsample_bylevel: 0.561581726528737
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   colsample_bynode: 0.6855466434915507
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:58:04,430] [INFO] [<frozen importlib] -   scale_pos_weight: 8.377764819749531
[2025-11-19 08:58:04,506] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:58:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:58:04,419] Trial 226 finished with value: 0.22738749024833693 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.3035497575675124, 'learning_rate': 0.039618104873033376, 'n_estimators': 450, 'alpha': 0.38261551667545346, 'lambda': 1.9479893205922363, 'subsample': 0.6028095995344732, 'colsample_bytree': 0.5250233866024044, 'colsample_bylevel': 0.5471635330108314, 'colsample_bynode': 0.7008183882598976, 'scale_pos_weight': 7.812718573642617}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.76860	train-auc:0.63416	train-aucpr:0.22951	val-logloss:0.77368	val-auc:0.63844	val-aucpr:0.14439
[10]	train-logloss:0.73237	train-auc:0.68473	train-aucpr:0.28638	val-logloss:0.68702	val-auc:0.69219	val-aucpr:0.20245
[20]	train-logloss:0.71306	train-auc:0.69272	train-aucpr:0.30049	val-logloss:0.62263	val-auc:0.71378	val-aucpr:0.22396
[30]	train-logloss:0.70126	train-auc:0.69792	train-aucpr:0.30959	val-logloss:0.59551	val-auc:0.71319	val-aucpr:0.23287
[40]	train-logloss:0.69317	train-auc:0.70503	train-aucpr:0.31610	val-logloss:0.56552	val-auc:0.71063	val-aucpr:0.22973
[50]	train-logloss:0.68728	train-auc:0.71011	train-aucpr:0.32177	val-logloss:0.56194	val-auc:0.69893	val-aucpr:0.21959
[58]	train-logloss:0.68357	train-auc:0.71478	train-aucpr:0.32622	val-logloss:0.55476	val-auc:0.69334	val-aucpr:0.21110
[2025-11-19 08:58:04,694] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:58:04,694] [INFO] [<frozen importlib] - Best train loss: 0.7023
[2025-11-19 08:58:04,694] [INFO] [<frozen importlib] - Best val loss: 0.5863
[2025-11-19 08:58:04,694] [INFO] [<frozen importlib] - Best val AUC: 0.7151
[2025-11-19 08:58:04,694] [INFO] [<frozen importlib] - Best val AUCPR: 0.2344
[2025-11-19 08:58:04,699] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:58:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:58:14,584] [INFO] [<frozen importlib] - Optimal threshold: 0.5384
[2025-11-19 08:58:14,585] [INFO] [<frozen importlib] - Best f1: 0.2826
[2025-11-19 08:58:14,585] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:58:14,630] [INFO] [<frozen importlib] - Validation Results (threshold=0.5384):
[2025-11-19 08:58:14,630] [INFO] [<frozen importlib] -   Accuracy: 0.9038
[2025-11-19 08:58:14,630] [INFO] [<frozen importlib] -   Precision: 0.3309
[2025-11-19 08:58:14,630] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 08:58:14,630] [INFO] [<frozen importlib] -   F1 Score: 0.2826
[2025-11-19 08:58:14,630] [INFO] [<frozen importlib] -   AUROC: 0.7151
[2025-11-19 08:58:14,630] [INFO] [<frozen importlib] -   AUPRC: 0.2348
[2025-11-19 08:58:14,630] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:58:14,630] [INFO] [<frozen importlib] -     TN=16721, FP=724
[2025-11-19 08:58:14,630] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 08:58:14,653] [INFO] [<frozen importlib] - Trial 227: AUPRC=0.2348, F1=0.4595, Prec=0.4727, Rec=0.4470 | Optimizing auprc=0.2348
                                                                                        Best trial: 140. Best value: 0.237476:  45%|████▌     | 227/500 [36:12<48:05, 10.57s/it]Best trial: 140. Best value: 0.237476:  45%|████▌     | 227/500 [36:12<48:05, 10.57s/it]Best trial: 140. Best value: 0.237476:  46%|████▌     | 228/500 [36:12<47:27, 10.47s/it][2025-11-19 08:58:14,667] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.389042384550557
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   gamma: 0.5016688926866066
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   alpha: 0.4842975938982501
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   lambda: 2.157630131069241
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   learning_rate: 0.058526336302956505
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   subsample: 0.7480946207347432
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   colsample_bytree: 0.5079817079460941
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5752341440526783
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   colsample_bynode: 0.6874677378492507
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:58:14,667] [INFO] [<frozen importlib] -   scale_pos_weight: 8.389042384550557
[2025-11-19 08:58:14,741] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:58:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:58:14,654] Trial 227 finished with value: 0.2347898727589684 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.5038620001685744, 'learning_rate': 0.05817137602765673, 'n_estimators': 350, 'alpha': 0.6006896635137295, 'lambda': 2.1550960860557002, 'subsample': 0.7508228558859082, 'colsample_bytree': 0.5090506752701612, 'colsample_bylevel': 0.561581726528737, 'colsample_bynode': 0.6855466434915507, 'scale_pos_weight': 8.377764819749531}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.76906	train-auc:0.63373	train-aucpr:0.22773	val-logloss:0.77361	val-auc:0.63845	val-aucpr:0.14521
[10]	train-logloss:0.73243	train-auc:0.67891	train-aucpr:0.28860	val-logloss:0.68174	val-auc:0.66995	val-aucpr:0.15094
[20]	train-logloss:0.71253	train-auc:0.69481	train-aucpr:0.30489	val-logloss:0.62827	val-auc:0.68586	val-aucpr:0.19639
[30]	train-logloss:0.70095	train-auc:0.70073	train-aucpr:0.31363	val-logloss:0.58995	val-auc:0.69720	val-aucpr:0.21526
[40]	train-logloss:0.69261	train-auc:0.70802	train-aucpr:0.32062	val-logloss:0.56706	val-auc:0.70851	val-aucpr:0.22079
[50]	train-logloss:0.68659	train-auc:0.71420	train-aucpr:0.32592	val-logloss:0.55190	val-auc:0.68781	val-aucpr:0.20478
[60]	train-logloss:0.68171	train-auc:0.71906	train-aucpr:0.33053	val-logloss:0.54768	val-auc:0.69120	val-aucpr:0.20635
[70]	train-logloss:0.67768	train-auc:0.72506	train-aucpr:0.33590	val-logloss:0.51815	val-auc:0.67552	val-aucpr:0.18229
[2025-11-19 08:58:14,955] [INFO] [<frozen importlib] - Training completed at iteration 40
[2025-11-19 08:58:14,955] [INFO] [<frozen importlib] - Best train loss: 0.6926
[2025-11-19 08:58:14,955] [INFO] [<frozen importlib] - Best val loss: 0.5671
[2025-11-19 08:58:14,955] [INFO] [<frozen importlib] - Best val AUC: 0.7085
[2025-11-19 08:58:14,955] [INFO] [<frozen importlib] - Best val AUCPR: 0.2208
[2025-11-19 08:58:14,960] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:58:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:58:27,564] [INFO] [<frozen importlib] - Optimal threshold: 0.5376
[2025-11-19 08:58:27,564] [INFO] [<frozen importlib] - Best f1: 0.2685
[2025-11-19 08:58:27,565] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:58:27,609] [INFO] [<frozen importlib] - Validation Results (threshold=0.5376):
[2025-11-19 08:58:27,610] [INFO] [<frozen importlib] -   Accuracy: 0.8916
[2025-11-19 08:58:27,610] [INFO] [<frozen importlib] -   Precision: 0.2787
[2025-11-19 08:58:27,610] [INFO] [<frozen importlib] -   Recall: 0.2590
[2025-11-19 08:58:27,610] [INFO] [<frozen importlib] -   F1 Score: 0.2685
[2025-11-19 08:58:27,610] [INFO] [<frozen importlib] -   AUROC: 0.7085
[2025-11-19 08:58:27,610] [INFO] [<frozen importlib] -   AUPRC: 0.2213
[2025-11-19 08:58:27,610] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:58:27,610] [INFO] [<frozen importlib] -     TN=16472, FP=973
[2025-11-19 08:58:27,610] [INFO] [<frozen importlib] -     FN=1076, TP=376
[2025-11-19 08:58:27,633] [INFO] [<frozen importlib] - Trial 228: AUPRC=0.2213, F1=0.4485, Prec=0.4188, Rec=0.4828 | Optimizing auprc=0.2213
[2025-11-19 08:58:27,634] [INFO] [<frozen importlib] - Trial 228 pruned.
[2025-11-19 08:58:27,634] [ERROR] [<frozen importlib] - Trial 228 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  46%|████▌     | 228/500 [36:25<47:27, 10.47s/it]Best trial: 140. Best value: 0.237476:  46%|████▌     | 228/500 [36:25<47:27, 10.47s/it]Best trial: 140. Best value: 0.237476:  46%|████▌     | 229/500 [36:25<50:41, 11.22s/it][2025-11-19 08:58:27,647] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.864205335098973
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   gamma: 0.14929809710061615
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   alpha: 0.30037181669428176
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   lambda: 2.0806364819630985
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   learning_rate: 0.055745727637265374
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   subsample: 0.7611489615721733
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   colsample_bytree: 0.5012520332146105
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5527972952247551
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   colsample_bynode: 0.6925066506139621
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:58:27,647] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:58:27,648] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:58:27,648] [INFO] [<frozen importlib] -   scale_pos_weight: 7.864205335098973
[2025-11-19 08:58:27,724] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:58:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:58:27,634] Trial 228 pruned. 
[0]	train-logloss:0.74256	train-auc:0.63714	train-aucpr:0.22382	val-logloss:0.74421	val-auc:0.64548	val-aucpr:0.14602
[10]	train-logloss:0.70938	train-auc:0.68015	train-aucpr:0.28152	val-logloss:0.66876	val-auc:0.66390	val-aucpr:0.14312
[20]	train-logloss:0.69072	train-auc:0.69218	train-aucpr:0.29624	val-logloss:0.60605	val-auc:0.69949	val-aucpr:0.22076
[30]	train-logloss:0.67976	train-auc:0.69902	train-aucpr:0.30372	val-logloss:0.57135	val-auc:0.69610	val-aucpr:0.21790
[40]	train-logloss:0.67163	train-auc:0.70556	train-aucpr:0.31342	val-logloss:0.55711	val-auc:0.70283	val-aucpr:0.21626
[50]	train-logloss:0.66573	train-auc:0.71142	train-aucpr:0.31855	val-logloss:0.55022	val-auc:0.70389	val-aucpr:0.21829
[51]	train-logloss:0.66517	train-auc:0.71227	train-aucpr:0.31971	val-logloss:0.54582	val-auc:0.70473	val-aucpr:0.21811
[2025-11-19 08:58:27,889] [INFO] [<frozen importlib] - Training completed at iteration 21
[2025-11-19 08:58:27,889] [INFO] [<frozen importlib] - Best train loss: 0.6892
[2025-11-19 08:58:27,889] [INFO] [<frozen importlib] - Best val loss: 0.6018
[2025-11-19 08:58:27,889] [INFO] [<frozen importlib] - Best val AUC: 0.7056
[2025-11-19 08:58:27,889] [INFO] [<frozen importlib] - Best val AUCPR: 0.2232
[2025-11-19 08:58:27,895] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:58:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:58:33,780] [INFO] [<frozen importlib] - Optimal threshold: 0.5195
[2025-11-19 08:58:33,780] [INFO] [<frozen importlib] - Best f1: 0.2728
[2025-11-19 08:58:33,780] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:58:33,826] [INFO] [<frozen importlib] - Validation Results (threshold=0.5195):
[2025-11-19 08:58:33,826] [INFO] [<frozen importlib] -   Accuracy: 0.8787
[2025-11-19 08:58:33,826] [INFO] [<frozen importlib] -   Precision: 0.2529
[2025-11-19 08:58:33,826] [INFO] [<frozen importlib] -   Recall: 0.2961
[2025-11-19 08:58:33,826] [INFO] [<frozen importlib] -   F1 Score: 0.2728
[2025-11-19 08:58:33,826] [INFO] [<frozen importlib] -   AUROC: 0.7056
[2025-11-19 08:58:33,826] [INFO] [<frozen importlib] -   AUPRC: 0.2234
[2025-11-19 08:58:33,826] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:58:33,826] [INFO] [<frozen importlib] -     TN=16175, FP=1270
[2025-11-19 08:58:33,826] [INFO] [<frozen importlib] -     FN=1022, TP=430
[2025-11-19 08:58:33,851] [INFO] [<frozen importlib] - Trial 229: AUPRC=0.2234, F1=0.4508, Prec=0.3841, Rec=0.5455 | Optimizing auprc=0.2234
                                                                                        Best trial: 140. Best value: 0.237476:  46%|████▌     | 229/500 [36:31<50:41, 11.22s/it]Best trial: 140. Best value: 0.237476:  46%|████▌     | 229/500 [36:31<50:41, 11.22s/it]Best trial: 140. Best value: 0.237476:  46%|████▌     | 230/500 [36:31<43:44,  9.72s/it][2025-11-19 08:58:33,870] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.676035178267064
[2025-11-19 08:58:33,870] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:58:33,870] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:58:33,870] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:58:33,870] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:58:33,870] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:58:33,870] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:58:33,870] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:58:33,870] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:58:33,870] [INFO] [<frozen importlib] -   gamma: 0.31906037371989693
[2025-11-19 08:58:33,870] [INFO] [<frozen importlib] -   alpha: 0.616900059231104
[2025-11-19 08:58:33,871] [INFO] [<frozen importlib] -   lambda: 2.3007822455068814
[2025-11-19 08:58:33,871] [INFO] [<frozen importlib] -   learning_rate: 0.05731513416942183
[2025-11-19 08:58:33,871] [INFO] [<frozen importlib] -   subsample: 0.5408278069145369
[2025-11-19 08:58:33,871] [INFO] [<frozen importlib] -   colsample_bytree: 0.5351436294253351
[2025-11-19 08:58:33,871] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5597000602277119
[2025-11-19 08:58:33,871] [INFO] [<frozen importlib] -   colsample_bynode: 0.6836025617011788
[2025-11-19 08:58:33,871] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:58:33,871] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:58:33,871] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:58:33,871] [INFO] [<frozen importlib] -   scale_pos_weight: 8.676035178267064
[2025-11-19 08:58:33,946] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:58:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:58:33,852] Trial 229 finished with value: 0.22344656325757653 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.14929809710061615, 'learning_rate': 0.055745727637265374, 'n_estimators': 350, 'alpha': 0.30037181669428176, 'lambda': 2.0806364819630985, 'subsample': 0.7611489615721733, 'colsample_bytree': 0.5012520332146105, 'colsample_bylevel': 0.5527972952247551, 'colsample_bynode': 0.6925066506139621, 'scale_pos_weight': 7.864205335098973}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.78323	train-auc:0.63587	train-aucpr:0.21580	val-logloss:0.78745	val-auc:0.67322	val-aucpr:0.15222
[10]	train-logloss:0.74466	train-auc:0.68292	train-aucpr:0.28572	val-logloss:0.68341	val-auc:0.69213	val-aucpr:0.20395
[20]	train-logloss:0.72552	train-auc:0.69065	train-aucpr:0.30037	val-logloss:0.62771	val-auc:0.69177	val-aucpr:0.20007
[30]	train-logloss:0.71455	train-auc:0.69590	train-aucpr:0.30621	val-logloss:0.59333	val-auc:0.68998	val-aucpr:0.21100
[40]	train-logloss:0.70691	train-auc:0.70312	train-aucpr:0.31076	val-logloss:0.57186	val-auc:0.69441	val-aucpr:0.19595
[50]	train-logloss:0.70109	train-auc:0.70937	train-aucpr:0.31629	val-logloss:0.56495	val-auc:0.69428	val-aucpr:0.19248
[58]	train-logloss:0.69679	train-auc:0.71386	train-aucpr:0.32026	val-logloss:0.55026	val-auc:0.69647	val-aucpr:0.19479
[2025-11-19 08:58:34,132] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 08:58:34,132] [INFO] [<frozen importlib] - Best train loss: 0.7155
[2025-11-19 08:58:34,132] [INFO] [<frozen importlib] - Best val loss: 0.6004
[2025-11-19 08:58:34,132] [INFO] [<frozen importlib] - Best val AUC: 0.6912
[2025-11-19 08:58:34,132] [INFO] [<frozen importlib] - Best val AUCPR: 0.2115
[2025-11-19 08:58:34,138] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:58:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:58:44,006] [INFO] [<frozen importlib] - Optimal threshold: 0.5501
[2025-11-19 08:58:44,007] [INFO] [<frozen importlib] - Best f1: 0.2653
[2025-11-19 08:58:44,007] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:58:44,053] [INFO] [<frozen importlib] - Validation Results (threshold=0.5501):
[2025-11-19 08:58:44,053] [INFO] [<frozen importlib] -   Accuracy: 0.8971
[2025-11-19 08:58:44,053] [INFO] [<frozen importlib] -   Precision: 0.2940
[2025-11-19 08:58:44,053] [INFO] [<frozen importlib] -   Recall: 0.2417
[2025-11-19 08:58:44,053] [INFO] [<frozen importlib] -   F1 Score: 0.2653
[2025-11-19 08:58:44,053] [INFO] [<frozen importlib] -   AUROC: 0.6912
[2025-11-19 08:58:44,054] [INFO] [<frozen importlib] -   AUPRC: 0.2119
[2025-11-19 08:58:44,054] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:58:44,054] [INFO] [<frozen importlib] -     TN=16602, FP=843
[2025-11-19 08:58:44,054] [INFO] [<frozen importlib] -     FN=1101, TP=351
[2025-11-19 08:58:44,079] [INFO] [<frozen importlib] - Trial 230: AUPRC=0.2119, F1=0.4514, Prec=0.4425, Rec=0.4607 | Optimizing auprc=0.2119
[2025-11-19 08:58:44,080] [INFO] [<frozen importlib] - Trial 230 pruned.
[2025-11-19 08:58:44,080] [ERROR] [<frozen importlib] - Trial 230 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  46%|████▌     | 230/500 [36:42<43:44,  9.72s/it]Best trial: 140. Best value: 0.237476:  46%|████▌     | 230/500 [36:42<43:44,  9.72s/it]Best trial: 140. Best value: 0.237476:  46%|████▌     | 231/500 [36:42<44:15,  9.87s/it][2025-11-19 08:58:44,098] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.484289306979023
[2025-11-19 08:58:44,098] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:58:44,098] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:58:44,098] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:58:44,098] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:58:44,098] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:58:44,098] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:58:44,098] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:58:44,098] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:58:44,098] [INFO] [<frozen importlib] -   gamma: 0.5086561838655886
[2025-11-19 08:58:44,098] [INFO] [<frozen importlib] -   alpha: 0.5780596561387692
[2025-11-19 08:58:44,099] [INFO] [<frozen importlib] -   lambda: 1.9966786434559614
[2025-11-19 08:58:44,099] [INFO] [<frozen importlib] -   learning_rate: 0.06235616545562779
[2025-11-19 08:58:44,099] [INFO] [<frozen importlib] -   subsample: 0.7525190230308985
[2025-11-19 08:58:44,099] [INFO] [<frozen importlib] -   colsample_bytree: 0.5151054170881365
[2025-11-19 08:58:44,099] [INFO] [<frozen importlib] -   colsample_bylevel: 0.540735123659163
[2025-11-19 08:58:44,099] [INFO] [<frozen importlib] -   colsample_bynode: 0.6705444970829672
[2025-11-19 08:58:44,099] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:58:44,099] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:58:44,099] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:58:44,099] [INFO] [<frozen importlib] -   scale_pos_weight: 7.484289306979023
[2025-11-19 08:58:44,181] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:58:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:58:44,080] Trial 230 pruned. 
[0]	train-logloss:0.72286	train-auc:0.63286	train-aucpr:0.22482	val-logloss:0.72200	val-auc:0.64776	val-aucpr:0.12461
[10]	train-logloss:0.68684	train-auc:0.68483	train-aucpr:0.29322	val-logloss:0.63527	val-auc:0.66084	val-aucpr:0.16398
[20]	train-logloss:0.66958	train-auc:0.69408	train-aucpr:0.30172	val-logloss:0.57885	val-auc:0.69504	val-aucpr:0.20649
[30]	train-logloss:0.65886	train-auc:0.69894	train-aucpr:0.30834	val-logloss:0.54638	val-auc:0.71046	val-aucpr:0.21284
[40]	train-logloss:0.65138	train-auc:0.70730	train-aucpr:0.31597	val-logloss:0.53039	val-auc:0.70034	val-aucpr:0.21600
[50]	train-logloss:0.64600	train-auc:0.71403	train-aucpr:0.32148	val-logloss:0.50502	val-auc:0.68252	val-aucpr:0.20485
[60]	train-logloss:0.64164	train-auc:0.72004	train-aucpr:0.32694	val-logloss:0.49216	val-auc:0.68361	val-aucpr:0.20501
[66]	train-logloss:0.63855	train-auc:0.72410	train-aucpr:0.33128	val-logloss:0.47079	val-auc:0.67663	val-aucpr:0.19815
[2025-11-19 08:58:44,386] [INFO] [<frozen importlib] - Training completed at iteration 37
[2025-11-19 08:58:44,386] [INFO] [<frozen importlib] - Best train loss: 0.6535
[2025-11-19 08:58:44,386] [INFO] [<frozen importlib] - Best val loss: 0.5303
[2025-11-19 08:58:44,386] [INFO] [<frozen importlib] - Best val AUC: 0.7021
[2025-11-19 08:58:44,386] [INFO] [<frozen importlib] - Best val AUCPR: 0.2194
[2025-11-19 08:58:44,391] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:58:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:58:55,660] [INFO] [<frozen importlib] - Optimal threshold: 0.5041
[2025-11-19 08:58:55,660] [INFO] [<frozen importlib] - Best f1: 0.2660
[2025-11-19 08:58:55,660] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:58:55,711] [INFO] [<frozen importlib] - Validation Results (threshold=0.5041):
[2025-11-19 08:58:55,711] [INFO] [<frozen importlib] -   Accuracy: 0.8887
[2025-11-19 08:58:55,711] [INFO] [<frozen importlib] -   Precision: 0.2696
[2025-11-19 08:58:55,711] [INFO] [<frozen importlib] -   Recall: 0.2624
[2025-11-19 08:58:55,711] [INFO] [<frozen importlib] -   F1 Score: 0.2660
[2025-11-19 08:58:55,711] [INFO] [<frozen importlib] -   AUROC: 0.7021
[2025-11-19 08:58:55,711] [INFO] [<frozen importlib] -   AUPRC: 0.2198
[2025-11-19 08:58:55,711] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:58:55,711] [INFO] [<frozen importlib] -     TN=16413, FP=1032
[2025-11-19 08:58:55,711] [INFO] [<frozen importlib] -     FN=1071, TP=381
[2025-11-19 08:58:55,734] [INFO] [<frozen importlib] - Trial 231: AUPRC=0.2198, F1=0.4421, Prec=0.4059, Rec=0.4855 | Optimizing auprc=0.2198
[2025-11-19 08:58:55,735] [INFO] [<frozen importlib] - Trial 231 pruned.
[2025-11-19 08:58:55,735] [ERROR] [<frozen importlib] - Trial 231 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  46%|████▌     | 231/500 [36:53<44:15,  9.87s/it]Best trial: 140. Best value: 0.237476:  46%|████▌     | 231/500 [36:53<44:15,  9.87s/it]Best trial: 140. Best value: 0.237476:  46%|████▋     | 232/500 [36:53<46:29, 10.41s/it][2025-11-19 08:58:55,747] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.179433250023951
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   gamma: 0.21403053940195774
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   alpha: 0.5271874663420798
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   lambda: 0.7272014180137176
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   learning_rate: 0.03778143019852574
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   subsample: 0.7786025160542975
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   colsample_bytree: 0.5170751597102983
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5628552714759023
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   colsample_bynode: 0.6868680050429361
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:58:55,748] [INFO] [<frozen importlib] -   scale_pos_weight: 8.179433250023951
[2025-11-19 08:58:55,828] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:58:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:58:55,735] Trial 231 pruned. 
[0]	train-logloss:0.76051	train-auc:0.63424	train-aucpr:0.23014	val-logloss:0.76630	val-auc:0.63871	val-aucpr:0.14614
[10]	train-logloss:0.73288	train-auc:0.68312	train-aucpr:0.28673	val-logloss:0.70508	val-auc:0.69144	val-aucpr:0.20279
[20]	train-logloss:0.71581	train-auc:0.68970	train-aucpr:0.30010	val-logloss:0.65233	val-auc:0.71103	val-aucpr:0.22229
[30]	train-logloss:0.70483	train-auc:0.69366	train-aucpr:0.30468	val-logloss:0.62191	val-auc:0.69668	val-aucpr:0.22379
[40]	train-logloss:0.69643	train-auc:0.69736	train-aucpr:0.30892	val-logloss:0.59669	val-auc:0.69447	val-aucpr:0.22666
[50]	train-logloss:0.68977	train-auc:0.70212	train-aucpr:0.31254	val-logloss:0.57608	val-auc:0.70459	val-aucpr:0.22796
[60]	train-logloss:0.68460	train-auc:0.70673	train-aucpr:0.31729	val-logloss:0.56899	val-auc:0.70762	val-aucpr:0.22852
[70]	train-logloss:0.68081	train-auc:0.71042	train-aucpr:0.32068	val-logloss:0.55807	val-auc:0.71379	val-aucpr:0.23149
[80]	train-logloss:0.67697	train-auc:0.71429	train-aucpr:0.32516	val-logloss:0.55420	val-auc:0.71211	val-aucpr:0.23357
[90]	train-logloss:0.67362	train-auc:0.71858	train-aucpr:0.32966	val-logloss:0.53165	val-auc:0.70800	val-aucpr:0.23300
[100]	train-logloss:0.67148	train-auc:0.72089	train-aucpr:0.33198	val-logloss:0.52516	val-auc:0.70527	val-aucpr:0.22981
[110]	train-logloss:0.66823	train-auc:0.72538	train-aucpr:0.33609	val-logloss:0.51951	val-auc:0.70360	val-aucpr:0.22715
[111]	train-logloss:0.66797	train-auc:0.72557	train-aucpr:0.33642	val-logloss:0.51880	val-auc:0.70348	val-aucpr:0.22773
[2025-11-19 08:58:56,140] [INFO] [<frozen importlib] - Training completed at iteration 81
[2025-11-19 08:58:56,140] [INFO] [<frozen importlib] - Best train loss: 0.6766
[2025-11-19 08:58:56,140] [INFO] [<frozen importlib] - Best val loss: 0.5481
[2025-11-19 08:58:56,140] [INFO] [<frozen importlib] - Best val AUC: 0.7130
[2025-11-19 08:58:56,140] [INFO] [<frozen importlib] - Best val AUCPR: 0.2348
[2025-11-19 08:58:56,146] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:58:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:59:10,185] [INFO] [<frozen importlib] - Optimal threshold: 0.5509
[2025-11-19 08:59:10,185] [INFO] [<frozen importlib] - Best f1: 0.2668
[2025-11-19 08:59:10,185] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:59:10,231] [INFO] [<frozen importlib] - Validation Results (threshold=0.5509):
[2025-11-19 08:59:10,231] [INFO] [<frozen importlib] -   Accuracy: 0.9058
[2025-11-19 08:59:10,231] [INFO] [<frozen importlib] -   Precision: 0.3316
[2025-11-19 08:59:10,232] [INFO] [<frozen importlib] -   Recall: 0.2231
[2025-11-19 08:59:10,232] [INFO] [<frozen importlib] -   F1 Score: 0.2668
[2025-11-19 08:59:10,232] [INFO] [<frozen importlib] -   AUROC: 0.7130
[2025-11-19 08:59:10,232] [INFO] [<frozen importlib] -   AUPRC: 0.2351
[2025-11-19 08:59:10,232] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:59:10,232] [INFO] [<frozen importlib] -     TN=16792, FP=653
[2025-11-19 08:59:10,232] [INFO] [<frozen importlib] -     FN=1128, TP=324
[2025-11-19 08:59:10,258] [INFO] [<frozen importlib] - Trial 232: AUPRC=0.2351, F1=0.4680, Prec=0.4961, Rec=0.4428 | Optimizing auprc=0.2351
                                                                                        Best trial: 140. Best value: 0.237476:  46%|████▋     | 232/500 [37:08<46:29, 10.41s/it]Best trial: 140. Best value: 0.237476:  46%|████▋     | 232/500 [37:08<46:29, 10.41s/it]Best trial: 140. Best value: 0.237476:  47%|████▋     | 233/500 [37:08<51:48, 11.64s/it][2025-11-19 08:59:10,269] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.170058845895563
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   gamma: 0.2053944889871176
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   alpha: 0.48064725613232445
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   lambda: 2.2272701967801543
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   learning_rate: 0.03745431748641271
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   subsample: 0.7710189616426614
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   colsample_bytree: 0.5283124313306573
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   colsample_bylevel: 0.568993444154295
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   colsample_bynode: 0.6817674194170251
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:59:10,269] [INFO] [<frozen importlib] -   scale_pos_weight: 8.170058845895563
[2025-11-19 08:59:10,347] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:59:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:59:10,258] Trial 232 finished with value: 0.23513465843195985 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.21403053940195774, 'learning_rate': 0.03778143019852574, 'n_estimators': 450, 'alpha': 0.5271874663420798, 'lambda': 0.7272014180137176, 'subsample': 0.7786025160542975, 'colsample_bytree': 0.5170751597102983, 'colsample_bylevel': 0.5628552714759023, 'colsample_bynode': 0.6868680050429361, 'scale_pos_weight': 8.179433250023951}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.76007	train-auc:0.63423	train-aucpr:0.22999	val-logloss:0.76586	val-auc:0.63849	val-aucpr:0.14439
[10]	train-logloss:0.73276	train-auc:0.68207	train-aucpr:0.28800	val-logloss:0.69590	val-auc:0.69631	val-aucpr:0.21157
[20]	train-logloss:0.71537	train-auc:0.69045	train-aucpr:0.29795	val-logloss:0.64543	val-auc:0.71422	val-aucpr:0.22019
[30]	train-logloss:0.70441	train-auc:0.69263	train-aucpr:0.30266	val-logloss:0.61459	val-auc:0.70683	val-aucpr:0.21775
[40]	train-logloss:0.69604	train-auc:0.69703	train-aucpr:0.30823	val-logloss:0.58981	val-auc:0.70573	val-aucpr:0.22267
[43]	train-logloss:0.69408	train-auc:0.69851	train-aucpr:0.30887	val-logloss:0.58158	val-auc:0.70458	val-aucpr:0.22275
[2025-11-19 08:59:10,495] [INFO] [<frozen importlib] - Training completed at iteration 14
[2025-11-19 08:59:10,495] [INFO] [<frozen importlib] - Best train loss: 0.7251
[2025-11-19 08:59:10,495] [INFO] [<frozen importlib] - Best val loss: 0.6737
[2025-11-19 08:59:10,495] [INFO] [<frozen importlib] - Best val AUC: 0.7144
[2025-11-19 08:59:10,495] [INFO] [<frozen importlib] - Best val AUCPR: 0.2244
[2025-11-19 08:59:10,500] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:59:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:59:14,510] [INFO] [<frozen importlib] - Optimal threshold: 0.5501
[2025-11-19 08:59:14,510] [INFO] [<frozen importlib] - Best f1: 0.2760
[2025-11-19 08:59:14,510] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:59:14,553] [INFO] [<frozen importlib] - Validation Results (threshold=0.5501):
[2025-11-19 08:59:14,553] [INFO] [<frozen importlib] -   Accuracy: 0.9009
[2025-11-19 08:59:14,553] [INFO] [<frozen importlib] -   Precision: 0.3145
[2025-11-19 08:59:14,553] [INFO] [<frozen importlib] -   Recall: 0.2459
[2025-11-19 08:59:14,553] [INFO] [<frozen importlib] -   F1 Score: 0.2760
[2025-11-19 08:59:14,553] [INFO] [<frozen importlib] -   AUROC: 0.7144
[2025-11-19 08:59:14,553] [INFO] [<frozen importlib] -   AUPRC: 0.2247
[2025-11-19 08:59:14,553] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:59:14,553] [INFO] [<frozen importlib] -     TN=16667, FP=778
[2025-11-19 08:59:14,553] [INFO] [<frozen importlib] -     FN=1095, TP=357
[2025-11-19 08:59:14,576] [INFO] [<frozen importlib] - Trial 233: AUPRC=0.2247, F1=0.4519, Prec=0.4556, Rec=0.4483 | Optimizing auprc=0.2247
                                                                                        Best trial: 140. Best value: 0.237476:  47%|████▋     | 233/500 [37:12<51:48, 11.64s/it]Best trial: 140. Best value: 0.237476:  47%|████▋     | 233/500 [37:12<51:48, 11.64s/it]Best trial: 140. Best value: 0.237476:  47%|████▋     | 234/500 [37:12<41:52,  9.45s/it][2025-11-19 08:59:14,587] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.391065551122498
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   gamma: 0.5458206541300092
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   alpha: 0.5282042744450394
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   lambda: 0.8644890551889438
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   learning_rate: 0.05831264248276383
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   subsample: 0.5786105507060165
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   colsample_bytree: 0.511408221289412
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5632655634729059
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   colsample_bynode: 0.6916357654848468
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:59:14,587] [INFO] [<frozen importlib] -   scale_pos_weight: 8.391065551122498
[2025-11-19 08:59:14,658] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:59:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:59:14,576] Trial 233 finished with value: 0.22470112892628774 and parameters: {'max_depth': 4, 'min_child_weight': 4, 'gamma': 0.2053944889871176, 'learning_rate': 0.03745431748641271, 'n_estimators': 450, 'alpha': 0.48064725613232445, 'lambda': 2.2272701967801543, 'subsample': 0.7710189616426614, 'colsample_bytree': 0.5283124313306573, 'colsample_bylevel': 0.568993444154295, 'colsample_bynode': 0.6817674194170251, 'scale_pos_weight': 8.170058845895563}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.76901	train-auc:0.63604	train-aucpr:0.22831	val-logloss:0.77443	val-auc:0.63961	val-aucpr:0.13604
[10]	train-logloss:0.73149	train-auc:0.68567	train-aucpr:0.28571	val-logloss:0.68394	val-auc:0.68833	val-aucpr:0.19986
[20]	train-logloss:0.71221	train-auc:0.69229	train-aucpr:0.29922	val-logloss:0.62359	val-auc:0.70854	val-aucpr:0.20525
[30]	train-logloss:0.70110	train-auc:0.69885	train-aucpr:0.30586	val-logloss:0.59502	val-auc:0.71135	val-aucpr:0.21595
[40]	train-logloss:0.69344	train-auc:0.70682	train-aucpr:0.31209	val-logloss:0.57384	val-auc:0.70533	val-aucpr:0.20990
[42]	train-logloss:0.69233	train-auc:0.70845	train-aucpr:0.31283	val-logloss:0.57178	val-auc:0.70540	val-aucpr:0.20981
[2025-11-19 08:59:14,803] [INFO] [<frozen importlib] - Training completed at iteration 13
[2025-11-19 08:59:14,803] [INFO] [<frozen importlib] - Best train loss: 0.7242
[2025-11-19 08:59:14,803] [INFO] [<frozen importlib] - Best val loss: 0.6605
[2025-11-19 08:59:14,803] [INFO] [<frozen importlib] - Best val AUC: 0.7094
[2025-11-19 08:59:14,803] [INFO] [<frozen importlib] - Best val AUCPR: 0.2185
[2025-11-19 08:59:14,808] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:59:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:59:18,562] [INFO] [<frozen importlib] - Optimal threshold: 0.5451
[2025-11-19 08:59:18,562] [INFO] [<frozen importlib] - Best f1: 0.2698
[2025-11-19 08:59:18,562] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:59:18,608] [INFO] [<frozen importlib] - Validation Results (threshold=0.5451):
[2025-11-19 08:59:18,608] [INFO] [<frozen importlib] -   Accuracy: 0.8728
[2025-11-19 08:59:18,608] [INFO] [<frozen importlib] -   Precision: 0.2414
[2025-11-19 08:59:18,608] [INFO] [<frozen importlib] -   Recall: 0.3058
[2025-11-19 08:59:18,608] [INFO] [<frozen importlib] -   F1 Score: 0.2698
[2025-11-19 08:59:18,608] [INFO] [<frozen importlib] -   AUROC: 0.7094
[2025-11-19 08:59:18,608] [INFO] [<frozen importlib] -   AUPRC: 0.2187
[2025-11-19 08:59:18,608] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:59:18,608] [INFO] [<frozen importlib] -     TN=16050, FP=1395
[2025-11-19 08:59:18,608] [INFO] [<frozen importlib] -     FN=1008, TP=444
[2025-11-19 08:59:18,633] [INFO] [<frozen importlib] - Trial 234: AUPRC=0.2187, F1=0.4331, Prec=0.3607, Rec=0.5420 | Optimizing auprc=0.2187
                                                                                        Best trial: 140. Best value: 0.237476:  47%|████▋     | 234/500 [37:16<41:52,  9.45s/it]Best trial: 140. Best value: 0.237476:  47%|████▋     | 234/500 [37:16<41:52,  9.45s/it]Best trial: 140. Best value: 0.237476:  47%|████▋     | 235/500 [37:16<34:34,  7.83s/it][2025-11-19 08:59:18,652] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.063509127907011
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   gamma: 0.4745459771371248
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   alpha: 0.2341830356692332
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   lambda: 0.7282260188477249
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   learning_rate: 0.038088465774522934
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   subsample: 0.7805507146130329
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   colsample_bytree: 0.5007694727991071
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5483077940664604
[2025-11-19 08:59:18,652] [INFO] [<frozen importlib] -   colsample_bynode: 0.6840524930199032
[2025-11-19 08:59:18,653] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:59:18,653] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:59:18,653] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:59:18,653] [INFO] [<frozen importlib] -   scale_pos_weight: 8.063509127907011
[2025-11-19 08:59:18,730] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:59:18] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:59:18,634] Trial 234 finished with value: 0.21871440363468753 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.5458206541300092, 'learning_rate': 0.05831264248276383, 'n_estimators': 450, 'alpha': 0.5282042744450394, 'lambda': 0.8644890551889438, 'subsample': 0.5786105507060165, 'colsample_bytree': 0.511408221289412, 'colsample_bylevel': 0.5632655634729059, 'colsample_bynode': 0.6916357654848468, 'scale_pos_weight': 8.391065551122498}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.75466	train-auc:0.63237	train-aucpr:0.22267	val-logloss:0.75824	val-auc:0.64881	val-aucpr:0.13202
[10]	train-logloss:0.72770	train-auc:0.68096	train-aucpr:0.29103	val-logloss:0.69727	val-auc:0.67753	val-aucpr:0.19661
[20]	train-logloss:0.71126	train-auc:0.68746	train-aucpr:0.29626	val-logloss:0.64725	val-auc:0.71063	val-aucpr:0.22425
[30]	train-logloss:0.69963	train-auc:0.69226	train-aucpr:0.30277	val-logloss:0.60871	val-auc:0.70964	val-aucpr:0.22583
[40]	train-logloss:0.69120	train-auc:0.69687	train-aucpr:0.30751	val-logloss:0.57426	val-auc:0.70901	val-aucpr:0.22423
[50]	train-logloss:0.68448	train-auc:0.70139	train-aucpr:0.31215	val-logloss:0.56370	val-auc:0.71400	val-aucpr:0.22608
[60]	train-logloss:0.67982	train-auc:0.70473	train-aucpr:0.31604	val-logloss:0.55057	val-auc:0.71494	val-aucpr:0.22579
[70]	train-logloss:0.67548	train-auc:0.71063	train-aucpr:0.32046	val-logloss:0.54368	val-auc:0.71059	val-aucpr:0.22117
[80]	train-logloss:0.67180	train-auc:0.71491	train-aucpr:0.32441	val-logloss:0.52550	val-auc:0.70961	val-aucpr:0.21435
[90]	train-logloss:0.66890	train-auc:0.71853	train-aucpr:0.32787	val-logloss:0.51433	val-auc:0.70653	val-aucpr:0.21392
[93]	train-logloss:0.66840	train-auc:0.71940	train-aucpr:0.32862	val-logloss:0.50999	val-auc:0.70591	val-aucpr:0.21309
[2025-11-19 08:59:19,003] [INFO] [<frozen importlib] - Training completed at iteration 63
[2025-11-19 08:59:19,003] [INFO] [<frozen importlib] - Best train loss: 0.6784
[2025-11-19 08:59:19,003] [INFO] [<frozen importlib] - Best val loss: 0.5468
[2025-11-19 08:59:19,003] [INFO] [<frozen importlib] - Best val AUC: 0.7147
[2025-11-19 08:59:19,003] [INFO] [<frozen importlib] - Best val AUCPR: 0.2288
[2025-11-19 08:59:19,009] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:59:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:59:32,743] [INFO] [<frozen importlib] - Optimal threshold: 0.5247
[2025-11-19 08:59:32,743] [INFO] [<frozen importlib] - Best f1: 0.2751
[2025-11-19 08:59:32,743] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:59:32,791] [INFO] [<frozen importlib] - Validation Results (threshold=0.5247):
[2025-11-19 08:59:32,792] [INFO] [<frozen importlib] -   Accuracy: 0.8909
[2025-11-19 08:59:32,792] [INFO] [<frozen importlib] -   Precision: 0.2811
[2025-11-19 08:59:32,792] [INFO] [<frozen importlib] -   Recall: 0.2693
[2025-11-19 08:59:32,792] [INFO] [<frozen importlib] -   F1 Score: 0.2751
[2025-11-19 08:59:32,792] [INFO] [<frozen importlib] -   AUROC: 0.7147
[2025-11-19 08:59:32,792] [INFO] [<frozen importlib] -   AUPRC: 0.2292
[2025-11-19 08:59:32,792] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:59:32,792] [INFO] [<frozen importlib] -     TN=16445, FP=1000
[2025-11-19 08:59:32,792] [INFO] [<frozen importlib] -     FN=1061, TP=391
[2025-11-19 08:59:32,818] [INFO] [<frozen importlib] - Trial 235: AUPRC=0.2292, F1=0.4535, Prec=0.4183, Rec=0.4952 | Optimizing auprc=0.2292
                                                                                        Best trial: 140. Best value: 0.237476:  47%|████▋     | 235/500 [37:30<34:34,  7.83s/it]Best trial: 140. Best value: 0.237476:  47%|████▋     | 235/500 [37:30<34:34,  7.83s/it]Best trial: 140. Best value: 0.237476:  47%|████▋     | 236/500 [37:30<42:50,  9.74s/it][2025-11-19 08:59:32,828] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.733179454345042
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   min_child_weight: 3
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   gamma: 0.17820070289862977
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   alpha: 0.4137174537274573
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   lambda: 1.9346952941891193
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   learning_rate: 0.03559683372383291
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   subsample: 0.7889692595867108
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   colsample_bytree: 0.517333716252595
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5853517876519057
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   colsample_bynode: 0.6689481026966215
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:59:32,828] [INFO] [<frozen importlib] -   scale_pos_weight: 7.733179454345042
[2025-11-19 08:59:32,909] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:59:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:59:32,818] Trial 235 finished with value: 0.22919293266937157 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.4745459771371248, 'learning_rate': 0.038088465774522934, 'n_estimators': 300, 'alpha': 0.2341830356692332, 'lambda': 0.7282260188477249, 'subsample': 0.7805507146130329, 'colsample_bytree': 0.5007694727991071, 'colsample_bylevel': 0.5483077940664604, 'colsample_bynode': 0.6840524930199032, 'scale_pos_weight': 8.063509127907011}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.73788	train-auc:0.63414	train-aucpr:0.22779	val-logloss:0.74112	val-auc:0.63350	val-aucpr:0.12256
[10]	train-logloss:0.71215	train-auc:0.68295	train-aucpr:0.29251	val-logloss:0.68170	val-auc:0.68342	val-aucpr:0.20072
[20]	train-logloss:0.69579	train-auc:0.69060	train-aucpr:0.29853	val-logloss:0.64597	val-auc:0.68866	val-aucpr:0.21456
[30]	train-logloss:0.68523	train-auc:0.69459	train-aucpr:0.30230	val-logloss:0.61162	val-auc:0.69735	val-aucpr:0.21954
[40]	train-logloss:0.67716	train-auc:0.69878	train-aucpr:0.30732	val-logloss:0.58315	val-auc:0.70303	val-aucpr:0.22207
[50]	train-logloss:0.67090	train-auc:0.70187	train-aucpr:0.31085	val-logloss:0.55584	val-auc:0.70100	val-aucpr:0.22087
[60]	train-logloss:0.66606	train-auc:0.70501	train-aucpr:0.31444	val-logloss:0.53887	val-auc:0.70287	val-aucpr:0.22565
[70]	train-logloss:0.66198	train-auc:0.70949	train-aucpr:0.31925	val-logloss:0.53471	val-auc:0.69559	val-aucpr:0.22015
[80]	train-logloss:0.65836	train-auc:0.71356	train-aucpr:0.32307	val-logloss:0.52898	val-auc:0.69593	val-aucpr:0.21936
[90]	train-logloss:0.65537	train-auc:0.71680	train-aucpr:0.32712	val-logloss:0.51728	val-auc:0.69302	val-aucpr:0.21693
[91]	train-logloss:0.65507	train-auc:0.71719	train-aucpr:0.32767	val-logloss:0.51661	val-auc:0.69303	val-aucpr:0.21698
[2025-11-19 08:59:33,173] [INFO] [<frozen importlib] - Training completed at iteration 61
[2025-11-19 08:59:33,173] [INFO] [<frozen importlib] - Best train loss: 0.6657
[2025-11-19 08:59:33,173] [INFO] [<frozen importlib] - Best val loss: 0.5400
[2025-11-19 08:59:33,173] [INFO] [<frozen importlib] - Best val AUC: 0.7036
[2025-11-19 08:59:33,173] [INFO] [<frozen importlib] - Best val AUCPR: 0.2268
[2025-11-19 08:59:33,178] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:59:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:59:46,201] [INFO] [<frozen importlib] - Optimal threshold: 0.5071
[2025-11-19 08:59:46,201] [INFO] [<frozen importlib] - Best f1: 0.2628
[2025-11-19 08:59:46,201] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:59:46,244] [INFO] [<frozen importlib] - Validation Results (threshold=0.5071):
[2025-11-19 08:59:46,245] [INFO] [<frozen importlib] -   Accuracy: 0.8937
[2025-11-19 08:59:46,245] [INFO] [<frozen importlib] -   Precision: 0.2812
[2025-11-19 08:59:46,245] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 08:59:46,245] [INFO] [<frozen importlib] -   F1 Score: 0.2628
[2025-11-19 08:59:46,245] [INFO] [<frozen importlib] -   AUROC: 0.7036
[2025-11-19 08:59:46,245] [INFO] [<frozen importlib] -   AUPRC: 0.2271
[2025-11-19 08:59:46,245] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:59:46,245] [INFO] [<frozen importlib] -     TN=16530, FP=915
[2025-11-19 08:59:46,245] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 08:59:46,268] [INFO] [<frozen importlib] - Trial 236: AUPRC=0.2271, F1=0.4448, Prec=0.4253, Rec=0.4663 | Optimizing auprc=0.2271
                                                                                        Best trial: 140. Best value: 0.237476:  47%|████▋     | 236/500 [37:44<42:50,  9.74s/it]Best trial: 140. Best value: 0.237476:  47%|████▋     | 236/500 [37:44<42:50,  9.74s/it]Best trial: 140. Best value: 0.237476:  47%|████▋     | 237/500 [37:44<47:33, 10.85s/it][2025-11-19 08:59:46,279] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.497652244040975
[2025-11-19 08:59:46,279] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   gamma: 0.4447877902083834
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   alpha: 0.5273738466150356
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   lambda: 1.8451002205283906
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   learning_rate: 0.060724438622568364
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   subsample: 0.7618492183944774
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   colsample_bytree: 0.5279712964849785
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5570932916880212
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   colsample_bynode: 0.7008610523278126
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:59:46,280] [INFO] [<frozen importlib] -   scale_pos_weight: 8.497652244040975
[2025-11-19 08:59:46,359] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:59:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:59:46,269] Trial 236 finished with value: 0.22714356528060303 and parameters: {'max_depth': 4, 'min_child_weight': 3, 'gamma': 0.17820070289862977, 'learning_rate': 0.03559683372383291, 'n_estimators': 450, 'alpha': 0.4137174537274573, 'lambda': 1.9346952941891193, 'subsample': 0.7889692595867108, 'colsample_bytree': 0.517333716252595, 'colsample_bylevel': 0.5853517876519057, 'colsample_bynode': 0.6689481026966215, 'scale_pos_weight': 7.733179454345042}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.77424	train-auc:0.63423	train-aucpr:0.23006	val-logloss:0.77979	val-auc:0.63849	val-aucpr:0.14439
[10]	train-logloss:0.73534	train-auc:0.68523	train-aucpr:0.29404	val-logloss:0.67987	val-auc:0.69511	val-aucpr:0.21171
[20]	train-logloss:0.71588	train-auc:0.69515	train-aucpr:0.30577	val-logloss:0.62638	val-auc:0.70620	val-aucpr:0.20989
[30]	train-logloss:0.70440	train-auc:0.70054	train-aucpr:0.31263	val-logloss:0.60059	val-auc:0.70817	val-aucpr:0.21623
[40]	train-logloss:0.69629	train-auc:0.70864	train-aucpr:0.31899	val-logloss:0.58131	val-auc:0.70743	val-aucpr:0.21251
[44]	train-logloss:0.69392	train-auc:0.71047	train-aucpr:0.32070	val-logloss:0.57220	val-auc:0.70460	val-aucpr:0.20980
[2025-11-19 08:59:46,511] [INFO] [<frozen importlib] - Training completed at iteration 15
[2025-11-19 08:59:46,511] [INFO] [<frozen importlib] - Best train loss: 0.7247
[2025-11-19 08:59:46,511] [INFO] [<frozen importlib] - Best val loss: 0.6493
[2025-11-19 08:59:46,511] [INFO] [<frozen importlib] - Best val AUC: 0.7077
[2025-11-19 08:59:46,511] [INFO] [<frozen importlib] - Best val AUCPR: 0.2180
[2025-11-19 08:59:46,517] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:59:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:59:50,010] [INFO] [<frozen importlib] - Optimal threshold: 0.5465
[2025-11-19 08:59:50,010] [INFO] [<frozen importlib] - Best f1: 0.2772
[2025-11-19 08:59:50,010] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:59:50,053] [INFO] [<frozen importlib] - Validation Results (threshold=0.5465):
[2025-11-19 08:59:50,053] [INFO] [<frozen importlib] -   Accuracy: 0.8838
[2025-11-19 08:59:50,053] [INFO] [<frozen importlib] -   Precision: 0.2654
[2025-11-19 08:59:50,053] [INFO] [<frozen importlib] -   Recall: 0.2899
[2025-11-19 08:59:50,053] [INFO] [<frozen importlib] -   F1 Score: 0.2772
[2025-11-19 08:59:50,053] [INFO] [<frozen importlib] -   AUROC: 0.7077
[2025-11-19 08:59:50,053] [INFO] [<frozen importlib] -   AUPRC: 0.2180
[2025-11-19 08:59:50,054] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:59:50,054] [INFO] [<frozen importlib] -     TN=16280, FP=1165
[2025-11-19 08:59:50,054] [INFO] [<frozen importlib] -     FN=1031, TP=421
[2025-11-19 08:59:50,079] [INFO] [<frozen importlib] - Trial 237: AUPRC=0.2180, F1=0.4381, Prec=0.3865, Rec=0.5055 | Optimizing auprc=0.2180
                                                                                        Best trial: 140. Best value: 0.237476:  47%|████▋     | 237/500 [37:48<47:33, 10.85s/it]Best trial: 140. Best value: 0.237476:  47%|████▋     | 237/500 [37:48<47:33, 10.85s/it]Best trial: 140. Best value: 0.237476:  48%|████▊     | 238/500 [37:48<38:09,  8.74s/it][2025-11-19 08:59:50,091] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 13.395535478119163
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   gamma: 0.22690983085213026
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   alpha: 1.0560437462617838
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   lambda: 2.4309405049188135
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   learning_rate: 0.05262530109097354
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   subsample: 0.7942808017358857
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   colsample_bytree: 0.5388053652862971
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5747683674243509
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   colsample_bynode: 0.6197553569308798
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:59:50,091] [INFO] [<frozen importlib] -   scale_pos_weight: 13.395535478119163
[2025-11-19 08:59:50,163] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:59:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:59:50,080] Trial 237 finished with value: 0.21804360888857033 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.4447877902083834, 'learning_rate': 0.060724438622568364, 'n_estimators': 350, 'alpha': 0.5273738466150356, 'lambda': 1.8451002205283906, 'subsample': 0.7618492183944774, 'colsample_bytree': 0.5279712964849785, 'colsample_bylevel': 0.5570932916880212, 'colsample_bynode': 0.7008610523278126, 'scale_pos_weight': 8.497652244040975}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.97949	train-auc:0.63756	train-aucpr:0.22079	val-logloss:1.00388	val-auc:0.65004	val-aucpr:0.14413
[10]	train-logloss:0.93551	train-auc:0.68590	train-aucpr:0.28838	val-logloss:0.88080	val-auc:0.67653	val-aucpr:0.18927
[20]	train-logloss:0.91352	train-auc:0.69387	train-aucpr:0.29941	val-logloss:0.81355	val-auc:0.71378	val-aucpr:0.21708
[30]	train-logloss:0.90076	train-auc:0.69849	train-aucpr:0.30781	val-logloss:0.77248	val-auc:0.70756	val-aucpr:0.21976
[40]	train-logloss:0.89022	train-auc:0.70596	train-aucpr:0.31416	val-logloss:0.74406	val-auc:0.70893	val-aucpr:0.21474
[50]	train-logloss:0.88232	train-auc:0.71208	train-aucpr:0.31905	val-logloss:0.71679	val-auc:0.70443	val-aucpr:0.21059
[60]	train-logloss:0.87640	train-auc:0.71703	train-aucpr:0.32420	val-logloss:0.71003	val-auc:0.70151	val-aucpr:0.21073
[62]	train-logloss:0.87533	train-auc:0.71772	train-aucpr:0.32469	val-logloss:0.70688	val-auc:0.70098	val-aucpr:0.21059
[2025-11-19 08:59:50,359] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 08:59:50,359] [INFO] [<frozen importlib] - Best train loss: 0.8985
[2025-11-19 08:59:50,359] [INFO] [<frozen importlib] - Best val loss: 0.7691
[2025-11-19 08:59:50,359] [INFO] [<frozen importlib] - Best val AUC: 0.7081
[2025-11-19 08:59:50,359] [INFO] [<frozen importlib] - Best val AUCPR: 0.2220
[2025-11-19 08:59:50,364] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:59:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 08:59:58,917] [INFO] [<frozen importlib] - Optimal threshold: 0.6393
[2025-11-19 08:59:58,917] [INFO] [<frozen importlib] - Best f1: 0.2716
[2025-11-19 08:59:58,917] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 08:59:58,969] [INFO] [<frozen importlib] - Validation Results (threshold=0.6393):
[2025-11-19 08:59:58,969] [INFO] [<frozen importlib] -   Accuracy: 0.8828
[2025-11-19 08:59:58,969] [INFO] [<frozen importlib] -   Precision: 0.2599
[2025-11-19 08:59:58,969] [INFO] [<frozen importlib] -   Recall: 0.2844
[2025-11-19 08:59:58,969] [INFO] [<frozen importlib] -   F1 Score: 0.2716
[2025-11-19 08:59:58,969] [INFO] [<frozen importlib] -   AUROC: 0.7081
[2025-11-19 08:59:58,969] [INFO] [<frozen importlib] -   AUPRC: 0.2223
[2025-11-19 08:59:58,969] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 08:59:58,969] [INFO] [<frozen importlib] -     TN=16269, FP=1176
[2025-11-19 08:59:58,969] [INFO] [<frozen importlib] -     FN=1039, TP=413
[2025-11-19 08:59:58,991] [INFO] [<frozen importlib] - Trial 238: AUPRC=0.2223, F1=0.4559, Prec=0.3975, Rec=0.5344 | Optimizing auprc=0.2223
[2025-11-19 08:59:58,991] [INFO] [<frozen importlib] - Trial 238 pruned.
[2025-11-19 08:59:58,991] [ERROR] [<frozen importlib] - Trial 238 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  48%|████▊     | 238/500 [37:56<38:09,  8.74s/it]Best trial: 140. Best value: 0.237476:  48%|████▊     | 238/500 [37:56<38:09,  8.74s/it]Best trial: 140. Best value: 0.237476:  48%|████▊     | 239/500 [37:56<38:14,  8.79s/it][2025-11-19 08:59:59,002] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 8.047131059192546
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   gamma: 0.2803761916433164
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   alpha: 0.9651604257877144
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   lambda: 2.5750163615449937
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   learning_rate: 0.07773364307432758
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   subsample: 0.7732392952028307
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   colsample_bytree: 0.7352956565801088
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5323610760637181
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   colsample_bynode: 0.7093453800022071
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 08:59:59,002] [INFO] [<frozen importlib] -   scale_pos_weight: 8.047131059192546
[2025-11-19 08:59:59,074] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [08:59:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 08:59:58,991] Trial 238 pruned. 
[0]	train-logloss:0.74954	train-auc:0.64353	train-aucpr:0.24760	val-logloss:0.74858	val-auc:0.59845	val-aucpr:0.13876
[10]	train-logloss:0.70504	train-auc:0.68360	train-aucpr:0.29994	val-logloss:0.62629	val-auc:0.68982	val-aucpr:0.19974
[20]	train-logloss:0.68748	train-auc:0.69434	train-aucpr:0.30937	val-logloss:0.57886	val-auc:0.69852	val-aucpr:0.21108
[30]	train-logloss:0.67595	train-auc:0.70472	train-aucpr:0.31764	val-logloss:0.57015	val-auc:0.68460	val-aucpr:0.19074
[40]	train-logloss:0.66938	train-auc:0.71231	train-aucpr:0.32521	val-logloss:0.57157	val-auc:0.67743	val-aucpr:0.18350
[48]	train-logloss:0.66420	train-auc:0.71816	train-aucpr:0.33111	val-logloss:0.55723	val-auc:0.67487	val-aucpr:0.18225
[2025-11-19 08:59:59,231] [INFO] [<frozen importlib] - Training completed at iteration 19
[2025-11-19 08:59:59,231] [INFO] [<frozen importlib] - Best train loss: 0.6884
[2025-11-19 08:59:59,231] [INFO] [<frozen importlib] - Best val loss: 0.5807
[2025-11-19 08:59:59,231] [INFO] [<frozen importlib] - Best val AUC: 0.6986
[2025-11-19 08:59:59,231] [INFO] [<frozen importlib] - Best val AUCPR: 0.2122
[2025-11-19 08:59:59,235] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [08:59:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:00:02,933] [INFO] [<frozen importlib] - Optimal threshold: 0.5395
[2025-11-19 09:00:02,933] [INFO] [<frozen importlib] - Best f1: 0.2618
[2025-11-19 09:00:02,933] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:00:02,975] [INFO] [<frozen importlib] - Validation Results (threshold=0.5395):
[2025-11-19 09:00:02,975] [INFO] [<frozen importlib] -   Accuracy: 0.8968
[2025-11-19 09:00:02,975] [INFO] [<frozen importlib] -   Precision: 0.2905
[2025-11-19 09:00:02,975] [INFO] [<frozen importlib] -   Recall: 0.2383
[2025-11-19 09:00:02,975] [INFO] [<frozen importlib] -   F1 Score: 0.2618
[2025-11-19 09:00:02,975] [INFO] [<frozen importlib] -   AUROC: 0.6986
[2025-11-19 09:00:02,975] [INFO] [<frozen importlib] -   AUPRC: 0.2124
[2025-11-19 09:00:02,975] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:00:02,976] [INFO] [<frozen importlib] -     TN=16600, FP=845
[2025-11-19 09:00:02,976] [INFO] [<frozen importlib] -     FN=1106, TP=346
[2025-11-19 09:00:02,998] [INFO] [<frozen importlib] - Trial 239: AUPRC=0.2124, F1=0.4427, Prec=0.4359, Rec=0.4497 | Optimizing auprc=0.2124
                                                                                        Best trial: 140. Best value: 0.237476:  48%|████▊     | 239/500 [38:00<38:14,  8.79s/it]Best trial: 140. Best value: 0.237476:  48%|████▊     | 239/500 [38:00<38:14,  8.79s/it]Best trial: 140. Best value: 0.237476:  48%|████▊     | 240/500 [38:00<31:52,  7.36s/it][2025-11-19 09:00:03,009] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.042533967223926
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   gamma: 0.2600707956733809
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   alpha: 0.5959835312263139
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   lambda: 0.6299351865422328
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   learning_rate: 0.04091979675431031
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   subsample: 0.7451188820263946
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   colsample_bytree: 0.5103107708709489
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5442649691833172
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   colsample_bynode: 0.7263308702197916
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:00:03,009] [INFO] [<frozen importlib] -   scale_pos_weight: 6.042533967223926
[2025-11-19 09:00:03,081] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:00:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:00:02,998] Trial 239 finished with value: 0.21238555966947162 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.2803761916433164, 'learning_rate': 0.07773364307432758, 'n_estimators': 400, 'alpha': 0.9651604257877144, 'lambda': 2.5750163615449937, 'subsample': 0.7732392952028307, 'colsample_bytree': 0.7352956565801088, 'colsample_bylevel': 0.5323610760637181, 'colsample_bynode': 0.7093453800022071, 'scale_pos_weight': 8.047131059192546}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.64640	train-auc:0.63500	train-aucpr:0.22409	val-logloss:0.63899	val-auc:0.62438	val-aucpr:0.09866
[10]	train-logloss:0.62365	train-auc:0.68279	train-aucpr:0.28780	val-logloss:0.59204	val-auc:0.67077	val-aucpr:0.14604
[20]	train-logloss:0.60923	train-auc:0.68679	train-aucpr:0.29839	val-logloss:0.55524	val-auc:0.68741	val-aucpr:0.20751
[30]	train-logloss:0.59920	train-auc:0.69260	train-aucpr:0.30580	val-logloss:0.52471	val-auc:0.68227	val-aucpr:0.20929
[40]	train-logloss:0.59207	train-auc:0.69810	train-aucpr:0.31062	val-logloss:0.50529	val-auc:0.68303	val-aucpr:0.21158
[50]	train-logloss:0.58696	train-auc:0.70245	train-aucpr:0.31434	val-logloss:0.49262	val-auc:0.69182	val-aucpr:0.21868
[60]	train-logloss:0.58304	train-auc:0.70652	train-aucpr:0.31943	val-logloss:0.48273	val-auc:0.69651	val-aucpr:0.22221
[70]	train-logloss:0.57969	train-auc:0.71111	train-aucpr:0.32319	val-logloss:0.47796	val-auc:0.69845	val-aucpr:0.21825
[80]	train-logloss:0.57647	train-auc:0.71579	train-aucpr:0.32834	val-logloss:0.47321	val-auc:0.69996	val-aucpr:0.21585
[90]	train-logloss:0.57418	train-auc:0.71899	train-aucpr:0.33188	val-logloss:0.47030	val-auc:0.70259	val-aucpr:0.21620
[2025-11-19 09:00:03,340] [INFO] [<frozen importlib] - Training completed at iteration 61
[2025-11-19 09:00:03,340] [INFO] [<frozen importlib] - Best train loss: 0.5827
[2025-11-19 09:00:03,340] [INFO] [<frozen importlib] - Best val loss: 0.4850
[2025-11-19 09:00:03,340] [INFO] [<frozen importlib] - Best val AUC: 0.6972
[2025-11-19 09:00:03,340] [INFO] [<frozen importlib] - Best val AUCPR: 0.2225
[2025-11-19 09:00:03,344] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:00:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:00:17,120] [INFO] [<frozen importlib] - Optimal threshold: 0.4568
[2025-11-19 09:00:17,120] [INFO] [<frozen importlib] - Best f1: 0.2617
[2025-11-19 09:00:17,120] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:00:17,167] [INFO] [<frozen importlib] - Validation Results (threshold=0.4568):
[2025-11-19 09:00:17,168] [INFO] [<frozen importlib] -   Accuracy: 0.8836
[2025-11-19 09:00:17,168] [INFO] [<frozen importlib] -   Precision: 0.2552
[2025-11-19 09:00:17,168] [INFO] [<frozen importlib] -   Recall: 0.2686
[2025-11-19 09:00:17,168] [INFO] [<frozen importlib] -   F1 Score: 0.2617
[2025-11-19 09:00:17,168] [INFO] [<frozen importlib] -   AUROC: 0.6972
[2025-11-19 09:00:17,168] [INFO] [<frozen importlib] -   AUPRC: 0.2231
[2025-11-19 09:00:17,168] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:00:17,168] [INFO] [<frozen importlib] -     TN=16307, FP=1138
[2025-11-19 09:00:17,168] [INFO] [<frozen importlib] -     FN=1062, TP=390
[2025-11-19 09:00:17,191] [INFO] [<frozen importlib] - Trial 240: AUPRC=0.2231, F1=0.4407, Prec=0.3914, Rec=0.5041 | Optimizing auprc=0.2231
[2025-11-19 09:00:17,192] [INFO] [<frozen importlib] - Trial 240 pruned.
[2025-11-19 09:00:17,192] [ERROR] [<frozen importlib] - Trial 240 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  48%|████▊     | 240/500 [38:15<31:52,  7.36s/it]Best trial: 140. Best value: 0.237476:  48%|████▊     | 240/500 [38:15<31:52,  7.36s/it]Best trial: 140. Best value: 0.237476:  48%|████▊     | 241/500 [38:15<40:36,  9.41s/it][2025-11-19 09:00:17,202] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.249259599914376
[2025-11-19 09:00:17,202] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   gamma: 0.24261732110246328
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   alpha: 0.5478410571934917
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   lambda: 0.9220562968146531
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   learning_rate: 0.03948764386708215
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   subsample: 0.7816176807774078
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   colsample_bytree: 0.5192138708354912
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5091859958881286
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   colsample_bynode: 0.7721939301102265
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:00:17,203] [INFO] [<frozen importlib] -   scale_pos_weight: 7.249259599914376
[2025-11-19 09:00:17,278] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:00:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:00:17,192] Trial 240 pruned. 
[0]	train-logloss:0.71222	train-auc:0.63969	train-aucpr:0.21718	val-logloss:0.71167	val-auc:0.66682	val-aucpr:0.15231
[10]	train-logloss:0.68610	train-auc:0.68037	train-aucpr:0.28746	val-logloss:0.66024	val-auc:0.66313	val-aucpr:0.18747
[20]	train-logloss:0.67026	train-auc:0.69009	train-aucpr:0.29647	val-logloss:0.60774	val-auc:0.70968	val-aucpr:0.22322
[30]	train-logloss:0.65981	train-auc:0.69248	train-aucpr:0.30323	val-logloss:0.57380	val-auc:0.71495	val-aucpr:0.23319
[40]	train-logloss:0.65185	train-auc:0.69762	train-aucpr:0.30979	val-logloss:0.56008	val-auc:0.71635	val-aucpr:0.23347
[50]	train-logloss:0.64572	train-auc:0.70225	train-aucpr:0.31405	val-logloss:0.54044	val-auc:0.71225	val-aucpr:0.22736
[60]	train-logloss:0.64144	train-auc:0.70531	train-aucpr:0.31836	val-logloss:0.53412	val-auc:0.71271	val-aucpr:0.23080
[68]	train-logloss:0.63864	train-auc:0.70934	train-aucpr:0.32126	val-logloss:0.51340	val-auc:0.70803	val-aucpr:0.22313
[2025-11-19 09:00:17,485] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 09:00:17,485] [INFO] [<frozen importlib] - Best train loss: 0.6526
[2025-11-19 09:00:17,485] [INFO] [<frozen importlib] - Best val loss: 0.5591
[2025-11-19 09:00:17,485] [INFO] [<frozen importlib] - Best val AUC: 0.7185
[2025-11-19 09:00:17,485] [INFO] [<frozen importlib] - Best val AUCPR: 0.2353
[2025-11-19 09:00:17,491] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:00:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:00:28,015] [INFO] [<frozen importlib] - Optimal threshold: 0.5138
[2025-11-19 09:00:28,015] [INFO] [<frozen importlib] - Best f1: 0.2850
[2025-11-19 09:00:28,015] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:00:28,060] [INFO] [<frozen importlib] - Validation Results (threshold=0.5138):
[2025-11-19 09:00:28,060] [INFO] [<frozen importlib] -   Accuracy: 0.9058
[2025-11-19 09:00:28,060] [INFO] [<frozen importlib] -   Precision: 0.3417
[2025-11-19 09:00:28,060] [INFO] [<frozen importlib] -   Recall: 0.2445
[2025-11-19 09:00:28,060] [INFO] [<frozen importlib] -   F1 Score: 0.2850
[2025-11-19 09:00:28,060] [INFO] [<frozen importlib] -   AUROC: 0.7185
[2025-11-19 09:00:28,060] [INFO] [<frozen importlib] -   AUPRC: 0.2357
[2025-11-19 09:00:28,060] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:00:28,060] [INFO] [<frozen importlib] -     TN=16761, FP=684
[2025-11-19 09:00:28,060] [INFO] [<frozen importlib] -     FN=1097, TP=355
[2025-11-19 09:00:28,091] [INFO] [<frozen importlib] - Trial 241: AUPRC=0.2357, F1=0.4465, Prec=0.4730, Rec=0.4229 | Optimizing auprc=0.2357
                                                                                        Best trial: 140. Best value: 0.237476:  48%|████▊     | 241/500 [38:26<40:36,  9.41s/it]Best trial: 140. Best value: 0.237476:  48%|████▊     | 241/500 [38:26<40:36,  9.41s/it]Best trial: 140. Best value: 0.237476:  48%|████▊     | 242/500 [38:26<42:22,  9.85s/it][2025-11-19 09:00:28,102] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.390453754688748
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   gamma: 0.22378435107728964
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   alpha: 0.5584456590600827
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   lambda: 0.8981970341672577
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   learning_rate: 0.03924906888574182
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   subsample: 0.780437660388948
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   colsample_bytree: 0.5216393628842785
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5068565246234756
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   colsample_bynode: 0.77167065845157
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:00:28,102] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:00:28,103] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:00:28,103] [INFO] [<frozen importlib] -   scale_pos_weight: 7.390453754688748
[2025-11-19 09:00:28,178] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:00:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:00:28,092] Trial 241 finished with value: 0.2357125481199977 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.24261732110246328, 'learning_rate': 0.03948764386708215, 'n_estimators': 450, 'alpha': 0.5478410571934917, 'lambda': 0.9220562968146531, 'subsample': 0.7816176807774078, 'colsample_bytree': 0.5192138708354912, 'colsample_bylevel': 0.5091859958881286, 'colsample_bynode': 0.7721939301102265, 'scale_pos_weight': 7.249259599914376}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.71969	train-auc:0.63969	train-aucpr:0.21718	val-logloss:0.72008	val-auc:0.66682	val-aucpr:0.15231
[10]	train-logloss:0.69332	train-auc:0.68043	train-aucpr:0.28764	val-logloss:0.66809	val-auc:0.66324	val-aucpr:0.18753
[20]	train-logloss:0.67734	train-auc:0.68940	train-aucpr:0.29639	val-logloss:0.61439	val-auc:0.70595	val-aucpr:0.22084
[30]	train-logloss:0.66682	train-auc:0.69204	train-aucpr:0.30281	val-logloss:0.58108	val-auc:0.71150	val-aucpr:0.23275
[40]	train-logloss:0.65891	train-auc:0.69703	train-aucpr:0.30882	val-logloss:0.56593	val-auc:0.71181	val-aucpr:0.23387
[50]	train-logloss:0.65263	train-auc:0.70174	train-aucpr:0.31324	val-logloss:0.54566	val-auc:0.70820	val-aucpr:0.22655
[60]	train-logloss:0.64826	train-auc:0.70478	train-aucpr:0.31744	val-logloss:0.53906	val-auc:0.71043	val-aucpr:0.23094
[69]	train-logloss:0.64491	train-auc:0.70910	train-aucpr:0.32046	val-logloss:0.51967	val-auc:0.70642	val-aucpr:0.22331
[2025-11-19 09:00:28,389] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 09:00:28,389] [INFO] [<frozen importlib] - Best train loss: 0.6596
[2025-11-19 09:00:28,389] [INFO] [<frozen importlib] - Best val loss: 0.5648
[2025-11-19 09:00:28,389] [INFO] [<frozen importlib] - Best val AUC: 0.7142
[2025-11-19 09:00:28,389] [INFO] [<frozen importlib] - Best val AUCPR: 0.2364
[2025-11-19 09:00:28,394] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:00:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:00:39,157] [INFO] [<frozen importlib] - Optimal threshold: 0.5077
[2025-11-19 09:00:39,157] [INFO] [<frozen importlib] - Best f1: 0.2843
[2025-11-19 09:00:39,157] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:00:39,201] [INFO] [<frozen importlib] - Validation Results (threshold=0.5077):
[2025-11-19 09:00:39,201] [INFO] [<frozen importlib] -   Accuracy: 0.9006
[2025-11-19 09:00:39,201] [INFO] [<frozen importlib] -   Precision: 0.3183
[2025-11-19 09:00:39,201] [INFO] [<frozen importlib] -   Recall: 0.2569
[2025-11-19 09:00:39,201] [INFO] [<frozen importlib] -   F1 Score: 0.2843
[2025-11-19 09:00:39,201] [INFO] [<frozen importlib] -   AUROC: 0.7142
[2025-11-19 09:00:39,201] [INFO] [<frozen importlib] -   AUPRC: 0.2367
[2025-11-19 09:00:39,201] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:00:39,201] [INFO] [<frozen importlib] -     TN=16646, FP=799
[2025-11-19 09:00:39,201] [INFO] [<frozen importlib] -     FN=1079, TP=373
[2025-11-19 09:00:39,225] [INFO] [<frozen importlib] - Trial 242: AUPRC=0.2367, F1=0.4454, Prec=0.4467, Rec=0.4442 | Optimizing auprc=0.2367
                                                                                        Best trial: 140. Best value: 0.237476:  48%|████▊     | 242/500 [38:37<42:22,  9.85s/it]Best trial: 140. Best value: 0.237476:  48%|████▊     | 242/500 [38:37<42:22,  9.85s/it]Best trial: 140. Best value: 0.237476:  49%|████▊     | 243/500 [38:37<43:51, 10.24s/it][2025-11-19 09:00:39,246] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.321860903971896
[2025-11-19 09:00:39,246] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:00:39,246] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:00:39,246] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:00:39,246] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:00:39,246] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:00:39,246] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:00:39,246] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   gamma: 0.21558565920661998
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   alpha: 0.548745183396923
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   lambda: 1.0514685931403904
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   learning_rate: 0.03746928535486479
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   subsample: 0.7813615518282466
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   colsample_bytree: 0.5275115053258853
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5050947588380651
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   colsample_bynode: 0.7771449330268803
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:00:39,247] [INFO] [<frozen importlib] -   scale_pos_weight: 7.321860903971896
[2025-11-19 09:00:39,330] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:00:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:00:39,226] Trial 242 finished with value: 0.23665143678827302 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.22378435107728964, 'learning_rate': 0.03924906888574182, 'n_estimators': 450, 'alpha': 0.5584456590600827, 'lambda': 0.8981970341672577, 'subsample': 0.780437660388948, 'colsample_bytree': 0.5216393628842785, 'colsample_bylevel': 0.5068565246234756, 'colsample_bynode': 0.77167065845157, 'scale_pos_weight': 7.390453754688748}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.71630	train-auc:0.63315	train-aucpr:0.21853	val-logloss:0.71821	val-auc:0.62309	val-aucpr:0.11160
[10]	train-logloss:0.69069	train-auc:0.68131	train-aucpr:0.28548	val-logloss:0.65968	val-auc:0.67627	val-aucpr:0.19680
[20]	train-logloss:0.67517	train-auc:0.68707	train-aucpr:0.29634	val-logloss:0.61839	val-auc:0.70260	val-aucpr:0.22120
[30]	train-logloss:0.66462	train-auc:0.69134	train-aucpr:0.30191	val-logloss:0.58302	val-auc:0.69419	val-aucpr:0.22286
[40]	train-logloss:0.65670	train-auc:0.69663	train-aucpr:0.30792	val-logloss:0.57005	val-auc:0.69617	val-aucpr:0.21997
[50]	train-logloss:0.65071	train-auc:0.70095	train-aucpr:0.31135	val-logloss:0.54990	val-auc:0.69832	val-aucpr:0.22350
[60]	train-logloss:0.64630	train-auc:0.70389	train-aucpr:0.31493	val-logloss:0.53959	val-auc:0.69884	val-aucpr:0.22720
[70]	train-logloss:0.64234	train-auc:0.70845	train-aucpr:0.31894	val-logloss:0.54052	val-auc:0.70428	val-aucpr:0.22855
[80]	train-logloss:0.63921	train-auc:0.71205	train-aucpr:0.32300	val-logloss:0.53867	val-auc:0.70439	val-aucpr:0.22154
[90]	train-logloss:0.63649	train-auc:0.71618	train-aucpr:0.32670	val-logloss:0.51908	val-auc:0.70109	val-aucpr:0.21649
[95]	train-logloss:0.63542	train-auc:0.71772	train-aucpr:0.32820	val-logloss:0.51672	val-auc:0.70035	val-aucpr:0.21682
[2025-11-19 09:00:39,607] [INFO] [<frozen importlib] - Training completed at iteration 66
[2025-11-19 09:00:39,607] [INFO] [<frozen importlib] - Best train loss: 0.6438
[2025-11-19 09:00:39,607] [INFO] [<frozen importlib] - Best val loss: 0.5397
[2025-11-19 09:00:39,607] [INFO] [<frozen importlib] - Best val AUC: 0.7003
[2025-11-19 09:00:39,607] [INFO] [<frozen importlib] - Best val AUCPR: 0.2292
[2025-11-19 09:00:39,612] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:00:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:00:52,949] [INFO] [<frozen importlib] - Optimal threshold: 0.5153
[2025-11-19 09:00:52,949] [INFO] [<frozen importlib] - Best f1: 0.2781
[2025-11-19 09:00:52,949] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:00:52,999] [INFO] [<frozen importlib] - Validation Results (threshold=0.5153):
[2025-11-19 09:00:52,999] [INFO] [<frozen importlib] -   Accuracy: 0.8956
[2025-11-19 09:00:52,999] [INFO] [<frozen importlib] -   Precision: 0.2966
[2025-11-19 09:00:52,999] [INFO] [<frozen importlib] -   Recall: 0.2617
[2025-11-19 09:00:52,999] [INFO] [<frozen importlib] -   F1 Score: 0.2781
[2025-11-19 09:00:52,999] [INFO] [<frozen importlib] -   AUROC: 0.7003
[2025-11-19 09:00:52,999] [INFO] [<frozen importlib] -   AUPRC: 0.2295
[2025-11-19 09:00:52,999] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:00:52,999] [INFO] [<frozen importlib] -     TN=16544, FP=901
[2025-11-19 09:00:52,999] [INFO] [<frozen importlib] -     FN=1072, TP=380
[2025-11-19 09:00:53,022] [INFO] [<frozen importlib] - Trial 243: AUPRC=0.2295, F1=0.4525, Prec=0.4330, Rec=0.4738 | Optimizing auprc=0.2295
                                                                                        Best trial: 140. Best value: 0.237476:  49%|████▊     | 243/500 [38:50<43:51, 10.24s/it]Best trial: 140. Best value: 0.237476:  49%|████▊     | 243/500 [38:50<43:51, 10.24s/it]Best trial: 140. Best value: 0.237476:  49%|████▉     | 244/500 [38:50<48:14, 11.31s/it][2025-11-19 09:00:53,036] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.895842233034605
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   gamma: 0.19337061505463396
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   alpha: 0.4941321874520097
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   lambda: 0.8995612468611545
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   learning_rate: 0.036330290369885256
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   subsample: 0.7629125029187573
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   colsample_bytree: 0.5181441793955287
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5006694900733397
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   colsample_bynode: 0.7822660839915383
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:00:53,036] [INFO] [<frozen importlib] -   scale_pos_weight: 6.895842233034605
[2025-11-19 09:00:53,111] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:00:53] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:00:53,023] Trial 243 finished with value: 0.229523996336115 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.21558565920661998, 'learning_rate': 0.03746928535486479, 'n_estimators': 450, 'alpha': 0.548745183396923, 'lambda': 1.0514685931403904, 'subsample': 0.7813615518282466, 'colsample_bytree': 0.5275115053258853, 'colsample_bylevel': 0.5050947588380651, 'colsample_bynode': 0.7771449330268803, 'scale_pos_weight': 7.321860903971896}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.69352	train-auc:0.63979	train-aucpr:0.21701	val-logloss:0.69089	val-auc:0.66458	val-aucpr:0.14968
[10]	train-logloss:0.66935	train-auc:0.68513	train-aucpr:0.29432	val-logloss:0.63372	val-auc:0.70420	val-aucpr:0.21415
[20]	train-logloss:0.65454	train-auc:0.68952	train-aucpr:0.29973	val-logloss:0.59802	val-auc:0.69607	val-aucpr:0.20563
[30]	train-logloss:0.64414	train-auc:0.69372	train-aucpr:0.30562	val-logloss:0.56842	val-auc:0.70182	val-aucpr:0.22066
[40]	train-logloss:0.63673	train-auc:0.69774	train-aucpr:0.30873	val-logloss:0.55137	val-auc:0.71213	val-aucpr:0.21759
[50]	train-logloss:0.63071	train-auc:0.70224	train-aucpr:0.31319	val-logloss:0.55225	val-auc:0.70089	val-aucpr:0.21345
[60]	train-logloss:0.62598	train-auc:0.70562	train-aucpr:0.31788	val-logloss:0.53783	val-auc:0.69941	val-aucpr:0.21476
[70]	train-logloss:0.62257	train-auc:0.70954	train-aucpr:0.32126	val-logloss:0.52856	val-auc:0.70432	val-aucpr:0.21851
[74]	train-logloss:0.62139	train-auc:0.71088	train-aucpr:0.32310	val-logloss:0.52933	val-auc:0.70277	val-aucpr:0.21244
[2025-11-19 09:00:53,335] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 09:00:53,335] [INFO] [<frozen importlib] - Best train loss: 0.6335
[2025-11-19 09:00:53,335] [INFO] [<frozen importlib] - Best val loss: 0.5491
[2025-11-19 09:00:53,335] [INFO] [<frozen importlib] - Best val AUC: 0.7133
[2025-11-19 09:00:53,335] [INFO] [<frozen importlib] - Best val AUCPR: 0.2242
[2025-11-19 09:00:53,340] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:00:53] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:01:04,851] [INFO] [<frozen importlib] - Optimal threshold: 0.5062
[2025-11-19 09:01:04,851] [INFO] [<frozen importlib] - Best f1: 0.2739
[2025-11-19 09:01:04,851] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:01:04,895] [INFO] [<frozen importlib] - Validation Results (threshold=0.5062):
[2025-11-19 09:01:04,895] [INFO] [<frozen importlib] -   Accuracy: 0.9015
[2025-11-19 09:01:04,895] [INFO] [<frozen importlib] -   Precision: 0.3159
[2025-11-19 09:01:04,895] [INFO] [<frozen importlib] -   Recall: 0.2417
[2025-11-19 09:01:04,895] [INFO] [<frozen importlib] -   F1 Score: 0.2739
[2025-11-19 09:01:04,895] [INFO] [<frozen importlib] -   AUROC: 0.7133
[2025-11-19 09:01:04,895] [INFO] [<frozen importlib] -   AUPRC: 0.2249
[2025-11-19 09:01:04,895] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:01:04,895] [INFO] [<frozen importlib] -     TN=16685, FP=760
[2025-11-19 09:01:04,895] [INFO] [<frozen importlib] -     FN=1101, TP=351
[2025-11-19 09:01:04,921] [INFO] [<frozen importlib] - Trial 244: AUPRC=0.2249, F1=0.4401, Prec=0.4509, Rec=0.4298 | Optimizing auprc=0.2249
[2025-11-19 09:01:04,921] [INFO] [<frozen importlib] - Trial 244 pruned.
[2025-11-19 09:01:04,921] [ERROR] [<frozen importlib] - Trial 244 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  49%|████▉     | 244/500 [39:02<48:14, 11.31s/it]Best trial: 140. Best value: 0.237476:  49%|████▉     | 244/500 [39:02<48:14, 11.31s/it]Best trial: 140. Best value: 0.237476:  49%|████▉     | 245/500 [39:02<48:48, 11.48s/it][2025-11-19 09:01:04,932] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.200754903683905
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   gamma: 0.2355938604168927
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   alpha: 0.5707824497636088
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   lambda: 0.9930451120319933
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   learning_rate: 0.03906978945547872
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   subsample: 0.7958409262066013
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   colsample_bytree: 0.5759842730735881
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5118579957197648
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   colsample_bynode: 0.7678567569280247
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:01:04,932] [INFO] [<frozen importlib] -   scale_pos_weight: 7.200754903683905
[2025-11-19 09:01:05,001] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:01:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:01:04,921] Trial 244 pruned. 
[0]	train-logloss:0.70932	train-auc:0.64747	train-aucpr:0.22144	val-logloss:0.70652	val-auc:0.65783	val-aucpr:0.14845
[10]	train-logloss:0.68312	train-auc:0.68454	train-aucpr:0.29094	val-logloss:0.63984	val-auc:0.71602	val-aucpr:0.22120
[20]	train-logloss:0.66744	train-auc:0.68924	train-aucpr:0.29846	val-logloss:0.60176	val-auc:0.71342	val-aucpr:0.22110
[30]	train-logloss:0.65680	train-auc:0.69468	train-aucpr:0.30466	val-logloss:0.57462	val-auc:0.71130	val-aucpr:0.22435
[40]	train-logloss:0.64954	train-auc:0.70056	train-aucpr:0.30971	val-logloss:0.57026	val-auc:0.71067	val-aucpr:0.22748
[50]	train-logloss:0.64320	train-auc:0.70479	train-aucpr:0.31432	val-logloss:0.56417	val-auc:0.71023	val-aucpr:0.22940
[60]	train-logloss:0.63862	train-auc:0.70839	train-aucpr:0.31818	val-logloss:0.55392	val-auc:0.70722	val-aucpr:0.23007
[70]	train-logloss:0.63515	train-auc:0.71100	train-aucpr:0.32188	val-logloss:0.53923	val-auc:0.70981	val-aucpr:0.23064
[76]	train-logloss:0.63323	train-auc:0.71375	train-aucpr:0.32437	val-logloss:0.53568	val-auc:0.70800	val-aucpr:0.22692
[2025-11-19 09:01:05,230] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 09:01:05,230] [INFO] [<frozen importlib] - Best train loss: 0.6448
[2025-11-19 09:01:05,230] [INFO] [<frozen importlib] - Best val loss: 0.5603
[2025-11-19 09:01:05,230] [INFO] [<frozen importlib] - Best val AUC: 0.7148
[2025-11-19 09:01:05,230] [INFO] [<frozen importlib] - Best val AUCPR: 0.2324
[2025-11-19 09:01:05,234] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:01:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:01:15,958] [INFO] [<frozen importlib] - Optimal threshold: 0.5090
[2025-11-19 09:01:15,958] [INFO] [<frozen importlib] - Best f1: 0.2732
[2025-11-19 09:01:15,958] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:01:16,011] [INFO] [<frozen importlib] - Validation Results (threshold=0.5090):
[2025-11-19 09:01:16,011] [INFO] [<frozen importlib] -   Accuracy: 0.8902
[2025-11-19 09:01:16,011] [INFO] [<frozen importlib] -   Precision: 0.2780
[2025-11-19 09:01:16,011] [INFO] [<frozen importlib] -   Recall: 0.2686
[2025-11-19 09:01:16,011] [INFO] [<frozen importlib] -   F1 Score: 0.2732
[2025-11-19 09:01:16,011] [INFO] [<frozen importlib] -   AUROC: 0.7148
[2025-11-19 09:01:16,011] [INFO] [<frozen importlib] -   AUPRC: 0.2327
[2025-11-19 09:01:16,011] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:01:16,011] [INFO] [<frozen importlib] -     TN=16432, FP=1013
[2025-11-19 09:01:16,011] [INFO] [<frozen importlib] -     FN=1062, TP=390
[2025-11-19 09:01:16,036] [INFO] [<frozen importlib] - Trial 245: AUPRC=0.2327, F1=0.4254, Prec=0.3967, Rec=0.4587 | Optimizing auprc=0.2327
                                                                                        Best trial: 140. Best value: 0.237476:  49%|████▉     | 245/500 [39:14<48:48, 11.48s/it]Best trial: 140. Best value: 0.237476:  49%|████▉     | 245/500 [39:14<48:48, 11.48s/it]Best trial: 140. Best value: 0.237476:  49%|████▉     | 246/500 [39:14<48:08, 11.37s/it][2025-11-19 09:01:16,050] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.348938293539137
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   gamma: 0.22361282711129826
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   alpha: 0.6277250188164549
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   lambda: 1.1754864817409665
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   learning_rate: 0.03900008004115053
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   subsample: 0.7946399134693745
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   colsample_bytree: 0.5386502729362771
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5142661445752466
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   colsample_bynode: 0.7698445188221573
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:01:16,050] [INFO] [<frozen importlib] -   scale_pos_weight: 7.348938293539137
[2025-11-19 09:01:16,126] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:01:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:01:16,037] Trial 245 finished with value: 0.2326865643026324 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.2355938604168927, 'learning_rate': 0.03906978945547872, 'n_estimators': 450, 'alpha': 0.5707824497636088, 'lambda': 0.9930451120319933, 'subsample': 0.7958409262066013, 'colsample_bytree': 0.5759842730735881, 'colsample_bylevel': 0.5118579957197648, 'colsample_bynode': 0.7678567569280247, 'scale_pos_weight': 7.200754903683905}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.71758	train-auc:0.63482	train-aucpr:0.21843	val-logloss:0.71969	val-auc:0.62189	val-aucpr:0.10981
[10]	train-logloss:0.69139	train-auc:0.68057	train-aucpr:0.29080	val-logloss:0.66428	val-auc:0.66443	val-aucpr:0.19569
[20]	train-logloss:0.67537	train-auc:0.68690	train-aucpr:0.30018	val-logloss:0.62366	val-auc:0.69797	val-aucpr:0.21830
[30]	train-logloss:0.66460	train-auc:0.69151	train-aucpr:0.30529	val-logloss:0.60197	val-auc:0.69916	val-aucpr:0.22646
[40]	train-logloss:0.65639	train-auc:0.69697	train-aucpr:0.31037	val-logloss:0.57824	val-auc:0.69730	val-aucpr:0.22877
[50]	train-logloss:0.65042	train-auc:0.70111	train-aucpr:0.31394	val-logloss:0.56728	val-auc:0.69948	val-aucpr:0.22713
[60]	train-logloss:0.64593	train-auc:0.70484	train-aucpr:0.31716	val-logloss:0.55937	val-auc:0.70717	val-aucpr:0.22706
[70]	train-logloss:0.64252	train-auc:0.70770	train-aucpr:0.32078	val-logloss:0.55110	val-auc:0.70521	val-aucpr:0.22492
[76]	train-logloss:0.64079	train-auc:0.71015	train-aucpr:0.32276	val-logloss:0.54419	val-auc:0.70296	val-aucpr:0.22365
[2025-11-19 09:01:16,364] [INFO] [<frozen importlib] - Training completed at iteration 46
[2025-11-19 09:01:16,364] [INFO] [<frozen importlib] - Best train loss: 0.6525
[2025-11-19 09:01:16,364] [INFO] [<frozen importlib] - Best val loss: 0.5654
[2025-11-19 09:01:16,364] [INFO] [<frozen importlib] - Best val AUC: 0.7042
[2025-11-19 09:01:16,364] [INFO] [<frozen importlib] - Best val AUCPR: 0.2318
[2025-11-19 09:01:16,369] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:01:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:01:28,600] [INFO] [<frozen importlib] - Optimal threshold: 0.5196
[2025-11-19 09:01:28,600] [INFO] [<frozen importlib] - Best f1: 0.2720
[2025-11-19 09:01:28,600] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:01:28,644] [INFO] [<frozen importlib] - Validation Results (threshold=0.5196):
[2025-11-19 09:01:28,644] [INFO] [<frozen importlib] -   Accuracy: 0.9003
[2025-11-19 09:01:28,644] [INFO] [<frozen importlib] -   Precision: 0.3099
[2025-11-19 09:01:28,644] [INFO] [<frozen importlib] -   Recall: 0.2424
[2025-11-19 09:01:28,644] [INFO] [<frozen importlib] -   F1 Score: 0.2720
[2025-11-19 09:01:28,644] [INFO] [<frozen importlib] -   AUROC: 0.7042
[2025-11-19 09:01:28,644] [INFO] [<frozen importlib] -   AUPRC: 0.2321
[2025-11-19 09:01:28,644] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:01:28,644] [INFO] [<frozen importlib] -     TN=16661, FP=784
[2025-11-19 09:01:28,644] [INFO] [<frozen importlib] -     FN=1100, TP=352
[2025-11-19 09:01:28,666] [INFO] [<frozen importlib] - Trial 246: AUPRC=0.2321, F1=0.4418, Prec=0.4471, Rec=0.4366 | Optimizing auprc=0.2321
                                                                                        Best trial: 140. Best value: 0.237476:  49%|████▉     | 246/500 [39:26<48:08, 11.37s/it]Best trial: 140. Best value: 0.237476:  49%|████▉     | 246/500 [39:26<48:08, 11.37s/it]Best trial: 140. Best value: 0.237476:  49%|████▉     | 247/500 [39:26<49:32, 11.75s/it][2025-11-19 09:01:28,679] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.36332681235875
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   gamma: 0.18000054529970866
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   alpha: 0.6249916872396422
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   lambda: 0.9704757291739655
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   learning_rate: 0.03883667746918093
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   subsample: 0.7982409977004414
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   colsample_bytree: 0.5410658497870748
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   colsample_bylevel: 0.508506072190562
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   colsample_bynode: 0.7701314142936501
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:01:28,679] [INFO] [<frozen importlib] -   scale_pos_weight: 7.36332681235875
[2025-11-19 09:01:28,754] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:01:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:01:28,667] Trial 246 finished with value: 0.23211013780797324 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.22361282711129826, 'learning_rate': 0.03900008004115053, 'n_estimators': 450, 'alpha': 0.6277250188164549, 'lambda': 1.1754864817409665, 'subsample': 0.7946399134693745, 'colsample_bytree': 0.5386502729362771, 'colsample_bylevel': 0.5142661445752466, 'colsample_bynode': 0.7698445188221573, 'scale_pos_weight': 7.348938293539137}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.71833	train-auc:0.63681	train-aucpr:0.21920	val-logloss:0.72040	val-auc:0.62970	val-aucpr:0.11235
[10]	train-logloss:0.69213	train-auc:0.68083	train-aucpr:0.29085	val-logloss:0.66476	val-auc:0.66379	val-aucpr:0.19350
[20]	train-logloss:0.67612	train-auc:0.68719	train-aucpr:0.30031	val-logloss:0.62415	val-auc:0.69749	val-aucpr:0.21813
[30]	train-logloss:0.66529	train-auc:0.69212	train-aucpr:0.30541	val-logloss:0.59212	val-auc:0.69870	val-aucpr:0.22403
[40]	train-logloss:0.65715	train-auc:0.69745	train-aucpr:0.31024	val-logloss:0.57626	val-auc:0.69913	val-aucpr:0.22583
[50]	train-logloss:0.65116	train-auc:0.70167	train-aucpr:0.31486	val-logloss:0.55918	val-auc:0.69015	val-aucpr:0.22142
[60]	train-logloss:0.64658	train-auc:0.70490	train-aucpr:0.31901	val-logloss:0.54629	val-auc:0.69843	val-aucpr:0.22714
[70]	train-logloss:0.64268	train-auc:0.70914	train-aucpr:0.32344	val-logloss:0.53729	val-auc:0.70542	val-aucpr:0.22350
[80]	train-logloss:0.63926	train-auc:0.71321	train-aucpr:0.32769	val-logloss:0.53720	val-auc:0.70647	val-aucpr:0.22162
[90]	train-logloss:0.63638	train-auc:0.71786	train-aucpr:0.33095	val-logloss:0.53025	val-auc:0.70409	val-aucpr:0.21813
[92]	train-logloss:0.63591	train-auc:0.71839	train-aucpr:0.33163	val-logloss:0.52932	val-auc:0.70393	val-aucpr:0.21817
[2025-11-19 09:01:29,022] [INFO] [<frozen importlib] - Training completed at iteration 63
[2025-11-19 09:01:29,022] [INFO] [<frozen importlib] - Best train loss: 0.6454
[2025-11-19 09:01:29,022] [INFO] [<frozen importlib] - Best val loss: 0.5455
[2025-11-19 09:01:29,022] [INFO] [<frozen importlib] - Best val AUC: 0.7018
[2025-11-19 09:01:29,022] [INFO] [<frozen importlib] - Best val AUCPR: 0.2295
[2025-11-19 09:01:29,027] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:01:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:01:42,446] [INFO] [<frozen importlib] - Optimal threshold: 0.5166
[2025-11-19 09:01:42,446] [INFO] [<frozen importlib] - Best f1: 0.2741
[2025-11-19 09:01:42,446] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:01:42,493] [INFO] [<frozen importlib] - Validation Results (threshold=0.5166):
[2025-11-19 09:01:42,493] [INFO] [<frozen importlib] -   Accuracy: 0.8982
[2025-11-19 09:01:42,493] [INFO] [<frozen importlib] -   Precision: 0.3033
[2025-11-19 09:01:42,493] [INFO] [<frozen importlib] -   Recall: 0.2500
[2025-11-19 09:01:42,493] [INFO] [<frozen importlib] -   F1 Score: 0.2741
[2025-11-19 09:01:42,493] [INFO] [<frozen importlib] -   AUROC: 0.7018
[2025-11-19 09:01:42,493] [INFO] [<frozen importlib] -   AUPRC: 0.2298
[2025-11-19 09:01:42,493] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:01:42,493] [INFO] [<frozen importlib] -     TN=16611, FP=834
[2025-11-19 09:01:42,493] [INFO] [<frozen importlib] -     FN=1089, TP=363
[2025-11-19 09:01:42,517] [INFO] [<frozen importlib] - Trial 247: AUPRC=0.2298, F1=0.4637, Prec=0.4528, Rec=0.4752 | Optimizing auprc=0.2298
                                                                                        Best trial: 140. Best value: 0.237476:  49%|████▉     | 247/500 [39:40<49:32, 11.75s/it]Best trial: 140. Best value: 0.237476:  49%|████▉     | 247/500 [39:40<49:32, 11.75s/it]Best trial: 140. Best value: 0.237476:  50%|████▉     | 248/500 [39:40<51:59, 12.38s/it][2025-11-19 09:01:42,530] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.203830072564142
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   gamma: 0.21235441531509766
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   alpha: 0.5630217225047888
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   lambda: 1.1443440106195442
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   learning_rate: 0.04067982277018376
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   subsample: 0.794417787757574
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   colsample_bytree: 0.5603495057078255
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5152551218017093
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   colsample_bynode: 0.7863161731897372
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:01:42,530] [INFO] [<frozen importlib] -   scale_pos_weight: 7.203830072564142
[2025-11-19 09:01:42,606] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:01:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:01:42,518] Trial 247 finished with value: 0.22983121751776536 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.18000054529970866, 'learning_rate': 0.03883667746918093, 'n_estimators': 450, 'alpha': 0.6249916872396422, 'lambda': 0.9704757291739655, 'subsample': 0.7982409977004414, 'colsample_bytree': 0.5410658497870748, 'colsample_bylevel': 0.508506072190562, 'colsample_bynode': 0.7701314142936501, 'scale_pos_weight': 7.36332681235875}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.70931	train-auc:0.64695	train-aucpr:0.22560	val-logloss:0.70738	val-auc:0.65337	val-aucpr:0.14808
[10]	train-logloss:0.68240	train-auc:0.68212	train-aucpr:0.29365	val-logloss:0.64650	val-auc:0.67832	val-aucpr:0.17453
[20]	train-logloss:0.66673	train-auc:0.68829	train-aucpr:0.30030	val-logloss:0.60401	val-auc:0.69377	val-aucpr:0.20928
[30]	train-logloss:0.65618	train-auc:0.69541	train-aucpr:0.30472	val-logloss:0.59424	val-auc:0.69808	val-aucpr:0.22011
[40]	train-logloss:0.64851	train-auc:0.70008	train-aucpr:0.30849	val-logloss:0.56434	val-auc:0.70459	val-aucpr:0.21805
[50]	train-logloss:0.64242	train-auc:0.70462	train-aucpr:0.31254	val-logloss:0.53857	val-auc:0.70466	val-aucpr:0.21388
[60]	train-logloss:0.63833	train-auc:0.70790	train-aucpr:0.31668	val-logloss:0.53679	val-auc:0.70206	val-aucpr:0.21727
[64]	train-logloss:0.63681	train-auc:0.70979	train-aucpr:0.31844	val-logloss:0.53238	val-auc:0.70139	val-aucpr:0.21342
[2025-11-19 09:01:42,808] [INFO] [<frozen importlib] - Training completed at iteration 35
[2025-11-19 09:01:42,808] [INFO] [<frozen importlib] - Best train loss: 0.6521
[2025-11-19 09:01:42,808] [INFO] [<frozen importlib] - Best val loss: 0.5760
[2025-11-19 09:01:42,808] [INFO] [<frozen importlib] - Best val AUC: 0.7036
[2025-11-19 09:01:42,808] [INFO] [<frozen importlib] - Best val AUCPR: 0.2214
[2025-11-19 09:01:42,813] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:01:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:01:52,263] [INFO] [<frozen importlib] - Optimal threshold: 0.5086
[2025-11-19 09:01:52,263] [INFO] [<frozen importlib] - Best f1: 0.2692
[2025-11-19 09:01:52,263] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:01:52,305] [INFO] [<frozen importlib] - Validation Results (threshold=0.5086):
[2025-11-19 09:01:52,305] [INFO] [<frozen importlib] -   Accuracy: 0.8799
[2025-11-19 09:01:52,305] [INFO] [<frozen importlib] -   Precision: 0.2529
[2025-11-19 09:01:52,305] [INFO] [<frozen importlib] -   Recall: 0.2879
[2025-11-19 09:01:52,305] [INFO] [<frozen importlib] -   F1 Score: 0.2692
[2025-11-19 09:01:52,305] [INFO] [<frozen importlib] -   AUROC: 0.7036
[2025-11-19 09:01:52,306] [INFO] [<frozen importlib] -   AUPRC: 0.2218
[2025-11-19 09:01:52,306] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:01:52,306] [INFO] [<frozen importlib] -     TN=16210, FP=1235
[2025-11-19 09:01:52,306] [INFO] [<frozen importlib] -     FN=1034, TP=418
[2025-11-19 09:01:52,327] [INFO] [<frozen importlib] - Trial 248: AUPRC=0.2218, F1=0.4382, Prec=0.3791, Rec=0.5193 | Optimizing auprc=0.2218
[2025-11-19 09:01:52,327] [INFO] [<frozen importlib] - Trial 248 pruned.
[2025-11-19 09:01:52,328] [ERROR] [<frozen importlib] - Trial 248 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  50%|████▉     | 248/500 [39:50<51:59, 12.38s/it]Best trial: 140. Best value: 0.237476:  50%|████▉     | 248/500 [39:50<51:59, 12.38s/it]Best trial: 140. Best value: 0.237476:  50%|████▉     | 249/500 [39:50<48:33, 11.61s/it][2025-11-19 09:01:52,339] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.570844092377139
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   gamma: 0.23324198236969537
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   alpha: 0.5983762298709907
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   lambda: 0.984026374221543
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   learning_rate: 0.037898644431232205
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   subsample: 0.7863739327335377
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   colsample_bytree: 0.5375638577790138
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5133165854189566
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   colsample_bynode: 0.7707518556449356
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:01:52,339] [INFO] [<frozen importlib] -   scale_pos_weight: 7.570844092377139
[2025-11-19 09:01:52,413] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:01:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:01:52,328] Trial 248 pruned. 
[0]	train-logloss:0.72931	train-auc:0.63482	train-aucpr:0.21843	val-logloss:0.73291	val-auc:0.62189	val-aucpr:0.10981
[10]	train-logloss:0.70324	train-auc:0.68166	train-aucpr:0.29009	val-logloss:0.67846	val-auc:0.65982	val-aucpr:0.16611
[20]	train-logloss:0.68702	train-auc:0.68789	train-aucpr:0.30036	val-logloss:0.64172	val-auc:0.69489	val-aucpr:0.21553
[30]	train-logloss:0.67615	train-auc:0.69169	train-aucpr:0.30455	val-logloss:0.60510	val-auc:0.69930	val-aucpr:0.22642
[40]	train-logloss:0.66768	train-auc:0.69692	train-aucpr:0.30987	val-logloss:0.58619	val-auc:0.69836	val-aucpr:0.22695
[50]	train-logloss:0.66157	train-auc:0.70128	train-aucpr:0.31365	val-logloss:0.57490	val-auc:0.70092	val-aucpr:0.22544
[60]	train-logloss:0.65685	train-auc:0.70456	train-aucpr:0.31675	val-logloss:0.55528	val-auc:0.70744	val-aucpr:0.22610
[70]	train-logloss:0.65309	train-auc:0.70795	train-aucpr:0.32068	val-logloss:0.56133	val-auc:0.70759	val-aucpr:0.22565
[76]	train-logloss:0.65105	train-auc:0.71105	train-aucpr:0.32348	val-logloss:0.55290	val-auc:0.70681	val-aucpr:0.22536
[2025-11-19 09:01:52,641] [INFO] [<frozen importlib] - Training completed at iteration 46
[2025-11-19 09:01:52,641] [INFO] [<frozen importlib] - Best train loss: 0.6637
[2025-11-19 09:01:52,641] [INFO] [<frozen importlib] - Best val loss: 0.5730
[2025-11-19 09:01:52,641] [INFO] [<frozen importlib] - Best val AUC: 0.7058
[2025-11-19 09:01:52,641] [INFO] [<frozen importlib] - Best val AUCPR: 0.2297
[2025-11-19 09:01:52,646] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:01:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:02:05,182] [INFO] [<frozen importlib] - Optimal threshold: 0.5205
[2025-11-19 09:02:05,182] [INFO] [<frozen importlib] - Best f1: 0.2739
[2025-11-19 09:02:05,182] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:02:05,235] [INFO] [<frozen importlib] - Validation Results (threshold=0.5205):
[2025-11-19 09:02:05,235] [INFO] [<frozen importlib] -   Accuracy: 0.8981
[2025-11-19 09:02:05,235] [INFO] [<frozen importlib] -   Precision: 0.3028
[2025-11-19 09:02:05,235] [INFO] [<frozen importlib] -   Recall: 0.2500
[2025-11-19 09:02:05,235] [INFO] [<frozen importlib] -   F1 Score: 0.2739
[2025-11-19 09:02:05,235] [INFO] [<frozen importlib] -   AUROC: 0.7058
[2025-11-19 09:02:05,235] [INFO] [<frozen importlib] -   AUPRC: 0.2301
[2025-11-19 09:02:05,235] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:02:05,235] [INFO] [<frozen importlib] -     TN=16609, FP=836
[2025-11-19 09:02:05,235] [INFO] [<frozen importlib] -     FN=1089, TP=363
[2025-11-19 09:02:05,260] [INFO] [<frozen importlib] - Trial 249: AUPRC=0.2301, F1=0.4467, Prec=0.4404, Rec=0.4532 | Optimizing auprc=0.2301
                                                                                        Best trial: 140. Best value: 0.237476:  50%|████▉     | 249/500 [40:03<48:33, 11.61s/it]Best trial: 140. Best value: 0.237476:  50%|████▉     | 249/500 [40:03<48:33, 11.61s/it]Best trial: 140. Best value: 0.237476:  50%|█████     | 250/500 [40:03<50:01, 12.01s/it][2025-11-19 09:02:05,272] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.200089568758863
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   gamma: 0.16324275272350136
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   alpha: 0.6505433081890176
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   lambda: 1.1974086282582188
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   learning_rate: 0.039555187109508456
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   subsample: 0.8049264959071678
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   colsample_bytree: 0.7833563963012478
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5069392291337734
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   colsample_bynode: 0.7663330153384601
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:02:05,272] [INFO] [<frozen importlib] -   scale_pos_weight: 7.200089568758863
[2025-11-19 09:02:05,345] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:02:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:02:05,261] Trial 249 finished with value: 0.23008226158357956 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.23324198236969537, 'learning_rate': 0.037898644431232205, 'n_estimators': 450, 'alpha': 0.5983762298709907, 'lambda': 0.984026374221543, 'subsample': 0.7863739327335377, 'colsample_bytree': 0.5375638577790138, 'colsample_bylevel': 0.5133165854189566, 'colsample_bynode': 0.7707518556449356, 'scale_pos_weight': 7.570844092377139}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.70898	train-auc:0.65351	train-aucpr:0.24734	val-logloss:0.70534	val-auc:0.62603	val-aucpr:0.12095
[10]	train-logloss:0.68238	train-auc:0.67970	train-aucpr:0.28754	val-logloss:0.64137	val-auc:0.70015	val-aucpr:0.19741
[20]	train-logloss:0.66604	train-auc:0.69005	train-aucpr:0.29656	val-logloss:0.59953	val-auc:0.69148	val-aucpr:0.19942
[30]	train-logloss:0.65523	train-auc:0.69576	train-aucpr:0.30630	val-logloss:0.56254	val-auc:0.69313	val-aucpr:0.20521
[40]	train-logloss:0.64781	train-auc:0.70042	train-aucpr:0.31022	val-logloss:0.54089	val-auc:0.69369	val-aucpr:0.20453
[50]	train-logloss:0.64172	train-auc:0.70449	train-aucpr:0.31593	val-logloss:0.53427	val-auc:0.69396	val-aucpr:0.20591
[60]	train-logloss:0.63681	train-auc:0.70903	train-aucpr:0.32106	val-logloss:0.52117	val-auc:0.69826	val-aucpr:0.21223
[70]	train-logloss:0.63321	train-auc:0.71321	train-aucpr:0.32480	val-logloss:0.50984	val-auc:0.68728	val-aucpr:0.20286
[80]	train-logloss:0.63022	train-auc:0.71578	train-aucpr:0.32792	val-logloss:0.50590	val-auc:0.68830	val-aucpr:0.20660
[86]	train-logloss:0.62846	train-auc:0.71807	train-aucpr:0.33039	val-logloss:0.51031	val-auc:0.68235	val-aucpr:0.19829
[2025-11-19 09:02:05,598] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:02:05,598] [INFO] [<frozen importlib] - Best train loss: 0.6389
[2025-11-19 09:02:05,598] [INFO] [<frozen importlib] - Best val loss: 0.5322
[2025-11-19 09:02:05,598] [INFO] [<frozen importlib] - Best val AUC: 0.7009
[2025-11-19 09:02:05,598] [INFO] [<frozen importlib] - Best val AUCPR: 0.2128
[2025-11-19 09:02:05,603] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:02:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:02:17,772] [INFO] [<frozen importlib] - Optimal threshold: 0.5001
[2025-11-19 09:02:17,772] [INFO] [<frozen importlib] - Best f1: 0.2689
[2025-11-19 09:02:17,772] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:02:17,819] [INFO] [<frozen importlib] - Validation Results (threshold=0.5001):
[2025-11-19 09:02:17,819] [INFO] [<frozen importlib] -   Accuracy: 0.9047
[2025-11-19 09:02:17,819] [INFO] [<frozen importlib] -   Precision: 0.3277
[2025-11-19 09:02:17,819] [INFO] [<frozen importlib] -   Recall: 0.2280
[2025-11-19 09:02:17,819] [INFO] [<frozen importlib] -   F1 Score: 0.2689
[2025-11-19 09:02:17,819] [INFO] [<frozen importlib] -   AUROC: 0.7009
[2025-11-19 09:02:17,819] [INFO] [<frozen importlib] -   AUPRC: 0.2134
[2025-11-19 09:02:17,819] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:02:17,819] [INFO] [<frozen importlib] -     TN=16766, FP=679
[2025-11-19 09:02:17,819] [INFO] [<frozen importlib] -     FN=1121, TP=331
[2025-11-19 09:02:17,843] [INFO] [<frozen importlib] - Trial 250: AUPRC=0.2134, F1=0.4541, Prec=0.4797, Rec=0.4311 | Optimizing auprc=0.2134
[2025-11-19 09:02:17,844] [INFO] [<frozen importlib] - Trial 250 pruned.
[2025-11-19 09:02:17,844] [ERROR] [<frozen importlib] - Trial 250 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  50%|█████     | 250/500 [40:15<50:01, 12.01s/it]Best trial: 140. Best value: 0.237476:  50%|█████     | 250/500 [40:15<50:01, 12.01s/it]Best trial: 140. Best value: 0.237476:  50%|█████     | 251/500 [40:15<50:32, 12.18s/it][2025-11-19 09:02:17,857] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.418777754284066
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   gamma: 0.200037961907373
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   alpha: 0.5448679328190084
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   lambda: 1.2461969979665395
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   learning_rate: 0.03565819386266789
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   subsample: 0.7780699297447023
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   colsample_bytree: 0.5475870065610154
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5228827150347749
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   colsample_bynode: 0.7826620179153061
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:02:17,857] [INFO] [<frozen importlib] -   scale_pos_weight: 7.418777754284066
[2025-11-19 09:02:17,934] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:02:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:02:17,844] Trial 250 pruned. 
[0]	train-logloss:0.72103	train-auc:0.64754	train-aucpr:0.23371	val-logloss:0.71986	val-auc:0.61626	val-aucpr:0.13299
[10]	train-logloss:0.69601	train-auc:0.68273	train-aucpr:0.28985	val-logloss:0.65886	val-auc:0.68506	val-aucpr:0.18790
[20]	train-logloss:0.68064	train-auc:0.68739	train-aucpr:0.29915	val-logloss:0.61635	val-auc:0.69427	val-aucpr:0.20403
[30]	train-logloss:0.67021	train-auc:0.69184	train-aucpr:0.30384	val-logloss:0.58452	val-auc:0.70192	val-aucpr:0.21968
[40]	train-logloss:0.66264	train-auc:0.69526	train-aucpr:0.30728	val-logloss:0.56404	val-auc:0.70217	val-aucpr:0.22272
[50]	train-logloss:0.65620	train-auc:0.69946	train-aucpr:0.31179	val-logloss:0.55775	val-auc:0.70403	val-aucpr:0.22664
[60]	train-logloss:0.65161	train-auc:0.70356	train-aucpr:0.31512	val-logloss:0.55039	val-auc:0.70383	val-aucpr:0.22902
[70]	train-logloss:0.64737	train-auc:0.70805	train-aucpr:0.31963	val-logloss:0.54044	val-auc:0.69711	val-aucpr:0.22223
[80]	train-logloss:0.64363	train-auc:0.71142	train-aucpr:0.32434	val-logloss:0.53378	val-auc:0.69963	val-aucpr:0.22362
[86]	train-logloss:0.64192	train-auc:0.71367	train-aucpr:0.32631	val-logloss:0.52262	val-auc:0.69113	val-aucpr:0.22108
[2025-11-19 09:02:18,186] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:02:18,186] [INFO] [<frozen importlib] - Best train loss: 0.6532
[2025-11-19 09:02:18,186] [INFO] [<frozen importlib] - Best val loss: 0.5494
[2025-11-19 09:02:18,186] [INFO] [<frozen importlib] - Best val AUC: 0.7055
[2025-11-19 09:02:18,186] [INFO] [<frozen importlib] - Best val AUCPR: 0.2304
[2025-11-19 09:02:18,192] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:02:18] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:02:29,570] [INFO] [<frozen importlib] - Optimal threshold: 0.5338
[2025-11-19 09:02:29,570] [INFO] [<frozen importlib] - Best f1: 0.2722
[2025-11-19 09:02:29,570] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:02:29,613] [INFO] [<frozen importlib] - Validation Results (threshold=0.5338):
[2025-11-19 09:02:29,613] [INFO] [<frozen importlib] -   Accuracy: 0.9083
[2025-11-19 09:02:29,613] [INFO] [<frozen importlib] -   Precision: 0.3488
[2025-11-19 09:02:29,613] [INFO] [<frozen importlib] -   Recall: 0.2231
[2025-11-19 09:02:29,613] [INFO] [<frozen importlib] -   F1 Score: 0.2722
[2025-11-19 09:02:29,613] [INFO] [<frozen importlib] -   AUROC: 0.7055
[2025-11-19 09:02:29,613] [INFO] [<frozen importlib] -   AUPRC: 0.2307
[2025-11-19 09:02:29,613] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:02:29,613] [INFO] [<frozen importlib] -     TN=16840, FP=605
[2025-11-19 09:02:29,613] [INFO] [<frozen importlib] -     FN=1128, TP=324
[2025-11-19 09:02:29,638] [INFO] [<frozen importlib] - Trial 251: AUPRC=0.2307, F1=0.4470, Prec=0.4946, Rec=0.4077 | Optimizing auprc=0.2307
                                                                                        Best trial: 140. Best value: 0.237476:  50%|█████     | 251/500 [40:27<50:32, 12.18s/it]Best trial: 140. Best value: 0.237476:  50%|█████     | 251/500 [40:27<50:32, 12.18s/it]Best trial: 140. Best value: 0.237476:  50%|█████     | 252/500 [40:27<49:51, 12.06s/it][2025-11-19 09:02:29,650] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 16.605304504873587
[2025-11-19 09:02:29,650] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:02:29,650] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   gamma: 0.20039828209505425
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   alpha: 0.5744128827401671
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   lambda: 1.1253963119261838
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   learning_rate: 0.03399853984237678
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   subsample: 0.7792885196577154
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   colsample_bytree: 0.5480484462226649
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5213387485146402
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   colsample_bynode: 0.7853521632173138
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:02:29,651] [INFO] [<frozen importlib] -   scale_pos_weight: 16.605304504873587
[2025-11-19 09:02:29,727] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:02:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:02:29,638] Trial 251 finished with value: 0.23073755836642787 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.200037961907373, 'learning_rate': 0.03565819386266789, 'n_estimators': 450, 'alpha': 0.5448679328190084, 'lambda': 1.2461969979665395, 'subsample': 0.7780699297447023, 'colsample_bytree': 0.5475870065610154, 'colsample_bylevel': 0.5228827150347749, 'colsample_bynode': 0.7826620179153061, 'scale_pos_weight': 7.418777754284066}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:1.08287	train-auc:0.64635	train-aucpr:0.23162	val-logloss:1.11514	val-auc:0.61673	val-aucpr:0.12687
[10]	train-logloss:1.04895	train-auc:0.68205	train-aucpr:0.28395	val-logloss:1.02822	val-auc:0.67944	val-aucpr:0.19131
[20]	train-logloss:1.03018	train-auc:0.68768	train-aucpr:0.29485	val-logloss:0.96400	val-auc:0.68838	val-aucpr:0.20549
[30]	train-logloss:1.01777	train-auc:0.69280	train-aucpr:0.29969	val-logloss:0.92134	val-auc:0.69387	val-aucpr:0.21049
[40]	train-logloss:1.00862	train-auc:0.69707	train-aucpr:0.30364	val-logloss:0.88682	val-auc:0.69117	val-aucpr:0.21395
[50]	train-logloss:1.00075	train-auc:0.70146	train-aucpr:0.30803	val-logloss:0.87237	val-auc:0.69891	val-aucpr:0.21356
[60]	train-logloss:0.99420	train-auc:0.70607	train-aucpr:0.31188	val-logloss:0.85092	val-auc:0.69489	val-aucpr:0.21997
[70]	train-logloss:0.98938	train-auc:0.70889	train-aucpr:0.31556	val-logloss:0.83503	val-auc:0.69322	val-aucpr:0.21782
[80]	train-logloss:0.98492	train-auc:0.71248	train-aucpr:0.31859	val-logloss:0.77998	val-auc:0.69515	val-aucpr:0.20841
[90]	train-logloss:0.98063	train-auc:0.71532	train-aucpr:0.32217	val-logloss:0.76458	val-auc:0.69361	val-aucpr:0.20967
[2025-11-19 09:02:29,989] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:02:29,989] [INFO] [<frozen importlib] - Best train loss: 0.9942
[2025-11-19 09:02:29,989] [INFO] [<frozen importlib] - Best val loss: 0.8509
[2025-11-19 09:02:29,989] [INFO] [<frozen importlib] - Best val AUC: 0.6949
[2025-11-19 09:02:29,989] [INFO] [<frozen importlib] - Best val AUCPR: 0.2200
[2025-11-19 09:02:29,994] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:02:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:02:42,604] [INFO] [<frozen importlib] - Optimal threshold: 0.6996
[2025-11-19 09:02:42,604] [INFO] [<frozen importlib] - Best f1: 0.2560
[2025-11-19 09:02:42,604] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:02:42,658] [INFO] [<frozen importlib] - Validation Results (threshold=0.6996):
[2025-11-19 09:02:42,658] [INFO] [<frozen importlib] -   Accuracy: 0.9037
[2025-11-19 09:02:42,658] [INFO] [<frozen importlib] -   Precision: 0.3152
[2025-11-19 09:02:42,658] [INFO] [<frozen importlib] -   Recall: 0.2156
[2025-11-19 09:02:42,658] [INFO] [<frozen importlib] -   F1 Score: 0.2560
[2025-11-19 09:02:42,658] [INFO] [<frozen importlib] -   AUROC: 0.6949
[2025-11-19 09:02:42,658] [INFO] [<frozen importlib] -   AUPRC: 0.2203
[2025-11-19 09:02:42,658] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:02:42,658] [INFO] [<frozen importlib] -     TN=16765, FP=680
[2025-11-19 09:02:42,658] [INFO] [<frozen importlib] -     FN=1139, TP=313
[2025-11-19 09:02:42,682] [INFO] [<frozen importlib] - Trial 252: AUPRC=0.2203, F1=0.4645, Prec=0.4868, Rec=0.4442 | Optimizing auprc=0.2203
[2025-11-19 09:02:42,682] [INFO] [<frozen importlib] - Trial 252 pruned.
[2025-11-19 09:02:42,683] [ERROR] [<frozen importlib] - Trial 252 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  50%|█████     | 252/500 [40:40<49:51, 12.06s/it]Best trial: 140. Best value: 0.237476:  50%|█████     | 252/500 [40:40<49:51, 12.06s/it]Best trial: 140. Best value: 0.237476:  51%|█████     | 253/500 [40:40<50:52, 12.36s/it][2025-11-19 09:02:42,696] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 13.935525829242088
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   gamma: 0.25156443101600967
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   alpha: 0.529778559736783
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   lambda: 1.2375285342297937
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   learning_rate: 0.035053536178978086
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   subsample: 0.7932863665021663
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   colsample_bytree: 0.5531391851640264
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6547346197206412
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   colsample_bynode: 0.775863301124705
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:02:42,696] [INFO] [<frozen importlib] -   scale_pos_weight: 13.935525829242088
[2025-11-19 09:02:42,772] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:02:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:02:42,683] Trial 252 pruned. 
[0]	train-logloss:0.99967	train-auc:0.65153	train-aucpr:0.22809	val-logloss:1.02556	val-auc:0.68248	val-aucpr:0.13393
[10]	train-logloss:0.96503	train-auc:0.68502	train-aucpr:0.28106	val-logloss:0.93094	val-auc:0.68878	val-aucpr:0.19530
[20]	train-logloss:0.94467	train-auc:0.69035	train-aucpr:0.29553	val-logloss:0.86693	val-auc:0.69754	val-aucpr:0.20600
[30]	train-logloss:0.93101	train-auc:0.69413	train-aucpr:0.29985	val-logloss:0.81797	val-auc:0.70210	val-aucpr:0.21214
[40]	train-logloss:0.92127	train-auc:0.69888	train-aucpr:0.30428	val-logloss:0.79649	val-auc:0.70082	val-aucpr:0.21050
[50]	train-logloss:0.91295	train-auc:0.70364	train-aucpr:0.30783	val-logloss:0.76874	val-auc:0.70194	val-aucpr:0.21590
[60]	train-logloss:0.90674	train-auc:0.70768	train-aucpr:0.31277	val-logloss:0.75434	val-auc:0.70162	val-aucpr:0.21840
[70]	train-logloss:0.90142	train-auc:0.71156	train-aucpr:0.31696	val-logloss:0.72809	val-auc:0.69941	val-aucpr:0.21453
[80]	train-logloss:0.89642	train-auc:0.71550	train-aucpr:0.32143	val-logloss:0.72800	val-auc:0.69858	val-aucpr:0.21101
[85]	train-logloss:0.89456	train-auc:0.71623	train-aucpr:0.32235	val-logloss:0.72708	val-auc:0.69956	val-aucpr:0.21110
[2025-11-19 09:02:43,022] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:02:43,022] [INFO] [<frozen importlib] - Best train loss: 0.9095
[2025-11-19 09:02:43,022] [INFO] [<frozen importlib] - Best val loss: 0.7579
[2025-11-19 09:02:43,022] [INFO] [<frozen importlib] - Best val AUC: 0.7023
[2025-11-19 09:02:43,022] [INFO] [<frozen importlib] - Best val AUCPR: 0.2212
[2025-11-19 09:02:43,027] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:02:43] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:02:54,754] [INFO] [<frozen importlib] - Optimal threshold: 0.6608
[2025-11-19 09:02:54,755] [INFO] [<frozen importlib] - Best f1: 0.2696
[2025-11-19 09:02:54,755] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:02:54,803] [INFO] [<frozen importlib] - Validation Results (threshold=0.6608):
[2025-11-19 09:02:54,803] [INFO] [<frozen importlib] -   Accuracy: 0.9031
[2025-11-19 09:02:54,803] [INFO] [<frozen importlib] -   Precision: 0.3204
[2025-11-19 09:02:54,803] [INFO] [<frozen importlib] -   Recall: 0.2328
[2025-11-19 09:02:54,803] [INFO] [<frozen importlib] -   F1 Score: 0.2696
[2025-11-19 09:02:54,803] [INFO] [<frozen importlib] -   AUROC: 0.7023
[2025-11-19 09:02:54,803] [INFO] [<frozen importlib] -   AUPRC: 0.2215
[2025-11-19 09:02:54,803] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:02:54,803] [INFO] [<frozen importlib] -     TN=16728, FP=717
[2025-11-19 09:02:54,803] [INFO] [<frozen importlib] -     FN=1114, TP=338
[2025-11-19 09:02:54,828] [INFO] [<frozen importlib] - Trial 253: AUPRC=0.2215, F1=0.4424, Prec=0.4621, Rec=0.4242 | Optimizing auprc=0.2215
[2025-11-19 09:02:54,828] [INFO] [<frozen importlib] - Trial 253 pruned.
[2025-11-19 09:02:54,828] [ERROR] [<frozen importlib] - Trial 253 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  51%|█████     | 253/500 [40:52<50:52, 12.36s/it]Best trial: 140. Best value: 0.237476:  51%|█████     | 253/500 [40:52<50:52, 12.36s/it]Best trial: 140. Best value: 0.237476:  51%|█████     | 254/500 [40:52<50:24, 12.29s/it][2025-11-19 09:02:54,840] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.027093120654203
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   gamma: 0.27221246654857156
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   alpha: 0.6347107774272004
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   lambda: 1.28448015568943
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   learning_rate: 0.03652222206945244
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   subsample: 0.7714959466130551
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   colsample_bytree: 0.5698112905522311
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5187838180957393
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   colsample_bynode: 0.7929333806942641
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:02:54,840] [INFO] [<frozen importlib] -   scale_pos_weight: 7.027093120654203
[2025-11-19 09:02:54,918] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:02:54] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:02:54,828] Trial 253 pruned. 
[0]	train-logloss:0.70023	train-auc:0.64656	train-aucpr:0.22692	val-logloss:0.69676	val-auc:0.62987	val-aucpr:0.12431
[10]	train-logloss:0.67597	train-auc:0.68107	train-aucpr:0.29000	val-logloss:0.63862	val-auc:0.66885	val-aucpr:0.15899
[20]	train-logloss:0.66090	train-auc:0.68863	train-aucpr:0.29731	val-logloss:0.60048	val-auc:0.68529	val-aucpr:0.19782
[30]	train-logloss:0.65032	train-auc:0.69329	train-aucpr:0.30328	val-logloss:0.56652	val-auc:0.69041	val-aucpr:0.20871
[40]	train-logloss:0.64307	train-auc:0.69604	train-aucpr:0.30635	val-logloss:0.55513	val-auc:0.69548	val-aucpr:0.21021
[50]	train-logloss:0.63678	train-auc:0.70053	train-aucpr:0.31198	val-logloss:0.54579	val-auc:0.68792	val-aucpr:0.21282
[60]	train-logloss:0.63244	train-auc:0.70484	train-aucpr:0.31523	val-logloss:0.54090	val-auc:0.69882	val-aucpr:0.22249
[70]	train-logloss:0.62871	train-auc:0.70878	train-aucpr:0.31912	val-logloss:0.52562	val-auc:0.70570	val-aucpr:0.22671
[80]	train-logloss:0.62528	train-auc:0.71312	train-aucpr:0.32368	val-logloss:0.51814	val-auc:0.70322	val-aucpr:0.22322
[90]	train-logloss:0.62242	train-auc:0.71775	train-aucpr:0.32772	val-logloss:0.51049	val-auc:0.69865	val-aucpr:0.21011
[93]	train-logloss:0.62192	train-auc:0.71872	train-aucpr:0.32850	val-logloss:0.50997	val-auc:0.69882	val-aucpr:0.21101
[2025-11-19 09:02:55,215] [INFO] [<frozen importlib] - Training completed at iteration 63
[2025-11-19 09:02:55,215] [INFO] [<frozen importlib] - Best train loss: 0.6313
[2025-11-19 09:02:55,215] [INFO] [<frozen importlib] - Best val loss: 0.5368
[2025-11-19 09:02:55,215] [INFO] [<frozen importlib] - Best val AUC: 0.7055
[2025-11-19 09:02:55,215] [INFO] [<frozen importlib] - Best val AUCPR: 0.2269
[2025-11-19 09:02:55,220] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:02:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:03:08,228] [INFO] [<frozen importlib] - Optimal threshold: 0.5023
[2025-11-19 09:03:08,228] [INFO] [<frozen importlib] - Best f1: 0.2681
[2025-11-19 09:03:08,228] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:03:08,273] [INFO] [<frozen importlib] - Validation Results (threshold=0.5023):
[2025-11-19 09:03:08,273] [INFO] [<frozen importlib] -   Accuracy: 0.8801
[2025-11-19 09:03:08,273] [INFO] [<frozen importlib] -   Precision: 0.2524
[2025-11-19 09:03:08,273] [INFO] [<frozen importlib] -   Recall: 0.2858
[2025-11-19 09:03:08,273] [INFO] [<frozen importlib] -   F1 Score: 0.2681
[2025-11-19 09:03:08,273] [INFO] [<frozen importlib] -   AUROC: 0.7055
[2025-11-19 09:03:08,273] [INFO] [<frozen importlib] -   AUPRC: 0.2272
[2025-11-19 09:03:08,273] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:03:08,273] [INFO] [<frozen importlib] -     TN=16216, FP=1229
[2025-11-19 09:03:08,273] [INFO] [<frozen importlib] -     FN=1037, TP=415
[2025-11-19 09:03:08,298] [INFO] [<frozen importlib] - Trial 254: AUPRC=0.2272, F1=0.4512, Prec=0.3886, Rec=0.5379 | Optimizing auprc=0.2272
[2025-11-19 09:03:08,299] [INFO] [<frozen importlib] - Trial 254 pruned.
[2025-11-19 09:03:08,299] [ERROR] [<frozen importlib] - Trial 254 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  51%|█████     | 254/500 [41:06<50:24, 12.29s/it]Best trial: 140. Best value: 0.237476:  51%|█████     | 254/500 [41:06<50:24, 12.29s/it]Best trial: 140. Best value: 0.237476:  51%|█████     | 255/500 [41:06<51:38, 12.65s/it][2025-11-19 09:03:08,310] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.679793829737761
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   gamma: 0.2165032108535443
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   alpha: 0.5625483970491676
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   lambda: 1.1296571705329466
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   learning_rate: 0.03794285515103575
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   subsample: 0.818767934347696
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   colsample_bytree: 0.5931720515736757
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5017617451243875
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   colsample_bynode: 0.7664035693521791
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:03:08,310] [INFO] [<frozen importlib] -   scale_pos_weight: 6.679793829737761
[2025-11-19 09:03:08,388] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:03:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:03:08,299] Trial 254 pruned. 
[0]	train-logloss:0.68192	train-auc:0.63509	train-aucpr:0.22057	val-logloss:0.67775	val-auc:0.62149	val-aucpr:0.13056
[10]	train-logloss:0.65747	train-auc:0.68247	train-aucpr:0.29062	val-logloss:0.62819	val-auc:0.66885	val-aucpr:0.18101
[20]	train-logloss:0.64254	train-auc:0.68846	train-aucpr:0.29985	val-logloss:0.59111	val-auc:0.68534	val-aucpr:0.21116
[30]	train-logloss:0.63267	train-auc:0.69307	train-aucpr:0.30489	val-logloss:0.56448	val-auc:0.69744	val-aucpr:0.21911
[40]	train-logloss:0.62552	train-auc:0.69707	train-aucpr:0.30925	val-logloss:0.53446	val-auc:0.71543	val-aucpr:0.22496
[50]	train-logloss:0.61946	train-auc:0.70074	train-aucpr:0.31324	val-logloss:0.52425	val-auc:0.71311	val-aucpr:0.22900
[60]	train-logloss:0.61553	train-auc:0.70409	train-aucpr:0.31752	val-logloss:0.51040	val-auc:0.71665	val-aucpr:0.23436
[70]	train-logloss:0.61204	train-auc:0.70751	train-aucpr:0.32138	val-logloss:0.50871	val-auc:0.71381	val-aucpr:0.23027
[80]	train-logloss:0.60897	train-auc:0.71117	train-aucpr:0.32457	val-logloss:0.50189	val-auc:0.71349	val-aucpr:0.22947
[89]	train-logloss:0.60650	train-auc:0.71546	train-aucpr:0.32833	val-logloss:0.48142	val-auc:0.70429	val-aucpr:0.21771
[2025-11-19 09:03:08,646] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:03:08,646] [INFO] [<frozen importlib] - Best train loss: 0.6155
[2025-11-19 09:03:08,646] [INFO] [<frozen importlib] - Best val loss: 0.5104
[2025-11-19 09:03:08,646] [INFO] [<frozen importlib] - Best val AUC: 0.7166
[2025-11-19 09:03:08,646] [INFO] [<frozen importlib] - Best val AUCPR: 0.2344
[2025-11-19 09:03:08,651] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:03:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:03:21,755] [INFO] [<frozen importlib] - Optimal threshold: 0.4775
[2025-11-19 09:03:21,755] [INFO] [<frozen importlib] - Best f1: 0.2831
[2025-11-19 09:03:21,755] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:03:21,799] [INFO] [<frozen importlib] - Validation Results (threshold=0.4775):
[2025-11-19 09:03:21,799] [INFO] [<frozen importlib] -   Accuracy: 0.8896
[2025-11-19 09:03:21,799] [INFO] [<frozen importlib] -   Precision: 0.2824
[2025-11-19 09:03:21,799] [INFO] [<frozen importlib] -   Recall: 0.2837
[2025-11-19 09:03:21,799] [INFO] [<frozen importlib] -   F1 Score: 0.2831
[2025-11-19 09:03:21,799] [INFO] [<frozen importlib] -   AUROC: 0.7166
[2025-11-19 09:03:21,799] [INFO] [<frozen importlib] -   AUPRC: 0.2348
[2025-11-19 09:03:21,799] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:03:21,799] [INFO] [<frozen importlib] -     TN=16398, FP=1047
[2025-11-19 09:03:21,799] [INFO] [<frozen importlib] -     FN=1040, TP=412
[2025-11-19 09:03:21,822] [INFO] [<frozen importlib] - Trial 255: AUPRC=0.2348, F1=0.4444, Prec=0.4055, Rec=0.4917 | Optimizing auprc=0.2348
                                                                                        Best trial: 140. Best value: 0.237476:  51%|█████     | 255/500 [41:19<51:38, 12.65s/it]Best trial: 140. Best value: 0.237476:  51%|█████     | 255/500 [41:19<51:38, 12.65s/it]Best trial: 140. Best value: 0.237476:  51%|█████     | 256/500 [41:19<52:30, 12.91s/it][2025-11-19 09:03:21,833] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.640142039229805
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   gamma: 0.18567242728934719
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   alpha: 0.5572392663374571
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   lambda: 1.2806550094038522
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   learning_rate: 0.03236292175170719
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   subsample: 0.8152413178547891
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   colsample_bytree: 0.5979529547926157
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5019645814946284
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   colsample_bynode: 0.7671253938831137
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:03:21,833] [INFO] [<frozen importlib] -   scale_pos_weight: 6.640142039229805
[2025-11-19 09:03:21,905] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:03:21] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:03:21,822] Trial 255 finished with value: 0.23475075509338256 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.2165032108535443, 'learning_rate': 0.03794285515103575, 'n_estimators': 450, 'alpha': 0.5625483970491676, 'lambda': 1.1296571705329466, 'subsample': 0.818767934347696, 'colsample_bytree': 0.5931720515736757, 'colsample_bylevel': 0.5017617451243875, 'colsample_bynode': 0.7664035693521791, 'scale_pos_weight': 6.679793829737761}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.68014	train-auc:0.63509	train-aucpr:0.22057	val-logloss:0.67612	val-auc:0.62149	val-aucpr:0.13056
[10]	train-logloss:0.65855	train-auc:0.68036	train-aucpr:0.28881	val-logloss:0.63218	val-auc:0.67960	val-aucpr:0.18939
[20]	train-logloss:0.64458	train-auc:0.68616	train-aucpr:0.29737	val-logloss:0.59776	val-auc:0.69037	val-aucpr:0.21610
[30]	train-logloss:0.63483	train-auc:0.68966	train-aucpr:0.30353	val-logloss:0.57010	val-auc:0.69632	val-aucpr:0.22468
[40]	train-logloss:0.62776	train-auc:0.69396	train-aucpr:0.30654	val-logloss:0.54015	val-auc:0.71304	val-aucpr:0.23102
[50]	train-logloss:0.62180	train-auc:0.69827	train-aucpr:0.31013	val-logloss:0.52507	val-auc:0.70877	val-aucpr:0.22923
[60]	train-logloss:0.61731	train-auc:0.70226	train-aucpr:0.31415	val-logloss:0.51775	val-auc:0.70853	val-aucpr:0.22719
[69]	train-logloss:0.61410	train-auc:0.70526	train-aucpr:0.31607	val-logloss:0.51383	val-auc:0.70731	val-aucpr:0.22774
[2025-11-19 09:03:22,114] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 09:03:22,114] [INFO] [<frozen importlib] - Best train loss: 0.6284
[2025-11-19 09:03:22,114] [INFO] [<frozen importlib] - Best val loss: 0.5433
[2025-11-19 09:03:22,114] [INFO] [<frozen importlib] - Best val AUC: 0.7134
[2025-11-19 09:03:22,114] [INFO] [<frozen importlib] - Best val AUCPR: 0.2333
[2025-11-19 09:03:22,118] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:03:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:03:30,237] [INFO] [<frozen importlib] - Optimal threshold: 0.4780
[2025-11-19 09:03:30,237] [INFO] [<frozen importlib] - Best f1: 0.2808
[2025-11-19 09:03:30,237] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:03:30,281] [INFO] [<frozen importlib] - Validation Results (threshold=0.4780):
[2025-11-19 09:03:30,281] [INFO] [<frozen importlib] -   Accuracy: 0.8926
[2025-11-19 09:03:30,281] [INFO] [<frozen importlib] -   Precision: 0.2893
[2025-11-19 09:03:30,281] [INFO] [<frozen importlib] -   Recall: 0.2727
[2025-11-19 09:03:30,281] [INFO] [<frozen importlib] -   F1 Score: 0.2808
[2025-11-19 09:03:30,281] [INFO] [<frozen importlib] -   AUROC: 0.7134
[2025-11-19 09:03:30,281] [INFO] [<frozen importlib] -   AUPRC: 0.2336
[2025-11-19 09:03:30,281] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:03:30,281] [INFO] [<frozen importlib] -     TN=16472, FP=973
[2025-11-19 09:03:30,281] [INFO] [<frozen importlib] -     FN=1056, TP=396
[2025-11-19 09:03:30,304] [INFO] [<frozen importlib] - Trial 256: AUPRC=0.2336, F1=0.4365, Prec=0.4103, Rec=0.4663 | Optimizing auprc=0.2336
                                                                                        Best trial: 140. Best value: 0.237476:  51%|█████     | 256/500 [41:28<52:30, 12.91s/it]Best trial: 140. Best value: 0.237476:  51%|█████     | 256/500 [41:28<52:30, 12.91s/it]Best trial: 140. Best value: 0.237476:  51%|█████▏    | 257/500 [41:28<46:54, 11.58s/it][2025-11-19 09:03:30,315] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.466936394446934
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   gamma: 0.1731293328754927
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   alpha: 0.5477489200989781
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   lambda: 1.3689680222829916
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   learning_rate: 0.03805392376268752
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   subsample: 0.818114876759904
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   colsample_bytree: 0.6016948133872737
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5009759621079686
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   colsample_bynode: 0.7773025378711531
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:03:30,315] [INFO] [<frozen importlib] -   scale_pos_weight: 6.466936394446934
[2025-11-19 09:03:30,389] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:03:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:03:30,304] Trial 256 finished with value: 0.2335811862773538 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.18567242728934719, 'learning_rate': 0.03236292175170719, 'n_estimators': 450, 'alpha': 0.5572392663374571, 'lambda': 1.2806550094038522, 'subsample': 0.8152413178547891, 'colsample_bytree': 0.5979529547926157, 'colsample_bylevel': 0.5019645814946284, 'colsample_bynode': 0.7671253938831137, 'scale_pos_weight': 6.640142039229805}. Best is trial 140 with value: 0.23747621706147465.
[0]	train-logloss:0.66979	train-auc:0.64292	train-aucpr:0.25135	val-logloss:0.66488	val-auc:0.57879	val-aucpr:0.11078
[10]	train-logloss:0.64621	train-auc:0.68156	train-aucpr:0.29026	val-logloss:0.60691	val-auc:0.67198	val-aucpr:0.18054
[20]	train-logloss:0.63143	train-auc:0.68850	train-aucpr:0.29974	val-logloss:0.56851	val-auc:0.66743	val-aucpr:0.19416
[30]	train-logloss:0.62173	train-auc:0.69304	train-aucpr:0.30516	val-logloss:0.54104	val-auc:0.68154	val-aucpr:0.21427
[40]	train-logloss:0.61497	train-auc:0.69705	train-aucpr:0.30988	val-logloss:0.52080	val-auc:0.68503	val-aucpr:0.21700
[50]	train-logloss:0.60892	train-auc:0.70240	train-aucpr:0.31415	val-logloss:0.51288	val-auc:0.68973	val-aucpr:0.21274
[60]	train-logloss:0.60489	train-auc:0.70530	train-aucpr:0.31792	val-logloss:0.50237	val-auc:0.69061	val-aucpr:0.21061
[69]	train-logloss:0.60165	train-auc:0.70872	train-aucpr:0.32168	val-logloss:0.49334	val-auc:0.69037	val-aucpr:0.21597
[2025-11-19 09:03:30,598] [INFO] [<frozen importlib] - Training completed at iteration 40
[2025-11-19 09:03:30,598] [INFO] [<frozen importlib] - Best train loss: 0.6150
[2025-11-19 09:03:30,598] [INFO] [<frozen importlib] - Best val loss: 0.5208
[2025-11-19 09:03:30,598] [INFO] [<frozen importlib] - Best val AUC: 0.6850
[2025-11-19 09:03:30,598] [INFO] [<frozen importlib] - Best val AUCPR: 0.2170
[2025-11-19 09:03:30,602] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:03:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:03:40,411] [INFO] [<frozen importlib] - Optimal threshold: 0.4717
[2025-11-19 09:03:40,411] [INFO] [<frozen importlib] - Best f1: 0.2782
[2025-11-19 09:03:40,411] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:03:40,455] [INFO] [<frozen importlib] - Validation Results (threshold=0.4717):
[2025-11-19 09:03:40,455] [INFO] [<frozen importlib] -   Accuracy: 0.8926
[2025-11-19 09:03:40,455] [INFO] [<frozen importlib] -   Precision: 0.2877
[2025-11-19 09:03:40,455] [INFO] [<frozen importlib] -   Recall: 0.2693
[2025-11-19 09:03:40,455] [INFO] [<frozen importlib] -   F1 Score: 0.2782
[2025-11-19 09:03:40,455] [INFO] [<frozen importlib] -   AUROC: 0.6850
[2025-11-19 09:03:40,455] [INFO] [<frozen importlib] -   AUPRC: 0.2174
[2025-11-19 09:03:40,455] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:03:40,455] [INFO] [<frozen importlib] -     TN=16477, FP=968
[2025-11-19 09:03:40,455] [INFO] [<frozen importlib] -     FN=1061, TP=391
[2025-11-19 09:03:40,478] [INFO] [<frozen importlib] - Trial 257: AUPRC=0.2174, F1=0.4412, Prec=0.4144, Rec=0.4718 | Optimizing auprc=0.2174
[2025-11-19 09:03:40,478] [INFO] [<frozen importlib] - Trial 257 pruned.
[2025-11-19 09:03:40,478] [ERROR] [<frozen importlib] - Trial 257 failed with error: 
                                                                                        Best trial: 140. Best value: 0.237476:  51%|█████▏    | 257/500 [41:38<46:54, 11.58s/it]Best trial: 140. Best value: 0.237476:  51%|█████▏    | 257/500 [41:38<46:54, 11.58s/it]Best trial: 140. Best value: 0.237476:  52%|█████▏    | 258/500 [41:38<45:00, 11.16s/it][2025-11-19 09:03:40,489] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.613479621025834
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   gamma: 0.2095383758839302
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   alpha: 0.5586163831559372
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   lambda: 1.2763756250504896
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   learning_rate: 0.03346250219346732
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   subsample: 0.8248516825314213
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   colsample_bytree: 0.5943432725258049
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5066258185164477
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   colsample_bynode: 0.7663258138137707
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:03:40,489] [INFO] [<frozen importlib] -   scale_pos_weight: 6.613479621025834
[2025-11-19 09:03:40,564] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:03:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:03:40,478] Trial 257 pruned. 
[0]	train-logloss:0.67861	train-auc:0.63509	train-aucpr:0.22057	val-logloss:0.67432	val-auc:0.62149	val-aucpr:0.13056
[10]	train-logloss:0.65653	train-auc:0.68239	train-aucpr:0.28947	val-logloss:0.62917	val-auc:0.67938	val-aucpr:0.18927
[20]	train-logloss:0.64270	train-auc:0.68712	train-aucpr:0.29694	val-logloss:0.59521	val-auc:0.68727	val-aucpr:0.21252
[30]	train-logloss:0.63271	train-auc:0.69080	train-aucpr:0.30381	val-logloss:0.56753	val-auc:0.69359	val-aucpr:0.22721
[40]	train-logloss:0.62543	train-auc:0.69528	train-aucpr:0.30765	val-logloss:0.53605	val-auc:0.70798	val-aucpr:0.23171
[50]	train-logloss:0.61953	train-auc:0.69882	train-aucpr:0.31120	val-logloss:0.52528	val-auc:0.70034	val-aucpr:0.23015
[60]	train-logloss:0.61516	train-auc:0.70280	train-aucpr:0.31497	val-logloss:0.52643	val-auc:0.70712	val-aucpr:0.23208
[70]	train-logloss:0.61161	train-auc:0.70627	train-aucpr:0.31763	val-logloss:0.51497	val-auc:0.70990	val-aucpr:0.23615
[80]	train-logloss:0.60895	train-auc:0.70818	train-aucpr:0.32066	val-logloss:0.51207	val-auc:0.71266	val-aucpr:0.23995
[90]	train-logloss:0.60616	train-auc:0.71155	train-aucpr:0.32393	val-logloss:0.50244	val-auc:0.71171	val-aucpr:0.23457
[100]	train-logloss:0.60367	train-auc:0.71568	train-aucpr:0.32765	val-logloss:0.48678	val-auc:0.71209	val-aucpr:0.23248
[109]	train-logloss:0.60159	train-auc:0.71893	train-aucpr:0.33069	val-logloss:0.47709	val-auc:0.70794	val-aucpr:0.23239
[2025-11-19 09:03:40,872] [INFO] [<frozen importlib] - Training completed at iteration 80
[2025-11-19 09:03:40,872] [INFO] [<frozen importlib] - Best train loss: 0.6089
[2025-11-19 09:03:40,872] [INFO] [<frozen importlib] - Best val loss: 0.5121
[2025-11-19 09:03:40,872] [INFO] [<frozen importlib] - Best val AUC: 0.7127
[2025-11-19 09:03:40,872] [INFO] [<frozen importlib] - Best val AUCPR: 0.2399
[2025-11-19 09:03:40,877] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:03:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:03:54,651] [INFO] [<frozen importlib] - Optimal threshold: 0.4911
[2025-11-19 09:03:54,651] [INFO] [<frozen importlib] - Best f1: 0.2920
[2025-11-19 09:03:54,651] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:03:54,700] [INFO] [<frozen importlib] - Validation Results (threshold=0.4911):
[2025-11-19 09:03:54,700] [INFO] [<frozen importlib] -   Accuracy: 0.8991
[2025-11-19 09:03:54,700] [INFO] [<frozen importlib] -   Precision: 0.3169
[2025-11-19 09:03:54,700] [INFO] [<frozen importlib] -   Recall: 0.2707
[2025-11-19 09:03:54,700] [INFO] [<frozen importlib] -   F1 Score: 0.2920
[2025-11-19 09:03:54,700] [INFO] [<frozen importlib] -   AUROC: 0.7127
[2025-11-19 09:03:54,700] [INFO] [<frozen importlib] -   AUPRC: 0.2403
[2025-11-19 09:03:54,700] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:03:54,700] [INFO] [<frozen importlib] -     TN=16598, FP=847
[2025-11-19 09:03:54,700] [INFO] [<frozen importlib] -     FN=1059, TP=393
[2025-11-19 09:03:54,722] [INFO] [<frozen importlib] - Trial 258: AUPRC=0.2403, F1=0.4503, Prec=0.4409, Rec=0.4601 | Optimizing auprc=0.2403
[2025-11-19 09:03:54,722] [INFO] [<frozen importlib] -   → New best model found! (value=0.2403)
                                                                                        Best trial: 140. Best value: 0.237476:  52%|█████▏    | 258/500 [41:52<45:00, 11.16s/it]Best trial: 258. Best value: 0.240317:  52%|█████▏    | 258/500 [41:52<45:00, 11.16s/it]Best trial: 258. Best value: 0.240317:  52%|█████▏    | 259/500 [41:52<48:32, 12.08s/it][2025-11-19 09:03:54,733] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.633176343117129
[2025-11-19 09:03:54,733] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:03:54,733] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   gamma: 0.1365124813263443
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   alpha: 0.6036754199391288
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   lambda: 1.0064248946595236
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   learning_rate: 0.032869531645352675
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   subsample: 0.8250863488721278
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   colsample_bytree: 0.5927555013569268
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5023630144841116
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   colsample_bynode: 0.7675611213980049
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:03:54,734] [INFO] [<frozen importlib] -   scale_pos_weight: 6.633176343117129
[2025-11-19 09:03:54,812] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:03:54] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:03:54,722] Trial 258 finished with value: 0.24031689511995413 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.2095383758839302, 'learning_rate': 0.03346250219346732, 'n_estimators': 450, 'alpha': 0.5586163831559372, 'lambda': 1.2763756250504896, 'subsample': 0.8248516825314213, 'colsample_bytree': 0.5943432725258049, 'colsample_bylevel': 0.5066258185164477, 'colsample_bynode': 0.7663258138137707, 'scale_pos_weight': 6.613479621025834}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.67974	train-auc:0.62985	train-aucpr:0.21883	val-logloss:0.67583	val-auc:0.62873	val-aucpr:0.13162
[10]	train-logloss:0.65791	train-auc:0.68260	train-aucpr:0.28956	val-logloss:0.63140	val-auc:0.67809	val-aucpr:0.18278
[20]	train-logloss:0.64415	train-auc:0.68717	train-aucpr:0.29690	val-logloss:0.59748	val-auc:0.68785	val-aucpr:0.21008
[30]	train-logloss:0.63421	train-auc:0.69078	train-aucpr:0.30367	val-logloss:0.57007	val-auc:0.69432	val-aucpr:0.22581
[40]	train-logloss:0.62685	train-auc:0.69515	train-aucpr:0.30768	val-logloss:0.53864	val-auc:0.70900	val-aucpr:0.23008
[50]	train-logloss:0.62086	train-auc:0.69842	train-aucpr:0.31060	val-logloss:0.52666	val-auc:0.70336	val-aucpr:0.22937
[60]	train-logloss:0.61646	train-auc:0.70251	train-aucpr:0.31443	val-logloss:0.53043	val-auc:0.70567	val-aucpr:0.22952
[70]	train-logloss:0.61291	train-auc:0.70571	train-aucpr:0.31683	val-logloss:0.51794	val-auc:0.70856	val-aucpr:0.23235
[80]	train-logloss:0.61016	train-auc:0.70810	train-aucpr:0.31992	val-logloss:0.51304	val-auc:0.71089	val-aucpr:0.23524
[90]	train-logloss:0.60731	train-auc:0.71188	train-aucpr:0.32304	val-logloss:0.50992	val-auc:0.70794	val-aucpr:0.23009
[100]	train-logloss:0.60498	train-auc:0.71575	train-aucpr:0.32641	val-logloss:0.49688	val-auc:0.70483	val-aucpr:0.22162
[109]	train-logloss:0.60296	train-auc:0.71840	train-aucpr:0.32924	val-logloss:0.49865	val-auc:0.70410	val-aucpr:0.22223
[2025-11-19 09:03:55,122] [INFO] [<frozen importlib] - Training completed at iteration 80
[2025-11-19 09:03:55,122] [INFO] [<frozen importlib] - Best train loss: 0.6102
[2025-11-19 09:03:55,122] [INFO] [<frozen importlib] - Best val loss: 0.5130
[2025-11-19 09:03:55,122] [INFO] [<frozen importlib] - Best val AUC: 0.7109
[2025-11-19 09:03:55,122] [INFO] [<frozen importlib] - Best val AUCPR: 0.2352
[2025-11-19 09:03:55,127] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:03:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:04:09,031] [INFO] [<frozen importlib] - Optimal threshold: 0.5044
[2025-11-19 09:04:09,031] [INFO] [<frozen importlib] - Best f1: 0.2845
[2025-11-19 09:04:09,031] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:04:09,074] [INFO] [<frozen importlib] - Validation Results (threshold=0.5044):
[2025-11-19 09:04:09,074] [INFO] [<frozen importlib] -   Accuracy: 0.9039
[2025-11-19 09:04:09,074] [INFO] [<frozen importlib] -   Precision: 0.3324
[2025-11-19 09:04:09,074] [INFO] [<frozen importlib] -   Recall: 0.2486
[2025-11-19 09:04:09,074] [INFO] [<frozen importlib] -   F1 Score: 0.2845
[2025-11-19 09:04:09,074] [INFO] [<frozen importlib] -   AUROC: 0.7109
[2025-11-19 09:04:09,074] [INFO] [<frozen importlib] -   AUPRC: 0.2356
[2025-11-19 09:04:09,074] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:04:09,074] [INFO] [<frozen importlib] -     TN=16720, FP=725
[2025-11-19 09:04:09,074] [INFO] [<frozen importlib] -     FN=1091, TP=361
[2025-11-19 09:04:09,100] [INFO] [<frozen importlib] - Trial 259: AUPRC=0.2356, F1=0.4674, Prec=0.4780, Rec=0.4573 | Optimizing auprc=0.2356
                                                                                        Best trial: 258. Best value: 0.240317:  52%|█████▏    | 259/500 [42:07<48:32, 12.08s/it]Best trial: 258. Best value: 0.240317:  52%|█████▏    | 259/500 [42:07<48:32, 12.08s/it]Best trial: 258. Best value: 0.240317:  52%|█████▏    | 260/500 [42:07<51:05, 12.77s/it][2025-11-19 09:04:09,112] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.612881854397394
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   gamma: 0.14953730328541429
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   alpha: 0.6038838496101846
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   lambda: 0.9941370679992135
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   learning_rate: 0.032363060733716455
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   subsample: 0.8280341463774291
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   colsample_bytree: 0.6205689349914976
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5047949479731908
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   colsample_bynode: 0.7675761553007092
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:04:09,112] [INFO] [<frozen importlib] -   scale_pos_weight: 6.612881854397394
[2025-11-19 09:04:09,185] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:04:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:04:09,101] Trial 259 finished with value: 0.23560666353658005 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.1365124813263443, 'learning_rate': 0.032869531645352675, 'n_estimators': 450, 'alpha': 0.6036754199391288, 'lambda': 1.0064248946595236, 'subsample': 0.8250863488721278, 'colsample_bytree': 0.5927555013569268, 'colsample_bylevel': 0.5023630144841116, 'colsample_bynode': 0.7675611213980049, 'scale_pos_weight': 6.633176343117129}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.67851	train-auc:0.63678	train-aucpr:0.21432	val-logloss:0.67331	val-auc:0.60289	val-aucpr:0.10268
[10]	train-logloss:0.65675	train-auc:0.67693	train-aucpr:0.29361	val-logloss:0.62084	val-auc:0.70609	val-aucpr:0.21917
[20]	train-logloss:0.64301	train-auc:0.68383	train-aucpr:0.29706	val-logloss:0.58713	val-auc:0.70498	val-aucpr:0.21850
[30]	train-logloss:0.63345	train-auc:0.69005	train-aucpr:0.30184	val-logloss:0.55732	val-auc:0.70650	val-aucpr:0.22349
[40]	train-logloss:0.62606	train-auc:0.69582	train-aucpr:0.30773	val-logloss:0.53988	val-auc:0.70835	val-aucpr:0.22185
[42]	train-logloss:0.62484	train-auc:0.69609	train-aucpr:0.30803	val-logloss:0.53688	val-auc:0.70793	val-aucpr:0.22099
[2025-11-19 09:04:09,326] [INFO] [<frozen importlib] - Training completed at iteration 12
[2025-11-19 09:04:09,326] [INFO] [<frozen importlib] - Best train loss: 0.6537
[2025-11-19 09:04:09,326] [INFO] [<frozen importlib] - Best val loss: 0.6139
[2025-11-19 09:04:09,326] [INFO] [<frozen importlib] - Best val AUC: 0.7056
[2025-11-19 09:04:09,326] [INFO] [<frozen importlib] - Best val AUCPR: 0.2265
[2025-11-19 09:04:09,331] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:04:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:04:11,421] [INFO] [<frozen importlib] - Optimal threshold: 0.4880
[2025-11-19 09:04:11,421] [INFO] [<frozen importlib] - Best f1: 0.2733
[2025-11-19 09:04:11,421] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:04:11,464] [INFO] [<frozen importlib] - Validation Results (threshold=0.4880):
[2025-11-19 09:04:11,464] [INFO] [<frozen importlib] -   Accuracy: 0.8815
[2025-11-19 09:04:11,464] [INFO] [<frozen importlib] -   Precision: 0.2584
[2025-11-19 09:04:11,464] [INFO] [<frozen importlib] -   Recall: 0.2899
[2025-11-19 09:04:11,464] [INFO] [<frozen importlib] -   F1 Score: 0.2733
[2025-11-19 09:04:11,464] [INFO] [<frozen importlib] -   AUROC: 0.7056
[2025-11-19 09:04:11,464] [INFO] [<frozen importlib] -   AUPRC: 0.2244
[2025-11-19 09:04:11,464] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:04:11,464] [INFO] [<frozen importlib] -     TN=16237, FP=1208
[2025-11-19 09:04:11,464] [INFO] [<frozen importlib] -     FN=1031, TP=421
[2025-11-19 09:04:11,487] [INFO] [<frozen importlib] - Trial 260: AUPRC=0.2244, F1=0.4265, Prec=0.3738, Rec=0.4966 | Optimizing auprc=0.2244
                                                                                        Best trial: 258. Best value: 0.240317:  52%|█████▏    | 260/500 [42:09<51:05, 12.77s/it]Best trial: 258. Best value: 0.240317:  52%|█████▏    | 260/500 [42:09<51:05, 12.77s/it]Best trial: 258. Best value: 0.240317:  52%|█████▏    | 261/500 [42:09<38:27,  9.66s/it][2025-11-19 09:04:11,498] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.252851982792066
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   gamma: 0.18108927871711006
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   alpha: 0.6739109954918288
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   lambda: 1.104421389925803
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   learning_rate: 0.03323835784473882
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   subsample: 0.8213365012291428
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   colsample_bytree: 0.6003633730587329
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5004532030543043
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   colsample_bynode: 0.7660826732320928
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:04:11,498] [INFO] [<frozen importlib] -   scale_pos_weight: 6.252851982792066
[2025-11-19 09:04:11,569] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:04:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:04:11,487] Trial 260 finished with value: 0.22439190538900766 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.14953730328541429, 'learning_rate': 0.032363060733716455, 'n_estimators': 450, 'alpha': 0.6038838496101846, 'lambda': 0.9941370679992135, 'subsample': 0.8280341463774291, 'colsample_bytree': 0.6205689349914976, 'colsample_bylevel': 0.5047949479731908, 'colsample_bynode': 0.7675761553007092, 'scale_pos_weight': 6.612881854397394}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.65834	train-auc:0.64315	train-aucpr:0.25519	val-logloss:0.65192	val-auc:0.58551	val-aucpr:0.11212
[10]	train-logloss:0.63762	train-auc:0.68154	train-aucpr:0.29011	val-logloss:0.60133	val-auc:0.67016	val-aucpr:0.17933
[20]	train-logloss:0.62415	train-auc:0.68631	train-aucpr:0.29652	val-logloss:0.56515	val-auc:0.67020	val-aucpr:0.19894
[30]	train-logloss:0.61469	train-auc:0.68970	train-aucpr:0.30273	val-logloss:0.53800	val-auc:0.69047	val-aucpr:0.21243
[40]	train-logloss:0.60774	train-auc:0.69384	train-aucpr:0.30737	val-logloss:0.51197	val-auc:0.70147	val-aucpr:0.21628
[50]	train-logloss:0.60174	train-auc:0.69760	train-aucpr:0.31125	val-logloss:0.49778	val-auc:0.70154	val-aucpr:0.21859
[60]	train-logloss:0.59783	train-auc:0.70105	train-aucpr:0.31420	val-logloss:0.49067	val-auc:0.70079	val-aucpr:0.21983
[70]	train-logloss:0.59429	train-auc:0.70470	train-aucpr:0.31762	val-logloss:0.48723	val-auc:0.69821	val-aucpr:0.21712
[80]	train-logloss:0.59146	train-auc:0.70785	train-aucpr:0.32090	val-logloss:0.47737	val-auc:0.69642	val-aucpr:0.21575
[85]	train-logloss:0.59025	train-auc:0.70881	train-aucpr:0.32235	val-logloss:0.48008	val-auc:0.69126	val-aucpr:0.21112
[2025-11-19 09:04:11,814] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:04:11,814] [INFO] [<frozen importlib] - Best train loss: 0.5994
[2025-11-19 09:04:11,814] [INFO] [<frozen importlib] - Best val loss: 0.4914
[2025-11-19 09:04:11,814] [INFO] [<frozen importlib] - Best val AUC: 0.7039
[2025-11-19 09:04:11,814] [INFO] [<frozen importlib] - Best val AUCPR: 0.2212
[2025-11-19 09:04:11,818] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:04:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:04:23,393] [INFO] [<frozen importlib] - Optimal threshold: 0.4665
[2025-11-19 09:04:23,393] [INFO] [<frozen importlib] - Best f1: 0.2713
[2025-11-19 09:04:23,393] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:04:23,433] [INFO] [<frozen importlib] - Validation Results (threshold=0.4665):
[2025-11-19 09:04:23,433] [INFO] [<frozen importlib] -   Accuracy: 0.8937
[2025-11-19 09:04:23,433] [INFO] [<frozen importlib] -   Precision: 0.2866
[2025-11-19 09:04:23,433] [INFO] [<frozen importlib] -   Recall: 0.2576
[2025-11-19 09:04:23,433] [INFO] [<frozen importlib] -   F1 Score: 0.2713
[2025-11-19 09:04:23,433] [INFO] [<frozen importlib] -   AUROC: 0.7039
[2025-11-19 09:04:23,433] [INFO] [<frozen importlib] -   AUPRC: 0.2217
[2025-11-19 09:04:23,433] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:04:23,433] [INFO] [<frozen importlib] -     TN=16514, FP=931
[2025-11-19 09:04:23,433] [INFO] [<frozen importlib] -     FN=1078, TP=374
[2025-11-19 09:04:23,458] [INFO] [<frozen importlib] - Trial 261: AUPRC=0.2217, F1=0.4450, Prec=0.4228, Rec=0.4697 | Optimizing auprc=0.2217
[2025-11-19 09:04:23,458] [INFO] [<frozen importlib] - Trial 261 pruned.
[2025-11-19 09:04:23,458] [ERROR] [<frozen importlib] - Trial 261 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  52%|█████▏    | 261/500 [42:21<38:27,  9.66s/it]Best trial: 258. Best value: 0.240317:  52%|█████▏    | 261/500 [42:21<38:27,  9.66s/it]Best trial: 258. Best value: 0.240317:  52%|█████▏    | 262/500 [42:21<41:03, 10.35s/it][2025-11-19 09:04:23,470] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.640976388808842
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   gamma: 0.1916032027755321
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   alpha: 0.6022052594177497
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   lambda: 1.0231887827817991
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   learning_rate: 0.030721026701902694
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   subsample: 0.8128247531063815
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   colsample_bytree: 0.594626164515251
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5097849110218412
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   colsample_bynode: 0.7619038151542097
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:04:23,470] [INFO] [<frozen importlib] -   scale_pos_weight: 6.640976388808842
[2025-11-19 09:04:23,545] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:04:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:04:23,458] Trial 261 pruned. 
[0]	train-logloss:0.68024	train-auc:0.63531	train-aucpr:0.22027	val-logloss:0.67640	val-auc:0.61467	val-aucpr:0.12098
[10]	train-logloss:0.65980	train-auc:0.68149	train-aucpr:0.28889	val-logloss:0.63165	val-auc:0.68865	val-aucpr:0.19389
[20]	train-logloss:0.64629	train-auc:0.68478	train-aucpr:0.29565	val-logloss:0.59519	val-auc:0.69774	val-aucpr:0.21032
[30]	train-logloss:0.63639	train-auc:0.68858	train-aucpr:0.29988	val-logloss:0.56702	val-auc:0.69941	val-aucpr:0.21714
[40]	train-logloss:0.62914	train-auc:0.69411	train-aucpr:0.30348	val-logloss:0.54590	val-auc:0.70564	val-aucpr:0.22288
[50]	train-logloss:0.62291	train-auc:0.69759	train-aucpr:0.30805	val-logloss:0.53348	val-auc:0.70574	val-aucpr:0.22387
[60]	train-logloss:0.61869	train-auc:0.70078	train-aucpr:0.31142	val-logloss:0.52433	val-auc:0.69792	val-aucpr:0.22085
[70]	train-logloss:0.61482	train-auc:0.70432	train-aucpr:0.31537	val-logloss:0.51920	val-auc:0.69684	val-aucpr:0.21754
[74]	train-logloss:0.61362	train-auc:0.70568	train-aucpr:0.31691	val-logloss:0.51353	val-auc:0.70051	val-aucpr:0.21976
[2025-11-19 09:04:23,770] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 09:04:23,770] [INFO] [<frozen importlib] - Best train loss: 0.6264
[2025-11-19 09:04:23,770] [INFO] [<frozen importlib] - Best val loss: 0.5374
[2025-11-19 09:04:23,770] [INFO] [<frozen importlib] - Best val AUC: 0.7086
[2025-11-19 09:04:23,770] [INFO] [<frozen importlib] - Best val AUCPR: 0.2254
[2025-11-19 09:04:23,776] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:04:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:04:32,120] [INFO] [<frozen importlib] - Optimal threshold: 0.4779
[2025-11-19 09:04:32,120] [INFO] [<frozen importlib] - Best f1: 0.2804
[2025-11-19 09:04:32,120] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:04:32,167] [INFO] [<frozen importlib] - Validation Results (threshold=0.4779):
[2025-11-19 09:04:32,168] [INFO] [<frozen importlib] -   Accuracy: 0.8949
[2025-11-19 09:04:32,168] [INFO] [<frozen importlib] -   Precision: 0.2959
[2025-11-19 09:04:32,168] [INFO] [<frozen importlib] -   Recall: 0.2665
[2025-11-19 09:04:32,168] [INFO] [<frozen importlib] -   F1 Score: 0.2804
[2025-11-19 09:04:32,168] [INFO] [<frozen importlib] -   AUROC: 0.7086
[2025-11-19 09:04:32,168] [INFO] [<frozen importlib] -   AUPRC: 0.2257
[2025-11-19 09:04:32,168] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:04:32,168] [INFO] [<frozen importlib] -     TN=16524, FP=921
[2025-11-19 09:04:32,168] [INFO] [<frozen importlib] -     FN=1065, TP=387
[2025-11-19 09:04:32,191] [INFO] [<frozen importlib] - Trial 262: AUPRC=0.2257, F1=0.4388, Prec=0.4200, Rec=0.4594 | Optimizing auprc=0.2257
[2025-11-19 09:04:32,191] [INFO] [<frozen importlib] - Trial 262 pruned.
[2025-11-19 09:04:32,191] [ERROR] [<frozen importlib] - Trial 262 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  52%|█████▏    | 262/500 [42:30<41:03, 10.35s/it]Best trial: 258. Best value: 0.240317:  52%|█████▏    | 262/500 [42:30<41:03, 10.35s/it]Best trial: 258. Best value: 0.240317:  53%|█████▎    | 263/500 [42:30<38:58,  9.87s/it][2025-11-19 09:04:32,202] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.763833065595364
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   gamma: 0.15713429756813146
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   alpha: 0.4609520793886988
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   lambda: 0.8754085021446509
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   learning_rate: 0.03393898476309842
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   subsample: 0.8362812611610023
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   colsample_bytree: 0.6092099996968592
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5097247193850302
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   colsample_bynode: 0.7745807436785043
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:04:32,202] [INFO] [<frozen importlib] -   scale_pos_weight: 6.763833065595364
[2025-11-19 09:04:32,275] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:04:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:04:32,191] Trial 262 pruned. 
[0]	train-logloss:0.68642	train-auc:0.64337	train-aucpr:0.24796	val-logloss:0.68289	val-auc:0.58801	val-aucpr:0.13590
[10]	train-logloss:0.66391	train-auc:0.68108	train-aucpr:0.29271	val-logloss:0.63679	val-auc:0.70392	val-aucpr:0.21692
[20]	train-logloss:0.64969	train-auc:0.68664	train-aucpr:0.29824	val-logloss:0.59434	val-auc:0.71018	val-aucpr:0.22026
[30]	train-logloss:0.63988	train-auc:0.69099	train-aucpr:0.30239	val-logloss:0.56483	val-auc:0.71227	val-aucpr:0.22797
[40]	train-logloss:0.63237	train-auc:0.69609	train-aucpr:0.30753	val-logloss:0.53837	val-auc:0.70884	val-aucpr:0.22326
[50]	train-logloss:0.62630	train-auc:0.70033	train-aucpr:0.31271	val-logloss:0.52878	val-auc:0.70509	val-aucpr:0.22259
[60]	train-logloss:0.62211	train-auc:0.70237	train-aucpr:0.31584	val-logloss:0.51842	val-auc:0.70686	val-aucpr:0.22569
[2025-11-19 09:04:32,463] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 09:04:32,463] [INFO] [<frozen importlib] - Best train loss: 0.6390
[2025-11-19 09:04:32,463] [INFO] [<frozen importlib] - Best val loss: 0.5621
[2025-11-19 09:04:32,463] [INFO] [<frozen importlib] - Best val AUC: 0.7117
[2025-11-19 09:04:32,463] [INFO] [<frozen importlib] - Best val AUCPR: 0.2284
[2025-11-19 09:04:32,467] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:04:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:04:38,460] [INFO] [<frozen importlib] - Optimal threshold: 0.4935
[2025-11-19 09:04:38,460] [INFO] [<frozen importlib] - Best f1: 0.2795
[2025-11-19 09:04:38,460] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:04:38,500] [INFO] [<frozen importlib] - Validation Results (threshold=0.4935):
[2025-11-19 09:04:38,500] [INFO] [<frozen importlib] -   Accuracy: 0.9053
[2025-11-19 09:04:38,500] [INFO] [<frozen importlib] -   Precision: 0.3366
[2025-11-19 09:04:38,500] [INFO] [<frozen importlib] -   Recall: 0.2390
[2025-11-19 09:04:38,500] [INFO] [<frozen importlib] -   F1 Score: 0.2795
[2025-11-19 09:04:38,500] [INFO] [<frozen importlib] -   AUROC: 0.7117
[2025-11-19 09:04:38,500] [INFO] [<frozen importlib] -   AUPRC: 0.2285
[2025-11-19 09:04:38,500] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:04:38,500] [INFO] [<frozen importlib] -     TN=16761, FP=684
[2025-11-19 09:04:38,500] [INFO] [<frozen importlib] -     FN=1105, TP=347
[2025-11-19 09:04:38,525] [INFO] [<frozen importlib] - Trial 263: AUPRC=0.2285, F1=0.4688, Prec=0.4888, Rec=0.4504 | Optimizing auprc=0.2285
                                                                                        Best trial: 258. Best value: 0.240317:  53%|█████▎    | 263/500 [42:36<38:58,  9.87s/it]Best trial: 258. Best value: 0.240317:  53%|█████▎    | 263/500 [42:36<38:58,  9.87s/it]Best trial: 258. Best value: 0.240317:  53%|█████▎    | 264/500 [42:36<34:38,  8.81s/it][2025-11-19 09:04:38,544] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.0566483496857675
[2025-11-19 09:04:38,544] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:04:38,544] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:04:38,544] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:04:38,544] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:04:38,544] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:04:38,544] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:04:38,544] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   gamma: 0.2090850242514129
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   alpha: 0.643143180910713
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   lambda: 1.3440374538114261
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   learning_rate: 0.03483615077556361
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   subsample: 0.8147385790295655
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   colsample_bytree: 0.5865157871887173
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5100773457635984
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   colsample_bynode: 0.7890656203134262
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:04:38,545] [INFO] [<frozen importlib] -   scale_pos_weight: 6.0566483496857675
[2025-11-19 09:04:38,621] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:04:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:04:38,525] Trial 263 finished with value: 0.22854713469749213 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.15713429756813146, 'learning_rate': 0.03393898476309842, 'n_estimators': 450, 'alpha': 0.4609520793886988, 'lambda': 0.8754085021446509, 'subsample': 0.8362812611610023, 'colsample_bytree': 0.6092099996968592, 'colsample_bylevel': 0.5097247193850302, 'colsample_bynode': 0.7745807436785043, 'scale_pos_weight': 6.763833065595364}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.64757	train-auc:0.63569	train-aucpr:0.22752	val-logloss:0.63823	val-auc:0.60702	val-aucpr:0.12738
[10]	train-logloss:0.62645	train-auc:0.67977	train-aucpr:0.28787	val-logloss:0.59957	val-auc:0.70028	val-aucpr:0.17663
[20]	train-logloss:0.61289	train-auc:0.68689	train-aucpr:0.29786	val-logloss:0.56364	val-auc:0.70605	val-aucpr:0.20222
[30]	train-logloss:0.60369	train-auc:0.69024	train-aucpr:0.30228	val-logloss:0.53424	val-auc:0.70633	val-aucpr:0.21884
[40]	train-logloss:0.59718	train-auc:0.69584	train-aucpr:0.30527	val-logloss:0.51778	val-auc:0.70113	val-aucpr:0.21983
[50]	train-logloss:0.59112	train-auc:0.69978	train-aucpr:0.31152	val-logloss:0.49980	val-auc:0.70529	val-aucpr:0.22162
[60]	train-logloss:0.58733	train-auc:0.70280	train-aucpr:0.31472	val-logloss:0.49174	val-auc:0.70618	val-aucpr:0.22275
[70]	train-logloss:0.58374	train-auc:0.70711	train-aucpr:0.31887	val-logloss:0.48485	val-auc:0.70057	val-aucpr:0.21970
[80]	train-logloss:0.58056	train-auc:0.71087	train-aucpr:0.32292	val-logloss:0.47977	val-auc:0.70110	val-aucpr:0.21870
[82]	train-logloss:0.58011	train-auc:0.71134	train-aucpr:0.32330	val-logloss:0.47941	val-auc:0.70100	val-aucpr:0.21933
[2025-11-19 09:04:38,859] [INFO] [<frozen importlib] - Training completed at iteration 53
[2025-11-19 09:04:38,859] [INFO] [<frozen importlib] - Best train loss: 0.5899
[2025-11-19 09:04:38,859] [INFO] [<frozen importlib] - Best val loss: 0.4940
[2025-11-19 09:04:38,859] [INFO] [<frozen importlib] - Best val AUC: 0.7066
[2025-11-19 09:04:38,859] [INFO] [<frozen importlib] - Best val AUCPR: 0.2236
[2025-11-19 09:04:38,865] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:04:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:04:50,512] [INFO] [<frozen importlib] - Optimal threshold: 0.4712
[2025-11-19 09:04:50,512] [INFO] [<frozen importlib] - Best f1: 0.2743
[2025-11-19 09:04:50,512] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:04:50,553] [INFO] [<frozen importlib] - Validation Results (threshold=0.4712):
[2025-11-19 09:04:50,553] [INFO] [<frozen importlib] -   Accuracy: 0.9048
[2025-11-19 09:04:50,553] [INFO] [<frozen importlib] -   Precision: 0.3311
[2025-11-19 09:04:50,553] [INFO] [<frozen importlib] -   Recall: 0.2342
[2025-11-19 09:04:50,553] [INFO] [<frozen importlib] -   F1 Score: 0.2743
[2025-11-19 09:04:50,553] [INFO] [<frozen importlib] -   AUROC: 0.7066
[2025-11-19 09:04:50,553] [INFO] [<frozen importlib] -   AUPRC: 0.2240
[2025-11-19 09:04:50,553] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:04:50,553] [INFO] [<frozen importlib] -     TN=16758, FP=687
[2025-11-19 09:04:50,553] [INFO] [<frozen importlib] -     FN=1112, TP=340
[2025-11-19 09:04:50,576] [INFO] [<frozen importlib] - Trial 264: AUPRC=0.2240, F1=0.4639, Prec=0.4846, Rec=0.4449 | Optimizing auprc=0.2240
                                                                                        Best trial: 258. Best value: 0.240317:  53%|█████▎    | 264/500 [42:48<34:38,  8.81s/it]Best trial: 258. Best value: 0.240317:  53%|█████▎    | 264/500 [42:48<34:38,  8.81s/it]Best trial: 258. Best value: 0.240317:  53%|█████▎    | 265/500 [42:48<38:18,  9.78s/it][2025-11-19 09:04:50,587] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.911190744598498
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   gamma: 0.13221687602674975
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   alpha: 0.5787682758572091
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   lambda: 0.9318261122936153
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   learning_rate: 0.03212678612144482
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   subsample: 0.8372526316676115
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   colsample_bytree: 0.5951233644327956
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5035344210264773
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   colsample_bynode: 0.7524433498931871
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:04:50,587] [INFO] [<frozen importlib] -   scale_pos_weight: 6.911190744598498
[2025-11-19 09:04:50,662] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:04:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:04:50,576] Trial 264 finished with value: 0.22398500731535773 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.2090850242514129, 'learning_rate': 0.03483615077556361, 'n_estimators': 450, 'alpha': 0.643143180910713, 'lambda': 1.3440374538114261, 'subsample': 0.8147385790295655, 'colsample_bytree': 0.5865157871887173, 'colsample_bylevel': 0.5100773457635984, 'colsample_bynode': 0.7890656203134262, 'scale_pos_weight': 6.0566483496857675}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.69491	train-auc:0.63587	train-aucpr:0.22080	val-logloss:0.69261	val-auc:0.62342	val-aucpr:0.13110
[10]	train-logloss:0.67287	train-auc:0.68146	train-aucpr:0.28924	val-logloss:0.64760	val-auc:0.67321	val-aucpr:0.18131
[20]	train-logloss:0.65881	train-auc:0.68660	train-aucpr:0.29665	val-logloss:0.61312	val-auc:0.68647	val-aucpr:0.20804
[30]	train-logloss:0.64851	train-auc:0.69046	train-aucpr:0.30349	val-logloss:0.58597	val-auc:0.69257	val-aucpr:0.21834
[40]	train-logloss:0.64099	train-auc:0.69526	train-aucpr:0.30687	val-logloss:0.55517	val-auc:0.70394	val-aucpr:0.22520
[50]	train-logloss:0.63482	train-auc:0.69946	train-aucpr:0.31028	val-logloss:0.54394	val-auc:0.69728	val-aucpr:0.22475
[60]	train-logloss:0.63030	train-auc:0.70247	train-aucpr:0.31411	val-logloss:0.53623	val-auc:0.70407	val-aucpr:0.22984
[70]	train-logloss:0.62647	train-auc:0.70599	train-aucpr:0.31698	val-logloss:0.52966	val-auc:0.71305	val-aucpr:0.23409
[80]	train-logloss:0.62349	train-auc:0.70860	train-aucpr:0.31983	val-logloss:0.52181	val-auc:0.71348	val-aucpr:0.23144
[90]	train-logloss:0.62070	train-auc:0.71186	train-aucpr:0.32236	val-logloss:0.52079	val-auc:0.70899	val-aucpr:0.22618
[97]	train-logloss:0.61896	train-auc:0.71437	train-aucpr:0.32473	val-logloss:0.51447	val-auc:0.70758	val-aucpr:0.22458
[2025-11-19 09:04:50,947] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:04:50,947] [INFO] [<frozen importlib] - Best train loss: 0.6272
[2025-11-19 09:04:50,947] [INFO] [<frozen importlib] - Best val loss: 0.5276
[2025-11-19 09:04:50,947] [INFO] [<frozen importlib] - Best val AUC: 0.7105
[2025-11-19 09:04:50,947] [INFO] [<frozen importlib] - Best val AUCPR: 0.2350
[2025-11-19 09:04:50,952] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:04:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:05:03,304] [INFO] [<frozen importlib] - Optimal threshold: 0.5009
[2025-11-19 09:05:03,304] [INFO] [<frozen importlib] - Best f1: 0.2867
[2025-11-19 09:05:03,304] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:05:03,353] [INFO] [<frozen importlib] - Validation Results (threshold=0.5009):
[2025-11-19 09:05:03,353] [INFO] [<frozen importlib] -   Accuracy: 0.9034
[2025-11-19 09:05:03,353] [INFO] [<frozen importlib] -   Precision: 0.3312
[2025-11-19 09:05:03,353] [INFO] [<frozen importlib] -   Recall: 0.2528
[2025-11-19 09:05:03,353] [INFO] [<frozen importlib] -   F1 Score: 0.2867
[2025-11-19 09:05:03,353] [INFO] [<frozen importlib] -   AUROC: 0.7105
[2025-11-19 09:05:03,353] [INFO] [<frozen importlib] -   AUPRC: 0.2354
[2025-11-19 09:05:03,353] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:05:03,353] [INFO] [<frozen importlib] -     TN=16704, FP=741
[2025-11-19 09:05:03,353] [INFO] [<frozen importlib] -     FN=1085, TP=367
[2025-11-19 09:05:03,377] [INFO] [<frozen importlib] - Trial 265: AUPRC=0.2354, F1=0.4556, Prec=0.4661, Rec=0.4456 | Optimizing auprc=0.2354
                                                                                        Best trial: 258. Best value: 0.240317:  53%|█████▎    | 265/500 [43:01<38:18,  9.78s/it]Best trial: 258. Best value: 0.240317:  53%|█████▎    | 265/500 [43:01<38:18,  9.78s/it]Best trial: 258. Best value: 0.240317:  53%|█████▎    | 266/500 [43:01<41:40, 10.69s/it][2025-11-19 09:05:03,389] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.30874283571367
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   gamma: 0.12448734984382148
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   alpha: 0.5577354493307285
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   lambda: 1.0874562681863271
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   learning_rate: 0.03274299926772352
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   subsample: 0.8404871468720508
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   colsample_bytree: 0.5935750053372937
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5027392750608123
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   colsample_bynode: 0.770747316840187
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:05:03,389] [INFO] [<frozen importlib] -   scale_pos_weight: 6.30874283571367
[2025-11-19 09:05:03,462] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:05:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:05:03,378] Trial 265 finished with value: 0.23544469812520777 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.13221687602674975, 'learning_rate': 0.03212678612144482, 'n_estimators': 450, 'alpha': 0.5787682758572091, 'lambda': 0.9318261122936153, 'subsample': 0.8372526316676115, 'colsample_bytree': 0.5951233644327956, 'colsample_bylevel': 0.5035344210264773, 'colsample_bynode': 0.7524433498931871, 'scale_pos_weight': 6.911190744598498}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.66188	train-auc:0.63587	train-aucpr:0.22080	val-logloss:0.65517	val-auc:0.62342	val-aucpr:0.13110
[10]	train-logloss:0.64103	train-auc:0.68132	train-aucpr:0.28897	val-logloss:0.61321	val-auc:0.67252	val-aucpr:0.18077
[20]	train-logloss:0.62773	train-auc:0.68655	train-aucpr:0.29645	val-logloss:0.57505	val-auc:0.69019	val-aucpr:0.20731
[30]	train-logloss:0.61794	train-auc:0.68981	train-aucpr:0.30404	val-logloss:0.55097	val-auc:0.69243	val-aucpr:0.21769
[40]	train-logloss:0.61085	train-auc:0.69447	train-aucpr:0.30689	val-logloss:0.52204	val-auc:0.70787	val-aucpr:0.22803
[50]	train-logloss:0.60509	train-auc:0.69867	train-aucpr:0.31105	val-logloss:0.51615	val-auc:0.69428	val-aucpr:0.22327
[60]	train-logloss:0.60089	train-auc:0.70257	train-aucpr:0.31459	val-logloss:0.50421	val-auc:0.70076	val-aucpr:0.22991
[70]	train-logloss:0.59733	train-auc:0.70562	train-aucpr:0.31799	val-logloss:0.50199	val-auc:0.71155	val-aucpr:0.23414
[80]	train-logloss:0.59401	train-auc:0.70915	train-aucpr:0.32219	val-logloss:0.49993	val-auc:0.71103	val-aucpr:0.23171
[90]	train-logloss:0.59142	train-auc:0.71263	train-aucpr:0.32526	val-logloss:0.49389	val-auc:0.70770	val-aucpr:0.22983
[100]	train-logloss:0.58906	train-auc:0.71622	train-aucpr:0.32906	val-logloss:0.48797	val-auc:0.70559	val-aucpr:0.22831
[101]	train-logloss:0.58864	train-auc:0.71680	train-aucpr:0.32981	val-logloss:0.48771	val-auc:0.70598	val-aucpr:0.22876
[2025-11-19 09:05:03,748] [INFO] [<frozen importlib] - Training completed at iteration 71
[2025-11-19 09:05:03,748] [INFO] [<frozen importlib] - Best train loss: 0.5970
[2025-11-19 09:05:03,748] [INFO] [<frozen importlib] - Best val loss: 0.5004
[2025-11-19 09:05:03,748] [INFO] [<frozen importlib] - Best val AUC: 0.7121
[2025-11-19 09:05:03,748] [INFO] [<frozen importlib] - Best val AUCPR: 0.2352
[2025-11-19 09:05:03,752] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:05:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:05:17,145] [INFO] [<frozen importlib] - Optimal threshold: 0.4826
[2025-11-19 09:05:17,145] [INFO] [<frozen importlib] - Best f1: 0.2855
[2025-11-19 09:05:17,145] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:05:17,195] [INFO] [<frozen importlib] - Validation Results (threshold=0.4826):
[2025-11-19 09:05:17,195] [INFO] [<frozen importlib] -   Accuracy: 0.9060
[2025-11-19 09:05:17,195] [INFO] [<frozen importlib] -   Precision: 0.3430
[2025-11-19 09:05:17,195] [INFO] [<frozen importlib] -   Recall: 0.2445
[2025-11-19 09:05:17,195] [INFO] [<frozen importlib] -   F1 Score: 0.2855
[2025-11-19 09:05:17,195] [INFO] [<frozen importlib] -   AUROC: 0.7121
[2025-11-19 09:05:17,195] [INFO] [<frozen importlib] -   AUPRC: 0.2355
[2025-11-19 09:05:17,195] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:05:17,195] [INFO] [<frozen importlib] -     TN=16765, FP=680
[2025-11-19 09:05:17,195] [INFO] [<frozen importlib] -     FN=1097, TP=355
[2025-11-19 09:05:17,218] [INFO] [<frozen importlib] - Trial 266: AUPRC=0.2355, F1=0.4545, Prec=0.4797, Rec=0.4318 | Optimizing auprc=0.2355
                                                                                        Best trial: 258. Best value: 0.240317:  53%|█████▎    | 266/500 [43:15<41:40, 10.69s/it]Best trial: 258. Best value: 0.240317:  53%|█████▎    | 266/500 [43:15<41:40, 10.69s/it]Best trial: 258. Best value: 0.240317:  53%|█████▎    | 267/500 [43:15<45:10, 11.63s/it][2025-11-19 09:05:17,232] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.363481694054972
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   gamma: 0.12451012914916157
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   alpha: 0.5700985035065942
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   lambda: 1.0837030457670738
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   learning_rate: 0.0317144397817603
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   subsample: 0.8430857537360825
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   colsample_bytree: 0.5927992109516734
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5008691912790134
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   colsample_bynode: 0.8033773327490183
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:05:17,232] [INFO] [<frozen importlib] -   scale_pos_weight: 6.363481694054972
[2025-11-19 09:05:17,308] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:05:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:05:17,219] Trial 266 finished with value: 0.23554301538775113 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.12448734984382148, 'learning_rate': 0.03274299926772352, 'n_estimators': 450, 'alpha': 0.5577354493307285, 'lambda': 1.0874562681863271, 'subsample': 0.8404871468720508, 'colsample_bytree': 0.5935750053372937, 'colsample_bylevel': 0.5027392750608123, 'colsample_bynode': 0.770747316840187, 'scale_pos_weight': 6.30874283571367}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.66498	train-auc:0.63745	train-aucpr:0.22130	val-logloss:0.65846	val-auc:0.60540	val-aucpr:0.12692
[10]	train-logloss:0.64439	train-auc:0.68095	train-aucpr:0.29007	val-logloss:0.62298	val-auc:0.66507	val-aucpr:0.16298
[20]	train-logloss:0.63116	train-auc:0.68681	train-aucpr:0.29702	val-logloss:0.58910	val-auc:0.68607	val-aucpr:0.20783
[30]	train-logloss:0.62126	train-auc:0.69054	train-aucpr:0.30436	val-logloss:0.55700	val-auc:0.68197	val-aucpr:0.21784
[40]	train-logloss:0.61420	train-auc:0.69447	train-aucpr:0.30732	val-logloss:0.52634	val-auc:0.69630	val-aucpr:0.22393
[50]	train-logloss:0.60837	train-auc:0.69793	train-aucpr:0.31104	val-logloss:0.51430	val-auc:0.69744	val-aucpr:0.22574
[60]	train-logloss:0.60410	train-auc:0.70163	train-aucpr:0.31427	val-logloss:0.51328	val-auc:0.70091	val-aucpr:0.22819
[70]	train-logloss:0.60052	train-auc:0.70481	train-aucpr:0.31663	val-logloss:0.50878	val-auc:0.70837	val-aucpr:0.23297
[80]	train-logloss:0.59779	train-auc:0.70701	train-aucpr:0.31923	val-logloss:0.50732	val-auc:0.71189	val-aucpr:0.23385
[90]	train-logloss:0.59531	train-auc:0.71001	train-aucpr:0.32225	val-logloss:0.50718	val-auc:0.70618	val-aucpr:0.22926
[100]	train-logloss:0.59285	train-auc:0.71404	train-aucpr:0.32582	val-logloss:0.51010	val-auc:0.70524	val-aucpr:0.22613
[106]	train-logloss:0.59139	train-auc:0.71616	train-aucpr:0.32819	val-logloss:0.50715	val-auc:0.70651	val-aucpr:0.22651
[2025-11-19 09:05:17,607] [INFO] [<frozen importlib] - Training completed at iteration 77
[2025-11-19 09:05:17,607] [INFO] [<frozen importlib] - Best train loss: 0.5985
[2025-11-19 09:05:17,607] [INFO] [<frozen importlib] - Best val loss: 0.5089
[2025-11-19 09:05:17,607] [INFO] [<frozen importlib] - Best val AUC: 0.7105
[2025-11-19 09:05:17,607] [INFO] [<frozen importlib] - Best val AUCPR: 0.2344
[2025-11-19 09:05:17,612] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:05:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:05:31,349] [INFO] [<frozen importlib] - Optimal threshold: 0.4992
[2025-11-19 09:05:31,349] [INFO] [<frozen importlib] - Best f1: 0.2848
[2025-11-19 09:05:31,349] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:05:31,390] [INFO] [<frozen importlib] - Validation Results (threshold=0.4992):
[2025-11-19 09:05:31,390] [INFO] [<frozen importlib] -   Accuracy: 0.9072
[2025-11-19 09:05:31,390] [INFO] [<frozen importlib] -   Precision: 0.3493
[2025-11-19 09:05:31,390] [INFO] [<frozen importlib] -   Recall: 0.2404
[2025-11-19 09:05:31,390] [INFO] [<frozen importlib] -   F1 Score: 0.2848
[2025-11-19 09:05:31,390] [INFO] [<frozen importlib] -   AUROC: 0.7105
[2025-11-19 09:05:31,390] [INFO] [<frozen importlib] -   AUPRC: 0.2348
[2025-11-19 09:05:31,390] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:05:31,390] [INFO] [<frozen importlib] -     TN=16795, FP=650
[2025-11-19 09:05:31,390] [INFO] [<frozen importlib] -     FN=1103, TP=349
[2025-11-19 09:05:31,413] [INFO] [<frozen importlib] - Trial 267: AUPRC=0.2348, F1=0.4493, Prec=0.4837, Rec=0.4194 | Optimizing auprc=0.2348
                                                                                        Best trial: 258. Best value: 0.240317:  53%|█████▎    | 267/500 [43:29<45:10, 11.63s/it]Best trial: 258. Best value: 0.240317:  53%|█████▎    | 267/500 [43:29<45:10, 11.63s/it]Best trial: 258. Best value: 0.240317:  54%|█████▎    | 268/500 [43:29<47:57, 12.40s/it][2025-11-19 09:05:31,424] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.5153602657801715
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   gamma: 0.12120694575770909
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   alpha: 0.5860574712034132
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   lambda: 1.103321078821345
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   learning_rate: 0.03199207968402754
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   subsample: 0.8466655377078418
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   colsample_bytree: 0.5954791885009291
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5006761854391267
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   colsample_bynode: 0.7768591686873234
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:05:31,424] [INFO] [<frozen importlib] -   scale_pos_weight: 6.5153602657801715
[2025-11-19 09:05:31,496] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:05:31] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:05:31,413] Trial 267 finished with value: 0.234835827606096 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.12451012914916157, 'learning_rate': 0.0317144397817603, 'n_estimators': 250, 'alpha': 0.5700985035065942, 'lambda': 1.0837030457670738, 'subsample': 0.8430857537360825, 'colsample_bytree': 0.5927992109516734, 'colsample_bylevel': 0.5008691912790134, 'colsample_bynode': 0.8033773327490183, 'scale_pos_weight': 6.363481694054972}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.67333	train-auc:0.63745	train-aucpr:0.22130	val-logloss:0.66793	val-auc:0.60540	val-aucpr:0.12692
[10]	train-logloss:0.65235	train-auc:0.68099	train-aucpr:0.28850	val-logloss:0.62470	val-auc:0.66832	val-aucpr:0.18028
[20]	train-logloss:0.63883	train-auc:0.68680	train-aucpr:0.29636	val-logloss:0.59148	val-auc:0.68450	val-aucpr:0.20421
[30]	train-logloss:0.62872	train-auc:0.69037	train-aucpr:0.30450	val-logloss:0.56046	val-auc:0.68166	val-aucpr:0.21281
[40]	train-logloss:0.62159	train-auc:0.69495	train-aucpr:0.30715	val-logloss:0.53122	val-auc:0.69597	val-aucpr:0.22256
[50]	train-logloss:0.61588	train-auc:0.69823	train-aucpr:0.31001	val-logloss:0.52172	val-auc:0.69768	val-aucpr:0.22749
[60]	train-logloss:0.61134	train-auc:0.70177	train-aucpr:0.31417	val-logloss:0.51373	val-auc:0.70661	val-aucpr:0.23100
[70]	train-logloss:0.60778	train-auc:0.70459	train-aucpr:0.31640	val-logloss:0.51148	val-auc:0.70656	val-aucpr:0.23144
[80]	train-logloss:0.60486	train-auc:0.70713	train-aucpr:0.31948	val-logloss:0.50457	val-auc:0.70909	val-aucpr:0.23341
[90]	train-logloss:0.60256	train-auc:0.70967	train-aucpr:0.32268	val-logloss:0.50676	val-auc:0.70624	val-aucpr:0.22745
[100]	train-logloss:0.60002	train-auc:0.71331	train-aucpr:0.32621	val-logloss:0.50740	val-auc:0.70250	val-aucpr:0.22508
[110]	train-logloss:0.59782	train-auc:0.71652	train-aucpr:0.32921	val-logloss:0.50247	val-auc:0.70216	val-aucpr:0.22409
[2025-11-19 09:05:31,804] [INFO] [<frozen importlib] - Training completed at iteration 81
[2025-11-19 09:05:31,804] [INFO] [<frozen importlib] - Best train loss: 0.6046
[2025-11-19 09:05:31,804] [INFO] [<frozen importlib] - Best val loss: 0.5044
[2025-11-19 09:05:31,804] [INFO] [<frozen importlib] - Best val AUC: 0.7085
[2025-11-19 09:05:31,804] [INFO] [<frozen importlib] - Best val AUCPR: 0.2338
[2025-11-19 09:05:31,809] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:05:31] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:05:45,575] [INFO] [<frozen importlib] - Optimal threshold: 0.4884
[2025-11-19 09:05:45,575] [INFO] [<frozen importlib] - Best f1: 0.2895
[2025-11-19 09:05:45,575] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:05:45,623] [INFO] [<frozen importlib] - Validation Results (threshold=0.4884):
[2025-11-19 09:05:45,623] [INFO] [<frozen importlib] -   Accuracy: 0.9057
[2025-11-19 09:05:45,623] [INFO] [<frozen importlib] -   Precision: 0.3438
[2025-11-19 09:05:45,623] [INFO] [<frozen importlib] -   Recall: 0.2500
[2025-11-19 09:05:45,623] [INFO] [<frozen importlib] -   F1 Score: 0.2895
[2025-11-19 09:05:45,623] [INFO] [<frozen importlib] -   AUROC: 0.7085
[2025-11-19 09:05:45,623] [INFO] [<frozen importlib] -   AUPRC: 0.2342
[2025-11-19 09:05:45,623] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:05:45,623] [INFO] [<frozen importlib] -     TN=16752, FP=693
[2025-11-19 09:05:45,623] [INFO] [<frozen importlib] -     FN=1089, TP=363
[2025-11-19 09:05:45,653] [INFO] [<frozen importlib] - Trial 268: AUPRC=0.2342, F1=0.4591, Prec=0.4797, Rec=0.4401 | Optimizing auprc=0.2342
[2025-11-19 09:05:45,654] [INFO] [<frozen importlib] - Trial 268 pruned.
[2025-11-19 09:05:45,654] [ERROR] [<frozen importlib] - Trial 268 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  54%|█████▎    | 268/500 [43:43<47:57, 12.40s/it]Best trial: 258. Best value: 0.240317:  54%|█████▎    | 268/500 [43:43<47:57, 12.40s/it]Best trial: 258. Best value: 0.240317:  54%|█████▍    | 269/500 [43:43<49:52, 12.95s/it][2025-11-19 09:05:45,664] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.249322426982124
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   gamma: 0.1112070842674828
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   alpha: 0.565471244008379
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   lambda: 1.0527126646510199
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   learning_rate: 0.03138449737363185
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   subsample: 0.8392889062270228
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   colsample_bytree: 0.6073808614698409
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5001120855872054
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   colsample_bynode: 0.8060334024022393
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:05:45,664] [INFO] [<frozen importlib] -   scale_pos_weight: 6.249322426982124
[2025-11-19 09:05:45,739] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:05:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:05:45,654] Trial 268 pruned. 
[0]	train-logloss:0.65834	train-auc:0.64292	train-aucpr:0.25050	val-logloss:0.65199	val-auc:0.58335	val-aucpr:0.11310
[10]	train-logloss:0.63814	train-auc:0.68246	train-aucpr:0.29217	val-logloss:0.60123	val-auc:0.67923	val-aucpr:0.18829
[20]	train-logloss:0.62512	train-auc:0.68633	train-aucpr:0.29776	val-logloss:0.56657	val-auc:0.67299	val-aucpr:0.19967
[30]	train-logloss:0.61565	train-auc:0.68906	train-aucpr:0.30280	val-logloss:0.53951	val-auc:0.69884	val-aucpr:0.21611
[40]	train-logloss:0.60872	train-auc:0.69348	train-aucpr:0.30653	val-logloss:0.51512	val-auc:0.70334	val-aucpr:0.21933
[50]	train-logloss:0.60298	train-auc:0.69643	train-aucpr:0.31001	val-logloss:0.50531	val-auc:0.70440	val-aucpr:0.22333
[60]	train-logloss:0.59895	train-auc:0.69950	train-aucpr:0.31296	val-logloss:0.49300	val-auc:0.70612	val-aucpr:0.22557
[70]	train-logloss:0.59530	train-auc:0.70281	train-aucpr:0.31645	val-logloss:0.49276	val-auc:0.70633	val-aucpr:0.22444
[80]	train-logloss:0.59176	train-auc:0.70791	train-aucpr:0.32129	val-logloss:0.48590	val-auc:0.70571	val-aucpr:0.22195
[89]	train-logloss:0.58936	train-auc:0.71120	train-aucpr:0.32444	val-logloss:0.48367	val-auc:0.70954	val-aucpr:0.22227
[2025-11-19 09:05:45,997] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:05:45,997] [INFO] [<frozen importlib] - Best train loss: 0.5989
[2025-11-19 09:05:45,997] [INFO] [<frozen importlib] - Best val loss: 0.4930
[2025-11-19 09:05:45,997] [INFO] [<frozen importlib] - Best val AUC: 0.7061
[2025-11-19 09:05:45,997] [INFO] [<frozen importlib] - Best val AUCPR: 0.2256
[2025-11-19 09:05:46,003] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:05:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:05:57,713] [INFO] [<frozen importlib] - Optimal threshold: 0.4611
[2025-11-19 09:05:57,713] [INFO] [<frozen importlib] - Best f1: 0.2705
[2025-11-19 09:05:57,713] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:05:57,753] [INFO] [<frozen importlib] - Validation Results (threshold=0.4611):
[2025-11-19 09:05:57,753] [INFO] [<frozen importlib] -   Accuracy: 0.8881
[2025-11-19 09:05:57,753] [INFO] [<frozen importlib] -   Precision: 0.2711
[2025-11-19 09:05:57,753] [INFO] [<frozen importlib] -   Recall: 0.2700
[2025-11-19 09:05:57,754] [INFO] [<frozen importlib] -   F1 Score: 0.2705
[2025-11-19 09:05:57,754] [INFO] [<frozen importlib] -   AUROC: 0.7061
[2025-11-19 09:05:57,754] [INFO] [<frozen importlib] -   AUPRC: 0.2259
[2025-11-19 09:05:57,754] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:05:57,754] [INFO] [<frozen importlib] -     TN=16391, FP=1054
[2025-11-19 09:05:57,754] [INFO] [<frozen importlib] -     FN=1060, TP=392
[2025-11-19 09:05:57,777] [INFO] [<frozen importlib] - Trial 269: AUPRC=0.2259, F1=0.4367, Prec=0.3991, Rec=0.4821 | Optimizing auprc=0.2259
[2025-11-19 09:05:57,778] [INFO] [<frozen importlib] - Trial 269 pruned.
[2025-11-19 09:05:57,778] [ERROR] [<frozen importlib] - Trial 269 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  54%|█████▍    | 269/500 [43:55<49:52, 12.95s/it]Best trial: 258. Best value: 0.240317:  54%|█████▍    | 269/500 [43:55<49:52, 12.95s/it]Best trial: 258. Best value: 0.240317:  54%|█████▍    | 270/500 [43:55<48:41, 12.70s/it][2025-11-19 09:05:57,788] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.9314024490334845
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   gamma: 0.14876221757234548
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   alpha: 0.6179186875048519
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   lambda: 0.9388669038714157
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   learning_rate: 0.030936882971145215
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   subsample: 0.8275601269309356
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   colsample_bytree: 0.5892255696113677
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5134744072683887
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   colsample_bynode: 0.7920918557849133
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:05:57,789] [INFO] [<frozen importlib] -   scale_pos_weight: 5.9314024490334845
[2025-11-19 09:05:57,867] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:05:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:05:57,778] Trial 269 pruned. 
[0]	train-logloss:0.64082	train-auc:0.63465	train-aucpr:0.22753	val-logloss:0.63118	val-auc:0.61090	val-aucpr:0.13278
[10]	train-logloss:0.62193	train-auc:0.67943	train-aucpr:0.28544	val-logloss:0.59605	val-auc:0.70176	val-aucpr:0.18535
[20]	train-logloss:0.60933	train-auc:0.68503	train-aucpr:0.29509	val-logloss:0.56372	val-auc:0.70686	val-aucpr:0.21186
[30]	train-logloss:0.60028	train-auc:0.68897	train-aucpr:0.30032	val-logloss:0.54147	val-auc:0.70352	val-aucpr:0.21727
[40]	train-logloss:0.59366	train-auc:0.69324	train-aucpr:0.30361	val-logloss:0.52520	val-auc:0.70448	val-aucpr:0.21798
[50]	train-logloss:0.58773	train-auc:0.69737	train-aucpr:0.30946	val-logloss:0.51634	val-auc:0.70466	val-aucpr:0.22166
[60]	train-logloss:0.58376	train-auc:0.69999	train-aucpr:0.31300	val-logloss:0.51022	val-auc:0.70261	val-aucpr:0.22432
[70]	train-logloss:0.58012	train-auc:0.70471	train-aucpr:0.31637	val-logloss:0.50441	val-auc:0.69759	val-aucpr:0.22031
[80]	train-logloss:0.57683	train-auc:0.70842	train-aucpr:0.32063	val-logloss:0.49768	val-auc:0.69943	val-aucpr:0.21495
[90]	train-logloss:0.57424	train-auc:0.71136	train-aucpr:0.32352	val-logloss:0.48514	val-auc:0.70018	val-aucpr:0.21766
[93]	train-logloss:0.57366	train-auc:0.71196	train-aucpr:0.32412	val-logloss:0.48491	val-auc:0.70231	val-aucpr:0.21797
[2025-11-19 09:05:58,137] [INFO] [<frozen importlib] - Training completed at iteration 63
[2025-11-19 09:05:58,137] [INFO] [<frozen importlib] - Best train loss: 0.5827
[2025-11-19 09:05:58,137] [INFO] [<frozen importlib] - Best val loss: 0.5098
[2025-11-19 09:05:58,137] [INFO] [<frozen importlib] - Best val AUC: 0.7056
[2025-11-19 09:05:58,137] [INFO] [<frozen importlib] - Best val AUCPR: 0.2263
[2025-11-19 09:05:58,143] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:05:58] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:06:10,793] [INFO] [<frozen importlib] - Optimal threshold: 0.4685
[2025-11-19 09:06:10,793] [INFO] [<frozen importlib] - Best f1: 0.2752
[2025-11-19 09:06:10,793] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:06:10,834] [INFO] [<frozen importlib] - Validation Results (threshold=0.4685):
[2025-11-19 09:06:10,834] [INFO] [<frozen importlib] -   Accuracy: 0.8949
[2025-11-19 09:06:10,834] [INFO] [<frozen importlib] -   Precision: 0.2927
[2025-11-19 09:06:10,834] [INFO] [<frozen importlib] -   Recall: 0.2596
[2025-11-19 09:06:10,834] [INFO] [<frozen importlib] -   F1 Score: 0.2752
[2025-11-19 09:06:10,834] [INFO] [<frozen importlib] -   AUROC: 0.7056
[2025-11-19 09:06:10,834] [INFO] [<frozen importlib] -   AUPRC: 0.2266
[2025-11-19 09:06:10,834] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:06:10,834] [INFO] [<frozen importlib] -     TN=16534, FP=911
[2025-11-19 09:06:10,834] [INFO] [<frozen importlib] -     FN=1075, TP=377
[2025-11-19 09:06:10,859] [INFO] [<frozen importlib] - Trial 270: AUPRC=0.2266, F1=0.4515, Prec=0.4306, Rec=0.4745 | Optimizing auprc=0.2266
[2025-11-19 09:06:10,859] [INFO] [<frozen importlib] - Trial 270 pruned.
[2025-11-19 09:06:10,859] [ERROR] [<frozen importlib] - Trial 270 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  54%|█████▍    | 270/500 [44:08<48:41, 12.70s/it]Best trial: 258. Best value: 0.240317:  54%|█████▍    | 270/500 [44:08<48:41, 12.70s/it]Best trial: 258. Best value: 0.240317:  54%|█████▍    | 271/500 [44:08<48:55, 12.82s/it][2025-11-19 09:06:10,871] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.747282614824695
[2025-11-19 09:06:10,871] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:06:10,871] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:06:10,871] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:06:10,871] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:06:10,871] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:06:10,871] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:06:10,871] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:06:10,871] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:06:10,871] [INFO] [<frozen importlib] -   gamma: 0.12344181773999033
[2025-11-19 09:06:10,871] [INFO] [<frozen importlib] -   alpha: 0.5683144267914626
[2025-11-19 09:06:10,871] [INFO] [<frozen importlib] -   lambda: 1.1989079805569212
[2025-11-19 09:06:10,872] [INFO] [<frozen importlib] -   learning_rate: 0.030171104023836444
[2025-11-19 09:06:10,872] [INFO] [<frozen importlib] -   subsample: 0.8468640986874245
[2025-11-19 09:06:10,872] [INFO] [<frozen importlib] -   colsample_bytree: 0.6150264133028468
[2025-11-19 09:06:10,872] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5087659262524759
[2025-11-19 09:06:10,872] [INFO] [<frozen importlib] -   colsample_bynode: 0.8013430167674577
[2025-11-19 09:06:10,872] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:06:10,872] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:06:10,872] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:06:10,872] [INFO] [<frozen importlib] -   scale_pos_weight: 5.747282614824695
[2025-11-19 09:06:10,945] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:06:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:06:10,859] Trial 270 pruned. 
[0]	train-logloss:0.63024	train-auc:0.64373	train-aucpr:0.24785	val-logloss:0.61937	val-auc:0.58631	val-aucpr:0.11496
[10]	train-logloss:0.61196	train-auc:0.68060	train-aucpr:0.29382	val-logloss:0.58267	val-auc:0.70363	val-aucpr:0.21644
[20]	train-logloss:0.59974	train-auc:0.68419	train-aucpr:0.29840	val-logloss:0.54835	val-auc:0.70438	val-aucpr:0.21996
[30]	train-logloss:0.59105	train-auc:0.68900	train-aucpr:0.30229	val-logloss:0.52262	val-auc:0.70979	val-aucpr:0.22877
[40]	train-logloss:0.58424	train-auc:0.69307	train-aucpr:0.30639	val-logloss:0.49740	val-auc:0.70680	val-aucpr:0.22504
[50]	train-logloss:0.57881	train-auc:0.69728	train-aucpr:0.31082	val-logloss:0.48912	val-auc:0.70528	val-aucpr:0.22868
[60]	train-logloss:0.57487	train-auc:0.70003	train-aucpr:0.31381	val-logloss:0.47992	val-auc:0.70525	val-aucpr:0.22909
[70]	train-logloss:0.57129	train-auc:0.70323	train-aucpr:0.31666	val-logloss:0.47694	val-auc:0.70387	val-aucpr:0.22575
[80]	train-logloss:0.56848	train-auc:0.70722	train-aucpr:0.32007	val-logloss:0.46668	val-auc:0.69860	val-aucpr:0.22486
[88]	train-logloss:0.56637	train-auc:0.70915	train-aucpr:0.32227	val-logloss:0.46562	val-auc:0.70253	val-aucpr:0.22419
[2025-11-19 09:06:11,201] [INFO] [<frozen importlib] - Training completed at iteration 59
[2025-11-19 09:06:11,201] [INFO] [<frozen importlib] - Best train loss: 0.5753
[2025-11-19 09:06:11,201] [INFO] [<frozen importlib] - Best val loss: 0.4807
[2025-11-19 09:06:11,201] [INFO] [<frozen importlib] - Best val AUC: 0.7058
[2025-11-19 09:06:11,201] [INFO] [<frozen importlib] - Best val AUCPR: 0.2297
[2025-11-19 09:06:11,206] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:06:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:06:22,063] [INFO] [<frozen importlib] - Optimal threshold: 0.4433
[2025-11-19 09:06:22,063] [INFO] [<frozen importlib] - Best f1: 0.2768
[2025-11-19 09:06:22,063] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:06:22,107] [INFO] [<frozen importlib] - Validation Results (threshold=0.4433):
[2025-11-19 09:06:22,107] [INFO] [<frozen importlib] -   Accuracy: 0.8922
[2025-11-19 09:06:22,107] [INFO] [<frozen importlib] -   Precision: 0.2855
[2025-11-19 09:06:22,107] [INFO] [<frozen importlib] -   Recall: 0.2686
[2025-11-19 09:06:22,107] [INFO] [<frozen importlib] -   F1 Score: 0.2768
[2025-11-19 09:06:22,107] [INFO] [<frozen importlib] -   AUROC: 0.7058
[2025-11-19 09:06:22,107] [INFO] [<frozen importlib] -   AUPRC: 0.2300
[2025-11-19 09:06:22,107] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:06:22,107] [INFO] [<frozen importlib] -     TN=16469, FP=976
[2025-11-19 09:06:22,107] [INFO] [<frozen importlib] -     FN=1062, TP=390
[2025-11-19 09:06:22,130] [INFO] [<frozen importlib] - Trial 271: AUPRC=0.2300, F1=0.4441, Prec=0.4152, Rec=0.4773 | Optimizing auprc=0.2300
                                                                                        Best trial: 258. Best value: 0.240317:  54%|█████▍    | 271/500 [44:20<48:55, 12.82s/it]Best trial: 258. Best value: 0.240317:  54%|█████▍    | 271/500 [44:20<48:55, 12.82s/it]Best trial: 258. Best value: 0.240317:  54%|█████▍    | 272/500 [44:20<46:56, 12.35s/it][2025-11-19 09:06:22,142] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.490967881218301
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   gamma: 0.1304764164450121
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   alpha: 0.5110221628587123
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   lambda: 0.8834066720089807
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   learning_rate: 0.03184372820549053
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   subsample: 0.8524355323262288
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   colsample_bytree: 0.5969323906236418
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5001368094639379
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   colsample_bynode: 0.7633173392204049
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:06:22,142] [INFO] [<frozen importlib] -   scale_pos_weight: 6.490967881218301
[2025-11-19 09:06:22,215] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:06:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:06:22,130] Trial 271 finished with value: 0.22996855837876184 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.12344181773999033, 'learning_rate': 0.030171104023836444, 'n_estimators': 450, 'alpha': 0.5683144267914626, 'lambda': 1.1989079805569212, 'subsample': 0.8468640986874245, 'colsample_bytree': 0.6150264133028468, 'colsample_bylevel': 0.5087659262524759, 'colsample_bynode': 0.8013430167674577, 'scale_pos_weight': 5.747282614824695}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.67199	train-auc:0.63591	train-aucpr:0.22080	val-logloss:0.66674	val-auc:0.62324	val-aucpr:0.13035
[10]	train-logloss:0.65115	train-auc:0.68136	train-aucpr:0.28912	val-logloss:0.62416	val-auc:0.67277	val-aucpr:0.18054
[20]	train-logloss:0.63760	train-auc:0.68644	train-aucpr:0.29738	val-logloss:0.59135	val-auc:0.68639	val-aucpr:0.20683
[30]	train-logloss:0.62783	train-auc:0.68986	train-aucpr:0.30433	val-logloss:0.56385	val-auc:0.69158	val-aucpr:0.22313
[40]	train-logloss:0.62060	train-auc:0.69511	train-aucpr:0.30708	val-logloss:0.53975	val-auc:0.70017	val-aucpr:0.22485
[50]	train-logloss:0.61490	train-auc:0.69875	train-aucpr:0.31017	val-logloss:0.52801	val-auc:0.70324	val-aucpr:0.22774
[60]	train-logloss:0.61044	train-auc:0.70138	train-aucpr:0.31351	val-logloss:0.51691	val-auc:0.70715	val-aucpr:0.23128
[70]	train-logloss:0.60696	train-auc:0.70438	train-aucpr:0.31587	val-logloss:0.51685	val-auc:0.70699	val-aucpr:0.23203
[80]	train-logloss:0.60427	train-auc:0.70616	train-aucpr:0.31812	val-logloss:0.50944	val-auc:0.70762	val-aucpr:0.23088
[90]	train-logloss:0.60193	train-auc:0.70835	train-aucpr:0.32110	val-logloss:0.50483	val-auc:0.70432	val-aucpr:0.22639
[97]	train-logloss:0.60018	train-auc:0.71107	train-aucpr:0.32401	val-logloss:0.50160	val-auc:0.70211	val-aucpr:0.22539
[2025-11-19 09:06:22,493] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:06:22,493] [INFO] [<frozen importlib] - Best train loss: 0.6077
[2025-11-19 09:06:22,493] [INFO] [<frozen importlib] - Best val loss: 0.5131
[2025-11-19 09:06:22,493] [INFO] [<frozen importlib] - Best val AUC: 0.7068
[2025-11-19 09:06:22,493] [INFO] [<frozen importlib] - Best val AUCPR: 0.2328
[2025-11-19 09:06:22,498] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:06:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:06:34,697] [INFO] [<frozen importlib] - Optimal threshold: 0.4933
[2025-11-19 09:06:34,697] [INFO] [<frozen importlib] - Best f1: 0.2813
[2025-11-19 09:06:34,697] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:06:34,740] [INFO] [<frozen importlib] - Validation Results (threshold=0.4933):
[2025-11-19 09:06:34,740] [INFO] [<frozen importlib] -   Accuracy: 0.9045
[2025-11-19 09:06:34,740] [INFO] [<frozen importlib] -   Precision: 0.3336
[2025-11-19 09:06:34,740] [INFO] [<frozen importlib] -   Recall: 0.2431
[2025-11-19 09:06:34,740] [INFO] [<frozen importlib] -   F1 Score: 0.2813
[2025-11-19 09:06:34,740] [INFO] [<frozen importlib] -   AUROC: 0.7068
[2025-11-19 09:06:34,740] [INFO] [<frozen importlib] -   AUPRC: 0.2332
[2025-11-19 09:06:34,740] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:06:34,740] [INFO] [<frozen importlib] -     TN=16740, FP=705
[2025-11-19 09:06:34,740] [INFO] [<frozen importlib] -     FN=1099, TP=353
[2025-11-19 09:06:34,763] [INFO] [<frozen importlib] - Trial 272: AUPRC=0.2332, F1=0.4571, Prec=0.4754, Rec=0.4401 | Optimizing auprc=0.2332
[2025-11-19 09:06:34,763] [INFO] [<frozen importlib] - Trial 272 pruned.
[2025-11-19 09:06:34,763] [ERROR] [<frozen importlib] - Trial 272 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  54%|█████▍    | 272/500 [44:32<46:56, 12.35s/it]Best trial: 258. Best value: 0.240317:  54%|█████▍    | 272/500 [44:32<46:56, 12.35s/it]Best trial: 258. Best value: 0.240317:  55%|█████▍    | 273/500 [44:32<47:03, 12.44s/it][2025-11-19 09:06:34,778] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.206007975439595
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   gamma: 0.13266293032846027
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   alpha: 0.5525403331565292
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   lambda: 1.0304705012789666
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   learning_rate: 0.03239814436821622
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   subsample: 0.8361891846874963
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   colsample_bytree: 0.5807110238257229
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5123790574482442
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   colsample_bynode: 0.7688232393767306
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:06:34,778] [INFO] [<frozen importlib] -   scale_pos_weight: 6.206007975439595
[2025-11-19 09:06:34,853] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:06:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:06:34,763] Trial 272 pruned. 
[0]	train-logloss:0.65600	train-auc:0.64476	train-aucpr:0.23341	val-logloss:0.64849	val-auc:0.61543	val-aucpr:0.11702
[10]	train-logloss:0.63539	train-auc:0.68312	train-aucpr:0.29089	val-logloss:0.60079	val-auc:0.71049	val-aucpr:0.21305
[20]	train-logloss:0.62221	train-auc:0.68665	train-aucpr:0.29553	val-logloss:0.56481	val-auc:0.70744	val-aucpr:0.22143
[30]	train-logloss:0.61291	train-auc:0.69037	train-aucpr:0.30052	val-logloss:0.53597	val-auc:0.70737	val-aucpr:0.22146
[40]	train-logloss:0.60615	train-auc:0.69394	train-aucpr:0.30437	val-logloss:0.51785	val-auc:0.70842	val-aucpr:0.22761
[50]	train-logloss:0.60049	train-auc:0.69849	train-aucpr:0.30804	val-logloss:0.52282	val-auc:0.70608	val-aucpr:0.23030
[60]	train-logloss:0.59665	train-auc:0.70144	train-aucpr:0.31145	val-logloss:0.51035	val-auc:0.70529	val-aucpr:0.22996
[70]	train-logloss:0.59259	train-auc:0.70523	train-aucpr:0.31622	val-logloss:0.50389	val-auc:0.70182	val-aucpr:0.22666
[80]	train-logloss:0.58948	train-auc:0.70839	train-aucpr:0.31988	val-logloss:0.50332	val-auc:0.69781	val-aucpr:0.21913
[90]	train-logloss:0.58689	train-auc:0.71138	train-aucpr:0.32321	val-logloss:0.49681	val-auc:0.69319	val-aucpr:0.21759
[91]	train-logloss:0.58670	train-auc:0.71198	train-aucpr:0.32357	val-logloss:0.49664	val-auc:0.69393	val-aucpr:0.21750
[2025-11-19 09:06:35,117] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:06:35,117] [INFO] [<frozen importlib] - Best train loss: 0.5959
[2025-11-19 09:06:35,117] [INFO] [<frozen importlib] - Best val loss: 0.5068
[2025-11-19 09:06:35,117] [INFO] [<frozen importlib] - Best val AUC: 0.7051
[2025-11-19 09:06:35,117] [INFO] [<frozen importlib] - Best val AUCPR: 0.2312
[2025-11-19 09:06:35,121] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:06:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:06:47,708] [INFO] [<frozen importlib] - Optimal threshold: 0.4718
[2025-11-19 09:06:47,708] [INFO] [<frozen importlib] - Best f1: 0.2725
[2025-11-19 09:06:47,708] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:06:47,755] [INFO] [<frozen importlib] - Validation Results (threshold=0.4718):
[2025-11-19 09:06:47,755] [INFO] [<frozen importlib] -   Accuracy: 0.8988
[2025-11-19 09:06:47,755] [INFO] [<frozen importlib] -   Precision: 0.3044
[2025-11-19 09:06:47,755] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 09:06:47,755] [INFO] [<frozen importlib] -   F1 Score: 0.2725
[2025-11-19 09:06:47,755] [INFO] [<frozen importlib] -   AUROC: 0.7051
[2025-11-19 09:06:47,755] [INFO] [<frozen importlib] -   AUPRC: 0.2316
[2025-11-19 09:06:47,755] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:06:47,755] [INFO] [<frozen importlib] -     TN=16627, FP=818
[2025-11-19 09:06:47,755] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 09:06:47,778] [INFO] [<frozen importlib] - Trial 273: AUPRC=0.2316, F1=0.4568, Prec=0.4510, Rec=0.4628 | Optimizing auprc=0.2316
                                                                                        Best trial: 258. Best value: 0.240317:  55%|█████▍    | 273/500 [44:45<47:03, 12.44s/it]Best trial: 258. Best value: 0.240317:  55%|█████▍    | 273/500 [44:45<47:03, 12.44s/it]Best trial: 258. Best value: 0.240317:  55%|█████▍    | 274/500 [44:45<47:30, 12.61s/it][2025-11-19 09:06:47,792] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.861259305802689
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   gamma: 0.13499213500095236
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   alpha: 0.6235867626798639
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   lambda: 1.251746765497514
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   learning_rate: 0.032591869732779506
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   subsample: 0.8234806642456611
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   colsample_bytree: 0.5782100898171856
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5136453532639639
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   colsample_bynode: 0.78209957502386
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:06:47,792] [INFO] [<frozen importlib] -   scale_pos_weight: 6.861259305802689
[2025-11-19 09:06:47,867] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:06:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:06:47,779] Trial 273 finished with value: 0.23158884740707592 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.13266293032846027, 'learning_rate': 0.03239814436821622, 'n_estimators': 150, 'alpha': 0.5525403331565292, 'lambda': 1.0304705012789666, 'subsample': 0.8361891846874963, 'colsample_bytree': 0.5807110238257229, 'colsample_bylevel': 0.5123790574482442, 'colsample_bynode': 0.7688232393767306, 'scale_pos_weight': 6.206007975439595}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.69193	train-auc:0.64460	train-aucpr:0.23134	val-logloss:0.68910	val-auc:0.61160	val-aucpr:0.12087
[10]	train-logloss:0.66947	train-auc:0.68225	train-aucpr:0.29274	val-logloss:0.63128	val-auc:0.70845	val-aucpr:0.21223
[20]	train-logloss:0.65532	train-auc:0.68772	train-aucpr:0.29724	val-logloss:0.59736	val-auc:0.70874	val-aucpr:0.22135
[30]	train-logloss:0.64513	train-auc:0.69172	train-aucpr:0.30291	val-logloss:0.56675	val-auc:0.70908	val-aucpr:0.22753
[40]	train-logloss:0.63810	train-auc:0.69478	train-aucpr:0.30569	val-logloss:0.54684	val-auc:0.70992	val-aucpr:0.22765
[50]	train-logloss:0.63205	train-auc:0.69894	train-aucpr:0.30984	val-logloss:0.53364	val-auc:0.70918	val-aucpr:0.23031
[60]	train-logloss:0.62796	train-auc:0.70199	train-aucpr:0.31299	val-logloss:0.52328	val-auc:0.71042	val-aucpr:0.23127
[70]	train-logloss:0.62401	train-auc:0.70622	train-aucpr:0.31616	val-logloss:0.51629	val-auc:0.70886	val-aucpr:0.22935
[80]	train-logloss:0.62062	train-auc:0.71012	train-aucpr:0.32028	val-logloss:0.50730	val-auc:0.70631	val-aucpr:0.22440
[90]	train-logloss:0.61779	train-auc:0.71338	train-aucpr:0.32360	val-logloss:0.49682	val-auc:0.70158	val-aucpr:0.22036
[91]	train-logloss:0.61771	train-auc:0.71343	train-aucpr:0.32377	val-logloss:0.49606	val-auc:0.70170	val-aucpr:0.22026
[2025-11-19 09:06:48,132] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:06:48,132] [INFO] [<frozen importlib] - Best train loss: 0.6272
[2025-11-19 09:06:48,132] [INFO] [<frozen importlib] - Best val loss: 0.5225
[2025-11-19 09:06:48,132] [INFO] [<frozen importlib] - Best val AUC: 0.7117
[2025-11-19 09:06:48,132] [INFO] [<frozen importlib] - Best val AUCPR: 0.2326
[2025-11-19 09:06:48,138] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:06:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:07:01,079] [INFO] [<frozen importlib] - Optimal threshold: 0.4969
[2025-11-19 09:07:01,079] [INFO] [<frozen importlib] - Best f1: 0.2707
[2025-11-19 09:07:01,079] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:07:01,125] [INFO] [<frozen importlib] - Validation Results (threshold=0.4969):
[2025-11-19 09:07:01,125] [INFO] [<frozen importlib] -   Accuracy: 0.8985
[2025-11-19 09:07:01,125] [INFO] [<frozen importlib] -   Precision: 0.3022
[2025-11-19 09:07:01,125] [INFO] [<frozen importlib] -   Recall: 0.2452
[2025-11-19 09:07:01,125] [INFO] [<frozen importlib] -   F1 Score: 0.2707
[2025-11-19 09:07:01,125] [INFO] [<frozen importlib] -   AUROC: 0.7117
[2025-11-19 09:07:01,125] [INFO] [<frozen importlib] -   AUPRC: 0.2330
[2025-11-19 09:07:01,125] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:07:01,125] [INFO] [<frozen importlib] -     TN=16623, FP=822
[2025-11-19 09:07:01,125] [INFO] [<frozen importlib] -     FN=1096, TP=356
[2025-11-19 09:07:01,148] [INFO] [<frozen importlib] - Trial 274: AUPRC=0.2330, F1=0.4583, Prec=0.4513, Rec=0.4656 | Optimizing auprc=0.2330
                                                                                        Best trial: 258. Best value: 0.240317:  55%|█████▍    | 274/500 [44:59<47:30, 12.61s/it]Best trial: 258. Best value: 0.240317:  55%|█████▍    | 274/500 [44:59<47:30, 12.61s/it]Best trial: 258. Best value: 0.240317:  55%|█████▌    | 275/500 [44:59<48:08, 12.84s/it][2025-11-19 09:07:01,160] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.824865069517634
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   gamma: 0.10072117191356461
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   alpha: 0.6312440685089152
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   lambda: 1.295110043487666
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   learning_rate: 0.033208535123935505
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   subsample: 0.8224609463483218
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   colsample_bytree: 0.5745895914692445
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7452271772802546
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   colsample_bynode: 0.7965750364367022
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:07:01,160] [INFO] [<frozen importlib] -   scale_pos_weight: 6.824865069517634
[2025-11-19 09:07:01,242] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:07:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:07:01,148] Trial 274 finished with value: 0.2329967790343747 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.13499213500095236, 'learning_rate': 0.032591869732779506, 'n_estimators': 100, 'alpha': 0.6235867626798639, 'lambda': 1.251746765497514, 'subsample': 0.8234806642456611, 'colsample_bytree': 0.5782100898171856, 'colsample_bylevel': 0.5136453532639639, 'colsample_bynode': 0.78209957502386, 'scale_pos_weight': 6.861259305802689}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.68963	train-auc:0.64812	train-aucpr:0.23920	val-logloss:0.68556	val-auc:0.66065	val-aucpr:0.12950
[10]	train-logloss:0.66684	train-auc:0.68333	train-aucpr:0.28869	val-logloss:0.62753	val-auc:0.71341	val-aucpr:0.20423
[20]	train-logloss:0.65202	train-auc:0.69045	train-aucpr:0.29881	val-logloss:0.59132	val-auc:0.70139	val-aucpr:0.20602
[30]	train-logloss:0.64211	train-auc:0.69309	train-aucpr:0.30368	val-logloss:0.57130	val-auc:0.70173	val-aucpr:0.21370
[40]	train-logloss:0.63441	train-auc:0.69669	train-aucpr:0.30910	val-logloss:0.54917	val-auc:0.70037	val-aucpr:0.21454
[50]	train-logloss:0.62828	train-auc:0.70080	train-aucpr:0.31432	val-logloss:0.54366	val-auc:0.70222	val-aucpr:0.21697
[60]	train-logloss:0.62383	train-auc:0.70413	train-aucpr:0.31774	val-logloss:0.52872	val-auc:0.70384	val-aucpr:0.21921
[70]	train-logloss:0.62007	train-auc:0.70825	train-aucpr:0.32120	val-logloss:0.52319	val-auc:0.69965	val-aucpr:0.21435
[80]	train-logloss:0.61690	train-auc:0.71159	train-aucpr:0.32479	val-logloss:0.51855	val-auc:0.70018	val-aucpr:0.21359
[85]	train-logloss:0.61557	train-auc:0.71285	train-aucpr:0.32565	val-logloss:0.52049	val-auc:0.69644	val-aucpr:0.20904
[2025-11-19 09:07:01,522] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:07:01,522] [INFO] [<frozen importlib] - Best train loss: 0.6258
[2025-11-19 09:07:01,522] [INFO] [<frozen importlib] - Best val loss: 0.5357
[2025-11-19 09:07:01,522] [INFO] [<frozen importlib] - Best val AUC: 0.7065
[2025-11-19 09:07:01,522] [INFO] [<frozen importlib] - Best val AUCPR: 0.2209
[2025-11-19 09:07:01,528] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:07:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:07:13,446] [INFO] [<frozen importlib] - Optimal threshold: 0.5014
[2025-11-19 09:07:13,446] [INFO] [<frozen importlib] - Best f1: 0.2692
[2025-11-19 09:07:13,446] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:07:13,489] [INFO] [<frozen importlib] - Validation Results (threshold=0.5014):
[2025-11-19 09:07:13,489] [INFO] [<frozen importlib] -   Accuracy: 0.8905
[2025-11-19 09:07:13,489] [INFO] [<frozen importlib] -   Precision: 0.2763
[2025-11-19 09:07:13,489] [INFO] [<frozen importlib] -   Recall: 0.2624
[2025-11-19 09:07:13,489] [INFO] [<frozen importlib] -   F1 Score: 0.2692
[2025-11-19 09:07:13,489] [INFO] [<frozen importlib] -   AUROC: 0.7065
[2025-11-19 09:07:13,489] [INFO] [<frozen importlib] -   AUPRC: 0.2212
[2025-11-19 09:07:13,489] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:07:13,489] [INFO] [<frozen importlib] -     TN=16447, FP=998
[2025-11-19 09:07:13,489] [INFO] [<frozen importlib] -     FN=1071, TP=381
[2025-11-19 09:07:13,512] [INFO] [<frozen importlib] - Trial 275: AUPRC=0.2212, F1=0.4543, Prec=0.4191, Rec=0.4959 | Optimizing auprc=0.2212
[2025-11-19 09:07:13,512] [INFO] [<frozen importlib] - Trial 275 pruned.
[2025-11-19 09:07:13,512] [ERROR] [<frozen importlib] - Trial 275 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  55%|█████▌    | 275/500 [45:11<48:08, 12.84s/it]Best trial: 258. Best value: 0.240317:  55%|█████▌    | 275/500 [45:11<48:08, 12.84s/it]Best trial: 258. Best value: 0.240317:  55%|█████▌    | 276/500 [45:11<47:23, 12.70s/it][2025-11-19 09:07:13,523] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.860590072936066
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   gamma: 0.10275541008626034
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   alpha: 0.5956245473066525
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   lambda: 1.1819334555170742
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   learning_rate: 0.032615002905382495
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   subsample: 0.8084616657290358
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   colsample_bytree: 0.6242055907848669
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5105736356228415
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   colsample_bynode: 0.7831165076014941
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:07:13,524] [INFO] [<frozen importlib] -   scale_pos_weight: 6.860590072936066
[2025-11-19 09:07:13,597] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:07:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:07:13,512] Trial 275 pruned. 
[0]	train-logloss:0.69194	train-auc:0.63482	train-aucpr:0.21701	val-logloss:0.68811	val-auc:0.58432	val-aucpr:0.09777
[10]	train-logloss:0.66945	train-auc:0.67798	train-aucpr:0.29404	val-logloss:0.63360	val-auc:0.70252	val-aucpr:0.21797
[20]	train-logloss:0.65503	train-auc:0.68568	train-aucpr:0.29881	val-logloss:0.59256	val-auc:0.69241	val-aucpr:0.22222
[30]	train-logloss:0.64525	train-auc:0.69162	train-aucpr:0.30341	val-logloss:0.56282	val-auc:0.70137	val-aucpr:0.22232
[40]	train-logloss:0.63783	train-auc:0.69676	train-aucpr:0.30876	val-logloss:0.54702	val-auc:0.70375	val-aucpr:0.22093
[42]	train-logloss:0.63654	train-auc:0.69752	train-aucpr:0.30927	val-logloss:0.54018	val-auc:0.70335	val-aucpr:0.21976
[2025-11-19 09:07:13,739] [INFO] [<frozen importlib] - Training completed at iteration 12
[2025-11-19 09:07:13,739] [INFO] [<frozen importlib] - Best train loss: 0.6662
[2025-11-19 09:07:13,739] [INFO] [<frozen importlib] - Best val loss: 0.6258
[2025-11-19 09:07:13,739] [INFO] [<frozen importlib] - Best val AUC: 0.7017
[2025-11-19 09:07:13,739] [INFO] [<frozen importlib] - Best val AUCPR: 0.2234
[2025-11-19 09:07:13,743] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:07:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:07:16,035] [INFO] [<frozen importlib] - Optimal threshold: 0.4900
[2025-11-19 09:07:16,035] [INFO] [<frozen importlib] - Best f1: 0.2621
[2025-11-19 09:07:16,035] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:07:16,083] [INFO] [<frozen importlib] - Validation Results (threshold=0.4900):
[2025-11-19 09:07:16,083] [INFO] [<frozen importlib] -   Accuracy: 0.8528
[2025-11-19 09:07:16,083] [INFO] [<frozen importlib] -   Precision: 0.2131
[2025-11-19 09:07:16,083] [INFO] [<frozen importlib] -   Recall: 0.3402
[2025-11-19 09:07:16,083] [INFO] [<frozen importlib] -   F1 Score: 0.2621
[2025-11-19 09:07:16,083] [INFO] [<frozen importlib] -   AUROC: 0.7017
[2025-11-19 09:07:16,083] [INFO] [<frozen importlib] -   AUPRC: 0.2211
[2025-11-19 09:07:16,083] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:07:16,083] [INFO] [<frozen importlib] -     TN=15621, FP=1824
[2025-11-19 09:07:16,083] [INFO] [<frozen importlib] -     FN=958, TP=494
[2025-11-19 09:07:16,109] [INFO] [<frozen importlib] - Trial 276: AUPRC=0.2211, F1=0.3945, Prec=0.3062, Rec=0.5544 | Optimizing auprc=0.2211
[2025-11-19 09:07:16,109] [INFO] [<frozen importlib] - Trial 276 pruned.
[2025-11-19 09:07:16,109] [ERROR] [<frozen importlib] - Trial 276 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  55%|█████▌    | 276/500 [45:14<47:23, 12.70s/it]Best trial: 258. Best value: 0.240317:  55%|█████▌    | 276/500 [45:14<47:23, 12.70s/it]Best trial: 258. Best value: 0.240317:  55%|█████▌    | 277/500 [45:14<35:55,  9.67s/it][2025-11-19 09:07:16,120] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.4525159263996885
[2025-11-19 09:07:16,120] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:07:16,120] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:07:16,120] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:07:16,120] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:07:16,120] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:07:16,120] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   gamma: 0.13616922425154315
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   alpha: 0.6592974703253281
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   lambda: 1.414076518504844
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   learning_rate: 0.03105270831466
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   subsample: 0.8255901490998919
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   colsample_bytree: 0.5905467154808699
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5010900746587685
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   colsample_bynode: 0.7744768974422638
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:07:16,121] [INFO] [<frozen importlib] -   scale_pos_weight: 6.4525159263996885
[2025-11-19 09:07:16,194] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:07:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:07:16,109] Trial 276 pruned. 
[0]	train-logloss:0.66986	train-auc:0.63571	train-aucpr:0.22752	val-logloss:0.66394	val-auc:0.60692	val-aucpr:0.12738
[10]	train-logloss:0.64964	train-auc:0.67949	train-aucpr:0.28155	val-logloss:0.62664	val-auc:0.70089	val-aucpr:0.17619
[20]	train-logloss:0.63634	train-auc:0.68576	train-aucpr:0.29440	val-logloss:0.59145	val-auc:0.69968	val-aucpr:0.20060
[30]	train-logloss:0.62697	train-auc:0.68966	train-aucpr:0.29958	val-logloss:0.57138	val-auc:0.70313	val-aucpr:0.21603
[40]	train-logloss:0.61987	train-auc:0.69430	train-aucpr:0.30403	val-logloss:0.54902	val-auc:0.70534	val-aucpr:0.21894
[50]	train-logloss:0.61372	train-auc:0.69803	train-aucpr:0.30955	val-logloss:0.53781	val-auc:0.70522	val-aucpr:0.22192
[60]	train-logloss:0.60955	train-auc:0.70053	train-aucpr:0.31296	val-logloss:0.52119	val-auc:0.70791	val-aucpr:0.22470
[70]	train-logloss:0.60580	train-auc:0.70430	train-aucpr:0.31638	val-logloss:0.51547	val-auc:0.70744	val-aucpr:0.21874
[80]	train-logloss:0.60230	train-auc:0.70810	train-aucpr:0.32070	val-logloss:0.50571	val-auc:0.70680	val-aucpr:0.21554
[90]	train-logloss:0.59950	train-auc:0.71092	train-aucpr:0.32348	val-logloss:0.49882	val-auc:0.70568	val-aucpr:0.21509
[95]	train-logloss:0.59855	train-auc:0.71248	train-aucpr:0.32460	val-logloss:0.49648	val-auc:0.70665	val-aucpr:0.21454
[2025-11-19 09:07:16,465] [INFO] [<frozen importlib] - Training completed at iteration 65
[2025-11-19 09:07:16,465] [INFO] [<frozen importlib] - Best train loss: 0.6078
[2025-11-19 09:07:16,465] [INFO] [<frozen importlib] - Best val loss: 0.5166
[2025-11-19 09:07:16,465] [INFO] [<frozen importlib] - Best val AUC: 0.7099
[2025-11-19 09:07:16,465] [INFO] [<frozen importlib] - Best val AUCPR: 0.2263
[2025-11-19 09:07:16,470] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:07:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:07:28,832] [INFO] [<frozen importlib] - Optimal threshold: 0.4850
[2025-11-19 09:07:28,832] [INFO] [<frozen importlib] - Best f1: 0.2773
[2025-11-19 09:07:28,832] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:07:28,875] [INFO] [<frozen importlib] - Validation Results (threshold=0.4850):
[2025-11-19 09:07:28,875] [INFO] [<frozen importlib] -   Accuracy: 0.9018
[2025-11-19 09:07:28,875] [INFO] [<frozen importlib] -   Precision: 0.3190
[2025-11-19 09:07:28,875] [INFO] [<frozen importlib] -   Recall: 0.2452
[2025-11-19 09:07:28,875] [INFO] [<frozen importlib] -   F1 Score: 0.2773
[2025-11-19 09:07:28,875] [INFO] [<frozen importlib] -   AUROC: 0.7099
[2025-11-19 09:07:28,875] [INFO] [<frozen importlib] -   AUPRC: 0.2268
[2025-11-19 09:07:28,875] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:07:28,875] [INFO] [<frozen importlib] -     TN=16685, FP=760
[2025-11-19 09:07:28,875] [INFO] [<frozen importlib] -     FN=1096, TP=356
[2025-11-19 09:07:28,960] [INFO] [<frozen importlib] - Trial 277: AUPRC=0.2268, F1=0.4548, Prec=0.4614, Rec=0.4483 | Optimizing auprc=0.2268
                                                                                        Best trial: 258. Best value: 0.240317:  55%|█████▌    | 277/500 [45:26<35:55,  9.67s/it]Best trial: 258. Best value: 0.240317:  55%|█████▌    | 277/500 [45:26<35:55,  9.67s/it]Best trial: 258. Best value: 0.240317:  56%|█████▌    | 278/500 [45:26<39:18, 10.62s/it][2025-11-19 09:07:28,971] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.631522874486828
[2025-11-19 09:07:28,971] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:07:28,971] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:07:28,971] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:07:28,971] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:07:28,971] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:07:28,971] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:07:28,971] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:07:28,971] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:07:28,971] [INFO] [<frozen importlib] -   gamma: 0.14659697664990656
[2025-11-19 09:07:28,971] [INFO] [<frozen importlib] -   alpha: 0.7170744524325113
[2025-11-19 09:07:28,971] [INFO] [<frozen importlib] -   lambda: 1.2816313513886013
[2025-11-19 09:07:28,972] [INFO] [<frozen importlib] -   learning_rate: 0.03261415068973815
[2025-11-19 09:07:28,972] [INFO] [<frozen importlib] -   subsample: 0.8611376243629997
[2025-11-19 09:07:28,972] [INFO] [<frozen importlib] -   colsample_bytree: 0.6011282001108529
[2025-11-19 09:07:28,972] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5165489084814334
[2025-11-19 09:07:28,972] [INFO] [<frozen importlib] -   colsample_bynode: 0.7881301709852547
[2025-11-19 09:07:28,972] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:07:28,972] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:07:28,972] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:07:28,972] [INFO] [<frozen importlib] -   scale_pos_weight: 6.631522874486828
[2025-11-19 09:07:29,048] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:07:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:07:28,960] Trial 277 finished with value: 0.2267509080001716 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.13616922425154315, 'learning_rate': 0.03105270831466, 'n_estimators': 100, 'alpha': 0.6592974703253281, 'lambda': 1.414076518504844, 'subsample': 0.8255901490998919, 'colsample_bytree': 0.5905467154808699, 'colsample_bylevel': 0.5010900746587685, 'colsample_bynode': 0.7744768974422638, 'scale_pos_weight': 6.4525159263996885}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.67930	train-auc:0.64301	train-aucpr:0.25078	val-logloss:0.67581	val-auc:0.58658	val-aucpr:0.11466
[10]	train-logloss:0.65768	train-auc:0.68275	train-aucpr:0.29393	val-logloss:0.62072	val-auc:0.69305	val-aucpr:0.20927
[20]	train-logloss:0.64372	train-auc:0.68853	train-aucpr:0.29915	val-logloss:0.58513	val-auc:0.69792	val-aucpr:0.21325
[30]	train-logloss:0.63392	train-auc:0.69089	train-aucpr:0.30326	val-logloss:0.55618	val-auc:0.70241	val-aucpr:0.21850
[40]	train-logloss:0.62683	train-auc:0.69424	train-aucpr:0.30677	val-logloss:0.53328	val-auc:0.70544	val-aucpr:0.22015
[50]	train-logloss:0.62132	train-auc:0.69674	train-aucpr:0.30980	val-logloss:0.51550	val-auc:0.70685	val-aucpr:0.22083
[60]	train-logloss:0.61676	train-auc:0.70012	train-aucpr:0.31370	val-logloss:0.52251	val-auc:0.70681	val-aucpr:0.21990
[70]	train-logloss:0.61303	train-auc:0.70338	train-aucpr:0.31690	val-logloss:0.51683	val-auc:0.71021	val-aucpr:0.22158
[80]	train-logloss:0.61037	train-auc:0.70613	train-aucpr:0.31998	val-logloss:0.50623	val-auc:0.71286	val-aucpr:0.22263
[90]	train-logloss:0.60771	train-auc:0.70909	train-aucpr:0.32309	val-logloss:0.50400	val-auc:0.71071	val-aucpr:0.22067
[99]	train-logloss:0.60561	train-auc:0.71216	train-aucpr:0.32642	val-logloss:0.50017	val-auc:0.70966	val-aucpr:0.22147
[2025-11-19 09:07:29,331] [INFO] [<frozen importlib] - Training completed at iteration 81
[2025-11-19 09:07:29,331] [INFO] [<frozen importlib] - Best train loss: 0.6102
[2025-11-19 09:07:29,331] [INFO] [<frozen importlib] - Best val loss: 0.5059
[2025-11-19 09:07:29,331] [INFO] [<frozen importlib] - Best val AUC: 0.7131
[2025-11-19 09:07:29,331] [INFO] [<frozen importlib] - Best val AUCPR: 0.2235
[2025-11-19 09:07:29,336] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:07:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:07:42,957] [INFO] [<frozen importlib] - Optimal threshold: 0.4922
[2025-11-19 09:07:42,957] [INFO] [<frozen importlib] - Best f1: 0.2781
[2025-11-19 09:07:42,957] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:07:43,002] [INFO] [<frozen importlib] - Validation Results (threshold=0.4922):
[2025-11-19 09:07:43,002] [INFO] [<frozen importlib] -   Accuracy: 0.9000
[2025-11-19 09:07:43,002] [INFO] [<frozen importlib] -   Precision: 0.3122
[2025-11-19 09:07:43,002] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 09:07:43,002] [INFO] [<frozen importlib] -   F1 Score: 0.2781
[2025-11-19 09:07:43,002] [INFO] [<frozen importlib] -   AUROC: 0.7131
[2025-11-19 09:07:43,002] [INFO] [<frozen importlib] -   AUPRC: 0.2240
[2025-11-19 09:07:43,002] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:07:43,002] [INFO] [<frozen importlib] -     TN=16643, FP=802
[2025-11-19 09:07:43,002] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 09:07:43,032] [INFO] [<frozen importlib] - Trial 278: AUPRC=0.2240, F1=0.4482, Prec=0.4480, Rec=0.4483 | Optimizing auprc=0.2240
[2025-11-19 09:07:43,033] [INFO] [<frozen importlib] - Trial 278 pruned.
[2025-11-19 09:07:43,033] [ERROR] [<frozen importlib] - Trial 278 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  56%|█████▌    | 278/500 [45:41<39:18, 10.62s/it]Best trial: 258. Best value: 0.240317:  56%|█████▌    | 278/500 [45:41<39:18, 10.62s/it]Best trial: 258. Best value: 0.240317:  56%|█████▌    | 279/500 [45:41<42:56, 11.66s/it][2025-11-19 09:07:43,044] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.04438943210155
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   gamma: 0.16913440197139687
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   alpha: 0.4738274946599697
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   lambda: 1.102196073562171
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   learning_rate: 0.03407037438799513
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   subsample: 0.8147677918001929
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   colsample_bytree: 0.5789976664483257
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5166160080397774
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   colsample_bynode: 0.7992231385368437
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:07:43,044] [INFO] [<frozen importlib] -   scale_pos_weight: 7.04438943210155
[2025-11-19 09:07:43,123] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:07:43] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:07:43,033] Trial 278 pruned. 
[0]	train-logloss:0.70166	train-auc:0.64460	train-aucpr:0.23134	val-logloss:0.69994	val-auc:0.61160	val-aucpr:0.12087
[10]	train-logloss:0.67825	train-auc:0.68202	train-aucpr:0.29291	val-logloss:0.63909	val-auc:0.70822	val-aucpr:0.21583
[20]	train-logloss:0.66339	train-auc:0.68730	train-aucpr:0.29775	val-logloss:0.60179	val-auc:0.70862	val-aucpr:0.22292
[30]	train-logloss:0.65306	train-auc:0.69178	train-aucpr:0.30344	val-logloss:0.56491	val-auc:0.70742	val-aucpr:0.22866
[40]	train-logloss:0.64600	train-auc:0.69673	train-aucpr:0.30644	val-logloss:0.54787	val-auc:0.70771	val-aucpr:0.22545
[50]	train-logloss:0.63969	train-auc:0.70043	train-aucpr:0.31170	val-logloss:0.54289	val-auc:0.70340	val-aucpr:0.22849
[60]	train-logloss:0.63565	train-auc:0.70326	train-aucpr:0.31459	val-logloss:0.53137	val-auc:0.70284	val-aucpr:0.22982
[70]	train-logloss:0.63185	train-auc:0.70678	train-aucpr:0.31763	val-logloss:0.52879	val-auc:0.70146	val-aucpr:0.22816
[80]	train-logloss:0.62848	train-auc:0.71013	train-aucpr:0.32141	val-logloss:0.51678	val-auc:0.69914	val-aucpr:0.22305
[87]	train-logloss:0.62630	train-auc:0.71273	train-aucpr:0.32419	val-logloss:0.50286	val-auc:0.69261	val-aucpr:0.21201
[2025-11-19 09:07:43,395] [INFO] [<frozen importlib] - Training completed at iteration 57
[2025-11-19 09:07:43,395] [INFO] [<frozen importlib] - Best train loss: 0.6369
[2025-11-19 09:07:43,395] [INFO] [<frozen importlib] - Best val loss: 0.5330
[2025-11-19 09:07:43,395] [INFO] [<frozen importlib] - Best val AUC: 0.7033
[2025-11-19 09:07:43,395] [INFO] [<frozen importlib] - Best val AUCPR: 0.2303
[2025-11-19 09:07:43,400] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:07:43] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:07:55,964] [INFO] [<frozen importlib] - Optimal threshold: 0.5115
[2025-11-19 09:07:55,965] [INFO] [<frozen importlib] - Best f1: 0.2676
[2025-11-19 09:07:55,965] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:07:56,006] [INFO] [<frozen importlib] - Validation Results (threshold=0.5115):
[2025-11-19 09:07:56,006] [INFO] [<frozen importlib] -   Accuracy: 0.9027
[2025-11-19 09:07:56,006] [INFO] [<frozen importlib] -   Precision: 0.3173
[2025-11-19 09:07:56,006] [INFO] [<frozen importlib] -   Recall: 0.2314
[2025-11-19 09:07:56,006] [INFO] [<frozen importlib] -   F1 Score: 0.2676
[2025-11-19 09:07:56,006] [INFO] [<frozen importlib] -   AUROC: 0.7033
[2025-11-19 09:07:56,006] [INFO] [<frozen importlib] -   AUPRC: 0.2307
[2025-11-19 09:07:56,006] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:07:56,006] [INFO] [<frozen importlib] -     TN=16722, FP=723
[2025-11-19 09:07:56,006] [INFO] [<frozen importlib] -     FN=1116, TP=336
[2025-11-19 09:07:56,031] [INFO] [<frozen importlib] - Trial 279: AUPRC=0.2307, F1=0.4624, Prec=0.4749, Rec=0.4504 | Optimizing auprc=0.2307
                                                                                        Best trial: 258. Best value: 0.240317:  56%|█████▌    | 279/500 [45:54<42:56, 11.66s/it]Best trial: 258. Best value: 0.240317:  56%|█████▌    | 279/500 [45:54<42:56, 11.66s/it]Best trial: 258. Best value: 0.240317:  56%|█████▌    | 280/500 [45:54<44:13, 12.06s/it][2025-11-19 09:07:56,043] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.532101026154243
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   gamma: 0.23748804564044684
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   alpha: 0.6210056049696122
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   lambda: 0.9402816433189097
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   learning_rate: 0.03165693070002128
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   subsample: 0.8366077401955464
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   colsample_bytree: 0.6120836390565876
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5082668656985685
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   colsample_bynode: 0.7579232430225674
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:07:56,043] [INFO] [<frozen importlib] -   scale_pos_weight: 5.532101026154243
[2025-11-19 09:07:56,119] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:07:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:07:56,032] Trial 279 finished with value: 0.23066334580988454 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.16913440197139687, 'learning_rate': 0.03407037438799513, 'n_estimators': 450, 'alpha': 0.4738274946599697, 'lambda': 1.102196073562171, 'subsample': 0.8147677918001929, 'colsample_bytree': 0.5789976664483257, 'colsample_bylevel': 0.5166160080397774, 'colsample_bynode': 0.7992231385368437, 'scale_pos_weight': 7.04438943210155}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.61793	train-auc:0.64250	train-aucpr:0.24845	val-logloss:0.60492	val-auc:0.58799	val-aucpr:0.13352
[10]	train-logloss:0.59938	train-auc:0.68104	train-aucpr:0.29347	val-logloss:0.56361	val-auc:0.70282	val-aucpr:0.21799
[20]	train-logloss:0.58720	train-auc:0.68605	train-aucpr:0.29858	val-logloss:0.52884	val-auc:0.70785	val-aucpr:0.22187
[30]	train-logloss:0.57863	train-auc:0.69002	train-aucpr:0.30234	val-logloss:0.50624	val-auc:0.70918	val-aucpr:0.22691
[40]	train-logloss:0.57203	train-auc:0.69387	train-aucpr:0.30663	val-logloss:0.48186	val-auc:0.70471	val-aucpr:0.22440
[50]	train-logloss:0.56658	train-auc:0.69829	train-aucpr:0.31234	val-logloss:0.47191	val-auc:0.70332	val-aucpr:0.22725
[60]	train-logloss:0.56273	train-auc:0.70035	train-aucpr:0.31540	val-logloss:0.46091	val-auc:0.70452	val-aucpr:0.22994
[70]	train-logloss:0.55949	train-auc:0.70250	train-aucpr:0.31777	val-logloss:0.45693	val-auc:0.70232	val-aucpr:0.22909
[80]	train-logloss:0.55665	train-auc:0.70528	train-aucpr:0.32112	val-logloss:0.45543	val-auc:0.69846	val-aucpr:0.22786
[90]	train-logloss:0.55437	train-auc:0.70816	train-aucpr:0.32417	val-logloss:0.44714	val-auc:0.70054	val-aucpr:0.22714
[100]	train-logloss:0.55228	train-auc:0.71117	train-aucpr:0.32744	val-logloss:0.44529	val-auc:0.69815	val-aucpr:0.22515
[103]	train-logloss:0.55147	train-auc:0.71248	train-aucpr:0.32885	val-logloss:0.44705	val-auc:0.69812	val-aucpr:0.22523
[2025-11-19 09:07:56,407] [INFO] [<frozen importlib] - Training completed at iteration 74
[2025-11-19 09:07:56,407] [INFO] [<frozen importlib] - Best train loss: 0.5586
[2025-11-19 09:07:56,407] [INFO] [<frozen importlib] - Best val loss: 0.4542
[2025-11-19 09:07:56,407] [INFO] [<frozen importlib] - Best val AUC: 0.7035
[2025-11-19 09:07:56,407] [INFO] [<frozen importlib] - Best val AUCPR: 0.2311
[2025-11-19 09:07:56,412] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:07:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:08:09,613] [INFO] [<frozen importlib] - Optimal threshold: 0.4368
[2025-11-19 09:08:09,613] [INFO] [<frozen importlib] - Best f1: 0.2835
[2025-11-19 09:08:09,613] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:08:09,661] [INFO] [<frozen importlib] - Validation Results (threshold=0.4368):
[2025-11-19 09:08:09,661] [INFO] [<frozen importlib] -   Accuracy: 0.8973
[2025-11-19 09:08:09,661] [INFO] [<frozen importlib] -   Precision: 0.3055
[2025-11-19 09:08:09,661] [INFO] [<frozen importlib] -   Recall: 0.2645
[2025-11-19 09:08:09,661] [INFO] [<frozen importlib] -   F1 Score: 0.2835
[2025-11-19 09:08:09,661] [INFO] [<frozen importlib] -   AUROC: 0.7035
[2025-11-19 09:08:09,661] [INFO] [<frozen importlib] -   AUPRC: 0.2315
[2025-11-19 09:08:09,661] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:08:09,661] [INFO] [<frozen importlib] -     TN=16572, FP=873
[2025-11-19 09:08:09,661] [INFO] [<frozen importlib] -     FN=1068, TP=384
[2025-11-19 09:08:09,685] [INFO] [<frozen importlib] - Trial 280: AUPRC=0.2315, F1=0.4490, Prec=0.4353, Rec=0.4635 | Optimizing auprc=0.2315
                                                                                        Best trial: 258. Best value: 0.240317:  56%|█████▌    | 280/500 [46:07<44:13, 12.06s/it]Best trial: 258. Best value: 0.240317:  56%|█████▌    | 280/500 [46:07<44:13, 12.06s/it]Best trial: 258. Best value: 0.240317:  56%|█████▌    | 281/500 [46:07<45:45, 12.54s/it][2025-11-19 09:08:09,705] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.346532813739846
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   gamma: 0.07582014614902097
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   alpha: 0.5212026961232663
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   lambda: 1.043564878865596
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   learning_rate: 0.033734282194733935
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   subsample: 0.8054872626245482
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   colsample_bytree: 0.5693885399705322
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5232186581880752
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   colsample_bynode: 0.7809406385874724
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:08:09,705] [INFO] [<frozen importlib] -   scale_pos_weight: 6.346532813739846
[2025-11-19 09:08:09,784] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:08:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:08:09,686] Trial 280 finished with value: 0.2314758253456241 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.23748804564044684, 'learning_rate': 0.03165693070002128, 'n_estimators': 450, 'alpha': 0.6210056049696122, 'lambda': 0.9402816433189097, 'subsample': 0.8366077401955464, 'colsample_bytree': 0.6120836390565876, 'colsample_bylevel': 0.5082668656985685, 'colsample_bynode': 0.7579232430225674, 'scale_pos_weight': 5.532101026154243}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.66355	train-auc:0.64007	train-aucpr:0.22970	val-logloss:0.65607	val-auc:0.63613	val-aucpr:0.13567
[10]	train-logloss:0.64218	train-auc:0.67938	train-aucpr:0.28914	val-logloss:0.60378	val-auc:0.67041	val-aucpr:0.16656
[20]	train-logloss:0.62875	train-auc:0.68746	train-aucpr:0.29617	val-logloss:0.56536	val-auc:0.68367	val-aucpr:0.19586
[30]	train-logloss:0.61883	train-auc:0.69110	train-aucpr:0.30208	val-logloss:0.53499	val-auc:0.68568	val-aucpr:0.21122
[40]	train-logloss:0.61218	train-auc:0.69380	train-aucpr:0.30532	val-logloss:0.52437	val-auc:0.69095	val-aucpr:0.21476
[50]	train-logloss:0.60632	train-auc:0.69783	train-aucpr:0.30982	val-logloss:0.51583	val-auc:0.69693	val-aucpr:0.22419
[60]	train-logloss:0.60221	train-auc:0.70186	train-aucpr:0.31360	val-logloss:0.51000	val-auc:0.70275	val-aucpr:0.22915
[70]	train-logloss:0.59835	train-auc:0.70729	train-aucpr:0.31872	val-logloss:0.50732	val-auc:0.70576	val-aucpr:0.22754
[80]	train-logloss:0.59511	train-auc:0.71111	train-aucpr:0.32297	val-logloss:0.49880	val-auc:0.70491	val-aucpr:0.22450
[90]	train-logloss:0.59237	train-auc:0.71465	train-aucpr:0.32586	val-logloss:0.50248	val-auc:0.70004	val-aucpr:0.21243
[2025-11-19 09:08:10,048] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:08:10,048] [INFO] [<frozen importlib] - Best train loss: 0.6022
[2025-11-19 09:08:10,048] [INFO] [<frozen importlib] - Best val loss: 0.5100
[2025-11-19 09:08:10,048] [INFO] [<frozen importlib] - Best val AUC: 0.7027
[2025-11-19 09:08:10,048] [INFO] [<frozen importlib] - Best val AUCPR: 0.2292
[2025-11-19 09:08:10,053] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:08:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:08:22,813] [INFO] [<frozen importlib] - Optimal threshold: 0.4869
[2025-11-19 09:08:22,813] [INFO] [<frozen importlib] - Best f1: 0.2770
[2025-11-19 09:08:22,814] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:08:22,859] [INFO] [<frozen importlib] - Validation Results (threshold=0.4869):
[2025-11-19 09:08:22,859] [INFO] [<frozen importlib] -   Accuracy: 0.8989
[2025-11-19 09:08:22,859] [INFO] [<frozen importlib] -   Precision: 0.3073
[2025-11-19 09:08:22,859] [INFO] [<frozen importlib] -   Recall: 0.2521
[2025-11-19 09:08:22,859] [INFO] [<frozen importlib] -   F1 Score: 0.2770
[2025-11-19 09:08:22,859] [INFO] [<frozen importlib] -   AUROC: 0.7027
[2025-11-19 09:08:22,859] [INFO] [<frozen importlib] -   AUPRC: 0.2295
[2025-11-19 09:08:22,859] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:08:22,859] [INFO] [<frozen importlib] -     TN=16620, FP=825
[2025-11-19 09:08:22,859] [INFO] [<frozen importlib] -     FN=1086, TP=366
[2025-11-19 09:08:22,884] [INFO] [<frozen importlib] - Trial 281: AUPRC=0.2295, F1=0.4473, Prec=0.4429, Rec=0.4518 | Optimizing auprc=0.2295
[2025-11-19 09:08:22,884] [INFO] [<frozen importlib] - Trial 281 pruned.
[2025-11-19 09:08:22,884] [ERROR] [<frozen importlib] - Trial 281 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  56%|█████▌    | 281/500 [46:20<45:45, 12.54s/it]Best trial: 258. Best value: 0.240317:  56%|█████▌    | 281/500 [46:20<45:45, 12.54s/it]Best trial: 258. Best value: 0.240317:  56%|█████▋    | 282/500 [46:20<46:16, 12.74s/it][2025-11-19 09:08:22,899] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.819862452075146
[2025-11-19 09:08:22,899] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:08:22,899] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:08:22,899] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:08:22,899] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:08:22,899] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:08:22,899] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:08:22,899] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:08:22,899] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:08:22,899] [INFO] [<frozen importlib] -   gamma: 0.12865183866562163
[2025-11-19 09:08:22,899] [INFO] [<frozen importlib] -   alpha: 0.5813404340754864
[2025-11-19 09:08:22,899] [INFO] [<frozen importlib] -   lambda: 1.207982847640635
[2025-11-19 09:08:22,900] [INFO] [<frozen importlib] -   learning_rate: 0.03414168348726453
[2025-11-19 09:08:22,900] [INFO] [<frozen importlib] -   subsample: 0.8507497832152113
[2025-11-19 09:08:22,900] [INFO] [<frozen importlib] -   colsample_bytree: 0.59037778533557
[2025-11-19 09:08:22,900] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5112916367424373
[2025-11-19 09:08:22,900] [INFO] [<frozen importlib] -   colsample_bynode: 0.771598132774462
[2025-11-19 09:08:22,900] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:08:22,900] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:08:22,900] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:08:22,900] [INFO] [<frozen importlib] -   scale_pos_weight: 6.819862452075146
[2025-11-19 09:08:22,981] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:08:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:08:22,884] Trial 281 pruned. 
[0]	train-logloss:0.68974	train-auc:0.63570	train-aucpr:0.22752	val-logloss:0.68619	val-auc:0.60692	val-aucpr:0.12738
[10]	train-logloss:0.66717	train-auc:0.68011	train-aucpr:0.28764	val-logloss:0.63553	val-auc:0.70775	val-aucpr:0.18871
[20]	train-logloss:0.65246	train-auc:0.68681	train-aucpr:0.29690	val-logloss:0.60034	val-auc:0.70529	val-aucpr:0.20688
[30]	train-logloss:0.64265	train-auc:0.69077	train-aucpr:0.30122	val-logloss:0.57873	val-auc:0.70069	val-aucpr:0.21902
[40]	train-logloss:0.63549	train-auc:0.69577	train-aucpr:0.30445	val-logloss:0.55944	val-auc:0.70053	val-aucpr:0.21955
[50]	train-logloss:0.62912	train-auc:0.70041	train-aucpr:0.31072	val-logloss:0.54510	val-auc:0.69923	val-aucpr:0.22150
[60]	train-logloss:0.62491	train-auc:0.70307	train-aucpr:0.31416	val-logloss:0.52825	val-auc:0.70171	val-aucpr:0.22178
[70]	train-logloss:0.62098	train-auc:0.70763	train-aucpr:0.31764	val-logloss:0.52401	val-auc:0.69368	val-aucpr:0.21341
[80]	train-logloss:0.61775	train-auc:0.71098	train-aucpr:0.32184	val-logloss:0.51515	val-auc:0.69623	val-aucpr:0.21710
[86]	train-logloss:0.61601	train-auc:0.71228	train-aucpr:0.32373	val-logloss:0.51014	val-auc:0.69808	val-aucpr:0.21586
[2025-11-19 09:08:23,235] [INFO] [<frozen importlib] - Training completed at iteration 57
[2025-11-19 09:08:23,235] [INFO] [<frozen importlib] - Best train loss: 0.6261
[2025-11-19 09:08:23,235] [INFO] [<frozen importlib] - Best val loss: 0.5313
[2025-11-19 09:08:23,235] [INFO] [<frozen importlib] - Best val AUC: 0.7013
[2025-11-19 09:08:23,235] [INFO] [<frozen importlib] - Best val AUCPR: 0.2229
[2025-11-19 09:08:23,240] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:08:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:08:34,781] [INFO] [<frozen importlib] - Optimal threshold: 0.5014
[2025-11-19 09:08:34,781] [INFO] [<frozen importlib] - Best f1: 0.2695
[2025-11-19 09:08:34,781] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:08:34,824] [INFO] [<frozen importlib] - Validation Results (threshold=0.5014):
[2025-11-19 09:08:34,824] [INFO] [<frozen importlib] -   Accuracy: 0.9022
[2025-11-19 09:08:34,824] [INFO] [<frozen importlib] -   Precision: 0.3160
[2025-11-19 09:08:34,824] [INFO] [<frozen importlib] -   Recall: 0.2348
[2025-11-19 09:08:34,824] [INFO] [<frozen importlib] -   F1 Score: 0.2695
[2025-11-19 09:08:34,824] [INFO] [<frozen importlib] -   AUROC: 0.7013
[2025-11-19 09:08:34,824] [INFO] [<frozen importlib] -   AUPRC: 0.2233
[2025-11-19 09:08:34,824] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:08:34,824] [INFO] [<frozen importlib] -     TN=16707, FP=738
[2025-11-19 09:08:34,824] [INFO] [<frozen importlib] -     FN=1111, TP=341
[2025-11-19 09:08:34,848] [INFO] [<frozen importlib] - Trial 282: AUPRC=0.2233, F1=0.4717, Prec=0.4781, Rec=0.4656 | Optimizing auprc=0.2233
[2025-11-19 09:08:34,849] [INFO] [<frozen importlib] - Trial 282 pruned.
[2025-11-19 09:08:34,849] [ERROR] [<frozen importlib] - Trial 282 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  56%|█████▋    | 282/500 [46:32<46:16, 12.74s/it]Best trial: 258. Best value: 0.240317:  56%|█████▋    | 282/500 [46:32<46:16, 12.74s/it]Best trial: 258. Best value: 0.240317:  57%|█████▋    | 283/500 [46:32<45:13, 12.50s/it][2025-11-19 09:08:34,861] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.085075086828023
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   gamma: 0.10971687092786211
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   alpha: 0.6830032884167581
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   lambda: 0.8457276486886403
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   learning_rate: 0.03567342208608664
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   subsample: 0.8247699345028331
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   colsample_bytree: 0.8656138515666827
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5002338444494254
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   colsample_bynode: 0.7570144612418916
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:08:34,861] [INFO] [<frozen importlib] -   scale_pos_weight: 6.085075086828023
[2025-11-19 09:08:34,932] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:08:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:08:34,849] Trial 282 pruned. 
[0]	train-logloss:0.64857	train-auc:0.65509	train-aucpr:0.24387	val-logloss:0.63621	val-auc:0.64136	val-aucpr:0.13490
[10]	train-logloss:0.62648	train-auc:0.67859	train-aucpr:0.28715	val-logloss:0.58402	val-auc:0.63934	val-aucpr:0.18267
[20]	train-logloss:0.61249	train-auc:0.68625	train-aucpr:0.29886	val-logloss:0.55016	val-auc:0.67753	val-aucpr:0.19638
[30]	train-logloss:0.60319	train-auc:0.69165	train-aucpr:0.30427	val-logloss:0.51888	val-auc:0.69513	val-aucpr:0.21215
[40]	train-logloss:0.59613	train-auc:0.69739	train-aucpr:0.31020	val-logloss:0.49455	val-auc:0.69261	val-aucpr:0.21868
[50]	train-logloss:0.59044	train-auc:0.70218	train-aucpr:0.31579	val-logloss:0.48190	val-auc:0.69432	val-aucpr:0.21190
[60]	train-logloss:0.58630	train-auc:0.70580	train-aucpr:0.31988	val-logloss:0.47898	val-auc:0.68826	val-aucpr:0.20815
[69]	train-logloss:0.58329	train-auc:0.70950	train-aucpr:0.32310	val-logloss:0.47495	val-auc:0.68456	val-aucpr:0.20393
[2025-11-19 09:08:35,145] [INFO] [<frozen importlib] - Training completed at iteration 40
[2025-11-19 09:08:35,145] [INFO] [<frozen importlib] - Best train loss: 0.5961
[2025-11-19 09:08:35,145] [INFO] [<frozen importlib] - Best val loss: 0.4946
[2025-11-19 09:08:35,145] [INFO] [<frozen importlib] - Best val AUC: 0.6926
[2025-11-19 09:08:35,145] [INFO] [<frozen importlib] - Best val AUCPR: 0.2187
[2025-11-19 09:08:35,150] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:08:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:08:40,516] [INFO] [<frozen importlib] - Optimal threshold: 0.4488
[2025-11-19 09:08:40,516] [INFO] [<frozen importlib] - Best f1: 0.2645
[2025-11-19 09:08:40,516] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:08:40,559] [INFO] [<frozen importlib] - Validation Results (threshold=0.4488):
[2025-11-19 09:08:40,559] [INFO] [<frozen importlib] -   Accuracy: 0.8808
[2025-11-19 09:08:40,559] [INFO] [<frozen importlib] -   Precision: 0.2516
[2025-11-19 09:08:40,559] [INFO] [<frozen importlib] -   Recall: 0.2789
[2025-11-19 09:08:40,559] [INFO] [<frozen importlib] -   F1 Score: 0.2645
[2025-11-19 09:08:40,559] [INFO] [<frozen importlib] -   AUROC: 0.6926
[2025-11-19 09:08:40,559] [INFO] [<frozen importlib] -   AUPRC: 0.2189
[2025-11-19 09:08:40,559] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:08:40,559] [INFO] [<frozen importlib] -     TN=16240, FP=1205
[2025-11-19 09:08:40,559] [INFO] [<frozen importlib] -     FN=1047, TP=405
[2025-11-19 09:08:40,581] [INFO] [<frozen importlib] - Trial 283: AUPRC=0.2189, F1=0.4231, Prec=0.3717, Rec=0.4910 | Optimizing auprc=0.2189
[2025-11-19 09:08:40,581] [INFO] [<frozen importlib] - Trial 283 pruned.
[2025-11-19 09:08:40,581] [ERROR] [<frozen importlib] - Trial 283 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  57%|█████▋    | 283/500 [46:38<45:13, 12.50s/it]Best trial: 258. Best value: 0.240317:  57%|█████▋    | 283/500 [46:38<45:13, 12.50s/it]Best trial: 258. Best value: 0.240317:  57%|█████▋    | 284/500 [46:38<37:42, 10.47s/it][2025-11-19 09:08:40,593] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.989084758897762
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   gamma: 0.1599007035905207
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   alpha: 0.6380116686945239
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   lambda: 1.082955601512034
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   learning_rate: 0.032764096222642355
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   subsample: 0.7990135153543739
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   colsample_bytree: 0.5792538024427847
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   colsample_bylevel: 0.520443168803087
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   colsample_bynode: 0.810017405515142
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:08:40,593] [INFO] [<frozen importlib] -   scale_pos_weight: 6.989084758897762
[2025-11-19 09:08:40,667] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:08:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:08:40,581] Trial 283 pruned. 
[0]	train-logloss:0.69852	train-auc:0.64659	train-aucpr:0.22740	val-logloss:0.69508	val-auc:0.62732	val-aucpr:0.12308
[10]	train-logloss:0.67609	train-auc:0.68109	train-aucpr:0.28935	val-logloss:0.63704	val-auc:0.71279	val-aucpr:0.21807
[20]	train-logloss:0.66172	train-auc:0.68610	train-aucpr:0.29670	val-logloss:0.60056	val-auc:0.70893	val-aucpr:0.21865
[30]	train-logloss:0.65157	train-auc:0.69064	train-aucpr:0.30256	val-logloss:0.56911	val-auc:0.70463	val-aucpr:0.22119
[40]	train-logloss:0.64452	train-auc:0.69477	train-aucpr:0.30555	val-logloss:0.54995	val-auc:0.70128	val-aucpr:0.22314
[50]	train-logloss:0.63792	train-auc:0.69962	train-aucpr:0.31207	val-logloss:0.55771	val-auc:0.69740	val-aucpr:0.22458
[60]	train-logloss:0.63351	train-auc:0.70255	train-aucpr:0.31481	val-logloss:0.55641	val-auc:0.69826	val-aucpr:0.22458
[70]	train-logloss:0.62988	train-auc:0.70450	train-aucpr:0.31721	val-logloss:0.54802	val-auc:0.70357	val-aucpr:0.22211
[75]	train-logloss:0.62855	train-auc:0.70613	train-aucpr:0.31813	val-logloss:0.54250	val-auc:0.70207	val-aucpr:0.22155
[2025-11-19 09:08:40,892] [INFO] [<frozen importlib] - Training completed at iteration 46
[2025-11-19 09:08:40,892] [INFO] [<frozen importlib] - Best train loss: 0.6402
[2025-11-19 09:08:40,892] [INFO] [<frozen importlib] - Best val loss: 0.5538
[2025-11-19 09:08:40,892] [INFO] [<frozen importlib] - Best val AUC: 0.6987
[2025-11-19 09:08:40,892] [INFO] [<frozen importlib] - Best val AUCPR: 0.2258
[2025-11-19 09:08:40,897] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:08:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:08:49,142] [INFO] [<frozen importlib] - Optimal threshold: 0.4966
[2025-11-19 09:08:49,142] [INFO] [<frozen importlib] - Best f1: 0.2671
[2025-11-19 09:08:49,142] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:08:49,185] [INFO] [<frozen importlib] - Validation Results (threshold=0.4966):
[2025-11-19 09:08:49,186] [INFO] [<frozen importlib] -   Accuracy: 0.8800
[2025-11-19 09:08:49,186] [INFO] [<frozen importlib] -   Precision: 0.2517
[2025-11-19 09:08:49,186] [INFO] [<frozen importlib] -   Recall: 0.2844
[2025-11-19 09:08:49,186] [INFO] [<frozen importlib] -   F1 Score: 0.2671
[2025-11-19 09:08:49,186] [INFO] [<frozen importlib] -   AUROC: 0.6987
[2025-11-19 09:08:49,186] [INFO] [<frozen importlib] -   AUPRC: 0.2259
[2025-11-19 09:08:49,186] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:08:49,186] [INFO] [<frozen importlib] -     TN=16217, FP=1228
[2025-11-19 09:08:49,186] [INFO] [<frozen importlib] -     FN=1039, TP=413
[2025-11-19 09:08:49,209] [INFO] [<frozen importlib] - Trial 284: AUPRC=0.2259, F1=0.4419, Prec=0.3823, Rec=0.5234 | Optimizing auprc=0.2259
[2025-11-19 09:08:49,209] [INFO] [<frozen importlib] - Trial 284 pruned.
[2025-11-19 09:08:49,210] [ERROR] [<frozen importlib] - Trial 284 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  57%|█████▋    | 284/500 [46:47<37:42, 10.47s/it]Best trial: 258. Best value: 0.240317:  57%|█████▋    | 284/500 [46:47<37:42, 10.47s/it]Best trial: 258. Best value: 0.240317:  57%|█████▋    | 285/500 [46:47<35:32,  9.92s/it][2025-11-19 09:08:49,221] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.650104317623539
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   gamma: 0.1599138365915842
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   alpha: 0.5868182379560455
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   lambda: 0.9461797554286795
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   learning_rate: 0.03011976628309071
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   subsample: 0.8147456797783961
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   colsample_bytree: 0.5651531485698834
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   colsample_bylevel: 0.509673244921873
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   colsample_bynode: 0.7834850859114102
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:08:49,221] [INFO] [<frozen importlib] -   scale_pos_weight: 6.650104317623539
[2025-11-19 09:08:49,294] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:08:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:08:49,210] Trial 284 pruned. 
[0]	train-logloss:0.68071	train-auc:0.63583	train-aucpr:0.22811	val-logloss:0.67711	val-auc:0.62335	val-aucpr:0.13087
[10]	train-logloss:0.66021	train-auc:0.67974	train-aucpr:0.28894	val-logloss:0.63029	val-auc:0.66716	val-aucpr:0.16556
[20]	train-logloss:0.64719	train-auc:0.68273	train-aucpr:0.29566	val-logloss:0.59650	val-auc:0.69459	val-aucpr:0.20326
[30]	train-logloss:0.63762	train-auc:0.68816	train-aucpr:0.29937	val-logloss:0.57976	val-auc:0.68684	val-aucpr:0.21201
[40]	train-logloss:0.63042	train-auc:0.69274	train-aucpr:0.30269	val-logloss:0.55371	val-auc:0.70439	val-aucpr:0.22238
[50]	train-logloss:0.62433	train-auc:0.69814	train-aucpr:0.30720	val-logloss:0.54963	val-auc:0.70112	val-aucpr:0.21933
[60]	train-logloss:0.61979	train-auc:0.70167	train-aucpr:0.31089	val-logloss:0.52967	val-auc:0.69310	val-aucpr:0.21770
[70]	train-logloss:0.61582	train-auc:0.70437	train-aucpr:0.31391	val-logloss:0.52297	val-auc:0.69495	val-aucpr:0.21555
[71]	train-logloss:0.61560	train-auc:0.70454	train-aucpr:0.31430	val-logloss:0.52272	val-auc:0.69581	val-aucpr:0.21661
[2025-11-19 09:08:49,516] [INFO] [<frozen importlib] - Training completed at iteration 42
[2025-11-19 09:08:49,516] [INFO] [<frozen importlib] - Best train loss: 0.6289
[2025-11-19 09:08:49,516] [INFO] [<frozen importlib] - Best val loss: 0.5483
[2025-11-19 09:08:49,516] [INFO] [<frozen importlib] - Best val AUC: 0.7047
[2025-11-19 09:08:49,516] [INFO] [<frozen importlib] - Best val AUCPR: 0.2230
[2025-11-19 09:08:49,520] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:08:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:08:57,540] [INFO] [<frozen importlib] - Optimal threshold: 0.4817
[2025-11-19 09:08:57,540] [INFO] [<frozen importlib] - Best f1: 0.2606
[2025-11-19 09:08:57,540] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:08:57,586] [INFO] [<frozen importlib] - Validation Results (threshold=0.4817):
[2025-11-19 09:08:57,586] [INFO] [<frozen importlib] -   Accuracy: 0.8754
[2025-11-19 09:08:57,586] [INFO] [<frozen importlib] -   Precision: 0.2395
[2025-11-19 09:08:57,586] [INFO] [<frozen importlib] -   Recall: 0.2858
[2025-11-19 09:08:57,587] [INFO] [<frozen importlib] -   F1 Score: 0.2606
[2025-11-19 09:08:57,587] [INFO] [<frozen importlib] -   AUROC: 0.7047
[2025-11-19 09:08:57,587] [INFO] [<frozen importlib] -   AUPRC: 0.2232
[2025-11-19 09:08:57,587] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:08:57,587] [INFO] [<frozen importlib] -     TN=16127, FP=1318
[2025-11-19 09:08:57,587] [INFO] [<frozen importlib] -     FN=1037, TP=415
[2025-11-19 09:08:57,612] [INFO] [<frozen importlib] - Trial 285: AUPRC=0.2232, F1=0.4288, Prec=0.3645, Rec=0.5207 | Optimizing auprc=0.2232
[2025-11-19 09:08:57,613] [INFO] [<frozen importlib] - Trial 285 pruned.
[2025-11-19 09:08:57,613] [ERROR] [<frozen importlib] - Trial 285 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  57%|█████▋    | 285/500 [46:55<35:32,  9.92s/it]Best trial: 258. Best value: 0.240317:  57%|█████▋    | 285/500 [46:55<35:32,  9.92s/it]Best trial: 258. Best value: 0.240317:  57%|█████▋    | 286/500 [46:55<33:45,  9.46s/it][2025-11-19 09:08:57,626] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.333606447530687
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   gamma: 0.1884472703985773
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   alpha: 0.5151864460356838
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   lambda: 1.3042729994594104
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   learning_rate: 0.03176786531664085
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   subsample: 0.8034998217265237
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   colsample_bytree: 0.6037899547467743
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8907754748763607
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   colsample_bynode: 0.7668416101690795
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:08:57,626] [INFO] [<frozen importlib] -   scale_pos_weight: 5.333606447530687
[2025-11-19 09:08:57,703] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:08:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:08:57,613] Trial 285 pruned. 
[0]	train-logloss:0.60636	train-auc:0.65493	train-aucpr:0.23687	val-logloss:0.59010	val-auc:0.62605	val-aucpr:0.12096
[10]	train-logloss:0.58761	train-auc:0.67697	train-aucpr:0.28303	val-logloss:0.54400	val-auc:0.68658	val-aucpr:0.20136
[20]	train-logloss:0.57523	train-auc:0.68582	train-aucpr:0.29477	val-logloss:0.51093	val-auc:0.68752	val-aucpr:0.20070
[30]	train-logloss:0.56654	train-auc:0.69164	train-aucpr:0.30191	val-logloss:0.48710	val-auc:0.69298	val-aucpr:0.20528
[40]	train-logloss:0.56002	train-auc:0.69627	train-aucpr:0.30710	val-logloss:0.47959	val-auc:0.69863	val-aucpr:0.21275
[50]	train-logloss:0.55478	train-auc:0.70057	train-aucpr:0.31201	val-logloss:0.46786	val-auc:0.69820	val-aucpr:0.21396
[60]	train-logloss:0.55083	train-auc:0.70495	train-aucpr:0.31567	val-logloss:0.46829	val-auc:0.69401	val-aucpr:0.21135
[70]	train-logloss:0.54782	train-auc:0.70733	train-aucpr:0.31880	val-logloss:0.46694	val-auc:0.69577	val-aucpr:0.21412
[77]	train-logloss:0.54584	train-auc:0.71005	train-aucpr:0.32126	val-logloss:0.46277	val-auc:0.69710	val-aucpr:0.21028
[2025-11-19 09:08:57,933] [INFO] [<frozen importlib] - Training completed at iteration 48
[2025-11-19 09:08:57,933] [INFO] [<frozen importlib] - Best train loss: 0.5555
[2025-11-19 09:08:57,933] [INFO] [<frozen importlib] - Best val loss: 0.4722
[2025-11-19 09:08:57,933] [INFO] [<frozen importlib] - Best val AUC: 0.6989
[2025-11-19 09:08:57,933] [INFO] [<frozen importlib] - Best val AUCPR: 0.2143
[2025-11-19 09:08:57,938] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:08:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:09:04,636] [INFO] [<frozen importlib] - Optimal threshold: 0.4378
[2025-11-19 09:09:04,636] [INFO] [<frozen importlib] - Best f1: 0.2690
[2025-11-19 09:09:04,636] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:09:04,681] [INFO] [<frozen importlib] - Validation Results (threshold=0.4378):
[2025-11-19 09:09:04,681] [INFO] [<frozen importlib] -   Accuracy: 0.8956
[2025-11-19 09:09:04,681] [INFO] [<frozen importlib] -   Precision: 0.2911
[2025-11-19 09:09:04,681] [INFO] [<frozen importlib] -   Recall: 0.2500
[2025-11-19 09:09:04,681] [INFO] [<frozen importlib] -   F1 Score: 0.2690
[2025-11-19 09:09:04,681] [INFO] [<frozen importlib] -   AUROC: 0.6989
[2025-11-19 09:09:04,681] [INFO] [<frozen importlib] -   AUPRC: 0.2147
[2025-11-19 09:09:04,681] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:09:04,681] [INFO] [<frozen importlib] -     TN=16561, FP=884
[2025-11-19 09:09:04,681] [INFO] [<frozen importlib] -     FN=1089, TP=363
[2025-11-19 09:09:04,705] [INFO] [<frozen importlib] - Trial 286: AUPRC=0.2147, F1=0.4458, Prec=0.4311, Rec=0.4614 | Optimizing auprc=0.2147
[2025-11-19 09:09:04,706] [INFO] [<frozen importlib] - Trial 286 pruned.
[2025-11-19 09:09:04,706] [ERROR] [<frozen importlib] - Trial 286 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  57%|█████▋    | 286/500 [47:02<33:45,  9.46s/it]Best trial: 258. Best value: 0.240317:  57%|█████▋    | 286/500 [47:02<33:45,  9.46s/it]Best trial: 258. Best value: 0.240317:  57%|█████▋    | 287/500 [47:02<31:04,  8.75s/it][2025-11-19 09:09:04,717] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.31631056985382
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   gamma: 0.1133802479419833
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   alpha: 0.570286037090536
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   lambda: 1.166751314633808
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   learning_rate: 0.03652080649077517
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   subsample: 0.8314757231869528
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   colsample_bytree: 0.5861754911786671
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5252832250117566
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   colsample_bynode: 0.7750786393011392
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:09:04,717] [INFO] [<frozen importlib] -   scale_pos_weight: 6.31631056985382
[2025-11-19 09:09:04,798] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:09:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:09:04,706] Trial 286 pruned. 
[0]	train-logloss:0.66202	train-auc:0.62992	train-aucpr:0.22364	val-logloss:0.65597	val-auc:0.60791	val-aucpr:0.11561
[10]	train-logloss:0.63895	train-auc:0.68146	train-aucpr:0.28627	val-logloss:0.60372	val-auc:0.71138	val-aucpr:0.20862
[20]	train-logloss:0.62513	train-auc:0.68724	train-aucpr:0.29764	val-logloss:0.57024	val-auc:0.70282	val-aucpr:0.22188
[30]	train-logloss:0.61549	train-auc:0.69199	train-aucpr:0.30299	val-logloss:0.54423	val-auc:0.71084	val-aucpr:0.22735
[40]	train-logloss:0.60869	train-auc:0.69609	train-aucpr:0.30676	val-logloss:0.52311	val-auc:0.71076	val-aucpr:0.23041
[50]	train-logloss:0.60298	train-auc:0.70018	train-aucpr:0.31193	val-logloss:0.51685	val-auc:0.71261	val-aucpr:0.23109
[60]	train-logloss:0.59902	train-auc:0.70395	train-aucpr:0.31544	val-logloss:0.51414	val-auc:0.70974	val-aucpr:0.22710
[70]	train-logloss:0.59546	train-auc:0.70739	train-aucpr:0.31981	val-logloss:0.51582	val-auc:0.70830	val-aucpr:0.22308
[80]	train-logloss:0.59252	train-auc:0.71074	train-aucpr:0.32302	val-logloss:0.50489	val-auc:0.70853	val-aucpr:0.22621
[2025-11-19 09:09:05,047] [INFO] [<frozen importlib] - Training completed at iteration 50
[2025-11-19 09:09:05,047] [INFO] [<frozen importlib] - Best train loss: 0.6030
[2025-11-19 09:09:05,047] [INFO] [<frozen importlib] - Best val loss: 0.5168
[2025-11-19 09:09:05,047] [INFO] [<frozen importlib] - Best val AUC: 0.7126
[2025-11-19 09:09:05,047] [INFO] [<frozen importlib] - Best val AUCPR: 0.2311
[2025-11-19 09:09:05,052] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:09:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:09:15,859] [INFO] [<frozen importlib] - Optimal threshold: 0.4782
[2025-11-19 09:09:15,860] [INFO] [<frozen importlib] - Best f1: 0.2750
[2025-11-19 09:09:15,860] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:09:15,903] [INFO] [<frozen importlib] - Validation Results (threshold=0.4782):
[2025-11-19 09:09:15,904] [INFO] [<frozen importlib] -   Accuracy: 0.8909
[2025-11-19 09:09:15,904] [INFO] [<frozen importlib] -   Precision: 0.2809
[2025-11-19 09:09:15,904] [INFO] [<frozen importlib] -   Recall: 0.2693
[2025-11-19 09:09:15,904] [INFO] [<frozen importlib] -   F1 Score: 0.2750
[2025-11-19 09:09:15,904] [INFO] [<frozen importlib] -   AUROC: 0.7126
[2025-11-19 09:09:15,904] [INFO] [<frozen importlib] -   AUPRC: 0.2315
[2025-11-19 09:09:15,904] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:09:15,904] [INFO] [<frozen importlib] -     TN=16444, FP=1001
[2025-11-19 09:09:15,904] [INFO] [<frozen importlib] -     FN=1061, TP=391
[2025-11-19 09:09:15,927] [INFO] [<frozen importlib] - Trial 287: AUPRC=0.2315, F1=0.4465, Prec=0.4132, Rec=0.4855 | Optimizing auprc=0.2315
                                                                                        Best trial: 258. Best value: 0.240317:  57%|█████▋    | 287/500 [47:13<31:04,  8.75s/it]Best trial: 258. Best value: 0.240317:  57%|█████▋    | 287/500 [47:13<31:04,  8.75s/it]Best trial: 258. Best value: 0.240317:  58%|█████▊    | 288/500 [47:13<33:32,  9.49s/it][2025-11-19 09:09:15,939] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.011741006783289
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   gamma: 0.14473344561936907
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   alpha: 0.547347164136269
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   lambda: 1.4717084894208239
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   learning_rate: 0.034826887015387706
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   subsample: 0.8451381272517999
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   colsample_bytree: 0.5721506895114987
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5144000318630497
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   colsample_bynode: 0.7954590693198877
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:09:15,939] [INFO] [<frozen importlib] -   scale_pos_weight: 5.011741006783289
[2025-11-19 09:09:16,012] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:09:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:09:15,928] Trial 287 finished with value: 0.2314661248859856 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.1133802479419833, 'learning_rate': 0.03652080649077517, 'n_estimators': 150, 'alpha': 0.570286037090536, 'lambda': 1.166751314633808, 'subsample': 0.8314757231869528, 'colsample_bytree': 0.5861754911786671, 'colsample_bylevel': 0.5252832250117566, 'colsample_bynode': 0.7750786393011392, 'scale_pos_weight': 6.31631056985382}. Best is trial 258 with value: 0.24031689511995413.
[0]	train-logloss:0.58805	train-auc:0.64356	train-aucpr:0.23664	val-logloss:0.57061	val-auc:0.61683	val-aucpr:0.12764
[10]	train-logloss:0.56924	train-auc:0.68280	train-aucpr:0.29088	val-logloss:0.52345	val-auc:0.67631	val-aucpr:0.19200
[20]	train-logloss:0.55713	train-auc:0.68781	train-aucpr:0.29717	val-logloss:0.49815	val-auc:0.68930	val-aucpr:0.20052
[30]	train-logloss:0.54878	train-auc:0.69067	train-aucpr:0.30274	val-logloss:0.47548	val-auc:0.69798	val-aucpr:0.21686
[40]	train-logloss:0.54262	train-auc:0.69472	train-aucpr:0.30639	val-logloss:0.46988	val-auc:0.70245	val-aucpr:0.21666
[50]	train-logloss:0.53762	train-auc:0.69899	train-aucpr:0.31125	val-logloss:0.45427	val-auc:0.70098	val-aucpr:0.21466
[60]	train-logloss:0.53404	train-auc:0.70236	train-aucpr:0.31530	val-logloss:0.44918	val-auc:0.69886	val-aucpr:0.21970
[70]	train-logloss:0.53085	train-auc:0.70617	train-aucpr:0.31926	val-logloss:0.43440	val-auc:0.69883	val-aucpr:0.21730
[80]	train-logloss:0.52818	train-auc:0.71040	train-aucpr:0.32376	val-logloss:0.43368	val-auc:0.69473	val-aucpr:0.21057
[89]	train-logloss:0.52603	train-auc:0.71504	train-aucpr:0.32689	val-logloss:0.43073	val-auc:0.69567	val-aucpr:0.20910
[2025-11-19 09:09:16,273] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:09:16,273] [INFO] [<frozen importlib] - Best train loss: 0.5340
[2025-11-19 09:09:16,273] [INFO] [<frozen importlib] - Best val loss: 0.4492
[2025-11-19 09:09:16,273] [INFO] [<frozen importlib] - Best val AUC: 0.6989
[2025-11-19 09:09:16,273] [INFO] [<frozen importlib] - Best val AUCPR: 0.2197
[2025-11-19 09:09:16,278] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:09:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:09:29,279] [INFO] [<frozen importlib] - Optimal threshold: 0.4260
[2025-11-19 09:09:29,279] [INFO] [<frozen importlib] - Best f1: 0.2711
[2025-11-19 09:09:29,279] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:09:29,324] [INFO] [<frozen importlib] - Validation Results (threshold=0.4260):
[2025-11-19 09:09:29,324] [INFO] [<frozen importlib] -   Accuracy: 0.8950
[2025-11-19 09:09:29,324] [INFO] [<frozen importlib] -   Precision: 0.2906
[2025-11-19 09:09:29,324] [INFO] [<frozen importlib] -   Recall: 0.2541
[2025-11-19 09:09:29,324] [INFO] [<frozen importlib] -   F1 Score: 0.2711
[2025-11-19 09:09:29,324] [INFO] [<frozen importlib] -   AUROC: 0.6989
[2025-11-19 09:09:29,324] [INFO] [<frozen importlib] -   AUPRC: 0.2201
[2025-11-19 09:09:29,324] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:09:29,324] [INFO] [<frozen importlib] -     TN=16544, FP=901
[2025-11-19 09:09:29,324] [INFO] [<frozen importlib] -     FN=1083, TP=369
[2025-11-19 09:09:29,347] [INFO] [<frozen importlib] - Trial 288: AUPRC=0.2201, F1=0.4397, Prec=0.4239, Rec=0.4566 | Optimizing auprc=0.2201
[2025-11-19 09:09:29,348] [INFO] [<frozen importlib] - Trial 288 pruned.
[2025-11-19 09:09:29,348] [ERROR] [<frozen importlib] - Trial 288 failed with error: 
                                                                                        Best trial: 258. Best value: 0.240317:  58%|█████▊    | 288/500 [47:27<33:32,  9.49s/it]Best trial: 258. Best value: 0.240317:  58%|█████▊    | 288/500 [47:27<33:32,  9.49s/it]Best trial: 258. Best value: 0.240317:  58%|█████▊    | 289/500 [47:27<37:31, 10.67s/it][2025-11-19 09:09:29,358] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.753742978625884
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] -   gamma: 0.1839985518857824
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] -   alpha: 0.4683400510947461
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] -   lambda: 0.8329058129495245
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] -   learning_rate: 0.03341111958449861
[2025-11-19 09:09:29,358] [INFO] [<frozen importlib] -   subsample: 0.8193008011639229
[2025-11-19 09:09:29,359] [INFO] [<frozen importlib] -   colsample_bytree: 0.5957335774509215
[2025-11-19 09:09:29,359] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5001868011920084
[2025-11-19 09:09:29,359] [INFO] [<frozen importlib] -   colsample_bynode: 0.7545748702416571
[2025-11-19 09:09:29,359] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:09:29,359] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:09:29,359] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:09:29,359] [INFO] [<frozen importlib] -   scale_pos_weight: 5.753742978625884
[2025-11-19 09:09:29,429] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:09:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:09:29,348] Trial 288 pruned. 
[0]	train-logloss:0.63070	train-auc:0.63768	train-aucpr:0.22400	val-logloss:0.61887	val-auc:0.53634	val-aucpr:0.10267
[10]	train-logloss:0.61067	train-auc:0.68030	train-aucpr:0.29076	val-logloss:0.57962	val-auc:0.67631	val-aucpr:0.19012
[20]	train-logloss:0.59794	train-auc:0.68597	train-aucpr:0.29848	val-logloss:0.54868	val-auc:0.69074	val-aucpr:0.21855
[30]	train-logloss:0.58889	train-auc:0.68981	train-aucpr:0.30443	val-logloss:0.52281	val-auc:0.70078	val-aucpr:0.23175
[40]	train-logloss:0.58226	train-auc:0.69456	train-aucpr:0.30771	val-logloss:0.49512	val-auc:0.71676	val-aucpr:0.23626
[50]	train-logloss:0.57678	train-auc:0.69782	train-aucpr:0.31145	val-logloss:0.48391	val-auc:0.71288	val-aucpr:0.23672
[60]	train-logloss:0.57279	train-auc:0.70173	train-aucpr:0.31527	val-logloss:0.47616	val-auc:0.71024	val-aucpr:0.24009
[70]	train-logloss:0.56953	train-auc:0.70478	train-aucpr:0.31874	val-logloss:0.47565	val-auc:0.71755	val-aucpr:0.24072
[80]	train-logloss:0.56645	train-auc:0.70856	train-aucpr:0.32250	val-logloss:0.47029	val-auc:0.71658	val-aucpr:0.23596
[90]	train-logloss:0.56393	train-auc:0.71212	train-aucpr:0.32574	val-logloss:0.46279	val-auc:0.71425	val-aucpr:0.23536
[100]	train-logloss:0.56169	train-auc:0.71576	train-aucpr:0.32922	val-logloss:0.44868	val-auc:0.70920	val-aucpr:0.23136
[101]	train-logloss:0.56132	train-auc:0.71634	train-aucpr:0.32991	val-logloss:0.44842	val-auc:0.70929	val-aucpr:0.23170
[2025-11-19 09:09:29,716] [INFO] [<frozen importlib] - Training completed at iteration 71
[2025-11-19 09:09:29,716] [INFO] [<frozen importlib] - Best train loss: 0.5693
[2025-11-19 09:09:29,716] [INFO] [<frozen importlib] - Best val loss: 0.4742
[2025-11-19 09:09:29,716] [INFO] [<frozen importlib] - Best val AUC: 0.7180
[2025-11-19 09:09:29,716] [INFO] [<frozen importlib] - Best val AUCPR: 0.2414
[2025-11-19 09:09:29,721] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:09:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:09:42,856] [INFO] [<frozen importlib] - Optimal threshold: 0.4571
[2025-11-19 09:09:42,856] [INFO] [<frozen importlib] - Best f1: 0.2875
[2025-11-19 09:09:42,856] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:09:42,897] [INFO] [<frozen importlib] - Validation Results (threshold=0.4571):
[2025-11-19 09:09:42,897] [INFO] [<frozen importlib] -   Accuracy: 0.9014
[2025-11-19 09:09:42,897] [INFO] [<frozen importlib] -   Precision: 0.3230
[2025-11-19 09:09:42,897] [INFO] [<frozen importlib] -   Recall: 0.2590
[2025-11-19 09:09:42,897] [INFO] [<frozen importlib] -   F1 Score: 0.2875
[2025-11-19 09:09:42,897] [INFO] [<frozen importlib] -   AUROC: 0.7180
[2025-11-19 09:09:42,897] [INFO] [<frozen importlib] -   AUPRC: 0.2418
[2025-11-19 09:09:42,897] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:09:42,897] [INFO] [<frozen importlib] -     TN=16657, FP=788
[2025-11-19 09:09:42,897] [INFO] [<frozen importlib] -     FN=1076, TP=376
[2025-11-19 09:09:42,920] [INFO] [<frozen importlib] - Trial 289: AUPRC=0.2418, F1=0.4647, Prec=0.4625, Rec=0.4669 | Optimizing auprc=0.2418
[2025-11-19 09:09:42,921] [INFO] [<frozen importlib] -   → New best model found! (value=0.2418)
                                                                                        Best trial: 258. Best value: 0.240317:  58%|█████▊    | 289/500 [47:40<37:31, 10.67s/it]Best trial: 289. Best value: 0.241792:  58%|█████▊    | 289/500 [47:40<37:31, 10.67s/it]Best trial: 289. Best value: 0.241792:  58%|█████▊    | 290/500 [47:40<40:23, 11.54s/it][2025-11-19 09:09:42,935] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.661514888175265
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   gamma: 0.17814291812993782
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   alpha: 0.4365076137750354
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   lambda: 0.8213796739464811
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   learning_rate: 0.03313523850892335
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   subsample: 0.8175970813731904
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   colsample_bytree: 0.5968471698253409
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5014578549684617
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   colsample_bynode: 0.7494466636783448
[2025-11-19 09:09:42,935] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:09:42,936] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:09:42,936] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:09:42,936] [INFO] [<frozen importlib] -   scale_pos_weight: 5.661514888175265
[2025-11-19 09:09:43,012] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:09:43] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:09:42,921] Trial 289 finished with value: 0.24179190906297438 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.1839985518857824, 'learning_rate': 0.03341111958449861, 'n_estimators': 450, 'alpha': 0.4683400510947461, 'lambda': 0.8329058129495245, 'subsample': 0.8193008011639229, 'colsample_bytree': 0.5957335774509215, 'colsample_bylevel': 0.5001868011920084, 'colsample_bynode': 0.7545748702416571, 'scale_pos_weight': 5.753742978625884}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.62548	train-auc:0.63768	train-aucpr:0.22400	val-logloss:0.61292	val-auc:0.53634	val-aucpr:0.10267
[10]	train-logloss:0.60582	train-auc:0.68014	train-aucpr:0.29052	val-logloss:0.57445	val-auc:0.67638	val-aucpr:0.18880
[20]	train-logloss:0.59323	train-auc:0.68598	train-aucpr:0.29829	val-logloss:0.54464	val-auc:0.68909	val-aucpr:0.21561
[30]	train-logloss:0.58425	train-auc:0.68973	train-aucpr:0.30452	val-logloss:0.51923	val-auc:0.69516	val-aucpr:0.22679
[40]	train-logloss:0.57781	train-auc:0.69428	train-aucpr:0.30763	val-logloss:0.49400	val-auc:0.71020	val-aucpr:0.23066
[50]	train-logloss:0.57235	train-auc:0.69742	train-aucpr:0.31151	val-logloss:0.47969	val-auc:0.70961	val-aucpr:0.23218
[60]	train-logloss:0.56834	train-auc:0.70249	train-aucpr:0.31580	val-logloss:0.47324	val-auc:0.70117	val-aucpr:0.23188
[70]	train-logloss:0.56515	train-auc:0.70559	train-aucpr:0.31907	val-logloss:0.46802	val-auc:0.71322	val-aucpr:0.23688
[80]	train-logloss:0.56208	train-auc:0.70902	train-aucpr:0.32261	val-logloss:0.46657	val-auc:0.71292	val-aucpr:0.23173
[90]	train-logloss:0.55960	train-auc:0.71251	train-aucpr:0.32578	val-logloss:0.46119	val-auc:0.71006	val-aucpr:0.22961
[100]	train-logloss:0.55732	train-auc:0.71640	train-aucpr:0.32946	val-logloss:0.44991	val-auc:0.70883	val-aucpr:0.22714
[2025-11-19 09:09:43,302] [INFO] [<frozen importlib] - Training completed at iteration 71
[2025-11-19 09:09:43,302] [INFO] [<frozen importlib] - Best train loss: 0.5649
[2025-11-19 09:09:43,302] [INFO] [<frozen importlib] - Best val loss: 0.4674
[2025-11-19 09:09:43,302] [INFO] [<frozen importlib] - Best val AUC: 0.7132
[2025-11-19 09:09:43,302] [INFO] [<frozen importlib] - Best val AUCPR: 0.2370
[2025-11-19 09:09:43,308] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:09:43] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:09:56,799] [INFO] [<frozen importlib] - Optimal threshold: 0.4553
[2025-11-19 09:09:56,799] [INFO] [<frozen importlib] - Best f1: 0.2890
[2025-11-19 09:09:56,799] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:09:56,842] [INFO] [<frozen importlib] - Validation Results (threshold=0.4553):
[2025-11-19 09:09:56,842] [INFO] [<frozen importlib] -   Accuracy: 0.9089
[2025-11-19 09:09:56,842] [INFO] [<frozen importlib] -   Precision: 0.3608
[2025-11-19 09:09:56,842] [INFO] [<frozen importlib] -   Recall: 0.2410
[2025-11-19 09:09:56,842] [INFO] [<frozen importlib] -   F1 Score: 0.2890
[2025-11-19 09:09:56,842] [INFO] [<frozen importlib] -   AUROC: 0.7132
[2025-11-19 09:09:56,842] [INFO] [<frozen importlib] -   AUPRC: 0.2375
[2025-11-19 09:09:56,842] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:09:56,842] [INFO] [<frozen importlib] -     TN=16825, FP=620
[2025-11-19 09:09:56,842] [INFO] [<frozen importlib] -     FN=1102, TP=350
[2025-11-19 09:09:56,864] [INFO] [<frozen importlib] - Trial 290: AUPRC=0.2375, F1=0.4635, Prec=0.5020, Rec=0.4304 | Optimizing auprc=0.2375
[2025-11-19 09:09:56,865] [INFO] [<frozen importlib] - Trial 290 pruned.
[2025-11-19 09:09:56,865] [ERROR] [<frozen importlib] - Trial 290 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  58%|█████▊    | 290/500 [47:54<40:23, 11.54s/it]Best trial: 289. Best value: 0.241792:  58%|█████▊    | 290/500 [47:54<40:23, 11.54s/it]Best trial: 289. Best value: 0.241792:  58%|█████▊    | 291/500 [47:54<42:42, 12.26s/it][2025-11-19 09:09:56,878] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.758318599369677
[2025-11-19 09:09:56,878] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:09:56,878] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:09:56,878] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:09:56,878] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:09:56,878] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   gamma: 0.6568024679209552
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   alpha: 0.49010425602251084
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   lambda: 0.9712751763846265
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   learning_rate: 0.03130167507075563
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   subsample: 0.8084086967023748
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   colsample_bytree: 0.6137360277902694
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   colsample_bylevel: 0.501042187406201
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   colsample_bynode: 0.7590234181222922
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:09:56,879] [INFO] [<frozen importlib] -   scale_pos_weight: 5.758318599369677
[2025-11-19 09:09:56,952] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:09:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:09:56,865] Trial 290 pruned. 
[0]	train-logloss:0.63103	train-auc:0.63879	train-aucpr:0.23203	val-logloss:0.61862	val-auc:0.62532	val-aucpr:0.13230
[10]	train-logloss:0.61214	train-auc:0.68285	train-aucpr:0.29177	val-logloss:0.57118	val-auc:0.70631	val-aucpr:0.21324
[20]	train-logloss:0.59948	train-auc:0.68719	train-aucpr:0.29722	val-logloss:0.53613	val-auc:0.70379	val-aucpr:0.20307
[30]	train-logloss:0.59060	train-auc:0.69002	train-aucpr:0.30225	val-logloss:0.51479	val-auc:0.70721	val-aucpr:0.21930
[40]	train-logloss:0.58426	train-auc:0.69329	train-aucpr:0.30608	val-logloss:0.49209	val-auc:0.70806	val-aucpr:0.21700
[50]	train-logloss:0.57868	train-auc:0.69738	train-aucpr:0.31013	val-logloss:0.49010	val-auc:0.70936	val-aucpr:0.22212
[60]	train-logloss:0.57454	train-auc:0.70149	train-aucpr:0.31387	val-logloss:0.48587	val-auc:0.70863	val-aucpr:0.22473
[70]	train-logloss:0.57110	train-auc:0.70556	train-aucpr:0.31755	val-logloss:0.47250	val-auc:0.70692	val-aucpr:0.22329
[80]	train-logloss:0.56780	train-auc:0.70920	train-aucpr:0.32158	val-logloss:0.45994	val-auc:0.70614	val-aucpr:0.22241
[85]	train-logloss:0.56653	train-auc:0.71009	train-aucpr:0.32274	val-logloss:0.45951	val-auc:0.70800	val-aucpr:0.22020
[2025-11-19 09:09:57,204] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:09:57,204] [INFO] [<frozen importlib] - Best train loss: 0.5763
[2025-11-19 09:09:57,204] [INFO] [<frozen importlib] - Best val loss: 0.4840
[2025-11-19 09:09:57,204] [INFO] [<frozen importlib] - Best val AUC: 0.7106
[2025-11-19 09:09:57,204] [INFO] [<frozen importlib] - Best val AUCPR: 0.2259
[2025-11-19 09:09:57,210] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:09:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:10:07,608] [INFO] [<frozen importlib] - Optimal threshold: 0.4508
[2025-11-19 09:10:07,609] [INFO] [<frozen importlib] - Best f1: 0.2765
[2025-11-19 09:10:07,609] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:10:07,652] [INFO] [<frozen importlib] - Validation Results (threshold=0.4508):
[2025-11-19 09:10:07,652] [INFO] [<frozen importlib] -   Accuracy: 0.8895
[2025-11-19 09:10:07,652] [INFO] [<frozen importlib] -   Precision: 0.2782
[2025-11-19 09:10:07,652] [INFO] [<frozen importlib] -   Recall: 0.2748
[2025-11-19 09:10:07,652] [INFO] [<frozen importlib] -   F1 Score: 0.2765
[2025-11-19 09:10:07,652] [INFO] [<frozen importlib] -   AUROC: 0.7106
[2025-11-19 09:10:07,652] [INFO] [<frozen importlib] -   AUPRC: 0.2263
[2025-11-19 09:10:07,652] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:10:07,652] [INFO] [<frozen importlib] -     TN=16410, FP=1035
[2025-11-19 09:10:07,652] [INFO] [<frozen importlib] -     FN=1053, TP=399
[2025-11-19 09:10:07,677] [INFO] [<frozen importlib] - Trial 291: AUPRC=0.2263, F1=0.4412, Prec=0.4048, Rec=0.4848 | Optimizing auprc=0.2263
[2025-11-19 09:10:07,677] [INFO] [<frozen importlib] - Trial 291 pruned.
[2025-11-19 09:10:07,677] [ERROR] [<frozen importlib] - Trial 291 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  58%|█████▊    | 291/500 [48:05<42:42, 12.26s/it]Best trial: 289. Best value: 0.241792:  58%|█████▊    | 291/500 [48:05<42:42, 12.26s/it]Best trial: 289. Best value: 0.241792:  58%|█████▊    | 292/500 [48:05<41:00, 11.83s/it][2025-11-19 09:10:07,693] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.844076683278954
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   gamma: 0.18604288927321572
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   alpha: 0.4594457788648551
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   lambda: 0.855621372290523
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   learning_rate: 0.03433285656889168
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   subsample: 0.8212922681542731
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   colsample_bytree: 0.6054192493410074
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5112769400526509
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   colsample_bynode: 0.7518259545367469
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:10:07,693] [INFO] [<frozen importlib] -   scale_pos_weight: 5.844076683278954
[2025-11-19 09:10:07,769] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:10:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:10:07,677] Trial 291 pruned. 
[0]	train-logloss:0.63536	train-auc:0.64315	train-aucpr:0.25519	val-logloss:0.62559	val-auc:0.58551	val-aucpr:0.11212
[10]	train-logloss:0.61509	train-auc:0.68145	train-aucpr:0.29034	val-logloss:0.57659	val-auc:0.66979	val-aucpr:0.17923
[20]	train-logloss:0.60203	train-auc:0.68623	train-aucpr:0.29764	val-logloss:0.54167	val-auc:0.67025	val-aucpr:0.19832
[30]	train-logloss:0.59285	train-auc:0.69068	train-aucpr:0.30372	val-logloss:0.51441	val-auc:0.68422	val-aucpr:0.21300
[40]	train-logloss:0.58612	train-auc:0.69470	train-aucpr:0.30892	val-logloss:0.49221	val-auc:0.70110	val-aucpr:0.21752
[50]	train-logloss:0.58036	train-auc:0.69831	train-aucpr:0.31277	val-logloss:0.47406	val-auc:0.70053	val-aucpr:0.21556
[60]	train-logloss:0.57649	train-auc:0.70264	train-aucpr:0.31617	val-logloss:0.46871	val-auc:0.70091	val-aucpr:0.21529
[63]	train-logloss:0.57539	train-auc:0.70424	train-aucpr:0.31764	val-logloss:0.47235	val-auc:0.69532	val-aucpr:0.21125
[2025-11-19 09:10:07,966] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 09:10:07,966] [INFO] [<frozen importlib] - Best train loss: 0.5899
[2025-11-19 09:10:07,966] [INFO] [<frozen importlib] - Best val loss: 0.5033
[2025-11-19 09:10:07,966] [INFO] [<frozen importlib] - Best val AUC: 0.7024
[2025-11-19 09:10:07,966] [INFO] [<frozen importlib] - Best val AUCPR: 0.2183
[2025-11-19 09:10:07,971] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:10:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:10:14,855] [INFO] [<frozen importlib] - Optimal threshold: 0.4575
[2025-11-19 09:10:14,855] [INFO] [<frozen importlib] - Best f1: 0.2699
[2025-11-19 09:10:14,855] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:10:14,895] [INFO] [<frozen importlib] - Validation Results (threshold=0.4575):
[2025-11-19 09:10:14,895] [INFO] [<frozen importlib] -   Accuracy: 0.9001
[2025-11-19 09:10:14,895] [INFO] [<frozen importlib] -   Precision: 0.3078
[2025-11-19 09:10:14,895] [INFO] [<frozen importlib] -   Recall: 0.2404
[2025-11-19 09:10:14,895] [INFO] [<frozen importlib] -   F1 Score: 0.2699
[2025-11-19 09:10:14,895] [INFO] [<frozen importlib] -   AUROC: 0.7024
[2025-11-19 09:10:14,895] [INFO] [<frozen importlib] -   AUPRC: 0.2186
[2025-11-19 09:10:14,895] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:10:14,895] [INFO] [<frozen importlib] -     TN=16660, FP=785
[2025-11-19 09:10:14,895] [INFO] [<frozen importlib] -     FN=1103, TP=349
[2025-11-19 09:10:14,918] [INFO] [<frozen importlib] - Trial 292: AUPRC=0.2186, F1=0.4572, Prec=0.4579, Rec=0.4566 | Optimizing auprc=0.2186
[2025-11-19 09:10:14,918] [INFO] [<frozen importlib] - Trial 292 pruned.
[2025-11-19 09:10:14,919] [ERROR] [<frozen importlib] - Trial 292 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  58%|█████▊    | 292/500 [48:12<41:00, 11.83s/it]Best trial: 289. Best value: 0.241792:  58%|█████▊    | 292/500 [48:12<41:00, 11.83s/it]Best trial: 289. Best value: 0.241792:  59%|█████▊    | 293/500 [48:12<36:03, 10.45s/it][2025-11-19 09:10:14,930] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.01437385872278
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   gamma: 0.21906476937915006
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   alpha: 0.6126829143847871
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   lambda: 0.6834344112022459
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   learning_rate: 0.035555718840697303
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   subsample: 0.7988513622828218
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   colsample_bytree: 0.667299795128514
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5000055331532749
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   colsample_bynode: 0.7631315640188092
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:10:14,930] [INFO] [<frozen importlib] -   scale_pos_weight: 6.01437385872278
[2025-11-19 09:10:15,001] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:10:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:10:14,919] Trial 292 pruned. 
[0]	train-logloss:0.64512	train-auc:0.63232	train-aucpr:0.21585	val-logloss:0.63598	val-auc:0.58962	val-aucpr:0.10781
[10]	train-logloss:0.62341	train-auc:0.68085	train-aucpr:0.28979	val-logloss:0.58934	val-auc:0.67257	val-aucpr:0.18398
[20]	train-logloss:0.60985	train-auc:0.68784	train-aucpr:0.29914	val-logloss:0.56105	val-auc:0.67377	val-aucpr:0.18938
[30]	train-logloss:0.60012	train-auc:0.69386	train-aucpr:0.30519	val-logloss:0.53013	val-auc:0.69967	val-aucpr:0.21815
[40]	train-logloss:0.59337	train-auc:0.69786	train-aucpr:0.30878	val-logloss:0.51017	val-auc:0.69380	val-aucpr:0.22116
[50]	train-logloss:0.58739	train-auc:0.70297	train-aucpr:0.31377	val-logloss:0.49508	val-auc:0.69141	val-aucpr:0.22407
[60]	train-logloss:0.58327	train-auc:0.70554	train-aucpr:0.31735	val-logloss:0.49123	val-auc:0.69486	val-aucpr:0.22904
[70]	train-logloss:0.58007	train-auc:0.70792	train-aucpr:0.32019	val-logloss:0.48053	val-auc:0.69927	val-aucpr:0.22798
[80]	train-logloss:0.57721	train-auc:0.71151	train-aucpr:0.32383	val-logloss:0.47920	val-auc:0.69725	val-aucpr:0.21976
[90]	train-logloss:0.57434	train-auc:0.71675	train-aucpr:0.32847	val-logloss:0.47757	val-auc:0.69459	val-aucpr:0.21570
[92]	train-logloss:0.57390	train-auc:0.71758	train-aucpr:0.32916	val-logloss:0.47538	val-auc:0.69318	val-aucpr:0.21275
[2025-11-19 09:10:15,269] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:10:15,269] [INFO] [<frozen importlib] - Best train loss: 0.5826
[2025-11-19 09:10:15,269] [INFO] [<frozen importlib] - Best val loss: 0.4868
[2025-11-19 09:10:15,269] [INFO] [<frozen importlib] - Best val AUC: 0.6967
[2025-11-19 09:10:15,269] [INFO] [<frozen importlib] - Best val AUCPR: 0.2297
[2025-11-19 09:10:15,273] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:10:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:10:28,815] [INFO] [<frozen importlib] - Optimal threshold: 0.4720
[2025-11-19 09:10:28,815] [INFO] [<frozen importlib] - Best f1: 0.2748
[2025-11-19 09:10:28,815] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:10:28,858] [INFO] [<frozen importlib] - Validation Results (threshold=0.4720):
[2025-11-19 09:10:28,858] [INFO] [<frozen importlib] -   Accuracy: 0.9092
[2025-11-19 09:10:28,858] [INFO] [<frozen importlib] -   Precision: 0.3560
[2025-11-19 09:10:28,858] [INFO] [<frozen importlib] -   Recall: 0.2238
[2025-11-19 09:10:28,858] [INFO] [<frozen importlib] -   F1 Score: 0.2748
[2025-11-19 09:10:28,858] [INFO] [<frozen importlib] -   AUROC: 0.6967
[2025-11-19 09:10:28,858] [INFO] [<frozen importlib] -   AUPRC: 0.2301
[2025-11-19 09:10:28,859] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:10:28,859] [INFO] [<frozen importlib] -     TN=16857, FP=588
[2025-11-19 09:10:28,859] [INFO] [<frozen importlib] -     FN=1127, TP=325
[2025-11-19 09:10:28,884] [INFO] [<frozen importlib] - Trial 293: AUPRC=0.2301, F1=0.4656, Prec=0.5128, Rec=0.4263 | Optimizing auprc=0.2301
                                                                                        Best trial: 289. Best value: 0.241792:  59%|█████▊    | 293/500 [48:26<36:03, 10.45s/it]Best trial: 289. Best value: 0.241792:  59%|█████▊    | 293/500 [48:26<36:03, 10.45s/it]Best trial: 289. Best value: 0.241792:  59%|█████▉    | 294/500 [48:26<39:30, 11.51s/it][2025-11-19 09:10:28,897] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.440905054853772
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   gamma: 0.13524553706030945
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   alpha: 0.5280960654290436
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   lambda: 0.4910693094189894
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   learning_rate: 0.036235337043300626
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   subsample: 0.792562482087224
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   colsample_bytree: 0.6305941618549405
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5195100785852501
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   colsample_bynode: 0.7831627585541174
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:10:28,897] [INFO] [<frozen importlib] -   scale_pos_weight: 5.440905054853772
[2025-11-19 09:10:28,973] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:10:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:10:28,885] Trial 293 finished with value: 0.23012646806589254 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.21906476937915006, 'learning_rate': 0.035555718840697303, 'n_estimators': 450, 'alpha': 0.6126829143847871, 'lambda': 0.6834344112022459, 'subsample': 0.7988513622828218, 'colsample_bytree': 0.667299795128514, 'colsample_bylevel': 0.5000055331532749, 'colsample_bynode': 0.7631315640188092, 'scale_pos_weight': 6.01437385872278}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.61227	train-auc:0.64392	train-aucpr:0.22882	val-logloss:0.59678	val-auc:0.60193	val-aucpr:0.10963
[10]	train-logloss:0.59198	train-auc:0.67923	train-aucpr:0.29387	val-logloss:0.54644	val-auc:0.68148	val-aucpr:0.20393
[20]	train-logloss:0.57920	train-auc:0.68645	train-aucpr:0.29923	val-logloss:0.51363	val-auc:0.67880	val-aucpr:0.20542
[30]	train-logloss:0.57044	train-auc:0.69196	train-aucpr:0.30465	val-logloss:0.49174	val-auc:0.68066	val-aucpr:0.20926
[40]	train-logloss:0.56412	train-auc:0.69736	train-aucpr:0.30876	val-logloss:0.46952	val-auc:0.69206	val-aucpr:0.21405
[50]	train-logloss:0.55863	train-auc:0.70196	train-aucpr:0.31343	val-logloss:0.46159	val-auc:0.69666	val-aucpr:0.21286
[60]	train-logloss:0.55491	train-auc:0.70500	train-aucpr:0.31709	val-logloss:0.45633	val-auc:0.69294	val-aucpr:0.21563
[70]	train-logloss:0.55180	train-auc:0.70814	train-aucpr:0.32075	val-logloss:0.44609	val-auc:0.68802	val-aucpr:0.21740
[80]	train-logloss:0.54882	train-auc:0.71256	train-aucpr:0.32525	val-logloss:0.44240	val-auc:0.68811	val-aucpr:0.21428
[90]	train-logloss:0.54653	train-auc:0.71524	train-aucpr:0.32885	val-logloss:0.44452	val-auc:0.68834	val-aucpr:0.21077
[95]	train-logloss:0.54576	train-auc:0.71653	train-aucpr:0.33039	val-logloss:0.44291	val-auc:0.69077	val-aucpr:0.21425
[2025-11-19 09:10:29,248] [INFO] [<frozen importlib] - Training completed at iteration 65
[2025-11-19 09:10:29,248] [INFO] [<frozen importlib] - Best train loss: 0.5532
[2025-11-19 09:10:29,248] [INFO] [<frozen importlib] - Best val loss: 0.4522
[2025-11-19 09:10:29,248] [INFO] [<frozen importlib] - Best val AUC: 0.6942
[2025-11-19 09:10:29,248] [INFO] [<frozen importlib] - Best val AUCPR: 0.2188
[2025-11-19 09:10:29,253] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:10:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:10:41,856] [INFO] [<frozen importlib] - Optimal threshold: 0.4294
[2025-11-19 09:10:41,857] [INFO] [<frozen importlib] - Best f1: 0.2595
[2025-11-19 09:10:41,857] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:10:41,900] [INFO] [<frozen importlib] - Validation Results (threshold=0.4294):
[2025-11-19 09:10:41,900] [INFO] [<frozen importlib] -   Accuracy: 0.8898
[2025-11-19 09:10:41,900] [INFO] [<frozen importlib] -   Precision: 0.2682
[2025-11-19 09:10:41,900] [INFO] [<frozen importlib] -   Recall: 0.2514
[2025-11-19 09:10:41,900] [INFO] [<frozen importlib] -   F1 Score: 0.2595
[2025-11-19 09:10:41,900] [INFO] [<frozen importlib] -   AUROC: 0.6942
[2025-11-19 09:10:41,900] [INFO] [<frozen importlib] -   AUPRC: 0.2193
[2025-11-19 09:10:41,900] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:10:41,900] [INFO] [<frozen importlib] -     TN=16449, FP=996
[2025-11-19 09:10:41,900] [INFO] [<frozen importlib] -     FN=1087, TP=365
[2025-11-19 09:10:41,923] [INFO] [<frozen importlib] - Trial 294: AUPRC=0.2193, F1=0.4506, Prec=0.4169, Rec=0.4904 | Optimizing auprc=0.2193
[2025-11-19 09:10:41,924] [INFO] [<frozen importlib] - Trial 294 pruned.
[2025-11-19 09:10:41,924] [ERROR] [<frozen importlib] - Trial 294 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  59%|█████▉    | 294/500 [48:39<39:30, 11.51s/it]Best trial: 289. Best value: 0.241792:  59%|█████▉    | 294/500 [48:39<39:30, 11.51s/it]Best trial: 289. Best value: 0.241792:  59%|█████▉    | 295/500 [48:39<40:53, 11.97s/it][2025-11-19 09:10:41,935] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.29233920137776
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   gamma: 0.16887013522114783
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   alpha: 0.7017794737934824
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   lambda: 3.7692120576816213
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   learning_rate: 0.03321794694773555
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   subsample: 0.8305726870590898
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   colsample_bytree: 0.5917049628970468
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5109540606699856
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   colsample_bynode: 0.7711942190252333
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:10:41,935] [INFO] [<frozen importlib] -   scale_pos_weight: 6.29233920137776
[2025-11-19 09:10:42,011] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:10:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:10:41,924] Trial 294 pruned. 
[0]	train-logloss:0.66088	train-auc:0.63530	train-aucpr:0.22028	val-logloss:0.65426	val-auc:0.61483	val-aucpr:0.12098
[10]	train-logloss:0.64003	train-auc:0.68217	train-aucpr:0.28969	val-logloss:0.60844	val-auc:0.69244	val-aucpr:0.20175
[20]	train-logloss:0.62671	train-auc:0.68539	train-aucpr:0.29594	val-logloss:0.57361	val-auc:0.67960	val-aucpr:0.20407
[30]	train-logloss:0.61696	train-auc:0.68979	train-aucpr:0.30059	val-logloss:0.54399	val-auc:0.68658	val-aucpr:0.21243
[40]	train-logloss:0.60986	train-auc:0.69431	train-aucpr:0.30480	val-logloss:0.52580	val-auc:0.70654	val-aucpr:0.22423
[50]	train-logloss:0.60402	train-auc:0.69776	train-aucpr:0.30906	val-logloss:0.51702	val-auc:0.70664	val-aucpr:0.22570
[60]	train-logloss:0.60010	train-auc:0.70121	train-aucpr:0.31275	val-logloss:0.50877	val-auc:0.70207	val-aucpr:0.22692
[70]	train-logloss:0.59621	train-auc:0.70596	train-aucpr:0.31754	val-logloss:0.50518	val-auc:0.70656	val-aucpr:0.22686
[80]	train-logloss:0.59296	train-auc:0.70987	train-aucpr:0.32198	val-logloss:0.49680	val-auc:0.70658	val-aucpr:0.22474
[90]	train-logloss:0.59051	train-auc:0.71298	train-aucpr:0.32463	val-logloss:0.49005	val-auc:0.70554	val-aucpr:0.22050
[92]	train-logloss:0.59014	train-auc:0.71342	train-aucpr:0.32528	val-logloss:0.48999	val-auc:0.70538	val-aucpr:0.22163
[2025-11-19 09:10:42,279] [INFO] [<frozen importlib] - Training completed at iteration 63
[2025-11-19 09:10:42,280] [INFO] [<frozen importlib] - Best train loss: 0.5989
[2025-11-19 09:10:42,280] [INFO] [<frozen importlib] - Best val loss: 0.5084
[2025-11-19 09:10:42,280] [INFO] [<frozen importlib] - Best val AUC: 0.7067
[2025-11-19 09:10:42,280] [INFO] [<frozen importlib] - Best val AUCPR: 0.2281
[2025-11-19 09:10:42,284] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:10:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:10:55,581] [INFO] [<frozen importlib] - Optimal threshold: 0.4736
[2025-11-19 09:10:55,581] [INFO] [<frozen importlib] - Best f1: 0.2867
[2025-11-19 09:10:55,582] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:10:55,623] [INFO] [<frozen importlib] - Validation Results (threshold=0.4736):
[2025-11-19 09:10:55,624] [INFO] [<frozen importlib] -   Accuracy: 0.9005
[2025-11-19 09:10:55,624] [INFO] [<frozen importlib] -   Precision: 0.3190
[2025-11-19 09:10:55,624] [INFO] [<frozen importlib] -   Recall: 0.2603
[2025-11-19 09:10:55,624] [INFO] [<frozen importlib] -   F1 Score: 0.2867
[2025-11-19 09:10:55,624] [INFO] [<frozen importlib] -   AUROC: 0.7067
[2025-11-19 09:10:55,624] [INFO] [<frozen importlib] -   AUPRC: 0.2285
[2025-11-19 09:10:55,624] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:10:55,624] [INFO] [<frozen importlib] -     TN=16638, FP=807
[2025-11-19 09:10:55,624] [INFO] [<frozen importlib] -     FN=1074, TP=378
[2025-11-19 09:10:55,650] [INFO] [<frozen importlib] - Trial 295: AUPRC=0.2285, F1=0.4474, Prec=0.4465, Rec=0.4483 | Optimizing auprc=0.2285
[2025-11-19 09:10:55,651] [INFO] [<frozen importlib] - Trial 295 pruned.
[2025-11-19 09:10:55,651] [ERROR] [<frozen importlib] - Trial 295 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  59%|█████▉    | 295/500 [48:53<40:53, 11.97s/it]Best trial: 289. Best value: 0.241792:  59%|█████▉    | 295/500 [48:53<40:53, 11.97s/it]Best trial: 289. Best value: 0.241792:  59%|█████▉    | 296/500 [48:53<42:28, 12.49s/it][2025-11-19 09:10:55,663] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.597183684477594
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   gamma: 0.22531539455963034
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   alpha: 0.6502508390787759
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   lambda: 2.768770829013399
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   learning_rate: 0.03769051715602092
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   subsample: 0.8068260165338093
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   colsample_bytree: 0.5594810199452022
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5252166760200792
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   colsample_bynode: 0.7525057330010549
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:10:55,664] [INFO] [<frozen importlib] -   scale_pos_weight: 6.597183684477594
[2025-11-19 09:10:55,742] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:10:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:10:55,651] Trial 295 pruned. 
[0]	train-logloss:0.67710	train-auc:0.63751	train-aucpr:0.22824	val-logloss:0.67147	val-auc:0.62848	val-aucpr:0.12104
[10]	train-logloss:0.65390	train-auc:0.68225	train-aucpr:0.29364	val-logloss:0.61178	val-auc:0.68014	val-aucpr:0.19011
[20]	train-logloss:0.63955	train-auc:0.68604	train-aucpr:0.29831	val-logloss:0.57437	val-auc:0.69266	val-aucpr:0.20745
[30]	train-logloss:0.62914	train-auc:0.69176	train-aucpr:0.30462	val-logloss:0.54854	val-auc:0.69975	val-aucpr:0.22009
[40]	train-logloss:0.62183	train-auc:0.69679	train-aucpr:0.30865	val-logloss:0.52582	val-auc:0.70513	val-aucpr:0.21955
[50]	train-logloss:0.61579	train-auc:0.70304	train-aucpr:0.31331	val-logloss:0.51643	val-auc:0.70139	val-aucpr:0.21631
[60]	train-logloss:0.61176	train-auc:0.70606	train-aucpr:0.31651	val-logloss:0.50634	val-auc:0.70083	val-aucpr:0.21633
[65]	train-logloss:0.60984	train-auc:0.70751	train-aucpr:0.31822	val-logloss:0.50166	val-auc:0.69791	val-aucpr:0.21403
[2025-11-19 09:10:55,938] [INFO] [<frozen importlib] - Training completed at iteration 35
[2025-11-19 09:10:55,938] [INFO] [<frozen importlib] - Best train loss: 0.6251
[2025-11-19 09:10:55,938] [INFO] [<frozen importlib] - Best val loss: 0.5341
[2025-11-19 09:10:55,938] [INFO] [<frozen importlib] - Best val AUC: 0.7004
[2025-11-19 09:10:55,938] [INFO] [<frozen importlib] - Best val AUCPR: 0.2234
[2025-11-19 09:10:55,943] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:10:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:11:03,291] [INFO] [<frozen importlib] - Optimal threshold: 0.4873
[2025-11-19 09:11:03,291] [INFO] [<frozen importlib] - Best f1: 0.2763
[2025-11-19 09:11:03,291] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:11:03,335] [INFO] [<frozen importlib] - Validation Results (threshold=0.4873):
[2025-11-19 09:11:03,335] [INFO] [<frozen importlib] -   Accuracy: 0.9008
[2025-11-19 09:11:03,335] [INFO] [<frozen importlib] -   Precision: 0.3143
[2025-11-19 09:11:03,335] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 09:11:03,335] [INFO] [<frozen importlib] -   F1 Score: 0.2763
[2025-11-19 09:11:03,335] [INFO] [<frozen importlib] -   AUROC: 0.7004
[2025-11-19 09:11:03,335] [INFO] [<frozen importlib] -   AUPRC: 0.2237
[2025-11-19 09:11:03,335] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:11:03,335] [INFO] [<frozen importlib] -     TN=16664, FP=781
[2025-11-19 09:11:03,335] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 09:11:03,361] [INFO] [<frozen importlib] - Trial 296: AUPRC=0.2237, F1=0.4642, Prec=0.4636, Rec=0.4649 | Optimizing auprc=0.2237
[2025-11-19 09:11:03,361] [INFO] [<frozen importlib] - Trial 296 pruned.
[2025-11-19 09:11:03,361] [ERROR] [<frozen importlib] - Trial 296 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  59%|█████▉    | 296/500 [49:01<42:28, 12.49s/it]Best trial: 289. Best value: 0.241792:  59%|█████▉    | 296/500 [49:01<42:28, 12.49s/it]Best trial: 289. Best value: 0.241792:  59%|█████▉    | 297/500 [49:01<37:25, 11.06s/it][2025-11-19 09:11:03,373] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.118460409930336
[2025-11-19 09:11:03,373] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:11:03,373] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:11:03,373] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:11:03,373] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:11:03,373] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:11:03,373] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   gamma: 0.20895078504887143
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   alpha: 0.4953818086628733
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   lambda: 1.0171019118415596
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   learning_rate: 0.030012229043401995
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   subsample: 0.818095731600573
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   colsample_bytree: 0.584762620239013
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7042560628352997
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   colsample_bynode: 0.7902616917169474
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:11:03,374] [INFO] [<frozen importlib] -   scale_pos_weight: 6.118460409930336
[2025-11-19 09:11:03,451] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:11:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:11:03,361] Trial 296 pruned. 
[0]	train-logloss:0.65099	train-auc:0.64829	train-aucpr:0.23779	val-logloss:0.64228	val-auc:0.65777	val-aucpr:0.12637
[10]	train-logloss:0.63151	train-auc:0.68127	train-aucpr:0.29141	val-logloss:0.59409	val-auc:0.67166	val-aucpr:0.19678
[20]	train-logloss:0.61852	train-auc:0.68576	train-aucpr:0.29829	val-logloss:0.56570	val-auc:0.69400	val-aucpr:0.21066
[30]	train-logloss:0.60918	train-auc:0.68992	train-aucpr:0.30272	val-logloss:0.53907	val-auc:0.69456	val-aucpr:0.21508
[40]	train-logloss:0.60241	train-auc:0.69397	train-aucpr:0.30640	val-logloss:0.51812	val-auc:0.70100	val-aucpr:0.21880
[50]	train-logloss:0.59660	train-auc:0.69786	train-aucpr:0.31096	val-logloss:0.51299	val-auc:0.70548	val-aucpr:0.22643
[60]	train-logloss:0.59247	train-auc:0.70100	train-aucpr:0.31453	val-logloss:0.49488	val-auc:0.70777	val-aucpr:0.23045
[70]	train-logloss:0.58871	train-auc:0.70559	train-aucpr:0.31857	val-logloss:0.49827	val-auc:0.70413	val-aucpr:0.22562
[80]	train-logloss:0.58563	train-auc:0.70839	train-aucpr:0.32166	val-logloss:0.49414	val-auc:0.70511	val-aucpr:0.22508
[90]	train-logloss:0.58298	train-auc:0.71140	train-aucpr:0.32489	val-logloss:0.49424	val-auc:0.69557	val-aucpr:0.22057
[2025-11-19 09:11:03,709] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:11:03,709] [INFO] [<frozen importlib] - Best train loss: 0.5925
[2025-11-19 09:11:03,709] [INFO] [<frozen importlib] - Best val loss: 0.4949
[2025-11-19 09:11:03,709] [INFO] [<frozen importlib] - Best val AUC: 0.7078
[2025-11-19 09:11:03,709] [INFO] [<frozen importlib] - Best val AUCPR: 0.2304
[2025-11-19 09:11:03,714] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:11:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:11:15,419] [INFO] [<frozen importlib] - Optimal threshold: 0.4592
[2025-11-19 09:11:15,419] [INFO] [<frozen importlib] - Best f1: 0.2759
[2025-11-19 09:11:15,419] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:11:15,467] [INFO] [<frozen importlib] - Validation Results (threshold=0.4592):
[2025-11-19 09:11:15,467] [INFO] [<frozen importlib] -   Accuracy: 0.8836
[2025-11-19 09:11:15,467] [INFO] [<frozen importlib] -   Precision: 0.2644
[2025-11-19 09:11:15,467] [INFO] [<frozen importlib] -   Recall: 0.2886
[2025-11-19 09:11:15,467] [INFO] [<frozen importlib] -   F1 Score: 0.2759
[2025-11-19 09:11:15,467] [INFO] [<frozen importlib] -   AUROC: 0.7078
[2025-11-19 09:11:15,467] [INFO] [<frozen importlib] -   AUPRC: 0.2308
[2025-11-19 09:11:15,467] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:11:15,467] [INFO] [<frozen importlib] -     TN=16279, FP=1166
[2025-11-19 09:11:15,467] [INFO] [<frozen importlib] -     FN=1033, TP=419
[2025-11-19 09:11:15,491] [INFO] [<frozen importlib] - Trial 297: AUPRC=0.2308, F1=0.4504, Prec=0.3949, Rec=0.5241 | Optimizing auprc=0.2308
                                                                                        Best trial: 289. Best value: 0.241792:  59%|█████▉    | 297/500 [49:13<37:25, 11.06s/it]Best trial: 289. Best value: 0.241792:  59%|█████▉    | 297/500 [49:13<37:25, 11.06s/it]Best trial: 289. Best value: 0.241792:  60%|█████▉    | 298/500 [49:13<38:18, 11.38s/it][2025-11-19 09:11:15,505] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.944793672357042
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   gamma: 0.1954680178265413
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   alpha: 0.579293488832573
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   lambda: 1.1299462091437558
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   learning_rate: 0.0320992344396918
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   subsample: 0.7904500060627065
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   colsample_bytree: 0.9472928055108655
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   colsample_bylevel: 0.509521592731357
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   colsample_bynode: 0.7620558854568106
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:11:15,505] [INFO] [<frozen importlib] -   scale_pos_weight: 6.944793672357042
[2025-11-19 09:11:15,579] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:11:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:11:15,492] Trial 297 finished with value: 0.23080037180213306 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.20895078504887143, 'learning_rate': 0.030012229043401995, 'n_estimators': 450, 'alpha': 0.4953818086628733, 'lambda': 1.0171019118415596, 'subsample': 0.818095731600573, 'colsample_bytree': 0.584762620239013, 'colsample_bylevel': 0.7042560628352997, 'colsample_bynode': 0.7902616917169474, 'scale_pos_weight': 6.118460409930336}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.69601	train-auc:0.65512	train-aucpr:0.24258	val-logloss:0.69181	val-auc:0.63384	val-aucpr:0.13004
[10]	train-logloss:0.67356	train-auc:0.67999	train-aucpr:0.27977	val-logloss:0.63730	val-auc:0.66897	val-aucpr:0.17417
[20]	train-logloss:0.65886	train-auc:0.68694	train-aucpr:0.29569	val-logloss:0.60661	val-auc:0.69343	val-aucpr:0.19643
[30]	train-logloss:0.64868	train-auc:0.69325	train-aucpr:0.30285	val-logloss:0.57386	val-auc:0.70422	val-aucpr:0.21046
[40]	train-logloss:0.64145	train-auc:0.69642	train-aucpr:0.30706	val-logloss:0.55124	val-auc:0.70041	val-aucpr:0.20833
[50]	train-logloss:0.63547	train-auc:0.69950	train-aucpr:0.31066	val-logloss:0.53395	val-auc:0.69989	val-aucpr:0.21077
[60]	train-logloss:0.63078	train-auc:0.70229	train-aucpr:0.31395	val-logloss:0.52528	val-auc:0.69584	val-aucpr:0.20883
[62]	train-logloss:0.62998	train-auc:0.70253	train-aucpr:0.31450	val-logloss:0.52409	val-auc:0.69850	val-aucpr:0.21134
[2025-11-19 09:11:15,773] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 09:11:15,773] [INFO] [<frozen importlib] - Best train loss: 0.6471
[2025-11-19 09:11:15,773] [INFO] [<frozen importlib] - Best val loss: 0.5691
[2025-11-19 09:11:15,773] [INFO] [<frozen importlib] - Best val AUC: 0.7075
[2025-11-19 09:11:15,773] [INFO] [<frozen importlib] - Best val AUCPR: 0.2141
[2025-11-19 09:11:15,778] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:11:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:11:20,533] [INFO] [<frozen importlib] - Optimal threshold: 0.4884
[2025-11-19 09:11:20,533] [INFO] [<frozen importlib] - Best f1: 0.2708
[2025-11-19 09:11:20,533] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:11:20,578] [INFO] [<frozen importlib] - Validation Results (threshold=0.4884):
[2025-11-19 09:11:20,578] [INFO] [<frozen importlib] -   Accuracy: 0.8900
[2025-11-19 09:11:20,579] [INFO] [<frozen importlib] -   Precision: 0.2759
[2025-11-19 09:11:20,579] [INFO] [<frozen importlib] -   Recall: 0.2658
[2025-11-19 09:11:20,579] [INFO] [<frozen importlib] -   F1 Score: 0.2708
[2025-11-19 09:11:20,579] [INFO] [<frozen importlib] -   AUROC: 0.7075
[2025-11-19 09:11:20,579] [INFO] [<frozen importlib] -   AUPRC: 0.2139
[2025-11-19 09:11:20,579] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:11:20,579] [INFO] [<frozen importlib] -     TN=16432, FP=1013
[2025-11-19 09:11:20,579] [INFO] [<frozen importlib] -     FN=1066, TP=386
[2025-11-19 09:11:20,603] [INFO] [<frozen importlib] - Trial 298: AUPRC=0.2139, F1=0.4428, Prec=0.4090, Rec=0.4828 | Optimizing auprc=0.2139
[2025-11-19 09:11:20,604] [INFO] [<frozen importlib] - Trial 298 pruned.
[2025-11-19 09:11:20,604] [ERROR] [<frozen importlib] - Trial 298 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  60%|█████▉    | 298/500 [49:18<38:18, 11.38s/it]Best trial: 289. Best value: 0.241792:  60%|█████▉    | 298/500 [49:18<38:18, 11.38s/it]Best trial: 289. Best value: 0.241792:  60%|█████▉    | 299/500 [49:18<31:49,  9.50s/it][2025-11-19 09:11:20,619] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.329470785352254
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   gamma: 0.24045562640203877
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   alpha: 0.545184954781154
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   lambda: 0.8330617994240803
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   learning_rate: 0.03726470586723297
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   subsample: 0.8372548215069859
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   colsample_bytree: 0.5961412803235728
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5180202848169525
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   colsample_bynode: 0.777905883265695
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:11:20,619] [INFO] [<frozen importlib] -   scale_pos_weight: 5.329470785352254
[2025-11-19 09:11:20,692] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:11:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:11:20,604] Trial 298 pruned. 
[0]	train-logloss:0.60681	train-auc:0.61335	train-aucpr:0.19963	val-logloss:0.59285	val-auc:0.58444	val-aucpr:0.11699
[10]	train-logloss:0.59050	train-auc:0.66436	train-aucpr:0.26904	val-logloss:0.54991	val-auc:0.65456	val-aucpr:0.13862
[20]	train-logloss:0.57911	train-auc:0.66752	train-aucpr:0.27802	val-logloss:0.52488	val-auc:0.65197	val-aucpr:0.13377
[30]	train-logloss:0.57182	train-auc:0.67376	train-aucpr:0.28380	val-logloss:0.50494	val-auc:0.65581	val-aucpr:0.17411
[40]	train-logloss:0.56606	train-auc:0.68035	train-aucpr:0.29022	val-logloss:0.48826	val-auc:0.66219	val-aucpr:0.19217
[50]	train-logloss:0.56159	train-auc:0.68378	train-aucpr:0.29520	val-logloss:0.47479	val-auc:0.66938	val-aucpr:0.20240
[60]	train-logloss:0.55820	train-auc:0.68629	train-aucpr:0.29746	val-logloss:0.46861	val-auc:0.66831	val-aucpr:0.20657
[70]	train-logloss:0.55530	train-auc:0.69033	train-aucpr:0.29990	val-logloss:0.47411	val-auc:0.66639	val-aucpr:0.20892
[80]	train-logloss:0.55280	train-auc:0.69229	train-aucpr:0.30255	val-logloss:0.47498	val-auc:0.67899	val-aucpr:0.22041
[90]	train-logloss:0.55087	train-auc:0.69494	train-aucpr:0.30558	val-logloss:0.46866	val-auc:0.67955	val-aucpr:0.21900
[100]	train-logloss:0.54931	train-auc:0.69695	train-aucpr:0.30794	val-logloss:0.46449	val-auc:0.68680	val-aucpr:0.21470
[110]	train-logloss:0.54770	train-auc:0.69931	train-aucpr:0.31032	val-logloss:0.45921	val-auc:0.68115	val-aucpr:0.21089
[120]	train-logloss:0.54613	train-auc:0.70192	train-aucpr:0.31237	val-logloss:0.45274	val-auc:0.68647	val-aucpr:0.21056
[123]	train-logloss:0.54590	train-auc:0.70255	train-aucpr:0.31331	val-logloss:0.45501	val-auc:0.68504	val-aucpr:0.20833
[2025-11-19 09:11:20,970] [INFO] [<frozen importlib] - Training completed at iteration 93
[2025-11-19 09:11:20,970] [INFO] [<frozen importlib] - Best train loss: 0.5504
[2025-11-19 09:11:20,970] [INFO] [<frozen importlib] - Best val loss: 0.4653
[2025-11-19 09:11:20,971] [INFO] [<frozen importlib] - Best val AUC: 0.6886
[2025-11-19 09:11:20,971] [INFO] [<frozen importlib] - Best val AUCPR: 0.2219
[2025-11-19 09:11:20,976] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:11:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:11:32,977] [INFO] [<frozen importlib] - Optimal threshold: 0.4374
[2025-11-19 09:11:32,977] [INFO] [<frozen importlib] - Best f1: 0.2691
[2025-11-19 09:11:32,977] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:11:33,024] [INFO] [<frozen importlib] - Validation Results (threshold=0.4374):
[2025-11-19 09:11:33,024] [INFO] [<frozen importlib] -   Accuracy: 0.9083
[2025-11-19 09:11:33,024] [INFO] [<frozen importlib] -   Precision: 0.3471
[2025-11-19 09:11:33,024] [INFO] [<frozen importlib] -   Recall: 0.2197
[2025-11-19 09:11:33,024] [INFO] [<frozen importlib] -   F1 Score: 0.2691
[2025-11-19 09:11:33,025] [INFO] [<frozen importlib] -   AUROC: 0.6886
[2025-11-19 09:11:33,025] [INFO] [<frozen importlib] -   AUPRC: 0.2223
[2025-11-19 09:11:33,025] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:11:33,025] [INFO] [<frozen importlib] -     TN=16845, FP=600
[2025-11-19 09:11:33,025] [INFO] [<frozen importlib] -     FN=1133, TP=319
[2025-11-19 09:11:33,051] [INFO] [<frozen importlib] - Trial 299: AUPRC=0.2223, F1=0.4490, Prec=0.4975, Rec=0.4091 | Optimizing auprc=0.2223
                                                                                        Best trial: 289. Best value: 0.241792:  60%|█████▉    | 299/500 [49:31<31:49,  9.50s/it]Best trial: 289. Best value: 0.241792:  60%|█████▉    | 299/500 [49:31<31:49,  9.50s/it]Best trial: 289. Best value: 0.241792:  60%|██████    | 300/500 [49:31<34:36, 10.38s/it][2025-11-19 09:11:33,064] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.89221269846306
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   gamma: 0.15961634953920822
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   alpha: 0.606570810536975
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   lambda: 0.915803628866949
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   learning_rate: 0.03453647582241054
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   subsample: 0.8091157681256257
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   colsample_bytree: 0.5725904096722245
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5081870498326944
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   colsample_bynode: 0.7446034965717918
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:11:33,064] [INFO] [<frozen importlib] -   scale_pos_weight: 10.89221269846306
[2025-11-19 09:11:33,140] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:11:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:11:33,052] Trial 299 finished with value: 0.22231764115343133 and parameters: {'max_depth': 3, 'min_child_weight': 7, 'gamma': 0.24045562640203877, 'learning_rate': 0.03726470586723297, 'n_estimators': 450, 'alpha': 0.545184954781154, 'lambda': 0.8330617994240803, 'subsample': 0.8372548215069859, 'colsample_bytree': 0.5961412803235728, 'colsample_bylevel': 0.5180202848169525, 'colsample_bynode': 0.777905883265695, 'scale_pos_weight': 5.329470785352254}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.88519	train-auc:0.64757	train-aucpr:0.22482	val-logloss:0.90033	val-auc:0.66341	val-aucpr:0.14466
[10]	train-logloss:0.85374	train-auc:0.68456	train-aucpr:0.28607	val-logloss:0.81555	val-auc:0.70720	val-aucpr:0.20530
[20]	train-logloss:0.83558	train-auc:0.68817	train-aucpr:0.29270	val-logloss:0.76294	val-auc:0.70410	val-aucpr:0.21936
[30]	train-logloss:0.82289	train-auc:0.69162	train-aucpr:0.29874	val-logloss:0.71590	val-auc:0.70503	val-aucpr:0.22140
[40]	train-logloss:0.81367	train-auc:0.69477	train-aucpr:0.30282	val-logloss:0.69241	val-auc:0.70715	val-aucpr:0.22167
[50]	train-logloss:0.80598	train-auc:0.69981	train-aucpr:0.30675	val-logloss:0.67854	val-auc:0.70258	val-aucpr:0.22338
[60]	train-logloss:0.80026	train-auc:0.70434	train-aucpr:0.31026	val-logloss:0.67284	val-auc:0.70089	val-aucpr:0.22529
[70]	train-logloss:0.79532	train-auc:0.70814	train-aucpr:0.31449	val-logloss:0.65575	val-auc:0.70040	val-aucpr:0.22421
[80]	train-logloss:0.79123	train-auc:0.71153	train-aucpr:0.31820	val-logloss:0.64410	val-auc:0.69801	val-aucpr:0.21949
[90]	train-logloss:0.78734	train-auc:0.71572	train-aucpr:0.32137	val-logloss:0.64217	val-auc:0.69513	val-aucpr:0.21568
[92]	train-logloss:0.78686	train-auc:0.71622	train-aucpr:0.32179	val-logloss:0.64417	val-auc:0.69397	val-aucpr:0.21310
[2025-11-19 09:11:33,407] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:11:33,407] [INFO] [<frozen importlib] - Best train loss: 0.7991
[2025-11-19 09:11:33,407] [INFO] [<frozen importlib] - Best val loss: 0.6703
[2025-11-19 09:11:33,407] [INFO] [<frozen importlib] - Best val AUC: 0.7003
[2025-11-19 09:11:33,407] [INFO] [<frozen importlib] - Best val AUCPR: 0.2256
[2025-11-19 09:11:33,413] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:11:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:11:46,712] [INFO] [<frozen importlib] - Optimal threshold: 0.6124
[2025-11-19 09:11:46,712] [INFO] [<frozen importlib] - Best f1: 0.2678
[2025-11-19 09:11:46,712] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:11:46,757] [INFO] [<frozen importlib] - Validation Results (threshold=0.6124):
[2025-11-19 09:11:46,757] [INFO] [<frozen importlib] -   Accuracy: 0.9080
[2025-11-19 09:11:46,757] [INFO] [<frozen importlib] -   Precision: 0.3445
[2025-11-19 09:11:46,757] [INFO] [<frozen importlib] -   Recall: 0.2190
[2025-11-19 09:11:46,757] [INFO] [<frozen importlib] -   F1 Score: 0.2678
[2025-11-19 09:11:46,757] [INFO] [<frozen importlib] -   AUROC: 0.7003
[2025-11-19 09:11:46,757] [INFO] [<frozen importlib] -   AUPRC: 0.2259
[2025-11-19 09:11:46,757] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:11:46,757] [INFO] [<frozen importlib] -     TN=16840, FP=605
[2025-11-19 09:11:46,757] [INFO] [<frozen importlib] -     FN=1134, TP=318
[2025-11-19 09:11:46,780] [INFO] [<frozen importlib] - Trial 300: AUPRC=0.2259, F1=0.4655, Prec=0.5077, Rec=0.4298 | Optimizing auprc=0.2259
[2025-11-19 09:11:46,780] [INFO] [<frozen importlib] - Trial 300 pruned.
[2025-11-19 09:11:46,780] [ERROR] [<frozen importlib] - Trial 300 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  60%|██████    | 300/500 [49:44<34:36, 10.38s/it]Best trial: 289. Best value: 0.241792:  60%|██████    | 300/500 [49:44<34:36, 10.38s/it]Best trial: 289. Best value: 0.241792:  60%|██████    | 301/500 [49:44<37:46, 11.39s/it][2025-11-19 09:11:46,792] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.5688634937787125
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   gamma: 0.11913809895978866
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   alpha: 0.47086701828690086
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   lambda: 0.6103080095968181
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   learning_rate: 0.03329951084950157
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   subsample: 0.7984306658491218
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   colsample_bytree: 0.6065434034223698
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5004498140028502
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   colsample_bynode: 0.6595144419360027
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:11:46,792] [INFO] [<frozen importlib] -   scale_pos_weight: 6.5688634937787125
[2025-11-19 09:11:46,868] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:11:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:11:46,780] Trial 300 pruned. 
[0]	train-logloss:0.67589	train-auc:0.64067	train-aucpr:0.24259	val-logloss:0.67165	val-auc:0.58513	val-aucpr:0.13182
[10]	train-logloss:0.65463	train-auc:0.68148	train-aucpr:0.29179	val-logloss:0.62552	val-auc:0.68163	val-aucpr:0.19263
[20]	train-logloss:0.64106	train-auc:0.68597	train-aucpr:0.29552	val-logloss:0.59036	val-auc:0.69814	val-aucpr:0.21277
[30]	train-logloss:0.63104	train-auc:0.68970	train-aucpr:0.30061	val-logloss:0.56201	val-auc:0.70136	val-aucpr:0.21962
[40]	train-logloss:0.62385	train-auc:0.69431	train-aucpr:0.30650	val-logloss:0.53929	val-auc:0.70301	val-aucpr:0.22322
[50]	train-logloss:0.61780	train-auc:0.69982	train-aucpr:0.30996	val-logloss:0.52326	val-auc:0.70348	val-aucpr:0.22407
[60]	train-logloss:0.61339	train-auc:0.70311	train-aucpr:0.31376	val-logloss:0.51103	val-auc:0.70531	val-aucpr:0.22293
[70]	train-logloss:0.60957	train-auc:0.70652	train-aucpr:0.31811	val-logloss:0.49833	val-auc:0.70209	val-aucpr:0.22371
[80]	train-logloss:0.60664	train-auc:0.70915	train-aucpr:0.32119	val-logloss:0.49271	val-auc:0.70320	val-aucpr:0.22155
[82]	train-logloss:0.60598	train-auc:0.70986	train-aucpr:0.32188	val-logloss:0.49044	val-auc:0.70278	val-aucpr:0.22153
[2025-11-19 09:11:47,112] [INFO] [<frozen importlib] - Training completed at iteration 53
[2025-11-19 09:11:47,112] [INFO] [<frozen importlib] - Best train loss: 0.6162
[2025-11-19 09:11:47,112] [INFO] [<frozen importlib] - Best val loss: 0.5205
[2025-11-19 09:11:47,112] [INFO] [<frozen importlib] - Best val AUC: 0.7063
[2025-11-19 09:11:47,112] [INFO] [<frozen importlib] - Best val AUCPR: 0.2261
[2025-11-19 09:11:47,117] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:11:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:11:59,201] [INFO] [<frozen importlib] - Optimal threshold: 0.4925
[2025-11-19 09:11:59,201] [INFO] [<frozen importlib] - Best f1: 0.2749
[2025-11-19 09:11:59,201] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:11:59,245] [INFO] [<frozen importlib] - Validation Results (threshold=0.4925):
[2025-11-19 09:11:59,245] [INFO] [<frozen importlib] -   Accuracy: 0.9026
[2025-11-19 09:11:59,245] [INFO] [<frozen importlib] -   Precision: 0.3211
[2025-11-19 09:11:59,245] [INFO] [<frozen importlib] -   Recall: 0.2404
[2025-11-19 09:11:59,245] [INFO] [<frozen importlib] -   F1 Score: 0.2749
[2025-11-19 09:11:59,245] [INFO] [<frozen importlib] -   AUROC: 0.7063
[2025-11-19 09:11:59,245] [INFO] [<frozen importlib] -   AUPRC: 0.2265
[2025-11-19 09:11:59,245] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:11:59,245] [INFO] [<frozen importlib] -     TN=16707, FP=738
[2025-11-19 09:11:59,245] [INFO] [<frozen importlib] -     FN=1103, TP=349
[2025-11-19 09:11:59,267] [INFO] [<frozen importlib] - Trial 301: AUPRC=0.2265, F1=0.4517, Prec=0.4641, Rec=0.4401 | Optimizing auprc=0.2265
                                                                                        Best trial: 289. Best value: 0.241792:  60%|██████    | 301/500 [49:57<37:46, 11.39s/it]Best trial: 289. Best value: 0.241792:  60%|██████    | 301/500 [49:57<37:46, 11.39s/it]Best trial: 289. Best value: 0.241792:  60%|██████    | 302/500 [49:57<38:40, 11.72s/it][2025-11-19 09:11:59,279] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.1535805616951125
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   gamma: 0.09044717931271881
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   alpha: 0.5536940888062236
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   lambda: 0.7742264843496741
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   learning_rate: 0.035145670451545735
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   subsample: 0.8214367578740672
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   colsample_bytree: 0.5815797994012807
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5255699209343803
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   colsample_bynode: 0.8051562881675365
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:11:59,280] [INFO] [<frozen importlib] -   scale_pos_weight: 7.1535805616951125
[2025-11-19 09:11:59,355] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:11:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:11:59,268] Trial 301 finished with value: 0.22649760402583985 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.11913809895978866, 'learning_rate': 0.03329951084950157, 'n_estimators': 450, 'alpha': 0.47086701828690086, 'lambda': 0.6103080095968181, 'subsample': 0.7984306658491218, 'colsample_bytree': 0.6065434034223698, 'colsample_bylevel': 0.5004498140028502, 'colsample_bynode': 0.6595144419360027, 'scale_pos_weight': 6.5688634937787125}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.70739	train-auc:0.64033	train-aucpr:0.22479	val-logloss:0.70576	val-auc:0.61595	val-aucpr:0.11679
[10]	train-logloss:0.68321	train-auc:0.68157	train-aucpr:0.28907	val-logloss:0.64273	val-auc:0.69971	val-aucpr:0.20340
[20]	train-logloss:0.66824	train-auc:0.68724	train-aucpr:0.29543	val-logloss:0.60497	val-auc:0.70209	val-aucpr:0.21559
[30]	train-logloss:0.65784	train-auc:0.69255	train-aucpr:0.30245	val-logloss:0.58582	val-auc:0.69945	val-aucpr:0.21707
[40]	train-logloss:0.65034	train-auc:0.69580	train-aucpr:0.30598	val-logloss:0.56456	val-auc:0.70161	val-aucpr:0.21865
[50]	train-logloss:0.64366	train-auc:0.70085	train-aucpr:0.31205	val-logloss:0.54042	val-auc:0.70497	val-aucpr:0.22707
[60]	train-logloss:0.63942	train-auc:0.70378	train-aucpr:0.31539	val-logloss:0.53916	val-auc:0.70809	val-aucpr:0.23143
[70]	train-logloss:0.63580	train-auc:0.70680	train-aucpr:0.31886	val-logloss:0.53281	val-auc:0.70778	val-aucpr:0.22882
[80]	train-logloss:0.63225	train-auc:0.71133	train-aucpr:0.32283	val-logloss:0.51982	val-auc:0.70480	val-aucpr:0.22369
[84]	train-logloss:0.63103	train-auc:0.71282	train-aucpr:0.32410	val-logloss:0.51987	val-auc:0.70282	val-aucpr:0.22129
[2025-11-19 09:11:59,602] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 09:11:59,602] [INFO] [<frozen importlib] - Best train loss: 0.6416
[2025-11-19 09:11:59,602] [INFO] [<frozen importlib] - Best val loss: 0.5344
[2025-11-19 09:11:59,602] [INFO] [<frozen importlib] - Best val AUC: 0.7090
[2025-11-19 09:11:59,602] [INFO] [<frozen importlib] - Best val AUCPR: 0.2315
[2025-11-19 09:11:59,606] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:11:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:12:12,463] [INFO] [<frozen importlib] - Optimal threshold: 0.5082
[2025-11-19 09:12:12,463] [INFO] [<frozen importlib] - Best f1: 0.2722
[2025-11-19 09:12:12,463] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:12:12,504] [INFO] [<frozen importlib] - Validation Results (threshold=0.5082):
[2025-11-19 09:12:12,504] [INFO] [<frozen importlib] -   Accuracy: 0.8975
[2025-11-19 09:12:12,504] [INFO] [<frozen importlib] -   Precision: 0.2997
[2025-11-19 09:12:12,504] [INFO] [<frozen importlib] -   Recall: 0.2493
[2025-11-19 09:12:12,504] [INFO] [<frozen importlib] -   F1 Score: 0.2722
[2025-11-19 09:12:12,504] [INFO] [<frozen importlib] -   AUROC: 0.7090
[2025-11-19 09:12:12,504] [INFO] [<frozen importlib] -   AUPRC: 0.2319
[2025-11-19 09:12:12,504] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:12:12,504] [INFO] [<frozen importlib] -     TN=16599, FP=846
[2025-11-19 09:12:12,504] [INFO] [<frozen importlib] -     FN=1090, TP=362
[2025-11-19 09:12:12,529] [INFO] [<frozen importlib] - Trial 302: AUPRC=0.2319, F1=0.4551, Prec=0.4445, Rec=0.4663 | Optimizing auprc=0.2319
                                                                                        Best trial: 289. Best value: 0.241792:  60%|██████    | 302/500 [50:10<38:40, 11.72s/it]Best trial: 289. Best value: 0.241792:  60%|██████    | 302/500 [50:10<38:40, 11.72s/it]Best trial: 289. Best value: 0.241792:  61%|██████    | 303/500 [50:10<39:59, 12.18s/it][2025-11-19 09:12:12,543] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.858165990483968
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   gamma: 0.193734609914002
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   alpha: 0.6625163281681122
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   lambda: 3.1679792950364147
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   learning_rate: 0.031318793321053584
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   subsample: 0.78708156505277
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   colsample_bytree: 0.5598535907237944
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7751582080262115
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   colsample_bynode: 0.7669231303722227
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:12:12,543] [INFO] [<frozen importlib] -   scale_pos_weight: 5.858165990483968
[2025-11-19 09:12:12,620] [INFO] [<frozen importlib] - Training with 150 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:12:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:12:12,530] Trial 302 finished with value: 0.2319280701833978 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.09044717931271881, 'learning_rate': 0.035145670451545735, 'n_estimators': 450, 'alpha': 0.5536940888062236, 'lambda': 0.7742264843496741, 'subsample': 0.8214367578740672, 'colsample_bytree': 0.5815797994012807, 'colsample_bylevel': 0.5255699209343803, 'colsample_bynode': 0.8051562881675365, 'scale_pos_weight': 7.1535805616951125}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.63635	train-auc:0.64275	train-aucpr:0.24914	val-logloss:0.62511	val-auc:0.63142	val-aucpr:0.11487
[10]	train-logloss:0.61704	train-auc:0.68015	train-aucpr:0.29061	val-logloss:0.58316	val-auc:0.66042	val-aucpr:0.16225
[20]	train-logloss:0.60418	train-auc:0.68806	train-aucpr:0.29781	val-logloss:0.55474	val-auc:0.68984	val-aucpr:0.19922
[30]	train-logloss:0.59485	train-auc:0.69129	train-aucpr:0.30229	val-logloss:0.52576	val-auc:0.69307	val-aucpr:0.20562
[40]	train-logloss:0.58823	train-auc:0.69482	train-aucpr:0.30707	val-logloss:0.49841	val-auc:0.69882	val-aucpr:0.21294
[50]	train-logloss:0.58260	train-auc:0.69859	train-aucpr:0.31121	val-logloss:0.49348	val-auc:0.70516	val-aucpr:0.21722
[60]	train-logloss:0.57834	train-auc:0.70245	train-aucpr:0.31488	val-logloss:0.47962	val-auc:0.70817	val-aucpr:0.22103
[70]	train-logloss:0.57485	train-auc:0.70571	train-aucpr:0.31843	val-logloss:0.47324	val-auc:0.70841	val-aucpr:0.22139
[80]	train-logloss:0.57177	train-auc:0.70957	train-aucpr:0.32229	val-logloss:0.47271	val-auc:0.70572	val-aucpr:0.21732
[86]	train-logloss:0.57013	train-auc:0.71147	train-aucpr:0.32417	val-logloss:0.47407	val-auc:0.70371	val-aucpr:0.21680
[2025-11-19 09:12:12,871] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:12:12,871] [INFO] [<frozen importlib] - Best train loss: 0.5800
[2025-11-19 09:12:12,871] [INFO] [<frozen importlib] - Best val loss: 0.4857
[2025-11-19 09:12:12,871] [INFO] [<frozen importlib] - Best val AUC: 0.7072
[2025-11-19 09:12:12,871] [INFO] [<frozen importlib] - Best val AUCPR: 0.2220
[2025-11-19 09:12:12,876] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:12:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:12:21,587] [INFO] [<frozen importlib] - Optimal threshold: 0.4530
[2025-11-19 09:12:21,587] [INFO] [<frozen importlib] - Best f1: 0.2745
[2025-11-19 09:12:21,587] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:12:21,631] [INFO] [<frozen importlib] - Validation Results (threshold=0.4530):
[2025-11-19 09:12:21,631] [INFO] [<frozen importlib] -   Accuracy: 0.8971
[2025-11-19 09:12:21,631] [INFO] [<frozen importlib] -   Precision: 0.2994
[2025-11-19 09:12:21,631] [INFO] [<frozen importlib] -   Recall: 0.2534
[2025-11-19 09:12:21,631] [INFO] [<frozen importlib] -   F1 Score: 0.2745
[2025-11-19 09:12:21,631] [INFO] [<frozen importlib] -   AUROC: 0.7072
[2025-11-19 09:12:21,631] [INFO] [<frozen importlib] -   AUPRC: 0.2223
[2025-11-19 09:12:21,631] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:12:21,631] [INFO] [<frozen importlib] -     TN=16584, FP=861
[2025-11-19 09:12:21,631] [INFO] [<frozen importlib] -     FN=1084, TP=368
[2025-11-19 09:12:21,654] [INFO] [<frozen importlib] - Trial 303: AUPRC=0.2223, F1=0.4356, Prec=0.4279, Rec=0.4435 | Optimizing auprc=0.2223
[2025-11-19 09:12:21,655] [INFO] [<frozen importlib] - Trial 303 pruned.
[2025-11-19 09:12:21,655] [ERROR] [<frozen importlib] - Trial 303 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  61%|██████    | 303/500 [50:19<39:59, 12.18s/it]Best trial: 289. Best value: 0.241792:  61%|██████    | 303/500 [50:19<39:59, 12.18s/it]Best trial: 289. Best value: 0.241792:  61%|██████    | 304/500 [50:19<36:47, 11.26s/it][2025-11-19 09:12:21,666] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.278253174341136
[2025-11-19 09:12:21,666] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:12:21,666] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:12:21,666] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:12:21,666] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:12:21,666] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:12:21,666] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:12:21,666] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:12:21,666] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   gamma: 0.25018200519792555
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   alpha: 0.4178616459913731
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   lambda: 1.2967029044862357
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   learning_rate: 0.038594550331534944
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   subsample: 0.8292421178756646
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   colsample_bytree: 0.5941389210217591
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5212808220321747
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   colsample_bynode: 0.7873978698936566
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:12:21,667] [INFO] [<frozen importlib] -   scale_pos_weight: 6.278253174341136
[2025-11-19 09:12:21,743] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:12:21] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:12:21,655] Trial 303 pruned. 
[0]	train-logloss:0.65965	train-auc:0.63894	train-aucpr:0.22160	val-logloss:0.65135	val-auc:0.61080	val-aucpr:0.12777
[10]	train-logloss:0.63593	train-auc:0.68218	train-aucpr:0.28978	val-logloss:0.60212	val-auc:0.67193	val-aucpr:0.17552
[20]	train-logloss:0.62142	train-auc:0.68886	train-aucpr:0.29857	val-logloss:0.56157	val-auc:0.68732	val-aucpr:0.20639
[30]	train-logloss:0.61156	train-auc:0.69355	train-aucpr:0.30443	val-logloss:0.53130	val-auc:0.68205	val-aucpr:0.21740
[40]	train-logloss:0.60467	train-auc:0.69777	train-aucpr:0.31017	val-logloss:0.51066	val-auc:0.70156	val-aucpr:0.23218
[50]	train-logloss:0.59925	train-auc:0.70167	train-aucpr:0.31433	val-logloss:0.49477	val-auc:0.70429	val-aucpr:0.23381
[60]	train-logloss:0.59532	train-auc:0.70586	train-aucpr:0.31836	val-logloss:0.49018	val-auc:0.70955	val-aucpr:0.23469
[70]	train-logloss:0.59173	train-auc:0.70913	train-aucpr:0.32264	val-logloss:0.48368	val-auc:0.71388	val-aucpr:0.23037
[80]	train-logloss:0.58853	train-auc:0.71404	train-aucpr:0.32742	val-logloss:0.47873	val-auc:0.70522	val-aucpr:0.22046
[83]	train-logloss:0.58779	train-auc:0.71487	train-aucpr:0.32810	val-logloss:0.47899	val-auc:0.70477	val-aucpr:0.21862
[2025-11-19 09:12:21,989] [INFO] [<frozen importlib] - Training completed at iteration 53
[2025-11-19 09:12:21,989] [INFO] [<frozen importlib] - Best train loss: 0.5979
[2025-11-19 09:12:21,989] [INFO] [<frozen importlib] - Best val loss: 0.4923
[2025-11-19 09:12:21,989] [INFO] [<frozen importlib] - Best val AUC: 0.7060
[2025-11-19 09:12:21,989] [INFO] [<frozen importlib] - Best val AUCPR: 0.2351
[2025-11-19 09:12:21,994] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:12:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:12:34,258] [INFO] [<frozen importlib] - Optimal threshold: 0.4487
[2025-11-19 09:12:34,258] [INFO] [<frozen importlib] - Best f1: 0.2870
[2025-11-19 09:12:34,258] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:12:34,299] [INFO] [<frozen importlib] - Validation Results (threshold=0.4487):
[2025-11-19 09:12:34,299] [INFO] [<frozen importlib] -   Accuracy: 0.8933
[2025-11-19 09:12:34,299] [INFO] [<frozen importlib] -   Precision: 0.2948
[2025-11-19 09:12:34,299] [INFO] [<frozen importlib] -   Recall: 0.2796
[2025-11-19 09:12:34,299] [INFO] [<frozen importlib] -   F1 Score: 0.2870
[2025-11-19 09:12:34,299] [INFO] [<frozen importlib] -   AUROC: 0.7060
[2025-11-19 09:12:34,299] [INFO] [<frozen importlib] -   AUPRC: 0.2355
[2025-11-19 09:12:34,299] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:12:34,299] [INFO] [<frozen importlib] -     TN=16474, FP=971
[2025-11-19 09:12:34,299] [INFO] [<frozen importlib] -     FN=1046, TP=406
[2025-11-19 09:12:34,319] [INFO] [<frozen importlib] - Trial 304: AUPRC=0.2355, F1=0.4438, Prec=0.4158, Rec=0.4759 | Optimizing auprc=0.2355
                                                                                        Best trial: 289. Best value: 0.241792:  61%|██████    | 304/500 [50:32<36:47, 11.26s/it]Best trial: 289. Best value: 0.241792:  61%|██████    | 304/500 [50:32<36:47, 11.26s/it]Best trial: 289. Best value: 0.241792:  61%|██████    | 305/500 [50:32<37:58, 11.68s/it][2025-11-19 09:12:34,332] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.167642636744451
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   gamma: 0.17425393293672445
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   alpha: 0.41472298081237036
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   lambda: 1.3924507017859817
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   learning_rate: 0.03684910077109981
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   subsample: 0.8244254998346017
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   colsample_bytree: 0.6127916014181745
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5169548403253836
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   colsample_bynode: 0.813804846414159
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:12:34,332] [INFO] [<frozen importlib] -   scale_pos_weight: 6.167642636744451
[2025-11-19 09:12:34,410] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:12:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:12:34,320] Trial 304 finished with value: 0.23545692755280195 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.25018200519792555, 'learning_rate': 0.038594550331534944, 'n_estimators': 250, 'alpha': 0.4178616459913731, 'lambda': 1.2967029044862357, 'subsample': 0.8292421178756646, 'colsample_bytree': 0.5941389210217591, 'colsample_bylevel': 0.5212808220321747, 'colsample_bynode': 0.7873978698936566, 'scale_pos_weight': 6.278253174341136}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.65333	train-auc:0.64297	train-aucpr:0.25188	val-logloss:0.64538	val-auc:0.58551	val-aucpr:0.11206
[10]	train-logloss:0.63103	train-auc:0.68107	train-aucpr:0.29348	val-logloss:0.59976	val-auc:0.70478	val-aucpr:0.21191
[20]	train-logloss:0.61697	train-auc:0.68585	train-aucpr:0.30010	val-logloss:0.56254	val-auc:0.70191	val-aucpr:0.21763
[30]	train-logloss:0.60765	train-auc:0.69177	train-aucpr:0.30500	val-logloss:0.53321	val-auc:0.70738	val-aucpr:0.22941
[40]	train-logloss:0.60087	train-auc:0.69646	train-aucpr:0.30927	val-logloss:0.51005	val-auc:0.70885	val-aucpr:0.22545
[50]	train-logloss:0.59501	train-auc:0.70097	train-aucpr:0.31323	val-logloss:0.50031	val-auc:0.70947	val-aucpr:0.22682
[60]	train-logloss:0.59112	train-auc:0.70336	train-aucpr:0.31755	val-logloss:0.49144	val-auc:0.71046	val-aucpr:0.22884
[2025-11-19 09:12:34,602] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 09:12:34,602] [INFO] [<frozen importlib] - Best train loss: 0.6068
[2025-11-19 09:12:34,602] [INFO] [<frozen importlib] - Best val loss: 0.5302
[2025-11-19 09:12:34,602] [INFO] [<frozen importlib] - Best val AUC: 0.7072
[2025-11-19 09:12:34,602] [INFO] [<frozen importlib] - Best val AUCPR: 0.2299
[2025-11-19 09:12:34,607] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:12:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:12:40,481] [INFO] [<frozen importlib] - Optimal threshold: 0.4661
[2025-11-19 09:12:40,481] [INFO] [<frozen importlib] - Best f1: 0.2744
[2025-11-19 09:12:40,481] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:12:40,526] [INFO] [<frozen importlib] - Validation Results (threshold=0.4661):
[2025-11-19 09:12:40,526] [INFO] [<frozen importlib] -   Accuracy: 0.8908
[2025-11-19 09:12:40,526] [INFO] [<frozen importlib] -   Precision: 0.2804
[2025-11-19 09:12:40,526] [INFO] [<frozen importlib] -   Recall: 0.2686
[2025-11-19 09:12:40,526] [INFO] [<frozen importlib] -   F1 Score: 0.2744
[2025-11-19 09:12:40,526] [INFO] [<frozen importlib] -   AUROC: 0.7072
[2025-11-19 09:12:40,526] [INFO] [<frozen importlib] -   AUPRC: 0.2299
[2025-11-19 09:12:40,526] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:12:40,526] [INFO] [<frozen importlib] -     TN=16444, FP=1001
[2025-11-19 09:12:40,526] [INFO] [<frozen importlib] -     FN=1062, TP=390
[2025-11-19 09:12:40,549] [INFO] [<frozen importlib] - Trial 305: AUPRC=0.2299, F1=0.4366, Prec=0.4063, Rec=0.4718 | Optimizing auprc=0.2299
                                                                                        Best trial: 289. Best value: 0.241792:  61%|██████    | 305/500 [50:38<37:58, 11.68s/it]Best trial: 289. Best value: 0.241792:  61%|██████    | 305/500 [50:38<37:58, 11.68s/it]Best trial: 289. Best value: 0.241792:  61%|██████    | 306/500 [50:38<32:29, 10.05s/it][2025-11-19 09:12:40,561] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.587660508536959
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   gamma: 0.25149955472495433
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   alpha: 0.4318644815473977
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   lambda: 1.2728055278789328
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   learning_rate: 0.08824626554818803
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   subsample: 0.8419808847433367
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   colsample_bytree: 0.6224918661097257
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8526205149436198
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   colsample_bynode: 0.7851984898735442
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:12:40,562] [INFO] [<frozen importlib] -   scale_pos_weight: 5.587660508536959
[2025-11-19 09:12:40,634] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:12:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:12:40,550] Trial 305 finished with value: 0.22986866510489706 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.17425393293672445, 'learning_rate': 0.03684910077109981, 'n_estimators': 200, 'alpha': 0.41472298081237036, 'lambda': 1.3924507017859817, 'subsample': 0.8244254998346017, 'colsample_bytree': 0.6127916014181745, 'colsample_bylevel': 0.5169548403253836, 'colsample_bynode': 0.813804846414159, 'scale_pos_weight': 6.167642636744451}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.61653	train-auc:0.65565	train-aucpr:0.24450	val-logloss:0.59398	val-auc:0.64402	val-aucpr:0.13554
[10]	train-logloss:0.57935	train-auc:0.68816	train-aucpr:0.30134	val-logloss:0.50263	val-auc:0.69933	val-aucpr:0.19716
[20]	train-logloss:0.56413	train-auc:0.69976	train-aucpr:0.31686	val-logloss:0.49854	val-auc:0.70217	val-aucpr:0.20704
[30]	train-logloss:0.55585	train-auc:0.70935	train-aucpr:0.32690	val-logloss:0.48109	val-auc:0.70135	val-aucpr:0.19967
[40]	train-logloss:0.55002	train-auc:0.71832	train-aucpr:0.33608	val-logloss:0.45074	val-auc:0.69970	val-aucpr:0.20357
[46]	train-logloss:0.54709	train-auc:0.72342	train-aucpr:0.34072	val-logloss:0.45238	val-auc:0.69953	val-aucpr:0.20483
[2025-11-19 09:12:40,792] [INFO] [<frozen importlib] - Training completed at iteration 17
[2025-11-19 09:12:40,792] [INFO] [<frozen importlib] - Best train loss: 0.5678
[2025-11-19 09:12:40,792] [INFO] [<frozen importlib] - Best val loss: 0.4988
[2025-11-19 09:12:40,792] [INFO] [<frozen importlib] - Best val AUC: 0.7017
[2025-11-19 09:12:40,792] [INFO] [<frozen importlib] - Best val AUCPR: 0.2094
[2025-11-19 09:12:40,797] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:12:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:12:44,315] [INFO] [<frozen importlib] - Optimal threshold: 0.4540
[2025-11-19 09:12:44,315] [INFO] [<frozen importlib] - Best f1: 0.2657
[2025-11-19 09:12:44,315] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:12:44,358] [INFO] [<frozen importlib] - Validation Results (threshold=0.4540):
[2025-11-19 09:12:44,358] [INFO] [<frozen importlib] -   Accuracy: 0.8736
[2025-11-19 09:12:44,359] [INFO] [<frozen importlib] -   Precision: 0.2400
[2025-11-19 09:12:44,359] [INFO] [<frozen importlib] -   Recall: 0.2975
[2025-11-19 09:12:44,359] [INFO] [<frozen importlib] -   F1 Score: 0.2657
[2025-11-19 09:12:44,359] [INFO] [<frozen importlib] -   AUROC: 0.7017
[2025-11-19 09:12:44,359] [INFO] [<frozen importlib] -   AUPRC: 0.2095
[2025-11-19 09:12:44,359] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:12:44,359] [INFO] [<frozen importlib] -     TN=16077, FP=1368
[2025-11-19 09:12:44,359] [INFO] [<frozen importlib] -     FN=1020, TP=432
[2025-11-19 09:12:44,382] [INFO] [<frozen importlib] - Trial 306: AUPRC=0.2095, F1=0.4325, Prec=0.3625, Rec=0.5358 | Optimizing auprc=0.2095
[2025-11-19 09:12:44,383] [INFO] [<frozen importlib] - Trial 306 pruned.
[2025-11-19 09:12:44,383] [ERROR] [<frozen importlib] - Trial 306 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  61%|██████    | 306/500 [50:42<32:29, 10.05s/it]Best trial: 289. Best value: 0.241792:  61%|██████    | 306/500 [50:42<32:29, 10.05s/it]Best trial: 289. Best value: 0.241792:  61%|██████▏   | 307/500 [50:42<26:19,  8.18s/it][2025-11-19 09:12:44,397] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.418810674148662
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   gamma: 0.22442090755702035
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   alpha: 0.4050817925129441
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   lambda: 1.2513241517623046
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   learning_rate: 0.04049903346400611
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   subsample: 0.8326675189250146
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   colsample_bytree: 0.5978288969194053
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5183708206411416
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   colsample_bynode: 0.7994059308990532
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:12:44,397] [INFO] [<frozen importlib] -   scale_pos_weight: 6.418810674148662
[2025-11-19 09:12:44,472] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:12:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:12:44,383] Trial 306 pruned. 
[0]	train-logloss:0.66730	train-auc:0.63863	train-aucpr:0.22153	val-logloss:0.65972	val-auc:0.61586	val-aucpr:0.12856
[10]	train-logloss:0.64282	train-auc:0.68274	train-aucpr:0.29112	val-logloss:0.60437	val-auc:0.69728	val-aucpr:0.20178
[20]	train-logloss:0.62801	train-auc:0.68949	train-aucpr:0.29928	val-logloss:0.56097	val-auc:0.69762	val-aucpr:0.22007
[30]	train-logloss:0.61778	train-auc:0.69473	train-aucpr:0.30577	val-logloss:0.52886	val-auc:0.70123	val-aucpr:0.22616
[40]	train-logloss:0.61087	train-auc:0.69818	train-aucpr:0.31017	val-logloss:0.50334	val-auc:0.71491	val-aucpr:0.23344
[50]	train-logloss:0.60506	train-auc:0.70257	train-aucpr:0.31449	val-logloss:0.50233	val-auc:0.71909	val-aucpr:0.23227
[60]	train-logloss:0.60103	train-auc:0.70743	train-aucpr:0.31902	val-logloss:0.49622	val-auc:0.71266	val-aucpr:0.22792
[70]	train-logloss:0.59746	train-auc:0.71049	train-aucpr:0.32327	val-logloss:0.50291	val-auc:0.70277	val-aucpr:0.21812
[75]	train-logloss:0.59591	train-auc:0.71323	train-aucpr:0.32589	val-logloss:0.49734	val-auc:0.69964	val-aucpr:0.21661
[2025-11-19 09:12:44,698] [INFO] [<frozen importlib] - Training completed at iteration 46
[2025-11-19 09:12:44,698] [INFO] [<frozen importlib] - Best train loss: 0.6070
[2025-11-19 09:12:44,698] [INFO] [<frozen importlib] - Best val loss: 0.5032
[2025-11-19 09:12:44,698] [INFO] [<frozen importlib] - Best val AUC: 0.7189
[2025-11-19 09:12:44,698] [INFO] [<frozen importlib] - Best val AUCPR: 0.2341
[2025-11-19 09:12:44,703] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:12:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:12:56,268] [INFO] [<frozen importlib] - Optimal threshold: 0.4707
[2025-11-19 09:12:56,268] [INFO] [<frozen importlib] - Best f1: 0.2854
[2025-11-19 09:12:56,268] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:12:56,318] [INFO] [<frozen importlib] - Validation Results (threshold=0.4707):
[2025-11-19 09:12:56,318] [INFO] [<frozen importlib] -   Accuracy: 0.8943
[2025-11-19 09:12:56,318] [INFO] [<frozen importlib] -   Precision: 0.2969
[2025-11-19 09:12:56,318] [INFO] [<frozen importlib] -   Recall: 0.2748
[2025-11-19 09:12:56,318] [INFO] [<frozen importlib] -   F1 Score: 0.2854
[2025-11-19 09:12:56,318] [INFO] [<frozen importlib] -   AUROC: 0.7189
[2025-11-19 09:12:56,318] [INFO] [<frozen importlib] -   AUPRC: 0.2345
[2025-11-19 09:12:56,318] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:12:56,318] [INFO] [<frozen importlib] -     TN=16500, FP=945
[2025-11-19 09:12:56,318] [INFO] [<frozen importlib] -     FN=1053, TP=399
[2025-11-19 09:12:56,340] [INFO] [<frozen importlib] - Trial 307: AUPRC=0.2345, F1=0.4420, Prec=0.4185, Rec=0.4683 | Optimizing auprc=0.2345
                                                                                        Best trial: 289. Best value: 0.241792:  61%|██████▏   | 307/500 [50:54<26:19,  8.18s/it]Best trial: 289. Best value: 0.241792:  61%|██████▏   | 307/500 [50:54<26:19,  8.18s/it]Best trial: 289. Best value: 0.241792:  62%|██████▏   | 308/500 [50:54<29:48,  9.32s/it][2025-11-19 09:12:56,353] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.408748985034967
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   gamma: 0.14191173204925106
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   alpha: 0.3835105777008903
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   lambda: 1.355764953775907
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   learning_rate: 0.04032076703622307
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   subsample: 0.8317912892090996
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   colsample_bytree: 0.5995278702429232
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5263270013178278
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   colsample_bynode: 0.8025301353793161
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:12:56,353] [INFO] [<frozen importlib] -   scale_pos_weight: 6.408748985034967
[2025-11-19 09:12:56,429] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:12:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:12:56,341] Trial 307 finished with value: 0.23448973764418768 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.22442090755702035, 'learning_rate': 0.04049903346400611, 'n_estimators': 250, 'alpha': 0.4050817925129441, 'lambda': 1.2513241517623046, 'subsample': 0.8326675189250146, 'colsample_bytree': 0.5978288969194053, 'colsample_bylevel': 0.5183708206411416, 'colsample_bynode': 0.7994059308990532, 'scale_pos_weight': 6.418810674148662}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.66676	train-auc:0.63863	train-aucpr:0.22153	val-logloss:0.65913	val-auc:0.61586	val-aucpr:0.12856
[10]	train-logloss:0.64197	train-auc:0.68245	train-aucpr:0.28974	val-logloss:0.60712	val-auc:0.67557	val-aucpr:0.17554
[20]	train-logloss:0.62713	train-auc:0.68851	train-aucpr:0.29855	val-logloss:0.56442	val-auc:0.69669	val-aucpr:0.21229
[30]	train-logloss:0.61706	train-auc:0.69434	train-aucpr:0.30530	val-logloss:0.53065	val-auc:0.69477	val-aucpr:0.22445
[40]	train-logloss:0.61020	train-auc:0.69783	train-aucpr:0.30970	val-logloss:0.50803	val-auc:0.71368	val-aucpr:0.23669
[50]	train-logloss:0.60472	train-auc:0.70213	train-aucpr:0.31365	val-logloss:0.49238	val-auc:0.71066	val-aucpr:0.23805
[60]	train-logloss:0.60080	train-auc:0.70637	train-aucpr:0.31811	val-logloss:0.48660	val-auc:0.71182	val-aucpr:0.23769
[70]	train-logloss:0.59711	train-auc:0.71016	train-aucpr:0.32244	val-logloss:0.47432	val-auc:0.71156	val-aucpr:0.23147
[77]	train-logloss:0.59469	train-auc:0.71383	train-aucpr:0.32609	val-logloss:0.46830	val-auc:0.70702	val-aucpr:0.22706
[2025-11-19 09:12:56,661] [INFO] [<frozen importlib] - Training completed at iteration 48
[2025-11-19 09:12:56,661] [INFO] [<frozen importlib] - Best train loss: 0.6055
[2025-11-19 09:12:56,661] [INFO] [<frozen importlib] - Best val loss: 0.4948
[2025-11-19 09:12:56,661] [INFO] [<frozen importlib] - Best val AUC: 0.7123
[2025-11-19 09:12:56,661] [INFO] [<frozen importlib] - Best val AUCPR: 0.2392
[2025-11-19 09:12:56,667] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:12:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:13:08,168] [INFO] [<frozen importlib] - Optimal threshold: 0.4606
[2025-11-19 09:13:08,168] [INFO] [<frozen importlib] - Best f1: 0.2901
[2025-11-19 09:13:08,168] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:13:08,208] [INFO] [<frozen importlib] - Validation Results (threshold=0.4606):
[2025-11-19 09:13:08,209] [INFO] [<frozen importlib] -   Accuracy: 0.8992
[2025-11-19 09:13:08,209] [INFO] [<frozen importlib] -   Precision: 0.3163
[2025-11-19 09:13:08,209] [INFO] [<frozen importlib] -   Recall: 0.2679
[2025-11-19 09:13:08,209] [INFO] [<frozen importlib] -   F1 Score: 0.2901
[2025-11-19 09:13:08,209] [INFO] [<frozen importlib] -   AUROC: 0.7123
[2025-11-19 09:13:08,209] [INFO] [<frozen importlib] -   AUPRC: 0.2396
[2025-11-19 09:13:08,209] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:13:08,209] [INFO] [<frozen importlib] -     TN=16604, FP=841
[2025-11-19 09:13:08,209] [INFO] [<frozen importlib] -     FN=1063, TP=389
[2025-11-19 09:13:08,232] [INFO] [<frozen importlib] - Trial 308: AUPRC=0.2396, F1=0.4454, Prec=0.4386, Rec=0.4525 | Optimizing auprc=0.2396
                                                                                        Best trial: 289. Best value: 0.241792:  62%|██████▏   | 308/500 [51:06<29:48,  9.32s/it]Best trial: 289. Best value: 0.241792:  62%|██████▏   | 308/500 [51:06<29:48,  9.32s/it]Best trial: 289. Best value: 0.241792:  62%|██████▏   | 309/500 [51:06<32:06, 10.09s/it][2025-11-19 09:13:08,244] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.985333827865759
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   gamma: 0.13562084195972618
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   alpha: 0.34081826890461464
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   lambda: 1.3657115394494217
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   learning_rate: 0.04148717054379014
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   subsample: 0.8349886931150257
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   colsample_bytree: 0.6002929310598332
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5088534058358204
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   colsample_bynode: 0.8018875319800337
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:13:08,245] [INFO] [<frozen importlib] -   scale_pos_weight: 5.985333827865759
[2025-11-19 09:13:08,317] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:13:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:13:08,233] Trial 308 finished with value: 0.239556655063751 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.14191173204925106, 'learning_rate': 0.04032076703622307, 'n_estimators': 250, 'alpha': 0.3835105777008903, 'lambda': 1.355764953775907, 'subsample': 0.8317912892090996, 'colsample_bytree': 0.5995278702429232, 'colsample_bylevel': 0.5263270013178278, 'colsample_bynode': 0.8025301353793161, 'scale_pos_weight': 6.408748985034967}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.64280	train-auc:0.64292	train-aucpr:0.25050	val-logloss:0.63377	val-auc:0.58335	val-aucpr:0.11310
[10]	train-logloss:0.61912	train-auc:0.68173	train-aucpr:0.29200	val-logloss:0.57385	val-auc:0.67883	val-aucpr:0.18502
[20]	train-logloss:0.60479	train-auc:0.68775	train-aucpr:0.30059	val-logloss:0.53713	val-auc:0.67767	val-aucpr:0.20456
[30]	train-logloss:0.59514	train-auc:0.69396	train-aucpr:0.30736	val-logloss:0.50912	val-auc:0.70326	val-aucpr:0.21571
[40]	train-logloss:0.58837	train-auc:0.69948	train-aucpr:0.31191	val-logloss:0.49093	val-auc:0.71100	val-aucpr:0.22397
[50]	train-logloss:0.58315	train-auc:0.70271	train-aucpr:0.31487	val-logloss:0.47623	val-auc:0.70560	val-aucpr:0.22267
[60]	train-logloss:0.57936	train-auc:0.70677	train-aucpr:0.31902	val-logloss:0.47514	val-auc:0.71068	val-aucpr:0.22441
[70]	train-logloss:0.57604	train-auc:0.71030	train-aucpr:0.32380	val-logloss:0.46355	val-auc:0.70788	val-aucpr:0.22291
[80]	train-logloss:0.57285	train-auc:0.71577	train-aucpr:0.32982	val-logloss:0.46548	val-auc:0.70389	val-aucpr:0.21549
[84]	train-logloss:0.57185	train-auc:0.71687	train-aucpr:0.33112	val-logloss:0.46397	val-auc:0.70311	val-aucpr:0.21514
[2025-11-19 09:13:08,565] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 09:13:08,565] [INFO] [<frozen importlib] - Best train loss: 0.5813
[2025-11-19 09:13:08,565] [INFO] [<frozen importlib] - Best val loss: 0.4764
[2025-11-19 09:13:08,565] [INFO] [<frozen importlib] - Best val AUC: 0.7113
[2025-11-19 09:13:08,565] [INFO] [<frozen importlib] - Best val AUCPR: 0.2278
[2025-11-19 09:13:08,570] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:13:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:13:20,931] [INFO] [<frozen importlib] - Optimal threshold: 0.4555
[2025-11-19 09:13:20,931] [INFO] [<frozen importlib] - Best f1: 0.2828
[2025-11-19 09:13:20,931] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:13:20,974] [INFO] [<frozen importlib] - Validation Results (threshold=0.4555):
[2025-11-19 09:13:20,975] [INFO] [<frozen importlib] -   Accuracy: 0.8991
[2025-11-19 09:13:20,975] [INFO] [<frozen importlib] -   Precision: 0.3115
[2025-11-19 09:13:20,975] [INFO] [<frozen importlib] -   Recall: 0.2590
[2025-11-19 09:13:20,975] [INFO] [<frozen importlib] -   F1 Score: 0.2828
[2025-11-19 09:13:20,975] [INFO] [<frozen importlib] -   AUROC: 0.7113
[2025-11-19 09:13:20,975] [INFO] [<frozen importlib] -   AUPRC: 0.2282
[2025-11-19 09:13:20,975] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:13:20,975] [INFO] [<frozen importlib] -     TN=16614, FP=831
[2025-11-19 09:13:20,975] [INFO] [<frozen importlib] -     FN=1076, TP=376
[2025-11-19 09:13:21,002] [INFO] [<frozen importlib] - Trial 309: AUPRC=0.2282, F1=0.4538, Prec=0.4464, Rec=0.4614 | Optimizing auprc=0.2282
                                                                                        Best trial: 289. Best value: 0.241792:  62%|██████▏   | 309/500 [51:18<32:06, 10.09s/it]Best trial: 289. Best value: 0.241792:  62%|██████▏   | 309/500 [51:18<32:06, 10.09s/it]Best trial: 289. Best value: 0.241792:  62%|██████▏   | 310/500 [51:18<34:29, 10.89s/it][2025-11-19 09:13:21,026] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.369562372684178
[2025-11-19 09:13:21,026] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:13:21,026] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:13:21,026] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:13:21,026] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:13:21,026] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:13:21,026] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:13:21,026] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:13:21,026] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:13:21,026] [INFO] [<frozen importlib] -   gamma: 0.1375466829390643
[2025-11-19 09:13:21,026] [INFO] [<frozen importlib] -   alpha: 0.38849424231158447
[2025-11-19 09:13:21,027] [INFO] [<frozen importlib] -   lambda: 1.2826069773770337
[2025-11-19 09:13:21,027] [INFO] [<frozen importlib] -   learning_rate: 0.040447723821709795
[2025-11-19 09:13:21,027] [INFO] [<frozen importlib] -   subsample: 0.8544799651253175
[2025-11-19 09:13:21,027] [INFO] [<frozen importlib] -   colsample_bytree: 0.5944138992930279
[2025-11-19 09:13:21,027] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5247789195354279
[2025-11-19 09:13:21,027] [INFO] [<frozen importlib] -   colsample_bynode: 0.8220456109041764
[2025-11-19 09:13:21,027] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:13:21,027] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:13:21,027] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:13:21,027] [INFO] [<frozen importlib] -   scale_pos_weight: 6.369562372684178
[2025-11-19 09:13:21,106] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:13:21] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:13:21,003] Trial 309 finished with value: 0.22824788102752547 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.13562084195972618, 'learning_rate': 0.04148717054379014, 'n_estimators': 250, 'alpha': 0.34081826890461464, 'lambda': 1.3657115394494217, 'subsample': 0.8349886931150257, 'colsample_bytree': 0.6002929310598332, 'colsample_bylevel': 0.5088534058358204, 'colsample_bynode': 0.8018875319800337, 'scale_pos_weight': 5.985333827865759}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.66458	train-auc:0.63857	train-aucpr:0.22153	val-logloss:0.65671	val-auc:0.61553	val-aucpr:0.12776
[10]	train-logloss:0.64017	train-auc:0.68152	train-aucpr:0.28676	val-logloss:0.60452	val-auc:0.66648	val-aucpr:0.17255
[20]	train-logloss:0.62511	train-auc:0.68798	train-aucpr:0.29923	val-logloss:0.57075	val-auc:0.66857	val-aucpr:0.19419
[30]	train-logloss:0.61508	train-auc:0.69262	train-aucpr:0.30495	val-logloss:0.53736	val-auc:0.67663	val-aucpr:0.21189
[40]	train-logloss:0.60829	train-auc:0.69661	train-aucpr:0.30948	val-logloss:0.51994	val-auc:0.70516	val-aucpr:0.22820
[50]	train-logloss:0.60288	train-auc:0.70144	train-aucpr:0.31397	val-logloss:0.49768	val-auc:0.70413	val-aucpr:0.23042
[60]	train-logloss:0.59875	train-auc:0.70575	train-aucpr:0.31904	val-logloss:0.50316	val-auc:0.70020	val-aucpr:0.22643
[70]	train-logloss:0.59565	train-auc:0.70860	train-aucpr:0.32260	val-logloss:0.50385	val-auc:0.69286	val-aucpr:0.21282
[74]	train-logloss:0.59454	train-auc:0.71001	train-aucpr:0.32476	val-logloss:0.50410	val-auc:0.68837	val-aucpr:0.20867
[2025-11-19 09:13:21,334] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 09:13:21,334] [INFO] [<frozen importlib] - Best train loss: 0.6052
[2025-11-19 09:13:21,334] [INFO] [<frozen importlib] - Best val loss: 0.5043
[2025-11-19 09:13:21,334] [INFO] [<frozen importlib] - Best val AUC: 0.7065
[2025-11-19 09:13:21,334] [INFO] [<frozen importlib] - Best val AUCPR: 0.2310
[2025-11-19 09:13:21,339] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:13:21] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:13:31,453] [INFO] [<frozen importlib] - Optimal threshold: 0.4710
[2025-11-19 09:13:31,453] [INFO] [<frozen importlib] - Best f1: 0.2847
[2025-11-19 09:13:31,453] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:13:31,497] [INFO] [<frozen importlib] - Validation Results (threshold=0.4710):
[2025-11-19 09:13:31,498] [INFO] [<frozen importlib] -   Accuracy: 0.9051
[2025-11-19 09:13:31,498] [INFO] [<frozen importlib] -   Precision: 0.3381
[2025-11-19 09:13:31,498] [INFO] [<frozen importlib] -   Recall: 0.2459
[2025-11-19 09:13:31,498] [INFO] [<frozen importlib] -   F1 Score: 0.2847
[2025-11-19 09:13:31,498] [INFO] [<frozen importlib] -   AUROC: 0.7065
[2025-11-19 09:13:31,498] [INFO] [<frozen importlib] -   AUPRC: 0.2314
[2025-11-19 09:13:31,498] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:13:31,498] [INFO] [<frozen importlib] -     TN=16746, FP=699
[2025-11-19 09:13:31,498] [INFO] [<frozen importlib] -     FN=1095, TP=357
[2025-11-19 09:13:31,523] [INFO] [<frozen importlib] - Trial 310: AUPRC=0.2314, F1=0.4581, Prec=0.4776, Rec=0.4401 | Optimizing auprc=0.2314
[2025-11-19 09:13:31,523] [INFO] [<frozen importlib] - Trial 310 pruned.
[2025-11-19 09:13:31,523] [ERROR] [<frozen importlib] - Trial 310 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  62%|██████▏   | 310/500 [51:29<34:29, 10.89s/it]Best trial: 289. Best value: 0.241792:  62%|██████▏   | 310/500 [51:29<34:29, 10.89s/it]Best trial: 289. Best value: 0.241792:  62%|██████▏   | 311/500 [51:29<33:57, 10.78s/it][2025-11-19 09:13:31,536] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.589122274359566
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   gamma: 0.15338237418901232
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   alpha: 0.30730148814338815
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   lambda: 1.469508521285133
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   learning_rate: 0.03259405882022068
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   subsample: 0.8312784495573137
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   colsample_bytree: 0.6068583492203873
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5009258360698816
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   colsample_bynode: 0.7935054941291655
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:13:31,536] [INFO] [<frozen importlib] -   scale_pos_weight: 5.589122274359566
[2025-11-19 09:13:31,609] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:13:31] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:13:31,523] Trial 310 pruned. 
[0]	train-logloss:0.62107	train-auc:0.64292	train-aucpr:0.25055	val-logloss:0.60920	val-auc:0.58335	val-aucpr:0.11310
[10]	train-logloss:0.60211	train-auc:0.68132	train-aucpr:0.29173	val-logloss:0.56273	val-auc:0.67844	val-aucpr:0.18412
[20]	train-logloss:0.58973	train-auc:0.68549	train-aucpr:0.29726	val-logloss:0.53110	val-auc:0.67474	val-aucpr:0.19922
[30]	train-logloss:0.58080	train-auc:0.68965	train-aucpr:0.30275	val-logloss:0.50451	val-auc:0.68761	val-aucpr:0.21197
[40]	train-logloss:0.57416	train-auc:0.69432	train-aucpr:0.30747	val-logloss:0.47777	val-auc:0.70209	val-aucpr:0.21801
[50]	train-logloss:0.56884	train-auc:0.69717	train-aucpr:0.31080	val-logloss:0.46704	val-auc:0.69910	val-aucpr:0.22074
[60]	train-logloss:0.56507	train-auc:0.70065	train-aucpr:0.31435	val-logloss:0.45922	val-auc:0.70276	val-aucpr:0.22421
[70]	train-logloss:0.56171	train-auc:0.70462	train-aucpr:0.31791	val-logloss:0.45853	val-auc:0.70545	val-aucpr:0.21953
[80]	train-logloss:0.55886	train-auc:0.70882	train-aucpr:0.32222	val-logloss:0.45826	val-auc:0.70257	val-aucpr:0.21918
[90]	train-logloss:0.55647	train-auc:0.71193	train-aucpr:0.32579	val-logloss:0.45219	val-auc:0.70501	val-aucpr:0.22145
[91]	train-logloss:0.55623	train-auc:0.71266	train-aucpr:0.32612	val-logloss:0.45206	val-auc:0.70514	val-aucpr:0.22175
[2025-11-19 09:13:31,865] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:13:31,865] [INFO] [<frozen importlib] - Best train loss: 0.5644
[2025-11-19 09:13:31,865] [INFO] [<frozen importlib] - Best val loss: 0.4609
[2025-11-19 09:13:31,865] [INFO] [<frozen importlib] - Best val AUC: 0.7028
[2025-11-19 09:13:31,865] [INFO] [<frozen importlib] - Best val AUCPR: 0.2242
[2025-11-19 09:13:31,870] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:13:31] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:13:44,691] [INFO] [<frozen importlib] - Optimal threshold: 0.4316
[2025-11-19 09:13:44,691] [INFO] [<frozen importlib] - Best f1: 0.2707
[2025-11-19 09:13:44,691] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:13:44,734] [INFO] [<frozen importlib] - Validation Results (threshold=0.4316):
[2025-11-19 09:13:44,734] [INFO] [<frozen importlib] -   Accuracy: 0.8882
[2025-11-19 09:13:44,734] [INFO] [<frozen importlib] -   Precision: 0.2715
[2025-11-19 09:13:44,734] [INFO] [<frozen importlib] -   Recall: 0.2700
[2025-11-19 09:13:44,734] [INFO] [<frozen importlib] -   F1 Score: 0.2707
[2025-11-19 09:13:44,734] [INFO] [<frozen importlib] -   AUROC: 0.7028
[2025-11-19 09:13:44,734] [INFO] [<frozen importlib] -   AUPRC: 0.2246
[2025-11-19 09:13:44,734] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:13:44,734] [INFO] [<frozen importlib] -     TN=16393, FP=1052
[2025-11-19 09:13:44,734] [INFO] [<frozen importlib] -     FN=1060, TP=392
[2025-11-19 09:13:44,756] [INFO] [<frozen importlib] - Trial 311: AUPRC=0.2246, F1=0.4408, Prec=0.4023, Rec=0.4876 | Optimizing auprc=0.2246
[2025-11-19 09:13:44,756] [INFO] [<frozen importlib] - Trial 311 pruned.
[2025-11-19 09:13:44,756] [ERROR] [<frozen importlib] - Trial 311 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  62%|██████▏   | 311/500 [51:42<33:57, 10.78s/it]Best trial: 289. Best value: 0.241792:  62%|██████▏   | 311/500 [51:42<33:57, 10.78s/it]Best trial: 289. Best value: 0.241792:  62%|██████▏   | 312/500 [51:42<36:05, 11.52s/it][2025-11-19 09:13:44,769] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.062590775590885
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   gamma: 0.10330813837476906
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   alpha: 0.40479120756130227
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   lambda: 1.2171962416835846
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   learning_rate: 0.03947256936753853
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   subsample: 0.8463818122472403
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   colsample_bytree: 0.5883477895952623
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5186060374104113
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   colsample_bynode: 0.8024273198740827
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:13:44,769] [INFO] [<frozen importlib] -   scale_pos_weight: 6.062590775590885
[2025-11-19 09:13:44,840] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:13:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:13:44,756] Trial 311 pruned. 
[0]	train-logloss:0.64766	train-auc:0.62939	train-aucpr:0.22769	val-logloss:0.63975	val-auc:0.62206	val-aucpr:0.13676
[10]	train-logloss:0.62401	train-auc:0.68089	train-aucpr:0.28752	val-logloss:0.58610	val-auc:0.69520	val-aucpr:0.18536
[20]	train-logloss:0.60997	train-auc:0.68732	train-aucpr:0.29941	val-logloss:0.54402	val-auc:0.69575	val-aucpr:0.21283
[30]	train-logloss:0.60053	train-auc:0.69279	train-aucpr:0.30517	val-logloss:0.53162	val-auc:0.69368	val-aucpr:0.22091
[40]	train-logloss:0.59418	train-auc:0.69803	train-aucpr:0.30866	val-logloss:0.52480	val-auc:0.69675	val-aucpr:0.22173
[50]	train-logloss:0.58842	train-auc:0.70286	train-aucpr:0.31415	val-logloss:0.50976	val-auc:0.69990	val-aucpr:0.22129
[60]	train-logloss:0.58414	train-auc:0.70754	train-aucpr:0.31854	val-logloss:0.50220	val-auc:0.69801	val-aucpr:0.22352
[70]	train-logloss:0.58076	train-auc:0.71135	train-aucpr:0.32335	val-logloss:0.50180	val-auc:0.69571	val-aucpr:0.21795
[75]	train-logloss:0.57932	train-auc:0.71329	train-aucpr:0.32519	val-logloss:0.49384	val-auc:0.69461	val-aucpr:0.21701
[2025-11-19 09:13:45,064] [INFO] [<frozen importlib] - Training completed at iteration 46
[2025-11-19 09:13:45,064] [INFO] [<frozen importlib] - Best train loss: 0.5904
[2025-11-19 09:13:45,064] [INFO] [<frozen importlib] - Best val loss: 0.5154
[2025-11-19 09:13:45,064] [INFO] [<frozen importlib] - Best val AUC: 0.6942
[2025-11-19 09:13:45,064] [INFO] [<frozen importlib] - Best val AUCPR: 0.2239
[2025-11-19 09:13:45,069] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:13:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:13:55,420] [INFO] [<frozen importlib] - Optimal threshold: 0.4831
[2025-11-19 09:13:55,420] [INFO] [<frozen importlib] - Best f1: 0.2595
[2025-11-19 09:13:55,420] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:13:55,465] [INFO] [<frozen importlib] - Validation Results (threshold=0.4831):
[2025-11-19 09:13:55,465] [INFO] [<frozen importlib] -   Accuracy: 0.8958
[2025-11-19 09:13:55,465] [INFO] [<frozen importlib] -   Precision: 0.2858
[2025-11-19 09:13:55,466] [INFO] [<frozen importlib] -   Recall: 0.2376
[2025-11-19 09:13:55,466] [INFO] [<frozen importlib] -   F1 Score: 0.2595
[2025-11-19 09:13:55,466] [INFO] [<frozen importlib] -   AUROC: 0.6942
[2025-11-19 09:13:55,466] [INFO] [<frozen importlib] -   AUPRC: 0.2242
[2025-11-19 09:13:55,466] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:13:55,466] [INFO] [<frozen importlib] -     TN=16583, FP=862
[2025-11-19 09:13:55,466] [INFO] [<frozen importlib] -     FN=1107, TP=345
[2025-11-19 09:13:55,489] [INFO] [<frozen importlib] - Trial 312: AUPRC=0.2242, F1=0.4480, Prec=0.4366, Rec=0.4601 | Optimizing auprc=0.2242
[2025-11-19 09:13:55,489] [INFO] [<frozen importlib] - Trial 312 pruned.
[2025-11-19 09:13:55,489] [ERROR] [<frozen importlib] - Trial 312 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  62%|██████▏   | 312/500 [51:53<36:05, 11.52s/it]Best trial: 289. Best value: 0.241792:  62%|██████▏   | 312/500 [51:53<36:05, 11.52s/it]Best trial: 289. Best value: 0.241792:  63%|██████▎   | 313/500 [51:53<35:09, 11.28s/it][2025-11-19 09:13:55,502] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.344184985977198
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   gamma: 0.17148346020062005
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   alpha: 0.36870421184411645
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   lambda: 1.3378830348930273
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   learning_rate: 0.03182700837950473
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   subsample: 0.8282999673374325
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   colsample_bytree: 0.5977697644364185
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5946140382698668
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   colsample_bynode: 0.7979327742552418
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:13:55,502] [INFO] [<frozen importlib] -   scale_pos_weight: 6.344184985977198
[2025-11-19 09:13:55,577] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:13:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:13:55,489] Trial 312 pruned. 
[0]	train-logloss:0.66350	train-auc:0.64534	train-aucpr:0.24634	val-logloss:0.65542	val-auc:0.64961	val-aucpr:0.13526
[10]	train-logloss:0.64288	train-auc:0.68092	train-aucpr:0.28842	val-logloss:0.61222	val-auc:0.66770	val-aucpr:0.17701
[20]	train-logloss:0.62950	train-auc:0.68569	train-aucpr:0.29621	val-logloss:0.57699	val-auc:0.70036	val-aucpr:0.20581
[30]	train-logloss:0.61978	train-auc:0.69067	train-aucpr:0.30226	val-logloss:0.55079	val-auc:0.70331	val-aucpr:0.21769
[40]	train-logloss:0.61288	train-auc:0.69464	train-aucpr:0.30551	val-logloss:0.52584	val-auc:0.70939	val-aucpr:0.22187
[50]	train-logloss:0.60703	train-auc:0.69753	train-aucpr:0.31001	val-logloss:0.51149	val-auc:0.71167	val-aucpr:0.22431
[60]	train-logloss:0.60266	train-auc:0.70057	train-aucpr:0.31382	val-logloss:0.50761	val-auc:0.71068	val-aucpr:0.22526
[70]	train-logloss:0.59919	train-auc:0.70385	train-aucpr:0.31585	val-logloss:0.50798	val-auc:0.70374	val-aucpr:0.22006
[80]	train-logloss:0.59624	train-auc:0.70692	train-aucpr:0.31938	val-logloss:0.49941	val-auc:0.70138	val-aucpr:0.21572
[86]	train-logloss:0.59471	train-auc:0.70862	train-aucpr:0.32113	val-logloss:0.49984	val-auc:0.69845	val-aucpr:0.21136
[2025-11-19 09:13:55,831] [INFO] [<frozen importlib] - Training completed at iteration 57
[2025-11-19 09:13:55,831] [INFO] [<frozen importlib] - Best train loss: 0.6039
[2025-11-19 09:13:55,831] [INFO] [<frozen importlib] - Best val loss: 0.5116
[2025-11-19 09:13:55,831] [INFO] [<frozen importlib] - Best val AUC: 0.7124
[2025-11-19 09:13:55,831] [INFO] [<frozen importlib] - Best val AUCPR: 0.2263
[2025-11-19 09:13:55,836] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:13:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:14:05,477] [INFO] [<frozen importlib] - Optimal threshold: 0.4612
[2025-11-19 09:14:05,478] [INFO] [<frozen importlib] - Best f1: 0.2864
[2025-11-19 09:14:05,478] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:14:05,517] [INFO] [<frozen importlib] - Validation Results (threshold=0.4612):
[2025-11-19 09:14:05,517] [INFO] [<frozen importlib] -   Accuracy: 0.8839
[2025-11-19 09:14:05,517] [INFO] [<frozen importlib] -   Precision: 0.2714
[2025-11-19 09:14:05,517] [INFO] [<frozen importlib] -   Recall: 0.3030
[2025-11-19 09:14:05,517] [INFO] [<frozen importlib] -   F1 Score: 0.2864
[2025-11-19 09:14:05,517] [INFO] [<frozen importlib] -   AUROC: 0.7124
[2025-11-19 09:14:05,517] [INFO] [<frozen importlib] -   AUPRC: 0.2269
[2025-11-19 09:14:05,517] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:14:05,517] [INFO] [<frozen importlib] -     TN=16264, FP=1181
[2025-11-19 09:14:05,517] [INFO] [<frozen importlib] -     FN=1012, TP=440
[2025-11-19 09:14:05,540] [INFO] [<frozen importlib] - Trial 313: AUPRC=0.2269, F1=0.4388, Prec=0.3852, Rec=0.5096 | Optimizing auprc=0.2269
[2025-11-19 09:14:05,540] [INFO] [<frozen importlib] - Trial 313 pruned.
[2025-11-19 09:14:05,540] [ERROR] [<frozen importlib] - Trial 313 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  63%|██████▎   | 313/500 [52:03<35:09, 11.28s/it]Best trial: 289. Best value: 0.241792:  63%|██████▎   | 313/500 [52:03<35:09, 11.28s/it]Best trial: 289. Best value: 0.241792:  63%|██████▎   | 314/500 [52:03<33:49, 10.91s/it][2025-11-19 09:14:05,552] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 17.904088004023123
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   gamma: 0.20202489013908312
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   alpha: 0.4246549155255315
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   lambda: 1.0920590359116034
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   learning_rate: 0.11863044146510025
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   subsample: 0.8391573373204734
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   colsample_bytree: 0.6185688539399536
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5176060717716234
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   colsample_bynode: 0.8134758432533821
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:14:05,552] [INFO] [<frozen importlib] -   scale_pos_weight: 17.904088004023123
[2025-11-19 09:14:05,626] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:14:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:14:05,540] Trial 313 pruned. 
[0]	train-logloss:1.10463	train-auc:0.65023	train-aucpr:0.23105	val-logloss:1.10645	val-auc:0.65908	val-aucpr:0.13035
[10]	train-logloss:1.04660	train-auc:0.68692	train-aucpr:0.30097	val-logloss:0.90271	val-auc:0.68721	val-aucpr:0.19629
[20]	train-logloss:1.02562	train-auc:0.70597	train-aucpr:0.31245	val-logloss:0.84259	val-auc:0.68624	val-aucpr:0.20389
[30]	train-logloss:1.01282	train-auc:0.71545	train-aucpr:0.32306	val-logloss:0.75479	val-auc:0.66124	val-aucpr:0.16009
[40]	train-logloss:1.00035	train-auc:0.72732	train-aucpr:0.33431	val-logloss:0.72407	val-auc:0.66641	val-aucpr:0.16644
[48]	train-logloss:0.98905	train-auc:0.73691	train-aucpr:0.34192	val-logloss:0.66999	val-auc:0.64430	val-aucpr:0.13086
[2025-11-19 09:14:05,788] [INFO] [<frozen importlib] - Training completed at iteration 19
[2025-11-19 09:14:05,788] [INFO] [<frozen importlib] - Best train loss: 1.0277
[2025-11-19 09:14:05,788] [INFO] [<frozen importlib] - Best val loss: 0.8482
[2025-11-19 09:14:05,788] [INFO] [<frozen importlib] - Best val AUC: 0.6869
[2025-11-19 09:14:05,788] [INFO] [<frozen importlib] - Best val AUCPR: 0.2043
[2025-11-19 09:14:05,792] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:14:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:14:11,551] [INFO] [<frozen importlib] - Optimal threshold: 0.7071
[2025-11-19 09:14:11,551] [INFO] [<frozen importlib] - Best f1: 0.2407
[2025-11-19 09:14:11,551] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:14:11,594] [INFO] [<frozen importlib] - Validation Results (threshold=0.7071):
[2025-11-19 09:14:11,594] [INFO] [<frozen importlib] -   Accuracy: 0.8698
[2025-11-19 09:14:11,594] [INFO] [<frozen importlib] -   Precision: 0.2181
[2025-11-19 09:14:11,594] [INFO] [<frozen importlib] -   Recall: 0.2686
[2025-11-19 09:14:11,595] [INFO] [<frozen importlib] -   F1 Score: 0.2407
[2025-11-19 09:14:11,595] [INFO] [<frozen importlib] -   AUROC: 0.6869
[2025-11-19 09:14:11,595] [INFO] [<frozen importlib] -   AUPRC: 0.2048
[2025-11-19 09:14:11,595] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:14:11,595] [INFO] [<frozen importlib] -     TN=16047, FP=1398
[2025-11-19 09:14:11,595] [INFO] [<frozen importlib] -     FN=1062, TP=390
[2025-11-19 09:14:11,620] [INFO] [<frozen importlib] - Trial 314: AUPRC=0.2048, F1=0.4276, Prec=0.3566, Rec=0.5337 | Optimizing auprc=0.2048
[2025-11-19 09:14:11,620] [INFO] [<frozen importlib] - Trial 314 pruned.
[2025-11-19 09:14:11,620] [ERROR] [<frozen importlib] - Trial 314 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  63%|██████▎   | 314/500 [52:09<33:49, 10.91s/it]Best trial: 289. Best value: 0.241792:  63%|██████▎   | 314/500 [52:09<33:49, 10.91s/it]Best trial: 289. Best value: 0.241792:  63%|██████▎   | 315/500 [52:09<29:10,  9.46s/it][2025-11-19 09:14:11,632] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.803935439166655
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   gamma: 0.05817278010851172
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   alpha: 0.4580109686100848
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   lambda: 1.158772292904353
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   learning_rate: 0.0419926827908977
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   subsample: 0.81340342212347
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   colsample_bytree: 0.6048258592285961
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   colsample_bylevel: 0.509237849451273
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   colsample_bynode: 0.7903019242032135
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:14:11,633] [INFO] [<frozen importlib] -   scale_pos_weight: 5.803935439166655
[2025-11-19 09:14:11,706] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:14:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:14:11,620] Trial 314 pruned. 
[0]	train-logloss:0.63250	train-auc:0.64332	train-aucpr:0.25530	val-logloss:0.62198	val-auc:0.58551	val-aucpr:0.11209
[10]	train-logloss:0.60905	train-auc:0.68231	train-aucpr:0.29188	val-logloss:0.56331	val-auc:0.67796	val-aucpr:0.18835
[20]	train-logloss:0.59497	train-auc:0.68812	train-aucpr:0.30067	val-logloss:0.52790	val-auc:0.67584	val-aucpr:0.20105
[30]	train-logloss:0.58560	train-auc:0.69439	train-aucpr:0.30691	val-logloss:0.49885	val-auc:0.68356	val-aucpr:0.21487
[40]	train-logloss:0.57925	train-auc:0.69957	train-aucpr:0.31094	val-logloss:0.47333	val-auc:0.70099	val-aucpr:0.22882
[50]	train-logloss:0.57395	train-auc:0.70278	train-aucpr:0.31490	val-logloss:0.45754	val-auc:0.69648	val-aucpr:0.22827
[60]	train-logloss:0.57044	train-auc:0.70656	train-aucpr:0.31896	val-logloss:0.45458	val-auc:0.70532	val-aucpr:0.22944
[70]	train-logloss:0.56724	train-auc:0.71008	train-aucpr:0.32384	val-logloss:0.46101	val-auc:0.70365	val-aucpr:0.21847
[80]	train-logloss:0.56427	train-auc:0.71491	train-aucpr:0.32822	val-logloss:0.45299	val-auc:0.69844	val-aucpr:0.21534
[85]	train-logloss:0.56301	train-auc:0.71697	train-aucpr:0.33032	val-logloss:0.45186	val-auc:0.69896	val-aucpr:0.21500
[2025-11-19 09:14:11,956] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:14:11,956] [INFO] [<frozen importlib] - Best train loss: 0.5718
[2025-11-19 09:14:11,956] [INFO] [<frozen importlib] - Best val loss: 0.4540
[2025-11-19 09:14:11,956] [INFO] [<frozen importlib] - Best val AUC: 0.7049
[2025-11-19 09:14:11,956] [INFO] [<frozen importlib] - Best val AUCPR: 0.2316
[2025-11-19 09:14:11,961] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:14:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:14:25,033] [INFO] [<frozen importlib] - Optimal threshold: 0.4270
[2025-11-19 09:14:25,033] [INFO] [<frozen importlib] - Best f1: 0.2832
[2025-11-19 09:14:25,033] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:14:25,077] [INFO] [<frozen importlib] - Validation Results (threshold=0.4270):
[2025-11-19 09:14:25,077] [INFO] [<frozen importlib] -   Accuracy: 0.8931
[2025-11-19 09:14:25,077] [INFO] [<frozen importlib] -   Precision: 0.2921
[2025-11-19 09:14:25,077] [INFO] [<frozen importlib] -   Recall: 0.2748
[2025-11-19 09:14:25,077] [INFO] [<frozen importlib] -   F1 Score: 0.2832
[2025-11-19 09:14:25,077] [INFO] [<frozen importlib] -   AUROC: 0.7049
[2025-11-19 09:14:25,077] [INFO] [<frozen importlib] -   AUPRC: 0.2320
[2025-11-19 09:14:25,077] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:14:25,077] [INFO] [<frozen importlib] -     TN=16478, FP=967
[2025-11-19 09:14:25,077] [INFO] [<frozen importlib] -     FN=1053, TP=399
[2025-11-19 09:14:25,101] [INFO] [<frozen importlib] - Trial 315: AUPRC=0.2320, F1=0.4484, Prec=0.4196, Rec=0.4814 | Optimizing auprc=0.2320
                                                                                        Best trial: 289. Best value: 0.241792:  63%|██████▎   | 315/500 [52:23<29:10,  9.46s/it]Best trial: 289. Best value: 0.241792:  63%|██████▎   | 315/500 [52:23<29:10,  9.46s/it]Best trial: 289. Best value: 0.241792:  63%|██████▎   | 316/500 [52:23<32:42, 10.67s/it][2025-11-19 09:14:25,123] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.639690274231807
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   gamma: 0.14941932802705435
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   alpha: 0.5017394157581783
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   lambda: 1.4276181477818017
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   learning_rate: 0.03335269769908863
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   subsample: 0.8248956200423795
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   colsample_bytree: 0.5899489403898338
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5271237745830347
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   colsample_bynode: 0.8079846187506925
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:14:25,123] [INFO] [<frozen importlib] -   scale_pos_weight: 6.639690274231807
[2025-11-19 09:14:25,205] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:14:25] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:14:25,102] Trial 315 finished with value: 0.23199414449262096 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.05817278010851172, 'learning_rate': 0.0419926827908977, 'n_estimators': 250, 'alpha': 0.4580109686100848, 'lambda': 1.158772292904353, 'subsample': 0.81340342212347, 'colsample_bytree': 0.6048258592285961, 'colsample_bylevel': 0.509237849451273, 'colsample_bynode': 0.7903019242032135, 'scale_pos_weight': 5.803935439166655}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.68001	train-auc:0.62992	train-aucpr:0.22765	val-logloss:0.67642	val-auc:0.61044	val-aucpr:0.12564
[10]	train-logloss:0.65756	train-auc:0.67993	train-aucpr:0.28643	val-logloss:0.62564	val-auc:0.68829	val-aucpr:0.18680
[20]	train-logloss:0.64377	train-auc:0.68623	train-aucpr:0.29677	val-logloss:0.59340	val-auc:0.67996	val-aucpr:0.20634
[30]	train-logloss:0.63385	train-auc:0.69128	train-aucpr:0.30269	val-logloss:0.57348	val-auc:0.70064	val-aucpr:0.21686
[40]	train-logloss:0.62685	train-auc:0.69599	train-aucpr:0.30631	val-logloss:0.55348	val-auc:0.69679	val-aucpr:0.21550
[50]	train-logloss:0.62076	train-auc:0.69990	train-aucpr:0.31148	val-logloss:0.54364	val-auc:0.69592	val-aucpr:0.21685
[60]	train-logloss:0.61649	train-auc:0.70338	train-aucpr:0.31510	val-logloss:0.53975	val-auc:0.69346	val-aucpr:0.21847
[70]	train-logloss:0.61273	train-auc:0.70734	train-aucpr:0.31882	val-logloss:0.53538	val-auc:0.69120	val-aucpr:0.21564
[80]	train-logloss:0.60936	train-auc:0.71073	train-aucpr:0.32252	val-logloss:0.52455	val-auc:0.69168	val-aucpr:0.21613
[90]	train-logloss:0.60654	train-auc:0.71358	train-aucpr:0.32569	val-logloss:0.52673	val-auc:0.69167	val-aucpr:0.21003
[95]	train-logloss:0.60542	train-auc:0.71541	train-aucpr:0.32731	val-logloss:0.51853	val-auc:0.68958	val-aucpr:0.20861
[2025-11-19 09:14:25,477] [INFO] [<frozen importlib] - Training completed at iteration 65
[2025-11-19 09:14:25,477] [INFO] [<frozen importlib] - Best train loss: 0.6145
[2025-11-19 09:14:25,477] [INFO] [<frozen importlib] - Best val loss: 0.5318
[2025-11-19 09:14:25,477] [INFO] [<frozen importlib] - Best val AUC: 0.6935
[2025-11-19 09:14:25,477] [INFO] [<frozen importlib] - Best val AUCPR: 0.2190
[2025-11-19 09:14:25,482] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:14:25] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:14:38,338] [INFO] [<frozen importlib] - Optimal threshold: 0.4928
[2025-11-19 09:14:38,338] [INFO] [<frozen importlib] - Best f1: 0.2675
[2025-11-19 09:14:38,338] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:14:38,381] [INFO] [<frozen importlib] - Validation Results (threshold=0.4928):
[2025-11-19 09:14:38,381] [INFO] [<frozen importlib] -   Accuracy: 0.8965
[2025-11-19 09:14:38,381] [INFO] [<frozen importlib] -   Precision: 0.2933
[2025-11-19 09:14:38,381] [INFO] [<frozen importlib] -   Recall: 0.2459
[2025-11-19 09:14:38,381] [INFO] [<frozen importlib] -   F1 Score: 0.2675
[2025-11-19 09:14:38,381] [INFO] [<frozen importlib] -   AUROC: 0.6935
[2025-11-19 09:14:38,381] [INFO] [<frozen importlib] -   AUPRC: 0.2195
[2025-11-19 09:14:38,381] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:14:38,382] [INFO] [<frozen importlib] -     TN=16585, FP=860
[2025-11-19 09:14:38,382] [INFO] [<frozen importlib] -     FN=1095, TP=357
[2025-11-19 09:14:38,403] [INFO] [<frozen importlib] - Trial 316: AUPRC=0.2195, F1=0.4514, Prec=0.4394, Rec=0.4642 | Optimizing auprc=0.2195
[2025-11-19 09:14:38,403] [INFO] [<frozen importlib] - Trial 316 pruned.
[2025-11-19 09:14:38,403] [ERROR] [<frozen importlib] - Trial 316 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  63%|██████▎   | 316/500 [52:36<32:42, 10.67s/it]Best trial: 289. Best value: 0.241792:  63%|██████▎   | 316/500 [52:36<32:42, 10.67s/it]Best trial: 289. Best value: 0.241792:  63%|██████▎   | 317/500 [52:36<34:56, 11.46s/it][2025-11-19 09:14:38,415] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.75350085998743
[2025-11-19 09:14:38,415] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   gamma: 0.12277633209310354
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   alpha: 0.3196170135898947
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   lambda: 1.0351607511239276
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   learning_rate: 0.039756466276678205
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   subsample: 0.8660694880974228
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   colsample_bytree: 0.5825450671364424
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5081017173629933
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   colsample_bynode: 0.7861098689179586
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:14:38,416] [INFO] [<frozen importlib] -   scale_pos_weight: 6.75350085998743
[2025-11-19 09:14:38,492] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:14:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:14:38,403] Trial 316 pruned. 
[0]	train-logloss:0.68552	train-auc:0.64222	train-aucpr:0.23333	val-logloss:0.68178	val-auc:0.61921	val-aucpr:0.13123
[10]	train-logloss:0.66004	train-auc:0.68268	train-aucpr:0.29228	val-logloss:0.62084	val-auc:0.70031	val-aucpr:0.19809
[20]	train-logloss:0.64466	train-auc:0.68962	train-aucpr:0.29992	val-logloss:0.57868	val-auc:0.70569	val-aucpr:0.21859
[30]	train-logloss:0.63427	train-auc:0.69513	train-aucpr:0.30713	val-logloss:0.54946	val-auc:0.70181	val-aucpr:0.22347
[40]	train-logloss:0.62726	train-auc:0.70014	train-aucpr:0.31061	val-logloss:0.53670	val-auc:0.70262	val-aucpr:0.22308
[50]	train-logloss:0.62168	train-auc:0.70377	train-aucpr:0.31460	val-logloss:0.52381	val-auc:0.70329	val-aucpr:0.22817
[60]	train-logloss:0.61773	train-auc:0.70722	train-aucpr:0.31743	val-logloss:0.52079	val-auc:0.70631	val-aucpr:0.22806
[70]	train-logloss:0.61422	train-auc:0.71101	train-aucpr:0.32103	val-logloss:0.50868	val-auc:0.70710	val-aucpr:0.22481
[80]	train-logloss:0.61100	train-auc:0.71493	train-aucpr:0.32594	val-logloss:0.48933	val-auc:0.70994	val-aucpr:0.22166
[83]	train-logloss:0.61009	train-auc:0.71617	train-aucpr:0.32685	val-logloss:0.48768	val-auc:0.71112	val-aucpr:0.22146
[2025-11-19 09:14:38,744] [INFO] [<frozen importlib] - Training completed at iteration 54
[2025-11-19 09:14:38,744] [INFO] [<frozen importlib] - Best train loss: 0.6200
[2025-11-19 09:14:38,744] [INFO] [<frozen importlib] - Best val loss: 0.5196
[2025-11-19 09:14:38,744] [INFO] [<frozen importlib] - Best val AUC: 0.7042
[2025-11-19 09:14:38,744] [INFO] [<frozen importlib] - Best val AUCPR: 0.2290
[2025-11-19 09:14:38,749] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:14:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:14:50,916] [INFO] [<frozen importlib] - Optimal threshold: 0.5139
[2025-11-19 09:14:50,916] [INFO] [<frozen importlib] - Best f1: 0.2649
[2025-11-19 09:14:50,916] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:14:50,962] [INFO] [<frozen importlib] - Validation Results (threshold=0.5139):
[2025-11-19 09:14:50,962] [INFO] [<frozen importlib] -   Accuracy: 0.9078
[2025-11-19 09:14:50,962] [INFO] [<frozen importlib] -   Precision: 0.3417
[2025-11-19 09:14:50,962] [INFO] [<frozen importlib] -   Recall: 0.2163
[2025-11-19 09:14:50,962] [INFO] [<frozen importlib] -   F1 Score: 0.2649
[2025-11-19 09:14:50,962] [INFO] [<frozen importlib] -   AUROC: 0.7042
[2025-11-19 09:14:50,962] [INFO] [<frozen importlib] -   AUPRC: 0.2293
[2025-11-19 09:14:50,962] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:14:50,962] [INFO] [<frozen importlib] -     TN=16840, FP=605
[2025-11-19 09:14:50,962] [INFO] [<frozen importlib] -     FN=1138, TP=314
[2025-11-19 09:14:50,984] [INFO] [<frozen importlib] - Trial 317: AUPRC=0.2293, F1=0.4632, Prec=0.5061, Rec=0.4270 | Optimizing auprc=0.2293
                                                                                        Best trial: 289. Best value: 0.241792:  63%|██████▎   | 317/500 [52:48<34:56, 11.46s/it]Best trial: 289. Best value: 0.241792:  63%|██████▎   | 317/500 [52:48<34:56, 11.46s/it]Best trial: 289. Best value: 0.241792:  64%|██████▎   | 318/500 [52:48<35:46, 11.80s/it][2025-11-19 09:14:50,996] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.143829777113951
[2025-11-19 09:14:50,996] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:14:50,996] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:14:50,996] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:14:50,996] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   gamma: 0.08399366059734646
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   alpha: 0.38408784663725254
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   lambda: 1.2156575785964996
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   learning_rate: 0.15216109550258716
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   subsample: 0.8340990684605311
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   colsample_bytree: 0.6132682223482742
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5304656814889008
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   colsample_bynode: 0.7786602433060559
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:14:50,997] [INFO] [<frozen importlib] -   scale_pos_weight: 5.143829777113951
[2025-11-19 09:14:51,068] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:14:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:14:50,984] Trial 317 finished with value: 0.22929721982165127 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.12277633209310354, 'learning_rate': 0.039756466276678205, 'n_estimators': 250, 'alpha': 0.3196170135898947, 'lambda': 1.0351607511239276, 'subsample': 0.8660694880974228, 'colsample_bytree': 0.5825450671364424, 'colsample_bylevel': 0.5081017173629933, 'colsample_bynode': 0.7861098689179586, 'scale_pos_weight': 6.75350085998743}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.58793	train-auc:0.64419	train-aucpr:0.25015	val-logloss:0.56415	val-auc:0.58339	val-aucpr:0.11540
[10]	train-logloss:0.54525	train-auc:0.69122	train-aucpr:0.30805	val-logloss:0.47703	val-auc:0.67289	val-aucpr:0.19187
[20]	train-logloss:0.53323	train-auc:0.70894	train-aucpr:0.32417	val-logloss:0.44172	val-auc:0.70234	val-aucpr:0.21066
[30]	train-logloss:0.52565	train-auc:0.72205	train-aucpr:0.33665	val-logloss:0.43559	val-auc:0.69320	val-aucpr:0.19900
[40]	train-logloss:0.51923	train-auc:0.73568	train-aucpr:0.35128	val-logloss:0.42363	val-auc:0.66932	val-aucpr:0.16319
[50]	train-logloss:0.51301	train-auc:0.74826	train-aucpr:0.36373	val-logloss:0.42654	val-auc:0.65377	val-aucpr:0.14160
[53]	train-logloss:0.51112	train-auc:0.75246	train-aucpr:0.36770	val-logloss:0.42620	val-auc:0.65537	val-aucpr:0.14234
[2025-11-19 09:14:51,237] [INFO] [<frozen importlib] - Training completed at iteration 23
[2025-11-19 09:14:51,237] [INFO] [<frozen importlib] - Best train loss: 0.5311
[2025-11-19 09:14:51,237] [INFO] [<frozen importlib] - Best val loss: 0.4308
[2025-11-19 09:14:51,237] [INFO] [<frozen importlib] - Best val AUC: 0.7021
[2025-11-19 09:14:51,237] [INFO] [<frozen importlib] - Best val AUCPR: 0.2124
[2025-11-19 09:14:51,242] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:14:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:15:01,128] [INFO] [<frozen importlib] - Optimal threshold: 0.4784
[2025-11-19 09:15:01,128] [INFO] [<frozen importlib] - Best f1: 0.2573
[2025-11-19 09:15:01,128] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:15:01,173] [INFO] [<frozen importlib] - Validation Results (threshold=0.4784):
[2025-11-19 09:15:01,173] [INFO] [<frozen importlib] -   Accuracy: 0.9092
[2025-11-19 09:15:01,173] [INFO] [<frozen importlib] -   Precision: 0.3466
[2025-11-19 09:15:01,173] [INFO] [<frozen importlib] -   Recall: 0.2045
[2025-11-19 09:15:01,173] [INFO] [<frozen importlib] -   F1 Score: 0.2573
[2025-11-19 09:15:01,173] [INFO] [<frozen importlib] -   AUROC: 0.7021
[2025-11-19 09:15:01,173] [INFO] [<frozen importlib] -   AUPRC: 0.2127
[2025-11-19 09:15:01,173] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:15:01,173] [INFO] [<frozen importlib] -     TN=16885, FP=560
[2025-11-19 09:15:01,173] [INFO] [<frozen importlib] -     FN=1155, TP=297
[2025-11-19 09:15:01,197] [INFO] [<frozen importlib] - Trial 318: AUPRC=0.2127, F1=0.4445, Prec=0.5066, Rec=0.3960 | Optimizing auprc=0.2127
[2025-11-19 09:15:01,198] [INFO] [<frozen importlib] - Trial 318 pruned.
[2025-11-19 09:15:01,198] [ERROR] [<frozen importlib] - Trial 318 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  64%|██████▎   | 318/500 [52:59<35:46, 11.80s/it]Best trial: 289. Best value: 0.241792:  64%|██████▎   | 318/500 [52:59<35:46, 11.80s/it]Best trial: 289. Best value: 0.241792:  64%|██████▍   | 319/500 [52:59<34:09, 11.32s/it][2025-11-19 09:15:01,209] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.061150382349085
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   gamma: 0.21389385046090975
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   alpha: 0.505388204449445
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   lambda: 1.3244351410183797
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   learning_rate: 0.03473077472424464
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   subsample: 0.8435254656692843
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   colsample_bytree: 0.5946576712535661
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9295259494374633
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   colsample_bynode: 0.7545624750013317
[2025-11-19 09:15:01,209] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:15:01,210] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:15:01,210] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:15:01,210] [INFO] [<frozen importlib] -   scale_pos_weight: 6.061150382349085
[2025-11-19 09:15:01,284] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:15:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:15:01,198] Trial 318 pruned. 
[0]	train-logloss:0.64775	train-auc:0.63144	train-aucpr:0.22870	val-logloss:0.63702	val-auc:0.60838	val-aucpr:0.13566
[10]	train-logloss:0.62589	train-auc:0.68035	train-aucpr:0.29267	val-logloss:0.57762	val-auc:0.71232	val-aucpr:0.22062
[20]	train-logloss:0.61203	train-auc:0.68619	train-aucpr:0.30101	val-logloss:0.54095	val-auc:0.71284	val-aucpr:0.21775
[30]	train-logloss:0.60228	train-auc:0.69150	train-aucpr:0.30569	val-logloss:0.51711	val-auc:0.70943	val-aucpr:0.21911
[37]	train-logloss:0.59703	train-auc:0.69484	train-aucpr:0.30900	val-logloss:0.51096	val-auc:0.70926	val-aucpr:0.22033
[2025-11-19 09:15:01,419] [INFO] [<frozen importlib] - Training completed at iteration 8
[2025-11-19 09:15:01,419] [INFO] [<frozen importlib] - Best train loss: 0.6295
[2025-11-19 09:15:01,419] [INFO] [<frozen importlib] - Best val loss: 0.5899
[2025-11-19 09:15:01,419] [INFO] [<frozen importlib] - Best val AUC: 0.7151
[2025-11-19 09:15:01,419] [INFO] [<frozen importlib] - Best val AUCPR: 0.2230
[2025-11-19 09:15:01,424] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:15:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:15:02,713] [INFO] [<frozen importlib] - Optimal threshold: 0.4602
[2025-11-19 09:15:02,713] [INFO] [<frozen importlib] - Best f1: 0.2746
[2025-11-19 09:15:02,713] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:15:02,758] [INFO] [<frozen importlib] - Validation Results (threshold=0.4602):
[2025-11-19 09:15:02,758] [INFO] [<frozen importlib] -   Accuracy: 0.8516
[2025-11-19 09:15:02,758] [INFO] [<frozen importlib] -   Precision: 0.2199
[2025-11-19 09:15:02,758] [INFO] [<frozen importlib] -   Recall: 0.3657
[2025-11-19 09:15:02,758] [INFO] [<frozen importlib] -   F1 Score: 0.2746
[2025-11-19 09:15:02,758] [INFO] [<frozen importlib] -   AUROC: 0.7151
[2025-11-19 09:15:02,758] [INFO] [<frozen importlib] -   AUPRC: 0.2126
[2025-11-19 09:15:02,758] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:15:02,758] [INFO] [<frozen importlib] -     TN=15561, FP=1884
[2025-11-19 09:15:02,758] [INFO] [<frozen importlib] -     FN=921, TP=531
[2025-11-19 09:15:02,781] [INFO] [<frozen importlib] - Trial 319: AUPRC=0.2126, F1=0.4088, Prec=0.3127, Rec=0.5902 | Optimizing auprc=0.2126
                                                                                        Best trial: 289. Best value: 0.241792:  64%|██████▍   | 319/500 [53:00<34:09, 11.32s/it]Best trial: 289. Best value: 0.241792:  64%|██████▍   | 319/500 [53:00<34:09, 11.32s/it]Best trial: 289. Best value: 0.241792:  64%|██████▍   | 320/500 [53:00<25:11,  8.40s/it][2025-11-19 09:15:02,794] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.366499676608468
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   gamma: 0.18704090295110434
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   alpha: 0.4537352649121621
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   lambda: 1.0042005272597598
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   learning_rate: 0.03116451927816543
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   subsample: 0.8187194901659632
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   colsample_bytree: 0.5831211675921013
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6253899666117962
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   colsample_bynode: 0.7938864012202844
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:15:02,794] [INFO] [<frozen importlib] -   scale_pos_weight: 6.366499676608468
[2025-11-19 09:15:02,871] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:15:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:15:02,781] Trial 319 finished with value: 0.21260458832007983 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.21389385046090975, 'learning_rate': 0.03473077472424464, 'n_estimators': 250, 'alpha': 0.505388204449445, 'lambda': 1.3244351410183797, 'subsample': 0.8435254656692843, 'colsample_bytree': 0.5946576712535661, 'colsample_bylevel': 0.9295259494374633, 'colsample_bynode': 0.7545624750013317, 'scale_pos_weight': 6.061150382349085}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.66463	train-auc:0.65297	train-aucpr:0.23576	val-logloss:0.65761	val-auc:0.63761	val-aucpr:0.11591
[10]	train-logloss:0.64408	train-auc:0.68409	train-aucpr:0.29261	val-logloss:0.61355	val-auc:0.69872	val-aucpr:0.20192
[20]	train-logloss:0.63058	train-auc:0.68962	train-aucpr:0.29806	val-logloss:0.57641	val-auc:0.69859	val-aucpr:0.21896
[30]	train-logloss:0.62091	train-auc:0.69340	train-aucpr:0.30324	val-logloss:0.54684	val-auc:0.70482	val-aucpr:0.22641
[40]	train-logloss:0.61374	train-auc:0.69625	train-aucpr:0.30795	val-logloss:0.52496	val-auc:0.70446	val-aucpr:0.22732
[50]	train-logloss:0.60788	train-auc:0.69974	train-aucpr:0.31217	val-logloss:0.51554	val-auc:0.70477	val-aucpr:0.22584
[60]	train-logloss:0.60348	train-auc:0.70355	train-aucpr:0.31546	val-logloss:0.50485	val-auc:0.70460	val-aucpr:0.22783
[70]	train-logloss:0.60007	train-auc:0.70622	train-aucpr:0.31825	val-logloss:0.50547	val-auc:0.70227	val-aucpr:0.22637
[76]	train-logloss:0.59844	train-auc:0.70740	train-aucpr:0.32003	val-logloss:0.50373	val-auc:0.70154	val-aucpr:0.22633
[2025-11-19 09:15:03,100] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 09:15:03,100] [INFO] [<frozen importlib] - Best train loss: 0.6093
[2025-11-19 09:15:03,100] [INFO] [<frozen importlib] - Best val loss: 0.5168
[2025-11-19 09:15:03,100] [INFO] [<frozen importlib] - Best val AUC: 0.7082
[2025-11-19 09:15:03,100] [INFO] [<frozen importlib] - Best val AUCPR: 0.2289
[2025-11-19 09:15:03,105] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:15:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:15:12,750] [INFO] [<frozen importlib] - Optimal threshold: 0.4776
[2025-11-19 09:15:12,750] [INFO] [<frozen importlib] - Best f1: 0.2729
[2025-11-19 09:15:12,750] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:15:12,792] [INFO] [<frozen importlib] - Validation Results (threshold=0.4776):
[2025-11-19 09:15:12,792] [INFO] [<frozen importlib] -   Accuracy: 0.9016
[2025-11-19 09:15:12,792] [INFO] [<frozen importlib] -   Precision: 0.3156
[2025-11-19 09:15:12,792] [INFO] [<frozen importlib] -   Recall: 0.2404
[2025-11-19 09:15:12,792] [INFO] [<frozen importlib] -   F1 Score: 0.2729
[2025-11-19 09:15:12,792] [INFO] [<frozen importlib] -   AUROC: 0.7082
[2025-11-19 09:15:12,792] [INFO] [<frozen importlib] -   AUPRC: 0.2292
[2025-11-19 09:15:12,792] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:15:12,792] [INFO] [<frozen importlib] -     TN=16688, FP=757
[2025-11-19 09:15:12,792] [INFO] [<frozen importlib] -     FN=1103, TP=349
[2025-11-19 09:15:12,819] [INFO] [<frozen importlib] - Trial 320: AUPRC=0.2292, F1=0.4400, Prec=0.4514, Rec=0.4291 | Optimizing auprc=0.2292
                                                                                        Best trial: 289. Best value: 0.241792:  64%|██████▍   | 320/500 [53:10<25:11,  8.40s/it]Best trial: 289. Best value: 0.241792:  64%|██████▍   | 320/500 [53:10<25:11,  8.40s/it]Best trial: 289. Best value: 0.241792:  64%|██████▍   | 321/500 [53:10<26:31,  8.89s/it][2025-11-19 09:15:12,831] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.454539294524328
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] -   gamma: 0.937645871241375
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] -   alpha: 0.4162436770105056
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] -   lambda: 1.246756184007746
[2025-11-19 09:15:12,831] [INFO] [<frozen importlib] -   learning_rate: 0.03830564260827591
[2025-11-19 09:15:12,832] [INFO] [<frozen importlib] -   subsample: 0.8558817231012653
[2025-11-19 09:15:12,832] [INFO] [<frozen importlib] -   colsample_bytree: 0.6537612251137115
[2025-11-19 09:15:12,832] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5006003933758918
[2025-11-19 09:15:12,832] [INFO] [<frozen importlib] -   colsample_bynode: 0.7431779731543279
[2025-11-19 09:15:12,832] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:15:12,832] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:15:12,832] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:15:12,832] [INFO] [<frozen importlib] -   scale_pos_weight: 5.454539294524328
[2025-11-19 09:15:12,905] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:15:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:15:12,820] Trial 320 finished with value: 0.22921374452724072 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.18704090295110434, 'learning_rate': 0.03116451927816543, 'n_estimators': 250, 'alpha': 0.4537352649121621, 'lambda': 1.0042005272597598, 'subsample': 0.8187194901659632, 'colsample_bytree': 0.5831211675921013, 'colsample_bylevel': 0.6253899666117962, 'colsample_bynode': 0.7938864012202844, 'scale_pos_weight': 6.366499676608468}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.61332	train-auc:0.63381	train-aucpr:0.21413	val-logloss:0.59955	val-auc:0.58900	val-aucpr:0.10589
[10]	train-logloss:0.59250	train-auc:0.67953	train-aucpr:0.28509	val-logloss:0.54953	val-auc:0.65660	val-aucpr:0.17999
[20]	train-logloss:0.57947	train-auc:0.68529	train-aucpr:0.29485	val-logloss:0.51172	val-auc:0.67077	val-aucpr:0.19615
[30]	train-logloss:0.57003	train-auc:0.69257	train-aucpr:0.30507	val-logloss:0.48605	val-auc:0.68089	val-aucpr:0.21186
[40]	train-logloss:0.56347	train-auc:0.69644	train-aucpr:0.31031	val-logloss:0.48405	val-auc:0.69181	val-aucpr:0.21950
[50]	train-logloss:0.55810	train-auc:0.70213	train-aucpr:0.31585	val-logloss:0.48233	val-auc:0.69733	val-aucpr:0.21900
[60]	train-logloss:0.55434	train-auc:0.70626	train-aucpr:0.31949	val-logloss:0.47339	val-auc:0.68848	val-aucpr:0.20725
[70]	train-logloss:0.55133	train-auc:0.70875	train-aucpr:0.32289	val-logloss:0.46350	val-auc:0.69026	val-aucpr:0.21015
[80]	train-logloss:0.54890	train-auc:0.71263	train-aucpr:0.32644	val-logloss:0.45887	val-auc:0.68637	val-aucpr:0.20313
[85]	train-logloss:0.54761	train-auc:0.71376	train-aucpr:0.32834	val-logloss:0.45883	val-auc:0.68639	val-aucpr:0.20283
[2025-11-19 09:15:13,151] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 09:15:13,151] [INFO] [<frozen importlib] - Best train loss: 0.5563
[2025-11-19 09:15:13,151] [INFO] [<frozen importlib] - Best val loss: 0.4777
[2025-11-19 09:15:13,151] [INFO] [<frozen importlib] - Best val AUC: 0.6985
[2025-11-19 09:15:13,151] [INFO] [<frozen importlib] - Best val AUCPR: 0.2227
[2025-11-19 09:15:13,156] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:15:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:15:24,530] [INFO] [<frozen importlib] - Optimal threshold: 0.4451
[2025-11-19 09:15:24,530] [INFO] [<frozen importlib] - Best f1: 0.2711
[2025-11-19 09:15:24,530] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:15:24,577] [INFO] [<frozen importlib] - Validation Results (threshold=0.4451):
[2025-11-19 09:15:24,577] [INFO] [<frozen importlib] -   Accuracy: 0.8998
[2025-11-19 09:15:24,577] [INFO] [<frozen importlib] -   Precision: 0.3074
[2025-11-19 09:15:24,577] [INFO] [<frozen importlib] -   Recall: 0.2424
[2025-11-19 09:15:24,577] [INFO] [<frozen importlib] -   F1 Score: 0.2711
[2025-11-19 09:15:24,577] [INFO] [<frozen importlib] -   AUROC: 0.6985
[2025-11-19 09:15:24,577] [INFO] [<frozen importlib] -   AUPRC: 0.2230
[2025-11-19 09:15:24,577] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:15:24,577] [INFO] [<frozen importlib] -     TN=16652, FP=793
[2025-11-19 09:15:24,577] [INFO] [<frozen importlib] -     FN=1100, TP=352
[2025-11-19 09:15:24,602] [INFO] [<frozen importlib] - Trial 321: AUPRC=0.2230, F1=0.4512, Prec=0.4520, Rec=0.4504 | Optimizing auprc=0.2230
[2025-11-19 09:15:24,602] [INFO] [<frozen importlib] - Trial 321 pruned.
[2025-11-19 09:15:24,602] [ERROR] [<frozen importlib] - Trial 321 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  64%|██████▍   | 321/500 [53:22<26:31,  8.89s/it]Best trial: 289. Best value: 0.241792:  64%|██████▍   | 321/500 [53:22<26:31,  8.89s/it]Best trial: 289. Best value: 0.241792:  64%|██████▍   | 322/500 [53:22<28:57,  9.76s/it][2025-11-19 09:15:24,623] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.79519641415794
[2025-11-19 09:15:24,623] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:15:24,623] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:15:24,623] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:15:24,623] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:15:24,623] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:15:24,623] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   gamma: 0.23052817650748722
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   alpha: 0.46172999187312874
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   lambda: 1.1282023129021392
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   learning_rate: 0.03617916978858056
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   subsample: 0.8298071821782136
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   colsample_bytree: 0.6031338463859712
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5173567341225384
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   colsample_bynode: 0.761777017689229
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:15:24,624] [INFO] [<frozen importlib] -   scale_pos_weight: 5.79519641415794
[2025-11-19 09:15:24,699] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:15:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:15:24,602] Trial 321 pruned. 
[0]	train-logloss:0.63250	train-auc:0.64286	train-aucpr:0.25090	val-logloss:0.62198	val-auc:0.59035	val-aucpr:0.13668
[10]	train-logloss:0.61122	train-auc:0.68213	train-aucpr:0.29272	val-logloss:0.56964	val-auc:0.69311	val-aucpr:0.21130
[20]	train-logloss:0.59767	train-auc:0.68926	train-aucpr:0.30031	val-logloss:0.53074	val-auc:0.69647	val-aucpr:0.21580
[30]	train-logloss:0.58860	train-auc:0.69302	train-aucpr:0.30498	val-logloss:0.50599	val-auc:0.70503	val-aucpr:0.22311
[40]	train-logloss:0.58189	train-auc:0.69630	train-aucpr:0.30865	val-logloss:0.48444	val-auc:0.70383	val-aucpr:0.22724
[50]	train-logloss:0.57662	train-auc:0.69920	train-aucpr:0.31256	val-logloss:0.47019	val-auc:0.70613	val-aucpr:0.22720
[60]	train-logloss:0.57263	train-auc:0.70348	train-aucpr:0.31763	val-logloss:0.47250	val-auc:0.70839	val-aucpr:0.22721
[70]	train-logloss:0.56946	train-auc:0.70700	train-aucpr:0.32112	val-logloss:0.47205	val-auc:0.70336	val-aucpr:0.21916
[80]	train-logloss:0.56660	train-auc:0.71115	train-aucpr:0.32555	val-logloss:0.47033	val-auc:0.70409	val-aucpr:0.21688
[90]	train-logloss:0.56417	train-auc:0.71434	train-aucpr:0.32879	val-logloss:0.46193	val-auc:0.70513	val-aucpr:0.21684
[94]	train-logloss:0.56312	train-auc:0.71678	train-aucpr:0.33092	val-logloss:0.45699	val-auc:0.70149	val-aucpr:0.20942
[2025-11-19 09:15:24,972] [INFO] [<frozen importlib] - Training completed at iteration 64
[2025-11-19 09:15:24,972] [INFO] [<frozen importlib] - Best train loss: 0.5715
[2025-11-19 09:15:24,972] [INFO] [<frozen importlib] - Best val loss: 0.4733
[2025-11-19 09:15:24,972] [INFO] [<frozen importlib] - Best val AUC: 0.7101
[2025-11-19 09:15:24,972] [INFO] [<frozen importlib] - Best val AUCPR: 0.2285
[2025-11-19 09:15:24,977] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:15:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:15:38,090] [INFO] [<frozen importlib] - Optimal threshold: 0.4561
[2025-11-19 09:15:38,090] [INFO] [<frozen importlib] - Best f1: 0.2804
[2025-11-19 09:15:38,090] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:15:38,132] [INFO] [<frozen importlib] - Validation Results (threshold=0.4561):
[2025-11-19 09:15:38,132] [INFO] [<frozen importlib] -   Accuracy: 0.8973
[2025-11-19 09:15:38,132] [INFO] [<frozen importlib] -   Precision: 0.3039
[2025-11-19 09:15:38,132] [INFO] [<frozen importlib] -   Recall: 0.2603
[2025-11-19 09:15:38,132] [INFO] [<frozen importlib] -   F1 Score: 0.2804
[2025-11-19 09:15:38,132] [INFO] [<frozen importlib] -   AUROC: 0.7101
[2025-11-19 09:15:38,132] [INFO] [<frozen importlib] -   AUPRC: 0.2289
[2025-11-19 09:15:38,132] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:15:38,132] [INFO] [<frozen importlib] -     TN=16579, FP=866
[2025-11-19 09:15:38,132] [INFO] [<frozen importlib] -     FN=1074, TP=378
[2025-11-19 09:15:38,158] [INFO] [<frozen importlib] - Trial 322: AUPRC=0.2289, F1=0.4474, Prec=0.4355, Rec=0.4601 | Optimizing auprc=0.2289
                                                                                        Best trial: 289. Best value: 0.241792:  64%|██████▍   | 322/500 [53:36<28:57,  9.76s/it]Best trial: 289. Best value: 0.241792:  64%|██████▍   | 322/500 [53:36<28:57,  9.76s/it]Best trial: 289. Best value: 0.241792:  65%|██████▍   | 323/500 [53:36<32:08, 10.90s/it][2025-11-19 09:15:38,180] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.89154616472541
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   gamma: 0.5758044036814134
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   alpha: 0.3539021436309124
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   lambda: 1.0951851527754375
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   learning_rate: 0.04026912920358152
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   subsample: 0.8173125510070411
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   colsample_bytree: 0.5918560677089698
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5006215196335744
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   colsample_bynode: 0.8220918874274369
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:15:38,180] [INFO] [<frozen importlib] -   scale_pos_weight: 6.89154616472541
[2025-11-19 09:15:38,263] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:15:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:15:38,159] Trial 322 finished with value: 0.22893252314945203 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.23052817650748722, 'learning_rate': 0.03617916978858056, 'n_estimators': 200, 'alpha': 0.46172999187312874, 'lambda': 1.1282023129021392, 'subsample': 0.8298071821782136, 'colsample_bytree': 0.6031338463859712, 'colsample_bylevel': 0.5173567341225384, 'colsample_bynode': 0.761777017689229, 'scale_pos_weight': 5.79519641415794}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.69320	train-auc:0.63800	train-aucpr:0.22147	val-logloss:0.68955	val-auc:0.60409	val-aucpr:0.12672
[10]	train-logloss:0.66694	train-auc:0.68228	train-aucpr:0.29173	val-logloss:0.64391	val-auc:0.66010	val-aucpr:0.16374
[20]	train-logloss:0.65144	train-auc:0.68875	train-aucpr:0.29990	val-logloss:0.60896	val-auc:0.67866	val-aucpr:0.20125
[30]	train-logloss:0.64100	train-auc:0.69327	train-aucpr:0.30580	val-logloss:0.56911	val-auc:0.67930	val-aucpr:0.22035
[40]	train-logloss:0.63380	train-auc:0.69847	train-aucpr:0.30997	val-logloss:0.53968	val-auc:0.70692	val-aucpr:0.23398
[50]	train-logloss:0.62798	train-auc:0.70196	train-aucpr:0.31368	val-logloss:0.52042	val-auc:0.70359	val-aucpr:0.23322
[60]	train-logloss:0.62391	train-auc:0.70674	train-aucpr:0.31866	val-logloss:0.50828	val-auc:0.70881	val-aucpr:0.23082
[68]	train-logloss:0.62119	train-auc:0.71012	train-aucpr:0.32114	val-logloss:0.50516	val-auc:0.70701	val-aucpr:0.21854
[2025-11-19 09:15:38,473] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 09:15:38,473] [INFO] [<frozen importlib] - Best train loss: 0.6344
[2025-11-19 09:15:38,473] [INFO] [<frozen importlib] - Best val loss: 0.5430
[2025-11-19 09:15:38,473] [INFO] [<frozen importlib] - Best val AUC: 0.7073
[2025-11-19 09:15:38,473] [INFO] [<frozen importlib] - Best val AUCPR: 0.2364
[2025-11-19 09:15:38,478] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:15:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:15:47,609] [INFO] [<frozen importlib] - Optimal threshold: 0.4899
[2025-11-19 09:15:47,609] [INFO] [<frozen importlib] - Best f1: 0.2852
[2025-11-19 09:15:47,609] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:15:47,652] [INFO] [<frozen importlib] - Validation Results (threshold=0.4899):
[2025-11-19 09:15:47,652] [INFO] [<frozen importlib] -   Accuracy: 0.8989
[2025-11-19 09:15:47,652] [INFO] [<frozen importlib] -   Precision: 0.3123
[2025-11-19 09:15:47,652] [INFO] [<frozen importlib] -   Recall: 0.2624
[2025-11-19 09:15:47,652] [INFO] [<frozen importlib] -   F1 Score: 0.2852
[2025-11-19 09:15:47,652] [INFO] [<frozen importlib] -   AUROC: 0.7073
[2025-11-19 09:15:47,652] [INFO] [<frozen importlib] -   AUPRC: 0.2367
[2025-11-19 09:15:47,652] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:15:47,652] [INFO] [<frozen importlib] -     TN=16606, FP=839
[2025-11-19 09:15:47,652] [INFO] [<frozen importlib] -     FN=1071, TP=381
[2025-11-19 09:15:47,675] [INFO] [<frozen importlib] - Trial 323: AUPRC=0.2367, F1=0.4457, Prec=0.4392, Rec=0.4525 | Optimizing auprc=0.2367
                                                                                        Best trial: 289. Best value: 0.241792:  65%|██████▍   | 323/500 [53:45<32:08, 10.90s/it]Best trial: 289. Best value: 0.241792:  65%|██████▍   | 323/500 [53:45<32:08, 10.90s/it]Best trial: 289. Best value: 0.241792:  65%|██████▍   | 324/500 [53:45<30:45, 10.48s/it][2025-11-19 09:15:47,687] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.751094262726146
[2025-11-19 09:15:47,687] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:15:47,687] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:15:47,687] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:15:47,687] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:15:47,687] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:15:47,687] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:15:47,687] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:15:47,687] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:15:47,687] [INFO] [<frozen importlib] -   gamma: 0.6224633873843809
[2025-11-19 09:15:47,687] [INFO] [<frozen importlib] -   alpha: 0.37394901225163407
[2025-11-19 09:15:47,688] [INFO] [<frozen importlib] -   lambda: 1.4490306976774803
[2025-11-19 09:15:47,688] [INFO] [<frozen importlib] -   learning_rate: 0.04158659528820435
[2025-11-19 09:15:47,688] [INFO] [<frozen importlib] -   subsample: 0.8128791219831045
[2025-11-19 09:15:47,688] [INFO] [<frozen importlib] -   colsample_bytree: 0.6295381363687635
[2025-11-19 09:15:47,688] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9056756452907144
[2025-11-19 09:15:47,688] [INFO] [<frozen importlib] -   colsample_bynode: 0.8251835742367778
[2025-11-19 09:15:47,688] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:15:47,688] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:15:47,688] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:15:47,688] [INFO] [<frozen importlib] -   scale_pos_weight: 6.751094262726146
[2025-11-19 09:15:47,760] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:15:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:15:47,675] Trial 323 finished with value: 0.23672837653687773 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.5758044036814134, 'learning_rate': 0.04026912920358152, 'n_estimators': 250, 'alpha': 0.3539021436309124, 'lambda': 1.0951851527754375, 'subsample': 0.8173125510070411, 'colsample_bytree': 0.5918560677089698, 'colsample_bylevel': 0.5006215196335744, 'colsample_bynode': 0.8220918874274369, 'scale_pos_weight': 6.89154616472541}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.68495	train-auc:0.64737	train-aucpr:0.23684	val-logloss:0.68027	val-auc:0.60809	val-aucpr:0.13402
[10]	train-logloss:0.65745	train-auc:0.68370	train-aucpr:0.29150	val-logloss:0.60769	val-auc:0.68885	val-aucpr:0.19872
[20]	train-logloss:0.64204	train-auc:0.69184	train-aucpr:0.29926	val-logloss:0.56358	val-auc:0.68821	val-aucpr:0.19642
[30]	train-logloss:0.63188	train-auc:0.69796	train-aucpr:0.30502	val-logloss:0.53972	val-auc:0.69397	val-aucpr:0.20633
[40]	train-logloss:0.62482	train-auc:0.70289	train-aucpr:0.30973	val-logloss:0.54430	val-auc:0.69317	val-aucpr:0.20605
[50]	train-logloss:0.61913	train-auc:0.70615	train-aucpr:0.31550	val-logloss:0.52423	val-auc:0.69520	val-aucpr:0.21220
[60]	train-logloss:0.61484	train-auc:0.71086	train-aucpr:0.32099	val-logloss:0.51688	val-auc:0.69354	val-aucpr:0.21166
[70]	train-logloss:0.61149	train-auc:0.71469	train-aucpr:0.32461	val-logloss:0.49446	val-auc:0.70129	val-aucpr:0.21333
[80]	train-logloss:0.60862	train-auc:0.71836	train-aucpr:0.32872	val-logloss:0.49240	val-auc:0.69639	val-aucpr:0.20404
[85]	train-logloss:0.60720	train-auc:0.72004	train-aucpr:0.33027	val-logloss:0.48839	val-auc:0.69615	val-aucpr:0.20268
[2025-11-19 09:15:48,009] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:15:48,009] [INFO] [<frozen importlib] - Best train loss: 0.6165
[2025-11-19 09:15:48,009] [INFO] [<frozen importlib] - Best val loss: 0.5180
[2025-11-19 09:15:48,009] [INFO] [<frozen importlib] - Best val AUC: 0.6946
[2025-11-19 09:15:48,009] [INFO] [<frozen importlib] - Best val AUCPR: 0.2147
[2025-11-19 09:15:48,014] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:15:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:15:58,579] [INFO] [<frozen importlib] - Optimal threshold: 0.5034
[2025-11-19 09:15:58,579] [INFO] [<frozen importlib] - Best f1: 0.2673
[2025-11-19 09:15:58,579] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:15:58,624] [INFO] [<frozen importlib] - Validation Results (threshold=0.5034):
[2025-11-19 09:15:58,624] [INFO] [<frozen importlib] -   Accuracy: 0.9072
[2025-11-19 09:15:58,624] [INFO] [<frozen importlib] -   Precision: 0.3397
[2025-11-19 09:15:58,624] [INFO] [<frozen importlib] -   Recall: 0.2204
[2025-11-19 09:15:58,624] [INFO] [<frozen importlib] -   F1 Score: 0.2673
[2025-11-19 09:15:58,624] [INFO] [<frozen importlib] -   AUROC: 0.6946
[2025-11-19 09:15:58,624] [INFO] [<frozen importlib] -   AUPRC: 0.2151
[2025-11-19 09:15:58,624] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:15:58,624] [INFO] [<frozen importlib] -     TN=16823, FP=622
[2025-11-19 09:15:58,624] [INFO] [<frozen importlib] -     FN=1132, TP=320
[2025-11-19 09:15:58,649] [INFO] [<frozen importlib] - Trial 324: AUPRC=0.2151, F1=0.4699, Prec=0.5060, Rec=0.4387 | Optimizing auprc=0.2151
[2025-11-19 09:15:58,649] [INFO] [<frozen importlib] - Trial 324 pruned.
[2025-11-19 09:15:58,649] [ERROR] [<frozen importlib] - Trial 324 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  65%|██████▍   | 324/500 [53:56<30:45, 10.48s/it]Best trial: 289. Best value: 0.241792:  65%|██████▍   | 324/500 [53:56<30:45, 10.48s/it]Best trial: 289. Best value: 0.241792:  65%|██████▌   | 325/500 [53:56<31:00, 10.63s/it][2025-11-19 09:15:58,670] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.410344681164775
[2025-11-19 09:15:58,670] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:15:58,670] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:15:58,670] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   gamma: 0.32748782518907693
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   alpha: 0.34844420419525585
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   lambda: 3.5937227277097046
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   learning_rate: 0.03258010744428662
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   subsample: 0.8172508708679542
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   colsample_bytree: 0.5953909696359035
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5002696393074758
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   colsample_bynode: 0.8393123084161265
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:15:58,671] [INFO] [<frozen importlib] -   scale_pos_weight: 6.410344681164775
[2025-11-19 09:15:58,746] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:15:58] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:15:58,649] Trial 324 pruned. 
[0]	train-logloss:0.66715	train-auc:0.64556	train-aucpr:0.22928	val-logloss:0.65992	val-auc:0.63470	val-aucpr:0.15663
[10]	train-logloss:0.64584	train-auc:0.68212	train-aucpr:0.29403	val-logloss:0.62388	val-auc:0.66347	val-aucpr:0.17517
[20]	train-logloss:0.63251	train-auc:0.68578	train-aucpr:0.29958	val-logloss:0.59450	val-auc:0.67748	val-aucpr:0.19837
[30]	train-logloss:0.62271	train-auc:0.69020	train-aucpr:0.30493	val-logloss:0.56306	val-auc:0.67402	val-aucpr:0.21523
[40]	train-logloss:0.61579	train-auc:0.69460	train-aucpr:0.30834	val-logloss:0.53389	val-auc:0.68518	val-aucpr:0.22418
[50]	train-logloss:0.60995	train-auc:0.69809	train-aucpr:0.31196	val-logloss:0.52216	val-auc:0.69181	val-aucpr:0.22877
[60]	train-logloss:0.60551	train-auc:0.70225	train-aucpr:0.31586	val-logloss:0.51011	val-auc:0.70205	val-aucpr:0.23334
[70]	train-logloss:0.60197	train-auc:0.70546	train-aucpr:0.31886	val-logloss:0.50631	val-auc:0.71161	val-aucpr:0.23519
[80]	train-logloss:0.59896	train-auc:0.70908	train-aucpr:0.32179	val-logloss:0.50529	val-auc:0.71354	val-aucpr:0.23154
[90]	train-logloss:0.59638	train-auc:0.71175	train-aucpr:0.32389	val-logloss:0.49456	val-auc:0.71492	val-aucpr:0.23074
[100]	train-logloss:0.59434	train-auc:0.71494	train-aucpr:0.32691	val-logloss:0.49547	val-auc:0.71380	val-aucpr:0.22659
[101]	train-logloss:0.59396	train-auc:0.71541	train-aucpr:0.32760	val-logloss:0.49471	val-auc:0.71330	val-aucpr:0.22638
[2025-11-19 09:15:59,027] [INFO] [<frozen importlib] - Training completed at iteration 71
[2025-11-19 09:15:59,027] [INFO] [<frozen importlib] - Best train loss: 0.6017
[2025-11-19 09:15:59,027] [INFO] [<frozen importlib] - Best val loss: 0.5047
[2025-11-19 09:15:59,027] [INFO] [<frozen importlib] - Best val AUC: 0.7115
[2025-11-19 09:15:59,027] [INFO] [<frozen importlib] - Best val AUCPR: 0.2357
[2025-11-19 09:15:59,033] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:15:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:16:11,917] [INFO] [<frozen importlib] - Optimal threshold: 0.4806
[2025-11-19 09:16:11,917] [INFO] [<frozen importlib] - Best f1: 0.2904
[2025-11-19 09:16:11,917] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:16:11,958] [INFO] [<frozen importlib] - Validation Results (threshold=0.4806):
[2025-11-19 09:16:11,958] [INFO] [<frozen importlib] -   Accuracy: 0.9023
[2025-11-19 09:16:11,958] [INFO] [<frozen importlib] -   Precision: 0.3284
[2025-11-19 09:16:11,958] [INFO] [<frozen importlib] -   Recall: 0.2603
[2025-11-19 09:16:11,958] [INFO] [<frozen importlib] -   F1 Score: 0.2904
[2025-11-19 09:16:11,958] [INFO] [<frozen importlib] -   AUROC: 0.7115
[2025-11-19 09:16:11,958] [INFO] [<frozen importlib] -   AUPRC: 0.2361
[2025-11-19 09:16:11,958] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:16:11,958] [INFO] [<frozen importlib] -     TN=16672, FP=773
[2025-11-19 09:16:11,958] [INFO] [<frozen importlib] -     FN=1074, TP=378
[2025-11-19 09:16:11,981] [INFO] [<frozen importlib] - Trial 325: AUPRC=0.2361, F1=0.4554, Prec=0.4591, Rec=0.4518 | Optimizing auprc=0.2361
[2025-11-19 09:16:11,981] [INFO] [<frozen importlib] - Trial 325 pruned.
[2025-11-19 09:16:11,981] [ERROR] [<frozen importlib] - Trial 325 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  65%|██████▌   | 325/500 [54:09<31:00, 10.63s/it]Best trial: 289. Best value: 0.241792:  65%|██████▌   | 325/500 [54:09<31:00, 10.63s/it]Best trial: 289. Best value: 0.241792:  65%|██████▌   | 326/500 [54:09<33:10, 11.44s/it][2025-11-19 09:16:11,994] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.129308391034586
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   gamma: 0.1587157135728942
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   alpha: 0.2938514855026519
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   lambda: 1.1286842452545978
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   learning_rate: 0.04285782335056184
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   subsample: 0.8412065064905073
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   colsample_bytree: 0.6115847785049788
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9425213153759431
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   colsample_bynode: 0.8168029951395948
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:16:11,994] [INFO] [<frozen importlib] -   scale_pos_weight: 6.129308391034586
[2025-11-19 09:16:12,067] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:16:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:16:11,981] Trial 325 pruned. 
[0]	train-logloss:0.65049	train-auc:0.65745	train-aucpr:0.22949	val-logloss:0.63832	val-auc:0.64352	val-aucpr:0.13548
[10]	train-logloss:0.62524	train-auc:0.68060	train-aucpr:0.28565	val-logloss:0.57164	val-auc:0.68463	val-aucpr:0.18421
[20]	train-logloss:0.60988	train-auc:0.69122	train-aucpr:0.30088	val-logloss:0.53361	val-auc:0.69134	val-aucpr:0.20618
[30]	train-logloss:0.60006	train-auc:0.69636	train-aucpr:0.30691	val-logloss:0.51335	val-auc:0.69240	val-aucpr:0.21399
[40]	train-logloss:0.59321	train-auc:0.70056	train-aucpr:0.31215	val-logloss:0.49480	val-auc:0.69400	val-aucpr:0.21643
[50]	train-logloss:0.58798	train-auc:0.70476	train-aucpr:0.31828	val-logloss:0.48462	val-auc:0.69165	val-aucpr:0.21749
[60]	train-logloss:0.58416	train-auc:0.70930	train-aucpr:0.32338	val-logloss:0.48725	val-auc:0.69460	val-aucpr:0.21980
[70]	train-logloss:0.58018	train-auc:0.71608	train-aucpr:0.32948	val-logloss:0.47390	val-auc:0.67832	val-aucpr:0.19756
[80]	train-logloss:0.57734	train-auc:0.72070	train-aucpr:0.33353	val-logloss:0.46661	val-auc:0.67587	val-aucpr:0.19039
[89]	train-logloss:0.57497	train-auc:0.72452	train-aucpr:0.33709	val-logloss:0.45526	val-auc:0.66410	val-aucpr:0.17116
[2025-11-19 09:16:12,326] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:16:12,326] [INFO] [<frozen importlib] - Best train loss: 0.5842
[2025-11-19 09:16:12,326] [INFO] [<frozen importlib] - Best val loss: 0.4873
[2025-11-19 09:16:12,326] [INFO] [<frozen importlib] - Best val AUC: 0.6946
[2025-11-19 09:16:12,326] [INFO] [<frozen importlib] - Best val AUCPR: 0.2198
[2025-11-19 09:16:12,330] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:16:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:16:23,619] [INFO] [<frozen importlib] - Optimal threshold: 0.4672
[2025-11-19 09:16:23,619] [INFO] [<frozen importlib] - Best f1: 0.2731
[2025-11-19 09:16:23,619] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:16:23,673] [INFO] [<frozen importlib] - Validation Results (threshold=0.4672):
[2025-11-19 09:16:23,673] [INFO] [<frozen importlib] -   Accuracy: 0.9014
[2025-11-19 09:16:23,673] [INFO] [<frozen importlib] -   Precision: 0.3150
[2025-11-19 09:16:23,673] [INFO] [<frozen importlib] -   Recall: 0.2410
[2025-11-19 09:16:23,673] [INFO] [<frozen importlib] -   F1 Score: 0.2731
[2025-11-19 09:16:23,673] [INFO] [<frozen importlib] -   AUROC: 0.6946
[2025-11-19 09:16:23,673] [INFO] [<frozen importlib] -   AUPRC: 0.2203
[2025-11-19 09:16:23,673] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:16:23,673] [INFO] [<frozen importlib] -     TN=16684, FP=761
[2025-11-19 09:16:23,673] [INFO] [<frozen importlib] -     FN=1102, TP=350
[2025-11-19 09:16:23,696] [INFO] [<frozen importlib] - Trial 326: AUPRC=0.2203, F1=0.4530, Prec=0.4599, Rec=0.4463 | Optimizing auprc=0.2203
[2025-11-19 09:16:23,696] [INFO] [<frozen importlib] - Trial 326 pruned.
[2025-11-19 09:16:23,696] [ERROR] [<frozen importlib] - Trial 326 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  65%|██████▌   | 326/500 [54:21<33:10, 11.44s/it]Best trial: 289. Best value: 0.241792:  65%|██████▌   | 326/500 [54:21<33:10, 11.44s/it]Best trial: 289. Best value: 0.241792:  65%|██████▌   | 327/500 [54:21<33:13, 11.52s/it][2025-11-19 09:16:23,708] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.856827873368452
[2025-11-19 09:16:23,708] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:16:23,708] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:16:23,708] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:16:23,708] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:16:23,708] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:16:23,708] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:16:23,708] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:16:23,708] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:16:23,708] [INFO] [<frozen importlib] -   gamma: 0.5460613783764998
[2025-11-19 09:16:23,708] [INFO] [<frozen importlib] -   alpha: 0.32692579855104636
[2025-11-19 09:16:23,709] [INFO] [<frozen importlib] -   lambda: 1.3310539685839822
[2025-11-19 09:16:23,709] [INFO] [<frozen importlib] -   learning_rate: 0.0339673218723607
[2025-11-19 09:16:23,709] [INFO] [<frozen importlib] -   subsample: 0.8300711046884496
[2025-11-19 09:16:23,709] [INFO] [<frozen importlib] -   colsample_bytree: 0.5869220788419811
[2025-11-19 09:16:23,709] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5000753341993088
[2025-11-19 09:16:23,709] [INFO] [<frozen importlib] -   colsample_bynode: 0.8286933838814621
[2025-11-19 09:16:23,709] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:16:23,709] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:16:23,709] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:16:23,709] [INFO] [<frozen importlib] -   scale_pos_weight: 6.856827873368452
[2025-11-19 09:16:23,781] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:16:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:16:23,696] Trial 326 pruned. 
[0]	train-logloss:0.69125	train-auc:0.64804	train-aucpr:0.24350	val-logloss:0.68671	val-auc:0.63163	val-aucpr:0.13479
[10]	train-logloss:0.66874	train-auc:0.68116	train-aucpr:0.28794	val-logloss:0.64443	val-auc:0.69233	val-aucpr:0.16900
[20]	train-logloss:0.65415	train-auc:0.68742	train-aucpr:0.29944	val-logloss:0.60741	val-auc:0.69408	val-aucpr:0.19712
[30]	train-logloss:0.64427	train-auc:0.69132	train-aucpr:0.30275	val-logloss:0.58418	val-auc:0.70545	val-aucpr:0.21212
[40]	train-logloss:0.63683	train-auc:0.69613	train-aucpr:0.30679	val-logloss:0.56264	val-auc:0.70849	val-aucpr:0.21605
[50]	train-logloss:0.63043	train-auc:0.70025	train-aucpr:0.31226	val-logloss:0.54725	val-auc:0.70799	val-aucpr:0.22046
[60]	train-logloss:0.62624	train-auc:0.70384	train-aucpr:0.31578	val-logloss:0.54052	val-auc:0.70592	val-aucpr:0.22097
[70]	train-logloss:0.62255	train-auc:0.70779	train-aucpr:0.31906	val-logloss:0.53227	val-auc:0.70405	val-aucpr:0.21874
[80]	train-logloss:0.61901	train-auc:0.71164	train-aucpr:0.32320	val-logloss:0.52501	val-auc:0.70473	val-aucpr:0.21489
[83]	train-logloss:0.61809	train-auc:0.71227	train-aucpr:0.32396	val-logloss:0.52184	val-auc:0.70512	val-aucpr:0.21524
[2025-11-19 09:16:24,028] [INFO] [<frozen importlib] - Training completed at iteration 53
[2025-11-19 09:16:24,028] [INFO] [<frozen importlib] - Best train loss: 0.6291
[2025-11-19 09:16:24,028] [INFO] [<frozen importlib] - Best val loss: 0.5409
[2025-11-19 09:16:24,028] [INFO] [<frozen importlib] - Best val AUC: 0.7084
[2025-11-19 09:16:24,028] [INFO] [<frozen importlib] - Best val AUCPR: 0.2218
[2025-11-19 09:16:24,033] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:16:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:16:34,589] [INFO] [<frozen importlib] - Optimal threshold: 0.4853
[2025-11-19 09:16:34,589] [INFO] [<frozen importlib] - Best f1: 0.2755
[2025-11-19 09:16:34,589] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:16:34,631] [INFO] [<frozen importlib] - Validation Results (threshold=0.4853):
[2025-11-19 09:16:34,631] [INFO] [<frozen importlib] -   Accuracy: 0.8795
[2025-11-19 09:16:34,631] [INFO] [<frozen importlib] -   Precision: 0.2561
[2025-11-19 09:16:34,631] [INFO] [<frozen importlib] -   Recall: 0.2982
[2025-11-19 09:16:34,631] [INFO] [<frozen importlib] -   F1 Score: 0.2755
[2025-11-19 09:16:34,631] [INFO] [<frozen importlib] -   AUROC: 0.7084
[2025-11-19 09:16:34,631] [INFO] [<frozen importlib] -   AUPRC: 0.2223
[2025-11-19 09:16:34,631] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:16:34,631] [INFO] [<frozen importlib] -     TN=16187, FP=1258
[2025-11-19 09:16:34,631] [INFO] [<frozen importlib] -     FN=1019, TP=433
[2025-11-19 09:16:34,654] [INFO] [<frozen importlib] - Trial 327: AUPRC=0.2223, F1=0.4488, Prec=0.3839, Rec=0.5399 | Optimizing auprc=0.2223
[2025-11-19 09:16:34,654] [INFO] [<frozen importlib] - Trial 327 pruned.
[2025-11-19 09:16:34,654] [ERROR] [<frozen importlib] - Trial 327 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  65%|██████▌   | 327/500 [54:32<33:13, 11.52s/it]Best trial: 289. Best value: 0.241792:  65%|██████▌   | 327/500 [54:32<33:13, 11.52s/it]Best trial: 289. Best value: 0.241792:  66%|██████▌   | 328/500 [54:32<32:32, 11.35s/it][2025-11-19 09:16:34,666] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.30515527436819
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] -   gamma: 0.18076386496195807
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] -   alpha: 0.4272417937212129
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] -   lambda: 2.6167078717975167
[2025-11-19 09:16:34,666] [INFO] [<frozen importlib] -   learning_rate: 0.03010379291612935
[2025-11-19 09:16:34,667] [INFO] [<frozen importlib] -   subsample: 0.8089845944661547
[2025-11-19 09:16:34,667] [INFO] [<frozen importlib] -   colsample_bytree: 0.6013748900645528
[2025-11-19 09:16:34,667] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6088393175756431
[2025-11-19 09:16:34,667] [INFO] [<frozen importlib] -   colsample_bynode: 0.8108502376353244
[2025-11-19 09:16:34,667] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:16:34,667] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:16:34,667] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:16:34,667] [INFO] [<frozen importlib] -   scale_pos_weight: 11.30515527436819
[2025-11-19 09:16:34,752] [INFO] [<frozen importlib] - Training with 100 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:16:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:16:34,654] Trial 327 pruned. 
[0]	train-logloss:0.90285	train-auc:0.65366	train-aucpr:0.22867	val-logloss:0.92367	val-auc:0.59447	val-aucpr:0.10549
[10]	train-logloss:0.87406	train-auc:0.67441	train-aucpr:0.27918	val-logloss:0.84762	val-auc:0.65258	val-aucpr:0.16076
[20]	train-logloss:0.85551	train-auc:0.68455	train-aucpr:0.29201	val-logloss:0.79485	val-auc:0.67632	val-aucpr:0.19259
[30]	train-logloss:0.84298	train-auc:0.69049	train-aucpr:0.29689	val-logloss:0.75726	val-auc:0.69037	val-aucpr:0.20310
[40]	train-logloss:0.83374	train-auc:0.69461	train-aucpr:0.30144	val-logloss:0.71806	val-auc:0.69644	val-aucpr:0.21013
[50]	train-logloss:0.82545	train-auc:0.69851	train-aucpr:0.30591	val-logloss:0.69670	val-auc:0.69439	val-aucpr:0.21247
[60]	train-logloss:0.81965	train-auc:0.70196	train-aucpr:0.30966	val-logloss:0.68997	val-auc:0.69606	val-aucpr:0.21290
[70]	train-logloss:0.81493	train-auc:0.70479	train-aucpr:0.31241	val-logloss:0.68962	val-auc:0.69895	val-aucpr:0.21471
[80]	train-logloss:0.81036	train-auc:0.70899	train-aucpr:0.31726	val-logloss:0.69936	val-auc:0.69855	val-aucpr:0.21540
[90]	train-logloss:0.80655	train-auc:0.71184	train-aucpr:0.32079	val-logloss:0.68625	val-auc:0.69600	val-aucpr:0.20804
[99]	train-logloss:0.80400	train-auc:0.71441	train-aucpr:0.32330	val-logloss:0.67657	val-auc:0.69110	val-aucpr:0.19868
[2025-11-19 09:16:35,045] [INFO] [<frozen importlib] - Training completed at iteration 72
[2025-11-19 09:16:35,045] [INFO] [<frozen importlib] - Best train loss: 0.8141
[2025-11-19 09:16:35,045] [INFO] [<frozen importlib] - Best val loss: 0.6885
[2025-11-19 09:16:35,045] [INFO] [<frozen importlib] - Best val AUC: 0.7001
[2025-11-19 09:16:35,045] [INFO] [<frozen importlib] - Best val AUCPR: 0.2160
[2025-11-19 09:16:35,050] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:16:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:16:47,460] [INFO] [<frozen importlib] - Optimal threshold: 0.6274
[2025-11-19 09:16:47,460] [INFO] [<frozen importlib] - Best f1: 0.2746
[2025-11-19 09:16:47,460] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:16:47,504] [INFO] [<frozen importlib] - Validation Results (threshold=0.6274):
[2025-11-19 09:16:47,504] [INFO] [<frozen importlib] -   Accuracy: 0.9063
[2025-11-19 09:16:47,504] [INFO] [<frozen importlib] -   Precision: 0.3391
[2025-11-19 09:16:47,504] [INFO] [<frozen importlib] -   Recall: 0.2307
[2025-11-19 09:16:47,504] [INFO] [<frozen importlib] -   F1 Score: 0.2746
[2025-11-19 09:16:47,504] [INFO] [<frozen importlib] -   AUROC: 0.7001
[2025-11-19 09:16:47,504] [INFO] [<frozen importlib] -   AUPRC: 0.2164
[2025-11-19 09:16:47,504] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:16:47,504] [INFO] [<frozen importlib] -     TN=16792, FP=653
[2025-11-19 09:16:47,504] [INFO] [<frozen importlib] -     FN=1117, TP=335
[2025-11-19 09:16:47,527] [INFO] [<frozen importlib] - Trial 328: AUPRC=0.2164, F1=0.4528, Prec=0.4854, Rec=0.4242 | Optimizing auprc=0.2164
                                                                                        Best trial: 289. Best value: 0.241792:  66%|██████▌   | 328/500 [54:45<32:32, 11.35s/it]Best trial: 289. Best value: 0.241792:  66%|██████▌   | 328/500 [54:45<32:32, 11.35s/it]Best trial: 289. Best value: 0.241792:  66%|██████▌   | 329/500 [54:45<33:39, 11.81s/it][2025-11-19 09:16:47,539] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.591903384305236
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   gamma: 0.11721951496477336
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   alpha: 0.24567927056736674
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   lambda: 1.2749641932813724
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   learning_rate: 0.040278710396729936
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   subsample: 0.8477657370103852
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   colsample_bytree: 0.638460795077336
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5192527885019179
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   colsample_bynode: 0.8060534904134317
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:16:47,539] [INFO] [<frozen importlib] -   scale_pos_weight: 6.591903384305236
[2025-11-19 09:16:47,613] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:16:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:16:47,527] Trial 328 finished with value: 0.21642908553902737 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.18076386496195807, 'learning_rate': 0.03010379291612935, 'n_estimators': 100, 'alpha': 0.4272417937212129, 'lambda': 2.6167078717975167, 'subsample': 0.8089845944661547, 'colsample_bytree': 0.6013748900645528, 'colsample_bylevel': 0.6088393175756431, 'colsample_bynode': 0.8108502376353244, 'scale_pos_weight': 11.30515527436819}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.67645	train-auc:0.64490	train-aucpr:0.23226	val-logloss:0.66915	val-auc:0.62479	val-aucpr:0.14979
[10]	train-logloss:0.65178	train-auc:0.67998	train-aucpr:0.28589	val-logloss:0.60148	val-auc:0.67199	val-aucpr:0.17926
[20]	train-logloss:0.63630	train-auc:0.68717	train-aucpr:0.29915	val-logloss:0.55761	val-auc:0.69074	val-aucpr:0.19472
[30]	train-logloss:0.62642	train-auc:0.69443	train-aucpr:0.30605	val-logloss:0.52585	val-auc:0.69486	val-aucpr:0.20405
[40]	train-logloss:0.61918	train-auc:0.69970	train-aucpr:0.31072	val-logloss:0.50759	val-auc:0.69693	val-aucpr:0.20777
[50]	train-logloss:0.61325	train-auc:0.70414	train-aucpr:0.31603	val-logloss:0.51072	val-auc:0.70220	val-aucpr:0.21392
[60]	train-logloss:0.60913	train-auc:0.70815	train-aucpr:0.31982	val-logloss:0.49848	val-auc:0.70553	val-aucpr:0.21504
[70]	train-logloss:0.60567	train-auc:0.71117	train-aucpr:0.32322	val-logloss:0.49434	val-auc:0.70159	val-aucpr:0.20619
[80]	train-logloss:0.60262	train-auc:0.71523	train-aucpr:0.32777	val-logloss:0.48525	val-auc:0.69692	val-aucpr:0.20251
[89]	train-logloss:0.60035	train-auc:0.71857	train-aucpr:0.33090	val-logloss:0.48269	val-auc:0.69897	val-aucpr:0.20524
[2025-11-19 09:16:47,871] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:16:47,871] [INFO] [<frozen importlib] - Best train loss: 0.6091
[2025-11-19 09:16:47,871] [INFO] [<frozen importlib] - Best val loss: 0.4985
[2025-11-19 09:16:47,871] [INFO] [<frozen importlib] - Best val AUC: 0.7055
[2025-11-19 09:16:47,871] [INFO] [<frozen importlib] - Best val AUCPR: 0.2150
[2025-11-19 09:16:47,876] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:16:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:17:01,418] [INFO] [<frozen importlib] - Optimal threshold: 0.4784
[2025-11-19 09:17:01,418] [INFO] [<frozen importlib] - Best f1: 0.2720
[2025-11-19 09:17:01,418] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:17:01,461] [INFO] [<frozen importlib] - Validation Results (threshold=0.4784):
[2025-11-19 09:17:01,461] [INFO] [<frozen importlib] -   Accuracy: 0.8909
[2025-11-19 09:17:01,461] [INFO] [<frozen importlib] -   Precision: 0.2792
[2025-11-19 09:17:01,461] [INFO] [<frozen importlib] -   Recall: 0.2652
[2025-11-19 09:17:01,461] [INFO] [<frozen importlib] -   F1 Score: 0.2720
[2025-11-19 09:17:01,461] [INFO] [<frozen importlib] -   AUROC: 0.7055
[2025-11-19 09:17:01,461] [INFO] [<frozen importlib] -   AUPRC: 0.2156
[2025-11-19 09:17:01,461] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:17:01,461] [INFO] [<frozen importlib] -     TN=16451, FP=994
[2025-11-19 09:17:01,461] [INFO] [<frozen importlib] -     FN=1067, TP=385
[2025-11-19 09:17:01,488] [INFO] [<frozen importlib] - Trial 329: AUPRC=0.2156, F1=0.4480, Prec=0.4153, Rec=0.4862 | Optimizing auprc=0.2156
[2025-11-19 09:17:01,488] [INFO] [<frozen importlib] - Trial 329 pruned.
[2025-11-19 09:17:01,488] [ERROR] [<frozen importlib] - Trial 329 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  66%|██████▌   | 329/500 [54:59<33:39, 11.81s/it]Best trial: 289. Best value: 0.241792:  66%|██████▌   | 329/500 [54:59<33:39, 11.81s/it]Best trial: 289. Best value: 0.241792:  66%|██████▌   | 330/500 [54:59<35:17, 12.45s/it][2025-11-19 09:17:01,500] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.679433396389493
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   gamma: 0.3867493113770281
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   alpha: 0.5010175197877204
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   lambda: 1.0948575324435261
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   learning_rate: 0.037434686123236735
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   subsample: 0.8255750346907079
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   colsample_bytree: 0.5936697855474625
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5095509944594216
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   colsample_bynode: 0.7822752273530971
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:17:01,500] [INFO] [<frozen importlib] -   scale_pos_weight: 5.679433396389493
[2025-11-19 09:17:01,577] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:17:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:17:01,489] Trial 329 pruned. 
[0]	train-logloss:0.62612	train-auc:0.63961	train-aucpr:0.22324	val-logloss:0.61197	val-auc:0.54387	val-aucpr:0.10244
[10]	train-logloss:0.60470	train-auc:0.68263	train-aucpr:0.29301	val-logloss:0.56591	val-auc:0.69593	val-aucpr:0.20770
[20]	train-logloss:0.59137	train-auc:0.68864	train-aucpr:0.29970	val-logloss:0.52818	val-auc:0.69874	val-aucpr:0.21764
[30]	train-logloss:0.58199	train-auc:0.69271	train-aucpr:0.30524	val-logloss:0.50366	val-auc:0.70103	val-aucpr:0.22518
[40]	train-logloss:0.57555	train-auc:0.69663	train-aucpr:0.30942	val-logloss:0.48172	val-auc:0.71350	val-aucpr:0.23154
[50]	train-logloss:0.57021	train-auc:0.70075	train-aucpr:0.31335	val-logloss:0.47823	val-auc:0.70646	val-aucpr:0.23157
[60]	train-logloss:0.56644	train-auc:0.70478	train-aucpr:0.31759	val-logloss:0.47520	val-auc:0.70582	val-aucpr:0.23150
[70]	train-logloss:0.56329	train-auc:0.70809	train-aucpr:0.32136	val-logloss:0.46539	val-auc:0.70867	val-aucpr:0.23475
[80]	train-logloss:0.56055	train-auc:0.71151	train-aucpr:0.32512	val-logloss:0.45911	val-auc:0.70834	val-aucpr:0.23137
[90]	train-logloss:0.55827	train-auc:0.71502	train-aucpr:0.32898	val-logloss:0.45149	val-auc:0.69996	val-aucpr:0.21862
[98]	train-logloss:0.55632	train-auc:0.71864	train-aucpr:0.33248	val-logloss:0.44918	val-auc:0.69858	val-aucpr:0.22094
[2025-11-19 09:17:01,858] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:17:01,858] [INFO] [<frozen importlib] - Best train loss: 0.5638
[2025-11-19 09:17:01,858] [INFO] [<frozen importlib] - Best val loss: 0.4682
[2025-11-19 09:17:01,858] [INFO] [<frozen importlib] - Best val AUC: 0.7092
[2025-11-19 09:17:01,858] [INFO] [<frozen importlib] - Best val AUCPR: 0.2356
[2025-11-19 09:17:01,862] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:17:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:17:15,241] [INFO] [<frozen importlib] - Optimal threshold: 0.4582
[2025-11-19 09:17:15,241] [INFO] [<frozen importlib] - Best f1: 0.2798
[2025-11-19 09:17:15,241] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:17:15,285] [INFO] [<frozen importlib] - Validation Results (threshold=0.4582):
[2025-11-19 09:17:15,286] [INFO] [<frozen importlib] -   Accuracy: 0.8998
[2025-11-19 09:17:15,286] [INFO] [<frozen importlib] -   Precision: 0.3124
[2025-11-19 09:17:15,286] [INFO] [<frozen importlib] -   Recall: 0.2534
[2025-11-19 09:17:15,286] [INFO] [<frozen importlib] -   F1 Score: 0.2798
[2025-11-19 09:17:15,286] [INFO] [<frozen importlib] -   AUROC: 0.7092
[2025-11-19 09:17:15,286] [INFO] [<frozen importlib] -   AUPRC: 0.2360
[2025-11-19 09:17:15,286] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:17:15,286] [INFO] [<frozen importlib] -     TN=16635, FP=810
[2025-11-19 09:17:15,286] [INFO] [<frozen importlib] -     FN=1084, TP=368
[2025-11-19 09:17:15,311] [INFO] [<frozen importlib] - Trial 330: AUPRC=0.2360, F1=0.4602, Prec=0.4549, Rec=0.4656 | Optimizing auprc=0.2360
                                                                                        Best trial: 289. Best value: 0.241792:  66%|██████▌   | 330/500 [55:13<35:17, 12.45s/it]Best trial: 289. Best value: 0.241792:  66%|██████▌   | 330/500 [55:13<35:17, 12.45s/it]Best trial: 289. Best value: 0.241792:  66%|██████▌   | 331/500 [55:13<36:14, 12.87s/it][2025-11-19 09:17:15,324] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.599351538774196
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   gamma: 0.40987789590031054
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   alpha: 0.4897141649150558
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   lambda: 1.1088979467883993
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   learning_rate: 0.03809817559351669
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   subsample: 0.8228620474029851
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   colsample_bytree: 0.6211264478659728
[2025-11-19 09:17:15,324] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5076491997409155
[2025-11-19 09:17:15,325] [INFO] [<frozen importlib] -   colsample_bynode: 0.7959591625561426
[2025-11-19 09:17:15,325] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:17:15,325] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:17:15,325] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:17:15,325] [INFO] [<frozen importlib] -   scale_pos_weight: 5.599351538774196
[2025-11-19 09:17:15,401] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:17:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:17:15,312] Trial 330 finished with value: 0.23601498859123377 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.3867493113770281, 'learning_rate': 0.037434686123236735, 'n_estimators': 300, 'alpha': 0.5010175197877204, 'lambda': 1.0948575324435261, 'subsample': 0.8255750346907079, 'colsample_bytree': 0.5936697855474625, 'colsample_bylevel': 0.5095509944594216, 'colsample_bynode': 0.7822752273530971, 'scale_pos_weight': 5.679433396389493}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.62153	train-auc:0.63521	train-aucpr:0.21682	val-logloss:0.60821	val-auc:0.58751	val-aucpr:0.10049
[10]	train-logloss:0.59943	train-auc:0.67698	train-aucpr:0.29363	val-logloss:0.55579	val-auc:0.69755	val-aucpr:0.21333
[20]	train-logloss:0.58595	train-auc:0.68747	train-aucpr:0.30181	val-logloss:0.52106	val-auc:0.69786	val-aucpr:0.21472
[30]	train-logloss:0.57740	train-auc:0.69316	train-aucpr:0.30551	val-logloss:0.49516	val-auc:0.69208	val-aucpr:0.22049
[40]	train-logloss:0.57088	train-auc:0.69781	train-aucpr:0.31034	val-logloss:0.47533	val-auc:0.70505	val-aucpr:0.22543
[50]	train-logloss:0.56546	train-auc:0.70279	train-aucpr:0.31466	val-logloss:0.46134	val-auc:0.70250	val-aucpr:0.22394
[60]	train-logloss:0.56199	train-auc:0.70544	train-aucpr:0.31793	val-logloss:0.45169	val-auc:0.70321	val-aucpr:0.22864
[70]	train-logloss:0.55878	train-auc:0.70855	train-aucpr:0.32173	val-logloss:0.44538	val-auc:0.69942	val-aucpr:0.22527
[80]	train-logloss:0.55623	train-auc:0.71185	train-aucpr:0.32486	val-logloss:0.44259	val-auc:0.69420	val-aucpr:0.21689
[86]	train-logloss:0.55460	train-auc:0.71482	train-aucpr:0.32755	val-logloss:0.44246	val-auc:0.68685	val-aucpr:0.20103
[2025-11-19 09:17:15,659] [INFO] [<frozen importlib] - Training completed at iteration 57
[2025-11-19 09:17:15,659] [INFO] [<frozen importlib] - Best train loss: 0.5630
[2025-11-19 09:17:15,659] [INFO] [<frozen importlib] - Best val loss: 0.4540
[2025-11-19 09:17:15,659] [INFO] [<frozen importlib] - Best val AUC: 0.7030
[2025-11-19 09:17:15,659] [INFO] [<frozen importlib] - Best val AUCPR: 0.2294
[2025-11-19 09:17:15,665] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:17:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:17:27,868] [INFO] [<frozen importlib] - Optimal threshold: 0.4356
[2025-11-19 09:17:27,868] [INFO] [<frozen importlib] - Best f1: 0.2858
[2025-11-19 09:17:27,869] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:17:27,921] [INFO] [<frozen importlib] - Validation Results (threshold=0.4356):
[2025-11-19 09:17:27,921] [INFO] [<frozen importlib] -   Accuracy: 0.9032
[2025-11-19 09:17:27,921] [INFO] [<frozen importlib] -   Precision: 0.3300
[2025-11-19 09:17:27,921] [INFO] [<frozen importlib] -   Recall: 0.2521
[2025-11-19 09:17:27,921] [INFO] [<frozen importlib] -   F1 Score: 0.2858
[2025-11-19 09:17:27,921] [INFO] [<frozen importlib] -   AUROC: 0.7030
[2025-11-19 09:17:27,921] [INFO] [<frozen importlib] -   AUPRC: 0.2297
[2025-11-19 09:17:27,921] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:17:27,921] [INFO] [<frozen importlib] -     TN=16702, FP=743
[2025-11-19 09:17:27,921] [INFO] [<frozen importlib] -     FN=1086, TP=366
[2025-11-19 09:17:27,944] [INFO] [<frozen importlib] - Trial 331: AUPRC=0.2297, F1=0.4640, Prec=0.4716, Rec=0.4566 | Optimizing auprc=0.2297
[2025-11-19 09:17:27,944] [INFO] [<frozen importlib] - Trial 331 pruned.
[2025-11-19 09:17:27,944] [ERROR] [<frozen importlib] - Trial 331 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  66%|██████▌   | 331/500 [55:25<36:14, 12.87s/it]Best trial: 289. Best value: 0.241792:  66%|██████▌   | 331/500 [55:25<36:14, 12.87s/it]Best trial: 289. Best value: 0.241792:  66%|██████▋   | 332/500 [55:25<35:49, 12.80s/it][2025-11-19 09:17:27,957] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.251405851390779
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   gamma: 0.3681603634219105
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   alpha: 0.49140604592237236
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   lambda: 1.039719989779494
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   learning_rate: 0.03585435373354634
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   subsample: 0.8244096806610367
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   colsample_bytree: 0.5978019171985525
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   colsample_bylevel: 0.52888762139767
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   colsample_bynode: 0.7868709479061604
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:17:27,957] [INFO] [<frozen importlib] -   scale_pos_weight: 5.251405851390779
[2025-11-19 09:17:28,038] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:17:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:17:27,944] Trial 331 pruned. 
[0]	train-logloss:0.60185	train-auc:0.63961	train-aucpr:0.22324	val-logloss:0.58427	val-auc:0.54387	val-aucpr:0.10244
[10]	train-logloss:0.58189	train-auc:0.68209	train-aucpr:0.28971	val-logloss:0.55132	val-auc:0.68662	val-aucpr:0.16965
[20]	train-logloss:0.56919	train-auc:0.68773	train-aucpr:0.29796	val-logloss:0.51654	val-auc:0.70531	val-aucpr:0.21692
[30]	train-logloss:0.56019	train-auc:0.69263	train-aucpr:0.30440	val-logloss:0.48930	val-auc:0.70121	val-aucpr:0.22399
[40]	train-logloss:0.55403	train-auc:0.69581	train-aucpr:0.30893	val-logloss:0.46952	val-auc:0.71377	val-aucpr:0.23536
[50]	train-logloss:0.54894	train-auc:0.70093	train-aucpr:0.31397	val-logloss:0.45229	val-auc:0.71406	val-aucpr:0.23678
[60]	train-logloss:0.54540	train-auc:0.70451	train-aucpr:0.31770	val-logloss:0.44636	val-auc:0.71574	val-aucpr:0.23795
[70]	train-logloss:0.54225	train-auc:0.70783	train-aucpr:0.32120	val-logloss:0.44649	val-auc:0.72232	val-aucpr:0.23829
[80]	train-logloss:0.53929	train-auc:0.71175	train-aucpr:0.32599	val-logloss:0.44156	val-auc:0.71933	val-aucpr:0.23494
[90]	train-logloss:0.53725	train-auc:0.71528	train-aucpr:0.32877	val-logloss:0.43259	val-auc:0.71547	val-aucpr:0.22809
[93]	train-logloss:0.53656	train-auc:0.71683	train-aucpr:0.33027	val-logloss:0.42122	val-auc:0.71323	val-aucpr:0.22551
[2025-11-19 09:17:28,307] [INFO] [<frozen importlib] - Training completed at iteration 63
[2025-11-19 09:17:28,307] [INFO] [<frozen importlib] - Best train loss: 0.5446
[2025-11-19 09:17:28,307] [INFO] [<frozen importlib] - Best val loss: 0.4435
[2025-11-19 09:17:28,307] [INFO] [<frozen importlib] - Best val AUC: 0.7224
[2025-11-19 09:17:28,307] [INFO] [<frozen importlib] - Best val AUCPR: 0.2394
[2025-11-19 09:17:28,312] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:17:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:17:41,651] [INFO] [<frozen importlib] - Optimal threshold: 0.4174
[2025-11-19 09:17:41,651] [INFO] [<frozen importlib] - Best f1: 0.2944
[2025-11-19 09:17:41,651] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:17:41,697] [INFO] [<frozen importlib] - Validation Results (threshold=0.4174):
[2025-11-19 09:17:41,697] [INFO] [<frozen importlib] -   Accuracy: 0.9072
[2025-11-19 09:17:41,697] [INFO] [<frozen importlib] -   Precision: 0.3540
[2025-11-19 09:17:41,697] [INFO] [<frozen importlib] -   Recall: 0.2521
[2025-11-19 09:17:41,697] [INFO] [<frozen importlib] -   F1 Score: 0.2944
[2025-11-19 09:17:41,697] [INFO] [<frozen importlib] -   AUROC: 0.7224
[2025-11-19 09:17:41,697] [INFO] [<frozen importlib] -   AUPRC: 0.2397
[2025-11-19 09:17:41,697] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:17:41,697] [INFO] [<frozen importlib] -     TN=16777, FP=668
[2025-11-19 09:17:41,697] [INFO] [<frozen importlib] -     FN=1086, TP=366
[2025-11-19 09:17:41,722] [INFO] [<frozen importlib] - Trial 332: AUPRC=0.2397, F1=0.4514, Prec=0.4806, Rec=0.4256 | Optimizing auprc=0.2397
                                                                                        Best trial: 289. Best value: 0.241792:  66%|██████▋   | 332/500 [55:39<35:49, 12.80s/it]Best trial: 289. Best value: 0.241792:  66%|██████▋   | 332/500 [55:39<35:49, 12.80s/it]Best trial: 289. Best value: 0.241792:  67%|██████▋   | 333/500 [55:39<36:26, 13.09s/it][2025-11-19 09:17:41,735] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.05328993396901
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   gamma: 0.39114719182641394
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   alpha: 0.5133820597231383
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   lambda: 0.953021192435827
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   learning_rate: 0.03596297026751407
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   subsample: 0.8355336046093967
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   colsample_bytree: 0.5965172883613398
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5859350757134584
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   colsample_bynode: 0.8217719483876896
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:17:41,735] [INFO] [<frozen importlib] -   scale_pos_weight: 5.05328993396901
[2025-11-19 09:17:41,812] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:17:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:17:41,723] Trial 332 finished with value: 0.23974556705159628 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.3681603634219105, 'learning_rate': 0.03585435373354634, 'n_estimators': 350, 'alpha': 0.49140604592237236, 'lambda': 1.039719989779494, 'subsample': 0.8244096806610367, 'colsample_bytree': 0.5978019171985525, 'colsample_bylevel': 0.52888762139767, 'colsample_bynode': 0.7868709479061604, 'scale_pos_weight': 5.251405851390779}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.59042	train-auc:0.63924	train-aucpr:0.24200	val-logloss:0.57248	val-auc:0.59195	val-aucpr:0.12616
[10]	train-logloss:0.57047	train-auc:0.68511	train-aucpr:0.29276	val-logloss:0.53449	val-auc:0.66127	val-aucpr:0.17527
[20]	train-logloss:0.55803	train-auc:0.69172	train-aucpr:0.29821	val-logloss:0.50064	val-auc:0.70079	val-aucpr:0.20899
[30]	train-logloss:0.54928	train-auc:0.69536	train-aucpr:0.30369	val-logloss:0.47318	val-auc:0.69612	val-aucpr:0.21536
[40]	train-logloss:0.54318	train-auc:0.69826	train-aucpr:0.30777	val-logloss:0.45117	val-auc:0.70524	val-aucpr:0.22025
[50]	train-logloss:0.53816	train-auc:0.70189	train-aucpr:0.31294	val-logloss:0.44877	val-auc:0.70436	val-aucpr:0.22034
[60]	train-logloss:0.53463	train-auc:0.70584	train-aucpr:0.31821	val-logloss:0.45032	val-auc:0.70268	val-aucpr:0.22041
[70]	train-logloss:0.53150	train-auc:0.70935	train-aucpr:0.32179	val-logloss:0.44883	val-auc:0.70493	val-aucpr:0.21776
[76]	train-logloss:0.52992	train-auc:0.71196	train-aucpr:0.32456	val-logloss:0.44760	val-auc:0.69933	val-aucpr:0.21155
[2025-11-19 09:17:42,043] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 09:17:42,043] [INFO] [<frozen importlib] - Best train loss: 0.5395
[2025-11-19 09:17:42,043] [INFO] [<frozen importlib] - Best val loss: 0.4445
[2025-11-19 09:17:42,043] [INFO] [<frozen importlib] - Best val AUC: 0.7097
[2025-11-19 09:17:42,043] [INFO] [<frozen importlib] - Best val AUCPR: 0.2230
[2025-11-19 09:17:42,048] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:17:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:17:52,487] [INFO] [<frozen importlib] - Optimal threshold: 0.4088
[2025-11-19 09:17:52,487] [INFO] [<frozen importlib] - Best f1: 0.2835
[2025-11-19 09:17:52,487] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:17:52,535] [INFO] [<frozen importlib] - Validation Results (threshold=0.4088):
[2025-11-19 09:17:52,535] [INFO] [<frozen importlib] -   Accuracy: 0.8901
[2025-11-19 09:17:52,535] [INFO] [<frozen importlib] -   Precision: 0.2840
[2025-11-19 09:17:52,535] [INFO] [<frozen importlib] -   Recall: 0.2831
[2025-11-19 09:17:52,535] [INFO] [<frozen importlib] -   F1 Score: 0.2835
[2025-11-19 09:17:52,535] [INFO] [<frozen importlib] -   AUROC: 0.7097
[2025-11-19 09:17:52,535] [INFO] [<frozen importlib] -   AUPRC: 0.2237
[2025-11-19 09:17:52,536] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:17:52,536] [INFO] [<frozen importlib] -     TN=16409, FP=1036
[2025-11-19 09:17:52,536] [INFO] [<frozen importlib] -     FN=1041, TP=411
[2025-11-19 09:17:52,562] [INFO] [<frozen importlib] - Trial 333: AUPRC=0.2237, F1=0.4445, Prec=0.4070, Rec=0.4897 | Optimizing auprc=0.2237
[2025-11-19 09:17:52,563] [INFO] [<frozen importlib] - Trial 333 pruned.
[2025-11-19 09:17:52,563] [ERROR] [<frozen importlib] - Trial 333 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  67%|██████▋   | 333/500 [55:50<36:26, 13.09s/it]Best trial: 289. Best value: 0.241792:  67%|██████▋   | 333/500 [55:50<36:26, 13.09s/it]Best trial: 289. Best value: 0.241792:  67%|██████▋   | 334/500 [55:50<34:20, 12.42s/it][2025-11-19 09:17:52,575] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.428973045270576
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   gamma: 0.37496128666436895
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   alpha: 0.47639692424316155
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   lambda: 1.0503653827412909
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   learning_rate: 0.03683401122739208
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   subsample: 0.8070555420793634
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   colsample_bytree: 0.6064323011704115
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5328443398922414
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   colsample_bynode: 0.8032938999059056
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:17:52,576] [INFO] [<frozen importlib] -   scale_pos_weight: 5.428973045270576
[2025-11-19 09:17:52,649] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:17:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:17:52,563] Trial 333 pruned. 
[0]	train-logloss:0.61156	train-auc:0.65176	train-aucpr:0.23809	val-logloss:0.60445	val-auc:0.48813	val-aucpr:0.07054
[10]	train-logloss:0.59068	train-auc:0.67994	train-aucpr:0.29178	val-logloss:0.55017	val-auc:0.68952	val-aucpr:0.20694
[20]	train-logloss:0.57768	train-auc:0.68941	train-aucpr:0.29952	val-logloss:0.51349	val-auc:0.71808	val-aucpr:0.22098
[30]	train-logloss:0.56872	train-auc:0.69433	train-aucpr:0.30364	val-logloss:0.48680	val-auc:0.71266	val-aucpr:0.21994
[40]	train-logloss:0.56252	train-auc:0.69845	train-aucpr:0.30788	val-logloss:0.47666	val-auc:0.71337	val-aucpr:0.22235
[50]	train-logloss:0.55735	train-auc:0.70091	train-aucpr:0.31266	val-logloss:0.45439	val-auc:0.71319	val-aucpr:0.22894
[60]	train-logloss:0.55375	train-auc:0.70406	train-aucpr:0.31666	val-logloss:0.44767	val-auc:0.71504	val-aucpr:0.22696
[70]	train-logloss:0.55065	train-auc:0.70767	train-aucpr:0.32060	val-logloss:0.43918	val-auc:0.70994	val-aucpr:0.22212
[80]	train-logloss:0.54807	train-auc:0.70992	train-aucpr:0.32453	val-logloss:0.43306	val-auc:0.71148	val-aucpr:0.21892
[83]	train-logloss:0.54745	train-auc:0.71074	train-aucpr:0.32538	val-logloss:0.43363	val-auc:0.70546	val-aucpr:0.21265
[2025-11-19 09:17:52,890] [INFO] [<frozen importlib] - Training completed at iteration 53
[2025-11-19 09:17:52,890] [INFO] [<frozen importlib] - Best train loss: 0.5561
[2025-11-19 09:17:52,890] [INFO] [<frozen importlib] - Best val loss: 0.4536
[2025-11-19 09:17:52,890] [INFO] [<frozen importlib] - Best val AUC: 0.7154
[2025-11-19 09:17:52,890] [INFO] [<frozen importlib] - Best val AUCPR: 0.2291
[2025-11-19 09:17:52,896] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:17:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:18:04,350] [INFO] [<frozen importlib] - Optimal threshold: 0.4209
[2025-11-19 09:18:04,350] [INFO] [<frozen importlib] - Best f1: 0.2850
[2025-11-19 09:18:04,350] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:18:04,404] [INFO] [<frozen importlib] - Validation Results (threshold=0.4209):
[2025-11-19 09:18:04,404] [INFO] [<frozen importlib] -   Accuracy: 0.8864
[2025-11-19 09:18:04,404] [INFO] [<frozen importlib] -   Precision: 0.2760
[2025-11-19 09:18:04,404] [INFO] [<frozen importlib] -   Recall: 0.2948
[2025-11-19 09:18:04,404] [INFO] [<frozen importlib] -   F1 Score: 0.2850
[2025-11-19 09:18:04,404] [INFO] [<frozen importlib] -   AUROC: 0.7154
[2025-11-19 09:18:04,404] [INFO] [<frozen importlib] -   AUPRC: 0.2295
[2025-11-19 09:18:04,404] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:18:04,404] [INFO] [<frozen importlib] -     TN=16322, FP=1123
[2025-11-19 09:18:04,404] [INFO] [<frozen importlib] -     FN=1024, TP=428
[2025-11-19 09:18:04,427] [INFO] [<frozen importlib] - Trial 334: AUPRC=0.2295, F1=0.4394, Prec=0.3923, Rec=0.4993 | Optimizing auprc=0.2295
                                                                                        Best trial: 289. Best value: 0.241792:  67%|██████▋   | 334/500 [56:02<34:20, 12.42s/it]Best trial: 289. Best value: 0.241792:  67%|██████▋   | 334/500 [56:02<34:20, 12.42s/it]Best trial: 289. Best value: 0.241792:  67%|██████▋   | 335/500 [56:02<33:41, 12.25s/it][2025-11-19 09:18:04,439] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.813126656510987
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   gamma: 0.3614900923188518
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   alpha: 0.5226817583947527
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   lambda: 1.0664393080796846
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   learning_rate: 0.03523580816384133
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   subsample: 0.8173925423108234
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   colsample_bytree: 0.6153729117143706
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   colsample_bylevel: 0.525449608954365
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   colsample_bynode: 0.7879947266156079
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:18:04,439] [INFO] [<frozen importlib] -   scale_pos_weight: 5.813126656510987
[2025-11-19 09:18:04,514] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:18:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:18:04,427] Trial 334 finished with value: 0.229537172003915 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.37496128666436895, 'learning_rate': 0.03683401122739208, 'n_estimators': 350, 'alpha': 0.47639692424316155, 'lambda': 1.0503653827412909, 'subsample': 0.8070555420793634, 'colsample_bytree': 0.6064323011704115, 'colsample_bylevel': 0.5328443398922414, 'colsample_bynode': 0.8032938999059056, 'scale_pos_weight': 5.428973045270576}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.63364	train-auc:0.64120	train-aucpr:0.24228	val-logloss:0.62286	val-auc:0.58553	val-aucpr:0.11240
[10]	train-logloss:0.61225	train-auc:0.68172	train-aucpr:0.29587	val-logloss:0.56939	val-auc:0.70564	val-aucpr:0.20136
[20]	train-logloss:0.59856	train-auc:0.68634	train-aucpr:0.30183	val-logloss:0.53328	val-auc:0.70316	val-aucpr:0.20648
[30]	train-logloss:0.58977	train-auc:0.69090	train-aucpr:0.30611	val-logloss:0.51751	val-auc:0.70395	val-aucpr:0.21045
[40]	train-logloss:0.58339	train-auc:0.69628	train-aucpr:0.31014	val-logloss:0.50304	val-auc:0.69918	val-aucpr:0.20676
[50]	train-logloss:0.57799	train-auc:0.70084	train-aucpr:0.31441	val-logloss:0.50066	val-auc:0.69858	val-aucpr:0.21011
[60]	train-logloss:0.57450	train-auc:0.70374	train-aucpr:0.31723	val-logloss:0.49108	val-auc:0.69866	val-aucpr:0.21455
[70]	train-logloss:0.57123	train-auc:0.70638	train-aucpr:0.31987	val-logloss:0.48957	val-auc:0.69863	val-aucpr:0.21460
[80]	train-logloss:0.56851	train-auc:0.70972	train-aucpr:0.32370	val-logloss:0.47695	val-auc:0.68970	val-aucpr:0.20884
[90]	train-logloss:0.56594	train-auc:0.71287	train-aucpr:0.32748	val-logloss:0.47135	val-auc:0.68799	val-aucpr:0.20632
[100]	train-logloss:0.56360	train-auc:0.71615	train-aucpr:0.33114	val-logloss:0.45865	val-auc:0.68255	val-aucpr:0.19503
[2025-11-19 09:18:04,808] [INFO] [<frozen importlib] - Training completed at iteration 71
[2025-11-19 09:18:04,808] [INFO] [<frozen importlib] - Best train loss: 0.5711
[2025-11-19 09:18:04,808] [INFO] [<frozen importlib] - Best val loss: 0.4894
[2025-11-19 09:18:04,808] [INFO] [<frozen importlib] - Best val AUC: 0.6993
[2025-11-19 09:18:04,808] [INFO] [<frozen importlib] - Best val AUCPR: 0.2162
[2025-11-19 09:18:04,814] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:18:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:18:18,964] [INFO] [<frozen importlib] - Optimal threshold: 0.4711
[2025-11-19 09:18:18,964] [INFO] [<frozen importlib] - Best f1: 0.2704
[2025-11-19 09:18:18,964] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:18:19,010] [INFO] [<frozen importlib] - Validation Results (threshold=0.4711):
[2025-11-19 09:18:19,010] [INFO] [<frozen importlib] -   Accuracy: 0.9035
[2025-11-19 09:18:19,010] [INFO] [<frozen importlib] -   Precision: 0.3225
[2025-11-19 09:18:19,010] [INFO] [<frozen importlib] -   Recall: 0.2328
[2025-11-19 09:18:19,010] [INFO] [<frozen importlib] -   F1 Score: 0.2704
[2025-11-19 09:18:19,010] [INFO] [<frozen importlib] -   AUROC: 0.6993
[2025-11-19 09:18:19,010] [INFO] [<frozen importlib] -   AUPRC: 0.2167
[2025-11-19 09:18:19,010] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:18:19,010] [INFO] [<frozen importlib] -     TN=16735, FP=710
[2025-11-19 09:18:19,010] [INFO] [<frozen importlib] -     FN=1114, TP=338
[2025-11-19 09:18:19,034] [INFO] [<frozen importlib] - Trial 335: AUPRC=0.2167, F1=0.4513, Prec=0.4701, Rec=0.4339 | Optimizing auprc=0.2167
[2025-11-19 09:18:19,034] [INFO] [<frozen importlib] - Trial 335 pruned.
[2025-11-19 09:18:19,035] [ERROR] [<frozen importlib] - Trial 335 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  67%|██████▋   | 335/500 [56:17<33:41, 12.25s/it]Best trial: 289. Best value: 0.241792:  67%|██████▋   | 335/500 [56:17<33:41, 12.25s/it]Best trial: 289. Best value: 0.241792:  67%|██████▋   | 336/500 [56:17<35:24, 12.96s/it][2025-11-19 09:18:19,047] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.08539738136956
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] -   gamma: 0.7162819354492858
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] -   alpha: 0.4447636330790221
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] -   lambda: 0.9142447804563862
[2025-11-19 09:18:19,047] [INFO] [<frozen importlib] -   learning_rate: 0.03774078855732676
[2025-11-19 09:18:19,048] [INFO] [<frozen importlib] -   subsample: 0.8305431017352639
[2025-11-19 09:18:19,048] [INFO] [<frozen importlib] -   colsample_bytree: 0.5935637051739717
[2025-11-19 09:18:19,048] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5793738937418411
[2025-11-19 09:18:19,048] [INFO] [<frozen importlib] -   colsample_bynode: 0.7781744921757137
[2025-11-19 09:18:19,048] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:18:19,048] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:18:19,048] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:18:19,048] [INFO] [<frozen importlib] -   scale_pos_weight: 5.08539738136956
[2025-11-19 09:18:19,125] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:18:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:18:19,035] Trial 335 pruned. 
[0]	train-logloss:0.59214	train-auc:0.63907	train-aucpr:0.24114	val-logloss:0.57435	val-auc:0.59211	val-aucpr:0.12567
[10]	train-logloss:0.57169	train-auc:0.68406	train-aucpr:0.29405	val-logloss:0.53240	val-auc:0.66001	val-aucpr:0.17704
[20]	train-logloss:0.55900	train-auc:0.69036	train-aucpr:0.30118	val-logloss:0.49770	val-auc:0.70743	val-aucpr:0.21191
[30]	train-logloss:0.55009	train-auc:0.69600	train-aucpr:0.30652	val-logloss:0.47428	val-auc:0.69824	val-aucpr:0.21600
[40]	train-logloss:0.54388	train-auc:0.69995	train-aucpr:0.31089	val-logloss:0.45785	val-auc:0.70555	val-aucpr:0.22119
[50]	train-logloss:0.53901	train-auc:0.70402	train-aucpr:0.31523	val-logloss:0.44940	val-auc:0.70651	val-aucpr:0.22061
[60]	train-logloss:0.53543	train-auc:0.70623	train-aucpr:0.31861	val-logloss:0.44153	val-auc:0.70621	val-aucpr:0.22052
[70]	train-logloss:0.53227	train-auc:0.70933	train-aucpr:0.32282	val-logloss:0.43535	val-auc:0.70602	val-aucpr:0.21968
[77]	train-logloss:0.53047	train-auc:0.71098	train-aucpr:0.32548	val-logloss:0.43274	val-auc:0.70593	val-aucpr:0.21939
[2025-11-19 09:18:19,356] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 09:18:19,356] [INFO] [<frozen importlib] - Best train loss: 0.5403
[2025-11-19 09:18:19,356] [INFO] [<frozen importlib] - Best val loss: 0.4476
[2025-11-19 09:18:19,356] [INFO] [<frozen importlib] - Best val AUC: 0.7084
[2025-11-19 09:18:19,356] [INFO] [<frozen importlib] - Best val AUCPR: 0.2247
[2025-11-19 09:18:19,361] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:18:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:18:30,158] [INFO] [<frozen importlib] - Optimal threshold: 0.4030
[2025-11-19 09:18:30,158] [INFO] [<frozen importlib] - Best f1: 0.2841
[2025-11-19 09:18:30,158] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:18:30,205] [INFO] [<frozen importlib] - Validation Results (threshold=0.4030):
[2025-11-19 09:18:30,205] [INFO] [<frozen importlib] -   Accuracy: 0.8874
[2025-11-19 09:18:30,205] [INFO] [<frozen importlib] -   Precision: 0.2778
[2025-11-19 09:18:30,205] [INFO] [<frozen importlib] -   Recall: 0.2906
[2025-11-19 09:18:30,205] [INFO] [<frozen importlib] -   F1 Score: 0.2841
[2025-11-19 09:18:30,205] [INFO] [<frozen importlib] -   AUROC: 0.7084
[2025-11-19 09:18:30,205] [INFO] [<frozen importlib] -   AUPRC: 0.2255
[2025-11-19 09:18:30,205] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:18:30,205] [INFO] [<frozen importlib] -     TN=16348, FP=1097
[2025-11-19 09:18:30,205] [INFO] [<frozen importlib] -     FN=1030, TP=422
[2025-11-19 09:18:30,229] [INFO] [<frozen importlib] - Trial 336: AUPRC=0.2255, F1=0.4178, Prec=0.3802, Rec=0.4635 | Optimizing auprc=0.2255
                                                                                        Best trial: 289. Best value: 0.241792:  67%|██████▋   | 336/500 [56:28<35:24, 12.96s/it]Best trial: 289. Best value: 0.241792:  67%|██████▋   | 336/500 [56:28<35:24, 12.96s/it]Best trial: 289. Best value: 0.241792:  67%|██████▋   | 337/500 [56:28<33:45, 12.43s/it][2025-11-19 09:18:30,242] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 15.699425341961366
[2025-11-19 09:18:30,242] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:18:30,242] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:18:30,242] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:18:30,242] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:18:30,242] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   gamma: 0.39167931358316455
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   alpha: 0.48631134016893973
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   lambda: 1.200845356177939
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   learning_rate: 0.040573249936047565
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   subsample: 0.804854229266087
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   colsample_bytree: 0.6067953598631015
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5003677796603173
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   colsample_bynode: 0.7963374452198466
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:18:30,243] [INFO] [<frozen importlib] -   scale_pos_weight: 15.699425341961366
[2025-11-19 09:18:30,316] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:18:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:18:30,230] Trial 336 finished with value: 0.22550686080676002 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.7162819354492858, 'learning_rate': 0.03774078855732676, 'n_estimators': 350, 'alpha': 0.4447636330790221, 'lambda': 0.9142447804563862, 'subsample': 0.8305431017352639, 'colsample_bytree': 0.5935637051739717, 'colsample_bylevel': 0.5793738937418411, 'colsample_bynode': 0.7781744921757137, 'scale_pos_weight': 5.08539738136956}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:1.05647	train-auc:0.64009	train-aucpr:0.22560	val-logloss:1.09204	val-auc:0.57857	val-aucpr:0.11699
[10]	train-logloss:1.01757	train-auc:0.68284	train-aucpr:0.29052	val-logloss:0.96816	val-auc:0.69985	val-aucpr:0.19251
[20]	train-logloss:0.99738	train-auc:0.68969	train-aucpr:0.29639	val-logloss:0.90385	val-auc:0.70485	val-aucpr:0.21209
[30]	train-logloss:0.98446	train-auc:0.69395	train-aucpr:0.30199	val-logloss:0.86705	val-auc:0.70446	val-aucpr:0.22236
[40]	train-logloss:0.97499	train-auc:0.69971	train-aucpr:0.30713	val-logloss:0.83731	val-auc:0.70328	val-aucpr:0.22444
[50]	train-logloss:0.96681	train-auc:0.70475	train-aucpr:0.31152	val-logloss:0.79476	val-auc:0.69872	val-aucpr:0.21467
[60]	train-logloss:0.96032	train-auc:0.71044	train-aucpr:0.31572	val-logloss:0.78717	val-auc:0.69236	val-aucpr:0.21147
[69]	train-logloss:0.95525	train-auc:0.71426	train-aucpr:0.32023	val-logloss:0.77285	val-auc:0.69075	val-aucpr:0.20689
[2025-11-19 09:18:30,529] [INFO] [<frozen importlib] - Training completed at iteration 40
[2025-11-19 09:18:30,529] [INFO] [<frozen importlib] - Best train loss: 0.9750
[2025-11-19 09:18:30,529] [INFO] [<frozen importlib] - Best val loss: 0.8373
[2025-11-19 09:18:30,529] [INFO] [<frozen importlib] - Best val AUC: 0.7033
[2025-11-19 09:18:30,529] [INFO] [<frozen importlib] - Best val AUCPR: 0.2244
[2025-11-19 09:18:30,534] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:18:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:18:39,673] [INFO] [<frozen importlib] - Optimal threshold: 0.6807
[2025-11-19 09:18:39,673] [INFO] [<frozen importlib] - Best f1: 0.2676
[2025-11-19 09:18:39,673] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:18:39,718] [INFO] [<frozen importlib] - Validation Results (threshold=0.6807):
[2025-11-19 09:18:39,719] [INFO] [<frozen importlib] -   Accuracy: 0.8943
[2025-11-19 09:18:39,719] [INFO] [<frozen importlib] -   Precision: 0.2861
[2025-11-19 09:18:39,719] [INFO] [<frozen importlib] -   Recall: 0.2514
[2025-11-19 09:18:39,719] [INFO] [<frozen importlib] -   F1 Score: 0.2676
[2025-11-19 09:18:39,719] [INFO] [<frozen importlib] -   AUROC: 0.7033
[2025-11-19 09:18:39,719] [INFO] [<frozen importlib] -   AUPRC: 0.2248
[2025-11-19 09:18:39,719] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:18:39,719] [INFO] [<frozen importlib] -     TN=16534, FP=911
[2025-11-19 09:18:39,719] [INFO] [<frozen importlib] -     FN=1087, TP=365
[2025-11-19 09:18:39,742] [INFO] [<frozen importlib] - Trial 337: AUPRC=0.2248, F1=0.4428, Prec=0.4245, Rec=0.4628 | Optimizing auprc=0.2248
[2025-11-19 09:18:39,742] [INFO] [<frozen importlib] - Trial 337 pruned.
[2025-11-19 09:18:39,742] [ERROR] [<frozen importlib] - Trial 337 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  67%|██████▋   | 337/500 [56:37<33:45, 12.43s/it]Best trial: 289. Best value: 0.241792:  67%|██████▋   | 337/500 [56:37<33:45, 12.43s/it]Best trial: 289. Best value: 0.241792:  68%|██████▊   | 338/500 [56:37<31:11, 11.55s/it][2025-11-19 09:18:39,755] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.425861777826606
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   gamma: 0.3509492879535789
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   alpha: 0.5326316784969078
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   lambda: 1.0087330868829463
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   learning_rate: 0.038982002223522466
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   subsample: 0.8431350600043414
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   colsample_bytree: 0.599047996652651
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5309044411810896
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   colsample_bynode: 0.7871238948044177
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:18:39,755] [INFO] [<frozen importlib] -   scale_pos_weight: 5.425861777826606
[2025-11-19 09:18:39,828] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:18:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:18:39,742] Trial 337 pruned. 
[0]	train-logloss:0.61165	train-auc:0.63854	train-aucpr:0.22152	val-logloss:0.59639	val-auc:0.61547	val-aucpr:0.12850
[10]	train-logloss:0.59004	train-auc:0.68153	train-aucpr:0.28925	val-logloss:0.55389	val-auc:0.67174	val-aucpr:0.17669
[20]	train-logloss:0.57667	train-auc:0.68840	train-aucpr:0.29798	val-logloss:0.51541	val-auc:0.69592	val-aucpr:0.21711
[30]	train-logloss:0.56741	train-auc:0.69294	train-aucpr:0.30386	val-logloss:0.48998	val-auc:0.68786	val-aucpr:0.22145
[40]	train-logloss:0.56103	train-auc:0.69736	train-aucpr:0.30921	val-logloss:0.47156	val-auc:0.71020	val-aucpr:0.23429
[50]	train-logloss:0.55612	train-auc:0.70226	train-aucpr:0.31284	val-logloss:0.45620	val-auc:0.70553	val-aucpr:0.23402
[60]	train-logloss:0.55251	train-auc:0.70572	train-aucpr:0.31708	val-logloss:0.45909	val-auc:0.70517	val-aucpr:0.23052
[70]	train-logloss:0.54952	train-auc:0.70925	train-aucpr:0.32080	val-logloss:0.45601	val-auc:0.70517	val-aucpr:0.23209
[80]	train-logloss:0.54681	train-auc:0.71354	train-aucpr:0.32559	val-logloss:0.43406	val-auc:0.70434	val-aucpr:0.22882
[2025-11-19 09:18:40,068] [INFO] [<frozen importlib] - Training completed at iteration 51
[2025-11-19 09:18:40,068] [INFO] [<frozen importlib] - Best train loss: 0.5557
[2025-11-19 09:18:40,068] [INFO] [<frozen importlib] - Best val loss: 0.4594
[2025-11-19 09:18:40,068] [INFO] [<frozen importlib] - Best val AUC: 0.7055
[2025-11-19 09:18:40,068] [INFO] [<frozen importlib] - Best val AUCPR: 0.2347
[2025-11-19 09:18:40,073] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:18:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:18:51,776] [INFO] [<frozen importlib] - Optimal threshold: 0.4200
[2025-11-19 09:18:51,776] [INFO] [<frozen importlib] - Best f1: 0.2846
[2025-11-19 09:18:51,776] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:18:51,823] [INFO] [<frozen importlib] - Validation Results (threshold=0.4200):
[2025-11-19 09:18:51,823] [INFO] [<frozen importlib] -   Accuracy: 0.8917
[2025-11-19 09:18:51,823] [INFO] [<frozen importlib] -   Precision: 0.2891
[2025-11-19 09:18:51,823] [INFO] [<frozen importlib] -   Recall: 0.2803
[2025-11-19 09:18:51,823] [INFO] [<frozen importlib] -   F1 Score: 0.2846
[2025-11-19 09:18:51,823] [INFO] [<frozen importlib] -   AUROC: 0.7055
[2025-11-19 09:18:51,823] [INFO] [<frozen importlib] -   AUPRC: 0.2350
[2025-11-19 09:18:51,823] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:18:51,823] [INFO] [<frozen importlib] -     TN=16444, FP=1001
[2025-11-19 09:18:51,823] [INFO] [<frozen importlib] -     FN=1045, TP=407
[2025-11-19 09:18:51,850] [INFO] [<frozen importlib] - Trial 338: AUPRC=0.2350, F1=0.4341, Prec=0.4045, Rec=0.4683 | Optimizing auprc=0.2350
                                                                                        Best trial: 289. Best value: 0.241792:  68%|██████▊   | 338/500 [56:49<31:11, 11.55s/it]Best trial: 289. Best value: 0.241792:  68%|██████▊   | 338/500 [56:49<31:11, 11.55s/it]Best trial: 289. Best value: 0.241792:  68%|██████▊   | 339/500 [56:49<31:26, 11.72s/it][2025-11-19 09:18:51,863] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.303184120550627
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] -   gamma: 0.34937202846559295
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] -   alpha: 0.5303403840731342
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] -   lambda: 1.0044954330749534
[2025-11-19 09:18:51,863] [INFO] [<frozen importlib] -   learning_rate: 0.039614657931666554
[2025-11-19 09:18:51,864] [INFO] [<frozen importlib] -   subsample: 0.8446356050688737
[2025-11-19 09:18:51,864] [INFO] [<frozen importlib] -   colsample_bytree: 0.6189806612846585
[2025-11-19 09:18:51,864] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5321217793980824
[2025-11-19 09:18:51,864] [INFO] [<frozen importlib] -   colsample_bynode: 0.7904089522184344
[2025-11-19 09:18:51,864] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:18:51,864] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:18:51,864] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:18:51,864] [INFO] [<frozen importlib] -   scale_pos_weight: 5.303184120550627
[2025-11-19 09:18:51,936] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:18:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:18:51,851] Trial 338 finished with value: 0.23501276374363197 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.3509492879535789, 'learning_rate': 0.038982002223522466, 'n_estimators': 350, 'alpha': 0.5326316784969078, 'lambda': 1.0087330868829463, 'subsample': 0.8431350600043414, 'colsample_bytree': 0.599047996652651, 'colsample_bylevel': 0.5309044411810896, 'colsample_bynode': 0.7871238948044177, 'scale_pos_weight': 5.425861777826606}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.60373	train-auc:0.66501	train-aucpr:0.25989	val-logloss:0.58567	val-auc:0.65136	val-aucpr:0.15817
[10]	train-logloss:0.57827	train-auc:0.70279	train-aucpr:0.31640	val-logloss:0.52839	val-auc:0.69971	val-aucpr:0.22035
[20]	train-logloss:0.56256	train-auc:0.70994	train-aucpr:0.32399	val-logloss:0.49792	val-auc:0.69558	val-aucpr:0.21842
[30]	train-logloss:0.55248	train-auc:0.71374	train-aucpr:0.32963	val-logloss:0.47093	val-auc:0.70060	val-aucpr:0.22159
[40]	train-logloss:0.54544	train-auc:0.71755	train-aucpr:0.33561	val-logloss:0.45902	val-auc:0.69585	val-aucpr:0.21795
[50]	train-logloss:0.53977	train-auc:0.72131	train-aucpr:0.34145	val-logloss:0.44495	val-auc:0.70068	val-aucpr:0.22253
[52]	train-logloss:0.53839	train-auc:0.72326	train-aucpr:0.34433	val-logloss:0.44005	val-auc:0.69749	val-aucpr:0.21727
[2025-11-19 09:18:52,145] [INFO] [<frozen importlib] - Training completed at iteration 22
[2025-11-19 09:18:52,145] [INFO] [<frozen importlib] - Best train loss: 0.5603
[2025-11-19 09:18:52,145] [INFO] [<frozen importlib] - Best val loss: 0.4893
[2025-11-19 09:18:52,145] [INFO] [<frozen importlib] - Best val AUC: 0.6995
[2025-11-19 09:18:52,145] [INFO] [<frozen importlib] - Best val AUCPR: 0.2228
[2025-11-19 09:18:52,150] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:18:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:18:58,784] [INFO] [<frozen importlib] - Optimal threshold: 0.4343
[2025-11-19 09:18:58,784] [INFO] [<frozen importlib] - Best f1: 0.2672
[2025-11-19 09:18:58,784] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:18:58,827] [INFO] [<frozen importlib] - Validation Results (threshold=0.4343):
[2025-11-19 09:18:58,827] [INFO] [<frozen importlib] -   Accuracy: 0.8926
[2025-11-19 09:18:58,827] [INFO] [<frozen importlib] -   Precision: 0.2809
[2025-11-19 09:18:58,827] [INFO] [<frozen importlib] -   Recall: 0.2548
[2025-11-19 09:18:58,827] [INFO] [<frozen importlib] -   F1 Score: 0.2672
[2025-11-19 09:18:58,827] [INFO] [<frozen importlib] -   AUROC: 0.6995
[2025-11-19 09:18:58,827] [INFO] [<frozen importlib] -   AUPRC: 0.2230
[2025-11-19 09:18:58,827] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:18:58,827] [INFO] [<frozen importlib] -     TN=16498, FP=947
[2025-11-19 09:18:58,827] [INFO] [<frozen importlib] -     FN=1082, TP=370
[2025-11-19 09:18:58,849] [INFO] [<frozen importlib] - Trial 339: AUPRC=0.2230, F1=0.4592, Prec=0.4302, Rec=0.4924 | Optimizing auprc=0.2230
                                                                                        Best trial: 289. Best value: 0.241792:  68%|██████▊   | 339/500 [56:56<31:26, 11.72s/it]Best trial: 289. Best value: 0.241792:  68%|██████▊   | 339/500 [56:56<31:26, 11.72s/it]Best trial: 289. Best value: 0.241792:  68%|██████▊   | 340/500 [56:56<27:28, 10.30s/it][2025-11-19 09:18:58,861] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.091055325707286
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   gamma: 0.5722720440929269
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   alpha: 0.5498017550568052
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   lambda: 2.9890710935328912
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   learning_rate: 0.038675163539107146
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   subsample: 0.8393335727418793
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   colsample_bytree: 0.6026027476616167
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5217351737076915
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   colsample_bynode: 0.8315348902759815
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:18:58,861] [INFO] [<frozen importlib] -   scale_pos_weight: 6.091055325707286
[2025-11-19 09:18:58,938] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:18:58] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:18:58,849] Trial 339 finished with value: 0.22297935709238983 and parameters: {'max_depth': 5, 'min_child_weight': 7, 'gamma': 0.34937202846559295, 'learning_rate': 0.039614657931666554, 'n_estimators': 350, 'alpha': 0.5303403840731342, 'lambda': 1.0044954330749534, 'subsample': 0.8446356050688737, 'colsample_bytree': 0.6189806612846585, 'colsample_bylevel': 0.5321217793980824, 'colsample_bynode': 0.7904089522184344, 'scale_pos_weight': 5.303184120550627}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.64896	train-auc:0.64299	train-aucpr:0.25042	val-logloss:0.64090	val-auc:0.58490	val-aucpr:0.12123
[10]	train-logloss:0.62599	train-auc:0.68161	train-aucpr:0.29190	val-logloss:0.58286	val-auc:0.69445	val-aucpr:0.20859
[20]	train-logloss:0.61186	train-auc:0.68944	train-aucpr:0.30018	val-logloss:0.54685	val-auc:0.68757	val-aucpr:0.21036
[30]	train-logloss:0.60235	train-auc:0.69372	train-aucpr:0.30399	val-logloss:0.52297	val-auc:0.70543	val-aucpr:0.22375
[40]	train-logloss:0.59538	train-auc:0.69736	train-aucpr:0.30947	val-logloss:0.51286	val-auc:0.70671	val-aucpr:0.21497
[50]	train-logloss:0.58999	train-auc:0.70115	train-aucpr:0.31396	val-logloss:0.49436	val-auc:0.70773	val-aucpr:0.22026
[60]	train-logloss:0.58633	train-auc:0.70492	train-aucpr:0.31819	val-logloss:0.49326	val-auc:0.70809	val-aucpr:0.22050
[2025-11-19 09:18:59,128] [INFO] [<frozen importlib] - Training completed at iteration 30
[2025-11-19 09:18:59,128] [INFO] [<frozen importlib] - Best train loss: 0.6023
[2025-11-19 09:18:59,128] [INFO] [<frozen importlib] - Best val loss: 0.5230
[2025-11-19 09:18:59,128] [INFO] [<frozen importlib] - Best val AUC: 0.7054
[2025-11-19 09:18:59,128] [INFO] [<frozen importlib] - Best val AUCPR: 0.2238
[2025-11-19 09:18:59,132] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:18:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:19:05,962] [INFO] [<frozen importlib] - Optimal threshold: 0.4599
[2025-11-19 09:19:05,962] [INFO] [<frozen importlib] - Best f1: 0.2725
[2025-11-19 09:19:05,962] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:19:06,002] [INFO] [<frozen importlib] - Validation Results (threshold=0.4599):
[2025-11-19 09:19:06,003] [INFO] [<frozen importlib] -   Accuracy: 0.8986
[2025-11-19 09:19:06,003] [INFO] [<frozen importlib] -   Precision: 0.3035
[2025-11-19 09:19:06,003] [INFO] [<frozen importlib] -   Recall: 0.2472
[2025-11-19 09:19:06,003] [INFO] [<frozen importlib] -   F1 Score: 0.2725
[2025-11-19 09:19:06,003] [INFO] [<frozen importlib] -   AUROC: 0.7054
[2025-11-19 09:19:06,003] [INFO] [<frozen importlib] -   AUPRC: 0.2239
[2025-11-19 09:19:06,003] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:19:06,003] [INFO] [<frozen importlib] -     TN=16621, FP=824
[2025-11-19 09:19:06,003] [INFO] [<frozen importlib] -     FN=1093, TP=359
[2025-11-19 09:19:06,026] [INFO] [<frozen importlib] - Trial 340: AUPRC=0.2239, F1=0.4501, Prec=0.4451, Rec=0.4552 | Optimizing auprc=0.2239
[2025-11-19 09:19:06,026] [INFO] [<frozen importlib] - Trial 340 pruned.
[2025-11-19 09:19:06,026] [ERROR] [<frozen importlib] - Trial 340 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  68%|██████▊   | 340/500 [57:03<27:28, 10.30s/it]Best trial: 289. Best value: 0.241792:  68%|██████▊   | 340/500 [57:03<27:28, 10.30s/it]Best trial: 289. Best value: 0.241792:  68%|██████▊   | 341/500 [57:03<24:49,  9.37s/it][2025-11-19 09:19:06,038] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.844430548348113
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   gamma: 0.6616979425352257
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   alpha: 0.47638694674614857
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   lambda: 0.8953460405985891
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   learning_rate: 0.041338864799043744
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   subsample: 0.853509579865541
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   colsample_bytree: 0.590695587131112
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5119649866936599
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   colsample_bynode: 0.7762638853743612
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:19:06,038] [INFO] [<frozen importlib] -   scale_pos_weight: 9.844430548348113
[2025-11-19 09:19:06,116] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:19:06] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:19:06,026] Trial 340 pruned. 
[0]	train-logloss:0.83897	train-auc:0.64839	train-aucpr:0.22405	val-logloss:0.85099	val-auc:0.62577	val-aucpr:0.10557
[10]	train-logloss:0.80586	train-auc:0.68033	train-aucpr:0.28902	val-logloss:0.77640	val-auc:0.70054	val-aucpr:0.17557
[20]	train-logloss:0.78642	train-auc:0.68807	train-aucpr:0.29995	val-logloss:0.71587	val-auc:0.71125	val-aucpr:0.21261
[30]	train-logloss:0.77412	train-auc:0.69278	train-aucpr:0.30359	val-logloss:0.68382	val-auc:0.71015	val-aucpr:0.21858
[40]	train-logloss:0.76543	train-auc:0.69985	train-aucpr:0.30745	val-logloss:0.68049	val-auc:0.70825	val-aucpr:0.21764
[50]	train-logloss:0.75762	train-auc:0.70543	train-aucpr:0.31390	val-logloss:0.66504	val-auc:0.71062	val-aucpr:0.22045
[60]	train-logloss:0.75258	train-auc:0.70890	train-aucpr:0.31768	val-logloss:0.64750	val-auc:0.70870	val-aucpr:0.22435
[70]	train-logloss:0.74784	train-auc:0.71330	train-aucpr:0.32199	val-logloss:0.64777	val-auc:0.70349	val-aucpr:0.21112
[80]	train-logloss:0.74388	train-auc:0.71749	train-aucpr:0.32672	val-logloss:0.63973	val-auc:0.70373	val-aucpr:0.21206
[89]	train-logloss:0.74054	train-auc:0.72153	train-aucpr:0.33038	val-logloss:0.63674	val-auc:0.69601	val-aucpr:0.20740
[2025-11-19 09:19:06,390] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:19:06,390] [INFO] [<frozen importlib] - Best train loss: 0.7526
[2025-11-19 09:19:06,390] [INFO] [<frozen importlib] - Best val loss: 0.6475
[2025-11-19 09:19:06,390] [INFO] [<frozen importlib] - Best val AUC: 0.7087
[2025-11-19 09:19:06,390] [INFO] [<frozen importlib] - Best val AUCPR: 0.2244
[2025-11-19 09:19:06,396] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:19:06] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:19:19,168] [INFO] [<frozen importlib] - Optimal threshold: 0.6012
[2025-11-19 09:19:19,169] [INFO] [<frozen importlib] - Best f1: 0.2723
[2025-11-19 09:19:19,169] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:19:19,213] [INFO] [<frozen importlib] - Validation Results (threshold=0.6012):
[2025-11-19 09:19:19,213] [INFO] [<frozen importlib] -   Accuracy: 0.9033
[2025-11-19 09:19:19,213] [INFO] [<frozen importlib] -   Precision: 0.3226
[2025-11-19 09:19:19,213] [INFO] [<frozen importlib] -   Recall: 0.2355
[2025-11-19 09:19:19,213] [INFO] [<frozen importlib] -   F1 Score: 0.2723
[2025-11-19 09:19:19,213] [INFO] [<frozen importlib] -   AUROC: 0.7087
[2025-11-19 09:19:19,213] [INFO] [<frozen importlib] -   AUPRC: 0.2248
[2025-11-19 09:19:19,213] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:19:19,213] [INFO] [<frozen importlib] -     TN=16727, FP=718
[2025-11-19 09:19:19,213] [INFO] [<frozen importlib] -     FN=1110, TP=342
[2025-11-19 09:19:19,238] [INFO] [<frozen importlib] - Trial 341: AUPRC=0.2248, F1=0.4718, Prec=0.4827, Rec=0.4614 | Optimizing auprc=0.2248
[2025-11-19 09:19:19,239] [INFO] [<frozen importlib] - Trial 341 pruned.
[2025-11-19 09:19:19,239] [ERROR] [<frozen importlib] - Trial 341 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  68%|██████▊   | 341/500 [57:17<24:49,  9.37s/it]Best trial: 289. Best value: 0.241792:  68%|██████▊   | 341/500 [57:17<24:49,  9.37s/it]Best trial: 289. Best value: 0.241792:  68%|██████▊   | 342/500 [57:17<27:42, 10.52s/it][2025-11-19 09:19:19,255] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.640798572242571
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   gamma: 0.593119219814374
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   alpha: 0.3959434082987616
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   lambda: 1.0565228003223615
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   learning_rate: 0.0373188724500591
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   subsample: 0.8255275711223592
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   colsample_bytree: 0.6111551964707365
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5288253437358424
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   colsample_bynode: 0.7965160475659258
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:19:19,255] [INFO] [<frozen importlib] -   scale_pos_weight: 5.640798572242571
[2025-11-19 09:19:19,331] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:19:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:19:19,239] Trial 341 pruned. 
[0]	train-logloss:0.62375	train-auc:0.64117	train-aucpr:0.24223	val-logloss:0.61140	val-auc:0.58553	val-aucpr:0.11240
[10]	train-logloss:0.60180	train-auc:0.68148	train-aucpr:0.29622	val-logloss:0.55632	val-auc:0.70055	val-aucpr:0.20770
[20]	train-logloss:0.58825	train-auc:0.68603	train-aucpr:0.30175	val-logloss:0.51896	val-auc:0.69811	val-aucpr:0.20810
[30]	train-logloss:0.57954	train-auc:0.69257	train-aucpr:0.30597	val-logloss:0.50321	val-auc:0.69963	val-aucpr:0.21168
[40]	train-logloss:0.57328	train-auc:0.69796	train-aucpr:0.31043	val-logloss:0.48266	val-auc:0.70217	val-aucpr:0.20771
[50]	train-logloss:0.56798	train-auc:0.70243	train-aucpr:0.31483	val-logloss:0.47756	val-auc:0.70711	val-aucpr:0.21733
[60]	train-logloss:0.56450	train-auc:0.70526	train-aucpr:0.31817	val-logloss:0.46809	val-auc:0.70516	val-aucpr:0.21698
[70]	train-logloss:0.56117	train-auc:0.70968	train-aucpr:0.32166	val-logloss:0.47091	val-auc:0.70128	val-aucpr:0.21296
[80]	train-logloss:0.55846	train-auc:0.71276	train-aucpr:0.32569	val-logloss:0.46395	val-auc:0.68539	val-aucpr:0.19686
[85]	train-logloss:0.55715	train-auc:0.71395	train-aucpr:0.32727	val-logloss:0.46228	val-auc:0.68560	val-aucpr:0.19187
[2025-11-19 09:19:19,581] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:19:19,581] [INFO] [<frozen importlib] - Best train loss: 0.5657
[2025-11-19 09:19:19,581] [INFO] [<frozen importlib] - Best val loss: 0.4714
[2025-11-19 09:19:19,581] [INFO] [<frozen importlib] - Best val AUC: 0.7078
[2025-11-19 09:19:19,581] [INFO] [<frozen importlib] - Best val AUCPR: 0.2180
[2025-11-19 09:19:19,586] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:19:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:19:32,360] [INFO] [<frozen importlib] - Optimal threshold: 0.4461
[2025-11-19 09:19:32,360] [INFO] [<frozen importlib] - Best f1: 0.2750
[2025-11-19 09:19:32,360] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:19:32,401] [INFO] [<frozen importlib] - Validation Results (threshold=0.4461):
[2025-11-19 09:19:32,401] [INFO] [<frozen importlib] -   Accuracy: 0.8948
[2025-11-19 09:19:32,401] [INFO] [<frozen importlib] -   Precision: 0.2922
[2025-11-19 09:19:32,401] [INFO] [<frozen importlib] -   Recall: 0.2596
[2025-11-19 09:19:32,401] [INFO] [<frozen importlib] -   F1 Score: 0.2750
[2025-11-19 09:19:32,401] [INFO] [<frozen importlib] -   AUROC: 0.7078
[2025-11-19 09:19:32,401] [INFO] [<frozen importlib] -   AUPRC: 0.2187
[2025-11-19 09:19:32,401] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:19:32,401] [INFO] [<frozen importlib] -     TN=16532, FP=913
[2025-11-19 09:19:32,401] [INFO] [<frozen importlib] -     FN=1075, TP=377
[2025-11-19 09:19:32,424] [INFO] [<frozen importlib] - Trial 342: AUPRC=0.2187, F1=0.4492, Prec=0.4287, Rec=0.4718 | Optimizing auprc=0.2187
[2025-11-19 09:19:32,425] [INFO] [<frozen importlib] - Trial 342 pruned.
[2025-11-19 09:19:32,425] [ERROR] [<frozen importlib] - Trial 342 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  68%|██████▊   | 342/500 [57:30<27:42, 10.52s/it]Best trial: 289. Best value: 0.241792:  68%|██████▊   | 342/500 [57:30<27:42, 10.52s/it]Best trial: 289. Best value: 0.241792:  69%|██████▊   | 343/500 [57:30<29:37, 11.32s/it][2025-11-19 09:19:32,447] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 10.29984099812865
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] -   gamma: 0.6404453398101637
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] -   alpha: 0.5336968858306866
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] -   lambda: 1.168729594155421
[2025-11-19 09:19:32,447] [INFO] [<frozen importlib] -   learning_rate: 0.03911776639730262
[2025-11-19 09:19:32,448] [INFO] [<frozen importlib] -   subsample: 0.814766812637384
[2025-11-19 09:19:32,448] [INFO] [<frozen importlib] -   colsample_bytree: 0.5872407052644638
[2025-11-19 09:19:32,448] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5101377053381466
[2025-11-19 09:19:32,448] [INFO] [<frozen importlib] -   colsample_bynode: 0.7847629831575091
[2025-11-19 09:19:32,448] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:19:32,448] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:19:32,448] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:19:32,448] [INFO] [<frozen importlib] -   scale_pos_weight: 10.29984099812865
[2025-11-19 09:19:32,533] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:19:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:19:32,425] Trial 342 pruned. 
[0]	train-logloss:0.85932	train-auc:0.64940	train-aucpr:0.22366	val-logloss:0.87334	val-auc:0.62433	val-aucpr:0.10626
[10]	train-logloss:0.82650	train-auc:0.68039	train-aucpr:0.28593	val-logloss:0.79932	val-auc:0.70879	val-aucpr:0.17534
[20]	train-logloss:0.80709	train-auc:0.68762	train-aucpr:0.29987	val-logloss:0.73812	val-auc:0.71103	val-aucpr:0.21140
[30]	train-logloss:0.79488	train-auc:0.69186	train-aucpr:0.30220	val-logloss:0.69946	val-auc:0.71057	val-aucpr:0.22177
[40]	train-logloss:0.78614	train-auc:0.69708	train-aucpr:0.30674	val-logloss:0.68158	val-auc:0.70652	val-aucpr:0.22259
[50]	train-logloss:0.77813	train-auc:0.70243	train-aucpr:0.31326	val-logloss:0.67167	val-auc:0.70732	val-aucpr:0.22446
[60]	train-logloss:0.77300	train-auc:0.70594	train-aucpr:0.31579	val-logloss:0.66213	val-auc:0.70269	val-aucpr:0.22075
[70]	train-logloss:0.76845	train-auc:0.70979	train-aucpr:0.31995	val-logloss:0.65092	val-auc:0.69972	val-aucpr:0.21454
[79]	train-logloss:0.76484	train-auc:0.71242	train-aucpr:0.32429	val-logloss:0.64065	val-auc:0.70358	val-aucpr:0.21207
[2025-11-19 09:19:32,777] [INFO] [<frozen importlib] - Training completed at iteration 50
[2025-11-19 09:19:32,777] [INFO] [<frozen importlib] - Best train loss: 0.7781
[2025-11-19 09:19:32,777] [INFO] [<frozen importlib] - Best val loss: 0.6717
[2025-11-19 09:19:32,777] [INFO] [<frozen importlib] - Best val AUC: 0.7073
[2025-11-19 09:19:32,777] [INFO] [<frozen importlib] - Best val AUCPR: 0.2245
[2025-11-19 09:19:32,782] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:19:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:19:45,030] [INFO] [<frozen importlib] - Optimal threshold: 0.5921
[2025-11-19 09:19:45,030] [INFO] [<frozen importlib] - Best f1: 0.2804
[2025-11-19 09:19:45,030] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:19:45,074] [INFO] [<frozen importlib] - Validation Results (threshold=0.5921):
[2025-11-19 09:19:45,074] [INFO] [<frozen importlib] -   Accuracy: 0.8938
[2025-11-19 09:19:45,074] [INFO] [<frozen importlib] -   Precision: 0.2924
[2025-11-19 09:19:45,074] [INFO] [<frozen importlib] -   Recall: 0.2693
[2025-11-19 09:19:45,074] [INFO] [<frozen importlib] -   F1 Score: 0.2804
[2025-11-19 09:19:45,074] [INFO] [<frozen importlib] -   AUROC: 0.7073
[2025-11-19 09:19:45,074] [INFO] [<frozen importlib] -   AUPRC: 0.2249
[2025-11-19 09:19:45,074] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:19:45,074] [INFO] [<frozen importlib] -     TN=16499, FP=946
[2025-11-19 09:19:45,074] [INFO] [<frozen importlib] -     FN=1061, TP=391
[2025-11-19 09:19:45,097] [INFO] [<frozen importlib] - Trial 343: AUPRC=0.2249, F1=0.4638, Prec=0.4335, Rec=0.4986 | Optimizing auprc=0.2249
                                                                                        Best trial: 289. Best value: 0.241792:  69%|██████▊   | 343/500 [57:43<29:37, 11.32s/it]Best trial: 289. Best value: 0.241792:  69%|██████▊   | 343/500 [57:43<29:37, 11.32s/it]Best trial: 289. Best value: 0.241792:  69%|██████▉   | 344/500 [57:43<30:29, 11.73s/it][2025-11-19 09:19:45,110] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.983490203741065
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   gamma: 0.3345460915644592
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   alpha: 0.5664756241259364
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   lambda: 0.8315731917574727
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   learning_rate: 0.0424060361919714
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   subsample: 0.8349060394108263
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   colsample_bytree: 0.5997890982751708
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5205460529669612
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   colsample_bynode: 0.7723826667772475
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:19:45,110] [INFO] [<frozen importlib] -   scale_pos_weight: 5.983490203741065
[2025-11-19 09:19:45,183] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:19:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:19:45,098] Trial 343 finished with value: 0.22488233466428226 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.6404453398101637, 'learning_rate': 0.03911776639730262, 'n_estimators': 250, 'alpha': 0.5336968858306866, 'lambda': 1.168729594155421, 'subsample': 0.814766812637384, 'colsample_bytree': 0.5872407052644638, 'colsample_bylevel': 0.5101377053381466, 'colsample_bynode': 0.7847629831575091, 'scale_pos_weight': 10.29984099812865}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.64300	train-auc:0.63634	train-aucpr:0.22061	val-logloss:0.63281	val-auc:0.62005	val-aucpr:0.12201
[10]	train-logloss:0.61886	train-auc:0.68353	train-aucpr:0.29068	val-logloss:0.57862	val-auc:0.69075	val-aucpr:0.20183
[20]	train-logloss:0.60463	train-auc:0.68889	train-aucpr:0.29942	val-logloss:0.53788	val-auc:0.69525	val-aucpr:0.22058
[30]	train-logloss:0.59496	train-auc:0.69457	train-aucpr:0.30577	val-logloss:0.50718	val-auc:0.69698	val-aucpr:0.22291
[40]	train-logloss:0.58825	train-auc:0.69831	train-aucpr:0.31004	val-logloss:0.48130	val-auc:0.71716	val-aucpr:0.22931
[50]	train-logloss:0.58291	train-auc:0.70297	train-aucpr:0.31396	val-logloss:0.47330	val-auc:0.71360	val-aucpr:0.23346
[60]	train-logloss:0.57912	train-auc:0.70737	train-aucpr:0.31860	val-logloss:0.47133	val-auc:0.71449	val-aucpr:0.23010
[70]	train-logloss:0.57589	train-auc:0.71076	train-aucpr:0.32331	val-logloss:0.47495	val-auc:0.70901	val-aucpr:0.21788
[75]	train-logloss:0.57453	train-auc:0.71259	train-aucpr:0.32560	val-logloss:0.46957	val-auc:0.70814	val-aucpr:0.21750
[2025-11-19 09:19:45,407] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 09:19:45,407] [INFO] [<frozen importlib] - Best train loss: 0.5852
[2025-11-19 09:19:45,407] [INFO] [<frozen importlib] - Best val loss: 0.4716
[2025-11-19 09:19:45,407] [INFO] [<frozen importlib] - Best val AUC: 0.7184
[2025-11-19 09:19:45,407] [INFO] [<frozen importlib] - Best val AUCPR: 0.2368
[2025-11-19 09:19:45,412] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:19:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:19:57,338] [INFO] [<frozen importlib] - Optimal threshold: 0.4392
[2025-11-19 09:19:57,338] [INFO] [<frozen importlib] - Best f1: 0.2892
[2025-11-19 09:19:57,338] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:19:57,379] [INFO] [<frozen importlib] - Validation Results (threshold=0.4392):
[2025-11-19 09:19:57,379] [INFO] [<frozen importlib] -   Accuracy: 0.8975
[2025-11-19 09:19:57,379] [INFO] [<frozen importlib] -   Precision: 0.3095
[2025-11-19 09:19:57,379] [INFO] [<frozen importlib] -   Recall: 0.2713
[2025-11-19 09:19:57,379] [INFO] [<frozen importlib] -   F1 Score: 0.2892
[2025-11-19 09:19:57,379] [INFO] [<frozen importlib] -   AUROC: 0.7184
[2025-11-19 09:19:57,379] [INFO] [<frozen importlib] -   AUPRC: 0.2372
[2025-11-19 09:19:57,379] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:19:57,379] [INFO] [<frozen importlib] -     TN=16566, FP=879
[2025-11-19 09:19:57,379] [INFO] [<frozen importlib] -     FN=1058, TP=394
[2025-11-19 09:19:57,402] [INFO] [<frozen importlib] - Trial 344: AUPRC=0.2372, F1=0.4496, Prec=0.4347, Rec=0.4656 | Optimizing auprc=0.2372
                                                                                        Best trial: 289. Best value: 0.241792:  69%|██████▉   | 344/500 [57:55<30:29, 11.73s/it]Best trial: 289. Best value: 0.241792:  69%|██████▉   | 344/500 [57:55<30:29, 11.73s/it]Best trial: 289. Best value: 0.241792:  69%|██████▉   | 345/500 [57:55<30:44, 11.90s/it][2025-11-19 09:19:57,425] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.732035742666499
[2025-11-19 09:19:57,425] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:19:57,425] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:19:57,425] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   gamma: 0.3347664707154447
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   alpha: 0.5803740725975428
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   lambda: 0.7991818077845917
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   learning_rate: 0.04311810287028503
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   subsample: 0.8385708627517937
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   colsample_bytree: 0.6911570504633885
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5325152942568577
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   colsample_bynode: 0.8020399921128044
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:19:57,426] [INFO] [<frozen importlib] -   scale_pos_weight: 5.732035742666499
[2025-11-19 09:19:57,504] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:19:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:19:57,403] Trial 344 finished with value: 0.2372317595304332 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.3345460915644592, 'learning_rate': 0.0424060361919714, 'n_estimators': 350, 'alpha': 0.5664756241259364, 'lambda': 0.8315731917574727, 'subsample': 0.8349060394108263, 'colsample_bytree': 0.5997890982751708, 'colsample_bylevel': 0.5205460529669612, 'colsample_bynode': 0.7723826667772475, 'scale_pos_weight': 5.983490203741065}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.62876	train-auc:0.63246	train-aucpr:0.23195	val-logloss:0.61518	val-auc:0.59316	val-aucpr:0.13414
[10]	train-logloss:0.60431	train-auc:0.68253	train-aucpr:0.29016	val-logloss:0.57534	val-auc:0.64095	val-aucpr:0.12458
[20]	train-logloss:0.59019	train-auc:0.69119	train-aucpr:0.30228	val-logloss:0.53007	val-auc:0.68169	val-aucpr:0.18428
[30]	train-logloss:0.58051	train-auc:0.69704	train-aucpr:0.30853	val-logloss:0.49203	val-auc:0.68946	val-aucpr:0.20833
[40]	train-logloss:0.57374	train-auc:0.70293	train-aucpr:0.31502	val-logloss:0.47959	val-auc:0.70085	val-aucpr:0.21155
[50]	train-logloss:0.56861	train-auc:0.70685	train-aucpr:0.31896	val-logloss:0.46626	val-auc:0.70079	val-aucpr:0.21792
[60]	train-logloss:0.56504	train-auc:0.70952	train-aucpr:0.32285	val-logloss:0.45533	val-auc:0.70847	val-aucpr:0.22405
[70]	train-logloss:0.56191	train-auc:0.71370	train-aucpr:0.32721	val-logloss:0.44200	val-auc:0.70288	val-aucpr:0.22025
[80]	train-logloss:0.55922	train-auc:0.71710	train-aucpr:0.33214	val-logloss:0.43125	val-auc:0.70200	val-aucpr:0.21667
[90]	train-logloss:0.55663	train-auc:0.72186	train-aucpr:0.33614	val-logloss:0.42576	val-auc:0.69909	val-aucpr:0.21170
[91]	train-logloss:0.55638	train-auc:0.72248	train-aucpr:0.33672	val-logloss:0.42540	val-auc:0.69889	val-aucpr:0.21167
[2025-11-19 09:19:57,771] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:19:57,771] [INFO] [<frozen importlib] - Best train loss: 0.5644
[2025-11-19 09:19:57,771] [INFO] [<frozen importlib] - Best val loss: 0.4537
[2025-11-19 09:19:57,771] [INFO] [<frozen importlib] - Best val AUC: 0.7106
[2025-11-19 09:19:57,771] [INFO] [<frozen importlib] - Best val AUCPR: 0.2244
[2025-11-19 09:19:57,777] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:19:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:20:10,960] [INFO] [<frozen importlib] - Optimal threshold: 0.4271
[2025-11-19 09:20:10,960] [INFO] [<frozen importlib] - Best f1: 0.2790
[2025-11-19 09:20:10,960] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:20:11,004] [INFO] [<frozen importlib] - Validation Results (threshold=0.4271):
[2025-11-19 09:20:11,004] [INFO] [<frozen importlib] -   Accuracy: 0.8829
[2025-11-19 09:20:11,004] [INFO] [<frozen importlib] -   Precision: 0.2649
[2025-11-19 09:20:11,004] [INFO] [<frozen importlib] -   Recall: 0.2948
[2025-11-19 09:20:11,004] [INFO] [<frozen importlib] -   F1 Score: 0.2790
[2025-11-19 09:20:11,004] [INFO] [<frozen importlib] -   AUROC: 0.7106
[2025-11-19 09:20:11,004] [INFO] [<frozen importlib] -   AUPRC: 0.2250
[2025-11-19 09:20:11,004] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:20:11,004] [INFO] [<frozen importlib] -     TN=16257, FP=1188
[2025-11-19 09:20:11,004] [INFO] [<frozen importlib] -     FN=1024, TP=428
[2025-11-19 09:20:11,029] [INFO] [<frozen importlib] - Trial 345: AUPRC=0.2250, F1=0.4309, Prec=0.3790, Rec=0.4993 | Optimizing auprc=0.2250
[2025-11-19 09:20:11,030] [INFO] [<frozen importlib] - Trial 345 pruned.
[2025-11-19 09:20:11,030] [ERROR] [<frozen importlib] - Trial 345 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  69%|██████▉   | 345/500 [58:09<30:44, 11.90s/it]Best trial: 289. Best value: 0.241792:  69%|██████▉   | 345/500 [58:09<30:44, 11.90s/it]Best trial: 289. Best value: 0.241792:  69%|██████▉   | 346/500 [58:09<31:52, 12.42s/it][2025-11-19 09:20:11,043] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.167250361313903
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   gamma: 0.3795014527101259
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   alpha: 0.4458321573849136
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   lambda: 0.9083355920531792
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   learning_rate: 0.04166101283515651
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   subsample: 0.8521746997507852
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   colsample_bytree: 0.6003370891031161
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   colsample_bylevel: 0.820776977982218
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   colsample_bynode: 0.7768894891603921
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:20:11,043] [INFO] [<frozen importlib] -   scale_pos_weight: 6.167250361313903
[2025-11-19 09:20:11,128] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:20:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:20:11,030] Trial 345 pruned. 
[0]	train-logloss:0.65288	train-auc:0.65155	train-aucpr:0.24077	val-logloss:0.65151	val-auc:0.51140	val-aucpr:0.07297
[10]	train-logloss:0.62797	train-auc:0.68224	train-aucpr:0.28385	val-logloss:0.57916	val-auc:0.69815	val-aucpr:0.20282
[20]	train-logloss:0.61314	train-auc:0.68982	train-aucpr:0.29692	val-logloss:0.54472	val-auc:0.68502	val-aucpr:0.20575
[30]	train-logloss:0.60308	train-auc:0.69586	train-aucpr:0.30647	val-logloss:0.52436	val-auc:0.69226	val-aucpr:0.21744
[40]	train-logloss:0.59626	train-auc:0.69930	train-aucpr:0.31162	val-logloss:0.50906	val-auc:0.69530	val-aucpr:0.22108
[50]	train-logloss:0.59084	train-auc:0.70366	train-aucpr:0.31782	val-logloss:0.50389	val-auc:0.69962	val-aucpr:0.21733
[60]	train-logloss:0.58706	train-auc:0.70740	train-aucpr:0.32219	val-logloss:0.50374	val-auc:0.69892	val-aucpr:0.21995
[70]	train-logloss:0.58366	train-auc:0.71182	train-aucpr:0.32700	val-logloss:0.49806	val-auc:0.69928	val-aucpr:0.21415
[74]	train-logloss:0.58243	train-auc:0.71407	train-aucpr:0.32972	val-logloss:0.49702	val-auc:0.69930	val-aucpr:0.21073
[2025-11-19 09:20:11,356] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 09:20:11,356] [INFO] [<frozen importlib] - Best train loss: 0.5936
[2025-11-19 09:20:11,356] [INFO] [<frozen importlib] - Best val loss: 0.5076
[2025-11-19 09:20:11,356] [INFO] [<frozen importlib] - Best val AUC: 0.6993
[2025-11-19 09:20:11,356] [INFO] [<frozen importlib] - Best val AUCPR: 0.2214
[2025-11-19 09:20:11,362] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:20:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:20:20,106] [INFO] [<frozen importlib] - Optimal threshold: 0.4859
[2025-11-19 09:20:20,106] [INFO] [<frozen importlib] - Best f1: 0.2620
[2025-11-19 09:20:20,106] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:20:20,149] [INFO] [<frozen importlib] - Validation Results (threshold=0.4859):
[2025-11-19 09:20:20,149] [INFO] [<frozen importlib] -   Accuracy: 0.8945
[2025-11-19 09:20:20,150] [INFO] [<frozen importlib] -   Precision: 0.2832
[2025-11-19 09:20:20,150] [INFO] [<frozen importlib] -   Recall: 0.2438
[2025-11-19 09:20:20,150] [INFO] [<frozen importlib] -   F1 Score: 0.2620
[2025-11-19 09:20:20,150] [INFO] [<frozen importlib] -   AUROC: 0.6993
[2025-11-19 09:20:20,150] [INFO] [<frozen importlib] -   AUPRC: 0.2218
[2025-11-19 09:20:20,150] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:20:20,150] [INFO] [<frozen importlib] -     TN=16549, FP=896
[2025-11-19 09:20:20,150] [INFO] [<frozen importlib] -     FN=1098, TP=354
[2025-11-19 09:20:20,175] [INFO] [<frozen importlib] - Trial 346: AUPRC=0.2218, F1=0.4558, Prec=0.4361, Rec=0.4773 | Optimizing auprc=0.2218
[2025-11-19 09:20:20,176] [INFO] [<frozen importlib] - Trial 346 pruned.
[2025-11-19 09:20:20,176] [ERROR] [<frozen importlib] - Trial 346 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  69%|██████▉   | 346/500 [58:18<31:52, 12.42s/it]Best trial: 289. Best value: 0.241792:  69%|██████▉   | 346/500 [58:18<31:52, 12.42s/it]Best trial: 289. Best value: 0.241792:  69%|██████▉   | 347/500 [58:18<29:09, 11.44s/it][2025-11-19 09:20:20,198] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.911923657880237
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   gamma: 0.36026993240453564
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   alpha: 0.5963921677326174
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   lambda: 0.8510151053741876
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   learning_rate: 0.04027891190436484
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   subsample: 0.834180777723557
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   colsample_bytree: 0.5873329859711517
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5202968694682988
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   colsample_bynode: 0.8094164531452713
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:20:20,198] [INFO] [<frozen importlib] -   scale_pos_weight: 5.911923657880237
[2025-11-19 09:20:20,276] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:20:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:20:20,176] Trial 346 pruned. 
[0]	train-logloss:0.63914	train-auc:0.63227	train-aucpr:0.22901	val-logloss:0.62977	val-auc:0.61416	val-aucpr:0.13387
[10]	train-logloss:0.61547	train-auc:0.68080	train-aucpr:0.28964	val-logloss:0.57702	val-auc:0.69083	val-aucpr:0.18382
[20]	train-logloss:0.60137	train-auc:0.68854	train-aucpr:0.30035	val-logloss:0.53585	val-auc:0.69814	val-aucpr:0.20756
[30]	train-logloss:0.59224	train-auc:0.69381	train-aucpr:0.30540	val-logloss:0.51456	val-auc:0.69719	val-aucpr:0.22063
[40]	train-logloss:0.58574	train-auc:0.69952	train-aucpr:0.30976	val-logloss:0.51544	val-auc:0.70222	val-aucpr:0.22379
[50]	train-logloss:0.58031	train-auc:0.70422	train-aucpr:0.31554	val-logloss:0.50003	val-auc:0.70095	val-aucpr:0.22650
[60]	train-logloss:0.57646	train-auc:0.70825	train-aucpr:0.31926	val-logloss:0.49722	val-auc:0.70045	val-aucpr:0.22513
[70]	train-logloss:0.57306	train-auc:0.71128	train-aucpr:0.32282	val-logloss:0.48670	val-auc:0.70140	val-aucpr:0.22531
[77]	train-logloss:0.57122	train-auc:0.71326	train-aucpr:0.32498	val-logloss:0.47685	val-auc:0.70079	val-aucpr:0.22528
[2025-11-19 09:20:20,508] [INFO] [<frozen importlib] - Training completed at iteration 48
[2025-11-19 09:20:20,508] [INFO] [<frozen importlib] - Best train loss: 0.5811
[2025-11-19 09:20:20,508] [INFO] [<frozen importlib] - Best val loss: 0.5001
[2025-11-19 09:20:20,508] [INFO] [<frozen importlib] - Best val AUC: 0.7051
[2025-11-19 09:20:20,508] [INFO] [<frozen importlib] - Best val AUCPR: 0.2282
[2025-11-19 09:20:20,513] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:20:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:20:31,635] [INFO] [<frozen importlib] - Optimal threshold: 0.4577
[2025-11-19 09:20:31,635] [INFO] [<frozen importlib] - Best f1: 0.2664
[2025-11-19 09:20:31,635] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:20:31,678] [INFO] [<frozen importlib] - Validation Results (threshold=0.4577):
[2025-11-19 09:20:31,678] [INFO] [<frozen importlib] -   Accuracy: 0.8896
[2025-11-19 09:20:31,679] [INFO] [<frozen importlib] -   Precision: 0.2721
[2025-11-19 09:20:31,679] [INFO] [<frozen importlib] -   Recall: 0.2610
[2025-11-19 09:20:31,679] [INFO] [<frozen importlib] -   F1 Score: 0.2664
[2025-11-19 09:20:31,679] [INFO] [<frozen importlib] -   AUROC: 0.7051
[2025-11-19 09:20:31,679] [INFO] [<frozen importlib] -   AUPRC: 0.2286
[2025-11-19 09:20:31,679] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:20:31,679] [INFO] [<frozen importlib] -     TN=16431, FP=1014
[2025-11-19 09:20:31,679] [INFO] [<frozen importlib] -     FN=1073, TP=379
[2025-11-19 09:20:31,702] [INFO] [<frozen importlib] - Trial 347: AUPRC=0.2286, F1=0.4417, Prec=0.4081, Rec=0.4814 | Optimizing auprc=0.2286
                                                                                        Best trial: 289. Best value: 0.241792:  69%|██████▉   | 347/500 [58:29<29:09, 11.44s/it]Best trial: 289. Best value: 0.241792:  69%|██████▉   | 347/500 [58:29<29:09, 11.44s/it]Best trial: 289. Best value: 0.241792:  70%|██████▉   | 348/500 [58:29<29:02, 11.46s/it][2025-11-19 09:20:31,716] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.3163932139802
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   gamma: 0.3152030676922004
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   alpha: 0.5042058799809712
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   lambda: 0.9799521813456264
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   learning_rate: 0.038468710174138686
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   subsample: 0.8500269176298045
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   colsample_bytree: 0.5757979439666836
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5224364620263031
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   colsample_bynode: 0.7880716449285746
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:20:31,716] [INFO] [<frozen importlib] -   scale_pos_weight: 5.3163932139802
[2025-11-19 09:20:31,793] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:20:31] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:20:31,703] Trial 347 finished with value: 0.22860244800534404 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.36026993240453564, 'learning_rate': 0.04027891190436484, 'n_estimators': 250, 'alpha': 0.5963921677326174, 'lambda': 0.8510151053741876, 'subsample': 0.834180777723557, 'colsample_bytree': 0.5873329859711517, 'colsample_bylevel': 0.5202968694682988, 'colsample_bynode': 0.8094164531452713, 'scale_pos_weight': 5.911923657880237}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.60526	train-auc:0.63970	train-aucpr:0.23754	val-logloss:0.58951	val-auc:0.62678	val-aucpr:0.12586
[10]	train-logloss:0.58436	train-auc:0.68014	train-aucpr:0.29127	val-logloss:0.54439	val-auc:0.68846	val-aucpr:0.19764
[20]	train-logloss:0.57119	train-auc:0.68918	train-aucpr:0.29834	val-logloss:0.51428	val-auc:0.69604	val-aucpr:0.21252
[30]	train-logloss:0.56228	train-auc:0.69485	train-aucpr:0.30561	val-logloss:0.49613	val-auc:0.69687	val-aucpr:0.22114
[40]	train-logloss:0.55587	train-auc:0.69833	train-aucpr:0.30948	val-logloss:0.48108	val-auc:0.70813	val-aucpr:0.22152
[50]	train-logloss:0.55068	train-auc:0.70361	train-aucpr:0.31524	val-logloss:0.46395	val-auc:0.70863	val-aucpr:0.22660
[60]	train-logloss:0.54713	train-auc:0.70639	train-aucpr:0.31874	val-logloss:0.46486	val-auc:0.70944	val-aucpr:0.22749
[70]	train-logloss:0.54412	train-auc:0.70913	train-aucpr:0.32211	val-logloss:0.45201	val-auc:0.71075	val-aucpr:0.22925
[80]	train-logloss:0.54164	train-auc:0.71270	train-aucpr:0.32583	val-logloss:0.43991	val-auc:0.70827	val-aucpr:0.23170
[90]	train-logloss:0.53909	train-auc:0.71763	train-aucpr:0.33022	val-logloss:0.43920	val-auc:0.70779	val-aucpr:0.22864
[100]	train-logloss:0.53694	train-auc:0.72080	train-aucpr:0.33439	val-logloss:0.43439	val-auc:0.70262	val-aucpr:0.21971
[109]	train-logloss:0.53491	train-auc:0.72451	train-aucpr:0.33794	val-logloss:0.42618	val-auc:0.70153	val-aucpr:0.21867
[2025-11-19 09:20:32,103] [INFO] [<frozen importlib] - Training completed at iteration 80
[2025-11-19 09:20:32,103] [INFO] [<frozen importlib] - Best train loss: 0.5416
[2025-11-19 09:20:32,103] [INFO] [<frozen importlib] - Best val loss: 0.4399
[2025-11-19 09:20:32,103] [INFO] [<frozen importlib] - Best val AUC: 0.7083
[2025-11-19 09:20:32,103] [INFO] [<frozen importlib] - Best val AUCPR: 0.2317
[2025-11-19 09:20:32,108] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:20:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:20:46,197] [INFO] [<frozen importlib] - Optimal threshold: 0.4387
[2025-11-19 09:20:46,197] [INFO] [<frozen importlib] - Best f1: 0.2744
[2025-11-19 09:20:46,197] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:20:46,238] [INFO] [<frozen importlib] - Validation Results (threshold=0.4387):
[2025-11-19 09:20:46,238] [INFO] [<frozen importlib] -   Accuracy: 0.8959
[2025-11-19 09:20:46,238] [INFO] [<frozen importlib] -   Precision: 0.2955
[2025-11-19 09:20:46,238] [INFO] [<frozen importlib] -   Recall: 0.2562
[2025-11-19 09:20:46,238] [INFO] [<frozen importlib] -   F1 Score: 0.2744
[2025-11-19 09:20:46,238] [INFO] [<frozen importlib] -   AUROC: 0.7083
[2025-11-19 09:20:46,238] [INFO] [<frozen importlib] -   AUPRC: 0.2321
[2025-11-19 09:20:46,238] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:20:46,238] [INFO] [<frozen importlib] -     TN=16558, FP=887
[2025-11-19 09:20:46,238] [INFO] [<frozen importlib] -     FN=1080, TP=372
[2025-11-19 09:20:46,260] [INFO] [<frozen importlib] - Trial 348: AUPRC=0.2321, F1=0.4453, Prec=0.4303, Rec=0.4614 | Optimizing auprc=0.2321
[2025-11-19 09:20:46,261] [INFO] [<frozen importlib] - Trial 348 pruned.
[2025-11-19 09:20:46,261] [ERROR] [<frozen importlib] - Trial 348 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  70%|██████▉   | 348/500 [58:44<29:02, 11.46s/it]Best trial: 289. Best value: 0.241792:  70%|██████▉   | 348/500 [58:44<29:02, 11.46s/it]Best trial: 289. Best value: 0.241792:  70%|██████▉   | 349/500 [58:44<31:11, 12.39s/it][2025-11-19 09:20:46,273] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.347045829321781
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   gamma: 0.3651724248781481
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   alpha: 0.4081511249485027
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   lambda: 0.7180611299048572
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   learning_rate: 0.04276914251532693
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   subsample: 0.8272064183892003
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   colsample_bytree: 0.8250702222447026
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5345853183494456
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   colsample_bynode: 0.8164186237681839
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:20:46,273] [INFO] [<frozen importlib] -   scale_pos_weight: 6.347045829321781
[2025-11-19 09:20:46,348] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:20:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:20:46,261] Trial 348 pruned. 
[0]	train-logloss:0.66256	train-auc:0.65373	train-aucpr:0.23558	val-logloss:0.65389	val-auc:0.62658	val-aucpr:0.11954
[10]	train-logloss:0.63666	train-auc:0.67853	train-aucpr:0.27829	val-logloss:0.58298	val-auc:0.66985	val-aucpr:0.17637
[20]	train-logloss:0.62179	train-auc:0.68708	train-aucpr:0.29603	val-logloss:0.54048	val-auc:0.67705	val-aucpr:0.19244
[30]	train-logloss:0.61161	train-auc:0.69738	train-aucpr:0.30677	val-logloss:0.51703	val-auc:0.68875	val-aucpr:0.20401
[40]	train-logloss:0.60457	train-auc:0.70184	train-aucpr:0.31203	val-logloss:0.50609	val-auc:0.69233	val-aucpr:0.21030
[50]	train-logloss:0.59921	train-auc:0.70552	train-aucpr:0.31661	val-logloss:0.49014	val-auc:0.69690	val-aucpr:0.21613
[60]	train-logloss:0.59526	train-auc:0.70926	train-aucpr:0.32085	val-logloss:0.48288	val-auc:0.69685	val-aucpr:0.22073
[70]	train-logloss:0.59184	train-auc:0.71363	train-aucpr:0.32574	val-logloss:0.48362	val-auc:0.69298	val-aucpr:0.20815
[80]	train-logloss:0.58845	train-auc:0.71899	train-aucpr:0.33141	val-logloss:0.46065	val-auc:0.68801	val-aucpr:0.20081
[90]	train-logloss:0.58550	train-auc:0.72430	train-aucpr:0.33552	val-logloss:0.44343	val-auc:0.68425	val-aucpr:0.19856
[2025-11-19 09:20:46,612] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:20:46,612] [INFO] [<frozen importlib] - Best train loss: 0.5953
[2025-11-19 09:20:46,612] [INFO] [<frozen importlib] - Best val loss: 0.4829
[2025-11-19 09:20:46,612] [INFO] [<frozen importlib] - Best val AUC: 0.6969
[2025-11-19 09:20:46,612] [INFO] [<frozen importlib] - Best val AUCPR: 0.2207
[2025-11-19 09:20:46,618] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:20:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:20:58,784] [INFO] [<frozen importlib] - Optimal threshold: 0.4643
[2025-11-19 09:20:58,784] [INFO] [<frozen importlib] - Best f1: 0.2743
[2025-11-19 09:20:58,784] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:20:58,827] [INFO] [<frozen importlib] - Validation Results (threshold=0.4643):
[2025-11-19 09:20:58,827] [INFO] [<frozen importlib] -   Accuracy: 0.8998
[2025-11-19 09:20:58,827] [INFO] [<frozen importlib] -   Precision: 0.3092
[2025-11-19 09:20:58,827] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 09:20:58,827] [INFO] [<frozen importlib] -   F1 Score: 0.2743
[2025-11-19 09:20:58,827] [INFO] [<frozen importlib] -   AUROC: 0.6969
[2025-11-19 09:20:58,827] [INFO] [<frozen importlib] -   AUPRC: 0.2211
[2025-11-19 09:20:58,827] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:20:58,827] [INFO] [<frozen importlib] -     TN=16645, FP=800
[2025-11-19 09:20:58,827] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 09:20:58,850] [INFO] [<frozen importlib] - Trial 349: AUPRC=0.2211, F1=0.4565, Prec=0.4543, Rec=0.4587 | Optimizing auprc=0.2211
[2025-11-19 09:20:58,851] [INFO] [<frozen importlib] - Trial 349 pruned.
[2025-11-19 09:20:58,851] [ERROR] [<frozen importlib] - Trial 349 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  70%|██████▉   | 349/500 [58:56<31:11, 12.39s/it]Best trial: 289. Best value: 0.241792:  70%|██████▉   | 349/500 [58:56<31:11, 12.39s/it]Best trial: 289. Best value: 0.241792:  70%|███████   | 350/500 [58:56<31:07, 12.45s/it][2025-11-19 09:20:58,863] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.54974600722123
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   gamma: 0.5922536019913534
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   alpha: 0.5058970821983968
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   lambda: 1.0782695411634369
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   learning_rate: 0.044588103670383836
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   subsample: 0.8419453831281352
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   colsample_bytree: 0.6106003783516503
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5127796968168651
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   colsample_bynode: 0.754632779436318
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:20:58,863] [INFO] [<frozen importlib] -   scale_pos_weight: 5.54974600722123
[2025-11-19 09:20:58,938] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:20:58] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:20:58,851] Trial 349 pruned. 
[0]	train-logloss:0.61803	train-auc:0.64354	train-aucpr:0.24568	val-logloss:0.60423	val-auc:0.59002	val-aucpr:0.13837
[10]	train-logloss:0.59420	train-auc:0.68175	train-aucpr:0.29530	val-logloss:0.54175	val-auc:0.69961	val-aucpr:0.22262
[20]	train-logloss:0.58023	train-auc:0.68937	train-aucpr:0.30232	val-logloss:0.50197	val-auc:0.69708	val-aucpr:0.21482
[30]	train-logloss:0.57132	train-auc:0.69448	train-aucpr:0.30747	val-logloss:0.48558	val-auc:0.69699	val-aucpr:0.22190
[40]	train-logloss:0.56468	train-auc:0.69949	train-aucpr:0.31487	val-logloss:0.47489	val-auc:0.69297	val-aucpr:0.21883
[2025-11-19 09:20:59,077] [INFO] [<frozen importlib] - Training completed at iteration 11
[2025-11-19 09:20:59,077] [INFO] [<frozen importlib] - Best train loss: 0.5926
[2025-11-19 09:20:59,077] [INFO] [<frozen importlib] - Best val loss: 0.5392
[2025-11-19 09:20:59,077] [INFO] [<frozen importlib] - Best val AUC: 0.7024
[2025-11-19 09:20:59,077] [INFO] [<frozen importlib] - Best val AUCPR: 0.2232
[2025-11-19 09:20:59,081] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:20:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:21:01,208] [INFO] [<frozen importlib] - Optimal threshold: 0.4495
[2025-11-19 09:21:01,208] [INFO] [<frozen importlib] - Best f1: 0.2694
[2025-11-19 09:21:01,208] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:21:01,250] [INFO] [<frozen importlib] - Validation Results (threshold=0.4495):
[2025-11-19 09:21:01,250] [INFO] [<frozen importlib] -   Accuracy: 0.8998
[2025-11-19 09:21:01,250] [INFO] [<frozen importlib] -   Precision: 0.3064
[2025-11-19 09:21:01,250] [INFO] [<frozen importlib] -   Recall: 0.2404
[2025-11-19 09:21:01,250] [INFO] [<frozen importlib] -   F1 Score: 0.2694
[2025-11-19 09:21:01,250] [INFO] [<frozen importlib] -   AUROC: 0.7024
[2025-11-19 09:21:01,250] [INFO] [<frozen importlib] -   AUPRC: 0.2220
[2025-11-19 09:21:01,250] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:21:01,250] [INFO] [<frozen importlib] -     TN=16655, FP=790
[2025-11-19 09:21:01,250] [INFO] [<frozen importlib] -     FN=1103, TP=349
[2025-11-19 09:21:01,273] [INFO] [<frozen importlib] - Trial 350: AUPRC=0.2220, F1=0.4596, Prec=0.4585, Rec=0.4607 | Optimizing auprc=0.2220
                                                                                        Best trial: 289. Best value: 0.241792:  70%|███████   | 350/500 [58:59<31:07, 12.45s/it]Best trial: 289. Best value: 0.241792:  70%|███████   | 350/500 [58:59<31:07, 12.45s/it]Best trial: 289. Best value: 0.241792:  70%|███████   | 351/500 [58:59<23:26,  9.44s/it][2025-11-19 09:21:01,286] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.94174427898518
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   gamma: 0.3260918165999557
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   alpha: 0.5746803410904805
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   lambda: 0.8112106456294838
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   learning_rate: 0.04066794806281034
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   subsample: 0.8611779492254308
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   colsample_bytree: 0.6203667377985614
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   colsample_bylevel: 0.522471120636751
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   colsample_bynode: 0.7714766400355137
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:21:01,286] [INFO] [<frozen importlib] -   scale_pos_weight: 5.94174427898518
[2025-11-19 09:21:01,356] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:21:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:21:01,273] Trial 350 finished with value: 0.22203393369754032 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.5922536019913534, 'learning_rate': 0.044588103670383836, 'n_estimators': 350, 'alpha': 0.5058970821983968, 'lambda': 1.0782695411634369, 'subsample': 0.8419453831281352, 'colsample_bytree': 0.6106003783516503, 'colsample_bylevel': 0.5127796968168651, 'colsample_bynode': 0.754632779436318, 'scale_pos_weight': 5.54974600722123}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.64065	train-auc:0.64042	train-aucpr:0.22013	val-logloss:0.63004	val-auc:0.58241	val-aucpr:0.10492
[10]	train-logloss:0.61706	train-auc:0.67881	train-aucpr:0.29389	val-logloss:0.56743	val-auc:0.71012	val-aucpr:0.21096
[20]	train-logloss:0.60257	train-auc:0.68734	train-aucpr:0.30011	val-logloss:0.53025	val-auc:0.70752	val-aucpr:0.21593
[30]	train-logloss:0.59329	train-auc:0.69459	train-aucpr:0.30578	val-logloss:0.51171	val-auc:0.70774	val-aucpr:0.22187
[40]	train-logloss:0.58681	train-auc:0.69885	train-aucpr:0.31060	val-logloss:0.48804	val-auc:0.70761	val-aucpr:0.21921
[50]	train-logloss:0.58150	train-auc:0.70297	train-aucpr:0.31573	val-logloss:0.47808	val-auc:0.70644	val-aucpr:0.21502
[60]	train-logloss:0.57794	train-auc:0.70620	train-aucpr:0.31883	val-logloss:0.47250	val-auc:0.70823	val-aucpr:0.22064
[61]	train-logloss:0.57755	train-auc:0.70699	train-aucpr:0.31937	val-logloss:0.47709	val-auc:0.70360	val-aucpr:0.21574
[2025-11-19 09:21:01,545] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 09:21:01,545] [INFO] [<frozen importlib] - Best train loss: 0.5925
[2025-11-19 09:21:01,545] [INFO] [<frozen importlib] - Best val loss: 0.5100
[2025-11-19 09:21:01,545] [INFO] [<frozen importlib] - Best val AUC: 0.7110
[2025-11-19 09:21:01,545] [INFO] [<frozen importlib] - Best val AUCPR: 0.2231
[2025-11-19 09:21:01,549] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:21:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:21:07,202] [INFO] [<frozen importlib] - Optimal threshold: 0.4584
[2025-11-19 09:21:07,202] [INFO] [<frozen importlib] - Best f1: 0.2763
[2025-11-19 09:21:07,202] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:21:07,242] [INFO] [<frozen importlib] - Validation Results (threshold=0.4584):
[2025-11-19 09:21:07,243] [INFO] [<frozen importlib] -   Accuracy: 0.9024
[2025-11-19 09:21:07,243] [INFO] [<frozen importlib] -   Precision: 0.3212
[2025-11-19 09:21:07,243] [INFO] [<frozen importlib] -   Recall: 0.2424
[2025-11-19 09:21:07,243] [INFO] [<frozen importlib] -   F1 Score: 0.2763
[2025-11-19 09:21:07,243] [INFO] [<frozen importlib] -   AUROC: 0.7110
[2025-11-19 09:21:07,243] [INFO] [<frozen importlib] -   AUPRC: 0.2235
[2025-11-19 09:21:07,243] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:21:07,243] [INFO] [<frozen importlib] -     TN=16701, FP=744
[2025-11-19 09:21:07,243] [INFO] [<frozen importlib] -     FN=1100, TP=352
[2025-11-19 09:21:07,267] [INFO] [<frozen importlib] - Trial 351: AUPRC=0.2235, F1=0.4414, Prec=0.4553, Rec=0.4284 | Optimizing auprc=0.2235
[2025-11-19 09:21:07,268] [INFO] [<frozen importlib] - Trial 351 pruned.
[2025-11-19 09:21:07,268] [ERROR] [<frozen importlib] - Trial 351 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  70%|███████   | 351/500 [59:05<23:26,  9.44s/it]Best trial: 289. Best value: 0.241792:  70%|███████   | 351/500 [59:05<23:26,  9.44s/it]Best trial: 289. Best value: 0.241792:  70%|███████   | 352/500 [59:05<20:44,  8.41s/it][2025-11-19 09:21:07,281] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.226866275106429
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   gamma: 0.3440226423731657
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   alpha: 0.45300883994248925
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   lambda: 0.9508502402826001
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   learning_rate: 0.03729690697855809
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   subsample: 0.8258047050113001
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   colsample_bytree: 0.5940062810418775
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5129585312039318
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   colsample_bynode: 0.7814129084574358
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:21:07,281] [INFO] [<frozen importlib] -   scale_pos_weight: 6.226866275106429
[2025-11-19 09:21:07,356] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:21:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:21:07,268] Trial 351 pruned. 
[0]	train-logloss:0.65687	train-auc:0.63961	train-aucpr:0.22324	val-logloss:0.64697	val-auc:0.54401	val-aucpr:0.10255
[10]	train-logloss:0.63422	train-auc:0.68198	train-aucpr:0.29228	val-logloss:0.59704	val-auc:0.69555	val-aucpr:0.20822
[20]	train-logloss:0.62036	train-auc:0.68676	train-aucpr:0.29891	val-logloss:0.55838	val-auc:0.68403	val-aucpr:0.21139
[30]	train-logloss:0.61048	train-auc:0.69167	train-aucpr:0.30411	val-logloss:0.52490	val-auc:0.69962	val-aucpr:0.22583
[40]	train-logloss:0.60357	train-auc:0.69574	train-aucpr:0.30849	val-logloss:0.50187	val-auc:0.71501	val-aucpr:0.23285
[50]	train-logloss:0.59786	train-auc:0.70073	train-aucpr:0.31271	val-logloss:0.49988	val-auc:0.71440	val-aucpr:0.23129
[60]	train-logloss:0.59378	train-auc:0.70449	train-aucpr:0.31754	val-logloss:0.49726	val-auc:0.71204	val-aucpr:0.23017
[70]	train-logloss:0.59018	train-auc:0.70865	train-aucpr:0.32118	val-logloss:0.48506	val-auc:0.71072	val-aucpr:0.23259
[80]	train-logloss:0.58716	train-auc:0.71283	train-aucpr:0.32494	val-logloss:0.47977	val-auc:0.71040	val-aucpr:0.22827
[90]	train-logloss:0.58482	train-auc:0.71548	train-aucpr:0.32860	val-logloss:0.47573	val-auc:0.70546	val-aucpr:0.22307
[97]	train-logloss:0.58310	train-auc:0.71855	train-aucpr:0.33156	val-logloss:0.46626	val-auc:0.70507	val-aucpr:0.22425
[2025-11-19 09:21:07,635] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:21:07,635] [INFO] [<frozen importlib] - Best train loss: 0.5908
[2025-11-19 09:21:07,635] [INFO] [<frozen importlib] - Best val loss: 0.4885
[2025-11-19 09:21:07,635] [INFO] [<frozen importlib] - Best val AUC: 0.7112
[2025-11-19 09:21:07,635] [INFO] [<frozen importlib] - Best val AUCPR: 0.2331
[2025-11-19 09:21:07,641] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:21:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:21:20,486] [INFO] [<frozen importlib] - Optimal threshold: 0.4851
[2025-11-19 09:21:20,486] [INFO] [<frozen importlib] - Best f1: 0.2786
[2025-11-19 09:21:20,487] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:21:20,532] [INFO] [<frozen importlib] - Validation Results (threshold=0.4851):
[2025-11-19 09:21:20,532] [INFO] [<frozen importlib] -   Accuracy: 0.9049
[2025-11-19 09:21:20,532] [INFO] [<frozen importlib] -   Precision: 0.3340
[2025-11-19 09:21:20,532] [INFO] [<frozen importlib] -   Recall: 0.2390
[2025-11-19 09:21:20,532] [INFO] [<frozen importlib] -   F1 Score: 0.2786
[2025-11-19 09:21:20,532] [INFO] [<frozen importlib] -   AUROC: 0.7112
[2025-11-19 09:21:20,532] [INFO] [<frozen importlib] -   AUPRC: 0.2335
[2025-11-19 09:21:20,532] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:21:20,533] [INFO] [<frozen importlib] -     TN=16753, FP=692
[2025-11-19 09:21:20,533] [INFO] [<frozen importlib] -     FN=1105, TP=347
[2025-11-19 09:21:20,562] [INFO] [<frozen importlib] - Trial 352: AUPRC=0.2335, F1=0.4691, Prec=0.4870, Rec=0.4525 | Optimizing auprc=0.2335
[2025-11-19 09:21:20,563] [INFO] [<frozen importlib] - Trial 352 pruned.
[2025-11-19 09:21:20,563] [ERROR] [<frozen importlib] - Trial 352 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  70%|███████   | 352/500 [59:18<20:44,  8.41s/it]Best trial: 289. Best value: 0.241792:  70%|███████   | 352/500 [59:18<20:44,  8.41s/it]Best trial: 289. Best value: 0.241792:  71%|███████   | 353/500 [59:18<24:11,  9.87s/it][2025-11-19 09:21:20,574] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.295862386695076
[2025-11-19 09:21:20,574] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:21:20,574] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:21:20,574] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:21:20,574] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:21:20,574] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:21:20,574] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:21:20,574] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:21:20,574] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   gamma: 0.3039341609957324
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   alpha: 0.5494387173968667
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   lambda: 0.5755760326156133
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   learning_rate: 0.03935829819328032
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   subsample: 0.8374742755759109
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   colsample_bytree: 0.5832844956453554
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5334144947852912
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   colsample_bynode: 0.7970513159870776
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:21:20,575] [INFO] [<frozen importlib] -   scale_pos_weight: 5.295862386695076
[2025-11-19 09:21:20,647] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:21:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:21:20,563] Trial 352 pruned. 
[0]	train-logloss:0.60403	train-auc:0.63969	train-aucpr:0.23773	val-logloss:0.58807	val-auc:0.62678	val-aucpr:0.12586
[10]	train-logloss:0.58272	train-auc:0.68145	train-aucpr:0.29214	val-logloss:0.54259	val-auc:0.68655	val-aucpr:0.19660
[20]	train-logloss:0.56973	train-auc:0.68844	train-aucpr:0.29875	val-logloss:0.51132	val-auc:0.69282	val-aucpr:0.21235
[30]	train-logloss:0.56075	train-auc:0.69495	train-aucpr:0.30606	val-logloss:0.49043	val-auc:0.68769	val-aucpr:0.22043
[40]	train-logloss:0.55433	train-auc:0.69922	train-aucpr:0.31011	val-logloss:0.47700	val-auc:0.70145	val-aucpr:0.21971
[50]	train-logloss:0.54902	train-auc:0.70392	train-aucpr:0.31560	val-logloss:0.45773	val-auc:0.70633	val-aucpr:0.22563
[60]	train-logloss:0.54551	train-auc:0.70734	train-aucpr:0.31933	val-logloss:0.45470	val-auc:0.70756	val-aucpr:0.22745
[70]	train-logloss:0.54258	train-auc:0.71131	train-aucpr:0.32336	val-logloss:0.44603	val-auc:0.69914	val-aucpr:0.21814
[80]	train-logloss:0.53981	train-auc:0.71472	train-aucpr:0.32793	val-logloss:0.43671	val-auc:0.70463	val-aucpr:0.21557
[89]	train-logloss:0.53763	train-auc:0.71864	train-aucpr:0.33195	val-logloss:0.43333	val-auc:0.70218	val-aucpr:0.21060
[2025-11-19 09:21:20,897] [INFO] [<frozen importlib] - Training completed at iteration 59
[2025-11-19 09:21:20,897] [INFO] [<frozen importlib] - Best train loss: 0.5458
[2025-11-19 09:21:20,897] [INFO] [<frozen importlib] - Best val loss: 0.4559
[2025-11-19 09:21:20,897] [INFO] [<frozen importlib] - Best val AUC: 0.7086
[2025-11-19 09:21:20,897] [INFO] [<frozen importlib] - Best val AUCPR: 0.2278
[2025-11-19 09:21:20,902] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:21:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:21:34,021] [INFO] [<frozen importlib] - Optimal threshold: 0.4491
[2025-11-19 09:21:34,022] [INFO] [<frozen importlib] - Best f1: 0.2715
[2025-11-19 09:21:34,022] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:21:34,066] [INFO] [<frozen importlib] - Validation Results (threshold=0.4491):
[2025-11-19 09:21:34,067] [INFO] [<frozen importlib] -   Accuracy: 0.8980
[2025-11-19 09:21:34,067] [INFO] [<frozen importlib] -   Precision: 0.3009
[2025-11-19 09:21:34,067] [INFO] [<frozen importlib] -   Recall: 0.2472
[2025-11-19 09:21:34,067] [INFO] [<frozen importlib] -   F1 Score: 0.2715
[2025-11-19 09:21:34,067] [INFO] [<frozen importlib] -   AUROC: 0.7086
[2025-11-19 09:21:34,067] [INFO] [<frozen importlib] -   AUPRC: 0.2282
[2025-11-19 09:21:34,067] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:21:34,067] [INFO] [<frozen importlib] -     TN=16611, FP=834
[2025-11-19 09:21:34,067] [INFO] [<frozen importlib] -     FN=1093, TP=359
[2025-11-19 09:21:34,091] [INFO] [<frozen importlib] - Trial 353: AUPRC=0.2282, F1=0.4606, Prec=0.4506, Rec=0.4711 | Optimizing auprc=0.2282
                                                                                        Best trial: 289. Best value: 0.241792:  71%|███████   | 353/500 [59:32<24:11,  9.87s/it]Best trial: 289. Best value: 0.241792:  71%|███████   | 353/500 [59:32<24:11,  9.87s/it]Best trial: 289. Best value: 0.241792:  71%|███████   | 354/500 [59:32<26:41, 10.97s/it][2025-11-19 09:21:34,106] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.852262945226215
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   gamma: 0.37467280965376765
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   alpha: 0.594526744034285
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   lambda: 0.6661524798956864
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   learning_rate: 0.035493796675060175
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   subsample: 0.8200285607538326
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   colsample_bytree: 0.9036330035264102
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9907956300178833
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   colsample_bynode: 0.7700304823445234
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:21:34,106] [INFO] [<frozen importlib] -   scale_pos_weight: 5.852262945226215
[2025-11-19 09:21:34,177] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:21:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:21:34,091] Trial 353 finished with value: 0.22821025977031478 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.3039341609957324, 'learning_rate': 0.03935829819328032, 'n_estimators': 350, 'alpha': 0.5494387173968667, 'lambda': 0.5755760326156133, 'subsample': 0.8374742755759109, 'colsample_bytree': 0.5832844956453554, 'colsample_bylevel': 0.5334144947852912, 'colsample_bynode': 0.7970513159870776, 'scale_pos_weight': 5.295862386695076}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.63550	train-auc:0.65504	train-aucpr:0.23853	val-logloss:0.62247	val-auc:0.65286	val-aucpr:0.14359
[10]	train-logloss:0.61347	train-auc:0.67682	train-aucpr:0.27917	val-logloss:0.56302	val-auc:0.67271	val-aucpr:0.17097
[20]	train-logloss:0.60014	train-auc:0.68622	train-aucpr:0.29267	val-logloss:0.52428	val-auc:0.67891	val-aucpr:0.19183
[30]	train-logloss:0.59050	train-auc:0.69316	train-aucpr:0.30362	val-logloss:0.49867	val-auc:0.68415	val-aucpr:0.20009
[40]	train-logloss:0.58368	train-auc:0.69847	train-aucpr:0.30961	val-logloss:0.47358	val-auc:0.68603	val-aucpr:0.20546
[50]	train-logloss:0.57779	train-auc:0.70320	train-aucpr:0.31608	val-logloss:0.46719	val-auc:0.69137	val-aucpr:0.20832
[60]	train-logloss:0.57377	train-auc:0.70676	train-aucpr:0.32094	val-logloss:0.46049	val-auc:0.69455	val-aucpr:0.21075
[70]	train-logloss:0.57010	train-auc:0.71164	train-aucpr:0.32545	val-logloss:0.46324	val-auc:0.68810	val-aucpr:0.19983
[80]	train-logloss:0.56711	train-auc:0.71613	train-aucpr:0.33003	val-logloss:0.46455	val-auc:0.68916	val-aucpr:0.19951
[84]	train-logloss:0.56608	train-auc:0.71766	train-aucpr:0.33125	val-logloss:0.46246	val-auc:0.68843	val-aucpr:0.19921
[2025-11-19 09:21:34,429] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 09:21:34,429] [INFO] [<frozen importlib] - Best train loss: 0.5759
[2025-11-19 09:21:34,429] [INFO] [<frozen importlib] - Best val loss: 0.4619
[2025-11-19 09:21:34,429] [INFO] [<frozen importlib] - Best val AUC: 0.6969
[2025-11-19 09:21:34,429] [INFO] [<frozen importlib] - Best val AUCPR: 0.2141
[2025-11-19 09:21:34,433] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:21:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:21:42,805] [INFO] [<frozen importlib] - Optimal threshold: 0.4287
[2025-11-19 09:21:42,805] [INFO] [<frozen importlib] - Best f1: 0.2723
[2025-11-19 09:21:42,805] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:21:42,845] [INFO] [<frozen importlib] - Validation Results (threshold=0.4287):
[2025-11-19 09:21:42,845] [INFO] [<frozen importlib] -   Accuracy: 0.8854
[2025-11-19 09:21:42,845] [INFO] [<frozen importlib] -   Precision: 0.2659
[2025-11-19 09:21:42,845] [INFO] [<frozen importlib] -   Recall: 0.2789
[2025-11-19 09:21:42,845] [INFO] [<frozen importlib] -   F1 Score: 0.2723
[2025-11-19 09:21:42,845] [INFO] [<frozen importlib] -   AUROC: 0.6969
[2025-11-19 09:21:42,845] [INFO] [<frozen importlib] -   AUPRC: 0.2145
[2025-11-19 09:21:42,845] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:21:42,845] [INFO] [<frozen importlib] -     TN=16327, FP=1118
[2025-11-19 09:21:42,845] [INFO] [<frozen importlib] -     FN=1047, TP=405
[2025-11-19 09:21:42,868] [INFO] [<frozen importlib] - Trial 354: AUPRC=0.2145, F1=0.4675, Prec=0.4122, Rec=0.5399 | Optimizing auprc=0.2145
[2025-11-19 09:21:42,868] [INFO] [<frozen importlib] - Trial 354 pruned.
[2025-11-19 09:21:42,868] [ERROR] [<frozen importlib] - Trial 354 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  71%|███████   | 354/500 [59:40<26:41, 10.97s/it]Best trial: 289. Best value: 0.241792:  71%|███████   | 354/500 [59:40<26:41, 10.97s/it]Best trial: 289. Best value: 0.241792:  71%|███████   | 355/500 [59:40<24:55, 10.31s/it][2025-11-19 09:21:42,881] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.407091544941013
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   gamma: 0.8086923105512769
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   alpha: 0.48750850550044333
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   lambda: 4.049116143394996
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   learning_rate: 0.04142643241095533
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   subsample: 0.8319487594645879
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   colsample_bytree: 0.6276616545650147
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5245989669212915
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   colsample_bynode: 0.7607159800647002
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:21:42,881] [INFO] [<frozen importlib] -   scale_pos_weight: 9.407091544941013
[2025-11-19 09:21:42,957] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:21:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:21:42,868] Trial 354 pruned. 
[0]	train-logloss:0.81893	train-auc:0.64932	train-aucpr:0.24068	val-logloss:0.82994	val-auc:0.61737	val-aucpr:0.11728
[10]	train-logloss:0.78701	train-auc:0.68232	train-aucpr:0.28955	val-logloss:0.75412	val-auc:0.64892	val-aucpr:0.18241
[20]	train-logloss:0.76834	train-auc:0.68897	train-aucpr:0.29842	val-logloss:0.69328	val-auc:0.68564	val-aucpr:0.19527
[30]	train-logloss:0.75546	train-auc:0.69501	train-aucpr:0.30566	val-logloss:0.65198	val-auc:0.69385	val-aucpr:0.21502
[40]	train-logloss:0.74669	train-auc:0.69869	train-aucpr:0.31079	val-logloss:0.63436	val-auc:0.69906	val-aucpr:0.21367
[50]	train-logloss:0.73955	train-auc:0.70331	train-aucpr:0.31479	val-logloss:0.62706	val-auc:0.70325	val-aucpr:0.21286
[60]	train-logloss:0.73445	train-auc:0.70712	train-aucpr:0.31922	val-logloss:0.61078	val-auc:0.70294	val-aucpr:0.21476
[64]	train-logloss:0.73260	train-auc:0.70928	train-aucpr:0.32084	val-logloss:0.62366	val-auc:0.69785	val-aucpr:0.21213
[2025-11-19 09:21:43,153] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 09:21:43,153] [INFO] [<frozen importlib] - Best train loss: 0.7516
[2025-11-19 09:21:43,153] [INFO] [<frozen importlib] - Best val loss: 0.6375
[2025-11-19 09:21:43,153] [INFO] [<frozen importlib] - Best val AUC: 0.6979
[2025-11-19 09:21:43,153] [INFO] [<frozen importlib] - Best val AUCPR: 0.2161
[2025-11-19 09:21:43,158] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:21:43] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:21:49,988] [INFO] [<frozen importlib] - Optimal threshold: 0.5613
[2025-11-19 09:21:49,988] [INFO] [<frozen importlib] - Best f1: 0.2625
[2025-11-19 09:21:49,988] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:21:50,029] [INFO] [<frozen importlib] - Validation Results (threshold=0.5613):
[2025-11-19 09:21:50,029] [INFO] [<frozen importlib] -   Accuracy: 0.9001
[2025-11-19 09:21:50,029] [INFO] [<frozen importlib] -   Precision: 0.3032
[2025-11-19 09:21:50,029] [INFO] [<frozen importlib] -   Recall: 0.2314
[2025-11-19 09:21:50,029] [INFO] [<frozen importlib] -   F1 Score: 0.2625
[2025-11-19 09:21:50,029] [INFO] [<frozen importlib] -   AUROC: 0.6979
[2025-11-19 09:21:50,029] [INFO] [<frozen importlib] -   AUPRC: 0.2163
[2025-11-19 09:21:50,029] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:21:50,029] [INFO] [<frozen importlib] -     TN=16673, FP=772
[2025-11-19 09:21:50,029] [INFO] [<frozen importlib] -     FN=1116, TP=336
[2025-11-19 09:21:50,052] [INFO] [<frozen importlib] - Trial 355: AUPRC=0.2163, F1=0.4545, Prec=0.4586, Rec=0.4504 | Optimizing auprc=0.2163
[2025-11-19 09:21:50,052] [INFO] [<frozen importlib] - Trial 355 pruned.
[2025-11-19 09:21:50,052] [ERROR] [<frozen importlib] - Trial 355 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  71%|███████   | 355/500 [59:48<24:55, 10.31s/it]Best trial: 289. Best value: 0.241792:  71%|███████   | 355/500 [59:48<24:55, 10.31s/it]Best trial: 289. Best value: 0.241792:  71%|███████   | 356/500 [59:48<22:29,  9.37s/it][2025-11-19 09:21:50,065] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.091566312229828
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   gamma: 0.3378472101813995
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   alpha: 0.5119870560009437
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   lambda: 1.1555254828337411
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   learning_rate: 0.03784100864579863
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   subsample: 0.8051788865508162
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   colsample_bytree: 0.5989883602732604
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6641914985806509
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   colsample_bynode: 0.7848807899301812
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:21:50,065] [INFO] [<frozen importlib] -   scale_pos_weight: 7.091566312229828
[2025-11-19 09:21:50,135] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:21:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:21:50,052] Trial 355 pruned. 
[0]	train-logloss:0.70411	train-auc:0.63595	train-aucpr:0.23023	val-logloss:0.70125	val-auc:0.60079	val-aucpr:0.13350
[10]	train-logloss:0.67844	train-auc:0.68117	train-aucpr:0.29286	val-logloss:0.64650	val-auc:0.66186	val-aucpr:0.17272
[20]	train-logloss:0.66272	train-auc:0.68836	train-aucpr:0.30089	val-logloss:0.60758	val-auc:0.69181	val-aucpr:0.20969
[30]	train-logloss:0.65193	train-auc:0.69479	train-aucpr:0.30720	val-logloss:0.57466	val-auc:0.69418	val-aucpr:0.22494
[40]	train-logloss:0.64435	train-auc:0.69906	train-aucpr:0.31128	val-logloss:0.55418	val-auc:0.70398	val-aucpr:0.23246
[50]	train-logloss:0.63826	train-auc:0.70315	train-aucpr:0.31629	val-logloss:0.53804	val-auc:0.70589	val-aucpr:0.23016
[60]	train-logloss:0.63416	train-auc:0.70590	train-aucpr:0.31858	val-logloss:0.52386	val-auc:0.70772	val-aucpr:0.23025
[70]	train-logloss:0.63048	train-auc:0.70870	train-aucpr:0.32168	val-logloss:0.51545	val-auc:0.70935	val-aucpr:0.22966
[74]	train-logloss:0.62948	train-auc:0.70986	train-aucpr:0.32320	val-logloss:0.51696	val-auc:0.70829	val-aucpr:0.22471
[2025-11-19 09:21:50,360] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 09:21:50,360] [INFO] [<frozen importlib] - Best train loss: 0.6411
[2025-11-19 09:21:50,360] [INFO] [<frozen importlib] - Best val loss: 0.5434
[2025-11-19 09:21:50,360] [INFO] [<frozen importlib] - Best val AUC: 0.7053
[2025-11-19 09:21:50,360] [INFO] [<frozen importlib] - Best val AUCPR: 0.2336
[2025-11-19 09:21:50,364] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:21:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:21:59,229] [INFO] [<frozen importlib] - Optimal threshold: 0.5083
[2025-11-19 09:21:59,229] [INFO] [<frozen importlib] - Best f1: 0.2863
[2025-11-19 09:21:59,229] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:21:59,272] [INFO] [<frozen importlib] - Validation Results (threshold=0.5083):
[2025-11-19 09:21:59,272] [INFO] [<frozen importlib] -   Accuracy: 0.9063
[2025-11-19 09:21:59,272] [INFO] [<frozen importlib] -   Precision: 0.3453
[2025-11-19 09:21:59,272] [INFO] [<frozen importlib] -   Recall: 0.2445
[2025-11-19 09:21:59,272] [INFO] [<frozen importlib] -   F1 Score: 0.2863
[2025-11-19 09:21:59,272] [INFO] [<frozen importlib] -   AUROC: 0.7053
[2025-11-19 09:21:59,272] [INFO] [<frozen importlib] -   AUPRC: 0.2343
[2025-11-19 09:21:59,272] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:21:59,272] [INFO] [<frozen importlib] -     TN=16772, FP=673
[2025-11-19 09:21:59,272] [INFO] [<frozen importlib] -     FN=1097, TP=355
[2025-11-19 09:21:59,297] [INFO] [<frozen importlib] - Trial 356: AUPRC=0.2343, F1=0.4529, Prec=0.4803, Rec=0.4284 | Optimizing auprc=0.2343
[2025-11-19 09:21:59,298] [INFO] [<frozen importlib] - Trial 356 pruned.
[2025-11-19 09:21:59,298] [ERROR] [<frozen importlib] - Trial 356 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  71%|███████   | 356/500 [59:57<22:29,  9.37s/it]Best trial: 289. Best value: 0.241792:  71%|███████   | 356/500 [59:57<22:29,  9.37s/it]Best trial: 289. Best value: 0.241792:  71%|███████▏  | 357/500 [59:57<22:14,  9.34s/it][2025-11-19 09:21:59,310] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.411763113680524
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   gamma: 0.3033183778208812
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   alpha: 0.43048204519734284
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   lambda: 1.0039906030758732
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   learning_rate: 0.039947563726127705
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   subsample: 0.8446287781024597
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   colsample_bytree: 0.6073416595298469
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7987119112412718
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   colsample_bynode: 0.7479995216613121
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:21:59,310] [INFO] [<frozen importlib] -   scale_pos_weight: 6.411763113680524
[2025-11-19 09:21:59,380] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:21:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:21:59,298] Trial 356 pruned. 
[0]	train-logloss:0.66653	train-auc:0.65288	train-aucpr:0.23083	val-logloss:0.65886	val-auc:0.63379	val-aucpr:0.14360
[10]	train-logloss:0.64176	train-auc:0.68016	train-aucpr:0.29075	val-logloss:0.59407	val-auc:0.68798	val-aucpr:0.20292
[20]	train-logloss:0.62662	train-auc:0.69072	train-aucpr:0.30006	val-logloss:0.55189	val-auc:0.68618	val-aucpr:0.20335
[30]	train-logloss:0.61637	train-auc:0.69670	train-aucpr:0.30685	val-logloss:0.53121	val-auc:0.68921	val-aucpr:0.22178
[40]	train-logloss:0.60903	train-auc:0.69956	train-aucpr:0.31239	val-logloss:0.52237	val-auc:0.69379	val-aucpr:0.22170
[50]	train-logloss:0.60371	train-auc:0.70399	train-aucpr:0.31717	val-logloss:0.51439	val-auc:0.69603	val-aucpr:0.22466
[60]	train-logloss:0.59981	train-auc:0.70710	train-aucpr:0.32133	val-logloss:0.50719	val-auc:0.69756	val-aucpr:0.22395
[70]	train-logloss:0.59654	train-auc:0.71124	train-aucpr:0.32499	val-logloss:0.51372	val-auc:0.69476	val-aucpr:0.21631
[80]	train-logloss:0.59335	train-auc:0.71599	train-aucpr:0.32949	val-logloss:0.51026	val-auc:0.68996	val-aucpr:0.20948
[84]	train-logloss:0.59232	train-auc:0.71694	train-aucpr:0.33072	val-logloss:0.50743	val-auc:0.69014	val-aucpr:0.21281
[2025-11-19 09:21:59,624] [INFO] [<frozen importlib] - Training completed at iteration 54
[2025-11-19 09:21:59,624] [INFO] [<frozen importlib] - Best train loss: 0.6022
[2025-11-19 09:21:59,624] [INFO] [<frozen importlib] - Best val loss: 0.5110
[2025-11-19 09:21:59,624] [INFO] [<frozen importlib] - Best val AUC: 0.6971
[2025-11-19 09:21:59,624] [INFO] [<frozen importlib] - Best val AUCPR: 0.2264
[2025-11-19 09:21:59,628] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:21:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:22:10,074] [INFO] [<frozen importlib] - Optimal threshold: 0.4754
[2025-11-19 09:22:10,074] [INFO] [<frozen importlib] - Best f1: 0.2732
[2025-11-19 09:22:10,074] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:22:10,116] [INFO] [<frozen importlib] - Validation Results (threshold=0.4754):
[2025-11-19 09:22:10,116] [INFO] [<frozen importlib] -   Accuracy: 0.8936
[2025-11-19 09:22:10,116] [INFO] [<frozen importlib] -   Precision: 0.2875
[2025-11-19 09:22:10,116] [INFO] [<frozen importlib] -   Recall: 0.2603
[2025-11-19 09:22:10,116] [INFO] [<frozen importlib] -   F1 Score: 0.2732
[2025-11-19 09:22:10,116] [INFO] [<frozen importlib] -   AUROC: 0.6971
[2025-11-19 09:22:10,117] [INFO] [<frozen importlib] -   AUPRC: 0.2267
[2025-11-19 09:22:10,117] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:22:10,117] [INFO] [<frozen importlib] -     TN=16508, FP=937
[2025-11-19 09:22:10,117] [INFO] [<frozen importlib] -     FN=1074, TP=378
[2025-11-19 09:22:10,144] [INFO] [<frozen importlib] - Trial 357: AUPRC=0.2267, F1=0.4567, Prec=0.4300, Rec=0.4869 | Optimizing auprc=0.2267
[2025-11-19 09:22:10,144] [INFO] [<frozen importlib] - Trial 357 pruned.
[2025-11-19 09:22:10,144] [ERROR] [<frozen importlib] - Trial 357 failed with error: 
                                                                                        Best trial: 289. Best value: 0.241792:  71%|███████▏  | 357/500 [1:00:08<22:14,  9.34s/it]Best trial: 289. Best value: 0.241792:  71%|███████▏  | 357/500 [1:00:08<22:14,  9.34s/it]Best trial: 289. Best value: 0.241792:  72%|███████▏  | 358/500 [1:00:08<23:09,  9.79s/it][2025-11-19 09:22:10,157] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.731966525653106
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   gamma: 0.34252849693035997
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   alpha: 0.6123283641124908
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   lambda: 0.8447418725387439
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   learning_rate: 0.10053128166044054
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   subsample: 0.8134205063444361
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   colsample_bytree: 0.5719973470480781
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5107786684676336
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   colsample_bynode: 0.8069954342050477
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:22:10,157] [INFO] [<frozen importlib] -   scale_pos_weight: 5.731966525653106
[2025-11-19 09:22:10,231] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:22:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:22:10,144] Trial 357 pruned. 
[0]	train-logloss:0.62464	train-auc:0.64272	train-aucpr:0.23422	val-logloss:0.60994	val-auc:0.61416	val-aucpr:0.13392
[10]	train-logloss:0.58541	train-auc:0.68918	train-aucpr:0.29772	val-logloss:0.50595	val-auc:0.67933	val-aucpr:0.19632
[20]	train-logloss:0.57089	train-auc:0.70069	train-aucpr:0.30998	val-logloss:0.45851	val-auc:0.70140	val-aucpr:0.21442
[30]	train-logloss:0.56321	train-auc:0.71072	train-aucpr:0.32023	val-logloss:0.44191	val-auc:0.70774	val-aucpr:0.21411
[40]	train-logloss:0.55679	train-auc:0.72341	train-aucpr:0.33264	val-logloss:0.43373	val-auc:0.70569	val-aucpr:0.20482
[50]	train-logloss:0.55109	train-auc:0.73150	train-aucpr:0.34237	val-logloss:0.40759	val-auc:0.69680	val-aucpr:0.18992
[58]	train-logloss:0.54795	train-auc:0.73945	train-aucpr:0.34976	val-logloss:0.38828	val-auc:0.70041	val-aucpr:0.20105
[2025-11-19 09:22:10,414] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 09:22:10,414] [INFO] [<frozen importlib] - Best train loss: 0.5637
[2025-11-19 09:22:10,414] [INFO] [<frozen importlib] - Best val loss: 0.4366
[2025-11-19 09:22:10,414] [INFO] [<frozen importlib] - Best val AUC: 0.7093
[2025-11-19 09:22:10,414] [INFO] [<frozen importlib] - Best val AUCPR: 0.2153
[2025-11-19 09:22:10,419] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:22:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:22:22,098] [INFO] [<frozen importlib] - Optimal threshold: 0.4498
[2025-11-19 09:22:22,099] [INFO] [<frozen importlib] - Best f1: 0.2620
[2025-11-19 09:22:22,099] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:22:22,143] [INFO] [<frozen importlib] - Validation Results (threshold=0.4498):
[2025-11-19 09:22:22,143] [INFO] [<frozen importlib] -   Accuracy: 0.8912
[2025-11-19 09:22:22,143] [INFO] [<frozen importlib] -   Precision: 0.2736
[2025-11-19 09:22:22,143] [INFO] [<frozen importlib] -   Recall: 0.2514
[2025-11-19 09:22:22,143] [INFO] [<frozen importlib] -   F1 Score: 0.2620
[2025-11-19 09:22:22,143] [INFO] [<frozen importlib] -   AUROC: 0.7093
[2025-11-19 09:22:22,143] [INFO] [<frozen importlib] -   AUPRC: 0.2158
[2025-11-19 09:22:22,143] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:22:22,143] [INFO] [<frozen importlib] -     TN=16476, FP=969
[2025-11-19 09:22:22,143] [INFO] [<frozen importlib] -     FN=1087, TP=365
[2025-11-19 09:22:22,165] [INFO] [<frozen importlib] - Trial 358: AUPRC=0.2158, F1=0.4585, Prec=0.4263, Rec=0.4959 | Optimizing auprc=0.2158
[2025-11-19 09:22:22,165] [INFO] [<frozen importlib] - Trial 358 pruned.
[2025-11-19 09:22:22,166] [ERROR] [<frozen importlib] - Trial 358 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  72%|███████▏  | 358/500 [1:00:20<23:09,  9.79s/it]Best trial: 289. Best value: 0.241792:  72%|███████▏  | 358/500 [1:00:20<23:09,  9.79s/it]Best trial: 289. Best value: 0.241792:  72%|███████▏  | 359/500 [1:00:20<24:34, 10.46s/it][2025-11-19 09:22:22,178] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.133218153760723
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   gamma: 0.2528427889381854
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   alpha: 0.5446795519436135
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   lambda: 0.43265845924208
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   learning_rate: 0.04251522505781841
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   subsample: 0.8255746827478155
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   colsample_bytree: 0.5904619174798551
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   colsample_bylevel: 0.518939978989056
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   colsample_bynode: 0.7742970791004506
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:22:22,178] [INFO] [<frozen importlib] -   scale_pos_weight: 6.133218153760723
[2025-11-19 09:22:22,251] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:22:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:22:22,166] Trial 358 pruned. 
[0]	train-logloss:0.65142	train-auc:0.62992	train-aucpr:0.22364	val-logloss:0.64361	val-auc:0.60791	val-aucpr:0.11561
[10]	train-logloss:0.62612	train-auc:0.68176	train-aucpr:0.28745	val-logloss:0.58749	val-auc:0.70759	val-aucpr:0.19569
[20]	train-logloss:0.61177	train-auc:0.68803	train-aucpr:0.29844	val-logloss:0.54587	val-auc:0.70115	val-aucpr:0.21422
[30]	train-logloss:0.60222	train-auc:0.69495	train-aucpr:0.30563	val-logloss:0.51795	val-auc:0.70811	val-aucpr:0.22956
[40]	train-logloss:0.59563	train-auc:0.70107	train-aucpr:0.31021	val-logloss:0.51422	val-auc:0.70697	val-aucpr:0.22626
[50]	train-logloss:0.58978	train-auc:0.70559	train-aucpr:0.31587	val-logloss:0.50713	val-auc:0.70944	val-aucpr:0.22917
[60]	train-logloss:0.58617	train-auc:0.70913	train-aucpr:0.31993	val-logloss:0.49715	val-auc:0.71162	val-aucpr:0.23257
[70]	train-logloss:0.58268	train-auc:0.71323	train-aucpr:0.32465	val-logloss:0.48799	val-auc:0.70977	val-aucpr:0.22858
[80]	train-logloss:0.57931	train-auc:0.71820	train-aucpr:0.32957	val-logloss:0.48182	val-auc:0.70439	val-aucpr:0.22487
[90]	train-logloss:0.57662	train-auc:0.72266	train-aucpr:0.33369	val-logloss:0.46131	val-auc:0.68899	val-aucpr:0.21334
[93]	train-logloss:0.57604	train-auc:0.72363	train-aucpr:0.33470	val-logloss:0.45951	val-auc:0.69033	val-aucpr:0.21305
[2025-11-19 09:22:22,523] [INFO] [<frozen importlib] - Training completed at iteration 64
[2025-11-19 09:22:22,523] [INFO] [<frozen importlib] - Best train loss: 0.5848
[2025-11-19 09:22:22,523] [INFO] [<frozen importlib] - Best val loss: 0.4910
[2025-11-19 09:22:22,523] [INFO] [<frozen importlib] - Best val AUC: 0.7132
[2025-11-19 09:22:22,523] [INFO] [<frozen importlib] - Best val AUCPR: 0.2336
[2025-11-19 09:22:22,528] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:22:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:22:35,478] [INFO] [<frozen importlib] - Optimal threshold: 0.4897
[2025-11-19 09:22:35,478] [INFO] [<frozen importlib] - Best f1: 0.2797
[2025-11-19 09:22:35,478] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:22:35,531] [INFO] [<frozen importlib] - Validation Results (threshold=0.4897):
[2025-11-19 09:22:35,531] [INFO] [<frozen importlib] -   Accuracy: 0.9041
[2025-11-19 09:22:35,531] [INFO] [<frozen importlib] -   Precision: 0.3305
[2025-11-19 09:22:35,531] [INFO] [<frozen importlib] -   Recall: 0.2424
[2025-11-19 09:22:35,531] [INFO] [<frozen importlib] -   F1 Score: 0.2797
[2025-11-19 09:22:35,531] [INFO] [<frozen importlib] -   AUROC: 0.7132
[2025-11-19 09:22:35,531] [INFO] [<frozen importlib] -   AUPRC: 0.2339
[2025-11-19 09:22:35,531] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:22:35,531] [INFO] [<frozen importlib] -     TN=16732, FP=713
[2025-11-19 09:22:35,531] [INFO] [<frozen importlib] -     FN=1100, TP=352
[2025-11-19 09:22:35,555] [INFO] [<frozen importlib] - Trial 359: AUPRC=0.2339, F1=0.4464, Prec=0.4659, Rec=0.4284 | Optimizing auprc=0.2339
                                                                                          Best trial: 289. Best value: 0.241792:  72%|███████▏  | 359/500 [1:00:33<24:34, 10.46s/it]Best trial: 289. Best value: 0.241792:  72%|███████▏  | 359/500 [1:00:33<24:34, 10.46s/it]Best trial: 289. Best value: 0.241792:  72%|███████▏  | 360/500 [1:00:33<26:27, 11.34s/it][2025-11-19 09:22:35,570] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.261825326461462
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   gamma: 0.2885651530754717
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   alpha: 0.3780887244120007
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   lambda: 1.0735391188557093
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   learning_rate: 0.03643440620320646
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   subsample: 0.8010297602323244
[2025-11-19 09:22:35,570] [INFO] [<frozen importlib] -   colsample_bytree: 0.580284186125645
[2025-11-19 09:22:35,571] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5084035271387523
[2025-11-19 09:22:35,571] [INFO] [<frozen importlib] -   colsample_bynode: 0.6746734872905183
[2025-11-19 09:22:35,571] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:22:35,571] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:22:35,571] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:22:35,571] [INFO] [<frozen importlib] -   scale_pos_weight: 7.261825326461462
[2025-11-19 09:22:35,643] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:22:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:22:35,556] Trial 359 finished with value: 0.23394823468263803 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.2528427889381854, 'learning_rate': 0.04251522505781841, 'n_estimators': 250, 'alpha': 0.5446795519436135, 'lambda': 0.43265845924208, 'subsample': 0.8255746827478155, 'colsample_bytree': 0.5904619174798551, 'colsample_bylevel': 0.518939978989056, 'colsample_bynode': 0.7742970791004506, 'scale_pos_weight': 6.133218153760723}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.71282	train-auc:0.64784	train-aucpr:0.22245	val-logloss:0.71125	val-auc:0.62553	val-aucpr:0.10658
[10]	train-logloss:0.68857	train-auc:0.68176	train-aucpr:0.28684	val-logloss:0.65284	val-auc:0.69455	val-aucpr:0.20588
[20]	train-logloss:0.67311	train-auc:0.68846	train-aucpr:0.29589	val-logloss:0.61160	val-auc:0.70292	val-aucpr:0.22083
[30]	train-logloss:0.66252	train-auc:0.69237	train-aucpr:0.30238	val-logloss:0.57688	val-auc:0.70270	val-aucpr:0.22088
[40]	train-logloss:0.65505	train-auc:0.69737	train-aucpr:0.30734	val-logloss:0.56399	val-auc:0.71052	val-aucpr:0.22405
[50]	train-logloss:0.64845	train-auc:0.70234	train-aucpr:0.31205	val-logloss:0.56727	val-auc:0.71015	val-aucpr:0.22967
[60]	train-logloss:0.64402	train-auc:0.70577	train-aucpr:0.31545	val-logloss:0.55956	val-auc:0.70659	val-aucpr:0.22988
[70]	train-logloss:0.64003	train-auc:0.70870	train-aucpr:0.31895	val-logloss:0.54570	val-auc:0.70642	val-aucpr:0.22447
[80]	train-logloss:0.63664	train-auc:0.71270	train-aucpr:0.32245	val-logloss:0.52199	val-auc:0.70639	val-aucpr:0.22511
[86]	train-logloss:0.63475	train-auc:0.71466	train-aucpr:0.32485	val-logloss:0.51323	val-auc:0.70344	val-aucpr:0.22082
[2025-11-19 09:22:35,895] [INFO] [<frozen importlib] - Training completed at iteration 57
[2025-11-19 09:22:35,895] [INFO] [<frozen importlib] - Best train loss: 0.6454
[2025-11-19 09:22:35,895] [INFO] [<frozen importlib] - Best val loss: 0.5614
[2025-11-19 09:22:35,895] [INFO] [<frozen importlib] - Best val AUC: 0.7069
[2025-11-19 09:22:35,895] [INFO] [<frozen importlib] - Best val AUCPR: 0.2304
[2025-11-19 09:22:35,900] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:22:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:22:49,014] [INFO] [<frozen importlib] - Optimal threshold: 0.5113
[2025-11-19 09:22:49,014] [INFO] [<frozen importlib] - Best f1: 0.2683
[2025-11-19 09:22:49,014] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:22:49,057] [INFO] [<frozen importlib] - Validation Results (threshold=0.5113):
[2025-11-19 09:22:49,057] [INFO] [<frozen importlib] -   Accuracy: 0.8895
[2025-11-19 09:22:49,057] [INFO] [<frozen importlib] -   Precision: 0.2730
[2025-11-19 09:22:49,057] [INFO] [<frozen importlib] -   Recall: 0.2638
[2025-11-19 09:22:49,057] [INFO] [<frozen importlib] -   F1 Score: 0.2683
[2025-11-19 09:22:49,057] [INFO] [<frozen importlib] -   AUROC: 0.7069
[2025-11-19 09:22:49,057] [INFO] [<frozen importlib] -   AUPRC: 0.2308
[2025-11-19 09:22:49,057] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:22:49,057] [INFO] [<frozen importlib] -     TN=16425, FP=1020
[2025-11-19 09:22:49,057] [INFO] [<frozen importlib] -     FN=1069, TP=383
[2025-11-19 09:22:49,083] [INFO] [<frozen importlib] - Trial 360: AUPRC=0.2308, F1=0.4394, Prec=0.4056, Rec=0.4793 | Optimizing auprc=0.2308
                                                                                          Best trial: 289. Best value: 0.241792:  72%|███████▏  | 360/500 [1:00:47<26:27, 11.34s/it]Best trial: 289. Best value: 0.241792:  72%|███████▏  | 360/500 [1:00:47<26:27, 11.34s/it]Best trial: 289. Best value: 0.241792:  72%|███████▏  | 361/500 [1:00:47<27:47, 11.99s/it][2025-11-19 09:22:49,096] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.569489644202367
[2025-11-19 09:22:49,096] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:22:49,096] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:22:49,096] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:22:49,096] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:22:49,096] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:22:49,096] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   gamma: 0.20741869008229652
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   alpha: 0.563101807379446
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   lambda: 0.9435438411247438
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   learning_rate: 0.03443069058042847
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   subsample: 0.85665113563588
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   colsample_bytree: 0.6036407029340396
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5004441227428822
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   colsample_bynode: 0.7902693483523292
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:22:49,097] [INFO] [<frozen importlib] -   scale_pos_weight: 5.569489644202367
[2025-11-19 09:22:49,172] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:22:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:22:49,084] Trial 360 finished with value: 0.23075253880547641 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.2885651530754717, 'learning_rate': 0.03643440620320646, 'n_estimators': 400, 'alpha': 0.3780887244120007, 'lambda': 1.0735391188557093, 'subsample': 0.8010297602323244, 'colsample_bytree': 0.580284186125645, 'colsample_bylevel': 0.5084035271387523, 'colsample_bynode': 0.6746734872905183, 'scale_pos_weight': 7.261825326461462}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.61982	train-auc:0.64301	train-aucpr:0.25493	val-logloss:0.60772	val-auc:0.58653	val-aucpr:0.11464
[10]	train-logloss:0.60018	train-auc:0.68103	train-aucpr:0.29174	val-logloss:0.55825	val-auc:0.68001	val-aucpr:0.18756
[20]	train-logloss:0.58749	train-auc:0.68543	train-aucpr:0.29816	val-logloss:0.52619	val-auc:0.67744	val-aucpr:0.19934
[30]	train-logloss:0.57854	train-auc:0.69002	train-aucpr:0.30398	val-logloss:0.50027	val-auc:0.69039	val-aucpr:0.21150
[40]	train-logloss:0.57193	train-auc:0.69453	train-aucpr:0.30901	val-logloss:0.47494	val-auc:0.70102	val-aucpr:0.21824
[50]	train-logloss:0.56666	train-auc:0.69782	train-aucpr:0.31276	val-logloss:0.45731	val-auc:0.69578	val-aucpr:0.22094
[60]	train-logloss:0.56293	train-auc:0.70154	train-aucpr:0.31595	val-logloss:0.44686	val-auc:0.69928	val-aucpr:0.22365
[70]	train-logloss:0.55975	train-auc:0.70495	train-aucpr:0.31998	val-logloss:0.44713	val-auc:0.70851	val-aucpr:0.22544
[80]	train-logloss:0.55686	train-auc:0.70899	train-aucpr:0.32441	val-logloss:0.44739	val-auc:0.70219	val-aucpr:0.21147
[90]	train-logloss:0.55442	train-auc:0.71305	train-aucpr:0.32810	val-logloss:0.44361	val-auc:0.70679	val-aucpr:0.21562
[100]	train-logloss:0.55221	train-auc:0.71623	train-aucpr:0.33119	val-logloss:0.44509	val-auc:0.70352	val-aucpr:0.20960
[2025-11-19 09:22:49,457] [INFO] [<frozen importlib] - Training completed at iteration 70
[2025-11-19 09:22:49,457] [INFO] [<frozen importlib] - Best train loss: 0.5597
[2025-11-19 09:22:49,457] [INFO] [<frozen importlib] - Best val loss: 0.4471
[2025-11-19 09:22:49,457] [INFO] [<frozen importlib] - Best val AUC: 0.7085
[2025-11-19 09:22:49,457] [INFO] [<frozen importlib] - Best val AUCPR: 0.2254
[2025-11-19 09:22:49,462] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:22:49] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:23:02,741] [INFO] [<frozen importlib] - Optimal threshold: 0.4245
[2025-11-19 09:23:02,741] [INFO] [<frozen importlib] - Best f1: 0.2804
[2025-11-19 09:23:02,741] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:23:02,785] [INFO] [<frozen importlib] - Validation Results (threshold=0.4245):
[2025-11-19 09:23:02,785] [INFO] [<frozen importlib] -   Accuracy: 0.8973
[2025-11-19 09:23:02,785] [INFO] [<frozen importlib] -   Precision: 0.3039
[2025-11-19 09:23:02,785] [INFO] [<frozen importlib] -   Recall: 0.2603
[2025-11-19 09:23:02,785] [INFO] [<frozen importlib] -   F1 Score: 0.2804
[2025-11-19 09:23:02,785] [INFO] [<frozen importlib] -   AUROC: 0.7085
[2025-11-19 09:23:02,785] [INFO] [<frozen importlib] -   AUPRC: 0.2260
[2025-11-19 09:23:02,785] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:23:02,785] [INFO] [<frozen importlib] -     TN=16579, FP=866
[2025-11-19 09:23:02,785] [INFO] [<frozen importlib] -     FN=1074, TP=378
[2025-11-19 09:23:02,808] [INFO] [<frozen importlib] - Trial 361: AUPRC=0.2260, F1=0.4552, Prec=0.4409, Rec=0.4704 | Optimizing auprc=0.2260
                                                                                          Best trial: 289. Best value: 0.241792:  72%|███████▏  | 361/500 [1:01:00<27:47, 11.99s/it]Best trial: 289. Best value: 0.241792:  72%|███████▏  | 361/500 [1:01:00<27:47, 11.99s/it]Best trial: 289. Best value: 0.241792:  72%|███████▏  | 362/500 [1:01:00<28:46, 12.51s/it][2025-11-19 09:23:02,821] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.563343722892258
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   gamma: 0.4013656421724011
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   alpha: 0.4700665748692348
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   lambda: 1.1585444053325165
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   learning_rate: 0.03891973503685137
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   subsample: 0.8337451638207353
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   colsample_bytree: 0.5918101075515292
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5365125812121279
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   colsample_bynode: 0.7395722954419441
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:23:02,821] [INFO] [<frozen importlib] -   scale_pos_weight: 6.563343722892258
[2025-11-19 09:23:02,892] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:23:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:23:02,809] Trial 361 finished with value: 0.22596604709952386 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.20741869008229652, 'learning_rate': 0.03443069058042847, 'n_estimators': 200, 'alpha': 0.563101807379446, 'lambda': 0.9435438411247438, 'subsample': 0.85665113563588, 'colsample_bytree': 0.6036407029340396, 'colsample_bylevel': 0.5004441227428822, 'colsample_bynode': 0.7902693483523292, 'scale_pos_weight': 5.569489644202367}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.67563	train-auc:0.62803	train-aucpr:0.22212	val-logloss:0.67140	val-auc:0.60862	val-aucpr:0.10223
[10]	train-logloss:0.65092	train-auc:0.68291	train-aucpr:0.29009	val-logloss:0.61808	val-auc:0.68312	val-aucpr:0.19801
[20]	train-logloss:0.63587	train-auc:0.68978	train-aucpr:0.30028	val-logloss:0.57610	val-auc:0.71797	val-aucpr:0.22354
[30]	train-logloss:0.62561	train-auc:0.69366	train-aucpr:0.30565	val-logloss:0.53866	val-auc:0.71566	val-aucpr:0.22077
[40]	train-logloss:0.61839	train-auc:0.69864	train-aucpr:0.31033	val-logloss:0.52935	val-auc:0.71155	val-aucpr:0.22285
[50]	train-logloss:0.61263	train-auc:0.70265	train-aucpr:0.31518	val-logloss:0.50458	val-auc:0.71209	val-aucpr:0.22593
[60]	train-logloss:0.60888	train-auc:0.70539	train-aucpr:0.31928	val-logloss:0.49835	val-auc:0.70407	val-aucpr:0.22321
[70]	train-logloss:0.60542	train-auc:0.70853	train-aucpr:0.32245	val-logloss:0.49244	val-auc:0.70354	val-aucpr:0.22803
[80]	train-logloss:0.60240	train-auc:0.71257	train-aucpr:0.32638	val-logloss:0.49003	val-auc:0.70100	val-aucpr:0.21932
[90]	train-logloss:0.59950	train-auc:0.71714	train-aucpr:0.33070	val-logloss:0.48162	val-auc:0.69787	val-aucpr:0.21120
[98]	train-logloss:0.59759	train-auc:0.72058	train-aucpr:0.33396	val-logloss:0.46746	val-auc:0.69859	val-aucpr:0.21244
[2025-11-19 09:23:03,173] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:23:03,173] [INFO] [<frozen importlib] - Best train loss: 0.6061
[2025-11-19 09:23:03,173] [INFO] [<frozen importlib] - Best val loss: 0.4952
[2025-11-19 09:23:03,173] [INFO] [<frozen importlib] - Best val AUC: 0.7040
[2025-11-19 09:23:03,174] [INFO] [<frozen importlib] - Best val AUCPR: 0.2283
[2025-11-19 09:23:03,179] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:23:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:23:15,788] [INFO] [<frozen importlib] - Optimal threshold: 0.4749
[2025-11-19 09:23:15,788] [INFO] [<frozen importlib] - Best f1: 0.2723
[2025-11-19 09:23:15,788] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:23:15,843] [INFO] [<frozen importlib] - Validation Results (threshold=0.4749):
[2025-11-19 09:23:15,843] [INFO] [<frozen importlib] -   Accuracy: 0.8940
[2025-11-19 09:23:15,843] [INFO] [<frozen importlib] -   Precision: 0.2880
[2025-11-19 09:23:15,843] [INFO] [<frozen importlib] -   Recall: 0.2583
[2025-11-19 09:23:15,843] [INFO] [<frozen importlib] -   F1 Score: 0.2723
[2025-11-19 09:23:15,843] [INFO] [<frozen importlib] -   AUROC: 0.7040
[2025-11-19 09:23:15,843] [INFO] [<frozen importlib] -   AUPRC: 0.2287
[2025-11-19 09:23:15,843] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:23:15,844] [INFO] [<frozen importlib] -     TN=16518, FP=927
[2025-11-19 09:23:15,844] [INFO] [<frozen importlib] -     FN=1077, TP=375
[2025-11-19 09:23:15,870] [INFO] [<frozen importlib] - Trial 362: AUPRC=0.2287, F1=0.4471, Prec=0.4249, Rec=0.4718 | Optimizing auprc=0.2287
[2025-11-19 09:23:15,870] [INFO] [<frozen importlib] - Trial 362 pruned.
[2025-11-19 09:23:15,870] [ERROR] [<frozen importlib] - Trial 362 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  72%|███████▏  | 362/500 [1:01:13<28:46, 12.51s/it]Best trial: 289. Best value: 0.241792:  72%|███████▏  | 362/500 [1:01:13<28:46, 12.51s/it]Best trial: 289. Best value: 0.241792:  73%|███████▎  | 363/500 [1:01:13<28:56, 12.68s/it][2025-11-19 09:23:15,890] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.984627892214958
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   gamma: 0.24921287842376108
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   alpha: 0.6428302216752613
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   lambda: 1.5106263781680418
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   learning_rate: 0.04389520165370221
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   subsample: 0.816558929995454
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   colsample_bytree: 0.6164209816192002
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5516067420247136
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   colsample_bynode: 0.7589234480958555
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:23:15,890] [INFO] [<frozen importlib] -   scale_pos_weight: 6.984627892214958
[2025-11-19 09:23:15,972] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:23:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:23:15,871] Trial 362 pruned. 
[0]	train-logloss:0.69753	train-auc:0.65009	train-aucpr:0.23193	val-logloss:0.69332	val-auc:0.61431	val-aucpr:0.10785
[10]	train-logloss:0.66937	train-auc:0.68239	train-aucpr:0.29247	val-logloss:0.62646	val-auc:0.67299	val-aucpr:0.17273
[20]	train-logloss:0.65307	train-auc:0.69141	train-aucpr:0.30156	val-logloss:0.58450	val-auc:0.69143	val-aucpr:0.20586
[30]	train-logloss:0.64287	train-auc:0.69570	train-aucpr:0.30562	val-logloss:0.55688	val-auc:0.68761	val-aucpr:0.21357
[40]	train-logloss:0.63536	train-auc:0.70065	train-aucpr:0.31208	val-logloss:0.54876	val-auc:0.70040	val-aucpr:0.21443
[50]	train-logloss:0.62979	train-auc:0.70375	train-aucpr:0.31616	val-logloss:0.53614	val-auc:0.70476	val-aucpr:0.21445
[60]	train-logloss:0.62568	train-auc:0.70721	train-aucpr:0.32083	val-logloss:0.52503	val-auc:0.70258	val-aucpr:0.21565
[66]	train-logloss:0.62344	train-auc:0.71010	train-aucpr:0.32354	val-logloss:0.52523	val-auc:0.69905	val-aucpr:0.21186
[2025-11-19 09:23:16,192] [INFO] [<frozen importlib] - Training completed at iteration 36
[2025-11-19 09:23:16,192] [INFO] [<frozen importlib] - Best train loss: 0.6382
[2025-11-19 09:23:16,192] [INFO] [<frozen importlib] - Best val loss: 0.5442
[2025-11-19 09:23:16,192] [INFO] [<frozen importlib] - Best val AUC: 0.6975
[2025-11-19 09:23:16,192] [INFO] [<frozen importlib] - Best val AUCPR: 0.2179
[2025-11-19 09:23:16,198] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:23:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:23:23,015] [INFO] [<frozen importlib] - Optimal threshold: 0.4927
[2025-11-19 09:23:23,015] [INFO] [<frozen importlib] - Best f1: 0.2685
[2025-11-19 09:23:23,015] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:23:23,060] [INFO] [<frozen importlib] - Validation Results (threshold=0.4927):
[2025-11-19 09:23:23,060] [INFO] [<frozen importlib] -   Accuracy: 0.8835
[2025-11-19 09:23:23,060] [INFO] [<frozen importlib] -   Precision: 0.2595
[2025-11-19 09:23:23,061] [INFO] [<frozen importlib] -   Recall: 0.2782
[2025-11-19 09:23:23,061] [INFO] [<frozen importlib] -   F1 Score: 0.2685
[2025-11-19 09:23:23,061] [INFO] [<frozen importlib] -   AUROC: 0.6975
[2025-11-19 09:23:23,061] [INFO] [<frozen importlib] -   AUPRC: 0.2181
[2025-11-19 09:23:23,061] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:23:23,061] [INFO] [<frozen importlib] -     TN=16292, FP=1153
[2025-11-19 09:23:23,061] [INFO] [<frozen importlib] -     FN=1048, TP=404
[2025-11-19 09:23:23,086] [INFO] [<frozen importlib] - Trial 363: AUPRC=0.2181, F1=0.4485, Prec=0.3951, Rec=0.5186 | Optimizing auprc=0.2181
                                                                                          Best trial: 289. Best value: 0.241792:  73%|███████▎  | 363/500 [1:01:21<28:56, 12.68s/it]Best trial: 289. Best value: 0.241792:  73%|███████▎  | 363/500 [1:01:21<28:56, 12.68s/it]Best trial: 289. Best value: 0.241792:  73%|███████▎  | 364/500 [1:01:21<25:01, 11.04s/it][2025-11-19 09:23:23,101] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.0192498139460575
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   gamma: 0.21595850544511053
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   alpha: 0.5239603377236131
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   lambda: 0.7675660660723128
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   learning_rate: 0.0959790198534305
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   subsample: 0.8452505610098843
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   colsample_bytree: 0.5711974768004847
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   colsample_bylevel: 0.8783680582762456
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   colsample_bynode: 0.777259703419082
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:23:23,101] [INFO] [<frozen importlib] -   scale_pos_weight: 5.0192498139460575
[2025-11-19 09:23:23,172] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:23:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:23:23,086] Trial 363 finished with value: 0.21813792510849805 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.24921287842376108, 'learning_rate': 0.04389520165370221, 'n_estimators': 350, 'alpha': 0.6428302216752613, 'lambda': 1.5106263781680418, 'subsample': 0.816558929995454, 'colsample_bytree': 0.6164209816192002, 'colsample_bylevel': 0.5516067420247136, 'colsample_bynode': 0.7589234480958555, 'scale_pos_weight': 6.984627892214958}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.58437	train-auc:0.64377	train-aucpr:0.23953	val-logloss:0.55910	val-auc:0.63297	val-aucpr:0.15128
[10]	train-logloss:0.54797	train-auc:0.69210	train-aucpr:0.30273	val-logloss:0.47143	val-auc:0.70020	val-aucpr:0.22117
[20]	train-logloss:0.53370	train-auc:0.70355	train-aucpr:0.31750	val-logloss:0.45523	val-auc:0.70061	val-aucpr:0.21559
[30]	train-logloss:0.52578	train-auc:0.71189	train-aucpr:0.32808	val-logloss:0.44535	val-auc:0.70196	val-aucpr:0.20202
[40]	train-logloss:0.52087	train-auc:0.72157	train-aucpr:0.33629	val-logloss:0.42932	val-auc:0.69892	val-aucpr:0.20014
[41]	train-logloss:0.52021	train-auc:0.72268	train-aucpr:0.33729	val-logloss:0.41033	val-auc:0.69681	val-aucpr:0.18954
[2025-11-19 09:23:23,310] [INFO] [<frozen importlib] - Training completed at iteration 11
[2025-11-19 09:23:23,310] [INFO] [<frozen importlib] - Best train loss: 0.5458
[2025-11-19 09:23:23,310] [INFO] [<frozen importlib] - Best val loss: 0.4677
[2025-11-19 09:23:23,310] [INFO] [<frozen importlib] - Best val AUC: 0.7064
[2025-11-19 09:23:23,310] [INFO] [<frozen importlib] - Best val AUCPR: 0.2255
[2025-11-19 09:23:23,315] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:23:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:23:24,982] [INFO] [<frozen importlib] - Optimal threshold: 0.4069
[2025-11-19 09:23:24,982] [INFO] [<frozen importlib] - Best f1: 0.2752
[2025-11-19 09:23:24,982] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:23:25,026] [INFO] [<frozen importlib] - Validation Results (threshold=0.4069):
[2025-11-19 09:23:25,026] [INFO] [<frozen importlib] -   Accuracy: 0.8760
[2025-11-19 09:23:25,026] [INFO] [<frozen importlib] -   Precision: 0.2497
[2025-11-19 09:23:25,026] [INFO] [<frozen importlib] -   Recall: 0.3065
[2025-11-19 09:23:25,026] [INFO] [<frozen importlib] -   F1 Score: 0.2752
[2025-11-19 09:23:25,026] [INFO] [<frozen importlib] -   AUROC: 0.7064
[2025-11-19 09:23:25,026] [INFO] [<frozen importlib] -   AUPRC: 0.2250
[2025-11-19 09:23:25,026] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:23:25,026] [INFO] [<frozen importlib] -     TN=16108, FP=1337
[2025-11-19 09:23:25,026] [INFO] [<frozen importlib] -     FN=1007, TP=445
[2025-11-19 09:23:25,050] [INFO] [<frozen importlib] - Trial 364: AUPRC=0.2250, F1=0.4185, Prec=0.3557, Rec=0.5083 | Optimizing auprc=0.2250
                                                                                          Best trial: 289. Best value: 0.241792:  73%|███████▎  | 364/500 [1:01:23<25:01, 11.04s/it]Best trial: 289. Best value: 0.241792:  73%|███████▎  | 364/500 [1:01:23<25:01, 11.04s/it]Best trial: 289. Best value: 0.241792:  73%|███████▎  | 365/500 [1:01:23<18:42,  8.32s/it][2025-11-19 09:23:25,064] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.9687477963587305
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   gamma: 0.3535926256398933
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   alpha: 0.5823608460322524
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   lambda: 0.9083916944832177
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   learning_rate: 0.04077699775031881
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   subsample: 0.7858825513115806
[2025-11-19 09:23:25,064] [INFO] [<frozen importlib] -   colsample_bytree: 0.5973154679879888
[2025-11-19 09:23:25,065] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5265169368206359
[2025-11-19 09:23:25,065] [INFO] [<frozen importlib] -   colsample_bynode: 0.8166083206379683
[2025-11-19 09:23:25,065] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:23:25,065] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:23:25,065] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:23:25,065] [INFO] [<frozen importlib] -   scale_pos_weight: 5.9687477963587305
[2025-11-19 09:23:25,141] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:23:25] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:23:25,050] Trial 364 finished with value: 0.2249637387884448 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.21595850544511053, 'learning_rate': 0.0959790198534305, 'n_estimators': 300, 'alpha': 0.5239603377236131, 'lambda': 0.7675660660723128, 'subsample': 0.8452505610098843, 'colsample_bytree': 0.5711974768004847, 'colsample_bylevel': 0.8783680582762456, 'colsample_bynode': 0.777259703419082, 'scale_pos_weight': 5.0192498139460575}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.64216	train-auc:0.63961	train-aucpr:0.22324	val-logloss:0.62983	val-auc:0.54401	val-aucpr:0.10255
[10]	train-logloss:0.61852	train-auc:0.68340	train-aucpr:0.28908	val-logloss:0.58242	val-auc:0.67946	val-aucpr:0.17712
[20]	train-logloss:0.60403	train-auc:0.68819	train-aucpr:0.29912	val-logloss:0.54416	val-auc:0.70127	val-aucpr:0.21457
[30]	train-logloss:0.59431	train-auc:0.69376	train-aucpr:0.30519	val-logloss:0.50879	val-auc:0.70482	val-aucpr:0.22110
[40]	train-logloss:0.58797	train-auc:0.69718	train-aucpr:0.30967	val-logloss:0.49254	val-auc:0.71365	val-aucpr:0.22750
[50]	train-logloss:0.58286	train-auc:0.70138	train-aucpr:0.31379	val-logloss:0.47542	val-auc:0.71077	val-aucpr:0.23088
[60]	train-logloss:0.57900	train-auc:0.70561	train-aucpr:0.31821	val-logloss:0.45973	val-auc:0.70948	val-aucpr:0.22655
[70]	train-logloss:0.57594	train-auc:0.70982	train-aucpr:0.32265	val-logloss:0.45532	val-auc:0.70597	val-aucpr:0.22308
[80]	train-logloss:0.57301	train-auc:0.71430	train-aucpr:0.32719	val-logloss:0.43986	val-auc:0.70072	val-aucpr:0.21793
[2025-11-19 09:23:25,376] [INFO] [<frozen importlib] - Training completed at iteration 50
[2025-11-19 09:23:25,376] [INFO] [<frozen importlib] - Best train loss: 0.5829
[2025-11-19 09:23:25,376] [INFO] [<frozen importlib] - Best val loss: 0.4754
[2025-11-19 09:23:25,376] [INFO] [<frozen importlib] - Best val AUC: 0.7108
[2025-11-19 09:23:25,376] [INFO] [<frozen importlib] - Best val AUCPR: 0.2309
[2025-11-19 09:23:25,381] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:23:25] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:23:37,023] [INFO] [<frozen importlib] - Optimal threshold: 0.4545
[2025-11-19 09:23:37,023] [INFO] [<frozen importlib] - Best f1: 0.2873
[2025-11-19 09:23:37,023] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:23:37,065] [INFO] [<frozen importlib] - Validation Results (threshold=0.4545):
[2025-11-19 09:23:37,065] [INFO] [<frozen importlib] -   Accuracy: 0.9050
[2025-11-19 09:23:37,065] [INFO] [<frozen importlib] -   Precision: 0.3390
[2025-11-19 09:23:37,065] [INFO] [<frozen importlib] -   Recall: 0.2493
[2025-11-19 09:23:37,065] [INFO] [<frozen importlib] -   F1 Score: 0.2873
[2025-11-19 09:23:37,065] [INFO] [<frozen importlib] -   AUROC: 0.7108
[2025-11-19 09:23:37,065] [INFO] [<frozen importlib] -   AUPRC: 0.2313
[2025-11-19 09:23:37,065] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:23:37,065] [INFO] [<frozen importlib] -     TN=16739, FP=706
[2025-11-19 09:23:37,065] [INFO] [<frozen importlib] -     FN=1090, TP=362
[2025-11-19 09:23:37,089] [INFO] [<frozen importlib] - Trial 365: AUPRC=0.2313, F1=0.4706, Prec=0.4847, Rec=0.4573 | Optimizing auprc=0.2313
                                                                                          Best trial: 289. Best value: 0.241792:  73%|███████▎  | 365/500 [1:01:35<18:42,  8.32s/it]Best trial: 289. Best value: 0.241792:  73%|███████▎  | 365/500 [1:01:35<18:42,  8.32s/it]Best trial: 289. Best value: 0.241792:  73%|███████▎  | 366/500 [1:01:35<21:04,  9.43s/it][2025-11-19 09:23:37,103] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.350825596173795
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   gamma: 0.523702848991484
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   alpha: 0.4199103798252838
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   lambda: 1.3975186627824168
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   learning_rate: 0.03783236147200359
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   subsample: 0.8100528629741018
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   colsample_bytree: 0.9847211966323282
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5177340819797981
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   colsample_bynode: 0.798287393774458
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:23:37,103] [INFO] [<frozen importlib] -   scale_pos_weight: 6.350825596173795
[2025-11-19 09:23:37,180] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:23:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:23:37,090] Trial 365 finished with value: 0.23126621534767294 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.3535926256398933, 'learning_rate': 0.04077699775031881, 'n_estimators': 400, 'alpha': 0.5823608460322524, 'lambda': 0.9083916944832177, 'subsample': 0.7858825513115806, 'colsample_bytree': 0.5973154679879888, 'colsample_bylevel': 0.5265169368206359, 'colsample_bynode': 0.8166083206379683, 'scale_pos_weight': 5.9687477963587305}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.66314	train-auc:0.64920	train-aucpr:0.23722	val-logloss:0.65287	val-auc:0.65407	val-aucpr:0.13653
[10]	train-logloss:0.63955	train-auc:0.68139	train-aucpr:0.28552	val-logloss:0.59295	val-auc:0.66451	val-aucpr:0.18609
[20]	train-logloss:0.62510	train-auc:0.68589	train-aucpr:0.29568	val-logloss:0.55987	val-auc:0.67761	val-aucpr:0.19401
[30]	train-logloss:0.61511	train-auc:0.69380	train-aucpr:0.30357	val-logloss:0.52606	val-auc:0.68485	val-aucpr:0.20877
[40]	train-logloss:0.60830	train-auc:0.69823	train-aucpr:0.30831	val-logloss:0.50952	val-auc:0.68762	val-aucpr:0.21393
[50]	train-logloss:0.60250	train-auc:0.70260	train-aucpr:0.31321	val-logloss:0.49627	val-auc:0.69656	val-aucpr:0.21411
[60]	train-logloss:0.59834	train-auc:0.70537	train-aucpr:0.31756	val-logloss:0.49044	val-auc:0.69575	val-aucpr:0.21511
[70]	train-logloss:0.59472	train-auc:0.70949	train-aucpr:0.32213	val-logloss:0.47152	val-auc:0.68757	val-aucpr:0.20917
[74]	train-logloss:0.59398	train-auc:0.71054	train-aucpr:0.32319	val-logloss:0.46875	val-auc:0.68838	val-aucpr:0.21087
[2025-11-19 09:23:37,410] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 09:23:37,410] [INFO] [<frozen importlib] - Best train loss: 0.6052
[2025-11-19 09:23:37,410] [INFO] [<frozen importlib] - Best val loss: 0.5026
[2025-11-19 09:23:37,410] [INFO] [<frozen importlib] - Best val AUC: 0.6940
[2025-11-19 09:23:37,410] [INFO] [<frozen importlib] - Best val AUCPR: 0.2175
[2025-11-19 09:23:37,415] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:23:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:23:45,140] [INFO] [<frozen importlib] - Optimal threshold: 0.4737
[2025-11-19 09:23:45,140] [INFO] [<frozen importlib] - Best f1: 0.2682
[2025-11-19 09:23:45,140] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:23:45,183] [INFO] [<frozen importlib] - Validation Results (threshold=0.4737):
[2025-11-19 09:23:45,183] [INFO] [<frozen importlib] -   Accuracy: 0.9029
[2025-11-19 09:23:45,183] [INFO] [<frozen importlib] -   Precision: 0.3188
[2025-11-19 09:23:45,183] [INFO] [<frozen importlib] -   Recall: 0.2314
[2025-11-19 09:23:45,183] [INFO] [<frozen importlib] -   F1 Score: 0.2682
[2025-11-19 09:23:45,183] [INFO] [<frozen importlib] -   AUROC: 0.6940
[2025-11-19 09:23:45,183] [INFO] [<frozen importlib] -   AUPRC: 0.2179
[2025-11-19 09:23:45,183] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:23:45,183] [INFO] [<frozen importlib] -     TN=16727, FP=718
[2025-11-19 09:23:45,183] [INFO] [<frozen importlib] -     FN=1116, TP=336
[2025-11-19 09:23:45,206] [INFO] [<frozen importlib] - Trial 366: AUPRC=0.2179, F1=0.4394, Prec=0.4597, Rec=0.4208 | Optimizing auprc=0.2179
[2025-11-19 09:23:45,206] [INFO] [<frozen importlib] - Trial 366 pruned.
[2025-11-19 09:23:45,206] [ERROR] [<frozen importlib] - Trial 366 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  73%|███████▎  | 366/500 [1:01:43<21:04,  9.43s/it]Best trial: 289. Best value: 0.241792:  73%|███████▎  | 366/500 [1:01:43<21:04,  9.43s/it]Best trial: 289. Best value: 0.241792:  73%|███████▎  | 367/500 [1:01:43<20:02,  9.04s/it][2025-11-19 09:23:45,219] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.466062608725791
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   min_child_weight: 10
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   gamma: 0.3215686611752407
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   alpha: 0.6138284231189542
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   lambda: 1.2110770210308077
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   learning_rate: 0.035866330545866645
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   subsample: 0.824254580553648
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   colsample_bytree: 0.584368066927033
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5088594611100916
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   colsample_bynode: 0.7680379648420903
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:23:45,219] [INFO] [<frozen importlib] -   scale_pos_weight: 5.466062608725791
[2025-11-19 09:23:45,295] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:23:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:23:45,206] Trial 366 pruned. 
[0]	train-logloss:0.61418	train-auc:0.62982	train-aucpr:0.22709	val-logloss:0.60059	val-auc:0.59558	val-aucpr:0.11358
[10]	train-logloss:0.59401	train-auc:0.68029	train-aucpr:0.29035	val-logloss:0.55800	val-auc:0.70385	val-aucpr:0.21198
[20]	train-logloss:0.58124	train-auc:0.68640	train-aucpr:0.29849	val-logloss:0.52715	val-auc:0.69803	val-aucpr:0.21608
[30]	train-logloss:0.57222	train-auc:0.69150	train-aucpr:0.30423	val-logloss:0.50644	val-auc:0.69771	val-aucpr:0.22035
[40]	train-logloss:0.56605	train-auc:0.69653	train-aucpr:0.30716	val-logloss:0.48989	val-auc:0.69774	val-aucpr:0.22168
[50]	train-logloss:0.56047	train-auc:0.70092	train-aucpr:0.31236	val-logloss:0.47901	val-auc:0.69840	val-aucpr:0.22326
[60]	train-logloss:0.55690	train-auc:0.70409	train-aucpr:0.31577	val-logloss:0.47352	val-auc:0.69651	val-aucpr:0.22653
[70]	train-logloss:0.55357	train-auc:0.70755	train-aucpr:0.31974	val-logloss:0.46422	val-auc:0.70182	val-aucpr:0.22484
[80]	train-logloss:0.55087	train-auc:0.71069	train-aucpr:0.32339	val-logloss:0.46012	val-auc:0.69812	val-aucpr:0.21899
[90]	train-logloss:0.54848	train-auc:0.71407	train-aucpr:0.32748	val-logloss:0.45329	val-auc:0.69661	val-aucpr:0.21498
[91]	train-logloss:0.54832	train-auc:0.71428	train-aucpr:0.32771	val-logloss:0.45276	val-auc:0.69659	val-aucpr:0.21508
[2025-11-19 09:23:45,557] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:23:45,557] [INFO] [<frozen importlib] - Best train loss: 0.5563
[2025-11-19 09:23:45,557] [INFO] [<frozen importlib] - Best val loss: 0.4702
[2025-11-19 09:23:45,557] [INFO] [<frozen importlib] - Best val AUC: 0.6997
[2025-11-19 09:23:45,557] [INFO] [<frozen importlib] - Best val AUCPR: 0.2270
[2025-11-19 09:23:45,561] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:23:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:23:57,631] [INFO] [<frozen importlib] - Optimal threshold: 0.4591
[2025-11-19 09:23:57,631] [INFO] [<frozen importlib] - Best f1: 0.2710
[2025-11-19 09:23:57,631] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:23:57,683] [INFO] [<frozen importlib] - Validation Results (threshold=0.4591):
[2025-11-19 09:23:57,683] [INFO] [<frozen importlib] -   Accuracy: 0.9072
[2025-11-19 09:23:57,683] [INFO] [<frozen importlib] -   Precision: 0.3417
[2025-11-19 09:23:57,683] [INFO] [<frozen importlib] -   Recall: 0.2245
[2025-11-19 09:23:57,683] [INFO] [<frozen importlib] -   F1 Score: 0.2710
[2025-11-19 09:23:57,683] [INFO] [<frozen importlib] -   AUROC: 0.6997
[2025-11-19 09:23:57,683] [INFO] [<frozen importlib] -   AUPRC: 0.2274
[2025-11-19 09:23:57,683] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:23:57,683] [INFO] [<frozen importlib] -     TN=16817, FP=628
[2025-11-19 09:23:57,683] [INFO] [<frozen importlib] -     FN=1126, TP=326
[2025-11-19 09:23:57,707] [INFO] [<frozen importlib] - Trial 367: AUPRC=0.2274, F1=0.4762, Prec=0.5086, Rec=0.4477 | Optimizing auprc=0.2274
[2025-11-19 09:23:57,708] [INFO] [<frozen importlib] - Trial 367 pruned.
[2025-11-19 09:23:57,708] [ERROR] [<frozen importlib] - Trial 367 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  73%|███████▎  | 367/500 [1:01:55<20:02,  9.04s/it]Best trial: 289. Best value: 0.241792:  73%|███████▎  | 367/500 [1:01:55<20:02,  9.04s/it]Best trial: 289. Best value: 0.241792:  74%|███████▎  | 368/500 [1:01:55<22:10, 10.08s/it][2025-11-19 09:23:57,722] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.678236549413456
[2025-11-19 09:23:57,722] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:23:57,722] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:23:57,722] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:23:57,722] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:23:57,722] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:23:57,722] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   gamma: 0.09996309321794986
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   alpha: 1.3591574769122339
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   lambda: 1.067285984278819
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   learning_rate: 0.19793177566058806
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   subsample: 0.8688532435189009
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   colsample_bytree: 0.771907256051945
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5393533963904055
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   colsample_bynode: 0.7875879278883635
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:23:57,723] [INFO] [<frozen importlib] -   scale_pos_weight: 6.678236549413456
[2025-11-19 09:23:57,796] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:23:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:23:57,708] Trial 367 pruned. 
[0]	train-logloss:0.66902	train-auc:0.64668	train-aucpr:0.25029	val-logloss:0.64749	val-auc:0.59130	val-aucpr:0.11571
[10]	train-logloss:0.61615	train-auc:0.69744	train-aucpr:0.31031	val-logloss:0.49710	val-auc:0.68209	val-aucpr:0.17969
[20]	train-logloss:0.60119	train-auc:0.71841	train-aucpr:0.33344	val-logloss:0.49090	val-auc:0.66143	val-aucpr:0.14792
[30]	train-logloss:0.59112	train-auc:0.73625	train-aucpr:0.34988	val-logloss:0.49499	val-auc:0.65590	val-aucpr:0.14414
[37]	train-logloss:0.58439	train-auc:0.74762	train-aucpr:0.36344	val-logloss:0.48716	val-auc:0.63075	val-aucpr:0.11885
[2025-11-19 09:23:57,928] [INFO] [<frozen importlib] - Training completed at iteration 8
[2025-11-19 09:23:57,928] [INFO] [<frozen importlib] - Best train loss: 0.6212
[2025-11-19 09:23:57,928] [INFO] [<frozen importlib] - Best val loss: 0.4854
[2025-11-19 09:23:57,928] [INFO] [<frozen importlib] - Best val AUC: 0.6973
[2025-11-19 09:23:57,928] [INFO] [<frozen importlib] - Best val AUCPR: 0.2127
[2025-11-19 09:23:57,932] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:23:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:23:59,281] [INFO] [<frozen importlib] - Optimal threshold: 0.4663
[2025-11-19 09:23:59,281] [INFO] [<frozen importlib] - Best f1: 0.2629
[2025-11-19 09:23:59,281] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:23:59,326] [INFO] [<frozen importlib] - Validation Results (threshold=0.4663):
[2025-11-19 09:23:59,326] [INFO] [<frozen importlib] -   Accuracy: 0.8917
[2025-11-19 09:23:59,326] [INFO] [<frozen importlib] -   Precision: 0.2755
[2025-11-19 09:23:59,326] [INFO] [<frozen importlib] -   Recall: 0.2514
[2025-11-19 09:23:59,326] [INFO] [<frozen importlib] -   F1 Score: 0.2629
[2025-11-19 09:23:59,326] [INFO] [<frozen importlib] -   AUROC: 0.6973
[2025-11-19 09:23:59,326] [INFO] [<frozen importlib] -   AUPRC: 0.2077
[2025-11-19 09:23:59,326] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:23:59,326] [INFO] [<frozen importlib] -     TN=16485, FP=960
[2025-11-19 09:23:59,326] [INFO] [<frozen importlib] -     FN=1087, TP=365
[2025-11-19 09:23:59,351] [INFO] [<frozen importlib] - Trial 368: AUPRC=0.2077, F1=0.4388, Prec=0.4139, Rec=0.4669 | Optimizing auprc=0.2077
                                                                                          Best trial: 289. Best value: 0.241792:  74%|███████▎  | 368/500 [1:01:57<22:10, 10.08s/it]Best trial: 289. Best value: 0.241792:  74%|███████▎  | 368/500 [1:01:57<22:10, 10.08s/it]Best trial: 289. Best value: 0.241792:  74%|███████▍  | 369/500 [1:01:57<16:28,  7.55s/it][2025-11-19 09:23:59,365] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.296496953604232
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   gamma: 0.2755477497134561
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   alpha: 0.4800938193048765
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   lambda: 0.6652306801562938
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   learning_rate: 0.03428818772029579
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   subsample: 0.8012684920449467
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   colsample_bytree: 0.5170129979816902
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5979110094450696
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   colsample_bynode: 0.7537702963893554
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:23:59,365] [INFO] [<frozen importlib] -   scale_pos_weight: 7.296496953604232
[2025-11-19 09:23:59,439] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:23:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:23:59,351] Trial 368 finished with value: 0.2076618008981764 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.09996309321794986, 'learning_rate': 0.19793177566058806, 'n_estimators': 250, 'alpha': 1.3591574769122339, 'lambda': 1.067285984278819, 'subsample': 0.8688532435189009, 'colsample_bytree': 0.771907256051945, 'colsample_bylevel': 0.5393533963904055, 'colsample_bynode': 0.7875879278883635, 'scale_pos_weight': 6.678236549413456}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.71528	train-auc:0.63211	train-aucpr:0.22253	val-logloss:0.71496	val-auc:0.64571	val-aucpr:0.12259
[10]	train-logloss:0.69091	train-auc:0.68163	train-aucpr:0.29389	val-logloss:0.65122	val-auc:0.68674	val-aucpr:0.20527
[20]	train-logloss:0.67572	train-auc:0.68785	train-aucpr:0.30107	val-logloss:0.61284	val-auc:0.69480	val-aucpr:0.21312
[30]	train-logloss:0.66542	train-auc:0.69293	train-aucpr:0.30502	val-logloss:0.58482	val-auc:0.68590	val-aucpr:0.21320
[40]	train-logloss:0.65755	train-auc:0.69811	train-aucpr:0.30897	val-logloss:0.55678	val-auc:0.70055	val-aucpr:0.21817
[50]	train-logloss:0.65137	train-auc:0.70125	train-aucpr:0.31132	val-logloss:0.54258	val-auc:0.69857	val-aucpr:0.21554
[60]	train-logloss:0.64654	train-auc:0.70478	train-aucpr:0.31471	val-logloss:0.53599	val-auc:0.70029	val-aucpr:0.21957
[70]	train-logloss:0.64237	train-auc:0.70836	train-aucpr:0.31918	val-logloss:0.52280	val-auc:0.69838	val-aucpr:0.22109
[80]	train-logloss:0.63885	train-auc:0.71211	train-aucpr:0.32301	val-logloss:0.51875	val-auc:0.70053	val-aucpr:0.21964
[90]	train-logloss:0.63579	train-auc:0.71558	train-aucpr:0.32709	val-logloss:0.50697	val-auc:0.70128	val-aucpr:0.21223
[93]	train-logloss:0.63529	train-auc:0.71641	train-aucpr:0.32742	val-logloss:0.50311	val-auc:0.70055	val-aucpr:0.21199
[2025-11-19 09:23:59,705] [INFO] [<frozen importlib] - Training completed at iteration 64
[2025-11-19 09:23:59,705] [INFO] [<frozen importlib] - Best train loss: 0.6446
[2025-11-19 09:23:59,705] [INFO] [<frozen importlib] - Best val loss: 0.5300
[2025-11-19 09:23:59,705] [INFO] [<frozen importlib] - Best val AUC: 0.7085
[2025-11-19 09:23:59,705] [INFO] [<frozen importlib] - Best val AUCPR: 0.2251
[2025-11-19 09:23:59,710] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:23:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:24:12,431] [INFO] [<frozen importlib] - Optimal threshold: 0.5108
[2025-11-19 09:24:12,432] [INFO] [<frozen importlib] - Best f1: 0.2751
[2025-11-19 09:24:12,432] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:24:12,481] [INFO] [<frozen importlib] - Validation Results (threshold=0.5108):
[2025-11-19 09:24:12,481] [INFO] [<frozen importlib] -   Accuracy: 0.9052
[2025-11-19 09:24:12,481] [INFO] [<frozen importlib] -   Precision: 0.3333
[2025-11-19 09:24:12,481] [INFO] [<frozen importlib] -   Recall: 0.2342
[2025-11-19 09:24:12,481] [INFO] [<frozen importlib] -   F1 Score: 0.2751
[2025-11-19 09:24:12,481] [INFO] [<frozen importlib] -   AUROC: 0.7085
[2025-11-19 09:24:12,481] [INFO] [<frozen importlib] -   AUPRC: 0.2256
[2025-11-19 09:24:12,481] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:24:12,481] [INFO] [<frozen importlib] -     TN=16765, FP=680
[2025-11-19 09:24:12,481] [INFO] [<frozen importlib] -     FN=1112, TP=340
[2025-11-19 09:24:12,505] [INFO] [<frozen importlib] - Trial 369: AUPRC=0.2256, F1=0.4489, Prec=0.4757, Rec=0.4249 | Optimizing auprc=0.2256
[2025-11-19 09:24:12,505] [INFO] [<frozen importlib] - Trial 369 pruned.
[2025-11-19 09:24:12,505] [ERROR] [<frozen importlib] - Trial 369 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  74%|███████▍  | 369/500 [1:02:10<16:28,  7.55s/it]Best trial: 289. Best value: 0.241792:  74%|███████▍  | 369/500 [1:02:10<16:28,  7.55s/it]Best trial: 289. Best value: 0.241792:  74%|███████▍  | 370/500 [1:02:10<19:59,  9.23s/it][2025-11-19 09:24:12,527] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.972800204566845
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   gamma: 0.23151812639530273
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   alpha: 0.679547396318219
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   lambda: 1.0118048481712592
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   learning_rate: 0.03902762053907774
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   subsample: 0.8346729396680553
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   colsample_bytree: 0.6082170655428732
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5085799781487935
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   colsample_bynode: 0.6514136030119824
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:24:12,528] [INFO] [<frozen importlib] -   scale_pos_weight: 5.972800204566845
[2025-11-19 09:24:12,610] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:24:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:24:12,505] Trial 369 pruned. 
[0]	train-logloss:0.64247	train-auc:0.64099	train-aucpr:0.23986	val-logloss:0.63308	val-auc:0.58667	val-aucpr:0.13209
[10]	train-logloss:0.61988	train-auc:0.68077	train-aucpr:0.29251	val-logloss:0.57773	val-auc:0.70207	val-aucpr:0.20626
[20]	train-logloss:0.60664	train-auc:0.68749	train-aucpr:0.29906	val-logloss:0.54180	val-auc:0.70525	val-aucpr:0.20510
[30]	train-logloss:0.59756	train-auc:0.69175	train-aucpr:0.30285	val-logloss:0.52088	val-auc:0.70432	val-aucpr:0.21865
[40]	train-logloss:0.59040	train-auc:0.69739	train-aucpr:0.30800	val-logloss:0.50447	val-auc:0.70276	val-aucpr:0.22182
[50]	train-logloss:0.58507	train-auc:0.70135	train-aucpr:0.31296	val-logloss:0.48552	val-auc:0.70367	val-aucpr:0.22576
[60]	train-logloss:0.58069	train-auc:0.70632	train-aucpr:0.31779	val-logloss:0.49338	val-auc:0.70519	val-aucpr:0.22784
[70]	train-logloss:0.57750	train-auc:0.70956	train-aucpr:0.32087	val-logloss:0.48211	val-auc:0.70680	val-aucpr:0.23059
[80]	train-logloss:0.57486	train-auc:0.71270	train-aucpr:0.32448	val-logloss:0.47643	val-auc:0.70561	val-aucpr:0.22668
[90]	train-logloss:0.57246	train-auc:0.71568	train-aucpr:0.32812	val-logloss:0.46859	val-auc:0.69663	val-aucpr:0.20928
[97]	train-logloss:0.57087	train-auc:0.71809	train-aucpr:0.33085	val-logloss:0.46789	val-auc:0.69109	val-aucpr:0.20552
[2025-11-19 09:24:12,893] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:24:12,893] [INFO] [<frozen importlib] - Best train loss: 0.5781
[2025-11-19 09:24:12,893] [INFO] [<frozen importlib] - Best val loss: 0.4834
[2025-11-19 09:24:12,893] [INFO] [<frozen importlib] - Best val AUC: 0.7059
[2025-11-19 09:24:12,893] [INFO] [<frozen importlib] - Best val AUCPR: 0.2310
[2025-11-19 09:24:12,898] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:24:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:24:26,993] [INFO] [<frozen importlib] - Optimal threshold: 0.4628
[2025-11-19 09:24:26,994] [INFO] [<frozen importlib] - Best f1: 0.2827
[2025-11-19 09:24:26,994] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:24:27,048] [INFO] [<frozen importlib] - Validation Results (threshold=0.4628):
[2025-11-19 09:24:27,049] [INFO] [<frozen importlib] -   Accuracy: 0.8928
[2025-11-19 09:24:27,049] [INFO] [<frozen importlib] -   Precision: 0.2910
[2025-11-19 09:24:27,049] [INFO] [<frozen importlib] -   Recall: 0.2748
[2025-11-19 09:24:27,049] [INFO] [<frozen importlib] -   F1 Score: 0.2827
[2025-11-19 09:24:27,049] [INFO] [<frozen importlib] -   AUROC: 0.7059
[2025-11-19 09:24:27,049] [INFO] [<frozen importlib] -   AUPRC: 0.2313
[2025-11-19 09:24:27,049] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:24:27,049] [INFO] [<frozen importlib] -     TN=16473, FP=972
[2025-11-19 09:24:27,049] [INFO] [<frozen importlib] -     FN=1053, TP=399
[2025-11-19 09:24:27,070] [INFO] [<frozen importlib] - Trial 370: AUPRC=0.2313, F1=0.4481, Prec=0.4187, Rec=0.4821 | Optimizing auprc=0.2313
[2025-11-19 09:24:27,070] [INFO] [<frozen importlib] - Trial 370 pruned.
[2025-11-19 09:24:27,070] [ERROR] [<frozen importlib] - Trial 370 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  74%|███████▍  | 370/500 [1:02:25<19:59,  9.23s/it]Best trial: 289. Best value: 0.241792:  74%|███████▍  | 370/500 [1:02:25<19:59,  9.23s/it]Best trial: 289. Best value: 0.241792:  74%|███████▍  | 371/500 [1:02:25<23:17, 10.83s/it][2025-11-19 09:24:27,083] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.329368365122525
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   gamma: 0.19936220130176674
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   alpha: 0.5283902030321552
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   lambda: 0.8278919863553685
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   learning_rate: 0.036934019531977696
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   subsample: 0.9491480050906218
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   colsample_bytree: 0.7241316048460043
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5001282432152878
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   colsample_bynode: 0.7800194659078812
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:24:27,083] [INFO] [<frozen importlib] -   scale_pos_weight: 6.329368365122525
[2025-11-19 09:24:27,156] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:24:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:24:27,070] Trial 370 pruned. 
[0]	train-logloss:0.66220	train-auc:0.64441	train-aucpr:0.23322	val-logloss:0.65455	val-auc:0.57878	val-aucpr:0.09023
[10]	train-logloss:0.63942	train-auc:0.67995	train-aucpr:0.28926	val-logloss:0.61246	val-auc:0.65209	val-aucpr:0.16112
[20]	train-logloss:0.62489	train-auc:0.68816	train-aucpr:0.29870	val-logloss:0.57492	val-auc:0.67048	val-aucpr:0.19910
[30]	train-logloss:0.61520	train-auc:0.69199	train-aucpr:0.30422	val-logloss:0.54704	val-auc:0.68836	val-aucpr:0.21163
[40]	train-logloss:0.60793	train-auc:0.69816	train-aucpr:0.30917	val-logloss:0.52250	val-auc:0.69461	val-aucpr:0.21404
[50]	train-logloss:0.60248	train-auc:0.70256	train-aucpr:0.31399	val-logloss:0.51500	val-auc:0.69520	val-aucpr:0.21763
[60]	train-logloss:0.59813	train-auc:0.70684	train-aucpr:0.31950	val-logloss:0.50828	val-auc:0.69789	val-aucpr:0.21780
[70]	train-logloss:0.59450	train-auc:0.71035	train-aucpr:0.32364	val-logloss:0.50403	val-auc:0.69543	val-aucpr:0.21587
[80]	train-logloss:0.59175	train-auc:0.71391	train-aucpr:0.32689	val-logloss:0.49649	val-auc:0.69358	val-aucpr:0.21034
[84]	train-logloss:0.59071	train-auc:0.71488	train-aucpr:0.32795	val-logloss:0.49896	val-auc:0.69007	val-aucpr:0.20823
[2025-11-19 09:24:27,715] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 09:24:27,715] [INFO] [<frozen importlib] - Best train loss: 0.6003
[2025-11-19 09:24:27,715] [INFO] [<frozen importlib] - Best val loss: 0.5105
[2025-11-19 09:24:27,715] [INFO] [<frozen importlib] - Best val AUC: 0.6989
[2025-11-19 09:24:27,715] [INFO] [<frozen importlib] - Best val AUCPR: 0.2226
[2025-11-19 09:24:27,718] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:24:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:24:39,053] [INFO] [<frozen importlib] - Optimal threshold: 0.4775
[2025-11-19 09:24:39,054] [INFO] [<frozen importlib] - Best f1: 0.2724
[2025-11-19 09:24:39,054] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:24:39,098] [INFO] [<frozen importlib] - Validation Results (threshold=0.4775):
[2025-11-19 09:24:39,098] [INFO] [<frozen importlib] -   Accuracy: 0.9031
[2025-11-19 09:24:39,098] [INFO] [<frozen importlib] -   Precision: 0.3218
[2025-11-19 09:24:39,098] [INFO] [<frozen importlib] -   Recall: 0.2362
[2025-11-19 09:24:39,099] [INFO] [<frozen importlib] -   F1 Score: 0.2724
[2025-11-19 09:24:39,099] [INFO] [<frozen importlib] -   AUROC: 0.6989
[2025-11-19 09:24:39,099] [INFO] [<frozen importlib] -   AUPRC: 0.2230
[2025-11-19 09:24:39,099] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:24:39,099] [INFO] [<frozen importlib] -     TN=16722, FP=723
[2025-11-19 09:24:39,099] [INFO] [<frozen importlib] -     FN=1109, TP=343
[2025-11-19 09:24:39,127] [INFO] [<frozen importlib] - Trial 371: AUPRC=0.2230, F1=0.4525, Prec=0.4680, Rec=0.4380 | Optimizing auprc=0.2230
[2025-11-19 09:24:39,127] [INFO] [<frozen importlib] - Trial 371 pruned.
[2025-11-19 09:24:39,127] [ERROR] [<frozen importlib] - Trial 371 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  74%|███████▍  | 371/500 [1:02:37<23:17, 10.83s/it]Best trial: 289. Best value: 0.241792:  74%|███████▍  | 371/500 [1:02:37<23:17, 10.83s/it]Best trial: 289. Best value: 0.241792:  74%|███████▍  | 372/500 [1:02:37<23:53, 11.20s/it][2025-11-19 09:24:39,140] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.799621898505107
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   gamma: 0.16441019165187865
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   alpha: 0.3627383889234433
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   lambda: 1.121649830000342
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   learning_rate: 0.08047736394934266
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   subsample: 0.8228631740825062
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   colsample_bytree: 0.578879382602183
[2025-11-19 09:24:39,140] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5278103645479663
[2025-11-19 09:24:39,141] [INFO] [<frozen importlib] -   colsample_bynode: 0.7635831608130794
[2025-11-19 09:24:39,141] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:24:39,141] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:24:39,141] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:24:39,141] [INFO] [<frozen importlib] -   scale_pos_weight: 6.799621898505107
[2025-11-19 09:24:39,224] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:24:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:24:39,127] Trial 371 pruned. 
[0]	train-logloss:0.68493	train-auc:0.63662	train-aucpr:0.22298	val-logloss:0.67533	val-auc:0.61260	val-aucpr:0.11631
[10]	train-logloss:0.64541	train-auc:0.68707	train-aucpr:0.29499	val-logloss:0.57268	val-auc:0.69487	val-aucpr:0.21779
[20]	train-logloss:0.62880	train-auc:0.69930	train-aucpr:0.30892	val-logloss:0.55003	val-auc:0.70805	val-aucpr:0.23151
[30]	train-logloss:0.61901	train-auc:0.70693	train-aucpr:0.32016	val-logloss:0.52423	val-auc:0.71575	val-aucpr:0.22965
[40]	train-logloss:0.61315	train-auc:0.71384	train-aucpr:0.32649	val-logloss:0.50845	val-auc:0.71446	val-aucpr:0.22328
[48]	train-logloss:0.60801	train-auc:0.71974	train-aucpr:0.33250	val-logloss:0.49741	val-auc:0.70928	val-aucpr:0.21240
[2025-11-19 09:24:39,389] [INFO] [<frozen importlib] - Training completed at iteration 19
[2025-11-19 09:24:39,389] [INFO] [<frozen importlib] - Best train loss: 0.6298
[2025-11-19 09:24:39,389] [INFO] [<frozen importlib] - Best val loss: 0.5591
[2025-11-19 09:24:39,389] [INFO] [<frozen importlib] - Best val AUC: 0.7063
[2025-11-19 09:24:39,389] [INFO] [<frozen importlib] - Best val AUCPR: 0.2326
[2025-11-19 09:24:39,394] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:24:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:24:44,945] [INFO] [<frozen importlib] - Optimal threshold: 0.5082
[2025-11-19 09:24:44,945] [INFO] [<frozen importlib] - Best f1: 0.2793
[2025-11-19 09:24:44,945] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:24:44,986] [INFO] [<frozen importlib] - Validation Results (threshold=0.5082):
[2025-11-19 09:24:44,986] [INFO] [<frozen importlib] -   Accuracy: 0.9003
[2025-11-19 09:24:44,986] [INFO] [<frozen importlib] -   Precision: 0.3141
[2025-11-19 09:24:44,986] [INFO] [<frozen importlib] -   Recall: 0.2514
[2025-11-19 09:24:44,986] [INFO] [<frozen importlib] -   F1 Score: 0.2793
[2025-11-19 09:24:44,986] [INFO] [<frozen importlib] -   AUROC: 0.7063
[2025-11-19 09:24:44,986] [INFO] [<frozen importlib] -   AUPRC: 0.2328
[2025-11-19 09:24:44,986] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:24:44,986] [INFO] [<frozen importlib] -     TN=16648, FP=797
[2025-11-19 09:24:44,986] [INFO] [<frozen importlib] -     FN=1087, TP=365
[2025-11-19 09:24:45,010] [INFO] [<frozen importlib] - Trial 372: AUPRC=0.2328, F1=0.4763, Prec=0.4687, Rec=0.4842 | Optimizing auprc=0.2328
                                                                                          Best trial: 289. Best value: 0.241792:  74%|███████▍  | 372/500 [1:02:42<23:53, 11.20s/it]Best trial: 289. Best value: 0.241792:  74%|███████▍  | 372/500 [1:02:42<23:53, 11.20s/it]Best trial: 289. Best value: 0.241792:  75%|███████▍  | 373/500 [1:02:42<20:19,  9.60s/it][2025-11-19 09:24:45,024] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.529951377724932
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   gamma: 0.6072110452207705
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   alpha: 0.5542391388705362
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   lambda: 0.9067971222608979
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   learning_rate: 0.041716519951694585
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   subsample: 0.8504003614169563
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   colsample_bytree: 0.632917539686728
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5159611989148326
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   colsample_bynode: 0.8024764078902586
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:24:45,025] [INFO] [<frozen importlib] -   scale_pos_weight: 7.529951377724932
[2025-11-19 09:24:45,097] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:24:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:24:45,010] Trial 372 finished with value: 0.23284666934681128 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.16441019165187865, 'learning_rate': 0.08047736394934266, 'n_estimators': 450, 'alpha': 0.3627383889234433, 'lambda': 1.121649830000342, 'subsample': 0.8228631740825062, 'colsample_bytree': 0.578879382602183, 'colsample_bylevel': 0.5278103645479663, 'colsample_bynode': 0.7635831608130794, 'scale_pos_weight': 6.799621898505107}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.72647	train-auc:0.64381	train-aucpr:0.22799	val-logloss:0.72644	val-auc:0.61684	val-aucpr:0.13463
[10]	train-logloss:0.69812	train-auc:0.68063	train-aucpr:0.29263	val-logloss:0.65186	val-auc:0.66955	val-aucpr:0.19465
[20]	train-logloss:0.68140	train-auc:0.68817	train-aucpr:0.29917	val-logloss:0.60440	val-auc:0.68769	val-aucpr:0.20371
[30]	train-logloss:0.67070	train-auc:0.69496	train-aucpr:0.30490	val-logloss:0.57424	val-auc:0.68979	val-aucpr:0.21549
[40]	train-logloss:0.66267	train-auc:0.70012	train-aucpr:0.31083	val-logloss:0.54850	val-auc:0.69761	val-aucpr:0.21343
[50]	train-logloss:0.65654	train-auc:0.70474	train-aucpr:0.31574	val-logloss:0.54800	val-auc:0.69733	val-aucpr:0.20952
[60]	train-logloss:0.65221	train-auc:0.70836	train-aucpr:0.31996	val-logloss:0.53869	val-auc:0.69615	val-aucpr:0.21026
[61]	train-logloss:0.65185	train-auc:0.70898	train-aucpr:0.32055	val-logloss:0.53594	val-auc:0.69739	val-aucpr:0.21074
[2025-11-19 09:24:45,289] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 09:24:45,289] [INFO] [<frozen importlib] - Best train loss: 0.6689
[2025-11-19 09:24:45,289] [INFO] [<frozen importlib] - Best val loss: 0.5674
[2025-11-19 09:24:45,289] [INFO] [<frozen importlib] - Best val AUC: 0.6956
[2025-11-19 09:24:45,289] [INFO] [<frozen importlib] - Best val AUCPR: 0.2164
[2025-11-19 09:24:45,294] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:24:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:24:52,357] [INFO] [<frozen importlib] - Optimal threshold: 0.5034
[2025-11-19 09:24:52,357] [INFO] [<frozen importlib] - Best f1: 0.2540
[2025-11-19 09:24:52,357] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:24:52,397] [INFO] [<frozen importlib] - Validation Results (threshold=0.5034):
[2025-11-19 09:24:52,397] [INFO] [<frozen importlib] -   Accuracy: 0.8716
[2025-11-19 09:24:52,397] [INFO] [<frozen importlib] -   Precision: 0.2294
[2025-11-19 09:24:52,397] [INFO] [<frozen importlib] -   Recall: 0.2844
[2025-11-19 09:24:52,397] [INFO] [<frozen importlib] -   F1 Score: 0.2540
[2025-11-19 09:24:52,397] [INFO] [<frozen importlib] -   AUROC: 0.6956
[2025-11-19 09:24:52,397] [INFO] [<frozen importlib] -   AUPRC: 0.2167
[2025-11-19 09:24:52,397] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:24:52,397] [INFO] [<frozen importlib] -     TN=16058, FP=1387
[2025-11-19 09:24:52,397] [INFO] [<frozen importlib] -     FN=1039, TP=413
[2025-11-19 09:24:52,420] [INFO] [<frozen importlib] - Trial 373: AUPRC=0.2167, F1=0.4280, Prec=0.3579, Rec=0.5324 | Optimizing auprc=0.2167
[2025-11-19 09:24:52,420] [INFO] [<frozen importlib] - Trial 373 pruned.
[2025-11-19 09:24:52,420] [ERROR] [<frozen importlib] - Trial 373 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  75%|███████▍  | 373/500 [1:02:50<20:19,  9.60s/it]Best trial: 289. Best value: 0.241792:  75%|███████▍  | 373/500 [1:02:50<20:19,  9.60s/it]Best trial: 289. Best value: 0.241792:  75%|███████▍  | 374/500 [1:02:50<18:47,  8.95s/it][2025-11-19 09:24:52,433] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.405613212370577
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   gamma: 0.26450336036890454
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   alpha: 1.9780371374297836
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   lambda: 1.354022953954519
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   learning_rate: 0.038425541410136314
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   subsample: 0.9972976654308379
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   colsample_bytree: 0.5981953548414471
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5473854973175731
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   colsample_bynode: 0.6395568476321156
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:24:52,433] [INFO] [<frozen importlib] -   scale_pos_weight: 5.405613212370577
[2025-11-19 09:24:52,504] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:24:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:24:52,420] Trial 373 pruned. 
[0]	train-logloss:0.61032	train-auc:0.64771	train-aucpr:0.23582	val-logloss:0.59572	val-auc:0.62987	val-aucpr:0.13563
[10]	train-logloss:0.58946	train-auc:0.68211	train-aucpr:0.29448	val-logloss:0.55417	val-auc:0.67695	val-aucpr:0.19373
[20]	train-logloss:0.57603	train-auc:0.68800	train-aucpr:0.30215	val-logloss:0.52143	val-auc:0.70254	val-aucpr:0.21311
[30]	train-logloss:0.56714	train-auc:0.69264	train-aucpr:0.30614	val-logloss:0.49351	val-auc:0.70712	val-aucpr:0.21561
[40]	train-logloss:0.56073	train-auc:0.69678	train-aucpr:0.31102	val-logloss:0.47549	val-auc:0.71419	val-aucpr:0.22210
[50]	train-logloss:0.55604	train-auc:0.70014	train-aucpr:0.31475	val-logloss:0.47393	val-auc:0.70771	val-aucpr:0.22048
[60]	train-logloss:0.55194	train-auc:0.70543	train-aucpr:0.32011	val-logloss:0.46665	val-auc:0.69404	val-aucpr:0.21384
[70]	train-logloss:0.54905	train-auc:0.70841	train-aucpr:0.32364	val-logloss:0.46460	val-auc:0.69294	val-aucpr:0.21218
[71]	train-logloss:0.54884	train-auc:0.70855	train-aucpr:0.32406	val-logloss:0.46402	val-auc:0.69309	val-aucpr:0.21249
[2025-11-19 09:24:52,720] [INFO] [<frozen importlib] - Training completed at iteration 41
[2025-11-19 09:24:52,720] [INFO] [<frozen importlib] - Best train loss: 0.5601
[2025-11-19 09:24:52,720] [INFO] [<frozen importlib] - Best val loss: 0.4740
[2025-11-19 09:24:52,720] [INFO] [<frozen importlib] - Best val AUC: 0.7149
[2025-11-19 09:24:52,720] [INFO] [<frozen importlib] - Best val AUCPR: 0.2224
[2025-11-19 09:24:52,726] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:24:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:25:01,446] [INFO] [<frozen importlib] - Optimal threshold: 0.4330
[2025-11-19 09:25:01,446] [INFO] [<frozen importlib] - Best f1: 0.2750
[2025-11-19 09:25:01,446] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:25:01,488] [INFO] [<frozen importlib] - Validation Results (threshold=0.4330):
[2025-11-19 09:25:01,489] [INFO] [<frozen importlib] -   Accuracy: 0.8954
[2025-11-19 09:25:01,489] [INFO] [<frozen importlib] -   Precision: 0.2941
[2025-11-19 09:25:01,489] [INFO] [<frozen importlib] -   Recall: 0.2583
[2025-11-19 09:25:01,489] [INFO] [<frozen importlib] -   F1 Score: 0.2750
[2025-11-19 09:25:01,489] [INFO] [<frozen importlib] -   AUROC: 0.7149
[2025-11-19 09:25:01,489] [INFO] [<frozen importlib] -   AUPRC: 0.2228
[2025-11-19 09:25:01,489] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:25:01,489] [INFO] [<frozen importlib] -     TN=16545, FP=900
[2025-11-19 09:25:01,489] [INFO] [<frozen importlib] -     FN=1077, TP=375
[2025-11-19 09:25:01,512] [INFO] [<frozen importlib] - Trial 374: AUPRC=0.2228, F1=0.4377, Prec=0.4227, Rec=0.4539 | Optimizing auprc=0.2228
[2025-11-19 09:25:01,512] [INFO] [<frozen importlib] - Trial 374 pruned.
[2025-11-19 09:25:01,512] [ERROR] [<frozen importlib] - Trial 374 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  75%|███████▍  | 374/500 [1:02:59<18:47,  8.95s/it]Best trial: 289. Best value: 0.241792:  75%|███████▍  | 374/500 [1:02:59<18:47,  8.95s/it]Best trial: 289. Best value: 0.241792:  75%|███████▌  | 375/500 [1:02:59<18:43,  8.99s/it][2025-11-19 09:25:01,525] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.704494775934035
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   gamma: 0.5543384321488593
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   alpha: 0.4699485993031534
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   lambda: 0.5221047879351151
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   learning_rate: 0.05132722457143473
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   subsample: 0.7906154511960932
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   colsample_bytree: 0.5158597222924544
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9610220520329379
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   colsample_bynode: 0.771482745044315
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:25:01,525] [INFO] [<frozen importlib] -   scale_pos_weight: 5.704494775934035
[2025-11-19 09:25:01,600] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:25:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:25:01,512] Trial 374 pruned. 
[0]	train-logloss:0.62586	train-auc:0.65611	train-aucpr:0.23189	val-logloss:0.60907	val-auc:0.64392	val-aucpr:0.13553
[10]	train-logloss:0.59865	train-auc:0.68527	train-aucpr:0.29011	val-logloss:0.53821	val-auc:0.68245	val-aucpr:0.20516
[20]	train-logloss:0.58357	train-auc:0.69272	train-aucpr:0.30435	val-logloss:0.50126	val-auc:0.69802	val-aucpr:0.21674
[30]	train-logloss:0.57408	train-auc:0.69920	train-aucpr:0.31279	val-logloss:0.47763	val-auc:0.70770	val-aucpr:0.22448
[40]	train-logloss:0.56807	train-auc:0.70343	train-aucpr:0.31800	val-logloss:0.45679	val-auc:0.70800	val-aucpr:0.22597
[50]	train-logloss:0.56274	train-auc:0.70974	train-aucpr:0.32486	val-logloss:0.45280	val-auc:0.70361	val-aucpr:0.22216
[60]	train-logloss:0.55884	train-auc:0.71668	train-aucpr:0.33045	val-logloss:0.45271	val-auc:0.69935	val-aucpr:0.21613
[70]	train-logloss:0.55539	train-auc:0.72219	train-aucpr:0.33630	val-logloss:0.46092	val-auc:0.68603	val-aucpr:0.20022
[71]	train-logloss:0.55532	train-auc:0.72269	train-aucpr:0.33657	val-logloss:0.46063	val-auc:0.68576	val-aucpr:0.19978
[2025-11-19 09:25:01,809] [INFO] [<frozen importlib] - Training completed at iteration 42
[2025-11-19 09:25:01,809] [INFO] [<frozen importlib] - Best train loss: 0.5668
[2025-11-19 09:25:01,809] [INFO] [<frozen importlib] - Best val loss: 0.4512
[2025-11-19 09:25:01,809] [INFO] [<frozen importlib] - Best val AUC: 0.7068
[2025-11-19 09:25:01,809] [INFO] [<frozen importlib] - Best val AUCPR: 0.2274
[2025-11-19 09:25:01,813] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:25:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:25:11,559] [INFO] [<frozen importlib] - Optimal threshold: 0.4427
[2025-11-19 09:25:11,559] [INFO] [<frozen importlib] - Best f1: 0.2736
[2025-11-19 09:25:11,559] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:25:11,602] [INFO] [<frozen importlib] - Validation Results (threshold=0.4427):
[2025-11-19 09:25:11,602] [INFO] [<frozen importlib] -   Accuracy: 0.8960
[2025-11-19 09:25:11,602] [INFO] [<frozen importlib] -   Precision: 0.2953
[2025-11-19 09:25:11,602] [INFO] [<frozen importlib] -   Recall: 0.2548
[2025-11-19 09:25:11,602] [INFO] [<frozen importlib] -   F1 Score: 0.2736
[2025-11-19 09:25:11,602] [INFO] [<frozen importlib] -   AUROC: 0.7068
[2025-11-19 09:25:11,602] [INFO] [<frozen importlib] -   AUPRC: 0.2279
[2025-11-19 09:25:11,602] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:25:11,602] [INFO] [<frozen importlib] -     TN=16562, FP=883
[2025-11-19 09:25:11,602] [INFO] [<frozen importlib] -     FN=1082, TP=370
[2025-11-19 09:25:11,627] [INFO] [<frozen importlib] - Trial 375: AUPRC=0.2279, F1=0.4428, Prec=0.4292, Rec=0.4573 | Optimizing auprc=0.2279
[2025-11-19 09:25:11,633] [INFO] [<frozen importlib] - Trial 375 pruned.
[2025-11-19 09:25:11,633] [ERROR] [<frozen importlib] - Trial 375 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  75%|███████▌  | 375/500 [1:03:09<18:43,  8.99s/it]Best trial: 289. Best value: 0.241792:  75%|███████▌  | 375/500 [1:03:09<18:43,  8.99s/it]Best trial: 289. Best value: 0.241792:  75%|███████▌  | 376/500 [1:03:09<19:16,  9.33s/it][2025-11-19 09:25:11,656] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.906742447478852
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   gamma: 0.300113327066917
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   alpha: 0.5903508439619051
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   lambda: 1.2409110226001683
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   learning_rate: 0.040348232148502104
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   subsample: 0.8101584836892868
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   colsample_bytree: 0.5888652873175055
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6788924663381106
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   colsample_bynode: 0.7466430690330392
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:25:11,656] [INFO] [<frozen importlib] -   scale_pos_weight: 6.906742447478852
[2025-11-19 09:25:11,733] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:25:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:25:11,633] Trial 375 pruned. 
[0]	train-logloss:0.69371	train-auc:0.64099	train-aucpr:0.23243	val-logloss:0.69027	val-auc:0.61426	val-aucpr:0.10308
[10]	train-logloss:0.66749	train-auc:0.67826	train-aucpr:0.28962	val-logloss:0.62015	val-auc:0.68567	val-aucpr:0.19515
[20]	train-logloss:0.65207	train-auc:0.68572	train-aucpr:0.29808	val-logloss:0.57772	val-auc:0.71036	val-aucpr:0.20991
[30]	train-logloss:0.64197	train-auc:0.69105	train-aucpr:0.30570	val-logloss:0.55098	val-auc:0.70591	val-aucpr:0.22120
[40]	train-logloss:0.63436	train-auc:0.69687	train-aucpr:0.31074	val-logloss:0.53949	val-auc:0.70645	val-aucpr:0.22995
[50]	train-logloss:0.62826	train-auc:0.70300	train-aucpr:0.31578	val-logloss:0.53135	val-auc:0.70264	val-aucpr:0.21990
[60]	train-logloss:0.62396	train-auc:0.70714	train-aucpr:0.32089	val-logloss:0.51343	val-auc:0.70001	val-aucpr:0.22511
[70]	train-logloss:0.62050	train-auc:0.71082	train-aucpr:0.32408	val-logloss:0.51232	val-auc:0.69638	val-aucpr:0.22180
[2025-11-19 09:25:11,942] [INFO] [<frozen importlib] - Training completed at iteration 40
[2025-11-19 09:25:11,942] [INFO] [<frozen importlib] - Best train loss: 0.6344
[2025-11-19 09:25:11,942] [INFO] [<frozen importlib] - Best val loss: 0.5395
[2025-11-19 09:25:11,942] [INFO] [<frozen importlib] - Best val AUC: 0.7064
[2025-11-19 09:25:11,942] [INFO] [<frozen importlib] - Best val AUCPR: 0.2299
[2025-11-19 09:25:11,947] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:25:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:25:18,699] [INFO] [<frozen importlib] - Optimal threshold: 0.5069
[2025-11-19 09:25:18,699] [INFO] [<frozen importlib] - Best f1: 0.2764
[2025-11-19 09:25:18,699] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:25:18,742] [INFO] [<frozen importlib] - Validation Results (threshold=0.5069):
[2025-11-19 09:25:18,742] [INFO] [<frozen importlib] -   Accuracy: 0.9027
[2025-11-19 09:25:18,743] [INFO] [<frozen importlib] -   Precision: 0.3226
[2025-11-19 09:25:18,743] [INFO] [<frozen importlib] -   Recall: 0.2417
[2025-11-19 09:25:18,743] [INFO] [<frozen importlib] -   F1 Score: 0.2764
[2025-11-19 09:25:18,743] [INFO] [<frozen importlib] -   AUROC: 0.7064
[2025-11-19 09:25:18,743] [INFO] [<frozen importlib] -   AUPRC: 0.2303
[2025-11-19 09:25:18,743] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:25:18,743] [INFO] [<frozen importlib] -     TN=16708, FP=737
[2025-11-19 09:25:18,743] [INFO] [<frozen importlib] -     FN=1101, TP=351
[2025-11-19 09:25:18,766] [INFO] [<frozen importlib] - Trial 376: AUPRC=0.2303, F1=0.4530, Prec=0.4652, Rec=0.4415 | Optimizing auprc=0.2303
                                                                                          Best trial: 289. Best value: 0.241792:  75%|███████▌  | 376/500 [1:03:16<19:16,  9.33s/it]Best trial: 289. Best value: 0.241792:  75%|███████▌  | 376/500 [1:03:16<19:16,  9.33s/it]Best trial: 289. Best value: 0.241792:  75%|███████▌  | 377/500 [1:03:16<17:46,  8.67s/it][2025-11-19 09:25:18,779] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.1705366480141866
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   gamma: 0.38173683990312507
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   alpha: 0.6423043215798654
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   lambda: 1.021760723112133
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   learning_rate: 0.03383019086726726
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   subsample: 0.8404015374824227
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   colsample_bytree: 0.6130427741777833
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5001102438150898
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   colsample_bynode: 0.7912854366827781
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:25:18,779] [INFO] [<frozen importlib] -   scale_pos_weight: 6.1705366480141866
[2025-11-19 09:25:18,854] [INFO] [<frozen importlib] - Training with 200 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:25:18] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:25:18,766] Trial 376 finished with value: 0.2302636201731712 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.300113327066917, 'learning_rate': 0.040348232148502104, 'n_estimators': 450, 'alpha': 0.5903508439619051, 'lambda': 1.2409110226001683, 'subsample': 0.8101584836892868, 'colsample_bytree': 0.5888652873175055, 'colsample_bylevel': 0.6788924663381106, 'colsample_bynode': 0.7466430690330392, 'scale_pos_weight': 6.906742447478852}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.65408	train-auc:0.63856	train-aucpr:0.23103	val-logloss:0.64615	val-auc:0.61099	val-aucpr:0.12854
[10]	train-logloss:0.63300	train-auc:0.68088	train-aucpr:0.29153	val-logloss:0.59598	val-auc:0.69550	val-aucpr:0.20284
[20]	train-logloss:0.61912	train-auc:0.68690	train-aucpr:0.29790	val-logloss:0.55679	val-auc:0.69594	val-aucpr:0.19912
[30]	train-logloss:0.60970	train-auc:0.69064	train-aucpr:0.30409	val-logloss:0.52844	val-auc:0.69915	val-aucpr:0.21802
[40]	train-logloss:0.60281	train-auc:0.69565	train-aucpr:0.30918	val-logloss:0.51205	val-auc:0.69901	val-aucpr:0.21097
[50]	train-logloss:0.59724	train-auc:0.69931	train-aucpr:0.31268	val-logloss:0.50195	val-auc:0.70258	val-aucpr:0.21747
[60]	train-logloss:0.59315	train-auc:0.70245	train-aucpr:0.31589	val-logloss:0.49088	val-auc:0.70266	val-aucpr:0.22267
[70]	train-logloss:0.58951	train-auc:0.70673	train-aucpr:0.31923	val-logloss:0.49291	val-auc:0.69675	val-aucpr:0.21415
[80]	train-logloss:0.58691	train-auc:0.70900	train-aucpr:0.32162	val-logloss:0.48185	val-auc:0.69844	val-aucpr:0.21622
[89]	train-logloss:0.58466	train-auc:0.71209	train-aucpr:0.32454	val-logloss:0.47145	val-auc:0.69817	val-aucpr:0.21699
[2025-11-19 09:25:19,134] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:25:19,134] [INFO] [<frozen importlib] - Best train loss: 0.5931
[2025-11-19 09:25:19,134] [INFO] [<frozen importlib] - Best val loss: 0.4909
[2025-11-19 09:25:19,134] [INFO] [<frozen importlib] - Best val AUC: 0.7027
[2025-11-19 09:25:19,134] [INFO] [<frozen importlib] - Best val AUCPR: 0.2227
[2025-11-19 09:25:19,139] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:25:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:25:31,781] [INFO] [<frozen importlib] - Optimal threshold: 0.4761
[2025-11-19 09:25:31,781] [INFO] [<frozen importlib] - Best f1: 0.2691
[2025-11-19 09:25:31,781] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:25:31,827] [INFO] [<frozen importlib] - Validation Results (threshold=0.4761):
[2025-11-19 09:25:31,827] [INFO] [<frozen importlib] -   Accuracy: 0.9020
[2025-11-19 09:25:31,827] [INFO] [<frozen importlib] -   Precision: 0.3152
[2025-11-19 09:25:31,827] [INFO] [<frozen importlib] -   Recall: 0.2348
[2025-11-19 09:25:31,827] [INFO] [<frozen importlib] -   F1 Score: 0.2691
[2025-11-19 09:25:31,827] [INFO] [<frozen importlib] -   AUROC: 0.7027
[2025-11-19 09:25:31,827] [INFO] [<frozen importlib] -   AUPRC: 0.2231
[2025-11-19 09:25:31,827] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:25:31,827] [INFO] [<frozen importlib] -     TN=16704, FP=741
[2025-11-19 09:25:31,827] [INFO] [<frozen importlib] -     FN=1111, TP=341
[2025-11-19 09:25:31,850] [INFO] [<frozen importlib] - Trial 377: AUPRC=0.2231, F1=0.4507, Prec=0.4627, Rec=0.4394 | Optimizing auprc=0.2231
[2025-11-19 09:25:31,850] [INFO] [<frozen importlib] - Trial 377 pruned.
[2025-11-19 09:25:31,850] [ERROR] [<frozen importlib] - Trial 377 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  75%|███████▌  | 377/500 [1:03:29<17:46,  8.67s/it]Best trial: 289. Best value: 0.241792:  75%|███████▌  | 377/500 [1:03:29<17:46,  8.67s/it]Best trial: 289. Best value: 0.241792:  76%|███████▌  | 378/500 [1:03:29<20:19,  9.99s/it][2025-11-19 09:25:31,864] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.585465221107511
[2025-11-19 09:25:31,864] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:25:31,864] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:25:31,864] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:25:31,864] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:25:31,864] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:25:31,864] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:25:31,864] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:25:31,864] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   gamma: 0.574207989552278
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   alpha: 0.5109287642258136
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   lambda: 0.7497066396184504
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   learning_rate: 0.08596175008539265
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   subsample: 0.8204190357925071
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   colsample_bytree: 0.6012306743514767
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5194483831841847
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   colsample_bynode: 0.7790668211856588
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:25:31,865] [INFO] [<frozen importlib] -   scale_pos_weight: 6.585465221107511
[2025-11-19 09:25:31,941] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:25:31] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:25:31,850] Trial 377 pruned. 
[0]	train-logloss:0.67283	train-auc:0.64118	train-aucpr:0.23976	val-logloss:0.66508	val-auc:0.58715	val-aucpr:0.13760
[10]	train-logloss:0.63234	train-auc:0.68805	train-aucpr:0.29874	val-logloss:0.55384	val-auc:0.69845	val-aucpr:0.20670
[20]	train-logloss:0.61607	train-auc:0.70154	train-aucpr:0.31058	val-logloss:0.52919	val-auc:0.70939	val-aucpr:0.21916
[30]	train-logloss:0.60739	train-auc:0.70842	train-aucpr:0.31961	val-logloss:0.50472	val-auc:0.71637	val-aucpr:0.22885
[40]	train-logloss:0.60056	train-auc:0.71789	train-aucpr:0.32896	val-logloss:0.47490	val-auc:0.67942	val-aucpr:0.18369
[50]	train-logloss:0.59521	train-auc:0.72356	train-aucpr:0.33577	val-logloss:0.47336	val-auc:0.66506	val-aucpr:0.16799
[60]	train-logloss:0.59152	train-auc:0.73091	train-aucpr:0.34276	val-logloss:0.46104	val-auc:0.65937	val-aucpr:0.15568
[62]	train-logloss:0.59075	train-auc:0.73214	train-aucpr:0.34423	val-logloss:0.46047	val-auc:0.65996	val-aucpr:0.15618
[2025-11-19 09:25:32,128] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 09:25:32,128] [INFO] [<frozen importlib] - Best train loss: 0.6063
[2025-11-19 09:25:32,128] [INFO] [<frozen importlib] - Best val loss: 0.5010
[2025-11-19 09:25:32,128] [INFO] [<frozen importlib] - Best val AUC: 0.7166
[2025-11-19 09:25:32,128] [INFO] [<frozen importlib] - Best val AUCPR: 0.2301
[2025-11-19 09:25:32,132] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:25:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:25:44,632] [INFO] [<frozen importlib] - Optimal threshold: 0.4990
[2025-11-19 09:25:44,632] [INFO] [<frozen importlib] - Best f1: 0.2787
[2025-11-19 09:25:44,632] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:25:44,676] [INFO] [<frozen importlib] - Validation Results (threshold=0.4990):
[2025-11-19 09:25:44,676] [INFO] [<frozen importlib] -   Accuracy: 0.9011
[2025-11-19 09:25:44,676] [INFO] [<frozen importlib] -   Precision: 0.3169
[2025-11-19 09:25:44,676] [INFO] [<frozen importlib] -   Recall: 0.2486
[2025-11-19 09:25:44,676] [INFO] [<frozen importlib] -   F1 Score: 0.2787
[2025-11-19 09:25:44,676] [INFO] [<frozen importlib] -   AUROC: 0.7166
[2025-11-19 09:25:44,676] [INFO] [<frozen importlib] -   AUPRC: 0.2305
[2025-11-19 09:25:44,676] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:25:44,676] [INFO] [<frozen importlib] -     TN=16667, FP=778
[2025-11-19 09:25:44,676] [INFO] [<frozen importlib] -     FN=1091, TP=361
[2025-11-19 09:25:44,701] [INFO] [<frozen importlib] - Trial 378: AUPRC=0.2305, F1=0.4551, Prec=0.4578, Rec=0.4525 | Optimizing auprc=0.2305
                                                                                          Best trial: 289. Best value: 0.241792:  76%|███████▌  | 378/500 [1:03:42<20:19,  9.99s/it]Best trial: 289. Best value: 0.241792:  76%|███████▌  | 378/500 [1:03:42<20:19,  9.99s/it]Best trial: 289. Best value: 0.241792:  76%|███████▌  | 379/500 [1:03:42<21:53, 10.85s/it][2025-11-19 09:25:44,714] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.090202156649921
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   gamma: 0.1403172925720154
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   alpha: 0.4477644626643384
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   lambda: 1.1268302224335514
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   learning_rate: 0.03578746205005287
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   subsample: 0.8585304201875273
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   colsample_bytree: 0.568828407551309
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7611885192965641
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   colsample_bynode: 0.7590709057385182
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:25:44,717] [INFO] [<frozen importlib] -   scale_pos_weight: 7.090202156649921
[2025-11-19 09:25:44,789] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:25:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:25:44,701] Trial 378 finished with value: 0.23047414735723754 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.574207989552278, 'learning_rate': 0.08596175008539265, 'n_estimators': 350, 'alpha': 0.5109287642258136, 'lambda': 0.7497066396184504, 'subsample': 0.8204190357925071, 'colsample_bytree': 0.6012306743514767, 'colsample_bylevel': 0.5194483831841847, 'colsample_bynode': 0.7790668211856588, 'scale_pos_weight': 6.585465221107511}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.70466	train-auc:0.61636	train-aucpr:0.20048	val-logloss:0.70488	val-auc:0.62516	val-aucpr:0.13143
[10]	train-logloss:0.68403	train-auc:0.66366	train-aucpr:0.26453	val-logloss:0.64750	val-auc:0.64066	val-aucpr:0.13392
[20]	train-logloss:0.67087	train-auc:0.66990	train-aucpr:0.27424	val-logloss:0.61417	val-auc:0.64457	val-aucpr:0.13026
[30]	train-logloss:0.66218	train-auc:0.67433	train-aucpr:0.28128	val-logloss:0.58387	val-auc:0.65476	val-aucpr:0.18625
[40]	train-logloss:0.65591	train-auc:0.67914	train-aucpr:0.28660	val-logloss:0.56292	val-auc:0.65802	val-aucpr:0.19511
[50]	train-logloss:0.65074	train-auc:0.68483	train-aucpr:0.29084	val-logloss:0.55731	val-auc:0.66310	val-aucpr:0.19668
[60]	train-logloss:0.64663	train-auc:0.68786	train-aucpr:0.29597	val-logloss:0.55224	val-auc:0.67339	val-aucpr:0.21236
[70]	train-logloss:0.64321	train-auc:0.69046	train-aucpr:0.29878	val-logloss:0.54476	val-auc:0.68448	val-aucpr:0.22146
[80]	train-logloss:0.64080	train-auc:0.69258	train-aucpr:0.30112	val-logloss:0.54765	val-auc:0.70054	val-aucpr:0.22500
[90]	train-logloss:0.63809	train-auc:0.69667	train-aucpr:0.30437	val-logloss:0.54053	val-auc:0.70194	val-aucpr:0.22366
[100]	train-logloss:0.63599	train-auc:0.69884	train-aucpr:0.30669	val-logloss:0.53682	val-auc:0.69986	val-aucpr:0.22009
[110]	train-logloss:0.63406	train-auc:0.70108	train-aucpr:0.30865	val-logloss:0.52883	val-auc:0.68996	val-aucpr:0.20982
[112]	train-logloss:0.63375	train-auc:0.70145	train-aucpr:0.30945	val-logloss:0.52679	val-auc:0.69056	val-aucpr:0.21095
[2025-11-19 09:25:45,049] [INFO] [<frozen importlib] - Training completed at iteration 83
[2025-11-19 09:25:45,049] [INFO] [<frozen importlib] - Best train loss: 0.6399
[2025-11-19 09:25:45,049] [INFO] [<frozen importlib] - Best val loss: 0.5443
[2025-11-19 09:25:45,049] [INFO] [<frozen importlib] - Best val AUC: 0.7045
[2025-11-19 09:25:45,049] [INFO] [<frozen importlib] - Best val AUCPR: 0.2277
[2025-11-19 09:25:45,054] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:25:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:25:54,182] [INFO] [<frozen importlib] - Optimal threshold: 0.5154
[2025-11-19 09:25:54,182] [INFO] [<frozen importlib] - Best f1: 0.2798
[2025-11-19 09:25:54,182] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:25:54,224] [INFO] [<frozen importlib] - Validation Results (threshold=0.5154):
[2025-11-19 09:25:54,224] [INFO] [<frozen importlib] -   Accuracy: 0.9063
[2025-11-19 09:25:54,224] [INFO] [<frozen importlib] -   Precision: 0.3416
[2025-11-19 09:25:54,224] [INFO] [<frozen importlib] -   Recall: 0.2369
[2025-11-19 09:25:54,224] [INFO] [<frozen importlib] -   F1 Score: 0.2798
[2025-11-19 09:25:54,224] [INFO] [<frozen importlib] -   AUROC: 0.7045
[2025-11-19 09:25:54,224] [INFO] [<frozen importlib] -   AUPRC: 0.2283
[2025-11-19 09:25:54,224] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:25:54,224] [INFO] [<frozen importlib] -     TN=16782, FP=663
[2025-11-19 09:25:54,224] [INFO] [<frozen importlib] -     FN=1108, TP=344
[2025-11-19 09:25:54,246] [INFO] [<frozen importlib] - Trial 379: AUPRC=0.2283, F1=0.4449, Prec=0.4771, Rec=0.4167 | Optimizing auprc=0.2283
[2025-11-19 09:25:54,246] [INFO] [<frozen importlib] - Trial 379 pruned.
[2025-11-19 09:25:54,246] [ERROR] [<frozen importlib] - Trial 379 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  76%|███████▌  | 379/500 [1:03:52<21:53, 10.85s/it]Best trial: 289. Best value: 0.241792:  76%|███████▌  | 379/500 [1:03:52<21:53, 10.85s/it]Best trial: 289. Best value: 0.241792:  76%|███████▌  | 380/500 [1:03:52<20:55, 10.46s/it][2025-11-19 09:25:54,259] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 14.669456119634942
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   gamma: 0.2473236087253719
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   alpha: 1.5953797306852218
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   lambda: 0.9481834303416857
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   learning_rate: 0.043194585922059374
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   subsample: 0.8303309770335426
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   colsample_bytree: 0.529057036165039
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5326012878967287
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   colsample_bynode: 0.6658306112020491
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:25:54,259] [INFO] [<frozen importlib] -   scale_pos_weight: 14.669456119634942
[2025-11-19 09:25:54,331] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:25:54] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:25:54,246] Trial 379 pruned. 
[0]	train-logloss:1.02376	train-auc:0.63461	train-aucpr:0.22060	val-logloss:1.05448	val-auc:0.63897	val-aucpr:0.13849
[10]	train-logloss:0.98558	train-auc:0.68242	train-aucpr:0.28602	val-logloss:0.95194	val-auc:0.69760	val-aucpr:0.21331
[20]	train-logloss:0.96507	train-auc:0.68863	train-aucpr:0.29343	val-logloss:0.88065	val-auc:0.70268	val-aucpr:0.21675
[30]	train-logloss:0.95196	train-auc:0.69243	train-aucpr:0.29968	val-logloss:0.83651	val-auc:0.69886	val-aucpr:0.22088
[40]	train-logloss:0.94117	train-auc:0.70057	train-aucpr:0.30634	val-logloss:0.81429	val-auc:0.70255	val-aucpr:0.21704
[50]	train-logloss:0.93299	train-auc:0.70495	train-aucpr:0.31117	val-logloss:0.80887	val-auc:0.69744	val-aucpr:0.21352
[60]	train-logloss:0.92737	train-auc:0.70911	train-aucpr:0.31715	val-logloss:0.80568	val-auc:0.69368	val-aucpr:0.20842
[64]	train-logloss:0.92510	train-auc:0.71044	train-aucpr:0.31897	val-logloss:0.80364	val-auc:0.69574	val-aucpr:0.21060
[2025-11-19 09:25:54,525] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 09:25:54,525] [INFO] [<frozen importlib] - Best train loss: 0.9477
[2025-11-19 09:25:54,525] [INFO] [<frozen importlib] - Best val loss: 0.8175
[2025-11-19 09:25:54,525] [INFO] [<frozen importlib] - Best val AUC: 0.6996
[2025-11-19 09:25:54,525] [INFO] [<frozen importlib] - Best val AUCPR: 0.2224
[2025-11-19 09:25:54,529] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:25:54] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:26:03,902] [INFO] [<frozen importlib] - Optimal threshold: 0.6625
[2025-11-19 09:26:03,902] [INFO] [<frozen importlib] - Best f1: 0.2539
[2025-11-19 09:26:03,902] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:26:03,942] [INFO] [<frozen importlib] - Validation Results (threshold=0.6625):
[2025-11-19 09:26:03,943] [INFO] [<frozen importlib] -   Accuracy: 0.8725
[2025-11-19 09:26:03,943] [INFO] [<frozen importlib] -   Precision: 0.2307
[2025-11-19 09:26:03,943] [INFO] [<frozen importlib] -   Recall: 0.2824
[2025-11-19 09:26:03,943] [INFO] [<frozen importlib] -   F1 Score: 0.2539
[2025-11-19 09:26:03,943] [INFO] [<frozen importlib] -   AUROC: 0.6996
[2025-11-19 09:26:03,943] [INFO] [<frozen importlib] -   AUPRC: 0.2227
[2025-11-19 09:26:03,943] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:26:03,943] [INFO] [<frozen importlib] -     TN=16078, FP=1367
[2025-11-19 09:26:03,943] [INFO] [<frozen importlib] -     FN=1042, TP=410
[2025-11-19 09:26:03,966] [INFO] [<frozen importlib] - Trial 380: AUPRC=0.2227, F1=0.4408, Prec=0.3683, Rec=0.5489 | Optimizing auprc=0.2227
[2025-11-19 09:26:03,966] [INFO] [<frozen importlib] - Trial 380 pruned.
[2025-11-19 09:26:03,966] [ERROR] [<frozen importlib] - Trial 380 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  76%|███████▌  | 380/500 [1:04:01<20:55, 10.46s/it]Best trial: 289. Best value: 0.241792:  76%|███████▌  | 380/500 [1:04:01<20:55, 10.46s/it]Best trial: 289. Best value: 0.241792:  76%|███████▌  | 381/500 [1:04:01<20:18, 10.24s/it][2025-11-19 09:26:03,979] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 11.611989748648742
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   gamma: 0.21891316811893088
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   alpha: 0.3975093851506799
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   lambda: 1.222344063328991
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   learning_rate: 0.039639975603169585
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   subsample: 0.7986406791279653
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   colsample_bytree: 0.5092944400729604
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5089498493542994
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   colsample_bynode: 0.8375125144931033
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:26:03,979] [INFO] [<frozen importlib] -   scale_pos_weight: 11.611989748648742
[2025-11-19 09:26:04,051] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:26:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:26:03,966] Trial 380 pruned. 
[0]	train-logloss:0.91425	train-auc:0.63930	train-aucpr:0.21905	val-logloss:0.93506	val-auc:0.65287	val-aucpr:0.13351
[10]	train-logloss:0.88042	train-auc:0.68214	train-aucpr:0.28439	val-logloss:0.85276	val-auc:0.68957	val-aucpr:0.20395
[20]	train-logloss:0.86020	train-auc:0.69003	train-aucpr:0.29386	val-logloss:0.79391	val-auc:0.71019	val-aucpr:0.22737
[30]	train-logloss:0.84667	train-auc:0.69401	train-aucpr:0.29998	val-logloss:0.74939	val-auc:0.70359	val-aucpr:0.22497
[40]	train-logloss:0.83649	train-auc:0.69917	train-aucpr:0.30523	val-logloss:0.72035	val-auc:0.70261	val-aucpr:0.22626
[50]	train-logloss:0.82859	train-auc:0.70327	train-aucpr:0.31118	val-logloss:0.69984	val-auc:0.70193	val-aucpr:0.22830
[60]	train-logloss:0.82286	train-auc:0.70712	train-aucpr:0.31525	val-logloss:0.69356	val-auc:0.70119	val-aucpr:0.22647
[70]	train-logloss:0.81792	train-auc:0.71164	train-aucpr:0.31929	val-logloss:0.69290	val-auc:0.69378	val-aucpr:0.21539
[80]	train-logloss:0.81351	train-auc:0.71526	train-aucpr:0.32370	val-logloss:0.68552	val-auc:0.68911	val-aucpr:0.20937
[2025-11-19 09:26:04,287] [INFO] [<frozen importlib] - Training completed at iteration 51
[2025-11-19 09:26:04,287] [INFO] [<frozen importlib] - Best train loss: 0.8280
[2025-11-19 09:26:04,287] [INFO] [<frozen importlib] - Best val loss: 0.6991
[2025-11-19 09:26:04,287] [INFO] [<frozen importlib] - Best val AUC: 0.7029
[2025-11-19 09:26:04,287] [INFO] [<frozen importlib] - Best val AUCPR: 0.2293
[2025-11-19 09:26:04,291] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:26:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:26:15,756] [INFO] [<frozen importlib] - Optimal threshold: 0.6159
[2025-11-19 09:26:15,757] [INFO] [<frozen importlib] - Best f1: 0.2691
[2025-11-19 09:26:15,757] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:26:15,800] [INFO] [<frozen importlib] - Validation Results (threshold=0.6159):
[2025-11-19 09:26:15,800] [INFO] [<frozen importlib] -   Accuracy: 0.8962
[2025-11-19 09:26:15,800] [INFO] [<frozen importlib] -   Precision: 0.2933
[2025-11-19 09:26:15,800] [INFO] [<frozen importlib] -   Recall: 0.2486
[2025-11-19 09:26:15,800] [INFO] [<frozen importlib] -   F1 Score: 0.2691
[2025-11-19 09:26:15,800] [INFO] [<frozen importlib] -   AUROC: 0.7029
[2025-11-19 09:26:15,800] [INFO] [<frozen importlib] -   AUPRC: 0.2297
[2025-11-19 09:26:15,800] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:26:15,800] [INFO] [<frozen importlib] -     TN=16575, FP=870
[2025-11-19 09:26:15,800] [INFO] [<frozen importlib] -     FN=1091, TP=361
[2025-11-19 09:26:15,823] [INFO] [<frozen importlib] - Trial 381: AUPRC=0.2297, F1=0.4494, Prec=0.4362, Rec=0.4635 | Optimizing auprc=0.2297
                                                                                          Best trial: 289. Best value: 0.241792:  76%|███████▌  | 381/500 [1:04:13<20:18, 10.24s/it]Best trial: 289. Best value: 0.241792:  76%|███████▌  | 381/500 [1:04:13<20:18, 10.24s/it]Best trial: 289. Best value: 0.241792:  76%|███████▋  | 382/500 [1:04:13<21:05, 10.72s/it][2025-11-19 09:26:15,836] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.196514721973591
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   gamma: 0.3621386353949398
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   alpha: 0.549781365515578
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   lambda: 0.8674946803314997
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   learning_rate: 0.03632151479530962
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   subsample: 0.8085450607981047
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   colsample_bytree: 0.5871296895833448
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5182013884880252
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   colsample_bynode: 0.8147746150797414
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:26:15,837] [INFO] [<frozen importlib] -   scale_pos_weight: 5.196514721973591
[2025-11-19 09:26:15,910] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:26:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:26:15,824] Trial 381 finished with value: 0.2296783128352549 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.21891316811893088, 'learning_rate': 0.039639975603169585, 'n_estimators': 450, 'alpha': 0.3975093851506799, 'lambda': 1.222344063328991, 'subsample': 0.7986406791279653, 'colsample_bytree': 0.5092944400729604, 'colsample_bylevel': 0.5089498493542994, 'colsample_bynode': 0.8375125144931033, 'scale_pos_weight': 11.611989748648742}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.59869	train-auc:0.63233	train-aucpr:0.22908	val-logloss:0.58322	val-auc:0.61416	val-aucpr:0.13387
[10]	train-logloss:0.57849	train-auc:0.68031	train-aucpr:0.29044	val-logloss:0.54240	val-auc:0.68881	val-aucpr:0.18490
[20]	train-logloss:0.56629	train-auc:0.68655	train-aucpr:0.29925	val-logloss:0.51655	val-auc:0.69214	val-aucpr:0.20890
[30]	train-logloss:0.55749	train-auc:0.69167	train-aucpr:0.30608	val-logloss:0.49250	val-auc:0.69880	val-aucpr:0.21944
[40]	train-logloss:0.55144	train-auc:0.69597	train-aucpr:0.30910	val-logloss:0.47533	val-auc:0.70485	val-aucpr:0.22487
[50]	train-logloss:0.54608	train-auc:0.70193	train-aucpr:0.31422	val-logloss:0.47387	val-auc:0.70183	val-aucpr:0.22542
[60]	train-logloss:0.54224	train-auc:0.70532	train-aucpr:0.31843	val-logloss:0.47086	val-auc:0.70140	val-aucpr:0.22771
[70]	train-logloss:0.53924	train-auc:0.70907	train-aucpr:0.32233	val-logloss:0.47163	val-auc:0.69819	val-aucpr:0.22245
[80]	train-logloss:0.53656	train-auc:0.71189	train-aucpr:0.32547	val-logloss:0.46149	val-auc:0.69827	val-aucpr:0.22279
[89]	train-logloss:0.53445	train-auc:0.71506	train-aucpr:0.32912	val-logloss:0.46408	val-auc:0.69356	val-aucpr:0.21426
[2025-11-19 09:26:16,170] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:26:16,170] [INFO] [<frozen importlib] - Best train loss: 0.5422
[2025-11-19 09:26:16,170] [INFO] [<frozen importlib] - Best val loss: 0.4709
[2025-11-19 09:26:16,170] [INFO] [<frozen importlib] - Best val AUC: 0.7014
[2025-11-19 09:26:16,170] [INFO] [<frozen importlib] - Best val AUCPR: 0.2277
[2025-11-19 09:26:16,174] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:26:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:26:27,763] [INFO] [<frozen importlib] - Optimal threshold: 0.4318
[2025-11-19 09:26:27,763] [INFO] [<frozen importlib] - Best f1: 0.2704
[2025-11-19 09:26:27,763] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:26:27,817] [INFO] [<frozen importlib] - Validation Results (threshold=0.4318):
[2025-11-19 09:26:27,817] [INFO] [<frozen importlib] -   Accuracy: 0.8841
[2025-11-19 09:26:27,817] [INFO] [<frozen importlib] -   Precision: 0.2618
[2025-11-19 09:26:27,817] [INFO] [<frozen importlib] -   Recall: 0.2796
[2025-11-19 09:26:27,817] [INFO] [<frozen importlib] -   F1 Score: 0.2704
[2025-11-19 09:26:27,817] [INFO] [<frozen importlib] -   AUROC: 0.7014
[2025-11-19 09:26:27,817] [INFO] [<frozen importlib] -   AUPRC: 0.2281
[2025-11-19 09:26:27,817] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:26:27,817] [INFO] [<frozen importlib] -     TN=16300, FP=1145
[2025-11-19 09:26:27,817] [INFO] [<frozen importlib] -     FN=1046, TP=406
[2025-11-19 09:26:27,844] [INFO] [<frozen importlib] - Trial 382: AUPRC=0.2281, F1=0.4412, Prec=0.3910, Rec=0.5062 | Optimizing auprc=0.2281
[2025-11-19 09:26:27,845] [INFO] [<frozen importlib] - Trial 382 pruned.
[2025-11-19 09:26:27,845] [ERROR] [<frozen importlib] - Trial 382 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  76%|███████▋  | 382/500 [1:04:25<21:05, 10.72s/it]Best trial: 289. Best value: 0.241792:  76%|███████▋  | 382/500 [1:04:25<21:05, 10.72s/it]Best trial: 289. Best value: 0.241792:  77%|███████▋  | 383/500 [1:04:25<21:40, 11.11s/it][2025-11-19 09:26:27,858] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.916601650312651
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   gamma: 0.12158802191606165
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   alpha: 0.6079680907721222
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   lambda: 3.356604172947529
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   learning_rate: 0.03766710554257962
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   subsample: 0.8416436999219477
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   colsample_bytree: 0.6051828899111986
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6199528309828416
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   colsample_bynode: 0.6890715568369854
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:26:27,858] [INFO] [<frozen importlib] -   scale_pos_weight: 5.916601650312651
[2025-11-19 09:26:27,930] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:26:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:26:27,845] Trial 382 pruned. 
[0]	train-logloss:0.63925	train-auc:0.64432	train-aucpr:0.25007	val-logloss:0.62841	val-auc:0.62380	val-aucpr:0.13277
[10]	train-logloss:0.61716	train-auc:0.68207	train-aucpr:0.29072	val-logloss:0.56661	val-auc:0.69897	val-aucpr:0.19980
[20]	train-logloss:0.60336	train-auc:0.68726	train-aucpr:0.29979	val-logloss:0.53385	val-auc:0.70035	val-aucpr:0.21994
[30]	train-logloss:0.59405	train-auc:0.69130	train-aucpr:0.30583	val-logloss:0.51082	val-auc:0.68746	val-aucpr:0.21634
[40]	train-logloss:0.58743	train-auc:0.69556	train-aucpr:0.30920	val-logloss:0.49581	val-auc:0.70426	val-aucpr:0.22248
[50]	train-logloss:0.58209	train-auc:0.69988	train-aucpr:0.31309	val-logloss:0.48763	val-auc:0.70754	val-aucpr:0.21841
[60]	train-logloss:0.57827	train-auc:0.70409	train-aucpr:0.31694	val-logloss:0.48348	val-auc:0.70836	val-aucpr:0.22122
[70]	train-logloss:0.57476	train-auc:0.70902	train-aucpr:0.32120	val-logloss:0.48091	val-auc:0.68255	val-aucpr:0.19783
[72]	train-logloss:0.57435	train-auc:0.70943	train-aucpr:0.32168	val-logloss:0.47982	val-auc:0.68344	val-aucpr:0.19923
[2025-11-19 09:26:28,144] [INFO] [<frozen importlib] - Training completed at iteration 42
[2025-11-19 09:26:28,144] [INFO] [<frozen importlib] - Best train loss: 0.5863
[2025-11-19 09:26:28,144] [INFO] [<frozen importlib] - Best val loss: 0.4917
[2025-11-19 09:26:28,144] [INFO] [<frozen importlib] - Best val AUC: 0.7048
[2025-11-19 09:26:28,144] [INFO] [<frozen importlib] - Best val AUCPR: 0.2240
[2025-11-19 09:26:28,148] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:26:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:26:35,162] [INFO] [<frozen importlib] - Optimal threshold: 0.4529
[2025-11-19 09:26:35,163] [INFO] [<frozen importlib] - Best f1: 0.2749
[2025-11-19 09:26:35,163] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:26:35,206] [INFO] [<frozen importlib] - Validation Results (threshold=0.4529):
[2025-11-19 09:26:35,206] [INFO] [<frozen importlib] -   Accuracy: 0.8973
[2025-11-19 09:26:35,206] [INFO] [<frozen importlib] -   Precision: 0.3004
[2025-11-19 09:26:35,206] [INFO] [<frozen importlib] -   Recall: 0.2534
[2025-11-19 09:26:35,206] [INFO] [<frozen importlib] -   F1 Score: 0.2749
[2025-11-19 09:26:35,206] [INFO] [<frozen importlib] -   AUROC: 0.7048
[2025-11-19 09:26:35,206] [INFO] [<frozen importlib] -   AUPRC: 0.2241
[2025-11-19 09:26:35,206] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:26:35,206] [INFO] [<frozen importlib] -     TN=16588, FP=857
[2025-11-19 09:26:35,206] [INFO] [<frozen importlib] -     FN=1084, TP=368
[2025-11-19 09:26:35,229] [INFO] [<frozen importlib] - Trial 383: AUPRC=0.2241, F1=0.4498, Prec=0.4388, Rec=0.4614 | Optimizing auprc=0.2241
[2025-11-19 09:26:35,229] [INFO] [<frozen importlib] - Trial 383 pruned.
[2025-11-19 09:26:35,230] [ERROR] [<frozen importlib] - Trial 383 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  77%|███████▋  | 383/500 [1:04:33<21:40, 11.11s/it]Best trial: 289. Best value: 0.241792:  77%|███████▋  | 383/500 [1:04:33<21:40, 11.11s/it]Best trial: 289. Best value: 0.241792:  77%|███████▋  | 384/500 [1:04:33<19:19,  9.99s/it][2025-11-19 09:26:35,252] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.49530103196348
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   gamma: 0.335387354534615
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   alpha: 0.49709887402050934
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   lambda: 4.219370165547733
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   learning_rate: 0.0347154124495163
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   subsample: 0.8301871123838438
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   colsample_bytree: 0.6238359457843593
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   colsample_bylevel: 0.6418366358750479
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   colsample_bynode: 0.7874003991854256
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:26:35,253] [INFO] [<frozen importlib] -   scale_pos_weight: 6.49530103196348
[2025-11-19 09:26:35,334] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:26:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:26:35,230] Trial 383 pruned. 
[0]	train-logloss:0.67167	train-auc:0.64283	train-aucpr:0.23040	val-logloss:0.66419	val-auc:0.63948	val-aucpr:0.15619
[10]	train-logloss:0.64924	train-auc:0.67789	train-aucpr:0.28963	val-logloss:0.60312	val-auc:0.70890	val-aucpr:0.20460
[20]	train-logloss:0.63476	train-auc:0.68657	train-aucpr:0.29802	val-logloss:0.56717	val-auc:0.69994	val-aucpr:0.20921
[30]	train-logloss:0.62475	train-auc:0.69247	train-aucpr:0.30370	val-logloss:0.54205	val-auc:0.69769	val-aucpr:0.21552
[40]	train-logloss:0.61751	train-auc:0.69628	train-aucpr:0.30843	val-logloss:0.52701	val-auc:0.69773	val-aucpr:0.21767
[50]	train-logloss:0.61185	train-auc:0.70014	train-aucpr:0.31308	val-logloss:0.51820	val-auc:0.69840	val-aucpr:0.22155
[60]	train-logloss:0.60774	train-auc:0.70308	train-aucpr:0.31719	val-logloss:0.50972	val-auc:0.70203	val-aucpr:0.22837
[70]	train-logloss:0.60420	train-auc:0.70748	train-aucpr:0.32048	val-logloss:0.50376	val-auc:0.70205	val-aucpr:0.22432
[80]	train-logloss:0.60140	train-auc:0.71034	train-aucpr:0.32403	val-logloss:0.49539	val-auc:0.70099	val-aucpr:0.22556
[89]	train-logloss:0.59899	train-auc:0.71346	train-aucpr:0.32697	val-logloss:0.49480	val-auc:0.70272	val-aucpr:0.22120
[2025-11-19 09:26:35,594] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:26:35,594] [INFO] [<frozen importlib] - Best train loss: 0.6077
[2025-11-19 09:26:35,594] [INFO] [<frozen importlib] - Best val loss: 0.5097
[2025-11-19 09:26:35,594] [INFO] [<frozen importlib] - Best val AUC: 0.7020
[2025-11-19 09:26:35,594] [INFO] [<frozen importlib] - Best val AUCPR: 0.2284
[2025-11-19 09:26:35,598] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:26:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:26:46,219] [INFO] [<frozen importlib] - Optimal threshold: 0.4875
[2025-11-19 09:26:46,219] [INFO] [<frozen importlib] - Best f1: 0.2748
[2025-11-19 09:26:46,219] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:26:46,277] [INFO] [<frozen importlib] - Validation Results (threshold=0.4875):
[2025-11-19 09:26:46,277] [INFO] [<frozen importlib] -   Accuracy: 0.8955
[2025-11-19 09:26:46,277] [INFO] [<frozen importlib] -   Precision: 0.2945
[2025-11-19 09:26:46,277] [INFO] [<frozen importlib] -   Recall: 0.2576
[2025-11-19 09:26:46,277] [INFO] [<frozen importlib] -   F1 Score: 0.2748
[2025-11-19 09:26:46,277] [INFO] [<frozen importlib] -   AUROC: 0.7020
[2025-11-19 09:26:46,277] [INFO] [<frozen importlib] -   AUPRC: 0.2287
[2025-11-19 09:26:46,277] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:26:46,277] [INFO] [<frozen importlib] -     TN=16549, FP=896
[2025-11-19 09:26:46,277] [INFO] [<frozen importlib] -     FN=1078, TP=374
[2025-11-19 09:26:46,302] [INFO] [<frozen importlib] - Trial 384: AUPRC=0.2287, F1=0.4558, Prec=0.4361, Rec=0.4773 | Optimizing auprc=0.2287
[2025-11-19 09:26:46,303] [INFO] [<frozen importlib] - Trial 384 pruned.
[2025-11-19 09:26:46,303] [ERROR] [<frozen importlib] - Trial 384 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  77%|███████▋  | 384/500 [1:04:44<19:19,  9.99s/it]Best trial: 289. Best value: 0.241792:  77%|███████▋  | 384/500 [1:04:44<19:19,  9.99s/it]Best trial: 289. Best value: 0.241792:  77%|███████▋  | 385/500 [1:04:44<19:46, 10.32s/it][2025-11-19 09:26:46,317] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.559037103922555
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   gamma: 0.19231474494497836
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   alpha: 0.570874095314003
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   lambda: 1.06555239870028
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   learning_rate: 0.10842826962981732
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   subsample: 0.7872099848068352
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   colsample_bytree: 0.5774885451689811
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5251268041352889
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   colsample_bynode: 0.8016976405967071
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:26:46,317] [INFO] [<frozen importlib] -   scale_pos_weight: 5.559037103922555
[2025-11-19 09:26:46,389] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:26:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:26:46,303] Trial 384 pruned. 
[0]	train-logloss:0.61435	train-auc:0.63904	train-aucpr:0.22890	val-logloss:0.59539	val-auc:0.62017	val-aucpr:0.12178
[10]	train-logloss:0.57462	train-auc:0.69052	train-aucpr:0.30104	val-logloss:0.49665	val-auc:0.67775	val-aucpr:0.18362
[20]	train-logloss:0.55949	train-auc:0.70866	train-aucpr:0.31807	val-logloss:0.47049	val-auc:0.67270	val-aucpr:0.18887
[30]	train-logloss:0.55149	train-auc:0.71721	train-aucpr:0.32874	val-logloss:0.46381	val-auc:0.68081	val-aucpr:0.20132
[40]	train-logloss:0.54621	train-auc:0.72716	train-aucpr:0.33737	val-logloss:0.45387	val-auc:0.68170	val-aucpr:0.19741
[42]	train-logloss:0.54447	train-auc:0.72959	train-aucpr:0.33935	val-logloss:0.45477	val-auc:0.68270	val-aucpr:0.19146
[2025-11-19 09:26:46,830] [INFO] [<frozen importlib] - Training completed at iteration 13
[2025-11-19 09:26:46,830] [INFO] [<frozen importlib] - Best train loss: 0.5690
[2025-11-19 09:26:46,830] [INFO] [<frozen importlib] - Best val loss: 0.4968
[2025-11-19 09:26:46,830] [INFO] [<frozen importlib] - Best val AUC: 0.6852
[2025-11-19 09:26:46,830] [INFO] [<frozen importlib] - Best val AUCPR: 0.2098
[2025-11-19 09:26:46,834] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:26:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:26:50,294] [INFO] [<frozen importlib] - Optimal threshold: 0.4684
[2025-11-19 09:26:50,294] [INFO] [<frozen importlib] - Best f1: 0.2534
[2025-11-19 09:26:50,294] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:26:50,338] [INFO] [<frozen importlib] - Validation Results (threshold=0.4684):
[2025-11-19 09:26:50,338] [INFO] [<frozen importlib] -   Accuracy: 0.8996
[2025-11-19 09:26:50,338] [INFO] [<frozen importlib] -   Precision: 0.2957
[2025-11-19 09:26:50,338] [INFO] [<frozen importlib] -   Recall: 0.2218
[2025-11-19 09:26:50,338] [INFO] [<frozen importlib] -   F1 Score: 0.2534
[2025-11-19 09:26:50,338] [INFO] [<frozen importlib] -   AUROC: 0.6852
[2025-11-19 09:26:50,338] [INFO] [<frozen importlib] -   AUPRC: 0.2098
[2025-11-19 09:26:50,338] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:26:50,338] [INFO] [<frozen importlib] -     TN=16678, FP=767
[2025-11-19 09:26:50,338] [INFO] [<frozen importlib] -     FN=1130, TP=322
[2025-11-19 09:26:50,362] [INFO] [<frozen importlib] - Trial 385: AUPRC=0.2098, F1=0.4542, Prec=0.4595, Rec=0.4490 | Optimizing auprc=0.2098
[2025-11-19 09:26:50,362] [INFO] [<frozen importlib] - Trial 385 pruned.
[2025-11-19 09:26:50,362] [ERROR] [<frozen importlib] - Trial 385 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  77%|███████▋  | 385/500 [1:04:48<19:46, 10.32s/it]Best trial: 289. Best value: 0.241792:  77%|███████▋  | 385/500 [1:04:48<19:46, 10.32s/it]Best trial: 289. Best value: 0.241792:  77%|███████▋  | 386/500 [1:04:48<16:02,  8.44s/it][2025-11-19 09:26:50,375] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.226494411958248
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   gamma: 0.2367449206084642
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   alpha: 0.6725973088577164
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   lambda: 0.6539646427919243
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   learning_rate: 0.031635498946540885
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   subsample: 0.8143921775768427
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   colsample_bytree: 0.5203642508506704
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7244306651834302
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   colsample_bynode: 0.7703796933176121
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:26:50,375] [INFO] [<frozen importlib] -   scale_pos_weight: 6.226494411958248
[2025-11-19 09:26:50,445] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:26:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:26:50,362] Trial 385 pruned. 
[0]	train-logloss:0.65679	train-auc:0.65165	train-aucpr:0.23915	val-logloss:0.64664	val-auc:0.63988	val-aucpr:0.13747
[10]	train-logloss:0.63657	train-auc:0.67863	train-aucpr:0.29129	val-logloss:0.59711	val-auc:0.67016	val-aucpr:0.19498
[20]	train-logloss:0.62304	train-auc:0.68747	train-aucpr:0.30068	val-logloss:0.56819	val-auc:0.69753	val-aucpr:0.20661
[30]	train-logloss:0.61370	train-auc:0.69178	train-aucpr:0.30461	val-logloss:0.53863	val-auc:0.69825	val-aucpr:0.20788
[40]	train-logloss:0.60660	train-auc:0.69513	train-aucpr:0.30884	val-logloss:0.51268	val-auc:0.69940	val-aucpr:0.21548
[50]	train-logloss:0.60092	train-auc:0.69896	train-aucpr:0.31243	val-logloss:0.50576	val-auc:0.70017	val-aucpr:0.21914
[60]	train-logloss:0.59674	train-auc:0.70279	train-aucpr:0.31598	val-logloss:0.49830	val-auc:0.69894	val-aucpr:0.22048
[70]	train-logloss:0.59318	train-auc:0.70471	train-aucpr:0.31957	val-logloss:0.48544	val-auc:0.70671	val-aucpr:0.22819
[80]	train-logloss:0.59032	train-auc:0.70829	train-aucpr:0.32238	val-logloss:0.47759	val-auc:0.70474	val-aucpr:0.22755
[90]	train-logloss:0.58776	train-auc:0.71149	train-aucpr:0.32528	val-logloss:0.47006	val-auc:0.70066	val-aucpr:0.22283
[100]	train-logloss:0.58531	train-auc:0.71497	train-aucpr:0.32874	val-logloss:0.45891	val-auc:0.70139	val-aucpr:0.22029
[103]	train-logloss:0.58446	train-auc:0.71588	train-aucpr:0.32987	val-logloss:0.45788	val-auc:0.70268	val-aucpr:0.22095
[2025-11-19 09:26:52,631] [INFO] [<frozen importlib] - Training completed at iteration 74
[2025-11-19 09:26:52,631] [INFO] [<frozen importlib] - Best train loss: 0.5923
[2025-11-19 09:26:52,631] [INFO] [<frozen importlib] - Best val loss: 0.4820
[2025-11-19 09:26:52,631] [INFO] [<frozen importlib] - Best val AUC: 0.7064
[2025-11-19 09:26:52,631] [INFO] [<frozen importlib] - Best val AUCPR: 0.2294
[2025-11-19 09:26:52,634] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:26:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:27:05,493] [INFO] [<frozen importlib] - Optimal threshold: 0.4689
[2025-11-19 09:27:05,493] [INFO] [<frozen importlib] - Best f1: 0.2760
[2025-11-19 09:27:05,493] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:27:05,547] [INFO] [<frozen importlib] - Validation Results (threshold=0.4689):
[2025-11-19 09:27:05,547] [INFO] [<frozen importlib] -   Accuracy: 0.8975
[2025-11-19 09:27:05,547] [INFO] [<frozen importlib] -   Precision: 0.3020
[2025-11-19 09:27:05,547] [INFO] [<frozen importlib] -   Recall: 0.2541
[2025-11-19 09:27:05,547] [INFO] [<frozen importlib] -   F1 Score: 0.2760
[2025-11-19 09:27:05,547] [INFO] [<frozen importlib] -   AUROC: 0.7064
[2025-11-19 09:27:05,547] [INFO] [<frozen importlib] -   AUPRC: 0.2298
[2025-11-19 09:27:05,547] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:27:05,547] [INFO] [<frozen importlib] -     TN=16592, FP=853
[2025-11-19 09:27:05,547] [INFO] [<frozen importlib] -     FN=1083, TP=369
[2025-11-19 09:27:05,573] [INFO] [<frozen importlib] - Trial 386: AUPRC=0.2298, F1=0.4415, Prec=0.4336, Rec=0.4497 | Optimizing auprc=0.2298
                                                                                          Best trial: 289. Best value: 0.241792:  77%|███████▋  | 386/500 [1:05:03<16:02,  8.44s/it]Best trial: 289. Best value: 0.241792:  77%|███████▋  | 386/500 [1:05:03<16:02,  8.44s/it]Best trial: 289. Best value: 0.241792:  77%|███████▋  | 387/500 [1:05:03<19:43, 10.47s/it][2025-11-19 09:27:05,586] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 19.95786296598284
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   gamma: 0.3114759959812363
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   alpha: 0.2729084743067033
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   lambda: 1.3306944951070507
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   learning_rate: 0.04098873422536483
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   subsample: 0.8511821444027138
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   colsample_bytree: 0.5928267102314073
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5741356416374264
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   colsample_bynode: 0.8280745843335009
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:27:05,586] [INFO] [<frozen importlib] -   scale_pos_weight: 19.95786296598284
[2025-11-19 09:27:05,661] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:27:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:27:05,573] Trial 386 finished with value: 0.22976723756504197 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.2367449206084642, 'learning_rate': 0.031635498946540885, 'n_estimators': 250, 'alpha': 0.6725973088577164, 'lambda': 0.6539646427919243, 'subsample': 0.8143921775768427, 'colsample_bytree': 0.5203642508506704, 'colsample_bylevel': 0.7244306651834302, 'colsample_bynode': 0.7703796933176121, 'scale_pos_weight': 6.226494411958248}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:1.16720	train-auc:0.64826	train-aucpr:0.23898	val-logloss:1.20274	val-auc:0.58210	val-aucpr:0.11526
[10]	train-logloss:1.13094	train-auc:0.68365	train-aucpr:0.28192	val-logloss:1.08881	val-auc:0.68182	val-aucpr:0.18881
[20]	train-logloss:1.11254	train-auc:0.69239	train-aucpr:0.29648	val-logloss:1.03060	val-auc:0.69692	val-aucpr:0.20888
[30]	train-logloss:1.10125	train-auc:0.69772	train-aucpr:0.30166	val-logloss:0.97188	val-auc:0.69909	val-aucpr:0.22134
[40]	train-logloss:1.09426	train-auc:0.70087	train-aucpr:0.30526	val-logloss:0.93605	val-auc:0.70162	val-aucpr:0.21635
[50]	train-logloss:1.08628	train-auc:0.70648	train-aucpr:0.31121	val-logloss:0.89861	val-auc:0.69425	val-aucpr:0.21502
[60]	train-logloss:1.08063	train-auc:0.71131	train-aucpr:0.31682	val-logloss:0.88308	val-auc:0.69593	val-aucpr:0.21299
[64]	train-logloss:1.07818	train-auc:0.71310	train-aucpr:0.31894	val-logloss:0.88008	val-auc:0.69502	val-aucpr:0.20918
[2025-11-19 09:27:07,126] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 09:27:07,126] [INFO] [<frozen importlib] - Best train loss: 1.0983
[2025-11-19 09:27:07,126] [INFO] [<frozen importlib] - Best val loss: 0.9603
[2025-11-19 09:27:07,126] [INFO] [<frozen importlib] - Best val AUC: 0.7030
[2025-11-19 09:27:07,126] [INFO] [<frozen importlib] - Best val AUCPR: 0.2233
[2025-11-19 09:27:07,129] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:27:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:27:13,810] [INFO] [<frozen importlib] - Optimal threshold: 0.7271
[2025-11-19 09:27:13,810] [INFO] [<frozen importlib] - Best f1: 0.2705
[2025-11-19 09:27:13,810] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:27:13,852] [INFO] [<frozen importlib] - Validation Results (threshold=0.7271):
[2025-11-19 09:27:13,852] [INFO] [<frozen importlib] -   Accuracy: 0.9029
[2025-11-19 09:27:13,852] [INFO] [<frozen importlib] -   Precision: 0.3202
[2025-11-19 09:27:13,852] [INFO] [<frozen importlib] -   Recall: 0.2342
[2025-11-19 09:27:13,852] [INFO] [<frozen importlib] -   F1 Score: 0.2705
[2025-11-19 09:27:13,852] [INFO] [<frozen importlib] -   AUROC: 0.7030
[2025-11-19 09:27:13,852] [INFO] [<frozen importlib] -   AUPRC: 0.2234
[2025-11-19 09:27:13,852] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:27:13,852] [INFO] [<frozen importlib] -     TN=16723, FP=722
[2025-11-19 09:27:13,852] [INFO] [<frozen importlib] -     FN=1112, TP=340
[2025-11-19 09:27:13,876] [INFO] [<frozen importlib] - Trial 387: AUPRC=0.2234, F1=0.4549, Prec=0.4699, Rec=0.4408 | Optimizing auprc=0.2234
[2025-11-19 09:27:13,877] [INFO] [<frozen importlib] - Trial 387 pruned.
[2025-11-19 09:27:13,877] [ERROR] [<frozen importlib] - Trial 387 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  77%|███████▋  | 387/500 [1:05:11<19:43, 10.47s/it]Best trial: 289. Best value: 0.241792:  77%|███████▋  | 387/500 [1:05:11<19:43, 10.47s/it]Best trial: 289. Best value: 0.241792:  78%|███████▊  | 388/500 [1:05:11<18:19,  9.82s/it][2025-11-19 09:27:13,890] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 12.359570880271368
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   gamma: 0.157163280618062
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   alpha: 0.43041904629011996
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   lambda: 0.8104131580588815
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   learning_rate: 0.0391445934425403
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   subsample: 0.799744010885117
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   colsample_bytree: 0.5637924134126595
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5434779500157318
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   colsample_bynode: 0.7354058291770482
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:27:13,890] [INFO] [<frozen importlib] -   scale_pos_weight: 12.359570880271368
[2025-11-19 09:27:13,965] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:27:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:27:13,877] Trial 387 pruned. 
[0]	train-logloss:0.94365	train-auc:0.63322	train-aucpr:0.22324	val-logloss:0.96629	val-auc:0.59363	val-aucpr:0.10493
[10]	train-logloss:0.90871	train-auc:0.68064	train-aucpr:0.28795	val-logloss:0.86720	val-auc:0.68842	val-aucpr:0.19829
[20]	train-logloss:0.88836	train-auc:0.68846	train-aucpr:0.29571	val-logloss:0.81473	val-auc:0.69215	val-aucpr:0.20829
[30]	train-logloss:0.87477	train-auc:0.69362	train-aucpr:0.30311	val-logloss:0.77022	val-auc:0.69307	val-aucpr:0.21186
[40]	train-logloss:0.86486	train-auc:0.69869	train-aucpr:0.30702	val-logloss:0.73882	val-auc:0.69474	val-aucpr:0.21643
[50]	train-logloss:0.85640	train-auc:0.70398	train-aucpr:0.31124	val-logloss:0.73366	val-auc:0.69624	val-aucpr:0.21694
[60]	train-logloss:0.85049	train-auc:0.70778	train-aucpr:0.31537	val-logloss:0.73170	val-auc:0.69632	val-aucpr:0.22055
[70]	train-logloss:0.84483	train-auc:0.71224	train-aucpr:0.32021	val-logloss:0.72144	val-auc:0.69446	val-aucpr:0.21853
[78]	train-logloss:0.84120	train-auc:0.71537	train-aucpr:0.32357	val-logloss:0.71088	val-auc:0.68783	val-aucpr:0.20634
[2025-11-19 09:27:14,557] [INFO] [<frozen importlib] - Training completed at iteration 48
[2025-11-19 09:27:14,557] [INFO] [<frozen importlib] - Best train loss: 0.8576
[2025-11-19 09:27:14,557] [INFO] [<frozen importlib] - Best val loss: 0.7402
[2025-11-19 09:27:14,557] [INFO] [<frozen importlib] - Best val AUC: 0.6987
[2025-11-19 09:27:14,557] [INFO] [<frozen importlib] - Best val AUCPR: 0.2215
[2025-11-19 09:27:14,561] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:27:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:27:26,576] [INFO] [<frozen importlib] - Optimal threshold: 0.6324
[2025-11-19 09:27:26,576] [INFO] [<frozen importlib] - Best f1: 0.2703
[2025-11-19 09:27:26,576] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:27:26,619] [INFO] [<frozen importlib] - Validation Results (threshold=0.6324):
[2025-11-19 09:27:26,619] [INFO] [<frozen importlib] -   Accuracy: 0.8894
[2025-11-19 09:27:26,619] [INFO] [<frozen importlib] -   Precision: 0.2741
[2025-11-19 09:27:26,619] [INFO] [<frozen importlib] -   Recall: 0.2665
[2025-11-19 09:27:26,619] [INFO] [<frozen importlib] -   F1 Score: 0.2703
[2025-11-19 09:27:26,619] [INFO] [<frozen importlib] -   AUROC: 0.6987
[2025-11-19 09:27:26,619] [INFO] [<frozen importlib] -   AUPRC: 0.2220
[2025-11-19 09:27:26,619] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:27:26,619] [INFO] [<frozen importlib] -     TN=16420, FP=1025
[2025-11-19 09:27:26,619] [INFO] [<frozen importlib] -     FN=1065, TP=387
[2025-11-19 09:27:26,641] [INFO] [<frozen importlib] - Trial 388: AUPRC=0.2220, F1=0.4509, Prec=0.4129, Rec=0.4966 | Optimizing auprc=0.2220
[2025-11-19 09:27:26,642] [INFO] [<frozen importlib] - Trial 388 pruned.
[2025-11-19 09:27:26,642] [ERROR] [<frozen importlib] - Trial 388 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  78%|███████▊  | 388/500 [1:05:24<18:19,  9.82s/it]Best trial: 289. Best value: 0.241792:  78%|███████▊  | 388/500 [1:05:24<18:19,  9.82s/it]Best trial: 289. Best value: 0.241792:  78%|███████▊  | 389/500 [1:05:24<19:48, 10.70s/it][2025-11-19 09:27:26,655] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.435509436367209
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   gamma: 0.28094526809386755
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   alpha: 0.5399231416802838
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   lambda: 0.9727550660848646
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   learning_rate: 0.03360876533223998
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   subsample: 0.8212932797412653
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   colsample_bytree: 0.5822876503009499
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5001167274821015
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   colsample_bynode: 0.7539625339166615
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:27:26,655] [INFO] [<frozen importlib] -   scale_pos_weight: 7.435509436367209
[2025-11-19 09:27:26,726] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:27:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:27:26,642] Trial 388 pruned. 
[0]	train-logloss:0.72228	train-auc:0.64684	train-aucpr:0.22154	val-logloss:0.72207	val-auc:0.64383	val-aucpr:0.12190
[10]	train-logloss:0.69845	train-auc:0.68141	train-aucpr:0.28617	val-logloss:0.67007	val-auc:0.70937	val-aucpr:0.19687
[20]	train-logloss:0.68363	train-auc:0.68784	train-aucpr:0.29503	val-logloss:0.63537	val-auc:0.70902	val-aucpr:0.20471
[30]	train-logloss:0.67313	train-auc:0.69204	train-aucpr:0.30026	val-logloss:0.60090	val-auc:0.70723	val-aucpr:0.21367
[40]	train-logloss:0.66558	train-auc:0.69502	train-aucpr:0.30353	val-logloss:0.57252	val-auc:0.70690	val-aucpr:0.21987
[50]	train-logloss:0.65863	train-auc:0.70120	train-aucpr:0.30907	val-logloss:0.57294	val-auc:0.70512	val-aucpr:0.22073
[60]	train-logloss:0.65396	train-auc:0.70476	train-aucpr:0.31250	val-logloss:0.57115	val-auc:0.70257	val-aucpr:0.21926
[70]	train-logloss:0.65022	train-auc:0.70770	train-aucpr:0.31617	val-logloss:0.56492	val-auc:0.69526	val-aucpr:0.20599
[76]	train-logloss:0.64837	train-auc:0.70875	train-aucpr:0.31883	val-logloss:0.56153	val-auc:0.69524	val-aucpr:0.20607
[2025-11-19 09:27:26,953] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 09:27:26,953] [INFO] [<frozen importlib] - Best train loss: 0.6603
[2025-11-19 09:27:26,953] [INFO] [<frozen importlib] - Best val loss: 0.5703
[2025-11-19 09:27:26,953] [INFO] [<frozen importlib] - Best val AUC: 0.7060
[2025-11-19 09:27:26,953] [INFO] [<frozen importlib] - Best val AUCPR: 0.2242
[2025-11-19 09:27:26,957] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:27:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:27:39,054] [INFO] [<frozen importlib] - Optimal threshold: 0.5210
[2025-11-19 09:27:39,054] [INFO] [<frozen importlib] - Best f1: 0.2672
[2025-11-19 09:27:39,054] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:27:39,097] [INFO] [<frozen importlib] - Validation Results (threshold=0.5210):
[2025-11-19 09:27:39,097] [INFO] [<frozen importlib] -   Accuracy: 0.8975
[2025-11-19 09:27:39,098] [INFO] [<frozen importlib] -   Precision: 0.2966
[2025-11-19 09:27:39,098] [INFO] [<frozen importlib] -   Recall: 0.2431
[2025-11-19 09:27:39,098] [INFO] [<frozen importlib] -   F1 Score: 0.2672
[2025-11-19 09:27:39,098] [INFO] [<frozen importlib] -   AUROC: 0.7060
[2025-11-19 09:27:39,098] [INFO] [<frozen importlib] -   AUPRC: 0.2245
[2025-11-19 09:27:39,098] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:27:39,098] [INFO] [<frozen importlib] -     TN=16608, FP=837
[2025-11-19 09:27:39,098] [INFO] [<frozen importlib] -     FN=1099, TP=353
[2025-11-19 09:27:39,124] [INFO] [<frozen importlib] - Trial 389: AUPRC=0.2245, F1=0.4648, Prec=0.4529, Rec=0.4773 | Optimizing auprc=0.2245
[2025-11-19 09:27:39,124] [INFO] [<frozen importlib] - Trial 389 pruned.
[2025-11-19 09:27:39,124] [ERROR] [<frozen importlib] - Trial 389 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  78%|███████▊  | 389/500 [1:05:37<19:48, 10.70s/it]Best trial: 289. Best value: 0.241792:  78%|███████▊  | 389/500 [1:05:37<19:48, 10.70s/it]Best trial: 289. Best value: 0.241792:  78%|███████▊  | 390/500 [1:05:37<20:36, 11.24s/it][2025-11-19 09:27:39,138] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.046102780681584
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   max_depth: 5
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   gamma: 0.6913501358720352
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   alpha: 0.3200193676924136
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   lambda: 1.1490380203661898
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   learning_rate: 0.037333589862938575
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   subsample: 0.8383553927790118
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   colsample_bytree: 0.6453622675884165
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5118356154968496
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   colsample_bynode: 0.7847749838262258
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:27:39,138] [INFO] [<frozen importlib] -   scale_pos_weight: 7.046102780681584
[2025-11-19 09:27:39,212] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:27:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:27:39,124] Trial 389 pruned. 
[0]	train-logloss:0.70069	train-auc:0.66321	train-aucpr:0.25561	val-logloss:0.69739	val-auc:0.64443	val-aucpr:0.12230
[10]	train-logloss:0.67135	train-auc:0.69789	train-aucpr:0.30821	val-logloss:0.63325	val-auc:0.67933	val-aucpr:0.18741
[20]	train-logloss:0.65298	train-auc:0.70660	train-aucpr:0.31874	val-logloss:0.58235	val-auc:0.68834	val-aucpr:0.20718
[30]	train-logloss:0.64071	train-auc:0.71186	train-aucpr:0.32665	val-logloss:0.55205	val-auc:0.69348	val-aucpr:0.21564
[40]	train-logloss:0.63245	train-auc:0.71554	train-aucpr:0.33189	val-logloss:0.53694	val-auc:0.69516	val-aucpr:0.22282
[50]	train-logloss:0.62543	train-auc:0.72137	train-aucpr:0.33808	val-logloss:0.52935	val-auc:0.69643	val-aucpr:0.22022
[60]	train-logloss:0.62025	train-auc:0.72604	train-aucpr:0.34348	val-logloss:0.51188	val-auc:0.69199	val-aucpr:0.21562
[68]	train-logloss:0.61672	train-auc:0.73039	train-aucpr:0.34778	val-logloss:0.51246	val-auc:0.68785	val-aucpr:0.20967
[2025-11-19 09:27:39,482] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 09:27:39,482] [INFO] [<frozen importlib] - Best train loss: 0.6332
[2025-11-19 09:27:39,482] [INFO] [<frozen importlib] - Best val loss: 0.5354
[2025-11-19 09:27:39,482] [INFO] [<frozen importlib] - Best val AUC: 0.6938
[2025-11-19 09:27:39,482] [INFO] [<frozen importlib] - Best val AUCPR: 0.2232
[2025-11-19 09:27:39,486] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:27:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:27:50,791] [INFO] [<frozen importlib] - Optimal threshold: 0.4910
[2025-11-19 09:27:50,791] [INFO] [<frozen importlib] - Best f1: 0.2559
[2025-11-19 09:27:50,791] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:27:50,841] [INFO] [<frozen importlib] - Validation Results (threshold=0.4910):
[2025-11-19 09:27:50,841] [INFO] [<frozen importlib] -   Accuracy: 0.8889
[2025-11-19 09:27:50,841] [INFO] [<frozen importlib] -   Precision: 0.2637
[2025-11-19 09:27:50,841] [INFO] [<frozen importlib] -   Recall: 0.2486
[2025-11-19 09:27:50,841] [INFO] [<frozen importlib] -   F1 Score: 0.2559
[2025-11-19 09:27:50,841] [INFO] [<frozen importlib] -   AUROC: 0.6938
[2025-11-19 09:27:50,841] [INFO] [<frozen importlib] -   AUPRC: 0.2236
[2025-11-19 09:27:50,841] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:27:50,841] [INFO] [<frozen importlib] -     TN=16437, FP=1008
[2025-11-19 09:27:50,841] [INFO] [<frozen importlib] -     FN=1091, TP=361
[2025-11-19 09:27:50,866] [INFO] [<frozen importlib] - Trial 390: AUPRC=0.2236, F1=0.4160, Prec=0.3906, Rec=0.4449 | Optimizing auprc=0.2236
[2025-11-19 09:27:50,866] [INFO] [<frozen importlib] - Trial 390 pruned.
[2025-11-19 09:27:50,866] [ERROR] [<frozen importlib] - Trial 390 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  78%|███████▊  | 390/500 [1:05:48<20:36, 11.24s/it]Best trial: 289. Best value: 0.241792:  78%|███████▊  | 390/500 [1:05:48<20:36, 11.24s/it]Best trial: 289. Best value: 0.241792:  78%|███████▊  | 391/500 [1:05:48<20:41, 11.39s/it][2025-11-19 09:27:50,889] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.870819679131416
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   gamma: 0.1729835039668748
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   alpha: 0.512990762564707
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   lambda: 1.5195892652497975
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   learning_rate: 0.044896294164312546
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   subsample: 0.8301364467735837
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   colsample_bytree: 0.6112276311437906
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5324542057293185
[2025-11-19 09:27:50,889] [INFO] [<frozen importlib] -   colsample_bynode: 0.7635251010559663
[2025-11-19 09:27:50,890] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:27:50,890] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:27:50,890] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:27:50,890] [INFO] [<frozen importlib] -   scale_pos_weight: 5.870819679131416
[2025-11-19 09:27:50,964] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:27:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:27:50,866] Trial 390 pruned. 
[0]	train-logloss:0.63608	train-auc:0.64413	train-aucpr:0.25180	val-logloss:0.62516	val-auc:0.58339	val-aucpr:0.11526
[10]	train-logloss:0.61064	train-auc:0.68253	train-aucpr:0.29614	val-logloss:0.56184	val-auc:0.70136	val-aucpr:0.20373
[20]	train-logloss:0.59579	train-auc:0.68862	train-aucpr:0.30458	val-logloss:0.52448	val-auc:0.69838	val-aucpr:0.20434
[30]	train-logloss:0.58681	train-auc:0.69625	train-aucpr:0.30961	val-logloss:0.50323	val-auc:0.69810	val-aucpr:0.21394
[40]	train-logloss:0.58039	train-auc:0.70056	train-aucpr:0.31394	val-logloss:0.48783	val-auc:0.69225	val-aucpr:0.20765
[50]	train-logloss:0.57527	train-auc:0.70484	train-aucpr:0.31860	val-logloss:0.47953	val-auc:0.69666	val-aucpr:0.21306
[60]	train-logloss:0.57196	train-auc:0.70825	train-aucpr:0.32258	val-logloss:0.47238	val-auc:0.69670	val-aucpr:0.21708
[70]	train-logloss:0.56836	train-auc:0.71343	train-aucpr:0.32783	val-logloss:0.45475	val-auc:0.69812	val-aucpr:0.22023
[80]	train-logloss:0.56513	train-auc:0.71799	train-aucpr:0.33319	val-logloss:0.45102	val-auc:0.68985	val-aucpr:0.21168
[90]	train-logloss:0.56266	train-auc:0.72238	train-aucpr:0.33695	val-logloss:0.45227	val-auc:0.69067	val-aucpr:0.20682
[99]	train-logloss:0.56098	train-auc:0.72557	train-aucpr:0.34038	val-logloss:0.45404	val-auc:0.69097	val-aucpr:0.20722
[2025-11-19 09:27:51,248] [INFO] [<frozen importlib] - Training completed at iteration 70
[2025-11-19 09:27:51,248] [INFO] [<frozen importlib] - Best train loss: 0.5684
[2025-11-19 09:27:51,248] [INFO] [<frozen importlib] - Best val loss: 0.4547
[2025-11-19 09:27:51,248] [INFO] [<frozen importlib] - Best val AUC: 0.6981
[2025-11-19 09:27:51,248] [INFO] [<frozen importlib] - Best val AUCPR: 0.2202
[2025-11-19 09:27:51,253] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:27:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:28:05,258] [INFO] [<frozen importlib] - Optimal threshold: 0.4592
[2025-11-19 09:28:05,258] [INFO] [<frozen importlib] - Best f1: 0.2663
[2025-11-19 09:28:05,258] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:28:05,302] [INFO] [<frozen importlib] - Validation Results (threshold=0.4592):
[2025-11-19 09:28:05,302] [INFO] [<frozen importlib] -   Accuracy: 0.9023
[2025-11-19 09:28:05,302] [INFO] [<frozen importlib] -   Precision: 0.3148
[2025-11-19 09:28:05,302] [INFO] [<frozen importlib] -   Recall: 0.2307
[2025-11-19 09:28:05,302] [INFO] [<frozen importlib] -   F1 Score: 0.2663
[2025-11-19 09:28:05,302] [INFO] [<frozen importlib] -   AUROC: 0.6981
[2025-11-19 09:28:05,302] [INFO] [<frozen importlib] -   AUPRC: 0.2207
[2025-11-19 09:28:05,302] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:28:05,302] [INFO] [<frozen importlib] -     TN=16716, FP=729
[2025-11-19 09:28:05,302] [INFO] [<frozen importlib] -     FN=1117, TP=335
[2025-11-19 09:28:05,325] [INFO] [<frozen importlib] - Trial 391: AUPRC=0.2207, F1=0.4510, Prec=0.4655, Rec=0.4373 | Optimizing auprc=0.2207
[2025-11-19 09:28:05,326] [INFO] [<frozen importlib] - Trial 391 pruned.
[2025-11-19 09:28:05,326] [ERROR] [<frozen importlib] - Trial 391 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  78%|███████▊  | 391/500 [1:06:03<20:41, 11.39s/it]Best trial: 289. Best value: 0.241792:  78%|███████▊  | 391/500 [1:06:03<20:41, 11.39s/it]Best trial: 289. Best value: 0.241792:  78%|███████▊  | 392/500 [1:06:03<22:09, 12.31s/it][2025-11-19 09:28:05,339] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.650877347017148
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   gamma: 0.21051595490945724
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   alpha: 0.6344820667346202
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   lambda: 0.7109710152281676
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   learning_rate: 0.04273571752938087
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   subsample: 0.782292851614512
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   colsample_bytree: 0.5984844143794347
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5189908332286611
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   colsample_bynode: 0.7966482279682023
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:28:05,339] [INFO] [<frozen importlib] -   scale_pos_weight: 6.650877347017148
[2025-11-19 09:28:05,408] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:28:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:28:05,326] Trial 391 pruned. 
[0]	train-logloss:0.67978	train-auc:0.63961	train-aucpr:0.22324	val-logloss:0.67212	val-auc:0.54401	val-aucpr:0.10255
[10]	train-logloss:0.65351	train-auc:0.68452	train-aucpr:0.29396	val-logloss:0.62186	val-auc:0.68740	val-aucpr:0.17545
[20]	train-logloss:0.63793	train-auc:0.68993	train-aucpr:0.30201	val-logloss:0.57940	val-auc:0.70773	val-aucpr:0.21219
[30]	train-logloss:0.62742	train-auc:0.69514	train-aucpr:0.30718	val-logloss:0.53573	val-auc:0.70796	val-aucpr:0.22275
[40]	train-logloss:0.62058	train-auc:0.69948	train-aucpr:0.31082	val-logloss:0.50965	val-auc:0.71147	val-aucpr:0.22621
[50]	train-logloss:0.61505	train-auc:0.70379	train-aucpr:0.31385	val-logloss:0.49807	val-auc:0.71583	val-aucpr:0.23494
[60]	train-logloss:0.61111	train-auc:0.70835	train-aucpr:0.31786	val-logloss:0.49179	val-auc:0.71581	val-aucpr:0.23549
[70]	train-logloss:0.60762	train-auc:0.71254	train-aucpr:0.32258	val-logloss:0.48065	val-auc:0.71219	val-aucpr:0.23473
[80]	train-logloss:0.60425	train-auc:0.71777	train-aucpr:0.32752	val-logloss:0.46753	val-auc:0.70863	val-aucpr:0.22459
[85]	train-logloss:0.60264	train-auc:0.71968	train-aucpr:0.32998	val-logloss:0.46675	val-auc:0.70362	val-aucpr:0.21189
[2025-11-19 09:28:05,663] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:28:05,663] [INFO] [<frozen importlib] - Best train loss: 0.6126
[2025-11-19 09:28:05,663] [INFO] [<frozen importlib] - Best val loss: 0.4928
[2025-11-19 09:28:05,663] [INFO] [<frozen importlib] - Best val AUC: 0.7173
[2025-11-19 09:28:05,663] [INFO] [<frozen importlib] - Best val AUCPR: 0.2364
[2025-11-19 09:28:05,667] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:28:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:28:18,998] [INFO] [<frozen importlib] - Optimal threshold: 0.4758
[2025-11-19 09:28:18,998] [INFO] [<frozen importlib] - Best f1: 0.2908
[2025-11-19 09:28:18,998] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:28:19,051] [INFO] [<frozen importlib] - Validation Results (threshold=0.4758):
[2025-11-19 09:28:19,051] [INFO] [<frozen importlib] -   Accuracy: 0.9014
[2025-11-19 09:28:19,051] [INFO] [<frozen importlib] -   Precision: 0.3251
[2025-11-19 09:28:19,051] [INFO] [<frozen importlib] -   Recall: 0.2631
[2025-11-19 09:28:19,051] [INFO] [<frozen importlib] -   F1 Score: 0.2908
[2025-11-19 09:28:19,051] [INFO] [<frozen importlib] -   AUROC: 0.7173
[2025-11-19 09:28:19,051] [INFO] [<frozen importlib] -   AUPRC: 0.2368
[2025-11-19 09:28:19,051] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:28:19,051] [INFO] [<frozen importlib] -     TN=16652, FP=793
[2025-11-19 09:28:19,051] [INFO] [<frozen importlib] -     FN=1070, TP=382
[2025-11-19 09:28:19,078] [INFO] [<frozen importlib] - Trial 392: AUPRC=0.2368, F1=0.4491, Prec=0.4505, Rec=0.4477 | Optimizing auprc=0.2368
                                                                                          Best trial: 289. Best value: 0.241792:  78%|███████▊  | 392/500 [1:06:17<22:09, 12.31s/it]Best trial: 289. Best value: 0.241792:  78%|███████▊  | 392/500 [1:06:17<22:09, 12.31s/it]Best trial: 289. Best value: 0.241792:  79%|███████▊  | 393/500 [1:06:17<22:43, 12.74s/it][2025-11-19 09:28:19,092] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.809926283366959
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   gamma: 0.10154494040879779
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   alpha: 0.651882426505741
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   lambda: 0.5814104706344628
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   learning_rate: 0.04268268841074882
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   subsample: 0.7811381915570755
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   colsample_bytree: 0.5287904947913683
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5093338643583948
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   colsample_bynode: 0.7785131148488093
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:28:19,092] [INFO] [<frozen importlib] -   scale_pos_weight: 6.809926283366959
[2025-11-19 09:28:19,164] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:28:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:28:19,078] Trial 392 finished with value: 0.23678335403027065 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.21051595490945724, 'learning_rate': 0.04273571752938087, 'n_estimators': 450, 'alpha': 0.6344820667346202, 'lambda': 0.7109710152281676, 'subsample': 0.782292851614512, 'colsample_bytree': 0.5984844143794347, 'colsample_bylevel': 0.5189908332286611, 'colsample_bynode': 0.7966482279682023, 'scale_pos_weight': 6.650877347017148}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.68858	train-auc:0.63237	train-aucpr:0.22261	val-logloss:0.68379	val-auc:0.64881	val-aucpr:0.13202
[10]	train-logloss:0.66221	train-auc:0.67785	train-aucpr:0.28744	val-logloss:0.61860	val-auc:0.69443	val-aucpr:0.20350
[20]	train-logloss:0.64678	train-auc:0.68646	train-aucpr:0.29725	val-logloss:0.57902	val-auc:0.69423	val-aucpr:0.21838
[30]	train-logloss:0.63698	train-auc:0.69090	train-aucpr:0.30198	val-logloss:0.54747	val-auc:0.69018	val-aucpr:0.22547
[40]	train-logloss:0.62956	train-auc:0.69759	train-aucpr:0.30775	val-logloss:0.54172	val-auc:0.70275	val-aucpr:0.22505
[50]	train-logloss:0.62351	train-auc:0.70256	train-aucpr:0.31227	val-logloss:0.53048	val-auc:0.70405	val-aucpr:0.22208
[58]	train-logloss:0.62020	train-auc:0.70516	train-aucpr:0.31632	val-logloss:0.51960	val-auc:0.70406	val-aucpr:0.22548
[2025-11-19 09:28:20,409] [INFO] [<frozen importlib] - Training completed at iteration 28
[2025-11-19 09:28:20,409] [INFO] [<frozen importlib] - Best train loss: 0.6387
[2025-11-19 09:28:20,409] [INFO] [<frozen importlib] - Best val loss: 0.5515
[2025-11-19 09:28:20,409] [INFO] [<frozen importlib] - Best val AUC: 0.6973
[2025-11-19 09:28:20,409] [INFO] [<frozen importlib] - Best val AUCPR: 0.2290
[2025-11-19 09:28:20,412] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:28:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:28:27,536] [INFO] [<frozen importlib] - Optimal threshold: 0.4983
[2025-11-19 09:28:27,536] [INFO] [<frozen importlib] - Best f1: 0.2758
[2025-11-19 09:28:27,536] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:28:27,600] [INFO] [<frozen importlib] - Validation Results (threshold=0.4983):
[2025-11-19 09:28:27,600] [INFO] [<frozen importlib] -   Accuracy: 0.8988
[2025-11-19 09:28:27,600] [INFO] [<frozen importlib] -   Precision: 0.3064
[2025-11-19 09:28:27,600] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 09:28:27,600] [INFO] [<frozen importlib] -   F1 Score: 0.2758
[2025-11-19 09:28:27,600] [INFO] [<frozen importlib] -   AUROC: 0.6973
[2025-11-19 09:28:27,600] [INFO] [<frozen importlib] -   AUPRC: 0.2293
[2025-11-19 09:28:27,600] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:28:27,600] [INFO] [<frozen importlib] -     TN=16621, FP=824
[2025-11-19 09:28:27,600] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 09:28:27,627] [INFO] [<frozen importlib] - Trial 393: AUPRC=0.2293, F1=0.4491, Prec=0.4444, Rec=0.4539 | Optimizing auprc=0.2293
                                                                                          Best trial: 289. Best value: 0.241792:  79%|███████▊  | 393/500 [1:06:25<22:43, 12.74s/it]Best trial: 289. Best value: 0.241792:  79%|███████▊  | 393/500 [1:06:25<22:43, 12.74s/it]Best trial: 289. Best value: 0.241792:  79%|███████▉  | 394/500 [1:06:25<20:17, 11.48s/it][2025-11-19 09:28:27,645] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.47132613215672
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   gamma: 0.214695147553638
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   alpha: 0.6249231981690785
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   lambda: 0.7165065202719445
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   learning_rate: 0.03517601463799313
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   subsample: 0.7831574327498567
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   colsample_bytree: 0.5088573612420504
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5542294780219087
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   colsample_bynode: 0.7930345121476066
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:28:27,645] [INFO] [<frozen importlib] -   scale_pos_weight: 7.47132613215672
[2025-11-19 09:28:27,724] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:28:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:28:27,627] Trial 393 finished with value: 0.2292721328698254 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.10154494040879779, 'learning_rate': 0.04268268841074882, 'n_estimators': 450, 'alpha': 0.651882426505741, 'lambda': 0.5814104706344628, 'subsample': 0.7811381915570755, 'colsample_bytree': 0.5287904947913683, 'colsample_bylevel': 0.5093338643583948, 'colsample_bynode': 0.7785131148488093, 'scale_pos_weight': 6.809926283366959}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.72419	train-auc:0.63600	train-aucpr:0.22330	val-logloss:0.72515	val-auc:0.64998	val-aucpr:0.13954
[10]	train-logloss:0.69972	train-auc:0.68269	train-aucpr:0.28510	val-logloss:0.66466	val-auc:0.68018	val-aucpr:0.20344
[20]	train-logloss:0.68398	train-auc:0.68854	train-aucpr:0.29829	val-logloss:0.61843	val-auc:0.70012	val-aucpr:0.21177
[30]	train-logloss:0.67336	train-auc:0.69100	train-aucpr:0.30239	val-logloss:0.59011	val-auc:0.68780	val-aucpr:0.21864
[40]	train-logloss:0.66569	train-auc:0.69585	train-aucpr:0.30748	val-logloss:0.57141	val-auc:0.68660	val-aucpr:0.21907
[50]	train-logloss:0.65915	train-auc:0.70060	train-aucpr:0.31197	val-logloss:0.56210	val-auc:0.68553	val-aucpr:0.22291
[60]	train-logloss:0.65458	train-auc:0.70392	train-aucpr:0.31503	val-logloss:0.55027	val-auc:0.69402	val-aucpr:0.22769
[70]	train-logloss:0.65106	train-auc:0.70689	train-aucpr:0.31781	val-logloss:0.53913	val-auc:0.69527	val-aucpr:0.22793
[80]	train-logloss:0.64746	train-auc:0.71163	train-aucpr:0.32215	val-logloss:0.53538	val-auc:0.68994	val-aucpr:0.22590
[90]	train-logloss:0.64469	train-auc:0.71422	train-aucpr:0.32502	val-logloss:0.51969	val-auc:0.68771	val-aucpr:0.22112
[97]	train-logloss:0.64297	train-auc:0.71634	train-aucpr:0.32754	val-logloss:0.50951	val-auc:0.68946	val-aucpr:0.22012
[2025-11-19 09:28:30,755] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:28:30,755] [INFO] [<frozen importlib] - Best train loss: 0.6517
[2025-11-19 09:28:30,755] [INFO] [<frozen importlib] - Best val loss: 0.5454
[2025-11-19 09:28:30,755] [INFO] [<frozen importlib] - Best val AUC: 0.6948
[2025-11-19 09:28:30,755] [INFO] [<frozen importlib] - Best val AUCPR: 0.2289
[2025-11-19 09:28:30,759] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:28:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:28:44,929] [INFO] [<frozen importlib] - Optimal threshold: 0.5192
[2025-11-19 09:28:44,930] [INFO] [<frozen importlib] - Best f1: 0.2710
[2025-11-19 09:28:44,930] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:28:44,987] [INFO] [<frozen importlib] - Validation Results (threshold=0.5192):
[2025-11-19 09:28:44,987] [INFO] [<frozen importlib] -   Accuracy: 0.9006
[2025-11-19 09:28:44,987] [INFO] [<frozen importlib] -   Precision: 0.3105
[2025-11-19 09:28:44,987] [INFO] [<frozen importlib] -   Recall: 0.2404
[2025-11-19 09:28:44,987] [INFO] [<frozen importlib] -   F1 Score: 0.2710
[2025-11-19 09:28:44,987] [INFO] [<frozen importlib] -   AUROC: 0.6948
[2025-11-19 09:28:44,987] [INFO] [<frozen importlib] -   AUPRC: 0.2292
[2025-11-19 09:28:44,987] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:28:44,987] [INFO] [<frozen importlib] -     TN=16670, FP=775
[2025-11-19 09:28:44,987] [INFO] [<frozen importlib] -     FN=1103, TP=349
[2025-11-19 09:28:45,015] [INFO] [<frozen importlib] - Trial 394: AUPRC=0.2292, F1=0.4513, Prec=0.4558, Rec=0.4470 | Optimizing auprc=0.2292
[2025-11-19 09:28:45,016] [INFO] [<frozen importlib] - Trial 394 pruned.
[2025-11-19 09:28:45,016] [ERROR] [<frozen importlib] - Trial 394 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  79%|███████▉  | 394/500 [1:06:42<20:17, 11.48s/it]Best trial: 289. Best value: 0.241792:  79%|███████▉  | 394/500 [1:06:42<20:17, 11.48s/it]Best trial: 289. Best value: 0.241792:  79%|███████▉  | 395/500 [1:06:42<23:11, 13.26s/it][2025-11-19 09:28:45,028] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.187457936872794
[2025-11-19 09:28:45,028] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:28:45,028] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:28:45,028] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:28:45,028] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:28:45,028] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:28:45,028] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   gamma: 0.14622906090581222
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   alpha: 0.7110355776484384
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   lambda: 0.758193308057016
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   learning_rate: 0.04481905685256414
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   subsample: 0.7956199328433428
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   colsample_bytree: 0.5914350758208496
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   colsample_bylevel: 0.9160577736162103
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   colsample_bynode: 0.7692712411554573
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:28:45,029] [INFO] [<frozen importlib] -   scale_pos_weight: 7.187457936872794
[2025-11-19 09:28:45,101] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:28:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:28:45,016] Trial 394 pruned. 
[0]	train-logloss:0.70817	train-auc:0.64245	train-aucpr:0.22956	val-logloss:0.70432	val-auc:0.62784	val-aucpr:0.13182
[10]	train-logloss:0.67853	train-auc:0.68302	train-aucpr:0.28799	val-logloss:0.62718	val-auc:0.68459	val-aucpr:0.19871
[20]	train-logloss:0.66196	train-auc:0.69165	train-aucpr:0.30204	val-logloss:0.57656	val-auc:0.69551	val-aucpr:0.20823
[30]	train-logloss:0.65098	train-auc:0.69849	train-aucpr:0.30970	val-logloss:0.55888	val-auc:0.69531	val-aucpr:0.21429
[40]	train-logloss:0.64385	train-auc:0.70172	train-aucpr:0.31433	val-logloss:0.53727	val-auc:0.69889	val-aucpr:0.21724
[50]	train-logloss:0.63775	train-auc:0.70678	train-aucpr:0.31942	val-logloss:0.53355	val-auc:0.70097	val-aucpr:0.21768
[60]	train-logloss:0.63294	train-auc:0.71232	train-aucpr:0.32473	val-logloss:0.52188	val-auc:0.69598	val-aucpr:0.21281
[70]	train-logloss:0.62924	train-auc:0.71751	train-aucpr:0.32914	val-logloss:0.50123	val-auc:0.68789	val-aucpr:0.19775
[74]	train-logloss:0.62820	train-auc:0.71903	train-aucpr:0.33105	val-logloss:0.50304	val-auc:0.68855	val-aucpr:0.19908
[2025-11-19 09:28:45,823] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 09:28:45,823] [INFO] [<frozen importlib] - Best train loss: 0.6411
[2025-11-19 09:28:45,823] [INFO] [<frozen importlib] - Best val loss: 0.5326
[2025-11-19 09:28:45,823] [INFO] [<frozen importlib] - Best val AUC: 0.7017
[2025-11-19 09:28:45,823] [INFO] [<frozen importlib] - Best val AUCPR: 0.2200
[2025-11-19 09:28:45,826] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:28:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:28:55,168] [INFO] [<frozen importlib] - Optimal threshold: 0.5066
[2025-11-19 09:28:55,168] [INFO] [<frozen importlib] - Best f1: 0.2756
[2025-11-19 09:28:55,169] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:28:55,208] [INFO] [<frozen importlib] - Validation Results (threshold=0.5066):
[2025-11-19 09:28:55,208] [INFO] [<frozen importlib] -   Accuracy: 0.9043
[2025-11-19 09:28:55,208] [INFO] [<frozen importlib] -   Precision: 0.3295
[2025-11-19 09:28:55,208] [INFO] [<frozen importlib] -   Recall: 0.2369
[2025-11-19 09:28:55,208] [INFO] [<frozen importlib] -   F1 Score: 0.2756
[2025-11-19 09:28:55,208] [INFO] [<frozen importlib] -   AUROC: 0.7017
[2025-11-19 09:28:55,208] [INFO] [<frozen importlib] -   AUPRC: 0.2205
[2025-11-19 09:28:55,208] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:28:55,208] [INFO] [<frozen importlib] -     TN=16745, FP=700
[2025-11-19 09:28:55,208] [INFO] [<frozen importlib] -     FN=1108, TP=344
[2025-11-19 09:28:55,231] [INFO] [<frozen importlib] - Trial 395: AUPRC=0.2205, F1=0.4529, Prec=0.4737, Rec=0.4339 | Optimizing auprc=0.2205
[2025-11-19 09:28:55,232] [INFO] [<frozen importlib] - Trial 395 pruned.
[2025-11-19 09:28:55,232] [ERROR] [<frozen importlib] - Trial 395 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  79%|███████▉  | 395/500 [1:06:53<23:11, 13.26s/it]Best trial: 289. Best value: 0.241792:  79%|███████▉  | 395/500 [1:06:53<23:11, 13.26s/it]Best trial: 289. Best value: 0.241792:  79%|███████▉  | 396/500 [1:06:53<21:23, 12.34s/it][2025-11-19 09:28:55,245] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.646614957929879
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   gamma: 0.18264696089001015
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   alpha: 0.5940958272317259
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   lambda: 0.6756196738630206
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   learning_rate: 0.030870681896296003
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   subsample: 0.7766626502577565
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   colsample_bytree: 0.6188061045003658
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5263317024188391
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   colsample_bynode: 0.7447361911247069
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:28:55,245] [INFO] [<frozen importlib] -   scale_pos_weight: 6.646614957929879
[2025-11-19 09:28:55,317] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:28:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:28:55,232] Trial 395 pruned. 
[0]	train-logloss:0.67995	train-auc:0.65146	train-aucpr:0.24284	val-logloss:0.67378	val-auc:0.65802	val-aucpr:0.13091
[10]	train-logloss:0.65898	train-auc:0.67742	train-aucpr:0.29381	val-logloss:0.62342	val-auc:0.70677	val-aucpr:0.21501
[20]	train-logloss:0.64528	train-auc:0.68451	train-aucpr:0.29898	val-logloss:0.58612	val-auc:0.69490	val-aucpr:0.20779
[30]	train-logloss:0.63581	train-auc:0.69013	train-aucpr:0.30332	val-logloss:0.55966	val-auc:0.70185	val-aucpr:0.21806
[39]	train-logloss:0.62907	train-auc:0.69408	train-aucpr:0.30785	val-logloss:0.53651	val-auc:0.70151	val-aucpr:0.21514
[2025-11-19 09:28:55,451] [INFO] [<frozen importlib] - Training completed at iteration 9
[2025-11-19 09:28:55,451] [INFO] [<frozen importlib] - Best train loss: 0.6607
[2025-11-19 09:28:55,451] [INFO] [<frozen importlib] - Best val loss: 0.6271
[2025-11-19 09:28:55,451] [INFO] [<frozen importlib] - Best val AUC: 0.7091
[2025-11-19 09:28:55,451] [INFO] [<frozen importlib] - Best val AUCPR: 0.2188
[2025-11-19 09:28:55,455] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:28:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:28:56,746] [INFO] [<frozen importlib] - Optimal threshold: 0.4865
[2025-11-19 09:28:56,746] [INFO] [<frozen importlib] - Best f1: 0.2750
[2025-11-19 09:28:56,746] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:28:56,788] [INFO] [<frozen importlib] - Validation Results (threshold=0.4865):
[2025-11-19 09:28:56,789] [INFO] [<frozen importlib] -   Accuracy: 0.8783
[2025-11-19 09:28:56,789] [INFO] [<frozen importlib] -   Precision: 0.2536
[2025-11-19 09:28:56,789] [INFO] [<frozen importlib] -   Recall: 0.3003
[2025-11-19 09:28:56,789] [INFO] [<frozen importlib] -   F1 Score: 0.2750
[2025-11-19 09:28:56,789] [INFO] [<frozen importlib] -   AUROC: 0.7091
[2025-11-19 09:28:56,789] [INFO] [<frozen importlib] -   AUPRC: 0.2111
[2025-11-19 09:28:56,789] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:28:56,789] [INFO] [<frozen importlib] -     TN=16162, FP=1283
[2025-11-19 09:28:56,789] [INFO] [<frozen importlib] -     FN=1016, TP=436
[2025-11-19 09:28:56,811] [INFO] [<frozen importlib] - Trial 396: AUPRC=0.2111, F1=0.4371, Prec=0.3735, Rec=0.5269 | Optimizing auprc=0.2111
                                                                                          Best trial: 289. Best value: 0.241792:  79%|███████▉  | 396/500 [1:06:54<21:23, 12.34s/it]Best trial: 289. Best value: 0.241792:  79%|███████▉  | 396/500 [1:06:54<21:23, 12.34s/it]Best trial: 289. Best value: 0.241792:  79%|███████▉  | 397/500 [1:06:54<15:38,  9.11s/it][2025-11-19 09:28:56,825] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.033873976332012
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   gamma: 0.34974019310542936
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   alpha: 0.5807503777312826
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   lambda: 0.8504857893899969
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   learning_rate: 0.03298743289174517
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   subsample: 0.805211608742215
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   colsample_bytree: 0.5754486051621727
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5668464996525284
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   colsample_bynode: 0.8089373116857151
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:28:56,825] [INFO] [<frozen importlib] -   scale_pos_weight: 5.033873976332012
[2025-11-19 09:28:56,896] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:28:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:28:56,812] Trial 396 finished with value: 0.21108546113549267 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.18264696089001015, 'learning_rate': 0.030870681896296003, 'n_estimators': 450, 'alpha': 0.5940958272317259, 'lambda': 0.6756196738630206, 'subsample': 0.7766626502577565, 'colsample_bytree': 0.6188061045003658, 'colsample_bylevel': 0.5263317024188391, 'colsample_bynode': 0.7447361911247069, 'scale_pos_weight': 6.646614957929879}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.58938	train-auc:0.64388	train-aucpr:0.22914	val-logloss:0.57179	val-auc:0.62803	val-aucpr:0.13352
[10]	train-logloss:0.57087	train-auc:0.68072	train-aucpr:0.29139	val-logloss:0.53382	val-auc:0.70043	val-aucpr:0.20054
[20]	train-logloss:0.55918	train-auc:0.68628	train-aucpr:0.29821	val-logloss:0.50516	val-auc:0.70393	val-aucpr:0.21226
[30]	train-logloss:0.55043	train-auc:0.69149	train-aucpr:0.30518	val-logloss:0.48643	val-auc:0.70123	val-aucpr:0.21743
[40]	train-logloss:0.54446	train-auc:0.69638	train-aucpr:0.30933	val-logloss:0.47991	val-auc:0.71012	val-aucpr:0.22291
[50]	train-logloss:0.53954	train-auc:0.69931	train-aucpr:0.31201	val-logloss:0.46312	val-auc:0.71268	val-aucpr:0.22407
[60]	train-logloss:0.53573	train-auc:0.70270	train-aucpr:0.31588	val-logloss:0.45915	val-auc:0.70918	val-aucpr:0.22600
[70]	train-logloss:0.53236	train-auc:0.70680	train-aucpr:0.31987	val-logloss:0.45327	val-auc:0.71087	val-aucpr:0.22585
[80]	train-logloss:0.52964	train-auc:0.70950	train-aucpr:0.32408	val-logloss:0.44111	val-auc:0.71061	val-aucpr:0.22494
[90]	train-logloss:0.52741	train-auc:0.71294	train-aucpr:0.32698	val-logloss:0.43855	val-auc:0.70943	val-aucpr:0.22520
[91]	train-logloss:0.52730	train-auc:0.71301	train-aucpr:0.32709	val-logloss:0.43839	val-auc:0.70938	val-aucpr:0.22574
[2025-11-19 09:28:57,184] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:28:57,184] [INFO] [<frozen importlib] - Best train loss: 0.5350
[2025-11-19 09:28:57,184] [INFO] [<frozen importlib] - Best val loss: 0.4581
[2025-11-19 09:28:57,184] [INFO] [<frozen importlib] - Best val AUC: 0.7123
[2025-11-19 09:28:57,184] [INFO] [<frozen importlib] - Best val AUCPR: 0.2273
[2025-11-19 09:28:57,188] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:28:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:29:08,514] [INFO] [<frozen importlib] - Optimal threshold: 0.4361
[2025-11-19 09:29:08,514] [INFO] [<frozen importlib] - Best f1: 0.2813
[2025-11-19 09:29:08,514] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:29:08,557] [INFO] [<frozen importlib] - Validation Results (threshold=0.4361):
[2025-11-19 09:29:08,557] [INFO] [<frozen importlib] -   Accuracy: 0.9032
[2025-11-19 09:29:08,557] [INFO] [<frozen importlib] -   Precision: 0.3275
[2025-11-19 09:29:08,557] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 09:29:08,557] [INFO] [<frozen importlib] -   F1 Score: 0.2813
[2025-11-19 09:29:08,557] [INFO] [<frozen importlib] -   AUROC: 0.7123
[2025-11-19 09:29:08,557] [INFO] [<frozen importlib] -   AUPRC: 0.2279
[2025-11-19 09:29:08,557] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:29:08,557] [INFO] [<frozen importlib] -     TN=16710, FP=735
[2025-11-19 09:29:08,557] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 09:29:08,579] [INFO] [<frozen importlib] - Trial 397: AUPRC=0.2279, F1=0.4445, Prec=0.4596, Rec=0.4304 | Optimizing auprc=0.2279
[2025-11-19 09:29:08,580] [INFO] [<frozen importlib] - Trial 397 pruned.
[2025-11-19 09:29:08,580] [ERROR] [<frozen importlib] - Trial 397 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  79%|███████▉  | 397/500 [1:07:06<15:38,  9.11s/it]Best trial: 289. Best value: 0.241792:  79%|███████▉  | 397/500 [1:07:06<15:38,  9.11s/it]Best trial: 289. Best value: 0.241792:  80%|███████▉  | 398/500 [1:07:06<16:50,  9.91s/it][2025-11-19 09:29:08,593] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.126917619134323
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   gamma: 0.06987575031039073
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   alpha: 0.6882326606267313
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   lambda: 0.4318453104700725
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   learning_rate: 0.04195522362239547
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   subsample: 0.788703509712126
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   colsample_bytree: 0.6024085884332735
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5402011814105938
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   colsample_bynode: 0.7775288299898634
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:29:08,593] [INFO] [<frozen importlib] -   scale_pos_weight: 6.126917619134323
[2025-11-19 09:29:08,668] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:29:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:29:08,580] Trial 397 pruned. 
[0]	train-logloss:0.65051	train-auc:0.65155	train-aucpr:0.23792	val-logloss:0.65054	val-auc:0.48813	val-aucpr:0.07054
[10]	train-logloss:0.62571	train-auc:0.68302	train-aucpr:0.29177	val-logloss:0.58424	val-auc:0.68669	val-aucpr:0.20311
[20]	train-logloss:0.61144	train-auc:0.69056	train-aucpr:0.29789	val-logloss:0.54618	val-auc:0.71160	val-aucpr:0.21126
[30]	train-logloss:0.60173	train-auc:0.69550	train-aucpr:0.30555	val-logloss:0.51882	val-auc:0.71024	val-aucpr:0.22103
[40]	train-logloss:0.59507	train-auc:0.69962	train-aucpr:0.31063	val-logloss:0.50234	val-auc:0.71489	val-aucpr:0.23072
[50]	train-logloss:0.58956	train-auc:0.70385	train-aucpr:0.31524	val-logloss:0.48636	val-auc:0.71523	val-aucpr:0.22988
[60]	train-logloss:0.58590	train-auc:0.70804	train-aucpr:0.31909	val-logloss:0.47938	val-auc:0.71464	val-aucpr:0.23178
[70]	train-logloss:0.58249	train-auc:0.71228	train-aucpr:0.32387	val-logloss:0.47022	val-auc:0.71332	val-aucpr:0.23007
[80]	train-logloss:0.57933	train-auc:0.71801	train-aucpr:0.32865	val-logloss:0.45602	val-auc:0.70735	val-aucpr:0.22585
[90]	train-logloss:0.57708	train-auc:0.72105	train-aucpr:0.33251	val-logloss:0.45338	val-auc:0.70221	val-aucpr:0.21421
[91]	train-logloss:0.57683	train-auc:0.72153	train-aucpr:0.33308	val-logloss:0.45233	val-auc:0.70195	val-aucpr:0.21435
[2025-11-19 09:29:08,929] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:29:08,929] [INFO] [<frozen importlib] - Best train loss: 0.5852
[2025-11-19 09:29:08,929] [INFO] [<frozen importlib] - Best val loss: 0.4760
[2025-11-19 09:29:08,929] [INFO] [<frozen importlib] - Best val AUC: 0.7161
[2025-11-19 09:29:08,929] [INFO] [<frozen importlib] - Best val AUCPR: 0.2326
[2025-11-19 09:29:08,933] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:29:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:29:21,934] [INFO] [<frozen importlib] - Optimal threshold: 0.4643
[2025-11-19 09:29:21,934] [INFO] [<frozen importlib] - Best f1: 0.2931
[2025-11-19 09:29:21,934] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:29:21,977] [INFO] [<frozen importlib] - Validation Results (threshold=0.4643):
[2025-11-19 09:29:21,977] [INFO] [<frozen importlib] -   Accuracy: 0.9040
[2025-11-19 09:29:21,977] [INFO] [<frozen importlib] -   Precision: 0.3375
[2025-11-19 09:29:21,977] [INFO] [<frozen importlib] -   Recall: 0.2590
[2025-11-19 09:29:21,977] [INFO] [<frozen importlib] -   F1 Score: 0.2931
[2025-11-19 09:29:21,978] [INFO] [<frozen importlib] -   AUROC: 0.7161
[2025-11-19 09:29:21,978] [INFO] [<frozen importlib] -   AUPRC: 0.2330
[2025-11-19 09:29:21,978] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:29:21,978] [INFO] [<frozen importlib] -     TN=16707, FP=738
[2025-11-19 09:29:21,978] [INFO] [<frozen importlib] -     FN=1076, TP=376
[2025-11-19 09:29:22,003] [INFO] [<frozen importlib] - Trial 398: AUPRC=0.2330, F1=0.4396, Prec=0.4554, Rec=0.4249 | Optimizing auprc=0.2330
                                                                                          Best trial: 289. Best value: 0.241792:  80%|███████▉  | 398/500 [1:07:19<16:50,  9.91s/it]Best trial: 289. Best value: 0.241792:  80%|███████▉  | 398/500 [1:07:19<16:50,  9.91s/it]Best trial: 289. Best value: 0.241792:  80%|███████▉  | 399/500 [1:07:19<18:27, 10.96s/it][2025-11-19 09:29:22,027] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.684286157191816
[2025-11-19 09:29:22,027] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:29:22,027] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:29:22,027] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:29:22,027] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:29:22,027] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:29:22,027] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:29:22,027] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:29:22,027] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:29:22,027] [INFO] [<frozen importlib] -   gamma: 0.7625809745114119
[2025-11-19 09:29:22,028] [INFO] [<frozen importlib] -   alpha: 0.6304720759047193
[2025-11-19 09:29:22,028] [INFO] [<frozen importlib] -   lambda: 0.9321448559895366
[2025-11-19 09:29:22,028] [INFO] [<frozen importlib] -   learning_rate: 0.03683173566460916
[2025-11-19 09:29:22,028] [INFO] [<frozen importlib] -   subsample: 0.7927252809078894
[2025-11-19 09:29:22,028] [INFO] [<frozen importlib] -   colsample_bytree: 0.5008400625040828
[2025-11-19 09:29:22,028] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5177306657224917
[2025-11-19 09:29:22,028] [INFO] [<frozen importlib] -   colsample_bynode: 0.7590592356094716
[2025-11-19 09:29:22,028] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:29:22,028] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:29:22,028] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:29:22,028] [INFO] [<frozen importlib] -   scale_pos_weight: 5.684286157191816
[2025-11-19 09:29:22,111] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:29:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:29:22,004] Trial 398 finished with value: 0.23300759500320808 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.06987575031039073, 'learning_rate': 0.04195522362239547, 'n_estimators': 400, 'alpha': 0.6882326606267313, 'lambda': 0.4318453104700725, 'subsample': 0.788703509712126, 'colsample_bytree': 0.6024085884332735, 'colsample_bylevel': 0.5402011814105938, 'colsample_bynode': 0.7775288299898634, 'scale_pos_weight': 6.126917619134323}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.62631	train-auc:0.63992	train-aucpr:0.22108	val-logloss:0.61419	val-auc:0.65953	val-aucpr:0.14816
[10]	train-logloss:0.60593	train-auc:0.67976	train-aucpr:0.29093	val-logloss:0.56727	val-auc:0.67443	val-aucpr:0.20049
[20]	train-logloss:0.59297	train-auc:0.68791	train-aucpr:0.29865	val-logloss:0.53512	val-auc:0.70133	val-aucpr:0.22173
[30]	train-logloss:0.58377	train-auc:0.69223	train-aucpr:0.30407	val-logloss:0.50978	val-auc:0.70871	val-aucpr:0.23033
[40]	train-logloss:0.57674	train-auc:0.69785	train-aucpr:0.30970	val-logloss:0.48877	val-auc:0.70664	val-aucpr:0.23224
[50]	train-logloss:0.57109	train-auc:0.70150	train-aucpr:0.31383	val-logloss:0.47812	val-auc:0.70611	val-aucpr:0.23130
[60]	train-logloss:0.56740	train-auc:0.70385	train-aucpr:0.31666	val-logloss:0.46512	val-auc:0.70773	val-aucpr:0.23176
[70]	train-logloss:0.56428	train-auc:0.70747	train-aucpr:0.31976	val-logloss:0.45027	val-auc:0.71110	val-aucpr:0.23135
[71]	train-logloss:0.56410	train-auc:0.70759	train-aucpr:0.32004	val-logloss:0.45001	val-auc:0.71082	val-aucpr:0.23188
[2025-11-19 09:29:22,331] [INFO] [<frozen importlib] - Training completed at iteration 42
[2025-11-19 09:29:22,331] [INFO] [<frozen importlib] - Best train loss: 0.5756
[2025-11-19 09:29:22,331] [INFO] [<frozen importlib] - Best val loss: 0.4849
[2025-11-19 09:29:22,331] [INFO] [<frozen importlib] - Best val AUC: 0.7076
[2025-11-19 09:29:22,331] [INFO] [<frozen importlib] - Best val AUCPR: 0.2332
[2025-11-19 09:29:22,336] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:29:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:29:32,606] [INFO] [<frozen importlib] - Optimal threshold: 0.4446
[2025-11-19 09:29:32,606] [INFO] [<frozen importlib] - Best f1: 0.2705
[2025-11-19 09:29:32,606] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:29:32,650] [INFO] [<frozen importlib] - Validation Results (threshold=0.4446):
[2025-11-19 09:29:32,650] [INFO] [<frozen importlib] -   Accuracy: 0.8947
[2025-11-19 09:29:32,650] [INFO] [<frozen importlib] -   Precision: 0.2892
[2025-11-19 09:29:32,650] [INFO] [<frozen importlib] -   Recall: 0.2541
[2025-11-19 09:29:32,650] [INFO] [<frozen importlib] -   F1 Score: 0.2705
[2025-11-19 09:29:32,650] [INFO] [<frozen importlib] -   AUROC: 0.7076
[2025-11-19 09:29:32,650] [INFO] [<frozen importlib] -   AUPRC: 0.2335
[2025-11-19 09:29:32,650] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:29:32,650] [INFO] [<frozen importlib] -     TN=16538, FP=907
[2025-11-19 09:29:32,650] [INFO] [<frozen importlib] -     FN=1083, TP=369
[2025-11-19 09:29:32,677] [INFO] [<frozen importlib] - Trial 399: AUPRC=0.2335, F1=0.4470, Prec=0.4281, Rec=0.4676 | Optimizing auprc=0.2335
                                                                                          Best trial: 289. Best value: 0.241792:  80%|███████▉  | 399/500 [1:07:30<18:27, 10.96s/it]Best trial: 289. Best value: 0.241792:  80%|███████▉  | 399/500 [1:07:30<18:27, 10.96s/it]Best trial: 289. Best value: 0.241792:  80%|████████  | 400/500 [1:07:30<18:07, 10.88s/it][2025-11-19 09:29:32,691] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.725823679156212
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   gamma: 0.19797507888415933
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   alpha: 0.560737190648133
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   lambda: 0.5960173782533189
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   learning_rate: 0.03894389554099395
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   subsample: 0.8137407055717909
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   colsample_bytree: 0.521820107175904
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5086000613871225
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   colsample_bynode: 0.7927181484802862
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:29:32,691] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:29:32,692] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:29:32,692] [INFO] [<frozen importlib] -   scale_pos_weight: 7.725823679156212
[2025-11-19 09:29:32,766] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:29:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:29:32,678] Trial 399 finished with value: 0.23349188551768496 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.7625809745114119, 'learning_rate': 0.03683173566460916, 'n_estimators': 450, 'alpha': 0.6304720759047193, 'lambda': 0.9321448559895366, 'subsample': 0.7927252809078894, 'colsample_bytree': 0.5008400625040828, 'colsample_bylevel': 0.5177306657224917, 'colsample_bynode': 0.7590592356094716, 'scale_pos_weight': 5.684286157191816}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.73720	train-auc:0.64031	train-aucpr:0.21547	val-logloss:0.74035	val-auc:0.65625	val-aucpr:0.12628
[10]	train-logloss:0.71009	train-auc:0.68156	train-aucpr:0.28442	val-logloss:0.68474	val-auc:0.67350	val-aucpr:0.19554
[20]	train-logloss:0.69368	train-auc:0.68904	train-aucpr:0.29402	val-logloss:0.63211	val-auc:0.71200	val-aucpr:0.22066
[30]	train-logloss:0.68265	train-auc:0.69262	train-aucpr:0.30151	val-logloss:0.59216	val-auc:0.71260	val-aucpr:0.22983
[40]	train-logloss:0.67491	train-auc:0.69628	train-aucpr:0.30731	val-logloss:0.58390	val-auc:0.71179	val-aucpr:0.22709
[50]	train-logloss:0.66836	train-auc:0.70204	train-aucpr:0.31237	val-logloss:0.57022	val-auc:0.70228	val-aucpr:0.22004
[60]	train-logloss:0.66402	train-auc:0.70501	train-aucpr:0.31614	val-logloss:0.55713	val-auc:0.70283	val-aucpr:0.22439
[65]	train-logloss:0.66223	train-auc:0.70608	train-aucpr:0.31735	val-logloss:0.55076	val-auc:0.70107	val-aucpr:0.22283
[2025-11-19 09:29:32,967] [INFO] [<frozen importlib] - Training completed at iteration 36
[2025-11-19 09:29:32,967] [INFO] [<frozen importlib] - Best train loss: 0.6778
[2025-11-19 09:29:32,967] [INFO] [<frozen importlib] - Best val loss: 0.5806
[2025-11-19 09:29:32,967] [INFO] [<frozen importlib] - Best val AUC: 0.7127
[2025-11-19 09:29:32,967] [INFO] [<frozen importlib] - Best val AUCPR: 0.2299
[2025-11-19 09:29:32,972] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:29:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:29:42,565] [INFO] [<frozen importlib] - Optimal threshold: 0.5254
[2025-11-19 09:29:42,565] [INFO] [<frozen importlib] - Best f1: 0.2750
[2025-11-19 09:29:42,565] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:29:42,610] [INFO] [<frozen importlib] - Validation Results (threshold=0.5254):
[2025-11-19 09:29:42,610] [INFO] [<frozen importlib] -   Accuracy: 0.9057
[2025-11-19 09:29:42,610] [INFO] [<frozen importlib] -   Precision: 0.3360
[2025-11-19 09:29:42,610] [INFO] [<frozen importlib] -   Recall: 0.2328
[2025-11-19 09:29:42,611] [INFO] [<frozen importlib] -   F1 Score: 0.2750
[2025-11-19 09:29:42,611] [INFO] [<frozen importlib] -   AUROC: 0.7127
[2025-11-19 09:29:42,611] [INFO] [<frozen importlib] -   AUPRC: 0.2303
[2025-11-19 09:29:42,611] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:29:42,611] [INFO] [<frozen importlib] -     TN=16777, FP=668
[2025-11-19 09:29:42,611] [INFO] [<frozen importlib] -     FN=1114, TP=338
[2025-11-19 09:29:42,637] [INFO] [<frozen importlib] - Trial 400: AUPRC=0.2303, F1=0.4537, Prec=0.4822, Rec=0.4284 | Optimizing auprc=0.2303
                                                                                          Best trial: 289. Best value: 0.241792:  80%|████████  | 400/500 [1:07:40<18:07, 10.88s/it]Best trial: 289. Best value: 0.241792:  80%|████████  | 400/500 [1:07:40<18:07, 10.88s/it]Best trial: 289. Best value: 0.241792:  80%|████████  | 401/500 [1:07:40<17:29, 10.60s/it][2025-11-19 09:29:42,650] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.003784807065895
[2025-11-19 09:29:42,650] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:29:42,650] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:29:42,650] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:29:42,650] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:29:42,650] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:29:42,650] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:29:42,650] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:29:42,650] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:29:42,650] [INFO] [<frozen importlib] -   gamma: 0.26539068911878266
[2025-11-19 09:29:42,650] [INFO] [<frozen importlib] -   alpha: 0.6117112702287687
[2025-11-19 09:29:42,650] [INFO] [<frozen importlib] -   lambda: 0.7511843641018895
[2025-11-19 09:29:42,651] [INFO] [<frozen importlib] -   learning_rate: 0.03494241217954241
[2025-11-19 09:29:42,651] [INFO] [<frozen importlib] -   subsample: 0.8745534547266371
[2025-11-19 09:29:42,651] [INFO] [<frozen importlib] -   colsample_bytree: 0.5507895663860847
[2025-11-19 09:29:42,651] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5004821756381325
[2025-11-19 09:29:42,651] [INFO] [<frozen importlib] -   colsample_bynode: 0.6771496938993775
[2025-11-19 09:29:42,651] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:29:42,651] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:29:42,651] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:29:42,651] [INFO] [<frozen importlib] -   scale_pos_weight: 7.003784807065895
[2025-11-19 09:29:42,732] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:29:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:29:42,637] Trial 400 finished with value: 0.23032856893456655 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.19797507888415933, 'learning_rate': 0.03894389554099395, 'n_estimators': 450, 'alpha': 0.560737190648133, 'lambda': 0.5960173782533189, 'subsample': 0.8137407055717909, 'colsample_bytree': 0.521820107175904, 'colsample_bylevel': 0.5086000613871225, 'colsample_bynode': 0.7927181484802862, 'scale_pos_weight': 7.725823679156212}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.69940	train-auc:0.64324	train-aucpr:0.23306	val-logloss:0.69706	val-auc:0.61018	val-aucpr:0.12755
[10]	train-logloss:0.67644	train-auc:0.68095	train-aucpr:0.28679	val-logloss:0.64697	val-auc:0.69231	val-aucpr:0.20697
[20]	train-logloss:0.66193	train-auc:0.68568	train-aucpr:0.29295	val-logloss:0.62048	val-auc:0.68226	val-aucpr:0.20817
[30]	train-logloss:0.65156	train-auc:0.69238	train-aucpr:0.30211	val-logloss:0.59233	val-auc:0.69226	val-aucpr:0.21598
[40]	train-logloss:0.64379	train-auc:0.69713	train-aucpr:0.30685	val-logloss:0.57345	val-auc:0.69693	val-aucpr:0.21823
[50]	train-logloss:0.63752	train-auc:0.70081	train-aucpr:0.31104	val-logloss:0.55360	val-auc:0.70575	val-aucpr:0.21376
[60]	train-logloss:0.63326	train-auc:0.70384	train-aucpr:0.31466	val-logloss:0.53717	val-auc:0.70491	val-aucpr:0.22262
[70]	train-logloss:0.62944	train-auc:0.70738	train-aucpr:0.31854	val-logloss:0.53382	val-auc:0.69787	val-aucpr:0.22018
[80]	train-logloss:0.62625	train-auc:0.71071	train-aucpr:0.32226	val-logloss:0.52946	val-auc:0.69960	val-aucpr:0.21946
[90]	train-logloss:0.62315	train-auc:0.71495	train-aucpr:0.32688	val-logloss:0.52885	val-auc:0.69725	val-aucpr:0.21696
[2025-11-19 09:29:42,996] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:29:42,996] [INFO] [<frozen importlib] - Best train loss: 0.6333
[2025-11-19 09:29:42,996] [INFO] [<frozen importlib] - Best val loss: 0.5372
[2025-11-19 09:29:42,996] [INFO] [<frozen importlib] - Best val AUC: 0.7049
[2025-11-19 09:29:42,996] [INFO] [<frozen importlib] - Best val AUCPR: 0.2226
[2025-11-19 09:29:43,001] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:29:43] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:29:55,130] [INFO] [<frozen importlib] - Optimal threshold: 0.5008
[2025-11-19 09:29:55,130] [INFO] [<frozen importlib] - Best f1: 0.2673
[2025-11-19 09:29:55,130] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:29:55,176] [INFO] [<frozen importlib] - Validation Results (threshold=0.5008):
[2025-11-19 09:29:55,176] [INFO] [<frozen importlib] -   Accuracy: 0.8927
[2025-11-19 09:29:55,176] [INFO] [<frozen importlib] -   Precision: 0.2812
[2025-11-19 09:29:55,176] [INFO] [<frozen importlib] -   Recall: 0.2548
[2025-11-19 09:29:55,176] [INFO] [<frozen importlib] -   F1 Score: 0.2673
[2025-11-19 09:29:55,176] [INFO] [<frozen importlib] -   AUROC: 0.7049
[2025-11-19 09:29:55,176] [INFO] [<frozen importlib] -   AUPRC: 0.2230
[2025-11-19 09:29:55,176] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:29:55,176] [INFO] [<frozen importlib] -     TN=16499, FP=946
[2025-11-19 09:29:55,176] [INFO] [<frozen importlib] -     FN=1082, TP=370
[2025-11-19 09:29:55,204] [INFO] [<frozen importlib] - Trial 401: AUPRC=0.2230, F1=0.4459, Prec=0.4211, Rec=0.4738 | Optimizing auprc=0.2230
[2025-11-19 09:29:55,205] [INFO] [<frozen importlib] - Trial 401 pruned.
[2025-11-19 09:29:55,205] [ERROR] [<frozen importlib] - Trial 401 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  80%|████████  | 401/500 [1:07:53<17:29, 10.60s/it]Best trial: 289. Best value: 0.241792:  80%|████████  | 401/500 [1:07:53<17:29, 10.60s/it]Best trial: 289. Best value: 0.241792:  80%|████████  | 402/500 [1:07:53<18:16, 11.19s/it][2025-11-19 09:29:55,219] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 9.030775424025647
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   gamma: 0.3215291462076586
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   alpha: 0.9119190184894197
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   lambda: 1.0246879295180615
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   learning_rate: 0.04367243073842647
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   subsample: 0.7766634703683999
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   colsample_bytree: 0.5886075698917075
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5247736206036118
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   colsample_bynode: 0.7716430421325317
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:29:55,219] [INFO] [<frozen importlib] -   scale_pos_weight: 9.030775424025647
[2025-11-19 09:29:55,303] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:29:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:29:55,205] Trial 401 pruned. 
[0]	train-logloss:0.80099	train-auc:0.64745	train-aucpr:0.22427	val-logloss:0.80872	val-auc:0.63773	val-aucpr:0.12945
[10]	train-logloss:0.76768	train-auc:0.68139	train-aucpr:0.28802	val-logloss:0.72358	val-auc:0.69781	val-aucpr:0.19194
[20]	train-logloss:0.74927	train-auc:0.69102	train-aucpr:0.29946	val-logloss:0.68627	val-auc:0.70338	val-aucpr:0.20639
[30]	train-logloss:0.73716	train-auc:0.69573	train-aucpr:0.30570	val-logloss:0.65611	val-auc:0.70746	val-aucpr:0.22395
[40]	train-logloss:0.72925	train-auc:0.70025	train-aucpr:0.30849	val-logloss:0.64130	val-auc:0.71115	val-aucpr:0.22516
[50]	train-logloss:0.72226	train-auc:0.70526	train-aucpr:0.31384	val-logloss:0.61594	val-auc:0.70947	val-aucpr:0.22313
[60]	train-logloss:0.71716	train-auc:0.70874	train-aucpr:0.31805	val-logloss:0.60384	val-auc:0.70716	val-aucpr:0.22426
[67]	train-logloss:0.71393	train-auc:0.71246	train-aucpr:0.32199	val-logloss:0.56763	val-auc:0.70287	val-aucpr:0.21450
[2025-11-19 09:29:55,529] [INFO] [<frozen importlib] - Training completed at iteration 37
[2025-11-19 09:29:55,529] [INFO] [<frozen importlib] - Best train loss: 0.7313
[2025-11-19 09:29:55,529] [INFO] [<frozen importlib] - Best val loss: 0.6417
[2025-11-19 09:29:55,529] [INFO] [<frozen importlib] - Best val AUC: 0.7125
[2025-11-19 09:29:55,529] [INFO] [<frozen importlib] - Best val AUCPR: 0.2268
[2025-11-19 09:29:55,534] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:29:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:30:04,776] [INFO] [<frozen importlib] - Optimal threshold: 0.5631
[2025-11-19 09:30:04,777] [INFO] [<frozen importlib] - Best f1: 0.2761
[2025-11-19 09:30:04,777] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:30:04,829] [INFO] [<frozen importlib] - Validation Results (threshold=0.5631):
[2025-11-19 09:30:04,829] [INFO] [<frozen importlib] -   Accuracy: 0.8829
[2025-11-19 09:30:04,829] [INFO] [<frozen importlib] -   Precision: 0.2629
[2025-11-19 09:30:04,829] [INFO] [<frozen importlib] -   Recall: 0.2906
[2025-11-19 09:30:04,829] [INFO] [<frozen importlib] -   F1 Score: 0.2761
[2025-11-19 09:30:04,829] [INFO] [<frozen importlib] -   AUROC: 0.7125
[2025-11-19 09:30:04,829] [INFO] [<frozen importlib] -   AUPRC: 0.2272
[2025-11-19 09:30:04,829] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:30:04,829] [INFO] [<frozen importlib] -     TN=16262, FP=1183
[2025-11-19 09:30:04,829] [INFO] [<frozen importlib] -     FN=1030, TP=422
[2025-11-19 09:30:04,853] [INFO] [<frozen importlib] - Trial 402: AUPRC=0.2272, F1=0.4259, Prec=0.3761, Rec=0.4910 | Optimizing auprc=0.2272
[2025-11-19 09:30:04,853] [INFO] [<frozen importlib] - Trial 402 pruned.
[2025-11-19 09:30:04,853] [ERROR] [<frozen importlib] - Trial 402 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  80%|████████  | 402/500 [1:08:02<18:16, 11.19s/it]Best trial: 289. Best value: 0.241792:  80%|████████  | 402/500 [1:08:02<18:16, 11.19s/it]Best trial: 289. Best value: 0.241792:  81%|████████  | 403/500 [1:08:02<17:20, 10.73s/it][2025-11-19 09:30:04,867] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.325017105229513
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   gamma: 0.3969267059421051
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   alpha: 0.656955989580931
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   lambda: 0.8184265326275345
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   learning_rate: 0.03823746436861295
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   subsample: 0.8013792684087466
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   colsample_bytree: 0.539409732766861
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5353602793659215
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   colsample_bynode: 0.5737258087988547
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:30:04,867] [INFO] [<frozen importlib] -   scale_pos_weight: 5.325017105229513
[2025-11-19 09:30:04,948] [INFO] [<frozen importlib] - Training with 500 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:30:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:30:04,853] Trial 402 pruned. 
[0]	train-logloss:0.60591	train-auc:0.63450	train-aucpr:0.22514	val-logloss:0.59062	val-auc:0.64328	val-aucpr:0.13523
[10]	train-logloss:0.58641	train-auc:0.68044	train-aucpr:0.28685	val-logloss:0.54674	val-auc:0.68294	val-aucpr:0.19759
[20]	train-logloss:0.57285	train-auc:0.68642	train-aucpr:0.30002	val-logloss:0.51691	val-auc:0.69941	val-aucpr:0.21177
[30]	train-logloss:0.56407	train-auc:0.69064	train-aucpr:0.30493	val-logloss:0.49230	val-auc:0.68699	val-aucpr:0.21432
[40]	train-logloss:0.55751	train-auc:0.69626	train-aucpr:0.31069	val-logloss:0.47811	val-auc:0.69673	val-aucpr:0.21761
[50]	train-logloss:0.55241	train-auc:0.70050	train-aucpr:0.31390	val-logloss:0.47228	val-auc:0.69523	val-aucpr:0.21674
[60]	train-logloss:0.54868	train-auc:0.70470	train-aucpr:0.31754	val-logloss:0.46495	val-auc:0.69743	val-aucpr:0.21130
[61]	train-logloss:0.54844	train-auc:0.70484	train-aucpr:0.31787	val-logloss:0.46449	val-auc:0.69761	val-aucpr:0.21110
[2025-11-19 09:30:05,163] [INFO] [<frozen importlib] - Training completed at iteration 32
[2025-11-19 09:30:05,163] [INFO] [<frozen importlib] - Best train loss: 0.5628
[2025-11-19 09:30:05,163] [INFO] [<frozen importlib] - Best val loss: 0.4895
[2025-11-19 09:30:05,163] [INFO] [<frozen importlib] - Best val AUC: 0.6949
[2025-11-19 09:30:05,163] [INFO] [<frozen importlib] - Best val AUCPR: 0.2189
[2025-11-19 09:30:05,167] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:30:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:30:13,973] [INFO] [<frozen importlib] - Optimal threshold: 0.4350
[2025-11-19 09:30:13,973] [INFO] [<frozen importlib] - Best f1: 0.2611
[2025-11-19 09:30:13,973] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:30:14,031] [INFO] [<frozen importlib] - Validation Results (threshold=0.4350):
[2025-11-19 09:30:14,031] [INFO] [<frozen importlib] -   Accuracy: 0.8967
[2025-11-19 09:30:14,031] [INFO] [<frozen importlib] -   Precision: 0.2897
[2025-11-19 09:30:14,031] [INFO] [<frozen importlib] -   Recall: 0.2376
[2025-11-19 09:30:14,031] [INFO] [<frozen importlib] -   F1 Score: 0.2611
[2025-11-19 09:30:14,031] [INFO] [<frozen importlib] -   AUROC: 0.6949
[2025-11-19 09:30:14,031] [INFO] [<frozen importlib] -   AUPRC: 0.2194
[2025-11-19 09:30:14,031] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:30:14,031] [INFO] [<frozen importlib] -     TN=16599, FP=846
[2025-11-19 09:30:14,031] [INFO] [<frozen importlib] -     FN=1107, TP=345
[2025-11-19 09:30:14,055] [INFO] [<frozen importlib] - Trial 403: AUPRC=0.2194, F1=0.4255, Prec=0.4233, Rec=0.4277 | Optimizing auprc=0.2194
[2025-11-19 09:30:14,056] [INFO] [<frozen importlib] - Trial 403 pruned.
[2025-11-19 09:30:14,056] [ERROR] [<frozen importlib] - Trial 403 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  81%|████████  | 403/500 [1:08:12<17:20, 10.73s/it]Best trial: 289. Best value: 0.241792:  81%|████████  | 403/500 [1:08:12<17:20, 10.73s/it]Best trial: 289. Best value: 0.241792:  81%|████████  | 404/500 [1:08:12<16:25, 10.27s/it][2025-11-19 09:30:14,069] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.387932943505101
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   gamma: 0.29414534244347096
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   alpha: 0.5215618355727918
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   lambda: 0.8837583365738935
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   learning_rate: 0.0407755299007344
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   subsample: 0.8197927077277505
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   colsample_bytree: 0.5656735405453363
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5873303150955455
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   colsample_bynode: 0.7840827050639724
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:30:14,069] [INFO] [<frozen importlib] -   scale_pos_weight: 6.387932943505101
[2025-11-19 09:30:14,143] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:30:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:30:14,056] Trial 403 pruned. 
[0]	train-logloss:0.66527	train-auc:0.64659	train-aucpr:0.23627	val-logloss:0.65803	val-auc:0.62378	val-aucpr:0.12527
[10]	train-logloss:0.64112	train-auc:0.68217	train-aucpr:0.29011	val-logloss:0.60568	val-auc:0.71714	val-aucpr:0.20407
[20]	train-logloss:0.62603	train-auc:0.68868	train-aucpr:0.29976	val-logloss:0.56615	val-auc:0.70867	val-aucpr:0.20776
[30]	train-logloss:0.61608	train-auc:0.69469	train-aucpr:0.30624	val-logloss:0.53068	val-auc:0.71263	val-aucpr:0.21393
[40]	train-logloss:0.60888	train-auc:0.70006	train-aucpr:0.31156	val-logloss:0.51840	val-auc:0.70870	val-aucpr:0.21323
[50]	train-logloss:0.60285	train-auc:0.70548	train-aucpr:0.31773	val-logloss:0.51298	val-auc:0.70757	val-aucpr:0.22002
[60]	train-logloss:0.59865	train-auc:0.71048	train-aucpr:0.32179	val-logloss:0.49144	val-auc:0.70733	val-aucpr:0.21876
[70]	train-logloss:0.59531	train-auc:0.71367	train-aucpr:0.32597	val-logloss:0.48334	val-auc:0.70309	val-aucpr:0.22206
[80]	train-logloss:0.59232	train-auc:0.71722	train-aucpr:0.32998	val-logloss:0.47481	val-auc:0.70529	val-aucpr:0.21929
[90]	train-logloss:0.58971	train-auc:0.72095	train-aucpr:0.33368	val-logloss:0.47785	val-auc:0.70269	val-aucpr:0.21656
[100]	train-logloss:0.58678	train-auc:0.72649	train-aucpr:0.33826	val-logloss:0.47056	val-auc:0.69866	val-aucpr:0.21479
[2025-11-19 09:30:18,116] [INFO] [<frozen importlib] - Training completed at iteration 71
[2025-11-19 09:30:18,116] [INFO] [<frozen importlib] - Best train loss: 0.5952
[2025-11-19 09:30:18,116] [INFO] [<frozen importlib] - Best val loss: 0.4829
[2025-11-19 09:30:18,116] [INFO] [<frozen importlib] - Best val AUC: 0.7033
[2025-11-19 09:30:18,116] [INFO] [<frozen importlib] - Best val AUCPR: 0.2224
[2025-11-19 09:30:18,119] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:30:18] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:30:31,928] [INFO] [<frozen importlib] - Optimal threshold: 0.4819
[2025-11-19 09:30:31,928] [INFO] [<frozen importlib] - Best f1: 0.2770
[2025-11-19 09:30:31,928] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:30:31,970] [INFO] [<frozen importlib] - Validation Results (threshold=0.4819):
[2025-11-19 09:30:31,970] [INFO] [<frozen importlib] -   Accuracy: 0.9063
[2025-11-19 09:30:31,970] [INFO] [<frozen importlib] -   Precision: 0.3404
[2025-11-19 09:30:31,970] [INFO] [<frozen importlib] -   Recall: 0.2335
[2025-11-19 09:30:31,970] [INFO] [<frozen importlib] -   F1 Score: 0.2770
[2025-11-19 09:30:31,970] [INFO] [<frozen importlib] -   AUROC: 0.7033
[2025-11-19 09:30:31,970] [INFO] [<frozen importlib] -   AUPRC: 0.2231
[2025-11-19 09:30:31,970] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:30:31,970] [INFO] [<frozen importlib] -     TN=16788, FP=657
[2025-11-19 09:30:31,970] [INFO] [<frozen importlib] -     FN=1113, TP=339
[2025-11-19 09:30:31,993] [INFO] [<frozen importlib] - Trial 404: AUPRC=0.2231, F1=0.4561, Prec=0.4867, Rec=0.4291 | Optimizing auprc=0.2231
[2025-11-19 09:30:31,996] [INFO] [<frozen importlib] - Trial 404 pruned.
[2025-11-19 09:30:31,996] [ERROR] [<frozen importlib] - Trial 404 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  81%|████████  | 404/500 [1:08:29<16:25, 10.27s/it]Best trial: 289. Best value: 0.241792:  81%|████████  | 404/500 [1:08:29<16:25, 10.27s/it]Best trial: 289. Best value: 0.241792:  81%|████████  | 405/500 [1:08:29<19:54, 12.57s/it][2025-11-19 09:30:32,008] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.066421628141692
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   gamma: 0.12294296692154452
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   alpha: 1.7763232138736589
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   lambda: 0.5313581784851045
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   learning_rate: 0.031986020967151606
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   subsample: 0.783183651669198
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   colsample_bytree: 0.6090964944104068
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5098518514364424
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   colsample_bynode: 0.749669900181835
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:30:32,009] [INFO] [<frozen importlib] -   scale_pos_weight: 6.066421628141692
[2025-11-19 09:30:32,080] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:30:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:30:31,996] Trial 404 pruned. 
[0]	train-logloss:0.64802	train-auc:0.64253	train-aucpr:0.24779	val-logloss:0.63945	val-auc:0.58658	val-aucpr:0.13287
[10]	train-logloss:0.62819	train-auc:0.68149	train-aucpr:0.29397	val-logloss:0.59003	val-auc:0.71232	val-aucpr:0.23285
[20]	train-logloss:0.61510	train-auc:0.68719	train-aucpr:0.29962	val-logloss:0.55140	val-auc:0.71041	val-aucpr:0.22785
[30]	train-logloss:0.60570	train-auc:0.69073	train-aucpr:0.30322	val-logloss:0.53185	val-auc:0.70774	val-aucpr:0.22735
[35]	train-logloss:0.60224	train-auc:0.69177	train-aucpr:0.30421	val-logloss:0.51871	val-auc:0.70874	val-aucpr:0.22573
[2025-11-19 09:30:32,632] [INFO] [<frozen importlib] - Training completed at iteration 6
[2025-11-19 09:30:32,632] [INFO] [<frozen importlib] - Best train loss: 0.6350
[2025-11-19 09:30:32,632] [INFO] [<frozen importlib] - Best val loss: 0.6061
[2025-11-19 09:30:32,632] [INFO] [<frozen importlib] - Best val AUC: 0.7047
[2025-11-19 09:30:32,632] [INFO] [<frozen importlib] - Best val AUCPR: 0.2338
[2025-11-19 09:30:32,635] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:30:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:30:33,532] [INFO] [<frozen importlib] - Optimal threshold: 0.4665
[2025-11-19 09:30:33,532] [INFO] [<frozen importlib] - Best f1: 0.2856
[2025-11-19 09:30:33,532] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:30:33,574] [INFO] [<frozen importlib] - Validation Results (threshold=0.4665):
[2025-11-19 09:30:33,574] [INFO] [<frozen importlib] -   Accuracy: 0.9036
[2025-11-19 09:30:33,575] [INFO] [<frozen importlib] -   Precision: 0.3318
[2025-11-19 09:30:33,575] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 09:30:33,575] [INFO] [<frozen importlib] -   F1 Score: 0.2856
[2025-11-19 09:30:33,575] [INFO] [<frozen importlib] -   AUROC: 0.7047
[2025-11-19 09:30:33,575] [INFO] [<frozen importlib] -   AUPRC: 0.2242
[2025-11-19 09:30:33,575] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:30:33,575] [INFO] [<frozen importlib] -     TN=16712, FP=733
[2025-11-19 09:30:33,575] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 09:30:33,596] [INFO] [<frozen importlib] - Trial 405: AUPRC=0.2242, F1=0.4645, Prec=0.4742, Rec=0.4552 | Optimizing auprc=0.2242
                                                                                          Best trial: 289. Best value: 0.241792:  81%|████████  | 405/500 [1:08:31<19:54, 12.57s/it]Best trial: 289. Best value: 0.241792:  81%|████████  | 405/500 [1:08:31<19:54, 12.57s/it]Best trial: 289. Best value: 0.241792:  81%|████████  | 406/500 [1:08:31<14:32,  9.28s/it][2025-11-19 09:30:33,609] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.734511489822059
[2025-11-19 09:30:33,609] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:30:33,609] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:30:33,609] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   min_child_weight: 1
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   gamma: 0.24251969963228182
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   alpha: 0.47584554149148467
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   lambda: 1.0685643102452762
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   learning_rate: 0.03382857119942371
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   subsample: 0.8073280548786905
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   colsample_bytree: 0.5994408374034276
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5178617835557005
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   colsample_bynode: 0.7606546545948597
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:30:33,610] [INFO] [<frozen importlib] -   scale_pos_weight: 6.734511489822059
[2025-11-19 09:30:33,683] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:30:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:30:33,596] Trial 405 finished with value: 0.22419992474422654 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.12294296692154452, 'learning_rate': 0.031986020967151606, 'n_estimators': 450, 'alpha': 1.7763232138736589, 'lambda': 0.5313581784851045, 'subsample': 0.783183651669198, 'colsample_bytree': 0.6090964944104068, 'colsample_bylevel': 0.5098518514364424, 'colsample_bynode': 0.749669900181835, 'scale_pos_weight': 6.066421628141692}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.68511	train-auc:0.63531	train-aucpr:0.22027	val-logloss:0.68170	val-auc:0.61467	val-aucpr:0.12098
[10]	train-logloss:0.66284	train-auc:0.68104	train-aucpr:0.28739	val-logloss:0.63296	val-auc:0.69131	val-aucpr:0.19433
[20]	train-logloss:0.64869	train-auc:0.68572	train-aucpr:0.29493	val-logloss:0.60061	val-auc:0.68692	val-aucpr:0.20750
[30]	train-logloss:0.63842	train-auc:0.69077	train-aucpr:0.30084	val-logloss:0.56780	val-auc:0.69496	val-aucpr:0.22008
[40]	train-logloss:0.63120	train-auc:0.69565	train-aucpr:0.30458	val-logloss:0.54599	val-auc:0.70689	val-aucpr:0.22737
[50]	train-logloss:0.62519	train-auc:0.69921	train-aucpr:0.30888	val-logloss:0.53097	val-auc:0.70906	val-aucpr:0.22989
[60]	train-logloss:0.62089	train-auc:0.70409	train-aucpr:0.31331	val-logloss:0.51907	val-auc:0.70987	val-aucpr:0.22847
[70]	train-logloss:0.61711	train-auc:0.70705	train-aucpr:0.31688	val-logloss:0.51808	val-auc:0.70752	val-aucpr:0.22528
[75]	train-logloss:0.61541	train-auc:0.70952	train-aucpr:0.31958	val-logloss:0.51654	val-auc:0.71008	val-aucpr:0.22288
[2025-11-19 09:30:33,930] [INFO] [<frozen importlib] - Training completed at iteration 46
[2025-11-19 09:30:33,930] [INFO] [<frozen importlib] - Best train loss: 0.6272
[2025-11-19 09:30:33,930] [INFO] [<frozen importlib] - Best val loss: 0.5328
[2025-11-19 09:30:33,930] [INFO] [<frozen importlib] - Best val AUC: 0.7082
[2025-11-19 09:30:33,930] [INFO] [<frozen importlib] - Best val AUCPR: 0.2314
[2025-11-19 09:30:33,933] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:30:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:30:43,801] [INFO] [<frozen importlib] - Optimal threshold: 0.4773
[2025-11-19 09:30:43,802] [INFO] [<frozen importlib] - Best f1: 0.2889
[2025-11-19 09:30:43,802] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:30:43,843] [INFO] [<frozen importlib] - Validation Results (threshold=0.4773):
[2025-11-19 09:30:43,843] [INFO] [<frozen importlib] -   Accuracy: 0.8963
[2025-11-19 09:30:43,843] [INFO] [<frozen importlib] -   Precision: 0.3054
[2025-11-19 09:30:43,843] [INFO] [<frozen importlib] -   Recall: 0.2741
[2025-11-19 09:30:43,843] [INFO] [<frozen importlib] -   F1 Score: 0.2889
[2025-11-19 09:30:43,843] [INFO] [<frozen importlib] -   AUROC: 0.7082
[2025-11-19 09:30:43,843] [INFO] [<frozen importlib] -   AUPRC: 0.2319
[2025-11-19 09:30:43,843] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:30:43,843] [INFO] [<frozen importlib] -     TN=16540, FP=905
[2025-11-19 09:30:43,843] [INFO] [<frozen importlib] -     FN=1054, TP=398
[2025-11-19 09:30:43,867] [INFO] [<frozen importlib] - Trial 406: AUPRC=0.2319, F1=0.4391, Prec=0.4228, Rec=0.4566 | Optimizing auprc=0.2319
                                                                                          Best trial: 289. Best value: 0.241792:  81%|████████  | 406/500 [1:08:41<14:32,  9.28s/it]Best trial: 289. Best value: 0.241792:  81%|████████  | 406/500 [1:08:41<14:32,  9.28s/it]Best trial: 289. Best value: 0.241792:  81%|████████▏ | 407/500 [1:08:41<14:50,  9.58s/it][2025-11-19 09:30:43,880] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.76758600978244
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   gamma: 0.3788424135798506
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   alpha: 0.5716442337093599
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   lambda: 0.9446670003291807
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   learning_rate: 0.036555340222890434
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   subsample: 0.8622096795262617
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   colsample_bytree: 0.5832733835628139
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5289959372966928
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   colsample_bynode: 0.8192627727148591
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:30:43,881] [INFO] [<frozen importlib] -   scale_pos_weight: 5.76758600978244
[2025-11-19 09:30:43,951] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:30:43] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:30:43,867] Trial 406 finished with value: 0.23192945125757744 and parameters: {'max_depth': 4, 'min_child_weight': 1, 'gamma': 0.24251969963228182, 'learning_rate': 0.03382857119942371, 'n_estimators': 450, 'alpha': 0.47584554149148467, 'lambda': 1.0685643102452762, 'subsample': 0.8073280548786905, 'colsample_bytree': 0.5994408374034276, 'colsample_bylevel': 0.5178617835557005, 'colsample_bynode': 0.7606546545948597, 'scale_pos_weight': 6.734511489822059}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.63103	train-auc:0.63970	train-aucpr:0.23754	val-logloss:0.61929	val-auc:0.62678	val-aucpr:0.12586
[10]	train-logloss:0.61023	train-auc:0.67913	train-aucpr:0.29009	val-logloss:0.57081	val-auc:0.69816	val-aucpr:0.20068
[20]	train-logloss:0.59642	train-auc:0.68831	train-aucpr:0.29741	val-logloss:0.53340	val-auc:0.70526	val-aucpr:0.21739
[30]	train-logloss:0.58699	train-auc:0.69380	train-aucpr:0.30487	val-logloss:0.52316	val-auc:0.70375	val-aucpr:0.22055
[40]	train-logloss:0.58044	train-auc:0.69718	train-aucpr:0.30830	val-logloss:0.50812	val-auc:0.70804	val-aucpr:0.22621
[50]	train-logloss:0.57477	train-auc:0.70214	train-aucpr:0.31469	val-logloss:0.49542	val-auc:0.71282	val-aucpr:0.23296
[60]	train-logloss:0.57096	train-auc:0.70519	train-aucpr:0.31827	val-logloss:0.49388	val-auc:0.71061	val-aucpr:0.23172
[70]	train-logloss:0.56783	train-auc:0.70835	train-aucpr:0.32117	val-logloss:0.48814	val-auc:0.70971	val-aucpr:0.23221
[80]	train-logloss:0.56535	train-auc:0.71110	train-aucpr:0.32462	val-logloss:0.48422	val-auc:0.70970	val-aucpr:0.23234
[81]	train-logloss:0.56517	train-auc:0.71149	train-aucpr:0.32485	val-logloss:0.48408	val-auc:0.71031	val-aucpr:0.23260
[2025-11-19 09:30:47,262] [INFO] [<frozen importlib] - Training completed at iteration 52
[2025-11-19 09:30:47,262] [INFO] [<frozen importlib] - Best train loss: 0.5740
[2025-11-19 09:30:47,262] [INFO] [<frozen importlib] - Best val loss: 0.4922
[2025-11-19 09:30:47,262] [INFO] [<frozen importlib] - Best val AUC: 0.7125
[2025-11-19 09:30:47,262] [INFO] [<frozen importlib] - Best val AUCPR: 0.2346
[2025-11-19 09:30:47,265] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:30:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:30:58,757] [INFO] [<frozen importlib] - Optimal threshold: 0.4590
[2025-11-19 09:30:58,757] [INFO] [<frozen importlib] - Best f1: 0.2707
[2025-11-19 09:30:58,757] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:30:58,802] [INFO] [<frozen importlib] - Validation Results (threshold=0.4590):
[2025-11-19 09:30:58,802] [INFO] [<frozen importlib] -   Accuracy: 0.8956
[2025-11-19 09:30:58,802] [INFO] [<frozen importlib] -   Precision: 0.2923
[2025-11-19 09:30:58,802] [INFO] [<frozen importlib] -   Recall: 0.2521
[2025-11-19 09:30:58,802] [INFO] [<frozen importlib] -   F1 Score: 0.2707
[2025-11-19 09:30:58,802] [INFO] [<frozen importlib] -   AUROC: 0.7125
[2025-11-19 09:30:58,802] [INFO] [<frozen importlib] -   AUPRC: 0.2349
[2025-11-19 09:30:58,802] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:30:58,803] [INFO] [<frozen importlib] -     TN=16559, FP=886
[2025-11-19 09:30:58,803] [INFO] [<frozen importlib] -     FN=1086, TP=366
[2025-11-19 09:30:58,825] [INFO] [<frozen importlib] - Trial 407: AUPRC=0.2349, F1=0.4511, Prec=0.4346, Rec=0.4690 | Optimizing auprc=0.2349
                                                                                          Best trial: 289. Best value: 0.241792:  81%|████████▏ | 407/500 [1:08:56<14:50,  9.58s/it]Best trial: 289. Best value: 0.241792:  81%|████████▏ | 407/500 [1:08:56<14:50,  9.58s/it]Best trial: 289. Best value: 0.241792:  82%|████████▏ | 408/500 [1:08:56<17:09, 11.19s/it][2025-11-19 09:30:58,839] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.678339939198347
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   gamma: 0.41732730855708633
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   alpha: 0.5815463251146207
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   lambda: 1.003689313310172
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   learning_rate: 0.036350083339488026
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   subsample: 0.8639161262900042
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   colsample_bytree: 0.5827435233337737
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5413460393423573
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   colsample_bynode: 0.833032654838694
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:30:58,839] [INFO] [<frozen importlib] -   scale_pos_weight: 5.678339939198347
[2025-11-19 09:30:58,910] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:30:58] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:30:58,826] Trial 407 finished with value: 0.2349108338547642 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.3788424135798506, 'learning_rate': 0.036555340222890434, 'n_estimators': 350, 'alpha': 0.5716442337093599, 'lambda': 0.9446670003291807, 'subsample': 0.8622096795262617, 'colsample_bytree': 0.5832733835628139, 'colsample_bylevel': 0.5289959372966928, 'colsample_bynode': 0.8192627727148591, 'scale_pos_weight': 5.76758600978244}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.62602	train-auc:0.63820	train-aucpr:0.23666	val-logloss:0.61336	val-auc:0.62814	val-aucpr:0.13316
[10]	train-logloss:0.60483	train-auc:0.68135	train-aucpr:0.29374	val-logloss:0.56991	val-auc:0.69635	val-aucpr:0.20981
[20]	train-logloss:0.59146	train-auc:0.68814	train-aucpr:0.29918	val-logloss:0.54419	val-auc:0.71156	val-aucpr:0.21856
[30]	train-logloss:0.58216	train-auc:0.69460	train-aucpr:0.30408	val-logloss:0.51472	val-auc:0.70995	val-aucpr:0.22459
[40]	train-logloss:0.57564	train-auc:0.69821	train-aucpr:0.30792	val-logloss:0.49807	val-auc:0.70944	val-aucpr:0.22636
[50]	train-logloss:0.57034	train-auc:0.70211	train-aucpr:0.31314	val-logloss:0.48602	val-auc:0.71217	val-aucpr:0.23040
[60]	train-logloss:0.56676	train-auc:0.70474	train-aucpr:0.31638	val-logloss:0.47503	val-auc:0.70853	val-aucpr:0.23418
[70]	train-logloss:0.56380	train-auc:0.70779	train-aucpr:0.31928	val-logloss:0.46978	val-auc:0.70931	val-aucpr:0.23196
[80]	train-logloss:0.56095	train-auc:0.71167	train-aucpr:0.32334	val-logloss:0.45823	val-auc:0.69603	val-aucpr:0.22313
[85]	train-logloss:0.55971	train-auc:0.71349	train-aucpr:0.32534	val-logloss:0.45038	val-auc:0.69088	val-aucpr:0.21339
[2025-11-19 09:31:01,928] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:31:01,928] [INFO] [<frozen importlib] - Best train loss: 0.5681
[2025-11-19 09:31:01,928] [INFO] [<frozen importlib] - Best val loss: 0.4812
[2025-11-19 09:31:01,928] [INFO] [<frozen importlib] - Best val AUC: 0.7128
[2025-11-19 09:31:01,928] [INFO] [<frozen importlib] - Best val AUCPR: 0.2351
[2025-11-19 09:31:01,931] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:31:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:31:12,319] [INFO] [<frozen importlib] - Optimal threshold: 0.4530
[2025-11-19 09:31:12,319] [INFO] [<frozen importlib] - Best f1: 0.2773
[2025-11-19 09:31:12,319] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:31:12,362] [INFO] [<frozen importlib] - Validation Results (threshold=0.4530):
[2025-11-19 09:31:12,363] [INFO] [<frozen importlib] -   Accuracy: 0.9018
[2025-11-19 09:31:12,363] [INFO] [<frozen importlib] -   Precision: 0.3190
[2025-11-19 09:31:12,363] [INFO] [<frozen importlib] -   Recall: 0.2452
[2025-11-19 09:31:12,363] [INFO] [<frozen importlib] -   F1 Score: 0.2773
[2025-11-19 09:31:12,363] [INFO] [<frozen importlib] -   AUROC: 0.7128
[2025-11-19 09:31:12,363] [INFO] [<frozen importlib] -   AUPRC: 0.2354
[2025-11-19 09:31:12,363] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:31:12,363] [INFO] [<frozen importlib] -     TN=16685, FP=760
[2025-11-19 09:31:12,363] [INFO] [<frozen importlib] -     FN=1096, TP=356
[2025-11-19 09:31:12,389] [INFO] [<frozen importlib] - Trial 408: AUPRC=0.2354, F1=0.4548, Prec=0.4614, Rec=0.4483 | Optimizing auprc=0.2354
                                                                                          Best trial: 289. Best value: 0.241792:  82%|████████▏ | 408/500 [1:09:10<17:09, 11.19s/it]Best trial: 289. Best value: 0.241792:  82%|████████▏ | 408/500 [1:09:10<17:09, 11.19s/it]Best trial: 289. Best value: 0.241792:  82%|████████▏ | 409/500 [1:09:10<18:03, 11.90s/it][2025-11-19 09:31:12,402] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.637886648787425
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   gamma: 0.4352785925452781
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   alpha: 0.5824257567733814
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   lambda: 0.9656333521224606
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   learning_rate: 0.03644463191930497
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   subsample: 0.8665112022943965
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   colsample_bytree: 0.5712975119793581
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5551037681349557
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   colsample_bynode: 0.8429311601988575
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:31:12,402] [INFO] [<frozen importlib] -   scale_pos_weight: 5.637886648787425
[2025-11-19 09:31:12,478] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:31:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:31:12,390] Trial 408 finished with value: 0.2354160318306208 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.41732730855708633, 'learning_rate': 0.036350083339488026, 'n_estimators': 350, 'alpha': 0.5815463251146207, 'lambda': 1.003689313310172, 'subsample': 0.8639161262900042, 'colsample_bytree': 0.5827435233337737, 'colsample_bylevel': 0.5413460393423573, 'colsample_bynode': 0.833032654838694, 'scale_pos_weight': 5.678339939198347}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.62372	train-auc:0.63820	train-aucpr:0.23666	val-logloss:0.61071	val-auc:0.62813	val-aucpr:0.13316
[10]	train-logloss:0.60265	train-auc:0.68335	train-aucpr:0.29108	val-logloss:0.55625	val-auc:0.70647	val-aucpr:0.21224
[20]	train-logloss:0.58913	train-auc:0.68844	train-aucpr:0.29835	val-logloss:0.52258	val-auc:0.71236	val-aucpr:0.21717
[30]	train-logloss:0.57992	train-auc:0.69528	train-aucpr:0.30459	val-logloss:0.50305	val-auc:0.71116	val-aucpr:0.22389
[40]	train-logloss:0.57358	train-auc:0.69768	train-aucpr:0.30780	val-logloss:0.49015	val-auc:0.70783	val-aucpr:0.22300
[50]	train-logloss:0.56832	train-auc:0.70160	train-aucpr:0.31293	val-logloss:0.48088	val-auc:0.70474	val-aucpr:0.22050
[58]	train-logloss:0.56509	train-auc:0.70442	train-aucpr:0.31694	val-logloss:0.47909	val-auc:0.70407	val-aucpr:0.21790
[2025-11-19 09:31:14,013] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 09:31:14,013] [INFO] [<frozen importlib] - Best train loss: 0.5807
[2025-11-19 09:31:14,013] [INFO] [<frozen importlib] - Best val loss: 0.4983
[2025-11-19 09:31:14,013] [INFO] [<frozen importlib] - Best val AUC: 0.7125
[2025-11-19 09:31:14,013] [INFO] [<frozen importlib] - Best val AUCPR: 0.2252
[2025-11-19 09:31:14,016] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:31:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:31:20,522] [INFO] [<frozen importlib] - Optimal threshold: 0.4348
[2025-11-19 09:31:20,522] [INFO] [<frozen importlib] - Best f1: 0.2819
[2025-11-19 09:31:20,522] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:31:20,570] [INFO] [<frozen importlib] - Validation Results (threshold=0.4348):
[2025-11-19 09:31:20,570] [INFO] [<frozen importlib] -   Accuracy: 0.8995
[2025-11-19 09:31:20,570] [INFO] [<frozen importlib] -   Precision: 0.3124
[2025-11-19 09:31:20,570] [INFO] [<frozen importlib] -   Recall: 0.2569
[2025-11-19 09:31:20,570] [INFO] [<frozen importlib] -   F1 Score: 0.2819
[2025-11-19 09:31:20,570] [INFO] [<frozen importlib] -   AUROC: 0.7125
[2025-11-19 09:31:20,570] [INFO] [<frozen importlib] -   AUPRC: 0.2257
[2025-11-19 09:31:20,570] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:31:20,570] [INFO] [<frozen importlib] -     TN=16624, FP=821
[2025-11-19 09:31:20,570] [INFO] [<frozen importlib] -     FN=1079, TP=373
[2025-11-19 09:31:20,595] [INFO] [<frozen importlib] - Trial 409: AUPRC=0.2257, F1=0.4463, Prec=0.4430, Rec=0.4497 | Optimizing auprc=0.2257
[2025-11-19 09:31:20,596] [INFO] [<frozen importlib] - Trial 409 pruned.
[2025-11-19 09:31:20,596] [ERROR] [<frozen importlib] - Trial 409 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  82%|████████▏ | 409/500 [1:09:18<18:03, 11.90s/it]Best trial: 289. Best value: 0.241792:  82%|████████▏ | 409/500 [1:09:18<18:03, 11.90s/it]Best trial: 289. Best value: 0.241792:  82%|████████▏ | 410/500 [1:09:18<16:11, 10.79s/it][2025-11-19 09:31:20,610] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.372271136763621
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   gamma: 0.3905635485295833
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   alpha: 1.4442634481162646
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   lambda: 0.9262326109329592
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   learning_rate: 0.03530683129634792
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   subsample: 0.8824235101953759
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   colsample_bytree: 0.5846421444626522
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5463578230164385
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   colsample_bynode: 0.8206307115084487
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:31:20,611] [INFO] [<frozen importlib] -   scale_pos_weight: 5.372271136763621
[2025-11-19 09:31:20,683] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:31:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:31:20,596] Trial 409 pruned. 
[0]	train-logloss:0.60863	train-auc:0.63947	train-aucpr:0.23253	val-logloss:0.59358	val-auc:0.62829	val-aucpr:0.13489
[10]	train-logloss:0.58871	train-auc:0.68050	train-aucpr:0.28930	val-logloss:0.54898	val-auc:0.67796	val-aucpr:0.19216
[20]	train-logloss:0.57597	train-auc:0.68641	train-aucpr:0.29989	val-logloss:0.52185	val-auc:0.68563	val-aucpr:0.20028
[30]	train-logloss:0.56730	train-auc:0.69138	train-aucpr:0.30535	val-logloss:0.49557	val-auc:0.70971	val-aucpr:0.21980
[40]	train-logloss:0.56096	train-auc:0.69562	train-aucpr:0.30897	val-logloss:0.48319	val-auc:0.70356	val-aucpr:0.21746
[50]	train-logloss:0.55580	train-auc:0.70029	train-aucpr:0.31355	val-logloss:0.46564	val-auc:0.70768	val-aucpr:0.22014
[60]	train-logloss:0.55199	train-auc:0.70361	train-aucpr:0.31760	val-logloss:0.45881	val-auc:0.70716	val-aucpr:0.22442
[70]	train-logloss:0.54880	train-auc:0.70709	train-aucpr:0.32090	val-logloss:0.45791	val-auc:0.71199	val-aucpr:0.22601
[80]	train-logloss:0.54626	train-auc:0.71003	train-aucpr:0.32412	val-logloss:0.44690	val-auc:0.71225	val-aucpr:0.22540
[90]	train-logloss:0.54366	train-auc:0.71447	train-aucpr:0.32867	val-logloss:0.43154	val-auc:0.71279	val-aucpr:0.22477
[100]	train-logloss:0.54150	train-auc:0.71772	train-aucpr:0.33203	val-logloss:0.43118	val-auc:0.71186	val-aucpr:0.22491
[101]	train-logloss:0.54122	train-auc:0.71797	train-aucpr:0.33241	val-logloss:0.43066	val-auc:0.71216	val-aucpr:0.22500
[2025-11-19 09:31:24,414] [INFO] [<frozen importlib] - Training completed at iteration 72
[2025-11-19 09:31:24,414] [INFO] [<frozen importlib] - Best train loss: 0.5483
[2025-11-19 09:31:24,414] [INFO] [<frozen importlib] - Best val loss: 0.4580
[2025-11-19 09:31:24,414] [INFO] [<frozen importlib] - Best val AUC: 0.7115
[2025-11-19 09:31:24,414] [INFO] [<frozen importlib] - Best val AUCPR: 0.2265
[2025-11-19 09:31:24,417] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:31:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:31:38,387] [INFO] [<frozen importlib] - Optimal threshold: 0.4423
[2025-11-19 09:31:38,387] [INFO] [<frozen importlib] - Best f1: 0.2731
[2025-11-19 09:31:38,387] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:31:38,428] [INFO] [<frozen importlib] - Validation Results (threshold=0.4423):
[2025-11-19 09:31:38,428] [INFO] [<frozen importlib] -   Accuracy: 0.8932
[2025-11-19 09:31:38,428] [INFO] [<frozen importlib] -   Precision: 0.2863
[2025-11-19 09:31:38,428] [INFO] [<frozen importlib] -   Recall: 0.2610
[2025-11-19 09:31:38,428] [INFO] [<frozen importlib] -   F1 Score: 0.2731
[2025-11-19 09:31:38,428] [INFO] [<frozen importlib] -   AUROC: 0.7115
[2025-11-19 09:31:38,428] [INFO] [<frozen importlib] -   AUPRC: 0.2269
[2025-11-19 09:31:38,428] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:31:38,428] [INFO] [<frozen importlib] -     TN=16500, FP=945
[2025-11-19 09:31:38,428] [INFO] [<frozen importlib] -     FN=1073, TP=379
[2025-11-19 09:31:38,453] [INFO] [<frozen importlib] - Trial 410: AUPRC=0.2269, F1=0.4659, Prec=0.4351, Rec=0.5014 | Optimizing auprc=0.2269
                                                                                          Best trial: 289. Best value: 0.241792:  82%|████████▏ | 410/500 [1:09:36<16:11, 10.79s/it]Best trial: 289. Best value: 0.241792:  82%|████████▏ | 410/500 [1:09:36<16:11, 10.79s/it]Best trial: 289. Best value: 0.241792:  82%|████████▏ | 411/500 [1:09:36<19:09, 12.91s/it][2025-11-19 09:31:38,466] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.830497204216171
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   gamma: 0.3603805531838469
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   alpha: 0.5483922468848091
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   lambda: 1.1098363381280467
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   learning_rate: 0.03694627772350874
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   subsample: 0.8618178919688784
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   colsample_bytree: 0.5927881886392726
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5306683706194723
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   colsample_bynode: 0.8324119273052574
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:31:38,466] [INFO] [<frozen importlib] -   scale_pos_weight: 5.830497204216171
[2025-11-19 09:31:38,541] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:31:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:31:38,453] Trial 410 finished with value: 0.22686802024923405 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.3905635485295833, 'learning_rate': 0.03530683129634792, 'n_estimators': 350, 'alpha': 1.4442634481162646, 'lambda': 0.9262326109329592, 'subsample': 0.8824235101953759, 'colsample_bytree': 0.5846421444626522, 'colsample_bylevel': 0.5463578230164385, 'colsample_bynode': 0.8206307115084487, 'scale_pos_weight': 5.372271136763621}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.63471	train-auc:0.63857	train-aucpr:0.22153	val-logloss:0.62303	val-auc:0.61553	val-aucpr:0.12776
[10]	train-logloss:0.61298	train-auc:0.68139	train-aucpr:0.29055	val-logloss:0.58105	val-auc:0.65511	val-aucpr:0.16984
[20]	train-logloss:0.59932	train-auc:0.68711	train-aucpr:0.29749	val-logloss:0.54733	val-auc:0.66719	val-aucpr:0.19716
[30]	train-logloss:0.58985	train-auc:0.69111	train-aucpr:0.30341	val-logloss:0.51775	val-auc:0.67380	val-aucpr:0.21286
[40]	train-logloss:0.58342	train-auc:0.69509	train-aucpr:0.30837	val-logloss:0.50235	val-auc:0.69192	val-aucpr:0.22447
[50]	train-logloss:0.57801	train-auc:0.70009	train-aucpr:0.31362	val-logloss:0.48456	val-auc:0.69614	val-aucpr:0.22686
[60]	train-logloss:0.57388	train-auc:0.70420	train-aucpr:0.31805	val-logloss:0.47977	val-auc:0.70390	val-aucpr:0.22569
[70]	train-logloss:0.57074	train-auc:0.70756	train-aucpr:0.32162	val-logloss:0.46969	val-auc:0.70842	val-aucpr:0.23008
[80]	train-logloss:0.56804	train-auc:0.71213	train-aucpr:0.32604	val-logloss:0.44674	val-auc:0.70709	val-aucpr:0.22692
[90]	train-logloss:0.56550	train-auc:0.71596	train-aucpr:0.32971	val-logloss:0.44773	val-auc:0.70571	val-aucpr:0.22391
[100]	train-logloss:0.56328	train-auc:0.71896	train-aucpr:0.33329	val-logloss:0.43376	val-auc:0.70945	val-aucpr:0.22214
[2025-11-19 09:31:41,721] [INFO] [<frozen importlib] - Training completed at iteration 70
[2025-11-19 09:31:41,721] [INFO] [<frozen importlib] - Best train loss: 0.5707
[2025-11-19 09:31:41,721] [INFO] [<frozen importlib] - Best val loss: 0.4697
[2025-11-19 09:31:41,721] [INFO] [<frozen importlib] - Best val AUC: 0.7084
[2025-11-19 09:31:41,721] [INFO] [<frozen importlib] - Best val AUCPR: 0.2301
[2025-11-19 09:31:41,724] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:31:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:31:55,234] [INFO] [<frozen importlib] - Optimal threshold: 0.4548
[2025-11-19 09:31:55,234] [INFO] [<frozen importlib] - Best f1: 0.2870
[2025-11-19 09:31:55,234] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:31:55,277] [INFO] [<frozen importlib] - Validation Results (threshold=0.4548):
[2025-11-19 09:31:55,277] [INFO] [<frozen importlib] -   Accuracy: 0.9061
[2025-11-19 09:31:55,277] [INFO] [<frozen importlib] -   Precision: 0.3446
[2025-11-19 09:31:55,277] [INFO] [<frozen importlib] -   Recall: 0.2459
[2025-11-19 09:31:55,277] [INFO] [<frozen importlib] -   F1 Score: 0.2870
[2025-11-19 09:31:55,277] [INFO] [<frozen importlib] -   AUROC: 0.7084
[2025-11-19 09:31:55,277] [INFO] [<frozen importlib] -   AUPRC: 0.2305
[2025-11-19 09:31:55,277] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:31:55,277] [INFO] [<frozen importlib] -     TN=16766, FP=679
[2025-11-19 09:31:55,277] [INFO] [<frozen importlib] -     FN=1095, TP=357
[2025-11-19 09:31:55,303] [INFO] [<frozen importlib] - Trial 411: AUPRC=0.2305, F1=0.4746, Prec=0.4940, Rec=0.4566 | Optimizing auprc=0.2305
                                                                                          Best trial: 289. Best value: 0.241792:  82%|████████▏ | 411/500 [1:09:53<19:09, 12.91s/it]Best trial: 289. Best value: 0.241792:  82%|████████▏ | 411/500 [1:09:53<19:09, 12.91s/it]Best trial: 289. Best value: 0.241792:  82%|████████▏ | 412/500 [1:09:53<20:40, 14.09s/it][2025-11-19 09:31:55,319] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.519459959317915
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   gamma: 0.4098856534339031
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   alpha: 0.600997369495576
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   lambda: 0.9860560528988714
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   learning_rate: 0.03573711752547807
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   subsample: 0.8728565367985331
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   colsample_bytree: 0.5854982383494777
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5235755780056126
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   colsample_bynode: 0.8462205220866085
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:31:55,319] [INFO] [<frozen importlib] -   scale_pos_weight: 5.519459959317915
[2025-11-19 09:31:55,391] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:31:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:31:55,304] Trial 411 finished with value: 0.2304806488788722 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.3603805531838469, 'learning_rate': 0.03694627772350874, 'n_estimators': 350, 'alpha': 0.5483922468848091, 'lambda': 1.1098363381280467, 'subsample': 0.8618178919688784, 'colsample_bytree': 0.5927881886392726, 'colsample_bylevel': 0.5306683706194723, 'colsample_bynode': 0.8324119273052574, 'scale_pos_weight': 5.830497204216171}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.61718	train-auc:0.63115	train-aucpr:0.22882	val-logloss:0.60436	val-auc:0.62985	val-aucpr:0.13582
[10]	train-logloss:0.59639	train-auc:0.68060	train-aucpr:0.29139	val-logloss:0.55909	val-auc:0.66406	val-aucpr:0.18333
[20]	train-logloss:0.58335	train-auc:0.68643	train-aucpr:0.29961	val-logloss:0.52429	val-auc:0.68491	val-aucpr:0.20987
[30]	train-logloss:0.57444	train-auc:0.69099	train-aucpr:0.30485	val-logloss:0.50203	val-auc:0.70162	val-aucpr:0.21921
[40]	train-logloss:0.56809	train-auc:0.69582	train-aucpr:0.30880	val-logloss:0.49611	val-auc:0.69804	val-aucpr:0.21880
[50]	train-logloss:0.56260	train-auc:0.70203	train-aucpr:0.31464	val-logloss:0.48080	val-auc:0.69441	val-aucpr:0.21757
[60]	train-logloss:0.55877	train-auc:0.70556	train-aucpr:0.31835	val-logloss:0.47281	val-auc:0.69774	val-aucpr:0.22213
[70]	train-logloss:0.55576	train-auc:0.70804	train-aucpr:0.32131	val-logloss:0.47253	val-auc:0.69471	val-aucpr:0.22046
[80]	train-logloss:0.55300	train-auc:0.71150	train-aucpr:0.32489	val-logloss:0.46146	val-auc:0.69604	val-aucpr:0.21891
[90]	train-logloss:0.55078	train-auc:0.71404	train-aucpr:0.32816	val-logloss:0.45697	val-auc:0.69634	val-aucpr:0.21380
[94]	train-logloss:0.54994	train-auc:0.71566	train-aucpr:0.32952	val-logloss:0.45543	val-auc:0.69594	val-aucpr:0.21257
[2025-11-19 09:31:57,383] [INFO] [<frozen importlib] - Training completed at iteration 64
[2025-11-19 09:31:57,383] [INFO] [<frozen importlib] - Best train loss: 0.5576
[2025-11-19 09:31:57,383] [INFO] [<frozen importlib] - Best val loss: 0.4670
[2025-11-19 09:31:57,383] [INFO] [<frozen importlib] - Best val AUC: 0.6995
[2025-11-19 09:31:57,383] [INFO] [<frozen importlib] - Best val AUCPR: 0.2248
[2025-11-19 09:31:57,386] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:31:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:32:11,200] [INFO] [<frozen importlib] - Optimal threshold: 0.4389
[2025-11-19 09:32:11,200] [INFO] [<frozen importlib] - Best f1: 0.2749
[2025-11-19 09:32:11,200] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:32:11,244] [INFO] [<frozen importlib] - Validation Results (threshold=0.4389):
[2025-11-19 09:32:11,244] [INFO] [<frozen importlib] -   Accuracy: 0.9023
[2025-11-19 09:32:11,244] [INFO] [<frozen importlib] -   Precision: 0.3199
[2025-11-19 09:32:11,244] [INFO] [<frozen importlib] -   Recall: 0.2410
[2025-11-19 09:32:11,244] [INFO] [<frozen importlib] -   F1 Score: 0.2749
[2025-11-19 09:32:11,244] [INFO] [<frozen importlib] -   AUROC: 0.6995
[2025-11-19 09:32:11,244] [INFO] [<frozen importlib] -   AUPRC: 0.2252
[2025-11-19 09:32:11,244] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:32:11,244] [INFO] [<frozen importlib] -     TN=16701, FP=744
[2025-11-19 09:32:11,244] [INFO] [<frozen importlib] -     FN=1102, TP=350
[2025-11-19 09:32:11,267] [INFO] [<frozen importlib] - Trial 412: AUPRC=0.2252, F1=0.4681, Prec=0.4742, Rec=0.4621 | Optimizing auprc=0.2252
[2025-11-19 09:32:11,267] [INFO] [<frozen importlib] - Trial 412 pruned.
[2025-11-19 09:32:11,268] [ERROR] [<frozen importlib] - Trial 412 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  82%|████████▏ | 412/500 [1:10:09<20:40, 14.09s/it]Best trial: 289. Best value: 0.241792:  82%|████████▏ | 412/500 [1:10:09<20:40, 14.09s/it]Best trial: 289. Best value: 0.241792:  83%|████████▎ | 413/500 [1:10:09<21:15, 14.66s/it][2025-11-19 09:32:11,281] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.876033291679118
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   gamma: 0.42877407480524854
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   alpha: 0.5262414204232617
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   lambda: 1.179153171774533
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   learning_rate: 0.033441041377234894
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   subsample: 0.8521685243245706
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   colsample_bytree: 0.6004590668000755
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5000434615617421
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   colsample_bynode: 0.822631288069409
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:32:11,281] [INFO] [<frozen importlib] -   scale_pos_weight: 5.876033291679118
[2025-11-19 09:32:11,347] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:32:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:32:11,268] Trial 412 pruned. 
[0]	train-logloss:0.63725	train-auc:0.64270	train-aucpr:0.25037	val-logloss:0.62780	val-auc:0.58653	val-aucpr:0.11464
[10]	train-logloss:0.61700	train-auc:0.68227	train-aucpr:0.29163	val-logloss:0.57679	val-auc:0.68165	val-aucpr:0.18956
[20]	train-logloss:0.60414	train-auc:0.68606	train-aucpr:0.29806	val-logloss:0.54250	val-auc:0.67964	val-aucpr:0.20277
[30]	train-logloss:0.59501	train-auc:0.68978	train-aucpr:0.30386	val-logloss:0.51603	val-auc:0.70095	val-aucpr:0.21385
[40]	train-logloss:0.58824	train-auc:0.69375	train-aucpr:0.30818	val-logloss:0.49230	val-auc:0.70600	val-aucpr:0.22053
[50]	train-logloss:0.58281	train-auc:0.69698	train-aucpr:0.31203	val-logloss:0.47880	val-auc:0.70544	val-aucpr:0.22370
[60]	train-logloss:0.57887	train-auc:0.70033	train-aucpr:0.31519	val-logloss:0.46712	val-auc:0.70763	val-aucpr:0.22661
[70]	train-logloss:0.57553	train-auc:0.70368	train-aucpr:0.31878	val-logloss:0.46794	val-auc:0.70577	val-aucpr:0.22561
[80]	train-logloss:0.57238	train-auc:0.70838	train-aucpr:0.32385	val-logloss:0.46285	val-auc:0.70234	val-aucpr:0.21938
[90]	train-logloss:0.56999	train-auc:0.71188	train-aucpr:0.32679	val-logloss:0.45773	val-auc:0.70243	val-aucpr:0.21808
[100]	train-logloss:0.56775	train-auc:0.71529	train-aucpr:0.33012	val-logloss:0.45601	val-auc:0.69703	val-aucpr:0.20986
[101]	train-logloss:0.56727	train-auc:0.71599	train-aucpr:0.33117	val-logloss:0.45582	val-auc:0.69732	val-aucpr:0.21011
[2025-11-19 09:32:13,161] [INFO] [<frozen importlib] - Training completed at iteration 72
[2025-11-19 09:32:13,161] [INFO] [<frozen importlib] - Best train loss: 0.5749
[2025-11-19 09:32:13,161] [INFO] [<frozen importlib] - Best val loss: 0.4653
[2025-11-19 09:32:13,161] [INFO] [<frozen importlib] - Best val AUC: 0.7061
[2025-11-19 09:32:13,161] [INFO] [<frozen importlib] - Best val AUCPR: 0.2267
[2025-11-19 09:32:13,164] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:32:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:32:26,303] [INFO] [<frozen importlib] - Optimal threshold: 0.4463
[2025-11-19 09:32:26,303] [INFO] [<frozen importlib] - Best f1: 0.2787
[2025-11-19 09:32:26,303] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:32:26,357] [INFO] [<frozen importlib] - Validation Results (threshold=0.4463):
[2025-11-19 09:32:26,357] [INFO] [<frozen importlib] -   Accuracy: 0.8992
[2025-11-19 09:32:26,357] [INFO] [<frozen importlib] -   Precision: 0.3095
[2025-11-19 09:32:26,357] [INFO] [<frozen importlib] -   Recall: 0.2534
[2025-11-19 09:32:26,357] [INFO] [<frozen importlib] -   F1 Score: 0.2787
[2025-11-19 09:32:26,357] [INFO] [<frozen importlib] -   AUROC: 0.7061
[2025-11-19 09:32:26,357] [INFO] [<frozen importlib] -   AUPRC: 0.2272
[2025-11-19 09:32:26,357] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:32:26,357] [INFO] [<frozen importlib] -     TN=16624, FP=821
[2025-11-19 09:32:26,357] [INFO] [<frozen importlib] -     FN=1084, TP=368
[2025-11-19 09:32:26,382] [INFO] [<frozen importlib] - Trial 413: AUPRC=0.2272, F1=0.4605, Prec=0.4530, Rec=0.4683 | Optimizing auprc=0.2272
                                                                                          Best trial: 289. Best value: 0.241792:  83%|████████▎ | 413/500 [1:10:24<21:15, 14.66s/it]Best trial: 289. Best value: 0.241792:  83%|████████▎ | 413/500 [1:10:24<21:15, 14.66s/it]Best trial: 289. Best value: 0.241792:  83%|████████▎ | 414/500 [1:10:24<21:12, 14.79s/it][2025-11-19 09:32:26,396] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.012417232830503
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   gamma: 0.38415420249367754
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   alpha: 0.6161570990096119
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   lambda: 0.8408794520056583
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   learning_rate: 0.03792218649707372
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   subsample: 0.864389765443901
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   colsample_bytree: 0.6175379120213534
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5379836570615807
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   colsample_bynode: 0.8292322932217655
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:32:26,396] [INFO] [<frozen importlib] -   scale_pos_weight: 6.012417232830503
[2025-11-19 09:32:26,475] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:32:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:32:26,383] Trial 413 finished with value: 0.2271844909621933 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.42877407480524854, 'learning_rate': 0.033441041377234894, 'n_estimators': 350, 'alpha': 0.5262414204232617, 'lambda': 1.179153171774533, 'subsample': 0.8521685243245706, 'colsample_bytree': 0.6004590668000755, 'colsample_bylevel': 0.5000434615617421, 'colsample_bynode': 0.822631288069409, 'scale_pos_weight': 5.876033291679118}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.64445	train-auc:0.64891	train-aucpr:0.24253	val-logloss:0.63303	val-auc:0.63816	val-aucpr:0.15584
[10]	train-logloss:0.62137	train-auc:0.68104	train-aucpr:0.29605	val-logloss:0.57676	val-auc:0.70371	val-aucpr:0.21441
[20]	train-logloss:0.60721	train-auc:0.68737	train-aucpr:0.30207	val-logloss:0.53740	val-auc:0.70291	val-aucpr:0.21800
[30]	train-logloss:0.59796	train-auc:0.69315	train-aucpr:0.30655	val-logloss:0.50918	val-auc:0.70225	val-aucpr:0.22424
[40]	train-logloss:0.59142	train-auc:0.69720	train-aucpr:0.31113	val-logloss:0.49110	val-auc:0.69738	val-aucpr:0.21933
[50]	train-logloss:0.58608	train-auc:0.70098	train-aucpr:0.31613	val-logloss:0.48736	val-auc:0.69223	val-aucpr:0.21732
[60]	train-logloss:0.58246	train-auc:0.70417	train-aucpr:0.31850	val-logloss:0.47894	val-auc:0.69687	val-aucpr:0.22243
[62]	train-logloss:0.58188	train-auc:0.70463	train-aucpr:0.31895	val-logloss:0.47686	val-auc:0.69682	val-aucpr:0.22147
[2025-11-19 09:32:28,835] [INFO] [<frozen importlib] - Training completed at iteration 33
[2025-11-19 09:32:28,835] [INFO] [<frozen importlib] - Best train loss: 0.5957
[2025-11-19 09:32:28,835] [INFO] [<frozen importlib] - Best val loss: 0.5002
[2025-11-19 09:32:28,835] [INFO] [<frozen importlib] - Best val AUC: 0.7057
[2025-11-19 09:32:28,835] [INFO] [<frozen importlib] - Best val AUCPR: 0.2256
[2025-11-19 09:32:28,838] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:32:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:32:34,533] [INFO] [<frozen importlib] - Optimal threshold: 0.4531
[2025-11-19 09:32:34,533] [INFO] [<frozen importlib] - Best f1: 0.2599
[2025-11-19 09:32:34,533] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:32:34,579] [INFO] [<frozen importlib] - Validation Results (threshold=0.4531):
[2025-11-19 09:32:34,580] [INFO] [<frozen importlib] -   Accuracy: 0.8879
[2025-11-19 09:32:34,580] [INFO] [<frozen importlib] -   Precision: 0.2636
[2025-11-19 09:32:34,580] [INFO] [<frozen importlib] -   Recall: 0.2562
[2025-11-19 09:32:34,580] [INFO] [<frozen importlib] -   F1 Score: 0.2599
[2025-11-19 09:32:34,580] [INFO] [<frozen importlib] -   AUROC: 0.7057
[2025-11-19 09:32:34,580] [INFO] [<frozen importlib] -   AUPRC: 0.2255
[2025-11-19 09:32:34,580] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:32:34,580] [INFO] [<frozen importlib] -     TN=16406, FP=1039
[2025-11-19 09:32:34,580] [INFO] [<frozen importlib] -     FN=1080, TP=372
[2025-11-19 09:32:34,603] [INFO] [<frozen importlib] - Trial 414: AUPRC=0.2255, F1=0.4309, Prec=0.3970, Rec=0.4711 | Optimizing auprc=0.2255
                                                                                          Best trial: 289. Best value: 0.241792:  83%|████████▎ | 414/500 [1:10:32<21:12, 14.79s/it]Best trial: 289. Best value: 0.241792:  83%|████████▎ | 414/500 [1:10:32<21:12, 14.79s/it]Best trial: 289. Best value: 0.241792:  83%|████████▎ | 415/500 [1:10:32<18:09, 12.82s/it][2025-11-19 09:32:34,617] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.547909189276915
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] -   gamma: 0.4115553589662482
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] -   alpha: 0.5696004544205018
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] -   lambda: 1.0654561459824756
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] -   learning_rate: 0.039295059104524334
[2025-11-19 09:32:34,617] [INFO] [<frozen importlib] -   subsample: 0.8560193510528079
[2025-11-19 09:32:34,618] [INFO] [<frozen importlib] -   colsample_bytree: 0.5736849977021279
[2025-11-19 09:32:34,618] [INFO] [<frozen importlib] -   colsample_bylevel: 0.51247174298176
[2025-11-19 09:32:34,618] [INFO] [<frozen importlib] -   colsample_bynode: 0.8136705755599704
[2025-11-19 09:32:34,618] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:32:34,618] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:32:34,618] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:32:34,618] [INFO] [<frozen importlib] -   scale_pos_weight: 5.547909189276915
[2025-11-19 09:32:34,695] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:32:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:32:34,604] Trial 414 finished with value: 0.2255495453986958 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.38415420249367754, 'learning_rate': 0.03792218649707372, 'n_estimators': 350, 'alpha': 0.6161570990096119, 'lambda': 0.8408794520056583, 'subsample': 0.864389765443901, 'colsample_bytree': 0.6175379120213534, 'colsample_bylevel': 0.5379836570615807, 'colsample_bynode': 0.8292322932217655, 'scale_pos_weight': 6.012417232830503}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.61838	train-auc:0.64275	train-aucpr:0.23596	val-logloss:0.60568	val-auc:0.61353	val-aucpr:0.13139
[10]	train-logloss:0.59639	train-auc:0.68347	train-aucpr:0.29097	val-logloss:0.55012	val-auc:0.69784	val-aucpr:0.20353
[20]	train-logloss:0.58314	train-auc:0.68843	train-aucpr:0.29783	val-logloss:0.52134	val-auc:0.69838	val-aucpr:0.21479
[30]	train-logloss:0.57407	train-auc:0.69319	train-aucpr:0.30408	val-logloss:0.49823	val-auc:0.70100	val-aucpr:0.22120
[40]	train-logloss:0.56772	train-auc:0.69696	train-aucpr:0.30812	val-logloss:0.49614	val-auc:0.70448	val-aucpr:0.22156
[50]	train-logloss:0.56263	train-auc:0.70165	train-aucpr:0.31393	val-logloss:0.48166	val-auc:0.70907	val-aucpr:0.22749
[60]	train-logloss:0.55874	train-auc:0.70545	train-aucpr:0.31863	val-logloss:0.47434	val-auc:0.70885	val-aucpr:0.23015
[70]	train-logloss:0.55524	train-auc:0.71035	train-aucpr:0.32389	val-logloss:0.45699	val-auc:0.70634	val-aucpr:0.22846
[80]	train-logloss:0.55244	train-auc:0.71491	train-aucpr:0.32839	val-logloss:0.45756	val-auc:0.69795	val-aucpr:0.22022
[84]	train-logloss:0.55145	train-auc:0.71611	train-aucpr:0.32946	val-logloss:0.45600	val-auc:0.69816	val-aucpr:0.22020
[2025-11-19 09:32:36,926] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 09:32:36,926] [INFO] [<frozen importlib] - Best train loss: 0.5608
[2025-11-19 09:32:36,926] [INFO] [<frozen importlib] - Best val loss: 0.4748
[2025-11-19 09:32:36,926] [INFO] [<frozen importlib] - Best val AUC: 0.7096
[2025-11-19 09:32:36,926] [INFO] [<frozen importlib] - Best val AUCPR: 0.2303
[2025-11-19 09:32:36,929] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:32:36] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:32:47,892] [INFO] [<frozen importlib] - Optimal threshold: 0.4658
[2025-11-19 09:32:47,892] [INFO] [<frozen importlib] - Best f1: 0.2707
[2025-11-19 09:32:47,892] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:32:47,935] [INFO] [<frozen importlib] - Validation Results (threshold=0.4658):
[2025-11-19 09:32:47,935] [INFO] [<frozen importlib] -   Accuracy: 0.9082
[2025-11-19 09:32:47,935] [INFO] [<frozen importlib] -   Precision: 0.3474
[2025-11-19 09:32:47,935] [INFO] [<frozen importlib] -   Recall: 0.2218
[2025-11-19 09:32:47,935] [INFO] [<frozen importlib] -   F1 Score: 0.2707
[2025-11-19 09:32:47,935] [INFO] [<frozen importlib] -   AUROC: 0.7097
[2025-11-19 09:32:47,935] [INFO] [<frozen importlib] -   AUPRC: 0.2306
[2025-11-19 09:32:47,935] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:32:47,935] [INFO] [<frozen importlib] -     TN=16840, FP=605
[2025-11-19 09:32:47,935] [INFO] [<frozen importlib] -     FN=1130, TP=322
[2025-11-19 09:32:47,958] [INFO] [<frozen importlib] - Trial 415: AUPRC=0.2306, F1=0.4464, Prec=0.4941, Rec=0.4070 | Optimizing auprc=0.2306
                                                                                          Best trial: 289. Best value: 0.241792:  83%|████████▎ | 415/500 [1:10:45<18:09, 12.82s/it]Best trial: 289. Best value: 0.241792:  83%|████████▎ | 415/500 [1:10:45<18:09, 12.82s/it]Best trial: 289. Best value: 0.241792:  83%|████████▎ | 416/500 [1:10:45<18:10, 12.98s/it][2025-11-19 09:32:47,973] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.209533586912489
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   gamma: 0.16010532349764922
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   alpha: 0.65030357151326
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   lambda: 0.9879302045785894
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   learning_rate: 0.03459148889811736
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   subsample: 0.8908295465923776
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   colsample_bytree: 0.6071102079568612
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   colsample_bylevel: 0.527285305068277
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   colsample_bynode: 0.8084347942175054
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:32:47,973] [INFO] [<frozen importlib] -   scale_pos_weight: 5.209533586912489
[2025-11-19 09:32:48,048] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:32:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:32:47,959] Trial 415 finished with value: 0.2306388708031154 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.4115553589662482, 'learning_rate': 0.039295059104524334, 'n_estimators': 350, 'alpha': 0.5696004544205018, 'lambda': 1.0654561459824756, 'subsample': 0.8560193510528079, 'colsample_bytree': 0.5736849977021279, 'colsample_bylevel': 0.51247174298176, 'colsample_bynode': 0.8136705755599704, 'scale_pos_weight': 5.547909189276915}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.59926	train-auc:0.64258	train-aucpr:0.25499	val-logloss:0.58404	val-auc:0.57959	val-aucpr:0.11331
[10]	train-logloss:0.57998	train-auc:0.68150	train-aucpr:0.29591	val-logloss:0.53693	val-auc:0.69339	val-aucpr:0.21047
[20]	train-logloss:0.56744	train-auc:0.68992	train-aucpr:0.30134	val-logloss:0.50614	val-auc:0.69424	val-aucpr:0.21415
[30]	train-logloss:0.55899	train-auc:0.69374	train-aucpr:0.30550	val-logloss:0.48172	val-auc:0.70215	val-aucpr:0.21727
[40]	train-logloss:0.55258	train-auc:0.69655	train-aucpr:0.30993	val-logloss:0.46004	val-auc:0.70630	val-aucpr:0.22326
[50]	train-logloss:0.54771	train-auc:0.69885	train-aucpr:0.31290	val-logloss:0.44913	val-auc:0.70866	val-aucpr:0.22364
[60]	train-logloss:0.54383	train-auc:0.70273	train-aucpr:0.31688	val-logloss:0.44611	val-auc:0.70519	val-aucpr:0.21880
[70]	train-logloss:0.54074	train-auc:0.70657	train-aucpr:0.32105	val-logloss:0.44261	val-auc:0.70429	val-aucpr:0.21373
[76]	train-logloss:0.53921	train-auc:0.70858	train-aucpr:0.32295	val-logloss:0.44110	val-auc:0.70181	val-aucpr:0.21191
[2025-11-19 09:32:48,346] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 09:32:48,346] [INFO] [<frozen importlib] - Best train loss: 0.5491
[2025-11-19 09:32:48,346] [INFO] [<frozen importlib] - Best val loss: 0.4485
[2025-11-19 09:32:48,346] [INFO] [<frozen importlib] - Best val AUC: 0.7087
[2025-11-19 09:32:48,346] [INFO] [<frozen importlib] - Best val AUCPR: 0.2253
[2025-11-19 09:32:48,349] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:32:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:32:59,289] [INFO] [<frozen importlib] - Optimal threshold: 0.4100
[2025-11-19 09:32:59,289] [INFO] [<frozen importlib] - Best f1: 0.2805
[2025-11-19 09:32:59,289] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:32:59,343] [INFO] [<frozen importlib] - Validation Results (threshold=0.4100):
[2025-11-19 09:32:59,343] [INFO] [<frozen importlib] -   Accuracy: 0.8852
[2025-11-19 09:32:59,343] [INFO] [<frozen importlib] -   Precision: 0.2705
[2025-11-19 09:32:59,343] [INFO] [<frozen importlib] -   Recall: 0.2913
[2025-11-19 09:32:59,343] [INFO] [<frozen importlib] -   F1 Score: 0.2805
[2025-11-19 09:32:59,343] [INFO] [<frozen importlib] -   AUROC: 0.7087
[2025-11-19 09:32:59,343] [INFO] [<frozen importlib] -   AUPRC: 0.2257
[2025-11-19 09:32:59,343] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:32:59,343] [INFO] [<frozen importlib] -     TN=16304, FP=1141
[2025-11-19 09:32:59,343] [INFO] [<frozen importlib] -     FN=1029, TP=423
[2025-11-19 09:32:59,366] [INFO] [<frozen importlib] - Trial 416: AUPRC=0.2257, F1=0.4380, Prec=0.3892, Rec=0.5007 | Optimizing auprc=0.2257
                                                                                          Best trial: 289. Best value: 0.241792:  83%|████████▎ | 416/500 [1:10:57<18:10, 12.98s/it]Best trial: 289. Best value: 0.241792:  83%|████████▎ | 416/500 [1:10:57<18:10, 12.98s/it]Best trial: 289. Best value: 0.241792:  83%|████████▎ | 417/500 [1:10:57<17:18, 12.51s/it][2025-11-19 09:32:59,380] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.184697534651039
[2025-11-19 09:32:59,380] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:32:59,380] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:32:59,380] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:32:59,380] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:32:59,380] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   gamma: 0.5263421482295598
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   alpha: 0.5380064357496885
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   lambda: 0.9153088944173342
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   learning_rate: 0.03634313764256155
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   subsample: 0.8461877746817311
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   colsample_bytree: 0.6312390958590548
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5167534388213265
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   colsample_bynode: 0.8213019562073837
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:32:59,381] [INFO] [<frozen importlib] -   scale_pos_weight: 6.184697534651039
[2025-11-19 09:32:59,456] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:32:59] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:32:59,367] Trial 416 finished with value: 0.22569637158995937 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.16010532349764922, 'learning_rate': 0.03459148889811736, 'n_estimators': 350, 'alpha': 0.65030357151326, 'lambda': 0.9879302045785894, 'subsample': 0.8908295465923776, 'colsample_bytree': 0.6071102079568612, 'colsample_bylevel': 0.527285305068277, 'colsample_bynode': 0.8084347942175054, 'scale_pos_weight': 5.209533586912489}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.65433	train-auc:0.64352	train-aucpr:0.23624	val-logloss:0.64465	val-auc:0.61781	val-aucpr:0.13540
[10]	train-logloss:0.63198	train-auc:0.68074	train-aucpr:0.29311	val-logloss:0.59474	val-auc:0.66509	val-aucpr:0.19769
[20]	train-logloss:0.61787	train-auc:0.68703	train-aucpr:0.29920	val-logloss:0.55419	val-auc:0.68599	val-aucpr:0.20399
[30]	train-logloss:0.60822	train-auc:0.69303	train-aucpr:0.30521	val-logloss:0.53051	val-auc:0.69084	val-aucpr:0.21360
[40]	train-logloss:0.60131	train-auc:0.69724	train-aucpr:0.30957	val-logloss:0.51234	val-auc:0.69840	val-aucpr:0.21633
[50]	train-logloss:0.59601	train-auc:0.70047	train-aucpr:0.31349	val-logloss:0.50268	val-auc:0.70258	val-aucpr:0.22321
[60]	train-logloss:0.59212	train-auc:0.70432	train-aucpr:0.31727	val-logloss:0.50345	val-auc:0.70260	val-aucpr:0.22097
[70]	train-logloss:0.58863	train-auc:0.70781	train-aucpr:0.32086	val-logloss:0.49321	val-auc:0.69613	val-aucpr:0.21418
[80]	train-logloss:0.58569	train-auc:0.71111	train-aucpr:0.32481	val-logloss:0.48491	val-auc:0.69092	val-aucpr:0.20972
[85]	train-logloss:0.58432	train-auc:0.71246	train-aucpr:0.32615	val-logloss:0.48945	val-auc:0.68622	val-aucpr:0.20346
[2025-11-19 09:33:02,346] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 09:33:02,346] [INFO] [<frozen importlib] - Best train loss: 0.5944
[2025-11-19 09:33:02,346] [INFO] [<frozen importlib] - Best val loss: 0.5047
[2025-11-19 09:33:02,346] [INFO] [<frozen importlib] - Best val AUC: 0.7053
[2025-11-19 09:33:02,346] [INFO] [<frozen importlib] - Best val AUCPR: 0.2247
[2025-11-19 09:33:02,349] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:33:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:33:14,329] [INFO] [<frozen importlib] - Optimal threshold: 0.4798
[2025-11-19 09:33:14,329] [INFO] [<frozen importlib] - Best f1: 0.2709
[2025-11-19 09:33:14,330] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:33:14,383] [INFO] [<frozen importlib] - Validation Results (threshold=0.4798):
[2025-11-19 09:33:14,383] [INFO] [<frozen importlib] -   Accuracy: 0.9040
[2025-11-19 09:33:14,383] [INFO] [<frozen importlib] -   Precision: 0.3253
[2025-11-19 09:33:14,383] [INFO] [<frozen importlib] -   Recall: 0.2321
[2025-11-19 09:33:14,383] [INFO] [<frozen importlib] -   F1 Score: 0.2709
[2025-11-19 09:33:14,383] [INFO] [<frozen importlib] -   AUROC: 0.7053
[2025-11-19 09:33:14,383] [INFO] [<frozen importlib] -   AUPRC: 0.2252
[2025-11-19 09:33:14,383] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:33:14,383] [INFO] [<frozen importlib] -     TN=16746, FP=699
[2025-11-19 09:33:14,383] [INFO] [<frozen importlib] -     FN=1115, TP=337
[2025-11-19 09:33:14,410] [INFO] [<frozen importlib] - Trial 417: AUPRC=0.2252, F1=0.4564, Prec=0.4764, Rec=0.4380 | Optimizing auprc=0.2252
[2025-11-19 09:33:14,410] [INFO] [<frozen importlib] - Trial 417 pruned.
[2025-11-19 09:33:14,410] [ERROR] [<frozen importlib] - Trial 417 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  83%|████████▎ | 417/500 [1:11:12<17:18, 12.51s/it]Best trial: 289. Best value: 0.241792:  83%|████████▎ | 417/500 [1:11:12<17:18, 12.51s/it]Best trial: 289. Best value: 0.241792:  84%|████████▎ | 418/500 [1:11:12<18:08, 13.27s/it][2025-11-19 09:33:14,424] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.768740120651225
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   gamma: 0.3808722528450806
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   alpha: 0.4880468706859852
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   lambda: 1.1395920389485044
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   learning_rate: 0.03796690815350517
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   subsample: 0.8751107799562833
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   colsample_bytree: 0.5938015833228193
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5498648645121162
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   colsample_bynode: 0.8462741600075997
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:33:14,424] [INFO] [<frozen importlib] -   scale_pos_weight: 5.768740120651225
[2025-11-19 09:33:14,511] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:33:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:33:14,410] Trial 417 pruned. 
[0]	train-logloss:0.63131	train-auc:0.62724	train-aucpr:0.23497	val-logloss:0.62034	val-auc:0.65014	val-aucpr:0.15835
[10]	train-logloss:0.60902	train-auc:0.68298	train-aucpr:0.28653	val-logloss:0.57141	val-auc:0.67782	val-aucpr:0.19294
[20]	train-logloss:0.59494	train-auc:0.69029	train-aucpr:0.29893	val-logloss:0.53698	val-auc:0.69428	val-aucpr:0.20411
[30]	train-logloss:0.58542	train-auc:0.69561	train-aucpr:0.30447	val-logloss:0.50589	val-auc:0.69151	val-aucpr:0.21277
[40]	train-logloss:0.57884	train-auc:0.69965	train-aucpr:0.30996	val-logloss:0.48663	val-auc:0.70500	val-aucpr:0.22764
[50]	train-logloss:0.57356	train-auc:0.70373	train-aucpr:0.31454	val-logloss:0.46786	val-auc:0.70628	val-aucpr:0.22590
[60]	train-logloss:0.56969	train-auc:0.70651	train-aucpr:0.31952	val-logloss:0.47292	val-auc:0.69666	val-aucpr:0.22344
[70]	train-logloss:0.56613	train-auc:0.71155	train-aucpr:0.32425	val-logloss:0.46796	val-auc:0.69258	val-aucpr:0.22450
[74]	train-logloss:0.56543	train-auc:0.71227	train-aucpr:0.32502	val-logloss:0.46654	val-auc:0.69300	val-aucpr:0.22425
[2025-11-19 09:33:18,485] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 09:33:18,485] [INFO] [<frozen importlib] - Best train loss: 0.5764
[2025-11-19 09:33:18,485] [INFO] [<frozen importlib] - Best val loss: 0.4808
[2025-11-19 09:33:18,485] [INFO] [<frozen importlib] - Best val AUC: 0.7065
[2025-11-19 09:33:18,485] [INFO] [<frozen importlib] - Best val AUCPR: 0.2293
[2025-11-19 09:33:18,489] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:33:18] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:33:27,316] [INFO] [<frozen importlib] - Optimal threshold: 0.4386
[2025-11-19 09:33:27,316] [INFO] [<frozen importlib] - Best f1: 0.2794
[2025-11-19 09:33:27,316] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:33:27,369] [INFO] [<frozen importlib] - Validation Results (threshold=0.4386):
[2025-11-19 09:33:27,369] [INFO] [<frozen importlib] -   Accuracy: 0.8925
[2025-11-19 09:33:27,369] [INFO] [<frozen importlib] -   Precision: 0.2880
[2025-11-19 09:33:27,369] [INFO] [<frozen importlib] -   Recall: 0.2713
[2025-11-19 09:33:27,369] [INFO] [<frozen importlib] -   F1 Score: 0.2794
[2025-11-19 09:33:27,369] [INFO] [<frozen importlib] -   AUROC: 0.7065
[2025-11-19 09:33:27,369] [INFO] [<frozen importlib] -   AUPRC: 0.2296
[2025-11-19 09:33:27,369] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:33:27,369] [INFO] [<frozen importlib] -     TN=16471, FP=974
[2025-11-19 09:33:27,369] [INFO] [<frozen importlib] -     FN=1058, TP=394
[2025-11-19 09:33:27,420] [INFO] [<frozen importlib] - Trial 418: AUPRC=0.2296, F1=0.4429, Prec=0.4147, Rec=0.4752 | Optimizing auprc=0.2296
                                                                                          Best trial: 289. Best value: 0.241792:  84%|████████▎ | 418/500 [1:11:25<18:08, 13.27s/it]Best trial: 289. Best value: 0.241792:  84%|████████▎ | 418/500 [1:11:25<18:08, 13.27s/it]Best trial: 289. Best value: 0.241792:  84%|████████▍ | 419/500 [1:11:25<17:48, 13.19s/it][2025-11-19 09:33:27,434] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.406887899506577
[2025-11-19 09:33:27,434] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:33:27,434] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:33:27,434] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:33:27,434] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   gamma: 0.37118085791209515
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   alpha: 0.6983646614285326
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   lambda: 0.8064345621993099
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   learning_rate: 0.03235595656241421
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   subsample: 0.8610326293363953
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   colsample_bytree: 0.5802520972879605
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   colsample_bylevel: 0.510532793034714
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   colsample_bynode: 0.8335575487809348
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:33:27,435] [INFO] [<frozen importlib] -   scale_pos_weight: 6.406887899506577
[2025-11-19 09:33:27,513] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:33:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:33:27,421] Trial 418 finished with value: 0.22958280968848754 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.3808722528450806, 'learning_rate': 0.03796690815350517, 'n_estimators': 350, 'alpha': 0.4880468706859852, 'lambda': 1.1395920389485044, 'subsample': 0.8751107799562833, 'colsample_bytree': 0.5938015833228193, 'colsample_bylevel': 0.5498648645121162, 'colsample_bynode': 0.8462741600075997, 'scale_pos_weight': 5.768740120651225}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.66709	train-auc:0.64248	train-aucpr:0.23375	val-logloss:0.66138	val-auc:0.61913	val-aucpr:0.13127
[10]	train-logloss:0.64623	train-auc:0.68108	train-aucpr:0.29102	val-logloss:0.61123	val-auc:0.69513	val-aucpr:0.20019
[20]	train-logloss:0.63260	train-auc:0.68730	train-aucpr:0.29608	val-logloss:0.57173	val-auc:0.70110	val-aucpr:0.21210
[30]	train-logloss:0.62281	train-auc:0.69145	train-aucpr:0.30221	val-logloss:0.54442	val-auc:0.70155	val-aucpr:0.22075
[40]	train-logloss:0.61591	train-auc:0.69589	train-aucpr:0.30580	val-logloss:0.52653	val-auc:0.70551	val-aucpr:0.22185
[50]	train-logloss:0.61016	train-auc:0.69930	train-aucpr:0.31048	val-logloss:0.52064	val-auc:0.70556	val-aucpr:0.22666
[60]	train-logloss:0.60604	train-auc:0.70252	train-aucpr:0.31399	val-logloss:0.51192	val-auc:0.70014	val-aucpr:0.22434
[70]	train-logloss:0.60225	train-auc:0.70634	train-aucpr:0.31709	val-logloss:0.50249	val-auc:0.69831	val-aucpr:0.22188
[78]	train-logloss:0.59974	train-auc:0.70862	train-aucpr:0.31970	val-logloss:0.50419	val-auc:0.69506	val-aucpr:0.21241
[2025-11-19 09:33:27,741] [INFO] [<frozen importlib] - Training completed at iteration 48
[2025-11-19 09:33:27,741] [INFO] [<frozen importlib] - Best train loss: 0.6111
[2025-11-19 09:33:27,741] [INFO] [<frozen importlib] - Best val loss: 0.5239
[2025-11-19 09:33:27,741] [INFO] [<frozen importlib] - Best val AUC: 0.7083
[2025-11-19 09:33:27,741] [INFO] [<frozen importlib] - Best val AUCPR: 0.2278
[2025-11-19 09:33:27,746] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:33:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:33:36,891] [INFO] [<frozen importlib] - Optimal threshold: 0.4743
[2025-11-19 09:33:36,891] [INFO] [<frozen importlib] - Best f1: 0.2675
[2025-11-19 09:33:36,891] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:33:36,935] [INFO] [<frozen importlib] - Validation Results (threshold=0.4743):
[2025-11-19 09:33:36,935] [INFO] [<frozen importlib] -   Accuracy: 0.8983
[2025-11-19 09:33:36,935] [INFO] [<frozen importlib] -   Precision: 0.2995
[2025-11-19 09:33:36,935] [INFO] [<frozen importlib] -   Recall: 0.2417
[2025-11-19 09:33:36,935] [INFO] [<frozen importlib] -   F1 Score: 0.2675
[2025-11-19 09:33:36,935] [INFO] [<frozen importlib] -   AUROC: 0.7083
[2025-11-19 09:33:36,935] [INFO] [<frozen importlib] -   AUPRC: 0.2281
[2025-11-19 09:33:36,935] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:33:36,935] [INFO] [<frozen importlib] -     TN=16624, FP=821
[2025-11-19 09:33:36,935] [INFO] [<frozen importlib] -     FN=1101, TP=351
[2025-11-19 09:33:36,957] [INFO] [<frozen importlib] - Trial 419: AUPRC=0.2281, F1=0.4485, Prec=0.4445, Rec=0.4525 | Optimizing auprc=0.2281
                                                                                          Best trial: 289. Best value: 0.241792:  84%|████████▍ | 419/500 [1:11:34<17:48, 13.19s/it]Best trial: 289. Best value: 0.241792:  84%|████████▍ | 419/500 [1:11:34<17:48, 13.19s/it]Best trial: 289. Best value: 0.241792:  84%|████████▍ | 420/500 [1:11:34<16:07, 12.10s/it][2025-11-19 09:33:36,972] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.162590097264292
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   gamma: 0.20328748620463516
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   alpha: 0.5771293400275457
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   lambda: 1.0280150963304078
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   learning_rate: 0.03540802858460175
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   subsample: 0.8439448374356334
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   colsample_bytree: 0.5983311638512553
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5332196307108428
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   colsample_bynode: 0.8036844476641206
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:33:36,973] [INFO] [<frozen importlib] -   scale_pos_weight: 6.162590097264292
[2025-11-19 09:33:37,047] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:33:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:33:36,958] Trial 419 finished with value: 0.2281433748364126 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.37118085791209515, 'learning_rate': 0.03235595656241421, 'n_estimators': 350, 'alpha': 0.6983646614285326, 'lambda': 0.8064345621993099, 'subsample': 0.8610326293363953, 'colsample_bytree': 0.5802520972879605, 'colsample_bylevel': 0.510532793034714, 'colsample_bynode': 0.8335575487809348, 'scale_pos_weight': 6.406887899506577}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.65346	train-auc:0.63854	train-aucpr:0.22152	val-logloss:0.64455	val-auc:0.61547	val-aucpr:0.12850
[10]	train-logloss:0.63163	train-auc:0.68157	train-aucpr:0.28860	val-logloss:0.59868	val-auc:0.66302	val-aucpr:0.17171
[20]	train-logloss:0.61770	train-auc:0.68735	train-aucpr:0.29766	val-logloss:0.56160	val-auc:0.68554	val-aucpr:0.20429
[30]	train-logloss:0.60772	train-auc:0.69146	train-aucpr:0.30414	val-logloss:0.53164	val-auc:0.68686	val-aucpr:0.22212
[40]	train-logloss:0.60101	train-auc:0.69585	train-aucpr:0.30871	val-logloss:0.51309	val-auc:0.70805	val-aucpr:0.23450
[50]	train-logloss:0.59540	train-auc:0.70086	train-aucpr:0.31286	val-logloss:0.49440	val-auc:0.70962	val-aucpr:0.23498
[60]	train-logloss:0.59110	train-auc:0.70397	train-aucpr:0.31701	val-logloss:0.49058	val-auc:0.70876	val-aucpr:0.23339
[70]	train-logloss:0.58787	train-auc:0.70676	train-aucpr:0.32010	val-logloss:0.48011	val-auc:0.71180	val-aucpr:0.23642
[80]	train-logloss:0.58497	train-auc:0.71123	train-aucpr:0.32447	val-logloss:0.45840	val-auc:0.70926	val-aucpr:0.23160
[90]	train-logloss:0.58243	train-auc:0.71489	train-aucpr:0.32811	val-logloss:0.45645	val-auc:0.70699	val-aucpr:0.22789
[99]	train-logloss:0.58028	train-auc:0.71858	train-aucpr:0.33209	val-logloss:0.45460	val-auc:0.70377	val-aucpr:0.22195
[2025-11-19 09:33:37,350] [INFO] [<frozen importlib] - Training completed at iteration 69
[2025-11-19 09:33:37,350] [INFO] [<frozen importlib] - Best train loss: 0.5881
[2025-11-19 09:33:37,350] [INFO] [<frozen importlib] - Best val loss: 0.4792
[2025-11-19 09:33:37,350] [INFO] [<frozen importlib] - Best val AUC: 0.7106
[2025-11-19 09:33:37,350] [INFO] [<frozen importlib] - Best val AUCPR: 0.2371
[2025-11-19 09:33:37,354] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:33:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:33:50,590] [INFO] [<frozen importlib] - Optimal threshold: 0.4520
[2025-11-19 09:33:50,590] [INFO] [<frozen importlib] - Best f1: 0.2838
[2025-11-19 09:33:50,590] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:33:50,641] [INFO] [<frozen importlib] - Validation Results (threshold=0.4520):
[2025-11-19 09:33:50,641] [INFO] [<frozen importlib] -   Accuracy: 0.8967
[2025-11-19 09:33:50,641] [INFO] [<frozen importlib] -   Precision: 0.3035
[2025-11-19 09:33:50,641] [INFO] [<frozen importlib] -   Recall: 0.2665
[2025-11-19 09:33:50,641] [INFO] [<frozen importlib] -   F1 Score: 0.2838
[2025-11-19 09:33:50,641] [INFO] [<frozen importlib] -   AUROC: 0.7106
[2025-11-19 09:33:50,641] [INFO] [<frozen importlib] -   AUPRC: 0.2374
[2025-11-19 09:33:50,641] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:33:50,641] [INFO] [<frozen importlib] -     TN=16557, FP=888
[2025-11-19 09:33:50,641] [INFO] [<frozen importlib] -     FN=1065, TP=387
[2025-11-19 09:33:50,669] [INFO] [<frozen importlib] - Trial 420: AUPRC=0.2374, F1=0.4519, Prec=0.4348, Rec=0.4704 | Optimizing auprc=0.2374
                                                                                          Best trial: 289. Best value: 0.241792:  84%|████████▍ | 420/500 [1:11:48<16:07, 12.10s/it]Best trial: 289. Best value: 0.241792:  84%|████████▍ | 420/500 [1:11:48<16:07, 12.10s/it]Best trial: 289. Best value: 0.241792:  84%|████████▍ | 421/500 [1:11:48<16:33, 12.58s/it][2025-11-19 09:33:50,682] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.213729195071849
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   gamma: 0.1980946794489051
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   alpha: 0.508842277203122
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   lambda: 1.0489473225866328
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   learning_rate: 0.03509538845884447
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   subsample: 0.8447506712335622
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   colsample_bytree: 0.6103531796940799
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5363780418084413
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   colsample_bynode: 0.8128607044336427
[2025-11-19 09:33:50,682] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:33:50,683] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:33:50,683] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:33:50,683] [INFO] [<frozen importlib] -   scale_pos_weight: 6.213729195071849
[2025-11-19 09:33:50,755] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:33:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:33:50,669] Trial 420 finished with value: 0.23742006460215895 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.20328748620463516, 'learning_rate': 0.03540802858460175, 'n_estimators': 350, 'alpha': 0.5771293400275457, 'lambda': 1.0280150963304078, 'subsample': 0.8439448374356334, 'colsample_bytree': 0.5983311638512553, 'colsample_bylevel': 0.5332196307108428, 'colsample_bynode': 0.8036844476641206, 'scale_pos_weight': 6.162590097264292}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.65600	train-auc:0.65356	train-aucpr:0.23764	val-logloss:0.64700	val-auc:0.64724	val-aucpr:0.14315
[10]	train-logloss:0.63434	train-auc:0.68053	train-aucpr:0.29140	val-logloss:0.59260	val-auc:0.70373	val-aucpr:0.19116
[20]	train-logloss:0.62017	train-auc:0.68760	train-aucpr:0.29838	val-logloss:0.55839	val-auc:0.70145	val-aucpr:0.19100
[30]	train-logloss:0.61066	train-auc:0.69090	train-aucpr:0.30338	val-logloss:0.53207	val-auc:0.70423	val-aucpr:0.20041
[40]	train-logloss:0.60378	train-auc:0.69564	train-aucpr:0.30763	val-logloss:0.51548	val-auc:0.69756	val-aucpr:0.20035
[50]	train-logloss:0.59825	train-auc:0.69947	train-aucpr:0.31167	val-logloss:0.50731	val-auc:0.70061	val-aucpr:0.20659
[60]	train-logloss:0.59424	train-auc:0.70238	train-aucpr:0.31545	val-logloss:0.50533	val-auc:0.69661	val-aucpr:0.20756
[70]	train-logloss:0.59053	train-auc:0.70741	train-aucpr:0.31945	val-logloss:0.49253	val-auc:0.69656	val-aucpr:0.20928
[80]	train-logloss:0.58789	train-auc:0.71029	train-aucpr:0.32270	val-logloss:0.48259	val-auc:0.69727	val-aucpr:0.20903
[90]	train-logloss:0.58524	train-auc:0.71355	train-aucpr:0.32627	val-logloss:0.48401	val-auc:0.69415	val-aucpr:0.20206
[100]	train-logloss:0.58277	train-auc:0.71814	train-aucpr:0.33030	val-logloss:0.46973	val-auc:0.68533	val-aucpr:0.19517
[105]	train-logloss:0.58153	train-auc:0.71980	train-aucpr:0.33183	val-logloss:0.46355	val-auc:0.68585	val-aucpr:0.19544
[2025-11-19 09:33:51,236] [INFO] [<frozen importlib] - Training completed at iteration 75
[2025-11-19 09:33:51,236] [INFO] [<frozen importlib] - Best train loss: 0.5895
[2025-11-19 09:33:51,236] [INFO] [<frozen importlib] - Best val loss: 0.4885
[2025-11-19 09:33:51,236] [INFO] [<frozen importlib] - Best val AUC: 0.6976
[2025-11-19 09:33:51,236] [INFO] [<frozen importlib] - Best val AUCPR: 0.2111
[2025-11-19 09:33:51,239] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:33:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:34:04,657] [INFO] [<frozen importlib] - Optimal threshold: 0.4736
[2025-11-19 09:34:04,657] [INFO] [<frozen importlib] - Best f1: 0.2654
[2025-11-19 09:34:04,657] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:34:04,714] [INFO] [<frozen importlib] - Validation Results (threshold=0.4736):
[2025-11-19 09:34:04,714] [INFO] [<frozen importlib] -   Accuracy: 0.9007
[2025-11-19 09:34:04,714] [INFO] [<frozen importlib] -   Precision: 0.3073
[2025-11-19 09:34:04,714] [INFO] [<frozen importlib] -   Recall: 0.2335
[2025-11-19 09:34:04,714] [INFO] [<frozen importlib] -   F1 Score: 0.2654
[2025-11-19 09:34:04,714] [INFO] [<frozen importlib] -   AUROC: 0.6976
[2025-11-19 09:34:04,714] [INFO] [<frozen importlib] -   AUPRC: 0.2116
[2025-11-19 09:34:04,714] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:34:04,714] [INFO] [<frozen importlib] -     TN=16681, FP=764
[2025-11-19 09:34:04,714] [INFO] [<frozen importlib] -     FN=1113, TP=339
[2025-11-19 09:34:04,743] [INFO] [<frozen importlib] - Trial 421: AUPRC=0.2116, F1=0.4531, Prec=0.4593, Rec=0.4470 | Optimizing auprc=0.2116
                                                                                          Best trial: 289. Best value: 0.241792:  84%|████████▍ | 421/500 [1:12:02<16:33, 12.58s/it]Best trial: 289. Best value: 0.241792:  84%|████████▍ | 421/500 [1:12:02<16:33, 12.58s/it]Best trial: 289. Best value: 0.241792:  84%|████████▍ | 422/500 [1:12:02<16:56, 13.03s/it][2025-11-19 09:34:04,757] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.541101685543673
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   gamma: 0.17431436574527098
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   alpha: 0.5732862034765418
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   lambda: 1.2303892721994594
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   learning_rate: 0.03380689074670402
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   subsample: 0.8381261920568385
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   colsample_bytree: 0.5935260105079901
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5313837335228394
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   colsample_bynode: 0.8018554272409701
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:34:04,757] [INFO] [<frozen importlib] -   scale_pos_weight: 6.541101685543673
[2025-11-19 09:34:04,831] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:34:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:34:04,744] Trial 421 finished with value: 0.21159151628501388 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.1980946794489051, 'learning_rate': 0.03509538845884447, 'n_estimators': 350, 'alpha': 0.508842277203122, 'lambda': 1.0489473225866328, 'subsample': 0.8447506712335622, 'colsample_bytree': 0.6103531796940799, 'colsample_bylevel': 0.5363780418084413, 'colsample_bynode': 0.8128607044336427, 'scale_pos_weight': 6.213729195071849}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.67452	train-auc:0.63863	train-aucpr:0.22153	val-logloss:0.66856	val-auc:0.61586	val-aucpr:0.12856
[10]	train-logloss:0.65245	train-auc:0.68190	train-aucpr:0.28793	val-logloss:0.62214	val-auc:0.67416	val-aucpr:0.17570
[20]	train-logloss:0.63831	train-auc:0.68714	train-aucpr:0.29687	val-logloss:0.58177	val-auc:0.69354	val-aucpr:0.21029
[30]	train-logloss:0.62832	train-auc:0.69123	train-aucpr:0.30247	val-logloss:0.55300	val-auc:0.69261	val-aucpr:0.22144
[40]	train-logloss:0.62121	train-auc:0.69496	train-aucpr:0.30682	val-logloss:0.53068	val-auc:0.71376	val-aucpr:0.23472
[50]	train-logloss:0.61537	train-auc:0.69929	train-aucpr:0.31084	val-logloss:0.51477	val-auc:0.71000	val-aucpr:0.23283
[60]	train-logloss:0.61104	train-auc:0.70271	train-aucpr:0.31493	val-logloss:0.50811	val-auc:0.70814	val-aucpr:0.23269
[70]	train-logloss:0.60767	train-auc:0.70508	train-aucpr:0.31819	val-logloss:0.50578	val-auc:0.71200	val-aucpr:0.23501
[74]	train-logloss:0.60660	train-auc:0.70694	train-aucpr:0.31997	val-logloss:0.50495	val-auc:0.71188	val-aucpr:0.23315
[2025-11-19 09:34:07,280] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 09:34:07,280] [INFO] [<frozen importlib] - Best train loss: 0.6186
[2025-11-19 09:34:07,280] [INFO] [<frozen importlib] - Best val loss: 0.5191
[2025-11-19 09:34:07,280] [INFO] [<frozen importlib] - Best val AUC: 0.7143
[2025-11-19 09:34:07,280] [INFO] [<frozen importlib] - Best val AUCPR: 0.2368
[2025-11-19 09:34:07,284] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:34:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:34:17,324] [INFO] [<frozen importlib] - Optimal threshold: 0.4635
[2025-11-19 09:34:17,324] [INFO] [<frozen importlib] - Best f1: 0.2893
[2025-11-19 09:34:17,324] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:34:17,375] [INFO] [<frozen importlib] - Validation Results (threshold=0.4635):
[2025-11-19 09:34:17,375] [INFO] [<frozen importlib] -   Accuracy: 0.8942
[2025-11-19 09:34:17,375] [INFO] [<frozen importlib] -   Precision: 0.2988
[2025-11-19 09:34:17,376] [INFO] [<frozen importlib] -   Recall: 0.2803
[2025-11-19 09:34:17,376] [INFO] [<frozen importlib] -   F1 Score: 0.2893
[2025-11-19 09:34:17,376] [INFO] [<frozen importlib] -   AUROC: 0.7143
[2025-11-19 09:34:17,376] [INFO] [<frozen importlib] -   AUPRC: 0.2371
[2025-11-19 09:34:17,376] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:34:17,376] [INFO] [<frozen importlib] -     TN=16490, FP=955
[2025-11-19 09:34:17,376] [INFO] [<frozen importlib] -     FN=1045, TP=407
[2025-11-19 09:34:17,398] [INFO] [<frozen importlib] - Trial 422: AUPRC=0.2371, F1=0.4436, Prec=0.4180, Rec=0.4725 | Optimizing auprc=0.2371
                                                                                          Best trial: 289. Best value: 0.241792:  84%|████████▍ | 422/500 [1:12:15<16:56, 13.03s/it]Best trial: 289. Best value: 0.241792:  84%|████████▍ | 422/500 [1:12:15<16:56, 13.03s/it]Best trial: 289. Best value: 0.241792:  85%|████████▍ | 423/500 [1:12:15<16:34, 12.92s/it][2025-11-19 09:34:17,415] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.476495579473617
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   gamma: 0.17168505193237998
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   alpha: 0.5836431256083171
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   lambda: 1.3218173749763271
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   learning_rate: 0.03315178562791474
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   subsample: 0.8489043525541026
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   colsample_bytree: 0.748864326019121
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5412846747630018
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   colsample_bynode: 0.8517678480743344
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:34:17,415] [INFO] [<frozen importlib] -   scale_pos_weight: 6.476495579473617
[2025-11-19 09:34:17,484] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:34:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:34:17,398] Trial 422 finished with value: 0.23712290509387615 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.17431436574527098, 'learning_rate': 0.03380689074670402, 'n_estimators': 350, 'alpha': 0.5732862034765418, 'lambda': 1.2303892721994594, 'subsample': 0.8381261920568385, 'colsample_bytree': 0.5935260105079901, 'colsample_bylevel': 0.5313837335228394, 'colsample_bynode': 0.8018554272409701, 'scale_pos_weight': 6.541101685543673}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.67070	train-auc:0.64101	train-aucpr:0.23331	val-logloss:0.66398	val-auc:0.57948	val-aucpr:0.09031
[10]	train-logloss:0.64929	train-auc:0.67678	train-aucpr:0.27876	val-logloss:0.61774	val-auc:0.67200	val-aucpr:0.14297
[20]	train-logloss:0.63475	train-auc:0.68627	train-aucpr:0.29619	val-logloss:0.57543	val-auc:0.68083	val-aucpr:0.18189
[30]	train-logloss:0.62485	train-auc:0.69268	train-aucpr:0.30445	val-logloss:0.54869	val-auc:0.68823	val-aucpr:0.20245
[40]	train-logloss:0.61731	train-auc:0.69737	train-aucpr:0.30921	val-logloss:0.52920	val-auc:0.69285	val-aucpr:0.20829
[50]	train-logloss:0.61179	train-auc:0.70075	train-aucpr:0.31339	val-logloss:0.52089	val-auc:0.70383	val-aucpr:0.21896
[60]	train-logloss:0.60771	train-auc:0.70335	train-aucpr:0.31565	val-logloss:0.51272	val-auc:0.70705	val-aucpr:0.22473
[70]	train-logloss:0.60399	train-auc:0.70763	train-aucpr:0.31887	val-logloss:0.49990	val-auc:0.70325	val-aucpr:0.22252
[80]	train-logloss:0.60085	train-auc:0.71138	train-aucpr:0.32303	val-logloss:0.49527	val-auc:0.70341	val-aucpr:0.22347
[90]	train-logloss:0.59833	train-auc:0.71394	train-aucpr:0.32629	val-logloss:0.47968	val-auc:0.70380	val-aucpr:0.22601
[100]	train-logloss:0.59611	train-auc:0.71590	train-aucpr:0.32972	val-logloss:0.47725	val-auc:0.70140	val-aucpr:0.22226
[110]	train-logloss:0.59382	train-auc:0.71926	train-aucpr:0.33284	val-logloss:0.47388	val-auc:0.70212	val-aucpr:0.21996
[120]	train-logloss:0.59154	train-auc:0.72297	train-aucpr:0.33591	val-logloss:0.46751	val-auc:0.69607	val-aucpr:0.21242
[2025-11-19 09:34:17,814] [INFO] [<frozen importlib] - Training completed at iteration 91
[2025-11-19 09:34:17,814] [INFO] [<frozen importlib] - Best train loss: 0.5981
[2025-11-19 09:34:17,814] [INFO] [<frozen importlib] - Best val loss: 0.4786
[2025-11-19 09:34:17,814] [INFO] [<frozen importlib] - Best val AUC: 0.7044
[2025-11-19 09:34:17,814] [INFO] [<frozen importlib] - Best val AUCPR: 0.2270
[2025-11-19 09:34:17,819] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:34:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:34:31,792] [INFO] [<frozen importlib] - Optimal threshold: 0.4881
[2025-11-19 09:34:31,793] [INFO] [<frozen importlib] - Best f1: 0.2687
[2025-11-19 09:34:31,793] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:34:31,841] [INFO] [<frozen importlib] - Validation Results (threshold=0.4881):
[2025-11-19 09:34:31,841] [INFO] [<frozen importlib] -   Accuracy: 0.8949
[2025-11-19 09:34:31,841] [INFO] [<frozen importlib] -   Precision: 0.2885
[2025-11-19 09:34:31,841] [INFO] [<frozen importlib] -   Recall: 0.2514
[2025-11-19 09:34:31,841] [INFO] [<frozen importlib] -   F1 Score: 0.2687
[2025-11-19 09:34:31,841] [INFO] [<frozen importlib] -   AUROC: 0.7044
[2025-11-19 09:34:31,841] [INFO] [<frozen importlib] -   AUPRC: 0.2274
[2025-11-19 09:34:31,841] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:34:31,841] [INFO] [<frozen importlib] -     TN=16545, FP=900
[2025-11-19 09:34:31,841] [INFO] [<frozen importlib] -     FN=1087, TP=365
[2025-11-19 09:34:31,868] [INFO] [<frozen importlib] - Trial 423: AUPRC=0.2274, F1=0.4572, Prec=0.4364, Rec=0.4800 | Optimizing auprc=0.2274
                                                                                          Best trial: 289. Best value: 0.241792:  85%|████████▍ | 423/500 [1:12:29<16:34, 12.92s/it]Best trial: 289. Best value: 0.241792:  85%|████████▍ | 423/500 [1:12:29<16:34, 12.92s/it]Best trial: 289. Best value: 0.241792:  85%|████████▍ | 424/500 [1:12:29<16:57, 13.38s/it][2025-11-19 09:34:31,883] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.006022804190235
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   gamma: 0.13982950288808674
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   alpha: 0.5387564548773522
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   lambda: 1.2557450065290747
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   learning_rate: 0.03381177072051905
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   subsample: 0.8388597685941295
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   colsample_bytree: 0.5973421096800461
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   colsample_bylevel: 0.547151593974167
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   colsample_bynode: 0.8031803371089894
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:34:31,883] [INFO] [<frozen importlib] -   scale_pos_weight: 6.006022804190235
[2025-11-19 09:34:31,958] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:34:31] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:34:31,868] Trial 423 finished with value: 0.2273810594171 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.17168505193237998, 'learning_rate': 0.03315178562791474, 'n_estimators': 350, 'alpha': 0.5836431256083171, 'lambda': 1.3218173749763271, 'subsample': 0.8489043525541026, 'colsample_bytree': 0.748864326019121, 'colsample_bylevel': 0.5412846747630018, 'colsample_bynode': 0.8517678480743344, 'scale_pos_weight': 6.476495579473617}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.64499	train-auc:0.63263	train-aucpr:0.22126	val-logloss:0.63533	val-auc:0.64306	val-aucpr:0.15077
[10]	train-logloss:0.62409	train-auc:0.68040	train-aucpr:0.28940	val-logloss:0.59042	val-auc:0.69703	val-aucpr:0.20363
[20]	train-logloss:0.61048	train-auc:0.68791	train-aucpr:0.29932	val-logloss:0.55473	val-auc:0.71177	val-aucpr:0.22315
[30]	train-logloss:0.60079	train-auc:0.69196	train-aucpr:0.30528	val-logloss:0.52394	val-auc:0.70821	val-aucpr:0.23035
[40]	train-logloss:0.59400	train-auc:0.69654	train-aucpr:0.30892	val-logloss:0.50877	val-auc:0.71819	val-aucpr:0.23520
[50]	train-logloss:0.58838	train-auc:0.69981	train-aucpr:0.31293	val-logloss:0.49945	val-auc:0.71822	val-aucpr:0.23579
[60]	train-logloss:0.58453	train-auc:0.70350	train-aucpr:0.31670	val-logloss:0.49987	val-auc:0.71309	val-aucpr:0.23445
[70]	train-logloss:0.58093	train-auc:0.70741	train-aucpr:0.32009	val-logloss:0.49762	val-auc:0.71268	val-aucpr:0.22987
[73]	train-logloss:0.58010	train-auc:0.70818	train-aucpr:0.32132	val-logloss:0.49361	val-auc:0.71200	val-aucpr:0.23004
[2025-11-19 09:34:32,179] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 09:34:32,179] [INFO] [<frozen importlib] - Best train loss: 0.5916
[2025-11-19 09:34:32,179] [INFO] [<frozen importlib] - Best val loss: 0.5016
[2025-11-19 09:34:32,179] [INFO] [<frozen importlib] - Best val AUC: 0.7191
[2025-11-19 09:34:32,179] [INFO] [<frozen importlib] - Best val AUCPR: 0.2361
[2025-11-19 09:34:32,184] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:34:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:34:41,865] [INFO] [<frozen importlib] - Optimal threshold: 0.4544
[2025-11-19 09:34:41,865] [INFO] [<frozen importlib] - Best f1: 0.2895
[2025-11-19 09:34:41,865] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:34:41,906] [INFO] [<frozen importlib] - Validation Results (threshold=0.4544):
[2025-11-19 09:34:41,906] [INFO] [<frozen importlib] -   Accuracy: 0.8953
[2025-11-19 09:34:41,906] [INFO] [<frozen importlib] -   Precision: 0.3026
[2025-11-19 09:34:41,906] [INFO] [<frozen importlib] -   Recall: 0.2775
[2025-11-19 09:34:41,906] [INFO] [<frozen importlib] -   F1 Score: 0.2895
[2025-11-19 09:34:41,906] [INFO] [<frozen importlib] -   AUROC: 0.7191
[2025-11-19 09:34:41,906] [INFO] [<frozen importlib] -   AUPRC: 0.2365
[2025-11-19 09:34:41,906] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:34:41,906] [INFO] [<frozen importlib] -     TN=16516, FP=929
[2025-11-19 09:34:41,906] [INFO] [<frozen importlib] -     FN=1049, TP=403
[2025-11-19 09:34:41,928] [INFO] [<frozen importlib] - Trial 424: AUPRC=0.2365, F1=0.4412, Prec=0.4205, Rec=0.4642 | Optimizing auprc=0.2365
                                                                                          Best trial: 289. Best value: 0.241792:  85%|████████▍ | 424/500 [1:12:39<16:57, 13.38s/it]Best trial: 289. Best value: 0.241792:  85%|████████▍ | 424/500 [1:12:39<16:57, 13.38s/it]Best trial: 289. Best value: 0.241792:  85%|████████▌ | 425/500 [1:12:39<15:28, 12.39s/it][2025-11-19 09:34:41,944] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.715281774642381
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   gamma: 0.1520933798802941
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   alpha: 0.46797385391336066
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   lambda: 1.4267940045703702
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   learning_rate: 0.03411709595374101
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   subsample: 0.8450055759332475
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   colsample_bytree: 0.6024992624461514
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5327699930652888
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   colsample_bynode: 0.8082187487711852
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:34:41,944] [INFO] [<frozen importlib] -   scale_pos_weight: 5.715281774642381
[2025-11-19 09:34:42,016] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:34:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:34:41,929] Trial 424 finished with value: 0.236508661858466 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.13982950288808674, 'learning_rate': 0.03381177072051905, 'n_estimators': 350, 'alpha': 0.5387564548773522, 'lambda': 1.2557450065290747, 'subsample': 0.8388597685941295, 'colsample_bytree': 0.5973421096800461, 'colsample_bylevel': 0.547151593974167, 'colsample_bynode': 0.8031803371089894, 'scale_pos_weight': 6.006022804190235}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.62805	train-auc:0.65488	train-aucpr:0.23907	val-logloss:0.62321	val-auc:0.48669	val-aucpr:0.06933
[10]	train-logloss:0.60788	train-auc:0.68170	train-aucpr:0.29087	val-logloss:0.57017	val-auc:0.69287	val-aucpr:0.19893
[20]	train-logloss:0.59483	train-auc:0.68939	train-aucpr:0.29894	val-logloss:0.53235	val-auc:0.70359	val-aucpr:0.21135
[30]	train-logloss:0.58560	train-auc:0.69362	train-aucpr:0.30266	val-logloss:0.50550	val-auc:0.69202	val-aucpr:0.21270
[40]	train-logloss:0.57902	train-auc:0.69763	train-aucpr:0.30697	val-logloss:0.48793	val-auc:0.69999	val-aucpr:0.21516
[50]	train-logloss:0.57367	train-auc:0.70000	train-aucpr:0.31187	val-logloss:0.46964	val-auc:0.70833	val-aucpr:0.21969
[60]	train-logloss:0.56970	train-auc:0.70339	train-aucpr:0.31587	val-logloss:0.46783	val-auc:0.70329	val-aucpr:0.21150
[70]	train-logloss:0.56629	train-auc:0.70770	train-aucpr:0.31967	val-logloss:0.46281	val-auc:0.69296	val-aucpr:0.19915
[80]	train-logloss:0.56386	train-auc:0.70951	train-aucpr:0.32257	val-logloss:0.45692	val-auc:0.69442	val-aucpr:0.20372
[2025-11-19 09:34:42,258] [INFO] [<frozen importlib] - Training completed at iteration 50
[2025-11-19 09:34:42,258] [INFO] [<frozen importlib] - Best train loss: 0.5737
[2025-11-19 09:34:42,258] [INFO] [<frozen importlib] - Best val loss: 0.4696
[2025-11-19 09:34:42,258] [INFO] [<frozen importlib] - Best val AUC: 0.7083
[2025-11-19 09:34:42,258] [INFO] [<frozen importlib] - Best val AUCPR: 0.2197
[2025-11-19 09:34:42,264] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:34:42] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:34:53,172] [INFO] [<frozen importlib] - Optimal threshold: 0.4333
[2025-11-19 09:34:53,172] [INFO] [<frozen importlib] - Best f1: 0.2703
[2025-11-19 09:34:53,172] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:34:53,219] [INFO] [<frozen importlib] - Validation Results (threshold=0.4333):
[2025-11-19 09:34:53,220] [INFO] [<frozen importlib] -   Accuracy: 0.8828
[2025-11-19 09:34:53,220] [INFO] [<frozen importlib] -   Precision: 0.2592
[2025-11-19 09:34:53,220] [INFO] [<frozen importlib] -   Recall: 0.2824
[2025-11-19 09:34:53,220] [INFO] [<frozen importlib] -   F1 Score: 0.2703
[2025-11-19 09:34:53,220] [INFO] [<frozen importlib] -   AUROC: 0.7083
[2025-11-19 09:34:53,220] [INFO] [<frozen importlib] -   AUPRC: 0.2200
[2025-11-19 09:34:53,220] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:34:53,220] [INFO] [<frozen importlib] -     TN=16273, FP=1172
[2025-11-19 09:34:53,220] [INFO] [<frozen importlib] -     FN=1042, TP=410
[2025-11-19 09:34:53,243] [INFO] [<frozen importlib] - Trial 425: AUPRC=0.2200, F1=0.4330, Prec=0.3822, Rec=0.4993 | Optimizing auprc=0.2200
[2025-11-19 09:34:53,244] [INFO] [<frozen importlib] - Trial 425 pruned.
[2025-11-19 09:34:53,244] [ERROR] [<frozen importlib] - Trial 425 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  85%|████████▌ | 425/500 [1:12:51<15:28, 12.39s/it]Best trial: 289. Best value: 0.241792:  85%|████████▌ | 425/500 [1:12:51<15:28, 12.39s/it]Best trial: 289. Best value: 0.241792:  85%|████████▌ | 426/500 [1:12:51<14:52, 12.06s/it][2025-11-19 09:34:53,258] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.9934134324359505
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   gamma: 0.1324615713062712
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   alpha: 0.5301573880316333
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   lambda: 1.254110226381992
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   learning_rate: 0.031049127012584426
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   subsample: 0.8370984523819845
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   colsample_bytree: 0.5835410629410608
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5480307991178681
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   colsample_bynode: 0.9999546256483575
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:34:53,258] [INFO] [<frozen importlib] -   scale_pos_weight: 5.9934134324359505
[2025-11-19 09:34:53,335] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:34:53] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:34:53,244] Trial 425 pruned. 
[0]	train-logloss:0.64411	train-auc:0.64129	train-aucpr:0.22981	val-logloss:0.63420	val-auc:0.62851	val-aucpr:0.12897
[10]	train-logloss:0.62454	train-auc:0.67927	train-aucpr:0.28488	val-logloss:0.59079	val-auc:0.69345	val-aucpr:0.19732
[20]	train-logloss:0.61158	train-auc:0.68645	train-aucpr:0.29682	val-logloss:0.55874	val-auc:0.70755	val-aucpr:0.21123
[30]	train-logloss:0.60237	train-auc:0.69047	train-aucpr:0.30106	val-logloss:0.53627	val-auc:0.71163	val-aucpr:0.21761
[40]	train-logloss:0.59559	train-auc:0.69455	train-aucpr:0.30554	val-logloss:0.52199	val-auc:0.71154	val-aucpr:0.22383
[50]	train-logloss:0.58989	train-auc:0.69879	train-aucpr:0.31077	val-logloss:0.50810	val-auc:0.70970	val-aucpr:0.22762
[60]	train-logloss:0.58596	train-auc:0.70228	train-aucpr:0.31407	val-logloss:0.50116	val-auc:0.70764	val-aucpr:0.22618
[70]	train-logloss:0.58221	train-auc:0.70726	train-aucpr:0.31736	val-logloss:0.50061	val-auc:0.70339	val-aucpr:0.21745
[80]	train-logloss:0.57898	train-auc:0.70981	train-aucpr:0.32125	val-logloss:0.48733	val-auc:0.70277	val-aucpr:0.21838
[85]	train-logloss:0.57763	train-auc:0.71107	train-aucpr:0.32246	val-logloss:0.48187	val-auc:0.70257	val-aucpr:0.21740
[2025-11-19 09:34:53,590] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 09:34:53,590] [INFO] [<frozen importlib] - Best train loss: 0.5880
[2025-11-19 09:34:53,590] [INFO] [<frozen importlib] - Best val loss: 0.5011
[2025-11-19 09:34:53,590] [INFO] [<frozen importlib] - Best val AUC: 0.7115
[2025-11-19 09:34:53,590] [INFO] [<frozen importlib] - Best val AUCPR: 0.2286
[2025-11-19 09:34:53,596] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:34:53] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:35:02,091] [INFO] [<frozen importlib] - Optimal threshold: 0.4541
[2025-11-19 09:35:02,092] [INFO] [<frozen importlib] - Best f1: 0.2745
[2025-11-19 09:35:02,092] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:35:02,136] [INFO] [<frozen importlib] - Validation Results (threshold=0.4541):
[2025-11-19 09:35:02,136] [INFO] [<frozen importlib] -   Accuracy: 0.8834
[2025-11-19 09:35:02,136] [INFO] [<frozen importlib] -   Precision: 0.2629
[2025-11-19 09:35:02,136] [INFO] [<frozen importlib] -   Recall: 0.2872
[2025-11-19 09:35:02,136] [INFO] [<frozen importlib] -   F1 Score: 0.2745
[2025-11-19 09:35:02,136] [INFO] [<frozen importlib] -   AUROC: 0.7115
[2025-11-19 09:35:02,136] [INFO] [<frozen importlib] -   AUPRC: 0.2290
[2025-11-19 09:35:02,136] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:35:02,136] [INFO] [<frozen importlib] -     TN=16276, FP=1169
[2025-11-19 09:35:02,136] [INFO] [<frozen importlib] -     FN=1035, TP=417
[2025-11-19 09:35:02,161] [INFO] [<frozen importlib] - Trial 426: AUPRC=0.2290, F1=0.4408, Prec=0.3880, Rec=0.5103 | Optimizing auprc=0.2290
                                                                                          Best trial: 289. Best value: 0.241792:  85%|████████▌ | 426/500 [1:13:00<14:52, 12.06s/it]Best trial: 289. Best value: 0.241792:  85%|████████▌ | 426/500 [1:13:00<14:52, 12.06s/it]Best trial: 289. Best value: 0.241792:  85%|████████▌ | 427/500 [1:13:00<13:31, 11.12s/it][2025-11-19 09:35:02,182] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.2442645035827615
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   gamma: 0.1689090999677449
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   alpha: 0.5021309207357271
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   lambda: 1.2052834102646848
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   learning_rate: 0.032868654200004156
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   subsample: 0.8395973811597962
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   colsample_bytree: 0.6224840377318969
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5283379172295398
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   colsample_bynode: 0.8233821607900262
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:35:02,182] [INFO] [<frozen importlib] -   scale_pos_weight: 6.2442645035827615
[2025-11-19 09:35:02,258] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:35:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:35:02,162] Trial 426 finished with value: 0.22896015449455595 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.1324615713062712, 'learning_rate': 0.031049127012584426, 'n_estimators': 350, 'alpha': 0.5301573880316333, 'lambda': 1.254110226381992, 'subsample': 0.8370984523819845, 'colsample_bytree': 0.5835410629410608, 'colsample_bylevel': 0.5480307991178681, 'colsample_bynode': 0.9999546256483575, 'scale_pos_weight': 5.9934134324359505}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.65781	train-auc:0.64890	train-aucpr:0.24253	val-logloss:0.64880	val-auc:0.63784	val-aucpr:0.15581
[10]	train-logloss:0.63646	train-auc:0.68085	train-aucpr:0.29508	val-logloss:0.59889	val-auc:0.69696	val-aucpr:0.21776
[20]	train-logloss:0.62304	train-auc:0.68630	train-aucpr:0.29851	val-logloss:0.56051	val-auc:0.69831	val-aucpr:0.21931
[30]	train-logloss:0.61366	train-auc:0.69184	train-aucpr:0.30314	val-logloss:0.53040	val-auc:0.70062	val-aucpr:0.22194
[40]	train-logloss:0.60654	train-auc:0.69617	train-aucpr:0.30842	val-logloss:0.51091	val-auc:0.69874	val-aucpr:0.21867
[50]	train-logloss:0.60092	train-auc:0.69907	train-aucpr:0.31209	val-logloss:0.50085	val-auc:0.69583	val-aucpr:0.21763
[60]	train-logloss:0.59698	train-auc:0.70222	train-aucpr:0.31442	val-logloss:0.48949	val-auc:0.70081	val-aucpr:0.22424
[70]	train-logloss:0.59334	train-auc:0.70592	train-aucpr:0.31775	val-logloss:0.48176	val-auc:0.69852	val-aucpr:0.22253
[80]	train-logloss:0.59046	train-auc:0.70913	train-aucpr:0.32078	val-logloss:0.47987	val-auc:0.69942	val-aucpr:0.22044
[89]	train-logloss:0.58827	train-auc:0.71179	train-aucpr:0.32325	val-logloss:0.47339	val-auc:0.69823	val-aucpr:0.21195
[2025-11-19 09:35:02,533] [INFO] [<frozen importlib] - Training completed at iteration 59
[2025-11-19 09:35:02,533] [INFO] [<frozen importlib] - Best train loss: 0.5974
[2025-11-19 09:35:02,533] [INFO] [<frozen importlib] - Best val loss: 0.4902
[2025-11-19 09:35:02,533] [INFO] [<frozen importlib] - Best val AUC: 0.7007
[2025-11-19 09:35:02,533] [INFO] [<frozen importlib] - Best val AUCPR: 0.2244
[2025-11-19 09:35:02,539] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:35:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:35:14,824] [INFO] [<frozen importlib] - Optimal threshold: 0.4542
[2025-11-19 09:35:14,824] [INFO] [<frozen importlib] - Best f1: 0.2605
[2025-11-19 09:35:14,824] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:35:14,868] [INFO] [<frozen importlib] - Validation Results (threshold=0.4542):
[2025-11-19 09:35:14,868] [INFO] [<frozen importlib] -   Accuracy: 0.8891
[2025-11-19 09:35:14,868] [INFO] [<frozen importlib] -   Precision: 0.2672
[2025-11-19 09:35:14,868] [INFO] [<frozen importlib] -   Recall: 0.2541
[2025-11-19 09:35:14,868] [INFO] [<frozen importlib] -   F1 Score: 0.2605
[2025-11-19 09:35:14,868] [INFO] [<frozen importlib] -   AUROC: 0.7007
[2025-11-19 09:35:14,868] [INFO] [<frozen importlib] -   AUPRC: 0.2248
[2025-11-19 09:35:14,868] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:35:14,868] [INFO] [<frozen importlib] -     TN=16433, FP=1012
[2025-11-19 09:35:14,868] [INFO] [<frozen importlib] -     FN=1083, TP=369
[2025-11-19 09:35:14,893] [INFO] [<frozen importlib] - Trial 427: AUPRC=0.2248, F1=0.4356, Prec=0.4040, Rec=0.4725 | Optimizing auprc=0.2248
[2025-11-19 09:35:14,894] [INFO] [<frozen importlib] - Trial 427 pruned.
[2025-11-19 09:35:14,894] [ERROR] [<frozen importlib] - Trial 427 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  85%|████████▌ | 427/500 [1:13:12<13:31, 11.12s/it]Best trial: 289. Best value: 0.241792:  85%|████████▌ | 427/500 [1:13:12<13:31, 11.12s/it]Best trial: 289. Best value: 0.241792:  86%|████████▌ | 428/500 [1:13:12<13:55, 11.60s/it][2025-11-19 09:35:14,914] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.031587700934728
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   gamma: 0.08821815865306049
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   alpha: 0.45364043511390817
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   lambda: 1.3423386452466075
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   learning_rate: 0.03391940478612597
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   subsample: 0.8521551481437102
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   colsample_bytree: 0.5995689309699902
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5354135519049125
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   colsample_bynode: 0.8087843706720184
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:35:14,914] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:35:14,915] [INFO] [<frozen importlib] -   scale_pos_weight: 6.031587700934728
[2025-11-19 09:35:14,989] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:35:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:35:14,894] Trial 427 pruned. 
[0]	train-logloss:0.64640	train-auc:0.63263	train-aucpr:0.22126	val-logloss:0.63694	val-auc:0.64306	val-aucpr:0.15077
[10]	train-logloss:0.62533	train-auc:0.68159	train-aucpr:0.29092	val-logloss:0.59032	val-auc:0.70030	val-aucpr:0.20351
[20]	train-logloss:0.61157	train-auc:0.68869	train-aucpr:0.30024	val-logloss:0.55879	val-auc:0.70033	val-aucpr:0.21190
[30]	train-logloss:0.60194	train-auc:0.69243	train-aucpr:0.30468	val-logloss:0.52856	val-auc:0.69538	val-aucpr:0.22191
[40]	train-logloss:0.59507	train-auc:0.69663	train-aucpr:0.30879	val-logloss:0.51045	val-auc:0.70719	val-aucpr:0.22722
[50]	train-logloss:0.58947	train-auc:0.70068	train-aucpr:0.31300	val-logloss:0.49844	val-auc:0.70455	val-aucpr:0.22575
[60]	train-logloss:0.58548	train-auc:0.70308	train-aucpr:0.31683	val-logloss:0.48773	val-auc:0.70091	val-aucpr:0.22551
[70]	train-logloss:0.58217	train-auc:0.70709	train-aucpr:0.32033	val-logloss:0.48616	val-auc:0.69900	val-aucpr:0.22062
[80]	train-logloss:0.57916	train-auc:0.71116	train-aucpr:0.32475	val-logloss:0.47710	val-auc:0.70270	val-aucpr:0.22216
[86]	train-logloss:0.57769	train-auc:0.71267	train-aucpr:0.32602	val-logloss:0.46314	val-auc:0.70341	val-aucpr:0.21960
[2025-11-19 09:35:15,244] [INFO] [<frozen importlib] - Training completed at iteration 57
[2025-11-19 09:35:15,244] [INFO] [<frozen importlib] - Best train loss: 0.5867
[2025-11-19 09:35:15,244] [INFO] [<frozen importlib] - Best val loss: 0.4911
[2025-11-19 09:35:15,244] [INFO] [<frozen importlib] - Best val AUC: 0.7029
[2025-11-19 09:35:15,244] [INFO] [<frozen importlib] - Best val AUCPR: 0.2280
[2025-11-19 09:35:15,249] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:35:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:35:26,656] [INFO] [<frozen importlib] - Optimal threshold: 0.4626
[2025-11-19 09:35:26,656] [INFO] [<frozen importlib] - Best f1: 0.2817
[2025-11-19 09:35:26,656] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:35:26,709] [INFO] [<frozen importlib] - Validation Results (threshold=0.4626):
[2025-11-19 09:35:26,709] [INFO] [<frozen importlib] -   Accuracy: 0.9090
[2025-11-19 09:35:26,709] [INFO] [<frozen importlib] -   Precision: 0.3581
[2025-11-19 09:35:26,709] [INFO] [<frozen importlib] -   Recall: 0.2321
[2025-11-19 09:35:26,709] [INFO] [<frozen importlib] -   F1 Score: 0.2817
[2025-11-19 09:35:26,709] [INFO] [<frozen importlib] -   AUROC: 0.7029
[2025-11-19 09:35:26,709] [INFO] [<frozen importlib] -   AUPRC: 0.2283
[2025-11-19 09:35:26,709] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:35:26,709] [INFO] [<frozen importlib] -     TN=16841, FP=604
[2025-11-19 09:35:26,709] [INFO] [<frozen importlib] -     FN=1115, TP=337
[2025-11-19 09:35:26,735] [INFO] [<frozen importlib] - Trial 428: AUPRC=0.2283, F1=0.4471, Prec=0.4950, Rec=0.4077 | Optimizing auprc=0.2283
[2025-11-19 09:35:26,736] [INFO] [<frozen importlib] - Trial 428 pruned.
[2025-11-19 09:35:26,736] [ERROR] [<frozen importlib] - Trial 428 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  86%|████████▌ | 428/500 [1:13:24<13:55, 11.60s/it]Best trial: 289. Best value: 0.241792:  86%|████████▌ | 428/500 [1:13:24<13:55, 11.60s/it]Best trial: 289. Best value: 0.241792:  86%|████████▌ | 429/500 [1:13:24<13:48, 11.68s/it][2025-11-19 09:35:26,760] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.298615818029777
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   gamma: 0.13921357613125696
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   alpha: 0.54406233463904
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   lambda: 1.1858494113559546
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   learning_rate: 0.032152922188934965
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   subsample: 0.8338328375742335
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   colsample_bytree: 0.6125665186879525
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5435817449663726
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   colsample_bynode: 0.8023430879726258
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:35:26,760] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:35:26,761] [INFO] [<frozen importlib] -   scale_pos_weight: 5.298615818029777
[2025-11-19 09:35:26,841] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:35:26] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:35:26,736] Trial 428 pruned. 
[0]	train-logloss:0.60450	train-auc:0.65486	train-aucpr:0.23839	val-logloss:0.58815	val-auc:0.64388	val-aucpr:0.14282
[10]	train-logloss:0.58605	train-auc:0.68027	train-aucpr:0.29360	val-logloss:0.54439	val-auc:0.70665	val-aucpr:0.20175
[20]	train-logloss:0.57374	train-auc:0.68704	train-aucpr:0.29930	val-logloss:0.51566	val-auc:0.70169	val-aucpr:0.19619
[30]	train-logloss:0.56517	train-auc:0.69034	train-aucpr:0.30379	val-logloss:0.50082	val-auc:0.70073	val-aucpr:0.20489
[40]	train-logloss:0.55904	train-auc:0.69518	train-aucpr:0.30785	val-logloss:0.48885	val-auc:0.70455	val-aucpr:0.21051
[50]	train-logloss:0.55377	train-auc:0.69858	train-aucpr:0.31180	val-logloss:0.47554	val-auc:0.70371	val-aucpr:0.21559
[60]	train-logloss:0.55015	train-auc:0.70092	train-aucpr:0.31454	val-logloss:0.47128	val-auc:0.70191	val-aucpr:0.20848
[70]	train-logloss:0.54700	train-auc:0.70341	train-aucpr:0.31706	val-logloss:0.46815	val-auc:0.70291	val-aucpr:0.20820
[80]	train-logloss:0.54438	train-auc:0.70687	train-aucpr:0.32092	val-logloss:0.46142	val-auc:0.70318	val-aucpr:0.20789
[81]	train-logloss:0.54416	train-auc:0.70701	train-aucpr:0.32111	val-logloss:0.46079	val-auc:0.70368	val-aucpr:0.20955
[2025-11-19 09:35:27,084] [INFO] [<frozen importlib] - Training completed at iteration 52
[2025-11-19 09:35:27,084] [INFO] [<frozen importlib] - Best train loss: 0.5530
[2025-11-19 09:35:27,084] [INFO] [<frozen importlib] - Best val loss: 0.4735
[2025-11-19 09:35:27,084] [INFO] [<frozen importlib] - Best val AUC: 0.7050
[2025-11-19 09:35:27,084] [INFO] [<frozen importlib] - Best val AUCPR: 0.2169
[2025-11-19 09:35:27,090] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:35:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:35:37,519] [INFO] [<frozen importlib] - Optimal threshold: 0.4369
[2025-11-19 09:35:37,519] [INFO] [<frozen importlib] - Best f1: 0.2674
[2025-11-19 09:35:37,520] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:35:37,562] [INFO] [<frozen importlib] - Validation Results (threshold=0.4369):
[2025-11-19 09:35:37,562] [INFO] [<frozen importlib] -   Accuracy: 0.8922
[2025-11-19 09:35:37,562] [INFO] [<frozen importlib] -   Precision: 0.2797
[2025-11-19 09:35:37,562] [INFO] [<frozen importlib] -   Recall: 0.2562
[2025-11-19 09:35:37,562] [INFO] [<frozen importlib] -   F1 Score: 0.2674
[2025-11-19 09:35:37,562] [INFO] [<frozen importlib] -   AUROC: 0.7050
[2025-11-19 09:35:37,562] [INFO] [<frozen importlib] -   AUPRC: 0.2174
[2025-11-19 09:35:37,562] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:35:37,562] [INFO] [<frozen importlib] -     TN=16487, FP=958
[2025-11-19 09:35:37,562] [INFO] [<frozen importlib] -     FN=1080, TP=372
[2025-11-19 09:35:37,584] [INFO] [<frozen importlib] - Trial 429: AUPRC=0.2174, F1=0.4492, Prec=0.4215, Rec=0.4807 | Optimizing auprc=0.2174
[2025-11-19 09:35:37,585] [INFO] [<frozen importlib] - Trial 429 pruned.
[2025-11-19 09:35:37,585] [ERROR] [<frozen importlib] - Trial 429 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  86%|████████▌ | 429/500 [1:13:35<13:48, 11.68s/it]Best trial: 289. Best value: 0.241792:  86%|████████▌ | 429/500 [1:13:35<13:48, 11.68s/it]Best trial: 289. Best value: 0.241792:  86%|████████▌ | 430/500 [1:13:35<13:19, 11.43s/it][2025-11-19 09:35:37,598] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.536853517913723
[2025-11-19 09:35:37,598] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   gamma: 0.17897654908410585
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   alpha: 0.5653909899075992
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   lambda: 1.014592696710923
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   learning_rate: 0.03527929038978368
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   subsample: 0.855913353657022
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   colsample_bytree: 0.5918571409095822
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5222765478706396
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   colsample_bynode: 0.8011274065792734
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:35:37,599] [INFO] [<frozen importlib] -   scale_pos_weight: 6.536853517913723
[2025-11-19 09:35:37,672] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:35:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:35:37,585] Trial 429 pruned. 
[0]	train-logloss:0.67416	train-auc:0.63861	train-aucpr:0.22154	val-logloss:0.66804	val-auc:0.61540	val-aucpr:0.12775
[10]	train-logloss:0.65148	train-auc:0.68128	train-aucpr:0.28839	val-logloss:0.62049	val-auc:0.66817	val-aucpr:0.17502
[20]	train-logloss:0.63699	train-auc:0.68746	train-aucpr:0.29730	val-logloss:0.58537	val-auc:0.67156	val-aucpr:0.19497
[30]	train-logloss:0.62680	train-auc:0.69207	train-aucpr:0.30392	val-logloss:0.55433	val-auc:0.67984	val-aucpr:0.21562
[40]	train-logloss:0.61970	train-auc:0.69564	train-aucpr:0.30855	val-logloss:0.52954	val-auc:0.70155	val-aucpr:0.23125
[50]	train-logloss:0.61422	train-auc:0.69985	train-aucpr:0.31224	val-logloss:0.50955	val-auc:0.70129	val-aucpr:0.23115
[60]	train-logloss:0.60982	train-auc:0.70369	train-aucpr:0.31611	val-logloss:0.50754	val-auc:0.70539	val-aucpr:0.23058
[70]	train-logloss:0.60647	train-auc:0.70654	train-aucpr:0.31896	val-logloss:0.50194	val-auc:0.70902	val-aucpr:0.23524
[80]	train-logloss:0.60352	train-auc:0.71112	train-aucpr:0.32337	val-logloss:0.48193	val-auc:0.70735	val-aucpr:0.23302
[90]	train-logloss:0.60065	train-auc:0.71468	train-aucpr:0.32762	val-logloss:0.47930	val-auc:0.70650	val-aucpr:0.22963
[100]	train-logloss:0.59811	train-auc:0.71907	train-aucpr:0.33186	val-logloss:0.47102	val-auc:0.70366	val-aucpr:0.22564
[105]	train-logloss:0.59680	train-auc:0.72121	train-aucpr:0.33374	val-logloss:0.46686	val-auc:0.70341	val-aucpr:0.22341
[2025-11-19 09:35:37,967] [INFO] [<frozen importlib] - Training completed at iteration 75
[2025-11-19 09:35:37,967] [INFO] [<frozen importlib] - Best train loss: 0.6052
[2025-11-19 09:35:37,967] [INFO] [<frozen importlib] - Best val loss: 0.4917
[2025-11-19 09:35:37,967] [INFO] [<frozen importlib] - Best val AUC: 0.7110
[2025-11-19 09:35:37,967] [INFO] [<frozen importlib] - Best val AUCPR: 0.2358
[2025-11-19 09:35:37,972] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:35:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:35:50,825] [INFO] [<frozen importlib] - Optimal threshold: 0.4941
[2025-11-19 09:35:50,825] [INFO] [<frozen importlib] - Best f1: 0.2810
[2025-11-19 09:35:50,825] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:35:50,869] [INFO] [<frozen importlib] - Validation Results (threshold=0.4941):
[2025-11-19 09:35:50,869] [INFO] [<frozen importlib] -   Accuracy: 0.9071
[2025-11-19 09:35:50,869] [INFO] [<frozen importlib] -   Precision: 0.3468
[2025-11-19 09:35:50,869] [INFO] [<frozen importlib] -   Recall: 0.2362
[2025-11-19 09:35:50,869] [INFO] [<frozen importlib] -   F1 Score: 0.2810
[2025-11-19 09:35:50,869] [INFO] [<frozen importlib] -   AUROC: 0.7110
[2025-11-19 09:35:50,869] [INFO] [<frozen importlib] -   AUPRC: 0.2362
[2025-11-19 09:35:50,869] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:35:50,869] [INFO] [<frozen importlib] -     TN=16799, FP=646
[2025-11-19 09:35:50,869] [INFO] [<frozen importlib] -     FN=1109, TP=343
[2025-11-19 09:35:50,892] [INFO] [<frozen importlib] - Trial 430: AUPRC=0.2362, F1=0.4641, Prec=0.4953, Rec=0.4366 | Optimizing auprc=0.2362
                                                                                          Best trial: 289. Best value: 0.241792:  86%|████████▌ | 430/500 [1:13:48<13:19, 11.43s/it]Best trial: 289. Best value: 0.241792:  86%|████████▌ | 430/500 [1:13:48<13:19, 11.43s/it]Best trial: 289. Best value: 0.241792:  86%|████████▌ | 431/500 [1:13:48<13:47, 11.99s/it][2025-11-19 09:35:50,907] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.575822380279127
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   gamma: 0.18245943167332745
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   alpha: 1.6846734596548716
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   lambda: 0.8924310544183661
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   learning_rate: 0.03556647737605437
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   subsample: 0.8592998080602217
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   colsample_bytree: 0.5815986018384283
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5281545716704408
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   colsample_bynode: 0.8211343953460972
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:35:50,908] [INFO] [<frozen importlib] -   scale_pos_weight: 6.575822380279127
[2025-11-19 09:35:50,977] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:35:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:35:50,893] Trial 430 finished with value: 0.23616324057195498 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.17897654908410585, 'learning_rate': 0.03527929038978368, 'n_estimators': 350, 'alpha': 0.5653909899075992, 'lambda': 1.014592696710923, 'subsample': 0.855913353657022, 'colsample_bytree': 0.5918571409095822, 'colsample_bylevel': 0.5222765478706396, 'colsample_bynode': 0.8011274065792734, 'scale_pos_weight': 6.536853517913723}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.67617	train-auc:0.63834	train-aucpr:0.22747	val-logloss:0.66993	val-auc:0.63646	val-aucpr:0.13571
[10]	train-logloss:0.65386	train-auc:0.67860	train-aucpr:0.28764	val-logloss:0.61716	val-auc:0.69397	val-aucpr:0.20060
[20]	train-logloss:0.63904	train-auc:0.68760	train-aucpr:0.29721	val-logloss:0.57855	val-auc:0.70502	val-aucpr:0.21949
[30]	train-logloss:0.62870	train-auc:0.69290	train-aucpr:0.30348	val-logloss:0.55478	val-auc:0.70178	val-aucpr:0.22348
[40]	train-logloss:0.62154	train-auc:0.69650	train-aucpr:0.30740	val-logloss:0.53827	val-auc:0.70693	val-aucpr:0.22860
[50]	train-logloss:0.61552	train-auc:0.70161	train-aucpr:0.31320	val-logloss:0.52528	val-auc:0.71176	val-aucpr:0.23544
[60]	train-logloss:0.61131	train-auc:0.70496	train-aucpr:0.31692	val-logloss:0.51887	val-auc:0.71080	val-aucpr:0.23497
[70]	train-logloss:0.60806	train-auc:0.70845	train-aucpr:0.31929	val-logloss:0.51265	val-auc:0.71228	val-aucpr:0.23568
[80]	train-logloss:0.60503	train-auc:0.71214	train-aucpr:0.32290	val-logloss:0.49891	val-auc:0.70648	val-aucpr:0.22942
[90]	train-logloss:0.60242	train-auc:0.71535	train-aucpr:0.32671	val-logloss:0.48624	val-auc:0.69962	val-aucpr:0.21790
[95]	train-logloss:0.60146	train-auc:0.71637	train-aucpr:0.32843	val-logloss:0.48857	val-auc:0.69856	val-aucpr:0.21807
[2025-11-19 09:35:51,252] [INFO] [<frozen importlib] - Training completed at iteration 66
[2025-11-19 09:35:51,252] [INFO] [<frozen importlib] - Best train loss: 0.6095
[2025-11-19 09:35:51,252] [INFO] [<frozen importlib] - Best val loss: 0.5144
[2025-11-19 09:35:51,252] [INFO] [<frozen importlib] - Best val AUC: 0.7124
[2025-11-19 09:35:51,252] [INFO] [<frozen importlib] - Best val AUCPR: 0.2366
[2025-11-19 09:35:51,257] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:35:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:36:04,918] [INFO] [<frozen importlib] - Optimal threshold: 0.4789
[2025-11-19 09:36:04,918] [INFO] [<frozen importlib] - Best f1: 0.2759
[2025-11-19 09:36:04,918] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:36:04,964] [INFO] [<frozen importlib] - Validation Results (threshold=0.4789):
[2025-11-19 09:36:04,964] [INFO] [<frozen importlib] -   Accuracy: 0.8892
[2025-11-19 09:36:04,964] [INFO] [<frozen importlib] -   Precision: 0.2771
[2025-11-19 09:36:04,964] [INFO] [<frozen importlib] -   Recall: 0.2748
[2025-11-19 09:36:04,964] [INFO] [<frozen importlib] -   F1 Score: 0.2759
[2025-11-19 09:36:04,965] [INFO] [<frozen importlib] -   AUROC: 0.7124
[2025-11-19 09:36:04,965] [INFO] [<frozen importlib] -   AUPRC: 0.2370
[2025-11-19 09:36:04,965] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:36:04,965] [INFO] [<frozen importlib] -     TN=16404, FP=1041
[2025-11-19 09:36:04,965] [INFO] [<frozen importlib] -     FN=1053, TP=399
[2025-11-19 09:36:04,988] [INFO] [<frozen importlib] - Trial 431: AUPRC=0.2370, F1=0.4433, Prec=0.4055, Rec=0.4890 | Optimizing auprc=0.2370
                                                                                          Best trial: 289. Best value: 0.241792:  86%|████████▌ | 431/500 [1:14:02<13:47, 11.99s/it]Best trial: 289. Best value: 0.241792:  86%|████████▌ | 431/500 [1:14:02<13:47, 11.99s/it]Best trial: 289. Best value: 0.241792:  86%|████████▋ | 432/500 [1:14:02<14:18, 12.62s/it][2025-11-19 09:36:05,003] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.842001903791209
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   gamma: 0.1959337318039608
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   alpha: 0.4858335010639946
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   lambda: 0.8617514796526988
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   learning_rate: 0.03508343705344293
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   subsample: 0.8500048753094722
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   colsample_bytree: 0.5668861724600701
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5240239666354928
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   colsample_bynode: 0.7973423977847354
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:36:05,003] [INFO] [<frozen importlib] -   scale_pos_weight: 6.842001903791209
[2025-11-19 09:36:05,079] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:36:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:36:04,989] Trial 431 finished with value: 0.2369850305994583 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.18245943167332745, 'learning_rate': 0.03556647737605437, 'n_estimators': 350, 'alpha': 1.6846734596548716, 'lambda': 0.8924310544183661, 'subsample': 0.8592998080602217, 'colsample_bytree': 0.5815986018384283, 'colsample_bylevel': 0.5281545716704408, 'colsample_bynode': 0.8211343953460972, 'scale_pos_weight': 6.575822380279127}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.69062	train-auc:0.64099	train-aucpr:0.22978	val-logloss:0.68613	val-auc:0.63817	val-aucpr:0.13898
[10]	train-logloss:0.66720	train-auc:0.68255	train-aucpr:0.28897	val-logloss:0.62574	val-auc:0.70246	val-aucpr:0.21401
[20]	train-logloss:0.65276	train-auc:0.68818	train-aucpr:0.29642	val-logloss:0.58576	val-auc:0.69780	val-aucpr:0.20760
[30]	train-logloss:0.64258	train-auc:0.69130	train-aucpr:0.30190	val-logloss:0.55936	val-auc:0.69133	val-aucpr:0.21352
[40]	train-logloss:0.63555	train-auc:0.69437	train-aucpr:0.30507	val-logloss:0.55607	val-auc:0.69121	val-aucpr:0.21282
[50]	train-logloss:0.62952	train-auc:0.69879	train-aucpr:0.30908	val-logloss:0.54771	val-auc:0.69808	val-aucpr:0.21871
[60]	train-logloss:0.62475	train-auc:0.70391	train-aucpr:0.31344	val-logloss:0.53236	val-auc:0.69988	val-aucpr:0.21708
[70]	train-logloss:0.62127	train-auc:0.70640	train-aucpr:0.31705	val-logloss:0.52862	val-auc:0.70382	val-aucpr:0.21811
[74]	train-logloss:0.62021	train-auc:0.70753	train-aucpr:0.31847	val-logloss:0.52582	val-auc:0.70455	val-aucpr:0.21873
[2025-11-19 09:36:05,303] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 09:36:05,303] [INFO] [<frozen importlib] - Best train loss: 0.6323
[2025-11-19 09:36:05,303] [INFO] [<frozen importlib] - Best val loss: 0.5488
[2025-11-19 09:36:05,303] [INFO] [<frozen importlib] - Best val AUC: 0.6996
[2025-11-19 09:36:05,303] [INFO] [<frozen importlib] - Best val AUCPR: 0.2208
[2025-11-19 09:36:05,309] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:36:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:36:15,014] [INFO] [<frozen importlib] - Optimal threshold: 0.5018
[2025-11-19 09:36:15,014] [INFO] [<frozen importlib] - Best f1: 0.2628
[2025-11-19 09:36:15,014] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:36:15,057] [INFO] [<frozen importlib] - Validation Results (threshold=0.5018):
[2025-11-19 09:36:15,057] [INFO] [<frozen importlib] -   Accuracy: 0.8901
[2025-11-19 09:36:15,057] [INFO] [<frozen importlib] -   Precision: 0.2713
[2025-11-19 09:36:15,057] [INFO] [<frozen importlib] -   Recall: 0.2548
[2025-11-19 09:36:15,057] [INFO] [<frozen importlib] -   F1 Score: 0.2628
[2025-11-19 09:36:15,057] [INFO] [<frozen importlib] -   AUROC: 0.6996
[2025-11-19 09:36:15,057] [INFO] [<frozen importlib] -   AUPRC: 0.2211
[2025-11-19 09:36:15,057] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:36:15,057] [INFO] [<frozen importlib] -     TN=16451, FP=994
[2025-11-19 09:36:15,057] [INFO] [<frozen importlib] -     FN=1082, TP=370
[2025-11-19 09:36:15,080] [INFO] [<frozen importlib] - Trial 432: AUPRC=0.2211, F1=0.4636, Prec=0.4261, Rec=0.5083 | Optimizing auprc=0.2211
[2025-11-19 09:36:15,080] [INFO] [<frozen importlib] - Trial 432 pruned.
[2025-11-19 09:36:15,080] [ERROR] [<frozen importlib] - Trial 432 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  86%|████████▋ | 432/500 [1:14:13<14:18, 12.62s/it]Best trial: 289. Best value: 0.241792:  86%|████████▋ | 432/500 [1:14:13<14:18, 12.62s/it]Best trial: 289. Best value: 0.241792:  87%|████████▋ | 433/500 [1:14:13<13:14, 11.86s/it][2025-11-19 09:36:15,094] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.656625880841137
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   gamma: 0.17324348095479522
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   alpha: 1.5230828245251162
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   lambda: 1.0116460157205527
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   learning_rate: 0.03505183472493514
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   subsample: 0.8578100126876385
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   colsample_bytree: 0.5926235747068702
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   colsample_bylevel: 0.546957964466958
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   colsample_bynode: 0.8384265708774128
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:36:15,094] [INFO] [<frozen importlib] -   scale_pos_weight: 6.656625880841137
[2025-11-19 09:36:15,171] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:36:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:36:15,080] Trial 432 pruned. 
[0]	train-logloss:0.68092	train-auc:0.63336	train-aucpr:0.22321	val-logloss:0.67624	val-auc:0.64813	val-aucpr:0.16426
[10]	train-logloss:0.65786	train-auc:0.68153	train-aucpr:0.28810	val-logloss:0.62537	val-auc:0.70442	val-aucpr:0.20830
[20]	train-logloss:0.64288	train-auc:0.68843	train-aucpr:0.29935	val-logloss:0.58839	val-auc:0.70010	val-aucpr:0.20884
[30]	train-logloss:0.63261	train-auc:0.69210	train-aucpr:0.30379	val-logloss:0.55718	val-auc:0.69855	val-aucpr:0.21587
[40]	train-logloss:0.62556	train-auc:0.69600	train-aucpr:0.30781	val-logloss:0.54032	val-auc:0.70328	val-aucpr:0.22140
[50]	train-logloss:0.61958	train-auc:0.70004	train-aucpr:0.31258	val-logloss:0.52274	val-auc:0.70580	val-aucpr:0.22332
[60]	train-logloss:0.61529	train-auc:0.70348	train-aucpr:0.31697	val-logloss:0.50893	val-auc:0.70709	val-aucpr:0.22871
[70]	train-logloss:0.61150	train-auc:0.70780	train-aucpr:0.32117	val-logloss:0.50657	val-auc:0.70949	val-aucpr:0.22541
[80]	train-logloss:0.60858	train-auc:0.71205	train-aucpr:0.32509	val-logloss:0.50116	val-auc:0.70528	val-aucpr:0.22237
[90]	train-logloss:0.60623	train-auc:0.71491	train-aucpr:0.32751	val-logloss:0.49726	val-auc:0.70437	val-aucpr:0.22157
[91]	train-logloss:0.60605	train-auc:0.71533	train-aucpr:0.32792	val-logloss:0.49308	val-auc:0.70408	val-aucpr:0.22126
[2025-11-19 09:36:15,439] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:36:15,439] [INFO] [<frozen importlib] - Best train loss: 0.6145
[2025-11-19 09:36:15,439] [INFO] [<frozen importlib] - Best val loss: 0.5069
[2025-11-19 09:36:15,439] [INFO] [<frozen importlib] - Best val AUC: 0.7061
[2025-11-19 09:36:15,439] [INFO] [<frozen importlib] - Best val AUCPR: 0.2287
[2025-11-19 09:36:15,444] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:36:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:36:27,801] [INFO] [<frozen importlib] - Optimal threshold: 0.4822
[2025-11-19 09:36:27,801] [INFO] [<frozen importlib] - Best f1: 0.2709
[2025-11-19 09:36:27,801] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:36:27,840] [INFO] [<frozen importlib] - Validation Results (threshold=0.4822):
[2025-11-19 09:36:27,840] [INFO] [<frozen importlib] -   Accuracy: 0.8906
[2025-11-19 09:36:27,840] [INFO] [<frozen importlib] -   Precision: 0.2777
[2025-11-19 09:36:27,840] [INFO] [<frozen importlib] -   Recall: 0.2645
[2025-11-19 09:36:27,840] [INFO] [<frozen importlib] -   F1 Score: 0.2709
[2025-11-19 09:36:27,840] [INFO] [<frozen importlib] -   AUROC: 0.7061
[2025-11-19 09:36:27,840] [INFO] [<frozen importlib] -   AUPRC: 0.2291
[2025-11-19 09:36:27,840] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:36:27,840] [INFO] [<frozen importlib] -     TN=16446, FP=999
[2025-11-19 09:36:27,840] [INFO] [<frozen importlib] -     FN=1068, TP=384
[2025-11-19 09:36:27,863] [INFO] [<frozen importlib] - Trial 433: AUPRC=0.2291, F1=0.4522, Prec=0.4175, Rec=0.4931 | Optimizing auprc=0.2291
[2025-11-19 09:36:27,864] [INFO] [<frozen importlib] - Trial 433 pruned.
[2025-11-19 09:36:27,864] [ERROR] [<frozen importlib] - Trial 433 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  87%|████████▋ | 433/500 [1:14:25<13:14, 11.86s/it]Best trial: 289. Best value: 0.241792:  87%|████████▋ | 433/500 [1:14:25<13:14, 11.86s/it]Best trial: 289. Best value: 0.241792:  87%|████████▋ | 434/500 [1:14:25<13:21, 12.14s/it][2025-11-19 09:36:27,877] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.505440854525401
[2025-11-19 09:36:27,877] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:36:27,877] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:36:27,877] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:36:27,877] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:36:27,877] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:36:27,877] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:36:27,877] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:36:27,877] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   gamma: 0.997081643120239
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   alpha: 0.5159415641857205
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   lambda: 0.7275889823903766
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   learning_rate: 0.03399187848143558
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   subsample: 0.8279015296726141
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   colsample_bytree: 0.6050830508482413
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5376855614220071
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   colsample_bynode: 0.7984820302135041
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:36:27,878] [INFO] [<frozen importlib] -   scale_pos_weight: 6.505440854525401
[2025-11-19 09:36:27,950] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:36:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:36:27,864] Trial 433 pruned. 
[0]	train-logloss:0.67213	train-auc:0.65445	train-aucpr:0.23873	val-logloss:0.67412	val-auc:0.49290	val-aucpr:0.07003
[10]	train-logloss:0.65003	train-auc:0.68061	train-aucpr:0.28992	val-logloss:0.61542	val-auc:0.68561	val-aucpr:0.19671
[20]	train-logloss:0.63606	train-auc:0.68829	train-aucpr:0.29743	val-logloss:0.57413	val-auc:0.70098	val-aucpr:0.21264
[30]	train-logloss:0.62627	train-auc:0.69249	train-aucpr:0.30380	val-logloss:0.54332	val-auc:0.70625	val-aucpr:0.22483
[40]	train-logloss:0.61908	train-auc:0.69596	train-aucpr:0.30811	val-logloss:0.51947	val-auc:0.70848	val-aucpr:0.22774
[50]	train-logloss:0.61320	train-auc:0.69888	train-aucpr:0.31145	val-logloss:0.50804	val-auc:0.70515	val-aucpr:0.22440
[60]	train-logloss:0.60902	train-auc:0.70289	train-aucpr:0.31512	val-logloss:0.50185	val-auc:0.69804	val-aucpr:0.22011
[63]	train-logloss:0.60774	train-auc:0.70466	train-aucpr:0.31722	val-logloss:0.50058	val-auc:0.69129	val-aucpr:0.21537
[2025-11-19 09:36:28,145] [INFO] [<frozen importlib] - Training completed at iteration 34
[2025-11-19 09:36:28,145] [INFO] [<frozen importlib] - Best train loss: 0.6231
[2025-11-19 09:36:28,145] [INFO] [<frozen importlib] - Best val loss: 0.5358
[2025-11-19 09:36:28,145] [INFO] [<frozen importlib] - Best val AUC: 0.7086
[2025-11-19 09:36:28,145] [INFO] [<frozen importlib] - Best val AUCPR: 0.2282
[2025-11-19 09:36:28,149] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:36:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:36:34,759] [INFO] [<frozen importlib] - Optimal threshold: 0.4661
[2025-11-19 09:36:34,759] [INFO] [<frozen importlib] - Best f1: 0.2791
[2025-11-19 09:36:34,759] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:36:34,800] [INFO] [<frozen importlib] - Validation Results (threshold=0.4661):
[2025-11-19 09:36:34,800] [INFO] [<frozen importlib] -   Accuracy: 0.8830
[2025-11-19 09:36:34,800] [INFO] [<frozen importlib] -   Precision: 0.2650
[2025-11-19 09:36:34,800] [INFO] [<frozen importlib] -   Recall: 0.2948
[2025-11-19 09:36:34,800] [INFO] [<frozen importlib] -   F1 Score: 0.2791
[2025-11-19 09:36:34,800] [INFO] [<frozen importlib] -   AUROC: 0.7086
[2025-11-19 09:36:34,800] [INFO] [<frozen importlib] -   AUPRC: 0.2285
[2025-11-19 09:36:34,800] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:36:34,800] [INFO] [<frozen importlib] -     TN=16258, FP=1187
[2025-11-19 09:36:34,800] [INFO] [<frozen importlib] -     FN=1024, TP=428
[2025-11-19 09:36:34,825] [INFO] [<frozen importlib] - Trial 434: AUPRC=0.2285, F1=0.4320, Prec=0.3798, Rec=0.5007 | Optimizing auprc=0.2285
                                                                                          Best trial: 289. Best value: 0.241792:  87%|████████▋ | 434/500 [1:14:32<13:21, 12.14s/it]Best trial: 289. Best value: 0.241792:  87%|████████▋ | 434/500 [1:14:32<13:21, 12.14s/it]Best trial: 289. Best value: 0.241792:  87%|████████▋ | 435/500 [1:14:32<11:28, 10.59s/it][2025-11-19 09:36:34,839] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.948132507955365
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   gamma: 0.16196409943342327
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   alpha: 0.44671374201598935
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   lambda: 0.8656333812103392
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   learning_rate: 0.035888727069470265
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   subsample: 0.8275467492173769
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   colsample_bytree: 0.5793722965131535
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5229066936163166
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   colsample_bynode: 0.8168620537904019
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:36:34,839] [INFO] [<frozen importlib] -   scale_pos_weight: 6.948132507955365
[2025-11-19 09:36:34,912] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:36:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:36:34,825] Trial 434 finished with value: 0.22853528293075664 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.997081643120239, 'learning_rate': 0.03399187848143558, 'n_estimators': 350, 'alpha': 0.5159415641857205, 'lambda': 0.7275889823903766, 'subsample': 0.8279015296726141, 'colsample_bytree': 0.6050830508482413, 'colsample_bylevel': 0.5376855614220071, 'colsample_bynode': 0.7984820302135041, 'scale_pos_weight': 6.505440854525401}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.69634	train-auc:0.63988	train-aucpr:0.22849	val-logloss:0.69325	val-auc:0.61596	val-aucpr:0.11895
[10]	train-logloss:0.67276	train-auc:0.67943	train-aucpr:0.28594	val-logloss:0.62998	val-auc:0.70279	val-aucpr:0.20949
[20]	train-logloss:0.65773	train-auc:0.68681	train-aucpr:0.29421	val-logloss:0.58955	val-auc:0.70864	val-aucpr:0.22424
[30]	train-logloss:0.64697	train-auc:0.69334	train-aucpr:0.30235	val-logloss:0.56316	val-auc:0.70861	val-aucpr:0.23039
[40]	train-logloss:0.63973	train-auc:0.69687	train-aucpr:0.30584	val-logloss:0.53823	val-auc:0.70850	val-aucpr:0.22608
[50]	train-logloss:0.63341	train-auc:0.70204	train-aucpr:0.31148	val-logloss:0.51810	val-auc:0.71278	val-aucpr:0.23094
[60]	train-logloss:0.62910	train-auc:0.70534	train-aucpr:0.31553	val-logloss:0.51333	val-auc:0.71091	val-aucpr:0.23240
[70]	train-logloss:0.62521	train-auc:0.70908	train-aucpr:0.31915	val-logloss:0.50162	val-auc:0.70252	val-aucpr:0.22589
[80]	train-logloss:0.62182	train-auc:0.71269	train-aucpr:0.32315	val-logloss:0.49558	val-auc:0.69962	val-aucpr:0.22215
[84]	train-logloss:0.62059	train-auc:0.71424	train-aucpr:0.32437	val-logloss:0.49167	val-auc:0.69474	val-aucpr:0.21760
[2025-11-19 09:36:35,157] [INFO] [<frozen importlib] - Training completed at iteration 55
[2025-11-19 09:36:35,157] [INFO] [<frozen importlib] - Best train loss: 0.6314
[2025-11-19 09:36:35,157] [INFO] [<frozen importlib] - Best val loss: 0.5136
[2025-11-19 09:36:35,157] [INFO] [<frozen importlib] - Best val AUC: 0.7141
[2025-11-19 09:36:35,157] [INFO] [<frozen importlib] - Best val AUCPR: 0.2334
[2025-11-19 09:36:35,161] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:36:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:36:48,119] [INFO] [<frozen importlib] - Optimal threshold: 0.4882
[2025-11-19 09:36:48,119] [INFO] [<frozen importlib] - Best f1: 0.2703
[2025-11-19 09:36:48,119] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:36:48,166] [INFO] [<frozen importlib] - Validation Results (threshold=0.4882):
[2025-11-19 09:36:48,166] [INFO] [<frozen importlib] -   Accuracy: 0.8923
[2025-11-19 09:36:48,166] [INFO] [<frozen importlib] -   Precision: 0.2820
[2025-11-19 09:36:48,166] [INFO] [<frozen importlib] -   Recall: 0.2596
[2025-11-19 09:36:48,166] [INFO] [<frozen importlib] -   F1 Score: 0.2703
[2025-11-19 09:36:48,166] [INFO] [<frozen importlib] -   AUROC: 0.7141
[2025-11-19 09:36:48,166] [INFO] [<frozen importlib] -   AUPRC: 0.2338
[2025-11-19 09:36:48,166] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:36:48,166] [INFO] [<frozen importlib] -     TN=16485, FP=960
[2025-11-19 09:36:48,166] [INFO] [<frozen importlib] -     FN=1075, TP=377
[2025-11-19 09:36:48,189] [INFO] [<frozen importlib] - Trial 435: AUPRC=0.2338, F1=0.4519, Prec=0.4231, Rec=0.4848 | Optimizing auprc=0.2338
                                                                                          Best trial: 289. Best value: 0.241792:  87%|████████▋ | 435/500 [1:14:46<11:28, 10.59s/it]Best trial: 289. Best value: 0.241792:  87%|████████▋ | 435/500 [1:14:46<11:28, 10.59s/it]Best trial: 289. Best value: 0.241792:  87%|████████▋ | 436/500 [1:14:46<12:10, 11.42s/it][2025-11-19 09:36:48,204] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.624523393196053
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   gamma: 0.18572658705465764
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   alpha: 1.8945764507159009
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   lambda: 1.0138617946594137
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   learning_rate: 0.16635886267177896
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   subsample: 0.8591698704365545
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   colsample_bytree: 0.5970366149100848
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5533453735710436
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   colsample_bynode: 0.8020851952045583
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:36:48,204] [INFO] [<frozen importlib] -   scale_pos_weight: 6.624523393196053
[2025-11-19 09:36:48,277] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:36:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:36:48,190] Trial 435 finished with value: 0.233788662638942 and parameters: {'max_depth': 4, 'min_child_weight': 9, 'gamma': 0.16196409943342327, 'learning_rate': 0.035888727069470265, 'n_estimators': 350, 'alpha': 0.44671374201598935, 'lambda': 0.8656333812103392, 'subsample': 0.8275467492173769, 'colsample_bytree': 0.5793722965131535, 'colsample_bylevel': 0.5229066936163166, 'colsample_bynode': 0.8168620537904019, 'scale_pos_weight': 6.948132507955365}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.67109	train-auc:0.63240	train-aucpr:0.22095	val-logloss:0.65522	val-auc:0.64155	val-aucpr:0.14716
[10]	train-logloss:0.61849	train-auc:0.69611	train-aucpr:0.30369	val-logloss:0.49704	val-auc:0.68063	val-aucpr:0.18990
[20]	train-logloss:0.60237	train-auc:0.71619	train-aucpr:0.32736	val-logloss:0.51481	val-auc:0.69302	val-aucpr:0.19256
[30]	train-logloss:0.59309	train-auc:0.73116	train-aucpr:0.34423	val-logloss:0.47436	val-auc:0.68373	val-aucpr:0.16865
[40]	train-logloss:0.58562	train-auc:0.74405	train-aucpr:0.35755	val-logloss:0.45852	val-auc:0.66839	val-aucpr:0.15464
[47]	train-logloss:0.58017	train-auc:0.75126	train-aucpr:0.36639	val-logloss:0.40091	val-auc:0.67036	val-aucpr:0.14610
[2025-11-19 09:36:48,431] [INFO] [<frozen importlib] - Training completed at iteration 17
[2025-11-19 09:36:48,431] [INFO] [<frozen importlib] - Best train loss: 0.6059
[2025-11-19 09:36:48,431] [INFO] [<frozen importlib] - Best val loss: 0.5070
[2025-11-19 09:36:48,431] [INFO] [<frozen importlib] - Best val AUC: 0.7017
[2025-11-19 09:36:48,431] [INFO] [<frozen importlib] - Best val AUCPR: 0.2084
[2025-11-19 09:36:48,435] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:36:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:36:55,900] [INFO] [<frozen importlib] - Optimal threshold: 0.5156
[2025-11-19 09:36:55,901] [INFO] [<frozen importlib] - Best f1: 0.2596
[2025-11-19 09:36:55,901] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:36:55,944] [INFO] [<frozen importlib] - Validation Results (threshold=0.5156):
[2025-11-19 09:36:55,945] [INFO] [<frozen importlib] -   Accuracy: 0.8913
[2025-11-19 09:36:55,945] [INFO] [<frozen importlib] -   Precision: 0.2723
[2025-11-19 09:36:55,945] [INFO] [<frozen importlib] -   Recall: 0.2479
[2025-11-19 09:36:55,945] [INFO] [<frozen importlib] -   F1 Score: 0.2596
[2025-11-19 09:36:55,945] [INFO] [<frozen importlib] -   AUROC: 0.7017
[2025-11-19 09:36:55,945] [INFO] [<frozen importlib] -   AUPRC: 0.2089
[2025-11-19 09:36:55,945] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:36:55,945] [INFO] [<frozen importlib] -     TN=16483, FP=962
[2025-11-19 09:36:55,945] [INFO] [<frozen importlib] -     FN=1092, TP=360
[2025-11-19 09:36:55,968] [INFO] [<frozen importlib] - Trial 436: AUPRC=0.2089, F1=0.4501, Prec=0.4215, Rec=0.4828 | Optimizing auprc=0.2089
[2025-11-19 09:36:55,968] [INFO] [<frozen importlib] - Trial 436 pruned.
[2025-11-19 09:36:55,968] [ERROR] [<frozen importlib] - Trial 436 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  87%|████████▋ | 436/500 [1:14:53<12:10, 11.42s/it]Best trial: 289. Best value: 0.241792:  87%|████████▋ | 436/500 [1:14:53<12:10, 11.42s/it]Best trial: 289. Best value: 0.241792:  87%|████████▋ | 437/500 [1:14:53<10:50, 10.33s/it][2025-11-19 09:36:55,982] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.226696187909854
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   gamma: 0.177412197794487
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   alpha: 0.613328570396185
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   lambda: 0.771423170276898
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   learning_rate: 0.036079954500919394
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   subsample: 0.8368191474105271
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   colsample_bytree: 0.620180158672647
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5322597872298667
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   colsample_bynode: 0.8125933757971495
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:36:55,982] [INFO] [<frozen importlib] -   scale_pos_weight: 6.226696187909854
[2025-11-19 09:36:56,052] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:36:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:36:55,968] Trial 436 pruned. 
[0]	train-logloss:0.65663	train-auc:0.65001	train-aucpr:0.23790	val-logloss:0.64574	val-auc:0.58531	val-aucpr:0.13085
[10]	train-logloss:0.63381	train-auc:0.67999	train-aucpr:0.29358	val-logloss:0.58942	val-auc:0.70264	val-aucpr:0.20676
[20]	train-logloss:0.61970	train-auc:0.68737	train-aucpr:0.29990	val-logloss:0.54858	val-auc:0.70241	val-aucpr:0.21360
[30]	train-logloss:0.61021	train-auc:0.69248	train-aucpr:0.30515	val-logloss:0.52056	val-auc:0.70455	val-aucpr:0.22175
[40]	train-logloss:0.60331	train-auc:0.69707	train-aucpr:0.31053	val-logloss:0.50280	val-auc:0.70273	val-aucpr:0.21855
[50]	train-logloss:0.59769	train-auc:0.70053	train-aucpr:0.31434	val-logloss:0.49677	val-auc:0.69474	val-aucpr:0.21320
[60]	train-logloss:0.59410	train-auc:0.70327	train-aucpr:0.31631	val-logloss:0.48810	val-auc:0.69774	val-aucpr:0.21710
[61]	train-logloss:0.59377	train-auc:0.70368	train-aucpr:0.31671	val-logloss:0.48587	val-auc:0.69678	val-aucpr:0.21598
[2025-11-19 09:36:56,243] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 09:36:56,243] [INFO] [<frozen importlib] - Best train loss: 0.6093
[2025-11-19 09:36:56,243] [INFO] [<frozen importlib] - Best val loss: 0.5180
[2025-11-19 09:36:56,243] [INFO] [<frozen importlib] - Best val AUC: 0.7043
[2025-11-19 09:36:56,243] [INFO] [<frozen importlib] - Best val AUCPR: 0.2226
[2025-11-19 09:36:56,247] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:36:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:37:01,187] [INFO] [<frozen importlib] - Optimal threshold: 0.4576
[2025-11-19 09:37:01,187] [INFO] [<frozen importlib] - Best f1: 0.2627
[2025-11-19 09:37:01,187] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:37:01,236] [INFO] [<frozen importlib] - Validation Results (threshold=0.4576):
[2025-11-19 09:37:01,236] [INFO] [<frozen importlib] -   Accuracy: 0.8809
[2025-11-19 09:37:01,236] [INFO] [<frozen importlib] -   Precision: 0.2505
[2025-11-19 09:37:01,236] [INFO] [<frozen importlib] -   Recall: 0.2762
[2025-11-19 09:37:01,236] [INFO] [<frozen importlib] -   F1 Score: 0.2627
[2025-11-19 09:37:01,236] [INFO] [<frozen importlib] -   AUROC: 0.7043
[2025-11-19 09:37:01,236] [INFO] [<frozen importlib] -   AUPRC: 0.2224
[2025-11-19 09:37:01,236] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:37:01,236] [INFO] [<frozen importlib] -     TN=16245, FP=1200
[2025-11-19 09:37:01,236] [INFO] [<frozen importlib] -     FN=1051, TP=401
[2025-11-19 09:37:01,259] [INFO] [<frozen importlib] - Trial 437: AUPRC=0.2224, F1=0.4247, Prec=0.3734, Rec=0.4924 | Optimizing auprc=0.2224
[2025-11-19 09:37:01,259] [INFO] [<frozen importlib] - Trial 437 pruned.
[2025-11-19 09:37:01,259] [ERROR] [<frozen importlib] - Trial 437 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  87%|████████▋ | 437/500 [1:14:59<10:50, 10.33s/it]Best trial: 289. Best value: 0.241792:  87%|████████▋ | 437/500 [1:14:59<10:50, 10.33s/it]Best trial: 289. Best value: 0.241792:  88%|████████▊ | 438/500 [1:14:59<09:06,  8.82s/it][2025-11-19 09:37:01,273] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.507140714119429
[2025-11-19 09:37:01,273] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:37:01,273] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:37:01,273] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:37:01,273] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:37:01,273] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:37:01,273] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:37:01,273] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:37:01,273] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   gamma: 0.20240100424210034
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   alpha: 0.37170663487906097
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   lambda: 1.2773387770789126
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   learning_rate: 0.034028655403497574
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   subsample: 0.8410493420181566
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   colsample_bytree: 0.5860652778961648
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5210660267544233
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   colsample_bynode: 0.8270189821882684
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:37:01,274] [INFO] [<frozen importlib] -   scale_pos_weight: 6.507140714119429
[2025-11-19 09:37:01,346] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:37:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:37:01,260] Trial 437 pruned. 
[0]	train-logloss:0.67272	train-auc:0.63101	train-aucpr:0.22792	val-logloss:0.66775	val-auc:0.60544	val-aucpr:0.12411
[10]	train-logloss:0.65038	train-auc:0.68152	train-aucpr:0.28710	val-logloss:0.61735	val-auc:0.69049	val-aucpr:0.18633
[20]	train-logloss:0.63618	train-auc:0.68727	train-aucpr:0.29927	val-logloss:0.58068	val-auc:0.68481	val-aucpr:0.20890
[30]	train-logloss:0.62641	train-auc:0.69193	train-aucpr:0.30312	val-logloss:0.55598	val-auc:0.70254	val-aucpr:0.21795
[40]	train-logloss:0.61943	train-auc:0.69620	train-aucpr:0.30728	val-logloss:0.53853	val-auc:0.70290	val-aucpr:0.22063
[50]	train-logloss:0.61365	train-auc:0.70029	train-aucpr:0.31198	val-logloss:0.53638	val-auc:0.70099	val-aucpr:0.22210
[60]	train-logloss:0.60957	train-auc:0.70341	train-aucpr:0.31494	val-logloss:0.52977	val-auc:0.70122	val-aucpr:0.22366
[70]	train-logloss:0.60580	train-auc:0.70769	train-aucpr:0.31903	val-logloss:0.53025	val-auc:0.70179	val-aucpr:0.21818
[80]	train-logloss:0.60256	train-auc:0.71078	train-aucpr:0.32291	val-logloss:0.51872	val-auc:0.69803	val-aucpr:0.21184
[90]	train-logloss:0.59986	train-auc:0.71336	train-aucpr:0.32657	val-logloss:0.52081	val-auc:0.69736	val-aucpr:0.21152
[95]	train-logloss:0.59875	train-auc:0.71514	train-aucpr:0.32796	val-logloss:0.51275	val-auc:0.69532	val-aucpr:0.21096
[2025-11-19 09:37:01,618] [INFO] [<frozen importlib] - Training completed at iteration 65
[2025-11-19 09:37:01,618] [INFO] [<frozen importlib] - Best train loss: 0.6076
[2025-11-19 09:37:01,618] [INFO] [<frozen importlib] - Best val loss: 0.5278
[2025-11-19 09:37:01,618] [INFO] [<frozen importlib] - Best val AUC: 0.7024
[2025-11-19 09:37:01,618] [INFO] [<frozen importlib] - Best val AUCPR: 0.2249
[2025-11-19 09:37:01,623] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:37:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:37:14,546] [INFO] [<frozen importlib] - Optimal threshold: 0.4872
[2025-11-19 09:37:14,546] [INFO] [<frozen importlib] - Best f1: 0.2733
[2025-11-19 09:37:14,546] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:37:14,587] [INFO] [<frozen importlib] - Validation Results (threshold=0.4872):
[2025-11-19 09:37:14,587] [INFO] [<frozen importlib] -   Accuracy: 0.8894
[2025-11-19 09:37:14,587] [INFO] [<frozen importlib] -   Precision: 0.2760
[2025-11-19 09:37:14,587] [INFO] [<frozen importlib] -   Recall: 0.2707
[2025-11-19 09:37:14,587] [INFO] [<frozen importlib] -   F1 Score: 0.2733
[2025-11-19 09:37:14,587] [INFO] [<frozen importlib] -   AUROC: 0.7024
[2025-11-19 09:37:14,587] [INFO] [<frozen importlib] -   AUPRC: 0.2253
[2025-11-19 09:37:14,587] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:37:14,587] [INFO] [<frozen importlib] -     TN=16414, FP=1031
[2025-11-19 09:37:14,587] [INFO] [<frozen importlib] -     FN=1059, TP=393
[2025-11-19 09:37:14,610] [INFO] [<frozen importlib] - Trial 438: AUPRC=0.2253, F1=0.4476, Prec=0.4098, Rec=0.4931 | Optimizing auprc=0.2253
                                                                                          Best trial: 289. Best value: 0.241792:  88%|████████▊ | 438/500 [1:15:12<09:06,  8.82s/it]Best trial: 289. Best value: 0.241792:  88%|████████▊ | 438/500 [1:15:12<09:06,  8.82s/it]Best trial: 289. Best value: 0.241792:  88%|████████▊ | 439/500 [1:15:12<10:20, 10.18s/it][2025-11-19 09:37:14,624] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.040240162580187
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   gamma: 0.1520304504060372
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   alpha: 0.5454209318435949
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   lambda: 1.1299345061439703
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   learning_rate: 0.03306045832004093
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   subsample: 0.8298553528566174
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   colsample_bytree: 0.6093861445942496
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5404052541287062
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   colsample_bynode: 0.7931930543131027
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:37:14,624] [INFO] [<frozen importlib] -   scale_pos_weight: 7.040240162580187
[2025-11-19 09:37:14,700] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:37:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:37:14,610] Trial 438 finished with value: 0.22528313828774316 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.20240100424210034, 'learning_rate': 0.034028655403497574, 'n_estimators': 350, 'alpha': 0.37170663487906097, 'lambda': 1.2773387770789126, 'subsample': 0.8410493420181566, 'colsample_bytree': 0.5860652778961648, 'colsample_bylevel': 0.5210660267544233, 'colsample_bynode': 0.8270189821882684, 'scale_pos_weight': 6.507140714119429}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.70130	train-auc:0.65414	train-aucpr:0.23778	val-logloss:0.69831	val-auc:0.64919	val-aucpr:0.14335
[10]	train-logloss:0.67839	train-auc:0.68250	train-aucpr:0.29249	val-logloss:0.64570	val-auc:0.69742	val-aucpr:0.19310
[20]	train-logloss:0.66344	train-auc:0.68802	train-aucpr:0.29844	val-logloss:0.61101	val-auc:0.69669	val-aucpr:0.20032
[30]	train-logloss:0.65347	train-auc:0.69131	train-aucpr:0.30228	val-logloss:0.58832	val-auc:0.69846	val-aucpr:0.20719
[40]	train-logloss:0.64600	train-auc:0.69624	train-aucpr:0.30642	val-logloss:0.56727	val-auc:0.69736	val-aucpr:0.20814
[50]	train-logloss:0.63971	train-auc:0.70022	train-aucpr:0.31137	val-logloss:0.55218	val-auc:0.69225	val-aucpr:0.20674
[60]	train-logloss:0.63584	train-auc:0.70244	train-aucpr:0.31335	val-logloss:0.54250	val-auc:0.69648	val-aucpr:0.21203
[70]	train-logloss:0.63202	train-auc:0.70634	train-aucpr:0.31639	val-logloss:0.53099	val-auc:0.69093	val-aucpr:0.20955
[80]	train-logloss:0.62828	train-auc:0.71098	train-aucpr:0.32139	val-logloss:0.51152	val-auc:0.69029	val-aucpr:0.21150
[90]	train-logloss:0.62550	train-auc:0.71417	train-aucpr:0.32417	val-logloss:0.50533	val-auc:0.68522	val-aucpr:0.21154
[100]	train-logloss:0.62350	train-auc:0.71596	train-aucpr:0.32683	val-logloss:0.50002	val-auc:0.68665	val-aucpr:0.21388
[110]	train-logloss:0.62095	train-auc:0.71879	train-aucpr:0.33057	val-logloss:0.49104	val-auc:0.67997	val-aucpr:0.19987
[120]	train-logloss:0.61854	train-auc:0.72230	train-aucpr:0.33378	val-logloss:0.47571	val-auc:0.67496	val-aucpr:0.18812
[128]	train-logloss:0.61734	train-auc:0.72488	train-aucpr:0.33588	val-logloss:0.46432	val-auc:0.67737	val-aucpr:0.18970
[2025-11-19 09:37:15,048] [INFO] [<frozen importlib] - Training completed at iteration 99
[2025-11-19 09:37:15,048] [INFO] [<frozen importlib] - Best train loss: 0.6237
[2025-11-19 09:37:15,048] [INFO] [<frozen importlib] - Best val loss: 0.5015
[2025-11-19 09:37:15,048] [INFO] [<frozen importlib] - Best val AUC: 0.6867
[2025-11-19 09:37:15,048] [INFO] [<frozen importlib] - Best val AUCPR: 0.2146
[2025-11-19 09:37:15,053] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:37:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:37:29,196] [INFO] [<frozen importlib] - Optimal threshold: 0.5066
[2025-11-19 09:37:29,196] [INFO] [<frozen importlib] - Best f1: 0.2517
[2025-11-19 09:37:29,196] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:37:29,238] [INFO] [<frozen importlib] - Validation Results (threshold=0.5066):
[2025-11-19 09:37:29,238] [INFO] [<frozen importlib] -   Accuracy: 0.9065
[2025-11-19 09:37:29,238] [INFO] [<frozen importlib] -   Precision: 0.3271
[2025-11-19 09:37:29,238] [INFO] [<frozen importlib] -   Recall: 0.2045
[2025-11-19 09:37:29,238] [INFO] [<frozen importlib] -   F1 Score: 0.2517
[2025-11-19 09:37:29,238] [INFO] [<frozen importlib] -   AUROC: 0.6867
[2025-11-19 09:37:29,238] [INFO] [<frozen importlib] -   AUPRC: 0.2152
[2025-11-19 09:37:29,238] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:37:29,238] [INFO] [<frozen importlib] -     TN=16834, FP=611
[2025-11-19 09:37:29,238] [INFO] [<frozen importlib] -     FN=1155, TP=297
[2025-11-19 09:37:29,260] [INFO] [<frozen importlib] - Trial 439: AUPRC=0.2152, F1=0.4662, Prec=0.5065, Rec=0.4318 | Optimizing auprc=0.2152
                                                                                          Best trial: 289. Best value: 0.241792:  88%|████████▊ | 439/500 [1:15:27<10:20, 10.18s/it]Best trial: 289. Best value: 0.241792:  88%|████████▊ | 439/500 [1:15:27<10:20, 10.18s/it]Best trial: 289. Best value: 0.241792:  88%|████████▊ | 440/500 [1:15:27<11:31, 11.52s/it][2025-11-19 09:37:29,274] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.157722433064288
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   gamma: 0.17614672885335594
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   alpha: 1.2846634149015763
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   lambda: 0.9187612567667939
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   learning_rate: 0.03687073726771604
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   subsample: 0.8526866556245872
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   colsample_bytree: 0.574755655204838
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   colsample_bylevel: 0.518588558422845
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   colsample_bynode: 0.7927952820149418
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:37:29,274] [INFO] [<frozen importlib] -   scale_pos_weight: 6.157722433064288
[2025-11-19 09:37:29,352] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:37:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:37:29,261] Trial 439 finished with value: 0.21519149831465934 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.1520304504060372, 'learning_rate': 0.03306045832004093, 'n_estimators': 350, 'alpha': 0.5454209318435949, 'lambda': 1.1299345061439703, 'subsample': 0.8298553528566174, 'colsample_bytree': 0.6093861445942496, 'colsample_bylevel': 0.5404052541287062, 'colsample_bynode': 0.7931930543131027, 'scale_pos_weight': 7.040240162580187}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.65286	train-auc:0.64008	train-aucpr:0.22970	val-logloss:0.64367	val-auc:0.63613	val-aucpr:0.13567
[10]	train-logloss:0.63041	train-auc:0.68262	train-aucpr:0.29034	val-logloss:0.58363	val-auc:0.70712	val-aucpr:0.21550
[20]	train-logloss:0.61671	train-auc:0.68820	train-aucpr:0.29705	val-logloss:0.55143	val-auc:0.69904	val-aucpr:0.21001
[30]	train-logloss:0.60690	train-auc:0.69179	train-aucpr:0.30336	val-logloss:0.52180	val-auc:0.69625	val-aucpr:0.21774
[40]	train-logloss:0.60030	train-auc:0.69535	train-aucpr:0.30663	val-logloss:0.51822	val-auc:0.69964	val-aucpr:0.21593
[50]	train-logloss:0.59492	train-auc:0.69952	train-aucpr:0.31134	val-logloss:0.51424	val-auc:0.70028	val-aucpr:0.21818
[60]	train-logloss:0.59058	train-auc:0.70452	train-aucpr:0.31651	val-logloss:0.50198	val-auc:0.69919	val-aucpr:0.21537
[70]	train-logloss:0.58696	train-auc:0.70792	train-aucpr:0.32084	val-logloss:0.49626	val-auc:0.69428	val-aucpr:0.21165
[75]	train-logloss:0.58580	train-auc:0.70964	train-aucpr:0.32228	val-logloss:0.49169	val-auc:0.69340	val-aucpr:0.21154
[2025-11-19 09:37:29,576] [INFO] [<frozen importlib] - Training completed at iteration 46
[2025-11-19 09:37:29,576] [INFO] [<frozen importlib] - Best train loss: 0.5970
[2025-11-19 09:37:29,576] [INFO] [<frozen importlib] - Best val loss: 0.5093
[2025-11-19 09:37:29,576] [INFO] [<frozen importlib] - Best val AUC: 0.7030
[2025-11-19 09:37:29,576] [INFO] [<frozen importlib] - Best val AUCPR: 0.2210
[2025-11-19 09:37:29,580] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:37:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:37:40,025] [INFO] [<frozen importlib] - Optimal threshold: 0.4675
[2025-11-19 09:37:40,025] [INFO] [<frozen importlib] - Best f1: 0.2637
[2025-11-19 09:37:40,025] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:37:40,073] [INFO] [<frozen importlib] - Validation Results (threshold=0.4675):
[2025-11-19 09:37:40,073] [INFO] [<frozen importlib] -   Accuracy: 0.8815
[2025-11-19 09:37:40,073] [INFO] [<frozen importlib] -   Precision: 0.2524
[2025-11-19 09:37:40,073] [INFO] [<frozen importlib] -   Recall: 0.2762
[2025-11-19 09:37:40,073] [INFO] [<frozen importlib] -   F1 Score: 0.2637
[2025-11-19 09:37:40,073] [INFO] [<frozen importlib] -   AUROC: 0.7030
[2025-11-19 09:37:40,073] [INFO] [<frozen importlib] -   AUPRC: 0.2214
[2025-11-19 09:37:40,073] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:37:40,073] [INFO] [<frozen importlib] -     TN=16257, FP=1188
[2025-11-19 09:37:40,073] [INFO] [<frozen importlib] -     FN=1051, TP=401
[2025-11-19 09:37:40,095] [INFO] [<frozen importlib] - Trial 440: AUPRC=0.2214, F1=0.4267, Prec=0.3761, Rec=0.4931 | Optimizing auprc=0.2214
[2025-11-19 09:37:40,096] [INFO] [<frozen importlib] - Trial 440 pruned.
[2025-11-19 09:37:40,096] [ERROR] [<frozen importlib] - Trial 440 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  88%|████████▊ | 440/500 [1:15:38<11:31, 11.52s/it]Best trial: 289. Best value: 0.241792:  88%|████████▊ | 440/500 [1:15:38<11:31, 11.52s/it]Best trial: 289. Best value: 0.241792:  88%|████████▊ | 441/500 [1:15:38<11:07, 11.31s/it][2025-11-19 09:37:40,110] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.877779524189033
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   gamma: 0.2073840492500278
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   alpha: 0.48917128517839387
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   lambda: 0.6938488775985776
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   learning_rate: 0.03530991667670589
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   subsample: 0.8215480435240077
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   colsample_bytree: 0.557497285870261
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5286982104203589
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   colsample_bynode: 0.8066888669291115
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:37:40,110] [INFO] [<frozen importlib] -   scale_pos_weight: 6.877779524189033
[2025-11-19 09:37:40,186] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:37:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:37:40,096] Trial 440 pruned. 
[0]	train-logloss:0.69256	train-auc:0.63943	train-aucpr:0.23283	val-logloss:0.68905	val-auc:0.62442	val-aucpr:0.12492
[10]	train-logloss:0.66864	train-auc:0.67747	train-aucpr:0.29039	val-logloss:0.62879	val-auc:0.69142	val-aucpr:0.20024
[20]	train-logloss:0.65396	train-auc:0.68547	train-aucpr:0.29794	val-logloss:0.60211	val-auc:0.69867	val-aucpr:0.20322
[30]	train-logloss:0.64384	train-auc:0.69144	train-aucpr:0.30346	val-logloss:0.57135	val-auc:0.69764	val-aucpr:0.21368
[40]	train-logloss:0.63659	train-auc:0.69552	train-aucpr:0.30777	val-logloss:0.55705	val-auc:0.69981	val-aucpr:0.21698
[50]	train-logloss:0.63047	train-auc:0.69969	train-aucpr:0.31261	val-logloss:0.54692	val-auc:0.70382	val-aucpr:0.21724
[60]	train-logloss:0.62642	train-auc:0.70349	train-aucpr:0.31545	val-logloss:0.54417	val-auc:0.70526	val-aucpr:0.22004
[70]	train-logloss:0.62273	train-auc:0.70835	train-aucpr:0.31919	val-logloss:0.54323	val-auc:0.69772	val-aucpr:0.20881
[80]	train-logloss:0.61950	train-auc:0.71155	train-aucpr:0.32285	val-logloss:0.53507	val-auc:0.69511	val-aucpr:0.20711
[85]	train-logloss:0.61813	train-auc:0.71220	train-aucpr:0.32419	val-logloss:0.53132	val-auc:0.69498	val-aucpr:0.20787
[2025-11-19 09:37:40,437] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:37:40,437] [INFO] [<frozen importlib] - Best train loss: 0.6279
[2025-11-19 09:37:40,437] [INFO] [<frozen importlib] - Best val loss: 0.5428
[2025-11-19 09:37:40,437] [INFO] [<frozen importlib] - Best val AUC: 0.7057
[2025-11-19 09:37:40,437] [INFO] [<frozen importlib] - Best val AUCPR: 0.2202
[2025-11-19 09:37:40,442] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:37:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:37:52,854] [INFO] [<frozen importlib] - Optimal threshold: 0.5020
[2025-11-19 09:37:52,854] [INFO] [<frozen importlib] - Best f1: 0.2591
[2025-11-19 09:37:52,854] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:37:52,883] [INFO] [<frozen importlib] - Validation Results (threshold=0.5020):
[2025-11-19 09:37:52,883] [INFO] [<frozen importlib] -   Accuracy: 0.8810
[2025-11-19 09:37:52,883] [INFO] [<frozen importlib] -   Precision: 0.2484
[2025-11-19 09:37:52,883] [INFO] [<frozen importlib] -   Recall: 0.2707
[2025-11-19 09:37:52,883] [INFO] [<frozen importlib] -   F1 Score: 0.2591
[2025-11-19 09:37:52,883] [INFO] [<frozen importlib] -   AUROC: 0.7057
[2025-11-19 09:37:52,884] [INFO] [<frozen importlib] -   AUPRC: 0.2206
[2025-11-19 09:37:52,884] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:37:52,884] [INFO] [<frozen importlib] -     TN=16256, FP=1189
[2025-11-19 09:37:52,884] [INFO] [<frozen importlib] -     FN=1059, TP=393
[2025-11-19 09:37:52,909] [INFO] [<frozen importlib] - Trial 441: AUPRC=0.2206, F1=0.4284, Prec=0.3772, Rec=0.4959 | Optimizing auprc=0.2206
[2025-11-19 09:37:52,910] [INFO] [<frozen importlib] - Trial 441 pruned.
[2025-11-19 09:37:52,910] [ERROR] [<frozen importlib] - Trial 441 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  88%|████████▊ | 441/500 [1:15:50<11:07, 11.31s/it]Best trial: 289. Best value: 0.241792:  88%|████████▊ | 441/500 [1:15:50<11:07, 11.31s/it]Best trial: 289. Best value: 0.241792:  88%|████████▊ | 442/500 [1:15:50<11:22, 11.76s/it][2025-11-19 09:37:52,926] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.490648890666907
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   gamma: 0.1871250897820343
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   alpha: 0.43020415459168454
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   lambda: 1.4240378249857282
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   learning_rate: 0.037197197438502194
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   subsample: 0.842016983553603
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   colsample_bytree: 0.5936823811897292
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5195661412996461
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   colsample_bynode: 0.8641595003986601
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:37:52,926] [INFO] [<frozen importlib] -   scale_pos_weight: 6.490648890666907
[2025-11-19 09:37:52,998] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:37:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:37:52,910] Trial 441 pruned. 
[0]	train-logloss:0.67151	train-auc:0.63854	train-aucpr:0.22152	val-logloss:0.66486	val-auc:0.61547	val-aucpr:0.12850
[10]	train-logloss:0.64795	train-auc:0.68281	train-aucpr:0.29146	val-logloss:0.61224	val-auc:0.68942	val-aucpr:0.19370
[20]	train-logloss:0.63342	train-auc:0.68848	train-aucpr:0.29876	val-logloss:0.57040	val-auc:0.69381	val-aucpr:0.21212
[30]	train-logloss:0.62324	train-auc:0.69211	train-aucpr:0.30487	val-logloss:0.53755	val-auc:0.69929	val-aucpr:0.22270
[40]	train-logloss:0.61610	train-auc:0.69678	train-aucpr:0.30969	val-logloss:0.52076	val-auc:0.70916	val-aucpr:0.22496
[50]	train-logloss:0.61033	train-auc:0.70107	train-aucpr:0.31423	val-logloss:0.51314	val-auc:0.70509	val-aucpr:0.22892
[60]	train-logloss:0.60622	train-auc:0.70421	train-aucpr:0.31802	val-logloss:0.50499	val-auc:0.70117	val-aucpr:0.23003
[70]	train-logloss:0.60271	train-auc:0.70856	train-aucpr:0.32174	val-logloss:0.48223	val-auc:0.70296	val-aucpr:0.23209
[80]	train-logloss:0.59966	train-auc:0.71321	train-aucpr:0.32602	val-logloss:0.47406	val-auc:0.70082	val-aucpr:0.22913
[90]	train-logloss:0.59693	train-auc:0.71691	train-aucpr:0.32979	val-logloss:0.46472	val-auc:0.69688	val-aucpr:0.22309
[100]	train-logloss:0.59447	train-auc:0.72042	train-aucpr:0.33360	val-logloss:0.46427	val-auc:0.69065	val-aucpr:0.21048
[2025-11-19 09:37:53,281] [INFO] [<frozen importlib] - Training completed at iteration 70
[2025-11-19 09:37:53,281] [INFO] [<frozen importlib] - Best train loss: 0.6027
[2025-11-19 09:37:53,281] [INFO] [<frozen importlib] - Best val loss: 0.4822
[2025-11-19 09:37:53,281] [INFO] [<frozen importlib] - Best val AUC: 0.7030
[2025-11-19 09:37:53,281] [INFO] [<frozen importlib] - Best val AUCPR: 0.2321
[2025-11-19 09:37:53,287] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:37:53] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:38:07,071] [INFO] [<frozen importlib] - Optimal threshold: 0.4646
[2025-11-19 09:38:07,071] [INFO] [<frozen importlib] - Best f1: 0.2780
[2025-11-19 09:38:07,071] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:38:07,118] [INFO] [<frozen importlib] - Validation Results (threshold=0.4646):
[2025-11-19 09:38:07,118] [INFO] [<frozen importlib] -   Accuracy: 0.8975
[2025-11-19 09:38:07,118] [INFO] [<frozen importlib] -   Precision: 0.3030
[2025-11-19 09:38:07,118] [INFO] [<frozen importlib] -   Recall: 0.2569
[2025-11-19 09:38:07,118] [INFO] [<frozen importlib] -   F1 Score: 0.2780
[2025-11-19 09:38:07,118] [INFO] [<frozen importlib] -   AUROC: 0.7030
[2025-11-19 09:38:07,118] [INFO] [<frozen importlib] -   AUPRC: 0.2325
[2025-11-19 09:38:07,118] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:38:07,118] [INFO] [<frozen importlib] -     TN=16587, FP=858
[2025-11-19 09:38:07,118] [INFO] [<frozen importlib] -     FN=1079, TP=373
[2025-11-19 09:38:07,142] [INFO] [<frozen importlib] - Trial 442: AUPRC=0.2325, F1=0.4528, Prec=0.4407, Rec=0.4656 | Optimizing auprc=0.2325
                                                                                          Best trial: 289. Best value: 0.241792:  88%|████████▊ | 442/500 [1:16:05<11:22, 11.76s/it]Best trial: 289. Best value: 0.241792:  88%|████████▊ | 442/500 [1:16:05<11:22, 11.76s/it]Best trial: 289. Best value: 0.241792:  89%|████████▊ | 443/500 [1:16:05<11:52, 12.50s/it][2025-11-19 09:38:07,168] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.0343275545319015
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   gamma: 0.14715084910212295
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   alpha: 0.5837822247053751
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   lambda: 1.060784071860419
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   learning_rate: 0.12718868191340962
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   subsample: 0.8231269836841186
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   colsample_bytree: 0.6019884434091916
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5474845098045414
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   colsample_bynode: 0.8276558568574472
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:38:07,168] [INFO] [<frozen importlib] -   scale_pos_weight: 5.0343275545319015
[2025-11-19 09:38:07,252] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:38:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:38:07,143] Trial 442 finished with value: 0.23253396492705108 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.1871250897820343, 'learning_rate': 0.037197197438502194, 'n_estimators': 300, 'alpha': 0.43020415459168454, 'lambda': 1.4240378249857282, 'subsample': 0.842016983553603, 'colsample_bytree': 0.5936823811897292, 'colsample_bylevel': 0.5195661412996461, 'colsample_bynode': 0.8641595003986601, 'scale_pos_weight': 6.490648890666907}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.58314	train-auc:0.65015	train-aucpr:0.23877	val-logloss:0.58306	val-auc:0.48994	val-aucpr:0.07082
[10]	train-logloss:0.54346	train-auc:0.69150	train-aucpr:0.30183	val-logloss:0.46645	val-auc:0.68584	val-aucpr:0.21664
[20]	train-logloss:0.53013	train-auc:0.70890	train-aucpr:0.31994	val-logloss:0.42691	val-auc:0.70186	val-aucpr:0.21027
[30]	train-logloss:0.52284	train-auc:0.71888	train-aucpr:0.33146	val-logloss:0.41700	val-auc:0.69839	val-aucpr:0.19837
[35]	train-logloss:0.52029	train-auc:0.72497	train-aucpr:0.33691	val-logloss:0.41218	val-auc:0.69263	val-aucpr:0.19533
[2025-11-19 09:38:07,382] [INFO] [<frozen importlib] - Training completed at iteration 6
[2025-11-19 09:38:07,382] [INFO] [<frozen importlib] - Best train loss: 0.5532
[2025-11-19 09:38:07,382] [INFO] [<frozen importlib] - Best val loss: 0.4922
[2025-11-19 09:38:07,382] [INFO] [<frozen importlib] - Best val AUC: 0.6965
[2025-11-19 09:38:07,382] [INFO] [<frozen importlib] - Best val AUCPR: 0.2252
[2025-11-19 09:38:07,388] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:38:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:38:08,145] [INFO] [<frozen importlib] - Optimal threshold: 0.4240
[2025-11-19 09:38:08,145] [INFO] [<frozen importlib] - Best f1: 0.2739
[2025-11-19 09:38:08,145] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:38:08,189] [INFO] [<frozen importlib] - Validation Results (threshold=0.4240):
[2025-11-19 09:38:08,189] [INFO] [<frozen importlib] -   Accuracy: 0.8906
[2025-11-19 09:38:08,190] [INFO] [<frozen importlib] -   Precision: 0.2794
[2025-11-19 09:38:08,190] [INFO] [<frozen importlib] -   Recall: 0.2686
[2025-11-19 09:38:08,190] [INFO] [<frozen importlib] -   F1 Score: 0.2739
[2025-11-19 09:38:08,190] [INFO] [<frozen importlib] -   AUROC: 0.6965
[2025-11-19 09:38:08,190] [INFO] [<frozen importlib] -   AUPRC: 0.2223
[2025-11-19 09:38:08,190] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:38:08,190] [INFO] [<frozen importlib] -     TN=16439, FP=1006
[2025-11-19 09:38:08,190] [INFO] [<frozen importlib] -     FN=1062, TP=390
[2025-11-19 09:38:08,215] [INFO] [<frozen importlib] - Trial 443: AUPRC=0.2223, F1=0.4364, Prec=0.4054, Rec=0.4725 | Optimizing auprc=0.2223
                                                                                          Best trial: 289. Best value: 0.241792:  89%|████████▊ | 443/500 [1:16:06<11:52, 12.50s/it]Best trial: 289. Best value: 0.241792:  89%|████████▊ | 443/500 [1:16:06<11:52, 12.50s/it]Best trial: 289. Best value: 0.241792:  89%|████████▉ | 444/500 [1:16:06<08:28,  9.08s/it][2025-11-19 09:38:08,240] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.07869397996383
[2025-11-19 09:38:08,240] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:38:08,240] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:38:08,240] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:38:08,240] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:38:08,240] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:38:08,240] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:38:08,240] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:38:08,240] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:38:08,240] [INFO] [<frozen importlib] -   gamma: 0.21035129008168066
[2025-11-19 09:38:08,240] [INFO] [<frozen importlib] -   alpha: 0.5292939015748888
[2025-11-19 09:38:08,240] [INFO] [<frozen importlib] -   lambda: 1.229009346662871
[2025-11-19 09:38:08,241] [INFO] [<frozen importlib] -   learning_rate: 0.034334902971099326
[2025-11-19 09:38:08,241] [INFO] [<frozen importlib] -   subsample: 0.8642756265498654
[2025-11-19 09:38:08,241] [INFO] [<frozen importlib] -   colsample_bytree: 0.5867708814028022
[2025-11-19 09:38:08,241] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5345839423869615
[2025-11-19 09:38:08,241] [INFO] [<frozen importlib] -   colsample_bynode: 0.7910196406960521
[2025-11-19 09:38:08,241] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:38:08,241] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:38:08,241] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:38:08,241] [INFO] [<frozen importlib] -   scale_pos_weight: 6.07869397996383
[2025-11-19 09:38:08,316] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:38:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:38:08,216] Trial 443 finished with value: 0.22228458073433868 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.14715084910212295, 'learning_rate': 0.12718868191340962, 'n_estimators': 400, 'alpha': 0.5837822247053751, 'lambda': 1.060784071860419, 'subsample': 0.8231269836841186, 'colsample_bytree': 0.6019884434091916, 'colsample_bylevel': 0.5474845098045414, 'colsample_bynode': 0.8276558568574472, 'scale_pos_weight': 5.0343275545319015}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.64867	train-auc:0.63842	train-aucpr:0.23165	val-logloss:0.63961	val-auc:0.62551	val-aucpr:0.13359
[10]	train-logloss:0.62770	train-auc:0.67981	train-aucpr:0.29072	val-logloss:0.59568	val-auc:0.65848	val-aucpr:0.17251
[20]	train-logloss:0.61397	train-auc:0.68632	train-aucpr:0.29907	val-logloss:0.55938	val-auc:0.68212	val-aucpr:0.21262
[30]	train-logloss:0.60439	train-auc:0.69116	train-aucpr:0.30331	val-logloss:0.53826	val-auc:0.69148	val-aucpr:0.22521
[40]	train-logloss:0.59771	train-auc:0.69520	train-aucpr:0.30705	val-logloss:0.53124	val-auc:0.70323	val-aucpr:0.22769
[50]	train-logloss:0.59239	train-auc:0.69949	train-aucpr:0.31121	val-logloss:0.51722	val-auc:0.71064	val-aucpr:0.23155
[60]	train-logloss:0.58853	train-auc:0.70190	train-aucpr:0.31506	val-logloss:0.50522	val-auc:0.70917	val-aucpr:0.22969
[70]	train-logloss:0.58495	train-auc:0.70724	train-aucpr:0.31908	val-logloss:0.50406	val-auc:0.70683	val-aucpr:0.22092
[78]	train-logloss:0.58269	train-auc:0.70909	train-aucpr:0.32196	val-logloss:0.50613	val-auc:0.70726	val-aucpr:0.22000
[2025-11-19 09:38:08,541] [INFO] [<frozen importlib] - Training completed at iteration 48
[2025-11-19 09:38:08,541] [INFO] [<frozen importlib] - Best train loss: 0.5932
[2025-11-19 09:38:08,541] [INFO] [<frozen importlib] - Best val loss: 0.5201
[2025-11-19 09:38:08,541] [INFO] [<frozen importlib] - Best val AUC: 0.7115
[2025-11-19 09:38:08,541] [INFO] [<frozen importlib] - Best val AUCPR: 0.2318
[2025-11-19 09:38:08,546] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:38:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:38:16,579] [INFO] [<frozen importlib] - Optimal threshold: 0.4660
[2025-11-19 09:38:16,579] [INFO] [<frozen importlib] - Best f1: 0.2776
[2025-11-19 09:38:16,579] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:38:16,622] [INFO] [<frozen importlib] - Validation Results (threshold=0.4660):
[2025-11-19 09:38:16,622] [INFO] [<frozen importlib] -   Accuracy: 0.8923
[2025-11-19 09:38:16,622] [INFO] [<frozen importlib] -   Precision: 0.2864
[2025-11-19 09:38:16,622] [INFO] [<frozen importlib] -   Recall: 0.2693
[2025-11-19 09:38:16,622] [INFO] [<frozen importlib] -   F1 Score: 0.2776
[2025-11-19 09:38:16,622] [INFO] [<frozen importlib] -   AUROC: 0.7115
[2025-11-19 09:38:16,623] [INFO] [<frozen importlib] -   AUPRC: 0.2321
[2025-11-19 09:38:16,623] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:38:16,623] [INFO] [<frozen importlib] -     TN=16471, FP=974
[2025-11-19 09:38:16,623] [INFO] [<frozen importlib] -     FN=1061, TP=391
[2025-11-19 09:38:16,648] [INFO] [<frozen importlib] - Trial 444: AUPRC=0.2321, F1=0.4444, Prec=0.4157, Rec=0.4773 | Optimizing auprc=0.2321
                                                                                          Best trial: 289. Best value: 0.241792:  89%|████████▉ | 444/500 [1:16:14<08:28,  9.08s/it]Best trial: 289. Best value: 0.241792:  89%|████████▉ | 444/500 [1:16:14<08:28,  9.08s/it]Best trial: 289. Best value: 0.241792:  89%|████████▉ | 445/500 [1:16:14<08:08,  8.88s/it][2025-11-19 09:38:16,662] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.586382074020776
[2025-11-19 09:38:16,662] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:38:16,662] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:38:16,662] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   gamma: 0.18598236904476964
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   alpha: 0.6288605244072277
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   lambda: 0.8115121522487532
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   learning_rate: 0.039343872297633024
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   subsample: 0.8124076363786003
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   colsample_bytree: 0.5667461996561126
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5157256396340228
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   colsample_bynode: 0.8022813928916873
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:38:16,663] [INFO] [<frozen importlib] -   scale_pos_weight: 5.586382074020776
[2025-11-19 09:38:16,734] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:38:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:38:16,649] Trial 444 finished with value: 0.23208793356683446 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.21035129008168066, 'learning_rate': 0.034334902971099326, 'n_estimators': 350, 'alpha': 0.5292939015748888, 'lambda': 1.229009346662871, 'subsample': 0.8642756265498654, 'colsample_bytree': 0.5867708814028022, 'colsample_bylevel': 0.5345839423869615, 'colsample_bynode': 0.7910196406960521, 'scale_pos_weight': 6.07869397996383}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.62051	train-auc:0.63974	train-aucpr:0.23102	val-logloss:0.60644	val-auc:0.63620	val-aucpr:0.13568
[10]	train-logloss:0.59845	train-auc:0.68010	train-aucpr:0.29008	val-logloss:0.55011	val-auc:0.70061	val-aucpr:0.20750
[20]	train-logloss:0.58524	train-auc:0.68741	train-aucpr:0.29794	val-logloss:0.51401	val-auc:0.69896	val-aucpr:0.20970
[30]	train-logloss:0.57583	train-auc:0.69455	train-aucpr:0.30539	val-logloss:0.49972	val-auc:0.69461	val-aucpr:0.21455
[40]	train-logloss:0.56973	train-auc:0.69770	train-aucpr:0.30868	val-logloss:0.49703	val-auc:0.70190	val-aucpr:0.21660
[50]	train-logloss:0.56434	train-auc:0.70262	train-aucpr:0.31384	val-logloss:0.49066	val-auc:0.70063	val-aucpr:0.21948
[60]	train-logloss:0.56014	train-auc:0.70823	train-aucpr:0.31881	val-logloss:0.47318	val-auc:0.69995	val-aucpr:0.21725
[70]	train-logloss:0.55720	train-auc:0.71130	train-aucpr:0.32233	val-logloss:0.46497	val-auc:0.69997	val-aucpr:0.21702
[76]	train-logloss:0.55582	train-auc:0.71288	train-aucpr:0.32475	val-logloss:0.45997	val-auc:0.69945	val-aucpr:0.21527
[2025-11-19 09:38:16,963] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 09:38:16,963] [INFO] [<frozen importlib] - Best train loss: 0.5658
[2025-11-19 09:38:16,963] [INFO] [<frozen importlib] - Best val loss: 0.4892
[2025-11-19 09:38:16,963] [INFO] [<frozen importlib] - Best val AUC: 0.7012
[2025-11-19 09:38:16,963] [INFO] [<frozen importlib] - Best val AUCPR: 0.2207
[2025-11-19 09:38:16,967] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:38:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:38:27,714] [INFO] [<frozen importlib] - Optimal threshold: 0.4585
[2025-11-19 09:38:27,714] [INFO] [<frozen importlib] - Best f1: 0.2722
[2025-11-19 09:38:27,714] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:38:27,758] [INFO] [<frozen importlib] - Validation Results (threshold=0.4585):
[2025-11-19 09:38:27,758] [INFO] [<frozen importlib] -   Accuracy: 0.8905
[2025-11-19 09:38:27,758] [INFO] [<frozen importlib] -   Precision: 0.2782
[2025-11-19 09:38:27,758] [INFO] [<frozen importlib] -   Recall: 0.2665
[2025-11-19 09:38:27,758] [INFO] [<frozen importlib] -   F1 Score: 0.2722
[2025-11-19 09:38:27,758] [INFO] [<frozen importlib] -   AUROC: 0.7012
[2025-11-19 09:38:27,758] [INFO] [<frozen importlib] -   AUPRC: 0.2211
[2025-11-19 09:38:27,758] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:38:27,758] [INFO] [<frozen importlib] -     TN=16441, FP=1004
[2025-11-19 09:38:27,758] [INFO] [<frozen importlib] -     FN=1065, TP=387
[2025-11-19 09:38:27,781] [INFO] [<frozen importlib] - Trial 445: AUPRC=0.2211, F1=0.4534, Prec=0.4176, Rec=0.4959 | Optimizing auprc=0.2211
[2025-11-19 09:38:27,781] [INFO] [<frozen importlib] - Trial 445 pruned.
[2025-11-19 09:38:27,781] [ERROR] [<frozen importlib] - Trial 445 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  89%|████████▉ | 445/500 [1:16:25<08:08,  8.88s/it]Best trial: 289. Best value: 0.241792:  89%|████████▉ | 445/500 [1:16:25<08:08,  8.88s/it]Best trial: 289. Best value: 0.241792:  89%|████████▉ | 446/500 [1:16:25<08:36,  9.56s/it][2025-11-19 09:38:27,795] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.314077780760625
[2025-11-19 09:38:27,795] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:38:27,795] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:38:27,795] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:38:27,795] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:38:27,795] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:38:27,795] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   gamma: 0.1665428226381156
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   alpha: 0.47468835504428947
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   lambda: 0.9739874746229527
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   learning_rate: 0.033069400476025086
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   subsample: 0.8722883636761735
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   colsample_bytree: 0.6094792416490534
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5269286425880738
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   colsample_bynode: 0.8146760044725238
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:38:27,796] [INFO] [<frozen importlib] -   scale_pos_weight: 7.314077780760625
[2025-11-19 09:38:27,869] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:38:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:38:27,781] Trial 445 pruned. 
[0]	train-logloss:0.71595	train-auc:0.64599	train-aucpr:0.24538	val-logloss:0.71575	val-auc:0.62360	val-aucpr:0.12169
[10]	train-logloss:0.69198	train-auc:0.68166	train-aucpr:0.29522	val-logloss:0.65424	val-auc:0.70011	val-aucpr:0.20773
[20]	train-logloss:0.67693	train-auc:0.68498	train-aucpr:0.30022	val-logloss:0.61143	val-auc:0.70034	val-aucpr:0.20892
[30]	train-logloss:0.66662	train-auc:0.69142	train-aucpr:0.30394	val-logloss:0.58412	val-auc:0.70081	val-aucpr:0.21504
[40]	train-logloss:0.65917	train-auc:0.69511	train-aucpr:0.30728	val-logloss:0.55593	val-auc:0.69949	val-aucpr:0.21439
[50]	train-logloss:0.65304	train-auc:0.69879	train-aucpr:0.31115	val-logloss:0.54028	val-auc:0.70389	val-aucpr:0.22206
[60]	train-logloss:0.64831	train-auc:0.70209	train-aucpr:0.31523	val-logloss:0.54473	val-auc:0.69909	val-aucpr:0.21812
[70]	train-logloss:0.64436	train-auc:0.70558	train-aucpr:0.31861	val-logloss:0.53300	val-auc:0.69810	val-aucpr:0.21435
[80]	train-logloss:0.64117	train-auc:0.70826	train-aucpr:0.32183	val-logloss:0.53643	val-auc:0.69790	val-aucpr:0.21439
[81]	train-logloss:0.64095	train-auc:0.70835	train-aucpr:0.32193	val-logloss:0.53606	val-auc:0.69790	val-aucpr:0.21585
[2025-11-19 09:38:28,107] [INFO] [<frozen importlib] - Training completed at iteration 52
[2025-11-19 09:38:28,107] [INFO] [<frozen importlib] - Best train loss: 0.6521
[2025-11-19 09:38:28,107] [INFO] [<frozen importlib] - Best val loss: 0.5424
[2025-11-19 09:38:28,107] [INFO] [<frozen importlib] - Best val AUC: 0.7046
[2025-11-19 09:38:28,107] [INFO] [<frozen importlib] - Best val AUCPR: 0.2221
[2025-11-19 09:38:28,111] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:38:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:38:39,085] [INFO] [<frozen importlib] - Optimal threshold: 0.5128
[2025-11-19 09:38:39,085] [INFO] [<frozen importlib] - Best f1: 0.2647
[2025-11-19 09:38:39,085] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:38:39,129] [INFO] [<frozen importlib] - Validation Results (threshold=0.5128):
[2025-11-19 09:38:39,129] [INFO] [<frozen importlib] -   Accuracy: 0.9059
[2025-11-19 09:38:39,129] [INFO] [<frozen importlib] -   Precision: 0.3313
[2025-11-19 09:38:39,129] [INFO] [<frozen importlib] -   Recall: 0.2204
[2025-11-19 09:38:39,129] [INFO] [<frozen importlib] -   F1 Score: 0.2647
[2025-11-19 09:38:39,129] [INFO] [<frozen importlib] -   AUROC: 0.7046
[2025-11-19 09:38:39,129] [INFO] [<frozen importlib] -   AUPRC: 0.2225
[2025-11-19 09:38:39,129] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:38:39,129] [INFO] [<frozen importlib] -     TN=16799, FP=646
[2025-11-19 09:38:39,129] [INFO] [<frozen importlib] -     FN=1132, TP=320
[2025-11-19 09:38:39,153] [INFO] [<frozen importlib] - Trial 446: AUPRC=0.2225, F1=0.4653, Prec=0.4961, Rec=0.4380 | Optimizing auprc=0.2225
[2025-11-19 09:38:39,154] [INFO] [<frozen importlib] - Trial 446 pruned.
[2025-11-19 09:38:39,154] [ERROR] [<frozen importlib] - Trial 446 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  89%|████████▉ | 446/500 [1:16:37<08:36,  9.56s/it]Best trial: 289. Best value: 0.241792:  89%|████████▉ | 446/500 [1:16:37<08:36,  9.56s/it]Best trial: 289. Best value: 0.241792:  89%|████████▉ | 447/500 [1:16:37<08:55, 10.10s/it][2025-11-19 09:38:39,167] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.686738220598622
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   gamma: 0.22208486963693982
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   alpha: 0.570131982070772
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   lambda: 1.1525087392918594
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   learning_rate: 0.035731957618715976
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   subsample: 0.8311998060830225
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   colsample_bytree: 0.6277487500894797
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5100194231545476
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   colsample_bynode: 0.7833767782416199
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:38:39,167] [INFO] [<frozen importlib] -   scale_pos_weight: 6.686738220598622
[2025-11-19 09:38:39,236] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:38:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:38:39,154] Trial 446 pruned. 
[0]	train-logloss:0.68201	train-auc:0.64352	train-aucpr:0.22847	val-logloss:0.67578	val-auc:0.62079	val-aucpr:0.14986
[10]	train-logloss:0.65884	train-auc:0.67983	train-aucpr:0.29096	val-logloss:0.61985	val-auc:0.68233	val-aucpr:0.19890
[20]	train-logloss:0.64438	train-auc:0.68602	train-aucpr:0.29737	val-logloss:0.58095	val-auc:0.68608	val-aucpr:0.20787
[30]	train-logloss:0.63445	train-auc:0.69208	train-aucpr:0.30268	val-logloss:0.55163	val-auc:0.69401	val-aucpr:0.21560
[40]	train-logloss:0.62720	train-auc:0.69662	train-aucpr:0.30672	val-logloss:0.52258	val-auc:0.69446	val-aucpr:0.21498
[50]	train-logloss:0.62120	train-auc:0.70051	train-aucpr:0.31149	val-logloss:0.51107	val-auc:0.69464	val-aucpr:0.21510
[60]	train-logloss:0.61718	train-auc:0.70364	train-aucpr:0.31540	val-logloss:0.49987	val-auc:0.69478	val-aucpr:0.21752
[70]	train-logloss:0.61369	train-auc:0.70662	train-aucpr:0.31857	val-logloss:0.49051	val-auc:0.69604	val-aucpr:0.21889
[80]	train-logloss:0.61003	train-auc:0.71104	train-aucpr:0.32388	val-logloss:0.48251	val-auc:0.69363	val-aucpr:0.21720
[90]	train-logloss:0.60760	train-auc:0.71381	train-aucpr:0.32722	val-logloss:0.47905	val-auc:0.68971	val-aucpr:0.21312
[95]	train-logloss:0.60665	train-auc:0.71555	train-aucpr:0.32856	val-logloss:0.47497	val-auc:0.68880	val-aucpr:0.21246
[2025-11-19 09:38:39,505] [INFO] [<frozen importlib] - Training completed at iteration 65
[2025-11-19 09:38:39,505] [INFO] [<frozen importlib] - Best train loss: 0.6152
[2025-11-19 09:38:39,505] [INFO] [<frozen importlib] - Best val loss: 0.4954
[2025-11-19 09:38:39,505] [INFO] [<frozen importlib] - Best val AUC: 0.6969
[2025-11-19 09:38:39,505] [INFO] [<frozen importlib] - Best val AUCPR: 0.2213
[2025-11-19 09:38:39,509] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:38:39] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:38:50,948] [INFO] [<frozen importlib] - Optimal threshold: 0.4744
[2025-11-19 09:38:50,948] [INFO] [<frozen importlib] - Best f1: 0.2666
[2025-11-19 09:38:50,948] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:38:50,992] [INFO] [<frozen importlib] - Validation Results (threshold=0.4744):
[2025-11-19 09:38:50,992] [INFO] [<frozen importlib] -   Accuracy: 0.8969
[2025-11-19 09:38:50,992] [INFO] [<frozen importlib] -   Precision: 0.2940
[2025-11-19 09:38:50,992] [INFO] [<frozen importlib] -   Recall: 0.2438
[2025-11-19 09:38:50,992] [INFO] [<frozen importlib] -   F1 Score: 0.2666
[2025-11-19 09:38:50,993] [INFO] [<frozen importlib] -   AUROC: 0.6969
[2025-11-19 09:38:50,993] [INFO] [<frozen importlib] -   AUPRC: 0.2218
[2025-11-19 09:38:50,993] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:38:50,993] [INFO] [<frozen importlib] -     TN=16595, FP=850
[2025-11-19 09:38:50,993] [INFO] [<frozen importlib] -     FN=1098, TP=354
[2025-11-19 09:38:51,016] [INFO] [<frozen importlib] - Trial 447: AUPRC=0.2218, F1=0.4414, Prec=0.4341, Rec=0.4490 | Optimizing auprc=0.2218
[2025-11-19 09:38:51,016] [INFO] [<frozen importlib] - Trial 447 pruned.
[2025-11-19 09:38:51,016] [ERROR] [<frozen importlib] - Trial 447 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  89%|████████▉ | 447/500 [1:16:48<08:55, 10.10s/it]Best trial: 289. Best value: 0.241792:  89%|████████▉ | 447/500 [1:16:48<08:55, 10.10s/it]Best trial: 289. Best value: 0.241792:  90%|████████▉ | 448/500 [1:16:48<09:12, 10.63s/it][2025-11-19 09:38:51,030] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.9541073025959825
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   gamma: 0.10922713480776498
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   alpha: 0.3410518062457868
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   lambda: 0.8828492740521164
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   learning_rate: 0.03780854248687312
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   subsample: 0.8480565249034829
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   colsample_bytree: 0.5780819943004343
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   colsample_bylevel: 0.560008719152621
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   colsample_bynode: 0.7943814966025788
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:38:51,031] [INFO] [<frozen importlib] -   scale_pos_weight: 5.9541073025959825
[2025-11-19 09:38:51,105] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:38:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:38:51,016] Trial 447 pruned. 
[0]	train-logloss:0.64141	train-auc:0.64129	train-aucpr:0.22982	val-logloss:0.63052	val-auc:0.62851	val-aucpr:0.12897
[10]	train-logloss:0.61856	train-auc:0.68062	train-aucpr:0.29252	val-logloss:0.57327	val-auc:0.69823	val-aucpr:0.20452
[20]	train-logloss:0.60491	train-auc:0.68761	train-aucpr:0.29950	val-logloss:0.54017	val-auc:0.70365	val-aucpr:0.22460
[30]	train-logloss:0.59536	train-auc:0.69433	train-aucpr:0.30462	val-logloss:0.52160	val-auc:0.70110	val-aucpr:0.22122
[40]	train-logloss:0.58874	train-auc:0.69861	train-aucpr:0.30929	val-logloss:0.50862	val-auc:0.70021	val-aucpr:0.22259
[50]	train-logloss:0.58321	train-auc:0.70306	train-aucpr:0.31398	val-logloss:0.50355	val-auc:0.70047	val-aucpr:0.22571
[60]	train-logloss:0.57959	train-auc:0.70617	train-aucpr:0.31729	val-logloss:0.50549	val-auc:0.69824	val-aucpr:0.22547
[70]	train-logloss:0.57655	train-auc:0.70933	train-aucpr:0.32084	val-logloss:0.49509	val-auc:0.69908	val-aucpr:0.22352
[75]	train-logloss:0.57532	train-auc:0.71023	train-aucpr:0.32289	val-logloss:0.49246	val-auc:0.70098	val-aucpr:0.22405
[2025-11-19 09:38:51,329] [INFO] [<frozen importlib] - Training completed at iteration 46
[2025-11-19 09:38:51,329] [INFO] [<frozen importlib] - Best train loss: 0.5853
[2025-11-19 09:38:51,329] [INFO] [<frozen importlib] - Best val loss: 0.5061
[2025-11-19 09:38:51,329] [INFO] [<frozen importlib] - Best val AUC: 0.7004
[2025-11-19 09:38:51,329] [INFO] [<frozen importlib] - Best val AUCPR: 0.2261
[2025-11-19 09:38:51,334] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:38:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:39:01,634] [INFO] [<frozen importlib] - Optimal threshold: 0.4698
[2025-11-19 09:39:01,634] [INFO] [<frozen importlib] - Best f1: 0.2670
[2025-11-19 09:39:01,634] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:39:01,675] [INFO] [<frozen importlib] - Validation Results (threshold=0.4698):
[2025-11-19 09:39:01,675] [INFO] [<frozen importlib] -   Accuracy: 0.8969
[2025-11-19 09:39:01,675] [INFO] [<frozen importlib] -   Precision: 0.2941
[2025-11-19 09:39:01,675] [INFO] [<frozen importlib] -   Recall: 0.2445
[2025-11-19 09:39:01,675] [INFO] [<frozen importlib] -   F1 Score: 0.2670
[2025-11-19 09:39:01,675] [INFO] [<frozen importlib] -   AUROC: 0.7004
[2025-11-19 09:39:01,675] [INFO] [<frozen importlib] -   AUPRC: 0.2265
[2025-11-19 09:39:01,675] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:39:01,675] [INFO] [<frozen importlib] -     TN=16593, FP=852
[2025-11-19 09:39:01,675] [INFO] [<frozen importlib] -     FN=1097, TP=355
[2025-11-19 09:39:01,698] [INFO] [<frozen importlib] - Trial 448: AUPRC=0.2265, F1=0.4578, Prec=0.4453, Rec=0.4711 | Optimizing auprc=0.2265
[2025-11-19 09:39:01,698] [INFO] [<frozen importlib] - Trial 448 pruned.
[2025-11-19 09:39:01,698] [ERROR] [<frozen importlib] - Trial 448 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  90%|████████▉ | 448/500 [1:16:59<09:12, 10.63s/it]Best trial: 289. Best value: 0.241792:  90%|████████▉ | 448/500 [1:16:59<09:12, 10.63s/it]Best trial: 289. Best value: 0.241792:  90%|████████▉ | 449/500 [1:16:59<09:02, 10.65s/it][2025-11-19 09:39:01,712] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.344369634510244
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   gamma: 0.1396588198078137
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   alpha: 1.6629557233950654
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   lambda: 1.0453511063596241
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   learning_rate: 0.04039929545851747
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   subsample: 0.8316579766605019
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   colsample_bytree: 0.5924989891263492
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   colsample_bylevel: 0.542342825100958
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   colsample_bynode: 0.8326209472728878
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:39:01,712] [INFO] [<frozen importlib] -   scale_pos_weight: 6.344369634510244
[2025-11-19 09:39:01,783] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:39:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:39:01,698] Trial 448 pruned. 
[0]	train-logloss:0.66334	train-auc:0.63371	train-aucpr:0.22873	val-logloss:0.65581	val-auc:0.64959	val-aucpr:0.14490
[10]	train-logloss:0.63853	train-auc:0.68314	train-aucpr:0.28988	val-logloss:0.60173	val-auc:0.70329	val-aucpr:0.20853
[20]	train-logloss:0.62343	train-auc:0.68937	train-aucpr:0.30055	val-logloss:0.55897	val-auc:0.71502	val-aucpr:0.21678
[30]	train-logloss:0.61342	train-auc:0.69523	train-aucpr:0.30607	val-logloss:0.53170	val-auc:0.70974	val-aucpr:0.22188
[40]	train-logloss:0.60659	train-auc:0.69938	train-aucpr:0.31138	val-logloss:0.52084	val-auc:0.71638	val-aucpr:0.22693
[50]	train-logloss:0.60085	train-auc:0.70285	train-aucpr:0.31641	val-logloss:0.50591	val-auc:0.71679	val-aucpr:0.23055
[60]	train-logloss:0.59709	train-auc:0.70662	train-aucpr:0.32048	val-logloss:0.49565	val-auc:0.71012	val-aucpr:0.22477
[70]	train-logloss:0.59372	train-auc:0.70930	train-aucpr:0.32434	val-logloss:0.49347	val-auc:0.71181	val-aucpr:0.22802
[78]	train-logloss:0.59152	train-auc:0.71207	train-aucpr:0.32695	val-logloss:0.48980	val-auc:0.70932	val-aucpr:0.22329
[2025-11-19 09:39:02,013] [INFO] [<frozen importlib] - Training completed at iteration 48
[2025-11-19 09:39:02,013] [INFO] [<frozen importlib] - Best train loss: 0.6017
[2025-11-19 09:39:02,013] [INFO] [<frozen importlib] - Best val loss: 0.5115
[2025-11-19 09:39:02,013] [INFO] [<frozen importlib] - Best val AUC: 0.7176
[2025-11-19 09:39:02,013] [INFO] [<frozen importlib] - Best val AUCPR: 0.2310
[2025-11-19 09:39:02,017] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:39:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:39:12,133] [INFO] [<frozen importlib] - Optimal threshold: 0.4842
[2025-11-19 09:39:12,133] [INFO] [<frozen importlib] - Best f1: 0.2841
[2025-11-19 09:39:12,133] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:39:12,177] [INFO] [<frozen importlib] - Validation Results (threshold=0.4842):
[2025-11-19 09:39:12,177] [INFO] [<frozen importlib] -   Accuracy: 0.8944
[2025-11-19 09:39:12,177] [INFO] [<frozen importlib] -   Precision: 0.2964
[2025-11-19 09:39:12,177] [INFO] [<frozen importlib] -   Recall: 0.2727
[2025-11-19 09:39:12,177] [INFO] [<frozen importlib] -   F1 Score: 0.2841
[2025-11-19 09:39:12,177] [INFO] [<frozen importlib] -   AUROC: 0.7176
[2025-11-19 09:39:12,177] [INFO] [<frozen importlib] -   AUPRC: 0.2314
[2025-11-19 09:39:12,177] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:39:12,177] [INFO] [<frozen importlib] -     TN=16505, FP=940
[2025-11-19 09:39:12,177] [INFO] [<frozen importlib] -     FN=1056, TP=396
[2025-11-19 09:39:12,201] [INFO] [<frozen importlib] - Trial 449: AUPRC=0.2314, F1=0.4493, Prec=0.4244, Rec=0.4773 | Optimizing auprc=0.2314
                                                                                          Best trial: 289. Best value: 0.241792:  90%|████████▉ | 449/500 [1:17:10<09:02, 10.65s/it]Best trial: 289. Best value: 0.241792:  90%|████████▉ | 449/500 [1:17:10<09:02, 10.65s/it]Best trial: 289. Best value: 0.241792:  90%|█████████ | 450/500 [1:17:10<08:50, 10.60s/it][2025-11-19 09:39:12,217] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.428945587499994
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   gamma: 0.19753411681755567
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   alpha: 0.5133753340992855
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   lambda: 1.3816150311868447
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   learning_rate: 0.03499926767041548
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   subsample: 0.8403228412442183
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   colsample_bytree: 0.6168526139382166
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   colsample_bylevel: 0.7031594407328599
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   colsample_bynode: 0.8156088912540468
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:39:12,217] [INFO] [<frozen importlib] -   scale_pos_weight: 5.428945587499994
[2025-11-19 09:39:12,290] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:39:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:39:12,202] Trial 449 finished with value: 0.23135594830371303 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.1396588198078137, 'learning_rate': 0.04039929545851747, 'n_estimators': 350, 'alpha': 1.6629557233950654, 'lambda': 1.0453511063596241, 'subsample': 0.8316579766605019, 'colsample_bytree': 0.5924989891263492, 'colsample_bylevel': 0.542342825100958, 'colsample_bynode': 0.8326209472728878, 'scale_pos_weight': 6.344369634510244}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.61178	train-auc:0.64921	train-aucpr:0.23706	val-logloss:0.59483	val-auc:0.58771	val-aucpr:0.13504
[10]	train-logloss:0.59156	train-auc:0.68109	train-aucpr:0.28772	val-logloss:0.53890	val-auc:0.69704	val-aucpr:0.20256
[20]	train-logloss:0.57862	train-auc:0.68662	train-aucpr:0.29646	val-logloss:0.50902	val-auc:0.68915	val-aucpr:0.19647
[30]	train-logloss:0.56974	train-auc:0.69226	train-aucpr:0.30270	val-logloss:0.48332	val-auc:0.69336	val-aucpr:0.20904
[40]	train-logloss:0.56325	train-auc:0.69698	train-aucpr:0.30842	val-logloss:0.46572	val-auc:0.69425	val-aucpr:0.21011
[50]	train-logloss:0.55813	train-auc:0.70013	train-aucpr:0.31268	val-logloss:0.46239	val-auc:0.69907	val-aucpr:0.21673
[60]	train-logloss:0.55450	train-auc:0.70296	train-aucpr:0.31607	val-logloss:0.45276	val-auc:0.70224	val-aucpr:0.22337
[70]	train-logloss:0.55127	train-auc:0.70662	train-aucpr:0.32038	val-logloss:0.44304	val-auc:0.69718	val-aucpr:0.21332
[80]	train-logloss:0.54849	train-auc:0.71065	train-aucpr:0.32437	val-logloss:0.43721	val-auc:0.69448	val-aucpr:0.20440
[90]	train-logloss:0.54592	train-auc:0.71524	train-aucpr:0.32896	val-logloss:0.43097	val-auc:0.68819	val-aucpr:0.19296
[91]	train-logloss:0.54575	train-auc:0.71583	train-aucpr:0.32942	val-logloss:0.42996	val-auc:0.68753	val-aucpr:0.19225
[2025-11-19 09:39:12,549] [INFO] [<frozen importlib] - Training completed at iteration 61
[2025-11-19 09:39:12,549] [INFO] [<frozen importlib] - Best train loss: 0.5542
[2025-11-19 09:39:12,549] [INFO] [<frozen importlib] - Best val loss: 0.4510
[2025-11-19 09:39:12,549] [INFO] [<frozen importlib] - Best val AUC: 0.7028
[2025-11-19 09:39:12,549] [INFO] [<frozen importlib] - Best val AUCPR: 0.2236
[2025-11-19 09:39:12,554] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:39:12] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:39:24,209] [INFO] [<frozen importlib] - Optimal threshold: 0.4304
[2025-11-19 09:39:24,209] [INFO] [<frozen importlib] - Best f1: 0.2728
[2025-11-19 09:39:24,209] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:39:24,254] [INFO] [<frozen importlib] - Validation Results (threshold=0.4304):
[2025-11-19 09:39:24,254] [INFO] [<frozen importlib] -   Accuracy: 0.8987
[2025-11-19 09:39:24,254] [INFO] [<frozen importlib] -   Precision: 0.3042
[2025-11-19 09:39:24,254] [INFO] [<frozen importlib] -   Recall: 0.2472
[2025-11-19 09:39:24,254] [INFO] [<frozen importlib] -   F1 Score: 0.2728
[2025-11-19 09:39:24,254] [INFO] [<frozen importlib] -   AUROC: 0.7028
[2025-11-19 09:39:24,254] [INFO] [<frozen importlib] -   AUPRC: 0.2241
[2025-11-19 09:39:24,254] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:39:24,254] [INFO] [<frozen importlib] -     TN=16624, FP=821
[2025-11-19 09:39:24,254] [INFO] [<frozen importlib] -     FN=1093, TP=359
[2025-11-19 09:39:24,277] [INFO] [<frozen importlib] - Trial 450: AUPRC=0.2241, F1=0.4724, Prec=0.4613, Rec=0.4842 | Optimizing auprc=0.2241
[2025-11-19 09:39:24,277] [INFO] [<frozen importlib] - Trial 450 pruned.
[2025-11-19 09:39:24,277] [ERROR] [<frozen importlib] - Trial 450 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  90%|█████████ | 450/500 [1:17:22<08:50, 10.60s/it]Best trial: 289. Best value: 0.241792:  90%|█████████ | 450/500 [1:17:22<08:50, 10.60s/it]Best trial: 289. Best value: 0.241792:  90%|█████████ | 451/500 [1:17:22<09:01, 11.04s/it][2025-11-19 09:39:24,292] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.175116799291323
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   min_child_weight: 10
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   gamma: 0.1659050891403187
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   alpha: 1.3189088092673864
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   lambda: 1.2744205073569934
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   learning_rate: 0.03661901972552277
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   subsample: 0.8192413059990429
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   colsample_bytree: 0.5988498739468929
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5189310756814829
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   colsample_bynode: 0.7870892848743447
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:39:24,292] [INFO] [<frozen importlib] -   scale_pos_weight: 7.175116799291323
[2025-11-19 09:39:24,368] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:39:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:39:24,277] Trial 450 pruned. 
[0]	train-logloss:0.70857	train-auc:0.63894	train-aucpr:0.22160	val-logloss:0.70682	val-auc:0.61080	val-aucpr:0.12777
[10]	train-logloss:0.68386	train-auc:0.68217	train-aucpr:0.28999	val-logloss:0.65172	val-auc:0.68766	val-aucpr:0.19468
[20]	train-logloss:0.66841	train-auc:0.68744	train-aucpr:0.29872	val-logloss:0.60739	val-auc:0.69667	val-aucpr:0.21129
[30]	train-logloss:0.65773	train-auc:0.69180	train-aucpr:0.30368	val-logloss:0.57195	val-auc:0.70107	val-aucpr:0.22476
[40]	train-logloss:0.65031	train-auc:0.69649	train-aucpr:0.30704	val-logloss:0.55020	val-auc:0.71130	val-aucpr:0.22875
[50]	train-logloss:0.64399	train-auc:0.70086	train-aucpr:0.31072	val-logloss:0.53780	val-auc:0.71348	val-aucpr:0.23401
[60]	train-logloss:0.63975	train-auc:0.70398	train-aucpr:0.31508	val-logloss:0.52626	val-auc:0.71119	val-aucpr:0.23116
[70]	train-logloss:0.63623	train-auc:0.70767	train-aucpr:0.31861	val-logloss:0.52667	val-auc:0.70688	val-aucpr:0.23376
[80]	train-logloss:0.63310	train-auc:0.71068	train-aucpr:0.32233	val-logloss:0.52134	val-auc:0.70680	val-aucpr:0.22952
[90]	train-logloss:0.63039	train-auc:0.71423	train-aucpr:0.32609	val-logloss:0.52575	val-auc:0.70504	val-aucpr:0.22227
[98]	train-logloss:0.62832	train-auc:0.71726	train-aucpr:0.32957	val-logloss:0.51723	val-auc:0.69821	val-aucpr:0.22166
[2025-11-19 09:39:24,645] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:39:24,645] [INFO] [<frozen importlib] - Best train loss: 0.6368
[2025-11-19 09:39:24,645] [INFO] [<frozen importlib] - Best val loss: 0.5176
[2025-11-19 09:39:24,645] [INFO] [<frozen importlib] - Best val AUC: 0.7105
[2025-11-19 09:39:24,645] [INFO] [<frozen importlib] - Best val AUCPR: 0.2357
[2025-11-19 09:39:24,650] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:39:24] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:39:37,918] [INFO] [<frozen importlib] - Optimal threshold: 0.5116
[2025-11-19 09:39:37,919] [INFO] [<frozen importlib] - Best f1: 0.2767
[2025-11-19 09:39:37,919] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:39:37,959] [INFO] [<frozen importlib] - Validation Results (threshold=0.5116):
[2025-11-19 09:39:37,959] [INFO] [<frozen importlib] -   Accuracy: 0.9054
[2025-11-19 09:39:37,959] [INFO] [<frozen importlib] -   Precision: 0.3353
[2025-11-19 09:39:37,959] [INFO] [<frozen importlib] -   Recall: 0.2355
[2025-11-19 09:39:37,959] [INFO] [<frozen importlib] -   F1 Score: 0.2767
[2025-11-19 09:39:37,959] [INFO] [<frozen importlib] -   AUROC: 0.7105
[2025-11-19 09:39:37,959] [INFO] [<frozen importlib] -   AUPRC: 0.2361
[2025-11-19 09:39:37,959] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:39:37,959] [INFO] [<frozen importlib] -     TN=16767, FP=678
[2025-11-19 09:39:37,959] [INFO] [<frozen importlib] -     FN=1110, TP=342
[2025-11-19 09:39:37,982] [INFO] [<frozen importlib] - Trial 451: AUPRC=0.2361, F1=0.4599, Prec=0.4840, Rec=0.4380 | Optimizing auprc=0.2361
                                                                                          Best trial: 289. Best value: 0.241792:  90%|█████████ | 451/500 [1:17:35<09:01, 11.04s/it]Best trial: 289. Best value: 0.241792:  90%|█████████ | 451/500 [1:17:35<09:01, 11.04s/it]Best trial: 289. Best value: 0.241792:  90%|█████████ | 452/500 [1:17:35<09:28, 11.84s/it][2025-11-19 09:39:37,996] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.0991038582045425
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   min_child_weight: 10
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   gamma: 0.1701515466199075
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   alpha: 1.757292916329378
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   lambda: 1.4861649959111523
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   learning_rate: 0.03667522643605132
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   subsample: 0.8153329163731503
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   colsample_bytree: 0.5801743964084145
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5156482066816738
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   colsample_bynode: 0.803079313254298
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:39:37,996] [INFO] [<frozen importlib] -   scale_pos_weight: 7.0991038582045425
[2025-11-19 09:39:38,077] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:39:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:39:37,982] Trial 451 finished with value: 0.2361108031423206 and parameters: {'max_depth': 4, 'min_child_weight': 10, 'gamma': 0.1659050891403187, 'learning_rate': 0.03661901972552277, 'n_estimators': 350, 'alpha': 1.3189088092673864, 'lambda': 1.2744205073569934, 'subsample': 0.8192413059990429, 'colsample_bytree': 0.5988498739468929, 'colsample_bylevel': 0.5189310756814829, 'colsample_bynode': 0.7870892848743447, 'scale_pos_weight': 7.175116799291323}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.70437	train-auc:0.64415	train-aucpr:0.23465	val-logloss:0.70278	val-auc:0.61161	val-aucpr:0.12355
[10]	train-logloss:0.67959	train-auc:0.68222	train-aucpr:0.29039	val-logloss:0.63693	val-auc:0.70441	val-aucpr:0.21264
[20]	train-logloss:0.66425	train-auc:0.68761	train-aucpr:0.29768	val-logloss:0.59460	val-auc:0.70508	val-aucpr:0.22039
[30]	train-logloss:0.65382	train-auc:0.69247	train-aucpr:0.30406	val-logloss:0.56785	val-auc:0.70204	val-aucpr:0.22500
[40]	train-logloss:0.64670	train-auc:0.69742	train-aucpr:0.30798	val-logloss:0.55415	val-auc:0.70431	val-aucpr:0.22697
[50]	train-logloss:0.64014	train-auc:0.70240	train-aucpr:0.31249	val-logloss:0.55275	val-auc:0.69999	val-aucpr:0.22509
[60]	train-logloss:0.63592	train-auc:0.70472	train-aucpr:0.31570	val-logloss:0.55619	val-auc:0.70342	val-aucpr:0.22471
[70]	train-logloss:0.63231	train-auc:0.70821	train-aucpr:0.31959	val-logloss:0.54324	val-auc:0.70107	val-aucpr:0.21866
[77]	train-logloss:0.63017	train-auc:0.71075	train-aucpr:0.32197	val-logloss:0.53931	val-auc:0.70276	val-aucpr:0.21942
[2025-11-19 09:39:38,301] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 09:39:38,301] [INFO] [<frozen importlib] - Best train loss: 0.6417
[2025-11-19 09:39:38,301] [INFO] [<frozen importlib] - Best val loss: 0.5489
[2025-11-19 09:39:38,301] [INFO] [<frozen importlib] - Best val AUC: 0.7038
[2025-11-19 09:39:38,301] [INFO] [<frozen importlib] - Best val AUCPR: 0.2276
[2025-11-19 09:39:38,305] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:39:38] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:39:48,502] [INFO] [<frozen importlib] - Optimal threshold: 0.5215
[2025-11-19 09:39:48,502] [INFO] [<frozen importlib] - Best f1: 0.2693
[2025-11-19 09:39:48,502] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:39:48,546] [INFO] [<frozen importlib] - Validation Results (threshold=0.5215):
[2025-11-19 09:39:48,546] [INFO] [<frozen importlib] -   Accuracy: 0.9026
[2025-11-19 09:39:48,546] [INFO] [<frozen importlib] -   Precision: 0.3180
[2025-11-19 09:39:48,546] [INFO] [<frozen importlib] -   Recall: 0.2335
[2025-11-19 09:39:48,546] [INFO] [<frozen importlib] -   F1 Score: 0.2693
[2025-11-19 09:39:48,546] [INFO] [<frozen importlib] -   AUROC: 0.7038
[2025-11-19 09:39:48,546] [INFO] [<frozen importlib] -   AUPRC: 0.2279
[2025-11-19 09:39:48,546] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:39:48,546] [INFO] [<frozen importlib] -     TN=16718, FP=727
[2025-11-19 09:39:48,546] [INFO] [<frozen importlib] -     FN=1113, TP=339
[2025-11-19 09:39:48,569] [INFO] [<frozen importlib] - Trial 452: AUPRC=0.2279, F1=0.4660, Prec=0.4766, Rec=0.4559 | Optimizing auprc=0.2279
                                                                                          Best trial: 289. Best value: 0.241792:  90%|█████████ | 452/500 [1:17:46<09:28, 11.84s/it]Best trial: 289. Best value: 0.241792:  90%|█████████ | 452/500 [1:17:46<09:28, 11.84s/it]Best trial: 289. Best value: 0.241792:  91%|█████████ | 453/500 [1:17:46<08:58, 11.47s/it][2025-11-19 09:39:48,584] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.240612826829916
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   min_child_weight: 10
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   gamma: 0.15591958433018613
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   alpha: 1.5731451799854728
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   lambda: 1.3256173077040876
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   learning_rate: 0.033464712465143646
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   subsample: 0.8082001792480568
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   colsample_bytree: 0.5994735370569894
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5096367971693563
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   colsample_bynode: 0.78357588614385
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:39:48,584] [INFO] [<frozen importlib] -   scale_pos_weight: 7.240612826829916
[2025-11-19 09:39:48,658] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:39:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:39:48,569] Trial 452 finished with value: 0.22794397674377398 and parameters: {'max_depth': 4, 'min_child_weight': 10, 'gamma': 0.1701515466199075, 'learning_rate': 0.03667522643605132, 'n_estimators': 400, 'alpha': 1.757292916329378, 'lambda': 1.4861649959111523, 'subsample': 0.8153329163731503, 'colsample_bytree': 0.5801743964084145, 'colsample_bylevel': 0.5156482066816738, 'colsample_bynode': 0.803079313254298, 'scale_pos_weight': 7.0991038582045425}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.71229	train-auc:0.63877	train-aucpr:0.22147	val-logloss:0.71132	val-auc:0.61062	val-aucpr:0.12755
[10]	train-logloss:0.68903	train-auc:0.68103	train-aucpr:0.28765	val-logloss:0.66139	val-auc:0.69281	val-aucpr:0.18239
[20]	train-logloss:0.67404	train-auc:0.68670	train-aucpr:0.29620	val-logloss:0.62052	val-auc:0.70272	val-aucpr:0.21454
[30]	train-logloss:0.66319	train-auc:0.69116	train-aucpr:0.30127	val-logloss:0.58773	val-auc:0.70006	val-aucpr:0.22238
[40]	train-logloss:0.65578	train-auc:0.69600	train-aucpr:0.30516	val-logloss:0.56508	val-auc:0.71076	val-aucpr:0.22634
[50]	train-logloss:0.64945	train-auc:0.70033	train-aucpr:0.30935	val-logloss:0.54731	val-auc:0.71286	val-aucpr:0.22966
[60]	train-logloss:0.64488	train-auc:0.70304	train-aucpr:0.31392	val-logloss:0.54053	val-auc:0.70992	val-aucpr:0.22755
[70]	train-logloss:0.64102	train-auc:0.70608	train-aucpr:0.31757	val-logloss:0.52830	val-auc:0.70771	val-aucpr:0.22987
[80]	train-logloss:0.63798	train-auc:0.70870	train-aucpr:0.32045	val-logloss:0.52145	val-auc:0.70693	val-aucpr:0.22747
[90]	train-logloss:0.63541	train-auc:0.71166	train-aucpr:0.32342	val-logloss:0.52865	val-auc:0.70114	val-aucpr:0.21526
[95]	train-logloss:0.63400	train-auc:0.71341	train-aucpr:0.32556	val-logloss:0.52596	val-auc:0.70212	val-aucpr:0.21606
[2025-11-19 09:39:48,933] [INFO] [<frozen importlib] - Training completed at iteration 66
[2025-11-19 09:39:48,933] [INFO] [<frozen importlib] - Best train loss: 0.6424
[2025-11-19 09:39:48,933] [INFO] [<frozen importlib] - Best val loss: 0.5337
[2025-11-19 09:39:48,933] [INFO] [<frozen importlib] - Best val AUC: 0.7085
[2025-11-19 09:39:48,933] [INFO] [<frozen importlib] - Best val AUCPR: 0.2305
[2025-11-19 09:39:48,939] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:39:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:40:01,591] [INFO] [<frozen importlib] - Optimal threshold: 0.5100
[2025-11-19 09:40:01,591] [INFO] [<frozen importlib] - Best f1: 0.2753
[2025-11-19 09:40:01,591] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:40:01,631] [INFO] [<frozen importlib] - Validation Results (threshold=0.5100):
[2025-11-19 09:40:01,631] [INFO] [<frozen importlib] -   Accuracy: 0.9005
[2025-11-19 09:40:01,631] [INFO] [<frozen importlib] -   Precision: 0.3126
[2025-11-19 09:40:01,632] [INFO] [<frozen importlib] -   Recall: 0.2459
[2025-11-19 09:40:01,632] [INFO] [<frozen importlib] -   F1 Score: 0.2753
[2025-11-19 09:40:01,632] [INFO] [<frozen importlib] -   AUROC: 0.7085
[2025-11-19 09:40:01,632] [INFO] [<frozen importlib] -   AUPRC: 0.2309
[2025-11-19 09:40:01,632] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:40:01,632] [INFO] [<frozen importlib] -     TN=16660, FP=785
[2025-11-19 09:40:01,632] [INFO] [<frozen importlib] -     FN=1095, TP=357
[2025-11-19 09:40:01,656] [INFO] [<frozen importlib] - Trial 453: AUPRC=0.2309, F1=0.4657, Prec=0.4638, Rec=0.4676 | Optimizing auprc=0.2309
                                                                                          Best trial: 289. Best value: 0.241792:  91%|█████████ | 453/500 [1:17:59<08:58, 11.47s/it]Best trial: 289. Best value: 0.241792:  91%|█████████ | 453/500 [1:17:59<08:58, 11.47s/it]Best trial: 289. Best value: 0.241792:  91%|█████████ | 454/500 [1:17:59<09:09, 11.95s/it][2025-11-19 09:40:01,669] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.834744124590716
[2025-11-19 09:40:01,669] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:40:01,669] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:40:01,669] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:40:01,669] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   gamma: 0.1310671986384709
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   alpha: 1.7197192137389892
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   lambda: 1.280607957321913
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   learning_rate: 0.03440767172096516
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   subsample: 0.8233033850637211
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   colsample_bytree: 0.5889755459539631
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   colsample_bylevel: 0.522506057212077
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   colsample_bynode: 0.7977863469071514
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:40:01,670] [INFO] [<frozen importlib] -   scale_pos_weight: 6.834744124590716
[2025-11-19 09:40:01,744] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:40:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:40:01,656] Trial 453 finished with value: 0.2308960857459687 and parameters: {'max_depth': 4, 'min_child_weight': 10, 'gamma': 0.15591958433018613, 'learning_rate': 0.033464712465143646, 'n_estimators': 350, 'alpha': 1.5731451799854728, 'lambda': 1.3256173077040876, 'subsample': 0.8082001792480568, 'colsample_bytree': 0.5994735370569894, 'colsample_bylevel': 0.5096367971693563, 'colsample_bynode': 0.78357588614385, 'scale_pos_weight': 7.240612826829916}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.69057	train-auc:0.63034	train-aucpr:0.22306	val-logloss:0.68833	val-auc:0.61043	val-aucpr:0.12169
[10]	train-logloss:0.66718	train-auc:0.67999	train-aucpr:0.28592	val-logloss:0.63450	val-auc:0.69153	val-aucpr:0.18702
[20]	train-logloss:0.65306	train-auc:0.68520	train-aucpr:0.29725	val-logloss:0.60144	val-auc:0.68439	val-aucpr:0.20658
[30]	train-logloss:0.64294	train-auc:0.69108	train-aucpr:0.30248	val-logloss:0.58057	val-auc:0.70027	val-aucpr:0.21498
[40]	train-logloss:0.63592	train-auc:0.69582	train-aucpr:0.30561	val-logloss:0.56099	val-auc:0.69741	val-aucpr:0.21531
[50]	train-logloss:0.62972	train-auc:0.70028	train-aucpr:0.31096	val-logloss:0.55392	val-auc:0.69711	val-aucpr:0.21879
[60]	train-logloss:0.62561	train-auc:0.70387	train-aucpr:0.31426	val-logloss:0.54447	val-auc:0.69647	val-aucpr:0.22026
[70]	train-logloss:0.62182	train-auc:0.70829	train-aucpr:0.31883	val-logloss:0.54028	val-auc:0.69375	val-aucpr:0.21113
[80]	train-logloss:0.61850	train-auc:0.71178	train-aucpr:0.32226	val-logloss:0.52906	val-auc:0.69288	val-aucpr:0.20959
[90]	train-logloss:0.61553	train-auc:0.71532	train-aucpr:0.32573	val-logloss:0.52136	val-auc:0.68382	val-aucpr:0.19904
[92]	train-logloss:0.61499	train-auc:0.71599	train-aucpr:0.32633	val-logloss:0.51565	val-auc:0.68377	val-aucpr:0.19866
[2025-11-19 09:40:02,016] [INFO] [<frozen importlib] - Training completed at iteration 63
[2025-11-19 09:40:02,016] [INFO] [<frozen importlib] - Best train loss: 0.6245
[2025-11-19 09:40:02,016] [INFO] [<frozen importlib] - Best val loss: 0.5384
[2025-11-19 09:40:02,016] [INFO] [<frozen importlib] - Best val AUC: 0.6975
[2025-11-19 09:40:02,016] [INFO] [<frozen importlib] - Best val AUCPR: 0.2219
[2025-11-19 09:40:02,021] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:40:02] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:40:14,657] [INFO] [<frozen importlib] - Optimal threshold: 0.5098
[2025-11-19 09:40:14,657] [INFO] [<frozen importlib] - Best f1: 0.2680
[2025-11-19 09:40:14,657] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:40:14,701] [INFO] [<frozen importlib] - Validation Results (threshold=0.5098):
[2025-11-19 09:40:14,701] [INFO] [<frozen importlib] -   Accuracy: 0.9034
[2025-11-19 09:40:14,701] [INFO] [<frozen importlib] -   Precision: 0.3208
[2025-11-19 09:40:14,701] [INFO] [<frozen importlib] -   Recall: 0.2300
[2025-11-19 09:40:14,701] [INFO] [<frozen importlib] -   F1 Score: 0.2680
[2025-11-19 09:40:14,701] [INFO] [<frozen importlib] -   AUROC: 0.6975
[2025-11-19 09:40:14,701] [INFO] [<frozen importlib] -   AUPRC: 0.2224
[2025-11-19 09:40:14,701] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:40:14,701] [INFO] [<frozen importlib] -     TN=16738, FP=707
[2025-11-19 09:40:14,701] [INFO] [<frozen importlib] -     FN=1118, TP=334
[2025-11-19 09:40:14,724] [INFO] [<frozen importlib] - Trial 454: AUPRC=0.2224, F1=0.4644, Prec=0.4801, Rec=0.4497 | Optimizing auprc=0.2224
[2025-11-19 09:40:14,725] [INFO] [<frozen importlib] - Trial 454 pruned.
[2025-11-19 09:40:14,725] [ERROR] [<frozen importlib] - Trial 454 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  91%|█████████ | 454/500 [1:18:12<09:09, 11.95s/it]Best trial: 289. Best value: 0.241792:  91%|█████████ | 454/500 [1:18:12<09:09, 11.95s/it]Best trial: 289. Best value: 0.241792:  91%|█████████ | 455/500 [1:18:12<09:12, 12.29s/it][2025-11-19 09:40:14,739] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 19.303395403633015
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   gamma: 0.18478459541395978
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   alpha: 1.3558337595245993
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   lambda: 1.198767228822377
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   learning_rate: 0.03567756261977085
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   subsample: 0.8168456971576861
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   colsample_bytree: 0.5673938192909216
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5090495583608974
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   colsample_bynode: 0.8225001630648265
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:40:14,739] [INFO] [<frozen importlib] -   scale_pos_weight: 19.303395403633015
[2025-11-19 09:40:14,813] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:40:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:40:14,725] Trial 454 pruned. 
[0]	train-logloss:1.15257	train-auc:0.64776	train-aucpr:0.22520	val-logloss:1.19003	val-auc:0.62833	val-aucpr:0.11274
[10]	train-logloss:1.11848	train-auc:0.68561	train-aucpr:0.28453	val-logloss:1.08062	val-auc:0.69222	val-aucpr:0.18788
[20]	train-logloss:1.10156	train-auc:0.69016	train-aucpr:0.29367	val-logloss:1.01615	val-auc:0.69191	val-aucpr:0.20515
[30]	train-logloss:1.09122	train-auc:0.69260	train-aucpr:0.29900	val-logloss:0.96228	val-auc:0.69613	val-aucpr:0.20862
[40]	train-logloss:1.08317	train-auc:0.69626	train-aucpr:0.30111	val-logloss:0.93864	val-auc:0.69323	val-aucpr:0.20816
[50]	train-logloss:1.07539	train-auc:0.70068	train-aucpr:0.30529	val-logloss:0.91591	val-auc:0.69313	val-aucpr:0.21224
[60]	train-logloss:1.06958	train-auc:0.70549	train-aucpr:0.30861	val-logloss:0.90698	val-auc:0.69349	val-aucpr:0.21794
[70]	train-logloss:1.06330	train-auc:0.71121	train-aucpr:0.31381	val-logloss:0.88952	val-auc:0.69040	val-aucpr:0.20793
[80]	train-logloss:1.05944	train-auc:0.71420	train-aucpr:0.31697	val-logloss:0.87088	val-auc:0.68620	val-aucpr:0.19773
[90]	train-logloss:1.05505	train-auc:0.71758	train-aucpr:0.32139	val-logloss:0.86345	val-auc:0.68157	val-aucpr:0.19507
[2025-11-19 09:40:15,071] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:40:15,071] [INFO] [<frozen importlib] - Best train loss: 1.0696
[2025-11-19 09:40:15,071] [INFO] [<frozen importlib] - Best val loss: 0.9070
[2025-11-19 09:40:15,071] [INFO] [<frozen importlib] - Best val AUC: 0.6935
[2025-11-19 09:40:15,071] [INFO] [<frozen importlib] - Best val AUCPR: 0.2179
[2025-11-19 09:40:15,075] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:40:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:40:28,514] [INFO] [<frozen importlib] - Optimal threshold: 0.7240
[2025-11-19 09:40:28,514] [INFO] [<frozen importlib] - Best f1: 0.2586
[2025-11-19 09:40:28,514] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:40:28,559] [INFO] [<frozen importlib] - Validation Results (threshold=0.7240):
[2025-11-19 09:40:28,559] [INFO] [<frozen importlib] -   Accuracy: 0.8944
[2025-11-19 09:40:28,559] [INFO] [<frozen importlib] -   Precision: 0.2809
[2025-11-19 09:40:28,559] [INFO] [<frozen importlib] -   Recall: 0.2397
[2025-11-19 09:40:28,559] [INFO] [<frozen importlib] -   F1 Score: 0.2586
[2025-11-19 09:40:28,559] [INFO] [<frozen importlib] -   AUROC: 0.6935
[2025-11-19 09:40:28,559] [INFO] [<frozen importlib] -   AUPRC: 0.2183
[2025-11-19 09:40:28,559] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:40:28,559] [INFO] [<frozen importlib] -     TN=16554, FP=891
[2025-11-19 09:40:28,559] [INFO] [<frozen importlib] -     FN=1104, TP=348
[2025-11-19 09:40:28,582] [INFO] [<frozen importlib] - Trial 455: AUPRC=0.2183, F1=0.4530, Prec=0.4350, Rec=0.4725 | Optimizing auprc=0.2183
[2025-11-19 09:40:28,583] [INFO] [<frozen importlib] - Trial 455 pruned.
[2025-11-19 09:40:28,583] [ERROR] [<frozen importlib] - Trial 455 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  91%|█████████ | 455/500 [1:18:26<09:12, 12.29s/it]Best trial: 289. Best value: 0.241792:  91%|█████████ | 455/500 [1:18:26<09:12, 12.29s/it]Best trial: 289. Best value: 0.241792:  91%|█████████ | 456/500 [1:18:26<09:21, 12.76s/it][2025-11-19 09:40:28,599] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.238381262811604
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   gamma: 0.1449973185199379
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   alpha: 1.4791596874528974
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   lambda: 1.5419126278557276
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   learning_rate: 0.032135691744091886
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   subsample: 0.8015756785710413
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   colsample_bytree: 0.6140109068300001
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5180803086757061
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   colsample_bynode: 0.8049498325338525
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:40:28,600] [INFO] [<frozen importlib] -   scale_pos_weight: 7.238381262811604
[2025-11-19 09:40:28,671] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:40:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:40:28,583] Trial 455 pruned. 
[0]	train-logloss:0.71199	train-auc:0.64387	train-aucpr:0.24597	val-logloss:0.71209	val-auc:0.58545	val-aucpr:0.11301
[10]	train-logloss:0.68926	train-auc:0.68092	train-aucpr:0.29302	val-logloss:0.66312	val-auc:0.70408	val-aucpr:0.21638
[20]	train-logloss:0.67478	train-auc:0.68551	train-aucpr:0.29882	val-logloss:0.62125	val-auc:0.70428	val-aucpr:0.21673
[30]	train-logloss:0.66477	train-auc:0.69066	train-aucpr:0.30217	val-logloss:0.59483	val-auc:0.70600	val-aucpr:0.22575
[40]	train-logloss:0.65736	train-auc:0.69475	train-aucpr:0.30584	val-logloss:0.56868	val-auc:0.70287	val-aucpr:0.22362
[50]	train-logloss:0.65084	train-auc:0.69926	train-aucpr:0.31068	val-logloss:0.55770	val-auc:0.70381	val-aucpr:0.22430
[60]	train-logloss:0.64621	train-auc:0.70296	train-aucpr:0.31358	val-logloss:0.55280	val-auc:0.70402	val-aucpr:0.22302
[61]	train-logloss:0.64576	train-auc:0.70335	train-aucpr:0.31401	val-logloss:0.55480	val-auc:0.70300	val-aucpr:0.22246
[2025-11-19 09:40:28,888] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 09:40:28,888] [INFO] [<frozen importlib] - Best train loss: 0.6639
[2025-11-19 09:40:28,888] [INFO] [<frozen importlib] - Best val loss: 0.5916
[2025-11-19 09:40:28,888] [INFO] [<frozen importlib] - Best val AUC: 0.7056
[2025-11-19 09:40:28,888] [INFO] [<frozen importlib] - Best val AUCPR: 0.2269
[2025-11-19 09:40:28,892] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:40:28] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:40:34,985] [INFO] [<frozen importlib] - Optimal threshold: 0.5090
[2025-11-19 09:40:34,985] [INFO] [<frozen importlib] - Best f1: 0.2791
[2025-11-19 09:40:34,985] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:40:35,024] [INFO] [<frozen importlib] - Validation Results (threshold=0.5090):
[2025-11-19 09:40:35,024] [INFO] [<frozen importlib] -   Accuracy: 0.8928
[2025-11-19 09:40:35,024] [INFO] [<frozen importlib] -   Precision: 0.2889
[2025-11-19 09:40:35,024] [INFO] [<frozen importlib] -   Recall: 0.2700
[2025-11-19 09:40:35,024] [INFO] [<frozen importlib] -   F1 Score: 0.2791
[2025-11-19 09:40:35,024] [INFO] [<frozen importlib] -   AUROC: 0.7056
[2025-11-19 09:40:35,024] [INFO] [<frozen importlib] -   AUPRC: 0.2271
[2025-11-19 09:40:35,024] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:40:35,024] [INFO] [<frozen importlib] -     TN=16480, FP=965
[2025-11-19 09:40:35,024] [INFO] [<frozen importlib] -     FN=1060, TP=392
[2025-11-19 09:40:35,046] [INFO] [<frozen importlib] - Trial 456: AUPRC=0.2271, F1=0.4491, Prec=0.4204, Rec=0.4821 | Optimizing auprc=0.2271
[2025-11-19 09:40:35,046] [INFO] [<frozen importlib] - Trial 456 pruned.
[2025-11-19 09:40:35,046] [ERROR] [<frozen importlib] - Trial 456 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  91%|█████████ | 456/500 [1:18:33<09:21, 12.76s/it]Best trial: 289. Best value: 0.241792:  91%|█████████ | 456/500 [1:18:33<09:21, 12.76s/it]Best trial: 289. Best value: 0.241792:  91%|█████████▏| 457/500 [1:18:33<07:47, 10.87s/it][2025-11-19 09:40:35,060] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.785897841405334
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   gamma: 0.20986874260940863
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   alpha: 1.3056328846728344
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   lambda: 1.361327082239503
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   learning_rate: 0.03680669735979488
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   subsample: 0.8234031443316893
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   colsample_bytree: 0.6394427008117698
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5285490312657647
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   colsample_bynode: 0.7883793080650541
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:40:35,060] [INFO] [<frozen importlib] -   scale_pos_weight: 6.785897841405334
[2025-11-19 09:40:35,132] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:40:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:40:35,046] Trial 456 pruned. 
[0]	train-logloss:0.68728	train-auc:0.65119	train-aucpr:0.23393	val-logloss:0.68366	val-auc:0.53863	val-aucpr:0.08288
[10]	train-logloss:0.66320	train-auc:0.67949	train-aucpr:0.28851	val-logloss:0.61737	val-auc:0.67349	val-aucpr:0.16711
[20]	train-logloss:0.64801	train-auc:0.68714	train-aucpr:0.29914	val-logloss:0.58130	val-auc:0.68568	val-aucpr:0.18733
[30]	train-logloss:0.63770	train-auc:0.69484	train-aucpr:0.30573	val-logloss:0.56415	val-auc:0.70122	val-aucpr:0.20262
[40]	train-logloss:0.63031	train-auc:0.69826	train-aucpr:0.31034	val-logloss:0.53968	val-auc:0.70237	val-aucpr:0.21005
[50]	train-logloss:0.62466	train-auc:0.70191	train-aucpr:0.31353	val-logloss:0.54191	val-auc:0.69403	val-aucpr:0.20688
[60]	train-logloss:0.62058	train-auc:0.70481	train-aucpr:0.31693	val-logloss:0.53638	val-auc:0.69326	val-aucpr:0.20566
[70]	train-logloss:0.61709	train-auc:0.70770	train-aucpr:0.31983	val-logloss:0.52398	val-auc:0.69117	val-aucpr:0.20112
[74]	train-logloss:0.61580	train-auc:0.70962	train-aucpr:0.32195	val-logloss:0.52429	val-auc:0.69061	val-aucpr:0.19661
[2025-11-19 09:40:35,353] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 09:40:35,353] [INFO] [<frozen importlib] - Best train loss: 0.6277
[2025-11-19 09:40:35,353] [INFO] [<frozen importlib] - Best val loss: 0.5361
[2025-11-19 09:40:35,353] [INFO] [<frozen importlib] - Best val AUC: 0.7004
[2025-11-19 09:40:35,353] [INFO] [<frozen importlib] - Best val AUCPR: 0.2116
[2025-11-19 09:40:35,357] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:40:35] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:40:44,552] [INFO] [<frozen importlib] - Optimal threshold: 0.4902
[2025-11-19 09:40:44,552] [INFO] [<frozen importlib] - Best f1: 0.2672
[2025-11-19 09:40:44,552] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:40:44,604] [INFO] [<frozen importlib] - Validation Results (threshold=0.4902):
[2025-11-19 09:40:44,604] [INFO] [<frozen importlib] -   Accuracy: 0.8911
[2025-11-19 09:40:44,604] [INFO] [<frozen importlib] -   Precision: 0.2768
[2025-11-19 09:40:44,604] [INFO] [<frozen importlib] -   Recall: 0.2583
[2025-11-19 09:40:44,604] [INFO] [<frozen importlib] -   F1 Score: 0.2672
[2025-11-19 09:40:44,604] [INFO] [<frozen importlib] -   AUROC: 0.7004
[2025-11-19 09:40:44,604] [INFO] [<frozen importlib] -   AUPRC: 0.2120
[2025-11-19 09:40:44,604] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:40:44,604] [INFO] [<frozen importlib] -     TN=16465, FP=980
[2025-11-19 09:40:44,604] [INFO] [<frozen importlib] -     FN=1077, TP=375
[2025-11-19 09:40:44,630] [INFO] [<frozen importlib] - Trial 457: AUPRC=0.2120, F1=0.4420, Prec=0.4132, Rec=0.4752 | Optimizing auprc=0.2120
[2025-11-19 09:40:44,631] [INFO] [<frozen importlib] - Trial 457 pruned.
[2025-11-19 09:40:44,631] [ERROR] [<frozen importlib] - Trial 457 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  91%|█████████▏| 457/500 [1:18:42<07:47, 10.87s/it]Best trial: 289. Best value: 0.241792:  91%|█████████▏| 457/500 [1:18:42<07:47, 10.87s/it]Best trial: 289. Best value: 0.241792:  92%|█████████▏| 458/500 [1:18:42<07:20, 10.48s/it][2025-11-19 09:40:44,645] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.411451093938552
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] -   gamma: 0.2302936386497555
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] -   alpha: 0.637066432232545
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] -   lambda: 1.1346716667859957
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] -   learning_rate: 0.034732916428831216
[2025-11-19 09:40:44,645] [INFO] [<frozen importlib] -   subsample: 0.8139191343582436
[2025-11-19 09:40:44,646] [INFO] [<frozen importlib] -   colsample_bytree: 0.604800059671436
[2025-11-19 09:40:44,646] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5081810183254146
[2025-11-19 09:40:44,646] [INFO] [<frozen importlib] -   colsample_bynode: 0.7805837230364451
[2025-11-19 09:40:44,646] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:40:44,646] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:40:44,646] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:40:44,646] [INFO] [<frozen importlib] -   scale_pos_weight: 6.411451093938552
[2025-11-19 09:40:44,730] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:40:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:40:44,631] Trial 457 pruned. 
[0]	train-logloss:0.66699	train-auc:0.64333	train-aucpr:0.25143	val-logloss:0.66171	val-auc:0.58551	val-aucpr:0.11209
[10]	train-logloss:0.64507	train-auc:0.68105	train-aucpr:0.29040	val-logloss:0.60664	val-auc:0.67633	val-aucpr:0.18755
[20]	train-logloss:0.63081	train-auc:0.68748	train-aucpr:0.29910	val-logloss:0.56959	val-auc:0.67063	val-aucpr:0.19946
[30]	train-logloss:0.62113	train-auc:0.69079	train-aucpr:0.30493	val-logloss:0.54016	val-auc:0.69271	val-aucpr:0.21898
[40]	train-logloss:0.61423	train-auc:0.69465	train-aucpr:0.30914	val-logloss:0.51286	val-auc:0.70438	val-aucpr:0.22293
[50]	train-logloss:0.60848	train-auc:0.69761	train-aucpr:0.31202	val-logloss:0.49916	val-auc:0.70554	val-aucpr:0.22284
[60]	train-logloss:0.60459	train-auc:0.70153	train-aucpr:0.31485	val-logloss:0.49266	val-auc:0.70301	val-aucpr:0.22403
[70]	train-logloss:0.60112	train-auc:0.70468	train-aucpr:0.31791	val-logloss:0.48475	val-auc:0.70131	val-aucpr:0.22254
[80]	train-logloss:0.59814	train-auc:0.70912	train-aucpr:0.32167	val-logloss:0.48454	val-auc:0.69886	val-aucpr:0.21882
[86]	train-logloss:0.59634	train-auc:0.71116	train-aucpr:0.32398	val-logloss:0.48014	val-auc:0.69646	val-aucpr:0.20828
[2025-11-19 09:40:44,985] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:40:44,985] [INFO] [<frozen importlib] - Best train loss: 0.6061
[2025-11-19 09:40:44,985] [INFO] [<frozen importlib] - Best val loss: 0.4929
[2025-11-19 09:40:44,985] [INFO] [<frozen importlib] - Best val AUC: 0.7069
[2025-11-19 09:40:44,985] [INFO] [<frozen importlib] - Best val AUCPR: 0.2278
[2025-11-19 09:40:44,990] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:40:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:40:57,274] [INFO] [<frozen importlib] - Optimal threshold: 0.4682
[2025-11-19 09:40:57,274] [INFO] [<frozen importlib] - Best f1: 0.2738
[2025-11-19 09:40:57,274] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:40:57,316] [INFO] [<frozen importlib] - Validation Results (threshold=0.4682):
[2025-11-19 09:40:57,316] [INFO] [<frozen importlib] -   Accuracy: 0.8944
[2025-11-19 09:40:57,317] [INFO] [<frozen importlib] -   Precision: 0.2903
[2025-11-19 09:40:57,317] [INFO] [<frozen importlib] -   Recall: 0.2590
[2025-11-19 09:40:57,317] [INFO] [<frozen importlib] -   F1 Score: 0.2738
[2025-11-19 09:40:57,317] [INFO] [<frozen importlib] -   AUROC: 0.7069
[2025-11-19 09:40:57,317] [INFO] [<frozen importlib] -   AUPRC: 0.2282
[2025-11-19 09:40:57,317] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:40:57,317] [INFO] [<frozen importlib] -     TN=16526, FP=919
[2025-11-19 09:40:57,317] [INFO] [<frozen importlib] -     FN=1076, TP=376
[2025-11-19 09:40:57,340] [INFO] [<frozen importlib] - Trial 458: AUPRC=0.2282, F1=0.4488, Prec=0.4274, Rec=0.4725 | Optimizing auprc=0.2282
[2025-11-19 09:40:57,340] [INFO] [<frozen importlib] - Trial 458 pruned.
[2025-11-19 09:40:57,340] [ERROR] [<frozen importlib] - Trial 458 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  92%|█████████▏| 458/500 [1:18:55<07:20, 10.48s/it]Best trial: 289. Best value: 0.241792:  92%|█████████▏| 458/500 [1:18:55<07:20, 10.48s/it]Best trial: 289. Best value: 0.241792:  92%|█████████▏| 459/500 [1:18:55<07:37, 11.15s/it][2025-11-19 09:40:57,357] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.968218130081122
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   min_child_weight: 10
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   gamma: 0.16463709796842801
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   alpha: 1.1929471214108316
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   lambda: 0.6930063647417651
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   learning_rate: 0.0378878187288985
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   subsample: 0.8335033897389663
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   colsample_bytree: 0.5877175963178117
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5195101283126337
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   colsample_bynode: 0.839798522130926
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:40:57,357] [INFO] [<frozen importlib] -   scale_pos_weight: 6.968218130081122
[2025-11-19 09:40:57,434] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:40:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:40:57,340] Trial 458 pruned. 
[0]	train-logloss:0.69687	train-auc:0.64870	train-aucpr:0.24365	val-logloss:0.69268	val-auc:0.62987	val-aucpr:0.13446
[10]	train-logloss:0.67159	train-auc:0.68192	train-aucpr:0.29083	val-logloss:0.63444	val-auc:0.68331	val-aucpr:0.18361
[20]	train-logloss:0.65665	train-auc:0.68744	train-aucpr:0.30014	val-logloss:0.59839	val-auc:0.68669	val-aucpr:0.20714
[30]	train-logloss:0.64641	train-auc:0.69320	train-aucpr:0.30456	val-logloss:0.57246	val-auc:0.69700	val-aucpr:0.21849
[40]	train-logloss:0.63927	train-auc:0.69766	train-aucpr:0.30802	val-logloss:0.55147	val-auc:0.70063	val-aucpr:0.21989
[50]	train-logloss:0.63308	train-auc:0.70230	train-aucpr:0.31364	val-logloss:0.54627	val-auc:0.69736	val-aucpr:0.22152
[60]	train-logloss:0.62866	train-auc:0.70611	train-aucpr:0.31788	val-logloss:0.54092	val-auc:0.69313	val-aucpr:0.21486
[70]	train-logloss:0.62554	train-auc:0.70836	train-aucpr:0.32124	val-logloss:0.53913	val-auc:0.68807	val-aucpr:0.21094
[77]	train-logloss:0.62353	train-auc:0.71029	train-aucpr:0.32299	val-logloss:0.52827	val-auc:0.68984	val-aucpr:0.21358
[2025-11-19 09:40:57,669] [INFO] [<frozen importlib] - Training completed at iteration 48
[2025-11-19 09:40:57,669] [INFO] [<frozen importlib] - Best train loss: 0.6341
[2025-11-19 09:40:57,669] [INFO] [<frozen importlib] - Best val loss: 0.5480
[2025-11-19 09:40:57,669] [INFO] [<frozen importlib] - Best val AUC: 0.6993
[2025-11-19 09:40:57,669] [INFO] [<frozen importlib] - Best val AUCPR: 0.2230
[2025-11-19 09:40:57,674] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:40:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:41:07,507] [INFO] [<frozen importlib] - Optimal threshold: 0.5029
[2025-11-19 09:41:07,507] [INFO] [<frozen importlib] - Best f1: 0.2652
[2025-11-19 09:41:07,507] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:41:07,556] [INFO] [<frozen importlib] - Validation Results (threshold=0.5029):
[2025-11-19 09:41:07,556] [INFO] [<frozen importlib] -   Accuracy: 0.8956
[2025-11-19 09:41:07,556] [INFO] [<frozen importlib] -   Precision: 0.2887
[2025-11-19 09:41:07,556] [INFO] [<frozen importlib] -   Recall: 0.2452
[2025-11-19 09:41:07,556] [INFO] [<frozen importlib] -   F1 Score: 0.2652
[2025-11-19 09:41:07,556] [INFO] [<frozen importlib] -   AUROC: 0.6993
[2025-11-19 09:41:07,556] [INFO] [<frozen importlib] -   AUPRC: 0.2234
[2025-11-19 09:41:07,556] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:41:07,556] [INFO] [<frozen importlib] -     TN=16568, FP=877
[2025-11-19 09:41:07,556] [INFO] [<frozen importlib] -     FN=1096, TP=356
[2025-11-19 09:41:07,581] [INFO] [<frozen importlib] - Trial 459: AUPRC=0.2234, F1=0.4535, Prec=0.4378, Rec=0.4704 | Optimizing auprc=0.2234
[2025-11-19 09:41:07,581] [INFO] [<frozen importlib] - Trial 459 pruned.
[2025-11-19 09:41:07,581] [ERROR] [<frozen importlib] - Trial 459 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  92%|█████████▏| 459/500 [1:19:05<07:37, 11.15s/it]Best trial: 289. Best value: 0.241792:  92%|█████████▏| 459/500 [1:19:05<07:37, 11.15s/it]Best trial: 289. Best value: 0.241792:  92%|█████████▏| 460/500 [1:19:05<07:15, 10.88s/it][2025-11-19 09:41:07,596] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.480084612840481
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   gamma: 0.11787545800397609
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   alpha: 0.4237663675452702
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   lambda: 1.27989281973489
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   learning_rate: 0.03137711002817835
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   subsample: 0.8045803568919359
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   colsample_bytree: 0.5783133243183429
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5387386225819525
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   colsample_bynode: 0.8131587510261694
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:41:07,596] [INFO] [<frozen importlib] -   scale_pos_weight: 7.480084612840481
[2025-11-19 09:41:07,673] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:41:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:41:07,581] Trial 459 pruned. 
[0]	train-logloss:0.72496	train-auc:0.64347	train-aucpr:0.22189	val-logloss:0.72492	val-auc:0.63929	val-aucpr:0.13806
[10]	train-logloss:0.70187	train-auc:0.68263	train-aucpr:0.28922	val-logloss:0.66888	val-auc:0.71051	val-aucpr:0.22827
[20]	train-logloss:0.68697	train-auc:0.68798	train-aucpr:0.29679	val-logloss:0.63480	val-auc:0.71409	val-aucpr:0.22908
[30]	train-logloss:0.67607	train-auc:0.69318	train-aucpr:0.30127	val-logloss:0.60534	val-auc:0.71090	val-aucpr:0.22792
[40]	train-logloss:0.66840	train-auc:0.69686	train-aucpr:0.30528	val-logloss:0.58274	val-auc:0.70771	val-aucpr:0.22735
[44]	train-logloss:0.66536	train-auc:0.69831	train-aucpr:0.30772	val-logloss:0.57332	val-auc:0.70676	val-aucpr:0.22947
[2025-11-19 09:41:07,823] [INFO] [<frozen importlib] - Training completed at iteration 14
[2025-11-19 09:41:07,823] [INFO] [<frozen importlib] - Best train loss: 0.6954
[2025-11-19 09:41:07,823] [INFO] [<frozen importlib] - Best val loss: 0.6543
[2025-11-19 09:41:07,823] [INFO] [<frozen importlib] - Best val AUC: 0.7127
[2025-11-19 09:41:07,823] [INFO] [<frozen importlib] - Best val AUCPR: 0.2317
[2025-11-19 09:41:07,828] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:41:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:41:11,041] [INFO] [<frozen importlib] - Optimal threshold: 0.5219
[2025-11-19 09:41:11,041] [INFO] [<frozen importlib] - Best f1: 0.2768
[2025-11-19 09:41:11,041] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:41:11,087] [INFO] [<frozen importlib] - Validation Results (threshold=0.5219):
[2025-11-19 09:41:11,088] [INFO] [<frozen importlib] -   Accuracy: 0.8996
[2025-11-19 09:41:11,088] [INFO] [<frozen importlib] -   Precision: 0.3100
[2025-11-19 09:41:11,088] [INFO] [<frozen importlib] -   Recall: 0.2500
[2025-11-19 09:41:11,088] [INFO] [<frozen importlib] -   F1 Score: 0.2768
[2025-11-19 09:41:11,088] [INFO] [<frozen importlib] -   AUROC: 0.7127
[2025-11-19 09:41:11,088] [INFO] [<frozen importlib] -   AUPRC: 0.2312
[2025-11-19 09:41:11,088] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:41:11,088] [INFO] [<frozen importlib] -     TN=16637, FP=808
[2025-11-19 09:41:11,088] [INFO] [<frozen importlib] -     FN=1089, TP=363
[2025-11-19 09:41:11,111] [INFO] [<frozen importlib] - Trial 460: AUPRC=0.2312, F1=0.4563, Prec=0.4526, Rec=0.4601 | Optimizing auprc=0.2312
                                                                                          Best trial: 289. Best value: 0.241792:  92%|█████████▏| 460/500 [1:19:09<07:15, 10.88s/it]Best trial: 289. Best value: 0.241792:  92%|█████████▏| 460/500 [1:19:09<07:15, 10.88s/it]Best trial: 289. Best value: 0.241792:  92%|█████████▏| 461/500 [1:19:09<05:38,  8.67s/it][2025-11-19 09:41:11,127] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.542250692438066
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   min_child_weight: 10
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   gamma: 0.18389414213467176
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   alpha: 1.938420577597874
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   lambda: 1.2041103138715281
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   learning_rate: 0.0339317061660548
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   subsample: 0.8261109390816236
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   colsample_bytree: 0.5575062093395102
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5083282799452057
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   colsample_bynode: 0.796060110383263
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:41:11,127] [INFO] [<frozen importlib] -   scale_pos_weight: 6.542250692438066
[2025-11-19 09:41:11,200] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:41:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:41:11,112] Trial 460 finished with value: 0.2311659762716132 and parameters: {'max_depth': 4, 'min_child_weight': 6, 'gamma': 0.11787545800397609, 'learning_rate': 0.03137711002817835, 'n_estimators': 350, 'alpha': 0.4237663675452702, 'lambda': 1.27989281973489, 'subsample': 0.8045803568919359, 'colsample_bytree': 0.5783133243183429, 'colsample_bylevel': 0.5387386225819525, 'colsample_bynode': 0.8131587510261694, 'scale_pos_weight': 7.480084612840481}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.67453	train-auc:0.63546	train-aucpr:0.23410	val-logloss:0.67033	val-auc:0.61603	val-aucpr:0.12855
[10]	train-logloss:0.65289	train-auc:0.68004	train-aucpr:0.28566	val-logloss:0.61748	val-auc:0.69297	val-aucpr:0.20901
[20]	train-logloss:0.63920	train-auc:0.68381	train-aucpr:0.29446	val-logloss:0.58859	val-auc:0.69870	val-aucpr:0.21235
[30]	train-logloss:0.62941	train-auc:0.69071	train-aucpr:0.30066	val-logloss:0.55991	val-auc:0.69966	val-aucpr:0.22298
[40]	train-logloss:0.62195	train-auc:0.69615	train-aucpr:0.30575	val-logloss:0.54701	val-auc:0.69964	val-aucpr:0.22354
[50]	train-logloss:0.61590	train-auc:0.70095	train-aucpr:0.30993	val-logloss:0.53184	val-auc:0.69862	val-aucpr:0.22029
[60]	train-logloss:0.61144	train-auc:0.70382	train-aucpr:0.31411	val-logloss:0.52105	val-auc:0.69906	val-aucpr:0.21702
[68]	train-logloss:0.60858	train-auc:0.70611	train-aucpr:0.31721	val-logloss:0.51160	val-auc:0.70047	val-aucpr:0.21922
[2025-11-19 09:41:11,431] [INFO] [<frozen importlib] - Training completed at iteration 38
[2025-11-19 09:41:11,431] [INFO] [<frozen importlib] - Best train loss: 0.6233
[2025-11-19 09:41:11,431] [INFO] [<frozen importlib] - Best val loss: 0.5466
[2025-11-19 09:41:11,431] [INFO] [<frozen importlib] - Best val AUC: 0.6986
[2025-11-19 09:41:11,431] [INFO] [<frozen importlib] - Best val AUCPR: 0.2240
[2025-11-19 09:41:11,434] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:41:11] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:41:19,405] [INFO] [<frozen importlib] - Optimal threshold: 0.4862
[2025-11-19 09:41:19,405] [INFO] [<frozen importlib] - Best f1: 0.2586
[2025-11-19 09:41:19,406] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:41:19,462] [INFO] [<frozen importlib] - Validation Results (threshold=0.4862):
[2025-11-19 09:41:19,462] [INFO] [<frozen importlib] -   Accuracy: 0.8832
[2025-11-19 09:41:19,462] [INFO] [<frozen importlib] -   Precision: 0.2523
[2025-11-19 09:41:19,462] [INFO] [<frozen importlib] -   Recall: 0.2652
[2025-11-19 09:41:19,462] [INFO] [<frozen importlib] -   F1 Score: 0.2586
[2025-11-19 09:41:19,462] [INFO] [<frozen importlib] -   AUROC: 0.6986
[2025-11-19 09:41:19,462] [INFO] [<frozen importlib] -   AUPRC: 0.2243
[2025-11-19 09:41:19,462] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:41:19,462] [INFO] [<frozen importlib] -     TN=16304, FP=1141
[2025-11-19 09:41:19,462] [INFO] [<frozen importlib] -     FN=1067, TP=385
[2025-11-19 09:41:19,487] [INFO] [<frozen importlib] - Trial 461: AUPRC=0.2243, F1=0.4351, Prec=0.3872, Rec=0.4966 | Optimizing auprc=0.2243
                                                                                          Best trial: 289. Best value: 0.241792:  92%|█████████▏| 461/500 [1:19:17<05:38,  8.67s/it]Best trial: 289. Best value: 0.241792:  92%|█████████▏| 461/500 [1:19:17<05:38,  8.67s/it]Best trial: 289. Best value: 0.241792:  92%|█████████▏| 462/500 [1:19:17<05:26,  8.58s/it][2025-11-19 09:41:19,503] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.328562239846747
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   gamma: 0.2020484471995987
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   alpha: 1.6354243107868403
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   lambda: 0.9206923414085566
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   learning_rate: 0.03283614588312741
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   subsample: 0.8510130523487425
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   colsample_bytree: 0.5939548161817053
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5001466633270945
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   colsample_bynode: 0.7785380175437637
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:41:19,503] [INFO] [<frozen importlib] -   scale_pos_weight: 6.328562239846747
[2025-11-19 09:41:19,581] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:41:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:41:19,488] Trial 461 finished with value: 0.2242577335302256 and parameters: {'max_depth': 4, 'min_child_weight': 10, 'gamma': 0.18389414213467176, 'learning_rate': 0.0339317061660548, 'n_estimators': 300, 'alpha': 1.938420577597874, 'lambda': 1.2041103138715281, 'subsample': 0.8261109390816236, 'colsample_bytree': 0.5575062093395102, 'colsample_bylevel': 0.5083282799452057, 'colsample_bynode': 0.796060110383263, 'scale_pos_weight': 6.542250692438066}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.66295	train-auc:0.63744	train-aucpr:0.22130	val-logloss:0.65607	val-auc:0.60563	val-aucpr:0.12694
[10]	train-logloss:0.64205	train-auc:0.68109	train-aucpr:0.28936	val-logloss:0.61377	val-auc:0.67356	val-aucpr:0.18814
[20]	train-logloss:0.62863	train-auc:0.68683	train-aucpr:0.29689	val-logloss:0.58096	val-auc:0.68360	val-aucpr:0.20598
[30]	train-logloss:0.61866	train-auc:0.69084	train-aucpr:0.30494	val-logloss:0.54725	val-auc:0.68827	val-aucpr:0.22091
[40]	train-logloss:0.61158	train-auc:0.69604	train-aucpr:0.30778	val-logloss:0.52093	val-auc:0.71012	val-aucpr:0.22963
[50]	train-logloss:0.60589	train-auc:0.69957	train-aucpr:0.31079	val-logloss:0.51030	val-auc:0.70847	val-aucpr:0.23087
[60]	train-logloss:0.60141	train-auc:0.70307	train-aucpr:0.31447	val-logloss:0.50159	val-auc:0.71033	val-aucpr:0.23109
[70]	train-logloss:0.59812	train-auc:0.70592	train-aucpr:0.31757	val-logloss:0.49973	val-auc:0.71337	val-aucpr:0.23296
[75]	train-logloss:0.59684	train-auc:0.70712	train-aucpr:0.31895	val-logloss:0.49787	val-auc:0.71254	val-aucpr:0.23257
[2025-11-19 09:41:19,823] [INFO] [<frozen importlib] - Training completed at iteration 46
[2025-11-19 09:41:19,823] [INFO] [<frozen importlib] - Best train loss: 0.6079
[2025-11-19 09:41:19,823] [INFO] [<frozen importlib] - Best val loss: 0.5108
[2025-11-19 09:41:19,823] [INFO] [<frozen importlib] - Best val AUC: 0.7189
[2025-11-19 09:41:19,823] [INFO] [<frozen importlib] - Best val AUCPR: 0.2340
[2025-11-19 09:41:19,828] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:41:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:41:30,014] [INFO] [<frozen importlib] - Optimal threshold: 0.4571
[2025-11-19 09:41:30,015] [INFO] [<frozen importlib] - Best f1: 0.2829
[2025-11-19 09:41:30,015] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:41:30,067] [INFO] [<frozen importlib] - Validation Results (threshold=0.4571):
[2025-11-19 09:41:30,067] [INFO] [<frozen importlib] -   Accuracy: 0.8911
[2025-11-19 09:41:30,067] [INFO] [<frozen importlib] -   Precision: 0.2863
[2025-11-19 09:41:30,067] [INFO] [<frozen importlib] -   Recall: 0.2796
[2025-11-19 09:41:30,067] [INFO] [<frozen importlib] -   F1 Score: 0.2829
[2025-11-19 09:41:30,067] [INFO] [<frozen importlib] -   AUROC: 0.7189
[2025-11-19 09:41:30,067] [INFO] [<frozen importlib] -   AUPRC: 0.2343
[2025-11-19 09:41:30,067] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:41:30,067] [INFO] [<frozen importlib] -     TN=16433, FP=1012
[2025-11-19 09:41:30,067] [INFO] [<frozen importlib] -     FN=1046, TP=406
[2025-11-19 09:41:30,092] [INFO] [<frozen importlib] - Trial 462: AUPRC=0.2343, F1=0.4449, Prec=0.4106, Rec=0.4855 | Optimizing auprc=0.2343
                                                                                          Best trial: 289. Best value: 0.241792:  92%|█████████▏| 462/500 [1:19:28<05:26,  8.58s/it]Best trial: 289. Best value: 0.241792:  92%|█████████▏| 462/500 [1:19:28<05:26,  8.58s/it]Best trial: 289. Best value: 0.241792:  93%|█████████▎| 463/500 [1:19:28<05:40,  9.19s/it][2025-11-19 09:41:30,118] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.711076807324362
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   gamma: 0.14986382465342388
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   alpha: 1.2401177318790606
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   lambda: 0.7973545930901854
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   learning_rate: 0.03609235506838428
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   subsample: 0.7978192982174811
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   colsample_bytree: 0.5996852524414921
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5542996847270126
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   colsample_bynode: 0.8573625535866497
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:41:30,118] [INFO] [<frozen importlib] -   scale_pos_weight: 6.711076807324362
[2025-11-19 09:41:30,200] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:41:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:41:30,093] Trial 462 finished with value: 0.23433494681417674 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.2020484471995987, 'learning_rate': 0.03283614588312741, 'n_estimators': 350, 'alpha': 1.6354243107868403, 'lambda': 0.9206923414085566, 'subsample': 0.8510130523487425, 'colsample_bytree': 0.5939548161817053, 'colsample_bylevel': 0.5001466633270945, 'colsample_bynode': 0.7785380175437637, 'scale_pos_weight': 6.328562239846747}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.68383	train-auc:0.63129	train-aucpr:0.21823	val-logloss:0.67937	val-auc:0.64764	val-aucpr:0.15194
[10]	train-logloss:0.65980	train-auc:0.68402	train-aucpr:0.28566	val-logloss:0.62968	val-auc:0.67229	val-aucpr:0.19980
[20]	train-logloss:0.64498	train-auc:0.68912	train-aucpr:0.29795	val-logloss:0.59362	val-auc:0.70415	val-aucpr:0.21802
[30]	train-logloss:0.63435	train-auc:0.69466	train-aucpr:0.30391	val-logloss:0.56305	val-auc:0.70175	val-aucpr:0.22273
[40]	train-logloss:0.62735	train-auc:0.69893	train-aucpr:0.30841	val-logloss:0.54081	val-auc:0.70927	val-aucpr:0.22761
[50]	train-logloss:0.62137	train-auc:0.70338	train-aucpr:0.31296	val-logloss:0.51964	val-auc:0.70882	val-aucpr:0.22892
[60]	train-logloss:0.61696	train-auc:0.70675	train-aucpr:0.31728	val-logloss:0.51092	val-auc:0.70966	val-aucpr:0.23090
[70]	train-logloss:0.61363	train-auc:0.70992	train-aucpr:0.32030	val-logloss:0.50241	val-auc:0.71045	val-aucpr:0.22999
[80]	train-logloss:0.61084	train-auc:0.71255	train-aucpr:0.32351	val-logloss:0.49050	val-auc:0.71144	val-aucpr:0.22928
[90]	train-logloss:0.60795	train-auc:0.71691	train-aucpr:0.32786	val-logloss:0.48399	val-auc:0.71044	val-aucpr:0.22635
[100]	train-logloss:0.60537	train-auc:0.72131	train-aucpr:0.33178	val-logloss:0.46953	val-auc:0.70304	val-aucpr:0.21929
[105]	train-logloss:0.60399	train-auc:0.72292	train-aucpr:0.33427	val-logloss:0.46830	val-auc:0.70484	val-aucpr:0.22221
[2025-11-19 09:41:33,005] [INFO] [<frozen importlib] - Training completed at iteration 76
[2025-11-19 09:41:33,005] [INFO] [<frozen importlib] - Best train loss: 0.6121
[2025-11-19 09:41:33,005] [INFO] [<frozen importlib] - Best val loss: 0.4979
[2025-11-19 09:41:33,005] [INFO] [<frozen importlib] - Best val AUC: 0.7106
[2025-11-19 09:41:33,005] [INFO] [<frozen importlib] - Best val AUCPR: 0.2326
[2025-11-19 09:41:33,008] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:41:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:41:47,190] [INFO] [<frozen importlib] - Optimal threshold: 0.4848
[2025-11-19 09:41:47,190] [INFO] [<frozen importlib] - Best f1: 0.2896
[2025-11-19 09:41:47,190] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:41:47,244] [INFO] [<frozen importlib] - Validation Results (threshold=0.4848):
[2025-11-19 09:41:47,244] [INFO] [<frozen importlib] -   Accuracy: 0.9016
[2025-11-19 09:41:47,244] [INFO] [<frozen importlib] -   Precision: 0.3253
[2025-11-19 09:41:47,244] [INFO] [<frozen importlib] -   Recall: 0.2610
[2025-11-19 09:41:47,244] [INFO] [<frozen importlib] -   F1 Score: 0.2896
[2025-11-19 09:41:47,244] [INFO] [<frozen importlib] -   AUROC: 0.7106
[2025-11-19 09:41:47,244] [INFO] [<frozen importlib] -   AUPRC: 0.2330
[2025-11-19 09:41:47,244] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:41:47,244] [INFO] [<frozen importlib] -     TN=16659, FP=786
[2025-11-19 09:41:47,244] [INFO] [<frozen importlib] -     FN=1073, TP=379
[2025-11-19 09:41:47,274] [INFO] [<frozen importlib] - Trial 463: AUPRC=0.2330, F1=0.4650, Prec=0.4631, Rec=0.4669 | Optimizing auprc=0.2330
                                                                                          Best trial: 289. Best value: 0.241792:  93%|█████████▎| 463/500 [1:19:45<05:40,  9.19s/it]Best trial: 289. Best value: 0.241792:  93%|█████████▎| 463/500 [1:19:45<05:40,  9.19s/it]Best trial: 289. Best value: 0.241792:  93%|█████████▎| 464/500 [1:19:45<06:57, 11.59s/it][2025-11-19 09:41:47,288] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.116669555218222
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   gamma: 0.22423689171296668
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   alpha: 1.3848412473166867
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   lambda: 1.0789274010681802
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   learning_rate: 0.038496529373107324
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   subsample: 0.8162048923608982
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   colsample_bytree: 0.572641424057991
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5272598947178128
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   colsample_bynode: 0.8083379414250177
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:41:47,288] [INFO] [<frozen importlib] -   scale_pos_weight: 7.116669555218222
[2025-11-19 09:41:47,358] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:41:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:41:47,275] Trial 463 finished with value: 0.2330219391447512 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.14986382465342388, 'learning_rate': 0.03609235506838428, 'n_estimators': 450, 'alpha': 1.2401177318790606, 'lambda': 0.7973545930901854, 'subsample': 0.7978192982174811, 'colsample_bytree': 0.5996852524414921, 'colsample_bylevel': 0.5542996847270126, 'colsample_bynode': 0.8573625535866497, 'scale_pos_weight': 6.711076807324362}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.70508	train-auc:0.64398	train-aucpr:0.22305	val-logloss:0.70204	val-auc:0.63862	val-aucpr:0.13698
[10]	train-logloss:0.67935	train-auc:0.68155	train-aucpr:0.28758	val-logloss:0.63365	val-auc:0.67982	val-aucpr:0.18875
[20]	train-logloss:0.66393	train-auc:0.68777	train-aucpr:0.29705	val-logloss:0.60035	val-auc:0.68974	val-aucpr:0.20357
[30]	train-logloss:0.65328	train-auc:0.69369	train-aucpr:0.30347	val-logloss:0.56732	val-auc:0.69078	val-aucpr:0.21492
[40]	train-logloss:0.64631	train-auc:0.69662	train-aucpr:0.30628	val-logloss:0.55789	val-auc:0.69619	val-aucpr:0.21284
[50]	train-logloss:0.63997	train-auc:0.70215	train-aucpr:0.31181	val-logloss:0.53732	val-auc:0.69729	val-aucpr:0.21339
[57]	train-logloss:0.63621	train-auc:0.70670	train-aucpr:0.31610	val-logloss:0.54095	val-auc:0.69975	val-aucpr:0.21020
[2025-11-19 09:41:48,253] [INFO] [<frozen importlib] - Training completed at iteration 27
[2025-11-19 09:41:48,253] [INFO] [<frozen importlib] - Best train loss: 0.6561
[2025-11-19 09:41:48,253] [INFO] [<frozen importlib] - Best val loss: 0.5792
[2025-11-19 09:41:48,253] [INFO] [<frozen importlib] - Best val AUC: 0.6945
[2025-11-19 09:41:48,253] [INFO] [<frozen importlib] - Best val AUCPR: 0.2160
[2025-11-19 09:41:48,256] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:41:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:41:54,621] [INFO] [<frozen importlib] - Optimal threshold: 0.5113
[2025-11-19 09:41:54,621] [INFO] [<frozen importlib] - Best f1: 0.2585
[2025-11-19 09:41:54,621] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:41:54,679] [INFO] [<frozen importlib] - Validation Results (threshold=0.5113):
[2025-11-19 09:41:54,679] [INFO] [<frozen importlib] -   Accuracy: 0.9019
[2025-11-19 09:41:54,679] [INFO] [<frozen importlib] -   Precision: 0.3085
[2025-11-19 09:41:54,679] [INFO] [<frozen importlib] -   Recall: 0.2225
[2025-11-19 09:41:54,679] [INFO] [<frozen importlib] -   F1 Score: 0.2585
[2025-11-19 09:41:54,679] [INFO] [<frozen importlib] -   AUROC: 0.6945
[2025-11-19 09:41:54,679] [INFO] [<frozen importlib] -   AUPRC: 0.2163
[2025-11-19 09:41:54,679] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:41:54,679] [INFO] [<frozen importlib] -     TN=16721, FP=724
[2025-11-19 09:41:54,679] [INFO] [<frozen importlib] -     FN=1129, TP=323
[2025-11-19 09:41:54,706] [INFO] [<frozen importlib] - Trial 464: AUPRC=0.2163, F1=0.4518, Prec=0.4673, Rec=0.4373 | Optimizing auprc=0.2163
                                                                                          Best trial: 289. Best value: 0.241792:  93%|█████████▎| 464/500 [1:19:52<06:57, 11.59s/it]Best trial: 289. Best value: 0.241792:  93%|█████████▎| 464/500 [1:19:52<06:57, 11.59s/it]Best trial: 289. Best value: 0.241792:  93%|█████████▎| 465/500 [1:19:52<06:01, 10.34s/it][2025-11-19 09:41:54,725] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.052640122901357
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   gamma: 0.18060675653522457
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   alpha: 1.719758935551716
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   lambda: 1.4249343894162472
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   learning_rate: 0.030105460687587262
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   subsample: 0.8349755209949997
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   colsample_bytree: 0.609515277048646
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   colsample_bylevel: 0.517400137246256
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   colsample_bynode: 0.7920135816639852
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:41:54,726] [INFO] [<frozen importlib] -   scale_pos_weight: 6.052640122901357
[2025-11-19 09:41:54,807] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:41:54] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:41:54,706] Trial 464 finished with value: 0.21625792709384375 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.22423689171296668, 'learning_rate': 0.038496529373107324, 'n_estimators': 450, 'alpha': 1.3848412473166867, 'lambda': 1.0789274010681802, 'subsample': 0.8162048923608982, 'colsample_bytree': 0.572641424057991, 'colsample_bylevel': 0.5272598947178128, 'colsample_bynode': 0.8083379414250177, 'scale_pos_weight': 7.116669555218222}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.64745	train-auc:0.64267	train-aucpr:0.24770	val-logloss:0.63905	val-auc:0.58317	val-aucpr:0.11298
[10]	train-logloss:0.62856	train-auc:0.68071	train-aucpr:0.29284	val-logloss:0.59546	val-auc:0.70349	val-aucpr:0.21614
[20]	train-logloss:0.61596	train-auc:0.68389	train-aucpr:0.29761	val-logloss:0.56084	val-auc:0.70130	val-aucpr:0.21669
[30]	train-logloss:0.60701	train-auc:0.68880	train-aucpr:0.30171	val-logloss:0.53502	val-auc:0.70706	val-aucpr:0.22487
[40]	train-logloss:0.60011	train-auc:0.69272	train-aucpr:0.30550	val-logloss:0.50906	val-auc:0.70466	val-aucpr:0.22335
[50]	train-logloss:0.59430	train-auc:0.69649	train-aucpr:0.30960	val-logloss:0.49619	val-auc:0.70183	val-aucpr:0.22580
[60]	train-logloss:0.59015	train-auc:0.70057	train-aucpr:0.31264	val-logloss:0.48963	val-auc:0.70275	val-aucpr:0.22152
[70]	train-logloss:0.58653	train-auc:0.70269	train-aucpr:0.31539	val-logloss:0.48581	val-auc:0.70386	val-aucpr:0.22481
[80]	train-logloss:0.58350	train-auc:0.70588	train-aucpr:0.31892	val-logloss:0.47550	val-auc:0.70570	val-aucpr:0.22421
[81]	train-logloss:0.58329	train-auc:0.70601	train-aucpr:0.31915	val-logloss:0.47535	val-auc:0.70568	val-aucpr:0.22524
[2025-11-19 09:41:55,986] [INFO] [<frozen importlib] - Training completed at iteration 52
[2025-11-19 09:41:55,986] [INFO] [<frozen importlib] - Best train loss: 0.5934
[2025-11-19 09:41:55,986] [INFO] [<frozen importlib] - Best val loss: 0.4945
[2025-11-19 09:41:55,986] [INFO] [<frozen importlib] - Best val AUC: 0.7032
[2025-11-19 09:41:55,986] [INFO] [<frozen importlib] - Best val AUCPR: 0.2279
[2025-11-19 09:41:55,990] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:41:56] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:42:07,524] [INFO] [<frozen importlib] - Optimal threshold: 0.4569
[2025-11-19 09:42:07,524] [INFO] [<frozen importlib] - Best f1: 0.2762
[2025-11-19 09:42:07,524] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:42:07,570] [INFO] [<frozen importlib] - Validation Results (threshold=0.4569):
[2025-11-19 09:42:07,570] [INFO] [<frozen importlib] -   Accuracy: 0.8965
[2025-11-19 09:42:07,570] [INFO] [<frozen importlib] -   Precision: 0.2986
[2025-11-19 09:42:07,570] [INFO] [<frozen importlib] -   Recall: 0.2569
[2025-11-19 09:42:07,570] [INFO] [<frozen importlib] -   F1 Score: 0.2762
[2025-11-19 09:42:07,570] [INFO] [<frozen importlib] -   AUROC: 0.7032
[2025-11-19 09:42:07,570] [INFO] [<frozen importlib] -   AUPRC: 0.2282
[2025-11-19 09:42:07,570] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:42:07,570] [INFO] [<frozen importlib] -     TN=16569, FP=876
[2025-11-19 09:42:07,570] [INFO] [<frozen importlib] -     FN=1079, TP=373
[2025-11-19 09:42:07,592] [INFO] [<frozen importlib] - Trial 465: AUPRC=0.2282, F1=0.4511, Prec=0.4363, Rec=0.4669 | Optimizing auprc=0.2282
[2025-11-19 09:42:07,592] [INFO] [<frozen importlib] - Trial 465 pruned.
[2025-11-19 09:42:07,592] [ERROR] [<frozen importlib] - Trial 465 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  93%|█████████▎| 465/500 [1:20:05<06:01, 10.34s/it]Best trial: 289. Best value: 0.241792:  93%|█████████▎| 465/500 [1:20:05<06:01, 10.34s/it]Best trial: 289. Best value: 0.241792:  93%|█████████▎| 466/500 [1:20:05<06:17, 11.10s/it][2025-11-19 09:42:07,606] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.238801351782489
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   gamma: 0.12885031538401795
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   alpha: 0.4010514619109259
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   lambda: 0.9594739520389871
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   learning_rate: 0.042146968209473085
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   subsample: 0.8233888207083117
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   colsample_bytree: 0.5859240998549385
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5332692811122173
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   colsample_bynode: 0.7755586231478422
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:42:07,606] [INFO] [<frozen importlib] -   scale_pos_weight: 6.238801351782489
[2025-11-19 09:42:07,681] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:42:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:42:07,592] Trial 465 pruned. 
[0]	train-logloss:0.65708	train-auc:0.63751	train-aucpr:0.22657	val-logloss:0.64905	val-auc:0.60548	val-aucpr:0.11003
[10]	train-logloss:0.63200	train-auc:0.68202	train-aucpr:0.28816	val-logloss:0.59772	val-auc:0.65578	val-aucpr:0.16998
[20]	train-logloss:0.61690	train-auc:0.68996	train-aucpr:0.30300	val-logloss:0.55713	val-auc:0.68290	val-aucpr:0.20216
[30]	train-logloss:0.60750	train-auc:0.69576	train-aucpr:0.30718	val-logloss:0.53193	val-auc:0.68536	val-aucpr:0.21425
[40]	train-logloss:0.60076	train-auc:0.70117	train-aucpr:0.31039	val-logloss:0.52113	val-auc:0.69771	val-aucpr:0.21684
[50]	train-logloss:0.59532	train-auc:0.70580	train-aucpr:0.31490	val-logloss:0.51887	val-auc:0.70678	val-aucpr:0.22499
[60]	train-logloss:0.59132	train-auc:0.70961	train-aucpr:0.31960	val-logloss:0.50831	val-auc:0.70612	val-aucpr:0.22401
[70]	train-logloss:0.58778	train-auc:0.71393	train-aucpr:0.32438	val-logloss:0.49966	val-auc:0.70346	val-aucpr:0.21820
[80]	train-logloss:0.58503	train-auc:0.71720	train-aucpr:0.32870	val-logloss:0.48147	val-auc:0.70545	val-aucpr:0.21940
[82]	train-logloss:0.58459	train-auc:0.71773	train-aucpr:0.32935	val-logloss:0.48651	val-auc:0.69928	val-aucpr:0.21295
[2025-11-19 09:42:07,920] [INFO] [<frozen importlib] - Training completed at iteration 52
[2025-11-19 09:42:07,920] [INFO] [<frozen importlib] - Best train loss: 0.5944
[2025-11-19 09:42:07,920] [INFO] [<frozen importlib] - Best val loss: 0.5148
[2025-11-19 09:42:07,920] [INFO] [<frozen importlib] - Best val AUC: 0.7088
[2025-11-19 09:42:07,920] [INFO] [<frozen importlib] - Best val AUCPR: 0.2264
[2025-11-19 09:42:07,924] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:42:07] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:42:19,711] [INFO] [<frozen importlib] - Optimal threshold: 0.4803
[2025-11-19 09:42:19,711] [INFO] [<frozen importlib] - Best f1: 0.2749
[2025-11-19 09:42:19,711] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:42:19,754] [INFO] [<frozen importlib] - Validation Results (threshold=0.4803):
[2025-11-19 09:42:19,754] [INFO] [<frozen importlib] -   Accuracy: 0.8934
[2025-11-19 09:42:19,754] [INFO] [<frozen importlib] -   Precision: 0.2879
[2025-11-19 09:42:19,754] [INFO] [<frozen importlib] -   Recall: 0.2631
[2025-11-19 09:42:19,754] [INFO] [<frozen importlib] -   F1 Score: 0.2749
[2025-11-19 09:42:19,754] [INFO] [<frozen importlib] -   AUROC: 0.7088
[2025-11-19 09:42:19,754] [INFO] [<frozen importlib] -   AUPRC: 0.2267
[2025-11-19 09:42:19,754] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:42:19,754] [INFO] [<frozen importlib] -     TN=16500, FP=945
[2025-11-19 09:42:19,754] [INFO] [<frozen importlib] -     FN=1070, TP=382
[2025-11-19 09:42:19,779] [INFO] [<frozen importlib] - Trial 466: AUPRC=0.2267, F1=0.4384, Prec=0.4159, Rec=0.4635 | Optimizing auprc=0.2267
[2025-11-19 09:42:19,780] [INFO] [<frozen importlib] - Trial 466 pruned.
[2025-11-19 09:42:19,780] [ERROR] [<frozen importlib] - Trial 466 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  93%|█████████▎| 466/500 [1:20:17<06:17, 11.10s/it]Best trial: 289. Best value: 0.241792:  93%|█████████▎| 466/500 [1:20:17<06:17, 11.10s/it]Best trial: 289. Best value: 0.241792:  93%|█████████▎| 467/500 [1:20:17<06:17, 11.43s/it][2025-11-19 09:42:19,795] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.865303222207414
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   gamma: 0.1590307522814881
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   alpha: 0.6005179067298092
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   lambda: 1.1036125358749456
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   learning_rate: 0.040036439449204334
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   subsample: 0.8576919062110744
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   colsample_bytree: 0.62205987294744
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5101086082816589
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   colsample_bynode: 0.8249530951976016
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:42:19,795] [INFO] [<frozen importlib] -   scale_pos_weight: 5.865303222207414
[2025-11-19 09:42:19,872] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:42:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:42:19,780] Trial 466 pruned. 
[0]	train-logloss:0.63644	train-auc:0.63397	train-aucpr:0.21706	val-logloss:0.62438	val-auc:0.58152	val-aucpr:0.09368
[10]	train-logloss:0.61284	train-auc:0.67922	train-aucpr:0.29539	val-logloss:0.56594	val-auc:0.69349	val-aucpr:0.21286
[20]	train-logloss:0.59859	train-auc:0.68862	train-aucpr:0.30335	val-logloss:0.52765	val-auc:0.70070	val-aucpr:0.21537
[30]	train-logloss:0.58962	train-auc:0.69435	train-aucpr:0.30734	val-logloss:0.50098	val-auc:0.70215	val-aucpr:0.21847
[40]	train-logloss:0.58292	train-auc:0.69922	train-aucpr:0.31193	val-logloss:0.48746	val-auc:0.70498	val-aucpr:0.22400
[50]	train-logloss:0.57773	train-auc:0.70331	train-aucpr:0.31615	val-logloss:0.47558	val-auc:0.70716	val-aucpr:0.22148
[60]	train-logloss:0.57412	train-auc:0.70594	train-aucpr:0.31942	val-logloss:0.46839	val-auc:0.71182	val-aucpr:0.22924
[70]	train-logloss:0.57091	train-auc:0.70988	train-aucpr:0.32288	val-logloss:0.46794	val-auc:0.69777	val-aucpr:0.21691
[80]	train-logloss:0.56821	train-auc:0.71327	train-aucpr:0.32696	val-logloss:0.46122	val-auc:0.69670	val-aucpr:0.21124
[90]	train-logloss:0.56595	train-auc:0.71658	train-aucpr:0.33072	val-logloss:0.45701	val-auc:0.68353	val-aucpr:0.19635
[2025-11-19 09:42:20,144] [INFO] [<frozen importlib] - Training completed at iteration 61
[2025-11-19 09:42:20,144] [INFO] [<frozen importlib] - Best train loss: 0.5738
[2025-11-19 09:42:20,144] [INFO] [<frozen importlib] - Best val loss: 0.4663
[2025-11-19 09:42:20,144] [INFO] [<frozen importlib] - Best val AUC: 0.7123
[2025-11-19 09:42:20,144] [INFO] [<frozen importlib] - Best val AUCPR: 0.2298
[2025-11-19 09:42:20,150] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:42:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:42:32,808] [INFO] [<frozen importlib] - Optimal threshold: 0.4524
[2025-11-19 09:42:32,808] [INFO] [<frozen importlib] - Best f1: 0.2700
[2025-11-19 09:42:32,808] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:42:32,862] [INFO] [<frozen importlib] - Validation Results (threshold=0.4524):
[2025-11-19 09:42:32,862] [INFO] [<frozen importlib] -   Accuracy: 0.8955
[2025-11-19 09:42:32,862] [INFO] [<frozen importlib] -   Precision: 0.2915
[2025-11-19 09:42:32,862] [INFO] [<frozen importlib] -   Recall: 0.2514
[2025-11-19 09:42:32,862] [INFO] [<frozen importlib] -   F1 Score: 0.2700
[2025-11-19 09:42:32,862] [INFO] [<frozen importlib] -   AUROC: 0.7123
[2025-11-19 09:42:32,862] [INFO] [<frozen importlib] -   AUPRC: 0.2301
[2025-11-19 09:42:32,862] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:42:32,862] [INFO] [<frozen importlib] -     TN=16558, FP=887
[2025-11-19 09:42:32,862] [INFO] [<frozen importlib] -     FN=1087, TP=365
[2025-11-19 09:42:32,885] [INFO] [<frozen importlib] - Trial 467: AUPRC=0.2301, F1=0.4407, Prec=0.4270, Rec=0.4552 | Optimizing auprc=0.2301
                                                                                          Best trial: 289. Best value: 0.241792:  93%|█████████▎| 467/500 [1:20:30<06:17, 11.43s/it]Best trial: 289. Best value: 0.241792:  93%|█████████▎| 467/500 [1:20:30<06:17, 11.43s/it]Best trial: 289. Best value: 0.241792:  94%|█████████▎| 468/500 [1:20:30<06:21, 11.93s/it][2025-11-19 09:42:32,903] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.699670552453075
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   max_depth: 3
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   gamma: 0.19883153173200996
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   alpha: 0.5574659703587839
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   lambda: 0.7435135412843052
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   learning_rate: 0.037498672548365586
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   subsample: 0.8093274503161375
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   colsample_bytree: 0.6052508177021935
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5218768423560968
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   colsample_bynode: 0.7897014242169139
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:42:32,903] [INFO] [<frozen importlib] -   scale_pos_weight: 6.699670552453075
[2025-11-19 09:42:32,981] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:42:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:42:32,886] Trial 467 finished with value: 0.2301430742238744 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.1590307522814881, 'learning_rate': 0.040036439449204334, 'n_estimators': 400, 'alpha': 0.6005179067298092, 'lambda': 1.1036125358749456, 'subsample': 0.8576919062110744, 'colsample_bytree': 0.62205987294744, 'colsample_bylevel': 0.5101086082816589, 'colsample_bynode': 0.8249530951976016, 'scale_pos_weight': 5.865303222207414}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.68318	train-auc:0.62585	train-aucpr:0.22054	val-logloss:0.67832	val-auc:0.58469	val-aucpr:0.11140
[10]	train-logloss:0.66445	train-auc:0.66626	train-aucpr:0.26276	val-logloss:0.62724	val-auc:0.66859	val-aucpr:0.14662
[20]	train-logloss:0.65137	train-auc:0.67103	train-aucpr:0.26993	val-logloss:0.59297	val-auc:0.65751	val-aucpr:0.15726
[30]	train-logloss:0.64267	train-auc:0.67712	train-aucpr:0.27843	val-logloss:0.56511	val-auc:0.65757	val-aucpr:0.17889
[40]	train-logloss:0.63645	train-auc:0.68103	train-aucpr:0.28437	val-logloss:0.54721	val-auc:0.66181	val-aucpr:0.18488
[50]	train-logloss:0.63114	train-auc:0.68407	train-aucpr:0.28942	val-logloss:0.52911	val-auc:0.66756	val-aucpr:0.20006
[60]	train-logloss:0.62749	train-auc:0.68687	train-aucpr:0.29400	val-logloss:0.51410	val-auc:0.67073	val-aucpr:0.20939
[70]	train-logloss:0.62422	train-auc:0.69029	train-aucpr:0.29714	val-logloss:0.52520	val-auc:0.67483	val-aucpr:0.21218
[80]	train-logloss:0.62126	train-auc:0.69295	train-aucpr:0.30083	val-logloss:0.52155	val-auc:0.67968	val-aucpr:0.21609
[90]	train-logloss:0.61895	train-auc:0.69575	train-aucpr:0.30385	val-logloss:0.52585	val-auc:0.68595	val-aucpr:0.21721
[100]	train-logloss:0.61705	train-auc:0.69774	train-aucpr:0.30669	val-logloss:0.52711	val-auc:0.69640	val-aucpr:0.21576
[110]	train-logloss:0.61516	train-auc:0.69992	train-aucpr:0.30923	val-logloss:0.52654	val-auc:0.69967	val-aucpr:0.21325
[118]	train-logloss:0.61327	train-auc:0.70236	train-aucpr:0.31235	val-logloss:0.52499	val-auc:0.69808	val-aucpr:0.21211
[2025-11-19 09:42:33,247] [INFO] [<frozen importlib] - Training completed at iteration 89
[2025-11-19 09:42:33,247] [INFO] [<frozen importlib] - Best train loss: 0.6192
[2025-11-19 09:42:33,247] [INFO] [<frozen importlib] - Best val loss: 0.5306
[2025-11-19 09:42:33,247] [INFO] [<frozen importlib] - Best val AUC: 0.6874
[2025-11-19 09:42:33,247] [INFO] [<frozen importlib] - Best val AUCPR: 0.2179
[2025-11-19 09:42:33,252] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:42:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:42:44,745] [INFO] [<frozen importlib] - Optimal threshold: 0.5003
[2025-11-19 09:42:44,745] [INFO] [<frozen importlib] - Best f1: 0.2785
[2025-11-19 09:42:44,745] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:42:44,794] [INFO] [<frozen importlib] - Validation Results (threshold=0.5003):
[2025-11-19 09:42:44,794] [INFO] [<frozen importlib] -   Accuracy: 0.9046
[2025-11-19 09:42:44,794] [INFO] [<frozen importlib] -   Precision: 0.3324
[2025-11-19 09:42:44,794] [INFO] [<frozen importlib] -   Recall: 0.2397
[2025-11-19 09:42:44,794] [INFO] [<frozen importlib] -   F1 Score: 0.2785
[2025-11-19 09:42:44,794] [INFO] [<frozen importlib] -   AUROC: 0.6874
[2025-11-19 09:42:44,794] [INFO] [<frozen importlib] -   AUPRC: 0.2183
[2025-11-19 09:42:44,794] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:42:44,794] [INFO] [<frozen importlib] -     TN=16746, FP=699
[2025-11-19 09:42:44,794] [INFO] [<frozen importlib] -     FN=1104, TP=348
[2025-11-19 09:42:44,822] [INFO] [<frozen importlib] - Trial 468: AUPRC=0.2183, F1=0.4619, Prec=0.4803, Rec=0.4449 | Optimizing auprc=0.2183
                                                                                          Best trial: 289. Best value: 0.241792:  94%|█████████▎| 468/500 [1:20:42<06:21, 11.93s/it]Best trial: 289. Best value: 0.241792:  94%|█████████▎| 468/500 [1:20:42<06:21, 11.93s/it]Best trial: 289. Best value: 0.241792:  94%|█████████▍| 469/500 [1:20:42<06:09, 11.93s/it][2025-11-19 09:42:44,848] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.111095070259938
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   gamma: 0.23314720527483246
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   alpha: 1.4191066920108817
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   lambda: 1.2367780556536156
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   learning_rate: 0.03501650509934684
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   subsample: 0.8376238490346493
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   colsample_bytree: 0.5947492088461013
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5441593279728136
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   colsample_bynode: 0.8010681263274325
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:42:44,848] [INFO] [<frozen importlib] -   scale_pos_weight: 7.111095070259938
[2025-11-19 09:42:44,929] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:42:44] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:42:44,823] Trial 468 finished with value: 0.21834007098890573 and parameters: {'max_depth': 3, 'min_child_weight': 7, 'gamma': 0.19883153173200996, 'learning_rate': 0.037498672548365586, 'n_estimators': 450, 'alpha': 0.5574659703587839, 'lambda': 0.7435135412843052, 'subsample': 0.8093274503161375, 'colsample_bytree': 0.6052508177021935, 'colsample_bylevel': 0.5218768423560968, 'colsample_bynode': 0.7897014242169139, 'scale_pos_weight': 6.699670552453075}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.70553	train-auc:0.63287	train-aucpr:0.22187	val-logloss:0.70381	val-auc:0.64403	val-aucpr:0.15131
[10]	train-logloss:0.68120	train-auc:0.68188	train-aucpr:0.28863	val-logloss:0.65206	val-auc:0.70081	val-aucpr:0.20427
[20]	train-logloss:0.66590	train-auc:0.68894	train-aucpr:0.29897	val-logloss:0.62139	val-auc:0.69022	val-aucpr:0.20626
[30]	train-logloss:0.65507	train-auc:0.69243	train-aucpr:0.30466	val-logloss:0.58545	val-auc:0.69132	val-aucpr:0.22110
[40]	train-logloss:0.64733	train-auc:0.69802	train-aucpr:0.30910	val-logloss:0.56612	val-auc:0.70279	val-aucpr:0.22690
[50]	train-logloss:0.64115	train-auc:0.70183	train-aucpr:0.31298	val-logloss:0.54633	val-auc:0.70362	val-aucpr:0.22831
[60]	train-logloss:0.63701	train-auc:0.70484	train-aucpr:0.31683	val-logloss:0.53133	val-auc:0.70580	val-aucpr:0.23121
[70]	train-logloss:0.63298	train-auc:0.70864	train-aucpr:0.32067	val-logloss:0.52764	val-auc:0.70978	val-aucpr:0.22981
[80]	train-logloss:0.62943	train-auc:0.71317	train-aucpr:0.32507	val-logloss:0.52234	val-auc:0.70284	val-aucpr:0.22358
[85]	train-logloss:0.62812	train-auc:0.71420	train-aucpr:0.32599	val-logloss:0.51956	val-auc:0.70105	val-aucpr:0.21994
[2025-11-19 09:42:45,185] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:42:45,185] [INFO] [<frozen importlib] - Best train loss: 0.6386
[2025-11-19 09:42:45,185] [INFO] [<frozen importlib] - Best val loss: 0.5350
[2025-11-19 09:42:45,185] [INFO] [<frozen importlib] - Best val AUC: 0.7037
[2025-11-19 09:42:45,185] [INFO] [<frozen importlib] - Best val AUCPR: 0.2313
[2025-11-19 09:42:45,190] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:42:45] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:42:57,083] [INFO] [<frozen importlib] - Optimal threshold: 0.4915
[2025-11-19 09:42:57,083] [INFO] [<frozen importlib] - Best f1: 0.2819
[2025-11-19 09:42:57,083] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:42:57,129] [INFO] [<frozen importlib] - Validation Results (threshold=0.4915):
[2025-11-19 09:42:57,129] [INFO] [<frozen importlib] -   Accuracy: 0.9040
[2025-11-19 09:42:57,129] [INFO] [<frozen importlib] -   Precision: 0.3315
[2025-11-19 09:42:57,129] [INFO] [<frozen importlib] -   Recall: 0.2452
[2025-11-19 09:42:57,129] [INFO] [<frozen importlib] -   F1 Score: 0.2819
[2025-11-19 09:42:57,129] [INFO] [<frozen importlib] -   AUROC: 0.7037
[2025-11-19 09:42:57,129] [INFO] [<frozen importlib] -   AUPRC: 0.2316
[2025-11-19 09:42:57,129] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:42:57,129] [INFO] [<frozen importlib] -     TN=16727, FP=718
[2025-11-19 09:42:57,129] [INFO] [<frozen importlib] -     FN=1096, TP=356
[2025-11-19 09:42:57,155] [INFO] [<frozen importlib] - Trial 469: AUPRC=0.2316, F1=0.4433, Prec=0.4626, Rec=0.4256 | Optimizing auprc=0.2316
                                                                                          Best trial: 289. Best value: 0.241792:  94%|█████████▍| 469/500 [1:20:55<06:09, 11.93s/it]Best trial: 289. Best value: 0.241792:  94%|█████████▍| 469/500 [1:20:55<06:09, 11.93s/it]Best trial: 289. Best value: 0.241792:  94%|█████████▍| 470/500 [1:20:55<06:01, 12.05s/it][2025-11-19 09:42:57,172] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.4311503874226545
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   gamma: 0.11234458880647841
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   alpha: 1.8197257573947652
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   lambda: 0.6518544837368859
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   learning_rate: 0.03303193758162346
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   subsample: 0.8774080352944472
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   colsample_bytree: 0.5767622452237011
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   colsample_bylevel: 0.564022259622752
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   colsample_bynode: 0.7747519247961586
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:42:57,172] [INFO] [<frozen importlib] -   scale_pos_weight: 7.4311503874226545
[2025-11-19 09:42:57,248] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:42:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:42:57,156] Trial 469 finished with value: 0.2316424725584227 and parameters: {'max_depth': 4, 'min_child_weight': 5, 'gamma': 0.23314720527483246, 'learning_rate': 0.03501650509934684, 'n_estimators': 350, 'alpha': 1.4191066920108817, 'lambda': 1.2367780556536156, 'subsample': 0.8376238490346493, 'colsample_bytree': 0.5947492088461013, 'colsample_bylevel': 0.5441593279728136, 'colsample_bynode': 0.8010681263274325, 'scale_pos_weight': 7.111095070259938}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.72220	train-auc:0.63931	train-aucpr:0.22571	val-logloss:0.72360	val-auc:0.61481	val-aucpr:0.12663
[10]	train-logloss:0.69808	train-auc:0.68075	train-aucpr:0.29021	val-logloss:0.66070	val-auc:0.69503	val-aucpr:0.20739
[20]	train-logloss:0.68327	train-auc:0.68732	train-aucpr:0.29592	val-logloss:0.62272	val-auc:0.69797	val-aucpr:0.21291
[30]	train-logloss:0.67252	train-auc:0.69157	train-aucpr:0.30072	val-logloss:0.59430	val-auc:0.69651	val-aucpr:0.21706
[40]	train-logloss:0.66498	train-auc:0.69546	train-aucpr:0.30577	val-logloss:0.57164	val-auc:0.69913	val-aucpr:0.22305
[50]	train-logloss:0.65869	train-auc:0.69990	train-aucpr:0.31046	val-logloss:0.56179	val-auc:0.70098	val-aucpr:0.22227
[60]	train-logloss:0.65423	train-auc:0.70315	train-aucpr:0.31365	val-logloss:0.54757	val-auc:0.70089	val-aucpr:0.22426
[70]	train-logloss:0.65039	train-auc:0.70703	train-aucpr:0.31680	val-logloss:0.55021	val-auc:0.70538	val-aucpr:0.22167
[80]	train-logloss:0.64695	train-auc:0.71014	train-aucpr:0.32123	val-logloss:0.54117	val-auc:0.70811	val-aucpr:0.22118
[86]	train-logloss:0.64513	train-auc:0.71130	train-aucpr:0.32311	val-logloss:0.53653	val-auc:0.70891	val-aucpr:0.21544
[2025-11-19 09:42:57,501] [INFO] [<frozen importlib] - Training completed at iteration 57
[2025-11-19 09:42:57,501] [INFO] [<frozen importlib] - Best train loss: 0.6556
[2025-11-19 09:42:57,501] [INFO] [<frozen importlib] - Best val loss: 0.5522
[2025-11-19 09:42:57,501] [INFO] [<frozen importlib] - Best val AUC: 0.7010
[2025-11-19 09:42:57,501] [INFO] [<frozen importlib] - Best val AUCPR: 0.2249
[2025-11-19 09:42:57,507] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:42:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:43:10,364] [INFO] [<frozen importlib] - Optimal threshold: 0.5279
[2025-11-19 09:43:10,365] [INFO] [<frozen importlib] - Best f1: 0.2664
[2025-11-19 09:43:10,365] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:43:10,409] [INFO] [<frozen importlib] - Validation Results (threshold=0.5279):
[2025-11-19 09:43:10,409] [INFO] [<frozen importlib] -   Accuracy: 0.9079
[2025-11-19 09:43:10,409] [INFO] [<frozen importlib] -   Precision: 0.3435
[2025-11-19 09:43:10,409] [INFO] [<frozen importlib] -   Recall: 0.2176
[2025-11-19 09:43:10,409] [INFO] [<frozen importlib] -   F1 Score: 0.2664
[2025-11-19 09:43:10,409] [INFO] [<frozen importlib] -   AUROC: 0.7010
[2025-11-19 09:43:10,409] [INFO] [<frozen importlib] -   AUPRC: 0.2252
[2025-11-19 09:43:10,409] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:43:10,409] [INFO] [<frozen importlib] -     TN=16841, FP=604
[2025-11-19 09:43:10,409] [INFO] [<frozen importlib] -     FN=1136, TP=316
[2025-11-19 09:43:10,432] [INFO] [<frozen importlib] - Trial 470: AUPRC=0.2252, F1=0.4640, Prec=0.5069, Rec=0.4277 | Optimizing auprc=0.2252
[2025-11-19 09:43:10,433] [INFO] [<frozen importlib] - Trial 470 pruned.
[2025-11-19 09:43:10,433] [ERROR] [<frozen importlib] - Trial 470 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  94%|█████████▍| 470/500 [1:21:08<06:01, 12.05s/it]Best trial: 289. Best value: 0.241792:  94%|█████████▍| 470/500 [1:21:08<06:01, 12.05s/it]Best trial: 289. Best value: 0.241792:  94%|█████████▍| 471/500 [1:21:08<06:00, 12.42s/it][2025-11-19 09:43:10,457] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.859704305168686
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   gamma: 0.1427350187984418
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   alpha: 1.8256164070685044
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   lambda: 0.8444269500355726
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   learning_rate: 0.03614480209280615
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   subsample: 0.6493867751723073
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   colsample_bytree: 0.5926743999519967
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5156495843423545
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   colsample_bynode: 0.6996790987064415
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:43:10,458] [INFO] [<frozen importlib] -   scale_pos_weight: 6.859704305168686
[2025-11-19 09:43:10,534] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:43:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:43:10,433] Trial 470 pruned. 
[0]	train-logloss:0.69168	train-auc:0.63691	train-aucpr:0.22460	val-logloss:0.68829	val-auc:0.52487	val-aucpr:0.09383
[10]	train-logloss:0.66795	train-auc:0.68344	train-aucpr:0.28872	val-logloss:0.63468	val-auc:0.68496	val-aucpr:0.20718
[20]	train-logloss:0.65300	train-auc:0.68772	train-aucpr:0.29542	val-logloss:0.59949	val-auc:0.69599	val-aucpr:0.21834
[30]	train-logloss:0.64282	train-auc:0.69250	train-aucpr:0.30144	val-logloss:0.56127	val-auc:0.69445	val-aucpr:0.22401
[40]	train-logloss:0.63546	train-auc:0.69622	train-aucpr:0.30616	val-logloss:0.53776	val-auc:0.69989	val-aucpr:0.22801
[50]	train-logloss:0.62944	train-auc:0.70080	train-aucpr:0.31100	val-logloss:0.52574	val-auc:0.69258	val-aucpr:0.22216
[60]	train-logloss:0.62472	train-auc:0.70449	train-aucpr:0.31520	val-logloss:0.51946	val-auc:0.69574	val-aucpr:0.21869
[68]	train-logloss:0.62169	train-auc:0.70652	train-aucpr:0.31732	val-logloss:0.50927	val-auc:0.69553	val-aucpr:0.21835
[2025-11-19 09:43:10,747] [INFO] [<frozen importlib] - Training completed at iteration 38
[2025-11-19 09:43:10,747] [INFO] [<frozen importlib] - Best train loss: 0.6367
[2025-11-19 09:43:10,747] [INFO] [<frozen importlib] - Best val loss: 0.5435
[2025-11-19 09:43:10,747] [INFO] [<frozen importlib] - Best val AUC: 0.6985
[2025-11-19 09:43:10,747] [INFO] [<frozen importlib] - Best val AUCPR: 0.2294
[2025-11-19 09:43:10,751] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:43:10] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:43:19,794] [INFO] [<frozen importlib] - Optimal threshold: 0.4903
[2025-11-19 09:43:19,794] [INFO] [<frozen importlib] - Best f1: 0.2789
[2025-11-19 09:43:19,794] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:43:19,844] [INFO] [<frozen importlib] - Validation Results (threshold=0.4903):
[2025-11-19 09:43:19,844] [INFO] [<frozen importlib] -   Accuracy: 0.9020
[2025-11-19 09:43:19,844] [INFO] [<frozen importlib] -   Precision: 0.3211
[2025-11-19 09:43:19,844] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 09:43:19,844] [INFO] [<frozen importlib] -   F1 Score: 0.2789
[2025-11-19 09:43:19,844] [INFO] [<frozen importlib] -   AUROC: 0.6985
[2025-11-19 09:43:19,844] [INFO] [<frozen importlib] -   AUPRC: 0.2296
[2025-11-19 09:43:19,844] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:43:19,844] [INFO] [<frozen importlib] -     TN=16688, FP=757
[2025-11-19 09:43:19,844] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 09:43:19,871] [INFO] [<frozen importlib] - Trial 471: AUPRC=0.2296, F1=0.4389, Prec=0.4507, Rec=0.4277 | Optimizing auprc=0.2296
                                                                                          Best trial: 289. Best value: 0.241792:  94%|█████████▍| 471/500 [1:21:17<06:00, 12.42s/it]Best trial: 289. Best value: 0.241792:  94%|█████████▍| 471/500 [1:21:17<06:00, 12.42s/it]Best trial: 289. Best value: 0.241792:  94%|█████████▍| 472/500 [1:21:17<05:22, 11.53s/it][2025-11-19 09:43:19,902] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.432512047594007
[2025-11-19 09:43:19,902] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:43:19,902] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:43:19,902] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   gamma: 0.17274283920688105
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   alpha: 0.4512683834321823
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   lambda: 1.6174732590812728
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   learning_rate: 0.038794178917493274
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   subsample: 0.7934312357112506
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   colsample_bytree: 0.6143092226629764
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5001286185819505
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   colsample_bynode: 0.7842065036984106
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:43:19,903] [INFO] [<frozen importlib] -   scale_pos_weight: 6.432512047594007
[2025-11-19 09:43:20,015] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:43:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:43:19,875] Trial 471 finished with value: 0.2295849477960974 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.1427350187984418, 'learning_rate': 0.03614480209280615, 'n_estimators': 450, 'alpha': 1.8256164070685044, 'lambda': 0.8444269500355726, 'subsample': 0.6493867751723073, 'colsample_bytree': 0.5926743999519967, 'colsample_bylevel': 0.5156495843423545, 'colsample_bynode': 0.6996790987064415, 'scale_pos_weight': 6.859704305168686}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.66816	train-auc:0.63856	train-aucpr:0.23103	val-logloss:0.66177	val-auc:0.61099	val-aucpr:0.12854
[10]	train-logloss:0.64418	train-auc:0.68203	train-aucpr:0.29178	val-logloss:0.60304	val-auc:0.69552	val-aucpr:0.20586
[20]	train-logloss:0.62929	train-auc:0.69025	train-aucpr:0.29853	val-logloss:0.55930	val-auc:0.70126	val-aucpr:0.21099
[30]	train-logloss:0.61954	train-auc:0.69318	train-aucpr:0.30368	val-logloss:0.52821	val-auc:0.70153	val-aucpr:0.21900
[40]	train-logloss:0.61284	train-auc:0.69806	train-aucpr:0.30864	val-logloss:0.50498	val-auc:0.70555	val-aucpr:0.21479
[50]	train-logloss:0.60692	train-auc:0.70271	train-aucpr:0.31340	val-logloss:0.49547	val-auc:0.70353	val-aucpr:0.21657
[60]	train-logloss:0.60288	train-auc:0.70543	train-aucpr:0.31634	val-logloss:0.48626	val-auc:0.70328	val-aucpr:0.22216
[70]	train-logloss:0.59953	train-auc:0.70937	train-aucpr:0.32062	val-logloss:0.48744	val-auc:0.69644	val-aucpr:0.21487
[80]	train-logloss:0.59665	train-auc:0.71295	train-aucpr:0.32408	val-logloss:0.47188	val-auc:0.69301	val-aucpr:0.21272
[90]	train-logloss:0.59407	train-auc:0.71658	train-aucpr:0.32847	val-logloss:0.46740	val-auc:0.69421	val-aucpr:0.21098
[91]	train-logloss:0.59382	train-auc:0.71725	train-aucpr:0.32911	val-logloss:0.46266	val-auc:0.69238	val-aucpr:0.20843
[2025-11-19 09:43:20,322] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:43:20,322] [INFO] [<frozen importlib] - Best train loss: 0.6019
[2025-11-19 09:43:20,322] [INFO] [<frozen importlib] - Best val loss: 0.4867
[2025-11-19 09:43:20,322] [INFO] [<frozen importlib] - Best val AUC: 0.7035
[2025-11-19 09:43:20,322] [INFO] [<frozen importlib] - Best val AUCPR: 0.2225
[2025-11-19 09:43:20,332] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:43:20] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:43:32,795] [INFO] [<frozen importlib] - Optimal threshold: 0.4724
[2025-11-19 09:43:32,795] [INFO] [<frozen importlib] - Best f1: 0.2713
[2025-11-19 09:43:32,795] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:43:32,851] [INFO] [<frozen importlib] - Validation Results (threshold=0.4724):
[2025-11-19 09:43:32,852] [INFO] [<frozen importlib] -   Accuracy: 0.9073
[2025-11-19 09:43:32,852] [INFO] [<frozen importlib] -   Precision: 0.3428
[2025-11-19 09:43:32,852] [INFO] [<frozen importlib] -   Recall: 0.2245
[2025-11-19 09:43:32,852] [INFO] [<frozen importlib] -   F1 Score: 0.2713
[2025-11-19 09:43:32,852] [INFO] [<frozen importlib] -   AUROC: 0.7035
[2025-11-19 09:43:32,852] [INFO] [<frozen importlib] -   AUPRC: 0.2228
[2025-11-19 09:43:32,852] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:43:32,852] [INFO] [<frozen importlib] -     TN=16820, FP=625
[2025-11-19 09:43:32,852] [INFO] [<frozen importlib] -     FN=1126, TP=326
[2025-11-19 09:43:32,913] [INFO] [<frozen importlib] - Trial 472: AUPRC=0.2228, F1=0.4500, Prec=0.4910, Rec=0.4153 | Optimizing auprc=0.2228
[2025-11-19 09:43:32,914] [INFO] [<frozen importlib] - Trial 472 pruned.
[2025-11-19 09:43:32,914] [ERROR] [<frozen importlib] - Trial 472 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  94%|█████████▍| 472/500 [1:21:30<05:22, 11.53s/it]Best trial: 289. Best value: 0.241792:  94%|█████████▍| 472/500 [1:21:30<05:22, 11.53s/it]Best trial: 289. Best value: 0.241792:  95%|█████████▍| 473/500 [1:21:30<05:23, 11.98s/it][2025-11-19 09:43:32,934] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.859309166050756
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   gamma: 0.21697213583096447
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   alpha: 0.6579443723613829
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   lambda: 1.0052393233669732
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   learning_rate: 0.031750887721284045
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   subsample: 0.8505758518219773
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   colsample_bytree: 0.5855707133284417
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5261047548966893
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   colsample_bynode: 0.811588267930798
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:43:32,934] [INFO] [<frozen importlib] -   scale_pos_weight: 5.859309166050756
[2025-11-19 09:43:33,008] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:43:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:43:32,914] Trial 472 pruned. 
[0]	train-logloss:0.63674	train-auc:0.62939	train-aucpr:0.22765	val-logloss:0.62747	val-auc:0.62157	val-aucpr:0.13475
[10]	train-logloss:0.61707	train-auc:0.68098	train-aucpr:0.28844	val-logloss:0.58310	val-auc:0.69041	val-aucpr:0.18409
[20]	train-logloss:0.60417	train-auc:0.68630	train-aucpr:0.29717	val-logloss:0.54959	val-auc:0.69389	val-aucpr:0.20476
[30]	train-logloss:0.59520	train-auc:0.69076	train-aucpr:0.30123	val-logloss:0.52826	val-auc:0.70050	val-aucpr:0.21115
[40]	train-logloss:0.58863	train-auc:0.69415	train-aucpr:0.30555	val-logloss:0.51019	val-auc:0.70364	val-aucpr:0.21873
[50]	train-logloss:0.58303	train-auc:0.69832	train-aucpr:0.31039	val-logloss:0.50800	val-auc:0.70167	val-aucpr:0.22050
[60]	train-logloss:0.57906	train-auc:0.70109	train-aucpr:0.31428	val-logloss:0.50053	val-auc:0.70607	val-aucpr:0.22436
[70]	train-logloss:0.57551	train-auc:0.70570	train-aucpr:0.31812	val-logloss:0.49137	val-auc:0.69838	val-aucpr:0.21953
[80]	train-logloss:0.57245	train-auc:0.70927	train-aucpr:0.32156	val-logloss:0.47830	val-auc:0.69772	val-aucpr:0.21914
[90]	train-logloss:0.56995	train-auc:0.71154	train-aucpr:0.32444	val-logloss:0.48041	val-auc:0.69248	val-aucpr:0.21238
[94]	train-logloss:0.56901	train-auc:0.71320	train-aucpr:0.32568	val-logloss:0.47771	val-auc:0.69245	val-aucpr:0.21026
[2025-11-19 09:43:33,284] [INFO] [<frozen importlib] - Training completed at iteration 65
[2025-11-19 09:43:33,284] [INFO] [<frozen importlib] - Best train loss: 0.5773
[2025-11-19 09:43:33,284] [INFO] [<frozen importlib] - Best val loss: 0.4932
[2025-11-19 09:43:33,284] [INFO] [<frozen importlib] - Best val AUC: 0.7053
[2025-11-19 09:43:33,284] [INFO] [<frozen importlib] - Best val AUCPR: 0.2250
[2025-11-19 09:43:33,288] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:43:33] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:43:46,511] [INFO] [<frozen importlib] - Optimal threshold: 0.4624
[2025-11-19 09:43:46,511] [INFO] [<frozen importlib] - Best f1: 0.2684
[2025-11-19 09:43:46,512] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:43:46,559] [INFO] [<frozen importlib] - Validation Results (threshold=0.4624):
[2025-11-19 09:43:46,559] [INFO] [<frozen importlib] -   Accuracy: 0.8913
[2025-11-19 09:43:46,559] [INFO] [<frozen importlib] -   Precision: 0.2778
[2025-11-19 09:43:46,559] [INFO] [<frozen importlib] -   Recall: 0.2596
[2025-11-19 09:43:46,559] [INFO] [<frozen importlib] -   F1 Score: 0.2684
[2025-11-19 09:43:46,559] [INFO] [<frozen importlib] -   AUROC: 0.7053
[2025-11-19 09:43:46,559] [INFO] [<frozen importlib] -   AUPRC: 0.2254
[2025-11-19 09:43:46,559] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:43:46,559] [INFO] [<frozen importlib] -     TN=16465, FP=980
[2025-11-19 09:43:46,559] [INFO] [<frozen importlib] -     FN=1075, TP=377
[2025-11-19 09:43:46,582] [INFO] [<frozen importlib] - Trial 473: AUPRC=0.2254, F1=0.4425, Prec=0.4135, Rec=0.4759 | Optimizing auprc=0.2254
                                                                                          Best trial: 289. Best value: 0.241792:  95%|█████████▍| 473/500 [1:21:44<05:23, 11.98s/it]Best trial: 289. Best value: 0.241792:  95%|█████████▍| 473/500 [1:21:44<05:23, 11.98s/it]Best trial: 289. Best value: 0.241792:  95%|█████████▍| 474/500 [1:21:44<05:24, 12.49s/it][2025-11-19 09:43:46,597] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.094926075660861
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   gamma: 0.19325920144660802
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   alpha: 0.4960607943016738
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   lambda: 1.1579871318614536
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   learning_rate: 0.040412319767450904
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   subsample: 0.8245405298933772
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   colsample_bytree: 0.603788961640048
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5091942125158104
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   colsample_bynode: 0.7693665213638406
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:43:46,597] [INFO] [<frozen importlib] -   scale_pos_weight: 6.094926075660861
[2025-11-19 09:43:46,668] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:43:46] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:43:46,583] Trial 473 finished with value: 0.22543506391111962 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.21697213583096447, 'learning_rate': 0.031750887721284045, 'n_estimators': 450, 'alpha': 0.6579443723613829, 'lambda': 1.0052393233669732, 'subsample': 0.8505758518219773, 'colsample_bytree': 0.5855707133284417, 'colsample_bylevel': 0.5261047548966893, 'colsample_bynode': 0.811588267930798, 'scale_pos_weight': 5.859309166050756}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.64899	train-auc:0.64315	train-aucpr:0.25519	val-logloss:0.64094	val-auc:0.58551	val-aucpr:0.11212
[10]	train-logloss:0.62536	train-auc:0.68210	train-aucpr:0.29184	val-logloss:0.58340	val-auc:0.66981	val-aucpr:0.18000
[20]	train-logloss:0.61101	train-auc:0.68877	train-aucpr:0.30044	val-logloss:0.54610	val-auc:0.66671	val-aucpr:0.19412
[30]	train-logloss:0.60154	train-auc:0.69330	train-aucpr:0.30613	val-logloss:0.51794	val-auc:0.67940	val-aucpr:0.21394
[40]	train-logloss:0.59490	train-auc:0.69793	train-aucpr:0.31092	val-logloss:0.49909	val-auc:0.67604	val-aucpr:0.21383
[50]	train-logloss:0.58943	train-auc:0.70215	train-aucpr:0.31478	val-logloss:0.48488	val-auc:0.68309	val-aucpr:0.21588
[60]	train-logloss:0.58582	train-auc:0.70477	train-aucpr:0.31818	val-logloss:0.47931	val-auc:0.68695	val-aucpr:0.21974
[70]	train-logloss:0.58239	train-auc:0.70952	train-aucpr:0.32250	val-logloss:0.46759	val-auc:0.68756	val-aucpr:0.21862
[80]	train-logloss:0.57944	train-auc:0.71426	train-aucpr:0.32702	val-logloss:0.45192	val-auc:0.68569	val-aucpr:0.21706
[90]	train-logloss:0.57697	train-auc:0.71866	train-aucpr:0.33070	val-logloss:0.45564	val-auc:0.68339	val-aucpr:0.21272
[97]	train-logloss:0.57533	train-auc:0.72140	train-aucpr:0.33361	val-logloss:0.45622	val-auc:0.68122	val-aucpr:0.21154
[2025-11-19 09:43:47,575] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:43:47,575] [INFO] [<frozen importlib] - Best train loss: 0.5830
[2025-11-19 09:43:47,575] [INFO] [<frozen importlib] - Best val loss: 0.4657
[2025-11-19 09:43:47,575] [INFO] [<frozen importlib] - Best val AUC: 0.6897
[2025-11-19 09:43:47,575] [INFO] [<frozen importlib] - Best val AUCPR: 0.2208
[2025-11-19 09:43:47,578] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:43:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:44:01,429] [INFO] [<frozen importlib] - Optimal threshold: 0.4532
[2025-11-19 09:44:01,429] [INFO] [<frozen importlib] - Best f1: 0.2668
[2025-11-19 09:44:01,429] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:44:01,473] [INFO] [<frozen importlib] - Validation Results (threshold=0.4532):
[2025-11-19 09:44:01,473] [INFO] [<frozen importlib] -   Accuracy: 0.8970
[2025-11-19 09:44:01,473] [INFO] [<frozen importlib] -   Precision: 0.2945
[2025-11-19 09:44:01,473] [INFO] [<frozen importlib] -   Recall: 0.2438
[2025-11-19 09:44:01,473] [INFO] [<frozen importlib] -   F1 Score: 0.2668
[2025-11-19 09:44:01,473] [INFO] [<frozen importlib] -   AUROC: 0.6897
[2025-11-19 09:44:01,473] [INFO] [<frozen importlib] -   AUPRC: 0.2214
[2025-11-19 09:44:01,473] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:44:01,473] [INFO] [<frozen importlib] -     TN=16597, FP=848
[2025-11-19 09:44:01,473] [INFO] [<frozen importlib] -     FN=1098, TP=354
[2025-11-19 09:44:01,496] [INFO] [<frozen importlib] - Trial 474: AUPRC=0.2214, F1=0.4574, Prec=0.4458, Rec=0.4697 | Optimizing auprc=0.2214
[2025-11-19 09:44:01,496] [INFO] [<frozen importlib] - Trial 474 pruned.
[2025-11-19 09:44:01,496] [ERROR] [<frozen importlib] - Trial 474 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  95%|█████████▍| 474/500 [1:21:59<05:24, 12.49s/it]Best trial: 289. Best value: 0.241792:  95%|█████████▍| 474/500 [1:21:59<05:24, 12.49s/it]Best trial: 289. Best value: 0.241792:  95%|█████████▌| 475/500 [1:21:59<05:30, 13.22s/it][2025-11-19 09:44:01,511] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.584515890113768
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   gamma: 0.24513435207261858
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   alpha: 0.6004828324520851
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   lambda: 0.915504679057028
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   learning_rate: 0.037332350247804305
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   subsample: 0.8103129622798116
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   colsample_bytree: 0.5701868935878492
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5375851814989645
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   colsample_bynode: 0.8197365875450017
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:44:01,511] [INFO] [<frozen importlib] -   scale_pos_weight: 6.584515890113768
[2025-11-19 09:44:01,586] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:44:01] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:44:01,497] Trial 474 pruned. 
[0]	train-logloss:0.67644	train-auc:0.63984	train-aucpr:0.22851	val-logloss:0.67027	val-auc:0.62350	val-aucpr:0.12475
[10]	train-logloss:0.65248	train-auc:0.68267	train-aucpr:0.29054	val-logloss:0.60394	val-auc:0.70597	val-aucpr:0.20345
[20]	train-logloss:0.63786	train-auc:0.68732	train-aucpr:0.29955	val-logloss:0.56799	val-auc:0.70411	val-aucpr:0.21350
[30]	train-logloss:0.62785	train-auc:0.69428	train-aucpr:0.30619	val-logloss:0.54158	val-auc:0.70503	val-aucpr:0.22222
[40]	train-logloss:0.62092	train-auc:0.69790	train-aucpr:0.30878	val-logloss:0.52335	val-auc:0.70446	val-aucpr:0.22013
[50]	train-logloss:0.61470	train-auc:0.70252	train-aucpr:0.31404	val-logloss:0.51808	val-auc:0.70909	val-aucpr:0.23200
[60]	train-logloss:0.61050	train-auc:0.70733	train-aucpr:0.31732	val-logloss:0.50319	val-auc:0.70739	val-aucpr:0.23077
[70]	train-logloss:0.60715	train-auc:0.71016	train-aucpr:0.32097	val-logloss:0.50234	val-auc:0.69528	val-aucpr:0.22278
[79]	train-logloss:0.60439	train-auc:0.71307	train-aucpr:0.32449	val-logloss:0.49058	val-auc:0.69126	val-aucpr:0.22009
[2025-11-19 09:44:03,033] [INFO] [<frozen importlib] - Training completed at iteration 50
[2025-11-19 09:44:03,033] [INFO] [<frozen importlib] - Best train loss: 0.6147
[2025-11-19 09:44:03,033] [INFO] [<frozen importlib] - Best val loss: 0.5181
[2025-11-19 09:44:03,033] [INFO] [<frozen importlib] - Best val AUC: 0.7091
[2025-11-19 09:44:03,033] [INFO] [<frozen importlib] - Best val AUCPR: 0.2320
[2025-11-19 09:44:03,036] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:44:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:44:14,687] [INFO] [<frozen importlib] - Optimal threshold: 0.4818
[2025-11-19 09:44:14,688] [INFO] [<frozen importlib] - Best f1: 0.2792
[2025-11-19 09:44:14,688] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:44:14,738] [INFO] [<frozen importlib] - Validation Results (threshold=0.4818):
[2025-11-19 09:44:14,738] [INFO] [<frozen importlib] -   Accuracy: 0.9006
[2025-11-19 09:44:14,738] [INFO] [<frozen importlib] -   Precision: 0.3152
[2025-11-19 09:44:14,738] [INFO] [<frozen importlib] -   Recall: 0.2507
[2025-11-19 09:44:14,738] [INFO] [<frozen importlib] -   F1 Score: 0.2792
[2025-11-19 09:44:14,738] [INFO] [<frozen importlib] -   AUROC: 0.7091
[2025-11-19 09:44:14,738] [INFO] [<frozen importlib] -   AUPRC: 0.2323
[2025-11-19 09:44:14,738] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:44:14,738] [INFO] [<frozen importlib] -     TN=16654, FP=791
[2025-11-19 09:44:14,738] [INFO] [<frozen importlib] -     FN=1088, TP=364
[2025-11-19 09:44:14,763] [INFO] [<frozen importlib] - Trial 475: AUPRC=0.2323, F1=0.4637, Prec=0.4612, Rec=0.4663 | Optimizing auprc=0.2323
                                                                                          Best trial: 289. Best value: 0.241792:  95%|█████████▌| 475/500 [1:22:12<05:30, 13.22s/it]Best trial: 289. Best value: 0.241792:  95%|█████████▌| 475/500 [1:22:12<05:30, 13.22s/it]Best trial: 289. Best value: 0.241792:  95%|█████████▌| 476/500 [1:22:12<05:17, 13.23s/it][2025-11-19 09:44:14,778] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.625739477045787
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   gamma: 0.08736966902222346
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   alpha: 0.5533797109060125
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   lambda: 1.3564786044263961
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   learning_rate: 0.033829391687944535
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   subsample: 0.8424027929614893
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   colsample_bytree: 0.583315579025744
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5482993401586481
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   colsample_bynode: 0.8005745188713826
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:44:14,778] [INFO] [<frozen importlib] -   scale_pos_weight: 7.625739477045787
[2025-11-19 09:44:14,861] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:44:14] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:44:14,764] Trial 475 finished with value: 0.23234424563848377 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.24513435207261858, 'learning_rate': 0.037332350247804305, 'n_estimators': 350, 'alpha': 0.6004828324520851, 'lambda': 0.915504679057028, 'subsample': 0.8103129622798116, 'colsample_bytree': 0.5701868935878492, 'colsample_bylevel': 0.5375851814989645, 'colsample_bynode': 0.8197365875450017, 'scale_pos_weight': 6.584515890113768}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.73237	train-auc:0.64077	train-aucpr:0.22265	val-logloss:0.73307	val-auc:0.62435	val-aucpr:0.12309
[10]	train-logloss:0.70746	train-auc:0.68303	train-aucpr:0.29239	val-logloss:0.67241	val-auc:0.72157	val-aucpr:0.22710
[20]	train-logloss:0.69200	train-auc:0.68845	train-aucpr:0.29535	val-logloss:0.63835	val-auc:0.72093	val-aucpr:0.22226
[30]	train-logloss:0.68083	train-auc:0.69383	train-aucpr:0.30071	val-logloss:0.60693	val-auc:0.71700	val-aucpr:0.22506
[40]	train-logloss:0.67318	train-auc:0.69689	train-aucpr:0.30468	val-logloss:0.58216	val-auc:0.71536	val-aucpr:0.22642
[43]	train-logloss:0.67103	train-auc:0.69828	train-aucpr:0.30699	val-logloss:0.57535	val-auc:0.71576	val-aucpr:0.22823
[2025-11-19 09:44:15,012] [INFO] [<frozen importlib] - Training completed at iteration 14
[2025-11-19 09:44:15,012] [INFO] [<frozen importlib] - Best train loss: 0.7008
[2025-11-19 09:44:15,012] [INFO] [<frozen importlib] - Best val loss: 0.6569
[2025-11-19 09:44:15,012] [INFO] [<frozen importlib] - Best val AUC: 0.7214
[2025-11-19 09:44:15,012] [INFO] [<frozen importlib] - Best val AUCPR: 0.2316
[2025-11-19 09:44:15,015] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:44:15] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:44:18,447] [INFO] [<frozen importlib] - Optimal threshold: 0.5192
[2025-11-19 09:44:18,447] [INFO] [<frozen importlib] - Best f1: 0.2811
[2025-11-19 09:44:18,447] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:44:18,487] [INFO] [<frozen importlib] - Validation Results (threshold=0.5192):
[2025-11-19 09:44:18,487] [INFO] [<frozen importlib] -   Accuracy: 0.8863
[2025-11-19 09:44:18,487] [INFO] [<frozen importlib] -   Precision: 0.2734
[2025-11-19 09:44:18,487] [INFO] [<frozen importlib] -   Recall: 0.2893
[2025-11-19 09:44:18,487] [INFO] [<frozen importlib] -   F1 Score: 0.2811
[2025-11-19 09:44:18,487] [INFO] [<frozen importlib] -   AUROC: 0.7214
[2025-11-19 09:44:18,487] [INFO] [<frozen importlib] -   AUPRC: 0.2312
[2025-11-19 09:44:18,488] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:44:18,488] [INFO] [<frozen importlib] -     TN=16329, FP=1116
[2025-11-19 09:44:18,488] [INFO] [<frozen importlib] -     FN=1032, TP=420
[2025-11-19 09:44:18,511] [INFO] [<frozen importlib] - Trial 476: AUPRC=0.2312, F1=0.4539, Prec=0.4032, Rec=0.5193 | Optimizing auprc=0.2312
                                                                                          Best trial: 289. Best value: 0.241792:  95%|█████████▌| 476/500 [1:22:16<05:17, 13.23s/it]Best trial: 289. Best value: 0.241792:  95%|█████████▌| 476/500 [1:22:16<05:17, 13.23s/it]Best trial: 289. Best value: 0.241792:  95%|█████████▌| 477/500 [1:22:16<03:58, 10.39s/it][2025-11-19 09:44:18,526] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.269544181511449
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   gamma: 0.1630017393196322
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   alpha: 0.4965336794396766
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   lambda: 1.0625848698304186
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   learning_rate: 0.04163105428124188
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   subsample: 0.8286682387500841
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   colsample_bytree: 0.8781027168741262
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5272328918402073
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   colsample_bynode: 0.7879544630645158
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:44:18,526] [INFO] [<frozen importlib] -   scale_pos_weight: 6.269544181511449
[2025-11-19 09:44:18,604] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:44:18] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:44:18,511] Trial 476 finished with value: 0.23119125517742833 and parameters: {'max_depth': 4, 'min_child_weight': 8, 'gamma': 0.08736966902222346, 'learning_rate': 0.033829391687944535, 'n_estimators': 450, 'alpha': 0.5533797109060125, 'lambda': 1.3564786044263961, 'subsample': 0.8424027929614893, 'colsample_bytree': 0.583315579025744, 'colsample_bylevel': 0.5482993401586481, 'colsample_bynode': 0.8005745188713826, 'scale_pos_weight': 7.625739477045787}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.65834	train-auc:0.65631	train-aucpr:0.23877	val-logloss:0.64824	val-auc:0.64921	val-aucpr:0.14109
[10]	train-logloss:0.63256	train-auc:0.68114	train-aucpr:0.28921	val-logloss:0.57877	val-auc:0.68318	val-aucpr:0.19400
[20]	train-logloss:0.61799	train-auc:0.68961	train-aucpr:0.30093	val-logloss:0.53779	val-auc:0.69344	val-aucpr:0.20665
[30]	train-logloss:0.60808	train-auc:0.69640	train-aucpr:0.30663	val-logloss:0.51284	val-auc:0.69670	val-aucpr:0.21405
[40]	train-logloss:0.60129	train-auc:0.70067	train-aucpr:0.31066	val-logloss:0.48736	val-auc:0.70118	val-aucpr:0.22653
[50]	train-logloss:0.59557	train-auc:0.70629	train-aucpr:0.31690	val-logloss:0.50077	val-auc:0.70571	val-aucpr:0.22322
[60]	train-logloss:0.59175	train-auc:0.70938	train-aucpr:0.32099	val-logloss:0.49084	val-auc:0.70458	val-aucpr:0.21902
[70]	train-logloss:0.58823	train-auc:0.71366	train-aucpr:0.32617	val-logloss:0.48820	val-auc:0.69847	val-aucpr:0.20659
[75]	train-logloss:0.58676	train-auc:0.71583	train-aucpr:0.32889	val-logloss:0.47447	val-auc:0.69801	val-aucpr:0.20780
[2025-11-19 09:44:18,828] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 09:44:18,828] [INFO] [<frozen importlib] - Best train loss: 0.5984
[2025-11-19 09:44:18,828] [INFO] [<frozen importlib] - Best val loss: 0.4936
[2025-11-19 09:44:18,828] [INFO] [<frozen importlib] - Best val AUC: 0.7065
[2025-11-19 09:44:18,828] [INFO] [<frozen importlib] - Best val AUCPR: 0.2268
[2025-11-19 09:44:18,832] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:44:18] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:44:29,574] [INFO] [<frozen importlib] - Optimal threshold: 0.4584
[2025-11-19 09:44:29,574] [INFO] [<frozen importlib] - Best f1: 0.2718
[2025-11-19 09:44:29,574] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:44:29,620] [INFO] [<frozen importlib] - Validation Results (threshold=0.4584):
[2025-11-19 09:44:29,621] [INFO] [<frozen importlib] -   Accuracy: 0.8806
[2025-11-19 09:44:29,621] [INFO] [<frozen importlib] -   Precision: 0.2558
[2025-11-19 09:44:29,621] [INFO] [<frozen importlib] -   Recall: 0.2899
[2025-11-19 09:44:29,621] [INFO] [<frozen importlib] -   F1 Score: 0.2718
[2025-11-19 09:44:29,621] [INFO] [<frozen importlib] -   AUROC: 0.7065
[2025-11-19 09:44:29,621] [INFO] [<frozen importlib] -   AUPRC: 0.2270
[2025-11-19 09:44:29,621] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:44:29,621] [INFO] [<frozen importlib] -     TN=16220, FP=1225
[2025-11-19 09:44:29,621] [INFO] [<frozen importlib] -     FN=1031, TP=421
[2025-11-19 09:44:29,646] [INFO] [<frozen importlib] - Trial 477: AUPRC=0.2270, F1=0.4258, Prec=0.3715, Rec=0.4986 | Optimizing auprc=0.2270
[2025-11-19 09:44:29,646] [INFO] [<frozen importlib] - Trial 477 pruned.
[2025-11-19 09:44:29,646] [ERROR] [<frozen importlib] - Trial 477 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  95%|█████████▌| 477/500 [1:22:27<03:58, 10.39s/it]Best trial: 289. Best value: 0.241792:  95%|█████████▌| 477/500 [1:22:27<03:58, 10.39s/it]Best trial: 289. Best value: 0.241792:  96%|█████████▌| 478/500 [1:22:27<03:53, 10.61s/it][2025-11-19 09:44:29,661] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.955336210569559
[2025-11-19 09:44:29,661] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:44:29,661] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:44:29,661] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   min_child_weight: 9
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   gamma: 0.20437038817398454
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   alpha: 0.6194964869780785
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   lambda: 0.8224658016564682
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   learning_rate: 0.03561963546057435
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   subsample: 0.7936358015020463
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   colsample_bytree: 0.5966369741993481
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5163711327652573
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   colsample_bynode: 0.8339496445393926
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:44:29,662] [INFO] [<frozen importlib] -   scale_pos_weight: 6.955336210569559
[2025-11-19 09:44:29,742] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:44:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:44:29,646] Trial 477 pruned. 
[0]	train-logloss:0.69681	train-auc:0.63961	train-aucpr:0.22324	val-logloss:0.69226	val-auc:0.54401	val-aucpr:0.10255
[10]	train-logloss:0.67279	train-auc:0.68440	train-aucpr:0.29484	val-logloss:0.64455	val-auc:0.67523	val-aucpr:0.15510
[20]	train-logloss:0.65779	train-auc:0.68798	train-aucpr:0.29942	val-logloss:0.60370	val-auc:0.69482	val-aucpr:0.19710
[30]	train-logloss:0.64721	train-auc:0.69171	train-aucpr:0.30394	val-logloss:0.56785	val-auc:0.69909	val-aucpr:0.22063
[40]	train-logloss:0.64004	train-auc:0.69582	train-aucpr:0.30830	val-logloss:0.53892	val-auc:0.71077	val-aucpr:0.22477
[50]	train-logloss:0.63379	train-auc:0.70039	train-aucpr:0.31306	val-logloss:0.52858	val-auc:0.71230	val-aucpr:0.22444
[60]	train-logloss:0.62937	train-auc:0.70491	train-aucpr:0.31727	val-logloss:0.51445	val-auc:0.71181	val-aucpr:0.22357
[70]	train-logloss:0.62581	train-auc:0.70744	train-aucpr:0.32053	val-logloss:0.50541	val-auc:0.70536	val-aucpr:0.22368
[74]	train-logloss:0.62463	train-auc:0.70886	train-aucpr:0.32200	val-logloss:0.50556	val-auc:0.70307	val-aucpr:0.22106
[2025-11-19 09:44:29,979] [INFO] [<frozen importlib] - Training completed at iteration 45
[2025-11-19 09:44:29,979] [INFO] [<frozen importlib] - Best train loss: 0.6366
[2025-11-19 09:44:29,979] [INFO] [<frozen importlib] - Best val loss: 0.5281
[2025-11-19 09:44:29,979] [INFO] [<frozen importlib] - Best val AUC: 0.7130
[2025-11-19 09:44:29,979] [INFO] [<frozen importlib] - Best val AUCPR: 0.2280
[2025-11-19 09:44:29,983] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:44:29] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:44:40,331] [INFO] [<frozen importlib] - Optimal threshold: 0.4768
[2025-11-19 09:44:40,331] [INFO] [<frozen importlib] - Best f1: 0.2842
[2025-11-19 09:44:40,331] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:44:40,409] [INFO] [<frozen importlib] - Validation Results (threshold=0.4768):
[2025-11-19 09:44:40,410] [INFO] [<frozen importlib] -   Accuracy: 0.8958
[2025-11-19 09:44:40,410] [INFO] [<frozen importlib] -   Precision: 0.3008
[2025-11-19 09:44:40,410] [INFO] [<frozen importlib] -   Recall: 0.2693
[2025-11-19 09:44:40,410] [INFO] [<frozen importlib] -   F1 Score: 0.2842
[2025-11-19 09:44:40,410] [INFO] [<frozen importlib] -   AUROC: 0.7130
[2025-11-19 09:44:40,410] [INFO] [<frozen importlib] -   AUPRC: 0.2287
[2025-11-19 09:44:40,410] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:44:40,410] [INFO] [<frozen importlib] -     TN=16536, FP=909
[2025-11-19 09:44:40,410] [INFO] [<frozen importlib] -     FN=1061, TP=391
[2025-11-19 09:44:40,496] [INFO] [<frozen importlib] - Trial 478: AUPRC=0.2287, F1=0.4359, Prec=0.4199, Rec=0.4532 | Optimizing auprc=0.2287
[2025-11-19 09:44:40,496] [INFO] [<frozen importlib] - Trial 478 pruned.
[2025-11-19 09:44:40,496] [ERROR] [<frozen importlib] - Trial 478 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  96%|█████████▌| 478/500 [1:22:38<03:53, 10.61s/it]Best trial: 289. Best value: 0.241792:  96%|█████████▌| 478/500 [1:22:38<03:53, 10.61s/it]Best trial: 289. Best value: 0.241792:  96%|█████████▌| 479/500 [1:22:38<03:44, 10.68s/it][2025-11-19 09:44:40,511] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.647523077726509
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   gamma: 0.13798838097652413
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   alpha: 0.5658166289417892
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   lambda: 1.267580718432304
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   learning_rate: 0.038853694652820105
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   subsample: 0.867045427163784
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   colsample_bytree: 0.5575423783303254
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5343961319658471
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   colsample_bynode: 0.7140063889953735
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:44:40,511] [INFO] [<frozen importlib] -   scale_pos_weight: 5.647523077726509
[2025-11-19 09:44:40,589] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:44:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:44:40,496] Trial 478 pruned. 
[0]	train-logloss:0.62411	train-auc:0.63841	train-aucpr:0.22718	val-logloss:0.61181	val-auc:0.62854	val-aucpr:0.12385
[10]	train-logloss:0.60253	train-auc:0.67972	train-aucpr:0.28896	val-logloss:0.55988	val-auc:0.69820	val-aucpr:0.20289
[20]	train-logloss:0.58882	train-auc:0.68747	train-aucpr:0.29811	val-logloss:0.52729	val-auc:0.70209	val-aucpr:0.20951
[30]	train-logloss:0.57944	train-auc:0.69363	train-aucpr:0.30400	val-logloss:0.50693	val-auc:0.70010	val-aucpr:0.21836
[40]	train-logloss:0.57291	train-auc:0.69851	train-aucpr:0.30892	val-logloss:0.49602	val-auc:0.69549	val-aucpr:0.21755
[50]	train-logloss:0.56771	train-auc:0.70363	train-aucpr:0.31423	val-logloss:0.48719	val-auc:0.69972	val-aucpr:0.21475
[58]	train-logloss:0.56485	train-auc:0.70670	train-aucpr:0.31704	val-logloss:0.48300	val-auc:0.69279	val-aucpr:0.21283
[2025-11-19 09:44:40,800] [INFO] [<frozen importlib] - Training completed at iteration 29
[2025-11-19 09:44:40,800] [INFO] [<frozen importlib] - Best train loss: 0.5801
[2025-11-19 09:44:40,800] [INFO] [<frozen importlib] - Best val loss: 0.5095
[2025-11-19 09:44:40,800] [INFO] [<frozen importlib] - Best val AUC: 0.7006
[2025-11-19 09:44:40,800] [INFO] [<frozen importlib] - Best val AUCPR: 0.2188
[2025-11-19 09:44:40,804] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:44:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:44:48,485] [INFO] [<frozen importlib] - Optimal threshold: 0.4584
[2025-11-19 09:44:48,485] [INFO] [<frozen importlib] - Best f1: 0.2566
[2025-11-19 09:44:48,485] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:44:48,526] [INFO] [<frozen importlib] - Validation Results (threshold=0.4584):
[2025-11-19 09:44:48,526] [INFO] [<frozen importlib] -   Accuracy: 0.8902
[2025-11-19 09:44:48,526] [INFO] [<frozen importlib] -   Precision: 0.2676
[2025-11-19 09:44:48,526] [INFO] [<frozen importlib] -   Recall: 0.2466
[2025-11-19 09:44:48,526] [INFO] [<frozen importlib] -   F1 Score: 0.2566
[2025-11-19 09:44:48,526] [INFO] [<frozen importlib] -   AUROC: 0.7006
[2025-11-19 09:44:48,526] [INFO] [<frozen importlib] -   AUPRC: 0.2191
[2025-11-19 09:44:48,526] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:44:48,526] [INFO] [<frozen importlib] -     TN=16465, FP=980
[2025-11-19 09:44:48,526] [INFO] [<frozen importlib] -     FN=1094, TP=358
[2025-11-19 09:44:48,551] [INFO] [<frozen importlib] - Trial 479: AUPRC=0.2191, F1=0.4264, Prec=0.4021, Rec=0.4539 | Optimizing auprc=0.2191
[2025-11-19 09:44:48,552] [INFO] [<frozen importlib] - Trial 479 pruned.
[2025-11-19 09:44:48,552] [ERROR] [<frozen importlib] - Trial 479 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  96%|█████████▌| 479/500 [1:22:46<03:44, 10.68s/it]Best trial: 289. Best value: 0.241792:  96%|█████████▌| 479/500 [1:22:46<03:44, 10.68s/it]Best trial: 289. Best value: 0.241792:  96%|█████████▌| 480/500 [1:22:46<03:17,  9.89s/it][2025-11-19 09:44:48,568] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 7.247554115683813
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   gamma: 0.18900842124684977
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   alpha: 0.38041887003990327
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   lambda: 0.9785375406822643
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   learning_rate: 0.034533644341514576
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   subsample: 0.8154867550569218
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   colsample_bytree: 0.6020385777614905
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5088464436740697
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   colsample_bynode: 0.7346888999672986
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:44:48,568] [INFO] [<frozen importlib] -   scale_pos_weight: 7.247554115683813
[2025-11-19 09:44:48,648] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:44:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:44:48,552] Trial 479 pruned. 
[0]	train-logloss:0.71229	train-auc:0.64332	train-aucpr:0.25530	val-logloss:0.71301	val-auc:0.58551	val-aucpr:0.11209
[10]	train-logloss:0.68827	train-auc:0.68311	train-aucpr:0.29249	val-logloss:0.65288	val-auc:0.68349	val-aucpr:0.18920
[20]	train-logloss:0.67355	train-auc:0.68670	train-aucpr:0.29554	val-logloss:0.61253	val-auc:0.67345	val-aucpr:0.20089
[30]	train-logloss:0.66308	train-auc:0.69083	train-aucpr:0.30080	val-logloss:0.57866	val-auc:0.69455	val-aucpr:0.21775
[40]	train-logloss:0.65566	train-auc:0.69457	train-aucpr:0.30634	val-logloss:0.55099	val-auc:0.70348	val-aucpr:0.22020
[50]	train-logloss:0.64936	train-auc:0.69818	train-aucpr:0.31042	val-logloss:0.53917	val-auc:0.70412	val-aucpr:0.22094
[60]	train-logloss:0.64476	train-auc:0.70221	train-aucpr:0.31426	val-logloss:0.53518	val-auc:0.70162	val-aucpr:0.21659
[68]	train-logloss:0.64162	train-auc:0.70523	train-aucpr:0.31714	val-logloss:0.52111	val-auc:0.69591	val-aucpr:0.21884
[2025-11-19 09:44:48,862] [INFO] [<frozen importlib] - Training completed at iteration 39
[2025-11-19 09:44:48,862] [INFO] [<frozen importlib] - Best train loss: 0.6563
[2025-11-19 09:44:48,862] [INFO] [<frozen importlib] - Best val loss: 0.5539
[2025-11-19 09:44:48,862] [INFO] [<frozen importlib] - Best val AUC: 0.7034
[2025-11-19 09:44:48,862] [INFO] [<frozen importlib] - Best val AUCPR: 0.2217
[2025-11-19 09:44:48,867] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:44:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:44:57,515] [INFO] [<frozen importlib] - Optimal threshold: 0.4955
[2025-11-19 09:44:57,515] [INFO] [<frozen importlib] - Best f1: 0.2783
[2025-11-19 09:44:57,515] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:44:57,559] [INFO] [<frozen importlib] - Validation Results (threshold=0.4955):
[2025-11-19 09:44:57,559] [INFO] [<frozen importlib] -   Accuracy: 0.8946
[2025-11-19 09:44:57,559] [INFO] [<frozen importlib] -   Precision: 0.2936
[2025-11-19 09:44:57,559] [INFO] [<frozen importlib] -   Recall: 0.2645
[2025-11-19 09:44:57,559] [INFO] [<frozen importlib] -   F1 Score: 0.2783
[2025-11-19 09:44:57,559] [INFO] [<frozen importlib] -   AUROC: 0.7034
[2025-11-19 09:44:57,559] [INFO] [<frozen importlib] -   AUPRC: 0.2221
[2025-11-19 09:44:57,559] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:44:57,559] [INFO] [<frozen importlib] -     TN=16521, FP=924
[2025-11-19 09:44:57,559] [INFO] [<frozen importlib] -     FN=1068, TP=384
[2025-11-19 09:44:57,582] [INFO] [<frozen importlib] - Trial 480: AUPRC=0.2221, F1=0.4506, Prec=0.4279, Rec=0.4759 | Optimizing auprc=0.2221
[2025-11-19 09:44:57,582] [INFO] [<frozen importlib] - Trial 480 pruned.
[2025-11-19 09:44:57,583] [ERROR] [<frozen importlib] - Trial 480 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  96%|█████████▌| 480/500 [1:22:55<03:17,  9.89s/it]Best trial: 289. Best value: 0.241792:  96%|█████████▌| 480/500 [1:22:55<03:17,  9.89s/it]Best trial: 289. Best value: 0.241792:  96%|█████████▌| 481/500 [1:22:55<03:03,  9.64s/it][2025-11-19 09:44:57,597] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.5653276246130465
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   gamma: 0.11689633529169995
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   alpha: 0.7378970521109665
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   lambda: 0.6059680290667039
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   learning_rate: 0.03686546947846338
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   subsample: 0.8351582830155745
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   colsample_bytree: 0.5489381685674914
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5228636863792654
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   colsample_bynode: 0.7746122788906139
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:44:57,597] [INFO] [<frozen importlib] -   scale_pos_weight: 6.5653276246130465
[2025-11-19 09:44:57,668] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:44:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:44:57,583] Trial 480 pruned. 
[0]	train-logloss:0.67509	train-auc:0.64824	train-aucpr:0.25396	val-logloss:0.66903	val-auc:0.61377	val-aucpr:0.13489
[10]	train-logloss:0.65180	train-auc:0.68164	train-aucpr:0.28908	val-logloss:0.61317	val-auc:0.67495	val-aucpr:0.19502
[20]	train-logloss:0.63759	train-auc:0.68644	train-aucpr:0.29943	val-logloss:0.57356	val-auc:0.70138	val-aucpr:0.21252
[30]	train-logloss:0.62782	train-auc:0.69041	train-aucpr:0.30362	val-logloss:0.54113	val-auc:0.70079	val-aucpr:0.22113
[40]	train-logloss:0.62073	train-auc:0.69480	train-aucpr:0.30753	val-logloss:0.52419	val-auc:0.69805	val-aucpr:0.21806
[50]	train-logloss:0.61484	train-auc:0.69896	train-aucpr:0.31239	val-logloss:0.51196	val-auc:0.70038	val-aucpr:0.22048
[60]	train-logloss:0.61104	train-auc:0.70260	train-aucpr:0.31515	val-logloss:0.50413	val-auc:0.69821	val-aucpr:0.22019
[65]	train-logloss:0.60894	train-auc:0.70529	train-aucpr:0.31763	val-logloss:0.49749	val-auc:0.69765	val-aucpr:0.21731
[2025-11-19 09:44:57,867] [INFO] [<frozen importlib] - Training completed at iteration 35
[2025-11-19 09:44:57,867] [INFO] [<frozen importlib] - Best train loss: 0.6241
[2025-11-19 09:44:57,867] [INFO] [<frozen importlib] - Best val loss: 0.5266
[2025-11-19 09:44:57,867] [INFO] [<frozen importlib] - Best val AUC: 0.6995
[2025-11-19 09:44:57,867] [INFO] [<frozen importlib] - Best val AUCPR: 0.2222
[2025-11-19 09:44:57,872] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:44:57] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:45:03,870] [INFO] [<frozen importlib] - Optimal threshold: 0.4855
[2025-11-19 09:45:03,870] [INFO] [<frozen importlib] - Best f1: 0.2609
[2025-11-19 09:45:03,870] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:45:03,911] [INFO] [<frozen importlib] - Validation Results (threshold=0.4855):
[2025-11-19 09:45:03,911] [INFO] [<frozen importlib] -   Accuracy: 0.8960
[2025-11-19 09:45:03,911] [INFO] [<frozen importlib] -   Precision: 0.2873
[2025-11-19 09:45:03,911] [INFO] [<frozen importlib] -   Recall: 0.2390
[2025-11-19 09:45:03,911] [INFO] [<frozen importlib] -   F1 Score: 0.2609
[2025-11-19 09:45:03,911] [INFO] [<frozen importlib] -   AUROC: 0.6995
[2025-11-19 09:45:03,911] [INFO] [<frozen importlib] -   AUPRC: 0.2224
[2025-11-19 09:45:03,911] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:45:03,911] [INFO] [<frozen importlib] -     TN=16584, FP=861
[2025-11-19 09:45:03,912] [INFO] [<frozen importlib] -     FN=1105, TP=347
[2025-11-19 09:45:03,937] [INFO] [<frozen importlib] - Trial 481: AUPRC=0.2224, F1=0.4492, Prec=0.4376, Rec=0.4614 | Optimizing auprc=0.2224
[2025-11-19 09:45:03,938] [INFO] [<frozen importlib] - Trial 481 pruned.
[2025-11-19 09:45:03,938] [ERROR] [<frozen importlib] - Trial 481 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  96%|█████████▌| 481/500 [1:23:01<03:03,  9.64s/it]Best trial: 289. Best value: 0.241792:  96%|█████████▌| 481/500 [1:23:01<03:03,  9.64s/it]Best trial: 289. Best value: 0.241792:  96%|█████████▋| 482/500 [1:23:01<02:35,  8.65s/it][2025-11-19 09:45:03,955] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.923304753837014
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   gamma: 0.23055911077698352
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   alpha: 0.4461562283663237
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   lambda: 1.1861036958968167
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   learning_rate: 0.032544679125694795
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   subsample: 0.8556896312807162
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   colsample_bytree: 0.6161819724560134
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5001179074686214
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   colsample_bynode: 0.8082407745293092
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:45:03,955] [INFO] [<frozen importlib] -   scale_pos_weight: 5.923304753837014
[2025-11-19 09:45:04,028] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:45:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:45:03,938] Trial 481 pruned. 
[0]	train-logloss:0.63996	train-auc:0.64913	train-aucpr:0.24266	val-logloss:0.62874	val-auc:0.62298	val-aucpr:0.11458
[10]	train-logloss:0.62023	train-auc:0.67984	train-aucpr:0.28994	val-logloss:0.57742	val-auc:0.69070	val-aucpr:0.20066
[20]	train-logloss:0.60681	train-auc:0.68581	train-aucpr:0.29741	val-logloss:0.54226	val-auc:0.69135	val-aucpr:0.20599
[30]	train-logloss:0.59771	train-auc:0.69020	train-aucpr:0.30332	val-logloss:0.51509	val-auc:0.69935	val-aucpr:0.21918
[40]	train-logloss:0.59111	train-auc:0.69423	train-aucpr:0.30721	val-logloss:0.49323	val-auc:0.70211	val-aucpr:0.21882
[50]	train-logloss:0.58582	train-auc:0.69891	train-aucpr:0.31096	val-logloss:0.47993	val-auc:0.70697	val-aucpr:0.22070
[60]	train-logloss:0.58150	train-auc:0.70365	train-aucpr:0.31472	val-logloss:0.47942	val-auc:0.70039	val-aucpr:0.21321
[70]	train-logloss:0.57815	train-auc:0.70646	train-aucpr:0.31766	val-logloss:0.48077	val-auc:0.70144	val-aucpr:0.21579
[79]	train-logloss:0.57592	train-auc:0.70802	train-aucpr:0.31962	val-logloss:0.47516	val-auc:0.70362	val-aucpr:0.21786
[2025-11-19 09:45:04,264] [INFO] [<frozen importlib] - Training completed at iteration 49
[2025-11-19 09:45:04,264] [INFO] [<frozen importlib] - Best train loss: 0.5862
[2025-11-19 09:45:04,264] [INFO] [<frozen importlib] - Best val loss: 0.4819
[2025-11-19 09:45:04,264] [INFO] [<frozen importlib] - Best val AUC: 0.7065
[2025-11-19 09:45:04,264] [INFO] [<frozen importlib] - Best val AUCPR: 0.2207
[2025-11-19 09:45:04,268] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:45:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:45:13,484] [INFO] [<frozen importlib] - Optimal threshold: 0.4403
[2025-11-19 09:45:13,484] [INFO] [<frozen importlib] - Best f1: 0.2658
[2025-11-19 09:45:13,484] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:45:13,527] [INFO] [<frozen importlib] - Validation Results (threshold=0.4403):
[2025-11-19 09:45:13,527] [INFO] [<frozen importlib] -   Accuracy: 0.8834
[2025-11-19 09:45:13,527] [INFO] [<frozen importlib] -   Precision: 0.2574
[2025-11-19 09:45:13,527] [INFO] [<frozen importlib] -   Recall: 0.2748
[2025-11-19 09:45:13,527] [INFO] [<frozen importlib] -   F1 Score: 0.2658
[2025-11-19 09:45:13,527] [INFO] [<frozen importlib] -   AUROC: 0.7065
[2025-11-19 09:45:13,527] [INFO] [<frozen importlib] -   AUPRC: 0.2211
[2025-11-19 09:45:13,527] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:45:13,527] [INFO] [<frozen importlib] -     TN=16294, FP=1151
[2025-11-19 09:45:13,527] [INFO] [<frozen importlib] -     FN=1053, TP=399
[2025-11-19 09:45:13,550] [INFO] [<frozen importlib] - Trial 482: AUPRC=0.2211, F1=0.4390, Prec=0.3887, Rec=0.5041 | Optimizing auprc=0.2211
                                                                                          Best trial: 289. Best value: 0.241792:  96%|█████████▋| 482/500 [1:23:11<02:35,  8.65s/it]Best trial: 289. Best value: 0.241792:  96%|█████████▋| 482/500 [1:23:11<02:35,  8.65s/it]Best trial: 289. Best value: 0.241792:  97%|█████████▋| 483/500 [1:23:11<02:31,  8.94s/it][2025-11-19 09:45:13,569] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.262378958988997
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   gamma: 0.16568671386137618
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   alpha: 0.5313088415871708
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   lambda: 0.8846638562135112
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   learning_rate: 0.03975929291400398
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   subsample: 0.8020358244095278
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   colsample_bytree: 0.6335873568479978
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5571557362704114
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   colsample_bynode: 0.7653159344443436
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:45:13,570] [INFO] [<frozen importlib] -   scale_pos_weight: 6.262378958988997
[2025-11-19 09:45:13,644] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:45:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:45:13,551] Trial 482 finished with value: 0.2210666475405016 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.23055911077698352, 'learning_rate': 0.032544679125694795, 'n_estimators': 300, 'alpha': 0.4461562283663237, 'lambda': 1.1861036958968167, 'subsample': 0.8556896312807162, 'colsample_bytree': 0.6161819724560134, 'colsample_bylevel': 0.5001179074686214, 'colsample_bynode': 0.8082407745293092, 'scale_pos_weight': 5.923304753837014}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.65827	train-auc:0.65118	train-aucpr:0.23393	val-logloss:0.65054	val-auc:0.53863	val-aucpr:0.08288
[10]	train-logloss:0.63387	train-auc:0.68141	train-aucpr:0.29179	val-logloss:0.58395	val-auc:0.67723	val-aucpr:0.17946
[20]	train-logloss:0.61907	train-auc:0.68893	train-aucpr:0.30097	val-logloss:0.55021	val-auc:0.69116	val-aucpr:0.19826
[30]	train-logloss:0.60944	train-auc:0.69537	train-aucpr:0.30659	val-logloss:0.52271	val-auc:0.69976	val-aucpr:0.21275
[40]	train-logloss:0.60279	train-auc:0.70016	train-aucpr:0.31069	val-logloss:0.49949	val-auc:0.69543	val-aucpr:0.20788
[50]	train-logloss:0.59708	train-auc:0.70403	train-aucpr:0.31564	val-logloss:0.49112	val-auc:0.70131	val-aucpr:0.21329
[60]	train-logloss:0.59324	train-auc:0.70733	train-aucpr:0.31885	val-logloss:0.48341	val-auc:0.69997	val-aucpr:0.21473
[70]	train-logloss:0.58958	train-auc:0.71159	train-aucpr:0.32361	val-logloss:0.47232	val-auc:0.70148	val-aucpr:0.21574
[80]	train-logloss:0.58645	train-auc:0.71597	train-aucpr:0.32797	val-logloss:0.46917	val-auc:0.69944	val-aucpr:0.21180
[90]	train-logloss:0.58393	train-auc:0.72032	train-aucpr:0.33187	val-logloss:0.46759	val-auc:0.69587	val-aucpr:0.20721
[97]	train-logloss:0.58244	train-auc:0.72282	train-aucpr:0.33469	val-logloss:0.45845	val-auc:0.69304	val-aucpr:0.19841
[2025-11-19 09:45:13,923] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:45:13,923] [INFO] [<frozen importlib] - Best train loss: 0.5902
[2025-11-19 09:45:13,923] [INFO] [<frozen importlib] - Best val loss: 0.4753
[2025-11-19 09:45:13,923] [INFO] [<frozen importlib] - Best val AUC: 0.7017
[2025-11-19 09:45:13,923] [INFO] [<frozen importlib] - Best val AUCPR: 0.2158
[2025-11-19 09:45:13,928] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:45:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:45:27,397] [INFO] [<frozen importlib] - Optimal threshold: 0.4622
[2025-11-19 09:45:27,397] [INFO] [<frozen importlib] - Best f1: 0.2756
[2025-11-19 09:45:27,397] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:45:27,442] [INFO] [<frozen importlib] - Validation Results (threshold=0.4622):
[2025-11-19 09:45:27,443] [INFO] [<frozen importlib] -   Accuracy: 0.8940
[2025-11-19 09:45:27,443] [INFO] [<frozen importlib] -   Precision: 0.2902
[2025-11-19 09:45:27,443] [INFO] [<frozen importlib] -   Recall: 0.2624
[2025-11-19 09:45:27,443] [INFO] [<frozen importlib] -   F1 Score: 0.2756
[2025-11-19 09:45:27,443] [INFO] [<frozen importlib] -   AUROC: 0.7017
[2025-11-19 09:45:27,443] [INFO] [<frozen importlib] -   AUPRC: 0.2164
[2025-11-19 09:45:27,443] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:45:27,443] [INFO] [<frozen importlib] -     TN=16513, FP=932
[2025-11-19 09:45:27,443] [INFO] [<frozen importlib] -     FN=1071, TP=381
[2025-11-19 09:45:27,466] [INFO] [<frozen importlib] - Trial 483: AUPRC=0.2164, F1=0.4509, Prec=0.4268, Rec=0.4780 | Optimizing auprc=0.2164
[2025-11-19 09:45:27,466] [INFO] [<frozen importlib] - Trial 483 pruned.
[2025-11-19 09:45:27,466] [ERROR] [<frozen importlib] - Trial 483 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  97%|█████████▋| 483/500 [1:23:25<02:31,  8.94s/it]Best trial: 289. Best value: 0.241792:  97%|█████████▋| 483/500 [1:23:25<02:31,  8.94s/it]Best trial: 289. Best value: 0.241792:  97%|█████████▋| 484/500 [1:23:25<02:46, 10.43s/it][2025-11-19 09:45:27,481] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.797994692840366
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   min_child_weight: 4
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   gamma: 0.211247204686869
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   alpha: 0.6730232827800688
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   lambda: 1.4445302724952365
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   learning_rate: 0.03771365490892274
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   subsample: 0.822853804456719
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   colsample_bytree: 0.5874168185372668
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5148614601153222
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   colsample_bynode: 0.7958583498471977
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:45:27,481] [INFO] [<frozen importlib] -   scale_pos_weight: 6.797994692840366
[2025-11-19 09:45:27,558] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:45:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:45:27,466] Trial 483 pruned. 
[0]	train-logloss:0.68833	train-auc:0.63034	train-aucpr:0.22306	val-logloss:0.68560	val-auc:0.61043	val-aucpr:0.12169
[10]	train-logloss:0.66336	train-auc:0.68049	train-aucpr:0.28621	val-logloss:0.62822	val-auc:0.69110	val-aucpr:0.18536
[20]	train-logloss:0.64850	train-auc:0.68631	train-aucpr:0.29902	val-logloss:0.59214	val-auc:0.68857	val-aucpr:0.20292
[30]	train-logloss:0.63843	train-auc:0.69223	train-aucpr:0.30473	val-logloss:0.56518	val-auc:0.69755	val-aucpr:0.21853
[40]	train-logloss:0.63165	train-auc:0.69697	train-aucpr:0.30730	val-logloss:0.54634	val-auc:0.69665	val-aucpr:0.21779
[50]	train-logloss:0.62538	train-auc:0.70249	train-aucpr:0.31312	val-logloss:0.53435	val-auc:0.69886	val-aucpr:0.21578
[60]	train-logloss:0.62095	train-auc:0.70695	train-aucpr:0.31710	val-logloss:0.53089	val-auc:0.69708	val-aucpr:0.21957
[70]	train-logloss:0.61728	train-auc:0.71091	train-aucpr:0.32159	val-logloss:0.52715	val-auc:0.69330	val-aucpr:0.21566
[76]	train-logloss:0.61516	train-auc:0.71367	train-aucpr:0.32450	val-logloss:0.51328	val-auc:0.69493	val-aucpr:0.21825
[2025-11-19 09:45:27,800] [INFO] [<frozen importlib] - Training completed at iteration 47
[2025-11-19 09:45:27,800] [INFO] [<frozen importlib] - Best train loss: 0.6270
[2025-11-19 09:45:27,800] [INFO] [<frozen importlib] - Best val loss: 0.5423
[2025-11-19 09:45:27,800] [INFO] [<frozen importlib] - Best val AUC: 0.7004
[2025-11-19 09:45:27,800] [INFO] [<frozen importlib] - Best val AUCPR: 0.2197
[2025-11-19 09:45:27,805] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:45:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:45:37,797] [INFO] [<frozen importlib] - Optimal threshold: 0.4919
[2025-11-19 09:45:37,797] [INFO] [<frozen importlib] - Best f1: 0.2613
[2025-11-19 09:45:37,797] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:45:37,845] [INFO] [<frozen importlib] - Validation Results (threshold=0.4919):
[2025-11-19 09:45:37,845] [INFO] [<frozen importlib] -   Accuracy: 0.8785
[2025-11-19 09:45:37,845] [INFO] [<frozen importlib] -   Precision: 0.2452
[2025-11-19 09:45:37,845] [INFO] [<frozen importlib] -   Recall: 0.2796
[2025-11-19 09:45:37,845] [INFO] [<frozen importlib] -   F1 Score: 0.2613
[2025-11-19 09:45:37,845] [INFO] [<frozen importlib] -   AUROC: 0.7004
[2025-11-19 09:45:37,845] [INFO] [<frozen importlib] -   AUPRC: 0.2201
[2025-11-19 09:45:37,845] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:45:37,845] [INFO] [<frozen importlib] -     TN=16195, FP=1250
[2025-11-19 09:45:37,845] [INFO] [<frozen importlib] -     FN=1046, TP=406
[2025-11-19 09:45:37,873] [INFO] [<frozen importlib] - Trial 484: AUPRC=0.2201, F1=0.4323, Prec=0.3734, Rec=0.5131 | Optimizing auprc=0.2201
[2025-11-19 09:45:37,874] [INFO] [<frozen importlib] - Trial 484 pruned.
[2025-11-19 09:45:37,874] [ERROR] [<frozen importlib] - Trial 484 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  97%|█████████▋| 484/500 [1:23:35<02:46, 10.43s/it]Best trial: 289. Best value: 0.241792:  97%|█████████▋| 484/500 [1:23:35<02:46, 10.43s/it]Best trial: 289. Best value: 0.241792:  97%|█████████▋| 485/500 [1:23:35<02:36, 10.42s/it][2025-11-19 09:45:37,888] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.667583865959681
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   gamma: 0.24626770250258773
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   alpha: 0.5860729487019445
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   lambda: 0.7378350487469936
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   learning_rate: 0.035720865698858656
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   subsample: 0.8454103820714688
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   colsample_bytree: 0.5759851153362837
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5377258145728406
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   colsample_bynode: 0.7814893034952566
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:45:37,888] [INFO] [<frozen importlib] -   scale_pos_weight: 5.667583865959681
[2025-11-19 09:45:37,974] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:45:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:45:37,874] Trial 484 pruned. 
[0]	train-logloss:0.62548	train-auc:0.63671	train-aucpr:0.23594	val-logloss:0.61359	val-auc:0.61140	val-aucpr:0.12761
[10]	train-logloss:0.60442	train-auc:0.68337	train-aucpr:0.29301	val-logloss:0.56881	val-auc:0.70778	val-aucpr:0.21951
[20]	train-logloss:0.59137	train-auc:0.68811	train-aucpr:0.29977	val-logloss:0.54029	val-auc:0.70642	val-aucpr:0.21727
[30]	train-logloss:0.58210	train-auc:0.69385	train-aucpr:0.30411	val-logloss:0.51456	val-auc:0.70902	val-aucpr:0.22536
[40]	train-logloss:0.57569	train-auc:0.69720	train-aucpr:0.30770	val-logloss:0.49466	val-auc:0.70997	val-aucpr:0.22739
[50]	train-logloss:0.57049	train-auc:0.70216	train-aucpr:0.31219	val-logloss:0.48785	val-auc:0.71267	val-aucpr:0.23318
[60]	train-logloss:0.56651	train-auc:0.70539	train-aucpr:0.31590	val-logloss:0.47494	val-auc:0.71041	val-aucpr:0.23604
[70]	train-logloss:0.56324	train-auc:0.70912	train-aucpr:0.31943	val-logloss:0.46859	val-auc:0.71148	val-aucpr:0.23006
[80]	train-logloss:0.56025	train-auc:0.71307	train-aucpr:0.32435	val-logloss:0.46470	val-auc:0.70580	val-aucpr:0.22744
[85]	train-logloss:0.55910	train-auc:0.71488	train-aucpr:0.32574	val-logloss:0.46101	val-auc:0.70454	val-aucpr:0.22658
[2025-11-19 09:45:40,459] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:45:40,459] [INFO] [<frozen importlib] - Best train loss: 0.5683
[2025-11-19 09:45:40,459] [INFO] [<frozen importlib] - Best val loss: 0.4806
[2025-11-19 09:45:40,459] [INFO] [<frozen importlib] - Best val AUC: 0.7123
[2025-11-19 09:45:40,459] [INFO] [<frozen importlib] - Best val AUCPR: 0.2367
[2025-11-19 09:45:40,462] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:45:40] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:45:51,375] [INFO] [<frozen importlib] - Optimal threshold: 0.4562
[2025-11-19 09:45:51,375] [INFO] [<frozen importlib] - Best f1: 0.2739
[2025-11-19 09:45:51,375] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:45:51,471] [INFO] [<frozen importlib] - Validation Results (threshold=0.4562):
[2025-11-19 09:45:51,471] [INFO] [<frozen importlib] -   Accuracy: 0.8970
[2025-11-19 09:45:51,471] [INFO] [<frozen importlib] -   Precision: 0.2989
[2025-11-19 09:45:51,471] [INFO] [<frozen importlib] -   Recall: 0.2528
[2025-11-19 09:45:51,471] [INFO] [<frozen importlib] -   F1 Score: 0.2739
[2025-11-19 09:45:51,472] [INFO] [<frozen importlib] -   AUROC: 0.7123
[2025-11-19 09:45:51,472] [INFO] [<frozen importlib] -   AUPRC: 0.2369
[2025-11-19 09:45:51,472] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:45:51,472] [INFO] [<frozen importlib] -     TN=16584, FP=861
[2025-11-19 09:45:51,472] [INFO] [<frozen importlib] -     FN=1085, TP=367
[2025-11-19 09:45:51,502] [INFO] [<frozen importlib] - Trial 485: AUPRC=0.2369, F1=0.4503, Prec=0.4384, Rec=0.4628 | Optimizing auprc=0.2369
                                                                                          Best trial: 289. Best value: 0.241792:  97%|█████████▋| 485/500 [1:23:49<02:36, 10.42s/it]Best trial: 289. Best value: 0.241792:  97%|█████████▋| 485/500 [1:23:49<02:36, 10.42s/it]Best trial: 289. Best value: 0.241792:  97%|█████████▋| 486/500 [1:23:49<02:39, 11.39s/it][2025-11-19 09:45:51,517] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.613653412128748
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   gamma: 0.25858602630406463
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   alpha: 0.6415936064579879
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   lambda: 1.1135584925179782
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   learning_rate: 0.031030271366014762
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   subsample: 0.8464901363605493
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   colsample_bytree: 0.7980381135093189
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5352866875022569
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   colsample_bynode: 0.7814242530427927
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:45:51,517] [INFO] [<frozen importlib] -   scale_pos_weight: 5.613653412128748
[2025-11-19 09:45:51,589] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:45:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:45:51,502] Trial 485 finished with value: 0.23694917674413155 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.24626770250258773, 'learning_rate': 0.035720865698858656, 'n_estimators': 450, 'alpha': 0.5860729487019445, 'lambda': 0.7378350487469936, 'subsample': 0.8454103820714688, 'colsample_bytree': 0.5759851153362837, 'colsample_bylevel': 0.5377258145728406, 'colsample_bynode': 0.7814893034952566, 'scale_pos_weight': 5.667583865959681}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.62264	train-auc:0.64778	train-aucpr:0.23581	val-logloss:0.61007	val-auc:0.57618	val-aucpr:0.09029
[10]	train-logloss:0.60378	train-auc:0.67881	train-aucpr:0.28821	val-logloss:0.56260	val-auc:0.68576	val-aucpr:0.19247
[20]	train-logloss:0.59137	train-auc:0.68347	train-aucpr:0.29310	val-logloss:0.53164	val-auc:0.69866	val-aucpr:0.21261
[30]	train-logloss:0.58222	train-auc:0.68912	train-aucpr:0.30194	val-logloss:0.50570	val-auc:0.69779	val-aucpr:0.21629
[40]	train-logloss:0.57537	train-auc:0.69460	train-aucpr:0.30615	val-logloss:0.48476	val-auc:0.70027	val-aucpr:0.21699
[50]	train-logloss:0.57026	train-auc:0.69767	train-aucpr:0.30960	val-logloss:0.47731	val-auc:0.70350	val-aucpr:0.22183
[60]	train-logloss:0.56649	train-auc:0.70018	train-aucpr:0.31241	val-logloss:0.46633	val-auc:0.70476	val-aucpr:0.22463
[70]	train-logloss:0.56345	train-auc:0.70337	train-aucpr:0.31504	val-logloss:0.45325	val-auc:0.70633	val-aucpr:0.22687
[80]	train-logloss:0.56077	train-auc:0.70626	train-aucpr:0.31894	val-logloss:0.45563	val-auc:0.71330	val-aucpr:0.23177
[90]	train-logloss:0.55817	train-auc:0.70996	train-aucpr:0.32251	val-logloss:0.44326	val-auc:0.71222	val-aucpr:0.22694
[100]	train-logloss:0.55571	train-auc:0.71385	train-aucpr:0.32655	val-logloss:0.43476	val-auc:0.70696	val-aucpr:0.22700
[109]	train-logloss:0.55370	train-auc:0.71768	train-aucpr:0.33021	val-logloss:0.42733	val-auc:0.70475	val-aucpr:0.22466
[2025-11-19 09:45:51,979] [INFO] [<frozen importlib] - Training completed at iteration 79
[2025-11-19 09:45:51,979] [INFO] [<frozen importlib] - Best train loss: 0.5610
[2025-11-19 09:45:51,979] [INFO] [<frozen importlib] - Best val loss: 0.4536
[2025-11-19 09:45:51,979] [INFO] [<frozen importlib] - Best val AUC: 0.7133
[2025-11-19 09:45:51,979] [INFO] [<frozen importlib] - Best val AUCPR: 0.2326
[2025-11-19 09:45:51,982] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:45:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:46:05,030] [INFO] [<frozen importlib] - Optimal threshold: 0.4437
[2025-11-19 09:46:05,030] [INFO] [<frozen importlib] - Best f1: 0.2862
[2025-11-19 09:46:05,030] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:46:05,119] [INFO] [<frozen importlib] - Validation Results (threshold=0.4437):
[2025-11-19 09:46:05,119] [INFO] [<frozen importlib] -   Accuracy: 0.8984
[2025-11-19 09:46:05,119] [INFO] [<frozen importlib] -   Precision: 0.3110
[2025-11-19 09:46:05,119] [INFO] [<frozen importlib] -   Recall: 0.2652
[2025-11-19 09:46:05,119] [INFO] [<frozen importlib] -   F1 Score: 0.2862
[2025-11-19 09:46:05,120] [INFO] [<frozen importlib] -   AUROC: 0.7133
[2025-11-19 09:46:05,120] [INFO] [<frozen importlib] -   AUPRC: 0.2331
[2025-11-19 09:46:05,120] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:46:05,120] [INFO] [<frozen importlib] -     TN=16592, FP=853
[2025-11-19 09:46:05,120] [INFO] [<frozen importlib] -     FN=1067, TP=385
[2025-11-19 09:46:05,144] [INFO] [<frozen importlib] - Trial 486: AUPRC=0.2331, F1=0.4541, Prec=0.4425, Rec=0.4663 | Optimizing auprc=0.2331
                                                                                          Best trial: 289. Best value: 0.241792:  97%|█████████▋| 486/500 [1:24:03<02:39, 11.39s/it]Best trial: 289. Best value: 0.241792:  97%|█████████▋| 486/500 [1:24:03<02:39, 11.39s/it]Best trial: 289. Best value: 0.241792:  97%|█████████▋| 487/500 [1:24:03<02:36, 12.06s/it][2025-11-19 09:46:05,161] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 17.306294911539183
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   gamma: 0.24111612779666305
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   alpha: 0.5982143697611821
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   lambda: 0.7578117660756504
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   learning_rate: 0.03566782721636263
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   subsample: 0.8607246122862529
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   colsample_bytree: 0.5624562140627943
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5262864914263512
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   colsample_bynode: 0.7852013876212579
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:46:05,161] [INFO] [<frozen importlib] -   scale_pos_weight: 17.306294911539183
[2025-11-19 09:46:05,238] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:46:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:46:05,145] Trial 486 finished with value: 0.23307904566750243 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.25858602630406463, 'learning_rate': 0.031030271366014762, 'n_estimators': 350, 'alpha': 0.6415936064579879, 'lambda': 1.1135584925179782, 'subsample': 0.8464901363605493, 'colsample_bytree': 0.7980381135093189, 'colsample_bylevel': 0.5352866875022569, 'colsample_bynode': 0.7814242530427927, 'scale_pos_weight': 5.613653412128748}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:1.10284	train-auc:0.63561	train-aucpr:0.20635	val-logloss:1.13692	val-auc:0.64102	val-aucpr:0.15982
[10]	train-logloss:1.07005	train-auc:0.68073	train-aucpr:0.27301	val-logloss:1.04213	val-auc:0.68377	val-aucpr:0.19248
[20]	train-logloss:1.05131	train-auc:0.68665	train-aucpr:0.28815	val-logloss:0.98609	val-auc:0.68946	val-aucpr:0.20133
[30]	train-logloss:1.03818	train-auc:0.69291	train-aucpr:0.29780	val-logloss:0.93923	val-auc:0.69591	val-aucpr:0.21656
[40]	train-logloss:1.02883	train-auc:0.69666	train-aucpr:0.30434	val-logloss:0.90161	val-auc:0.69719	val-aucpr:0.22187
[50]	train-logloss:1.02054	train-auc:0.70200	train-aucpr:0.30717	val-logloss:0.88475	val-auc:0.70478	val-aucpr:0.22034
[60]	train-logloss:1.01493	train-auc:0.70612	train-aucpr:0.30986	val-logloss:0.87095	val-auc:0.70203	val-aucpr:0.21955
[70]	train-logloss:1.00887	train-auc:0.71056	train-aucpr:0.31340	val-logloss:0.86575	val-auc:0.68951	val-aucpr:0.19784
[77]	train-logloss:1.00524	train-auc:0.71379	train-aucpr:0.31689	val-logloss:0.84816	val-auc:0.69220	val-aucpr:0.20511
[2025-11-19 09:46:05,476] [INFO] [<frozen importlib] - Training completed at iteration 48
[2025-11-19 09:46:05,476] [INFO] [<frozen importlib] - Best train loss: 1.0221
[2025-11-19 09:46:05,476] [INFO] [<frozen importlib] - Best val loss: 0.8923
[2025-11-19 09:46:05,476] [INFO] [<frozen importlib] - Best val AUC: 0.7075
[2025-11-19 09:46:05,476] [INFO] [<frozen importlib] - Best val AUCPR: 0.2267
[2025-11-19 09:46:05,479] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:46:05] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:46:16,401] [INFO] [<frozen importlib] - Optimal threshold: 0.7036
[2025-11-19 09:46:16,401] [INFO] [<frozen importlib] - Best f1: 0.2763
[2025-11-19 09:46:16,401] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:46:16,453] [INFO] [<frozen importlib] - Validation Results (threshold=0.7036):
[2025-11-19 09:46:16,454] [INFO] [<frozen importlib] -   Accuracy: 0.9033
[2025-11-19 09:46:16,454] [INFO] [<frozen importlib] -   Precision: 0.3250
[2025-11-19 09:46:16,454] [INFO] [<frozen importlib] -   Recall: 0.2404
[2025-11-19 09:46:16,454] [INFO] [<frozen importlib] -   F1 Score: 0.2763
[2025-11-19 09:46:16,454] [INFO] [<frozen importlib] -   AUROC: 0.7075
[2025-11-19 09:46:16,454] [INFO] [<frozen importlib] -   AUPRC: 0.2271
[2025-11-19 09:46:16,454] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:46:16,454] [INFO] [<frozen importlib] -     TN=16720, FP=725
[2025-11-19 09:46:16,454] [INFO] [<frozen importlib] -     FN=1103, TP=349
[2025-11-19 09:46:16,480] [INFO] [<frozen importlib] - Trial 487: AUPRC=0.2271, F1=0.4383, Prec=0.4573, Rec=0.4208 | Optimizing auprc=0.2271
[2025-11-19 09:46:16,481] [INFO] [<frozen importlib] - Trial 487 pruned.
[2025-11-19 09:46:16,481] [ERROR] [<frozen importlib] - Trial 487 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  97%|█████████▋| 487/500 [1:24:14<02:36, 12.06s/it]Best trial: 289. Best value: 0.241792:  97%|█████████▋| 487/500 [1:24:14<02:36, 12.06s/it]Best trial: 289. Best value: 0.241792:  98%|█████████▊| 488/500 [1:24:14<02:22, 11.84s/it][2025-11-19 09:46:16,506] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.208466227878506
[2025-11-19 09:46:16,506] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:46:16,506] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:46:16,506] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:46:16,506] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:46:16,506] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:46:16,506] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:46:16,506] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:46:16,506] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   gamma: 0.14916412703270565
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   alpha: 0.6950915638836035
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   lambda: 1.0045022412253868
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   learning_rate: 0.033612217278819995
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   subsample: 0.8419875055583624
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   colsample_bytree: 0.5742240418540702
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5421422153574457
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   colsample_bynode: 0.7699023519734822
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:46:16,507] [INFO] [<frozen importlib] -   scale_pos_weight: 5.208466227878506
[2025-11-19 09:46:16,585] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:46:16] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:46:16,481] Trial 487 pruned. 
[0]	train-logloss:0.59943	train-auc:0.63823	train-aucpr:0.23698	val-logloss:0.58382	val-auc:0.61021	val-aucpr:0.12050
[10]	train-logloss:0.58043	train-auc:0.68181	train-aucpr:0.29207	val-logloss:0.53504	val-auc:0.69936	val-aucpr:0.21156
[20]	train-logloss:0.56859	train-auc:0.68627	train-aucpr:0.29593	val-logloss:0.51300	val-auc:0.69931	val-aucpr:0.21300
[30]	train-logloss:0.56028	train-auc:0.69102	train-aucpr:0.30152	val-logloss:0.49437	val-auc:0.69486	val-aucpr:0.21812
[40]	train-logloss:0.55358	train-auc:0.69639	train-aucpr:0.30687	val-logloss:0.47719	val-auc:0.70368	val-aucpr:0.21894
[50]	train-logloss:0.54868	train-auc:0.69977	train-aucpr:0.31079	val-logloss:0.46505	val-auc:0.70622	val-aucpr:0.22081
[60]	train-logloss:0.54493	train-auc:0.70302	train-aucpr:0.31372	val-logloss:0.45712	val-auc:0.70585	val-aucpr:0.22070
[70]	train-logloss:0.54153	train-auc:0.70702	train-aucpr:0.31850	val-logloss:0.45203	val-auc:0.70560	val-aucpr:0.21729
[74]	train-logloss:0.54048	train-auc:0.70849	train-aucpr:0.32018	val-logloss:0.44801	val-auc:0.70420	val-aucpr:0.21477
[2025-11-19 09:46:19,114] [INFO] [<frozen importlib] - Training completed at iteration 44
[2025-11-19 09:46:19,114] [INFO] [<frozen importlib] - Best train loss: 0.5514
[2025-11-19 09:46:19,114] [INFO] [<frozen importlib] - Best val loss: 0.4663
[2025-11-19 09:46:19,114] [INFO] [<frozen importlib] - Best val AUC: 0.7098
[2025-11-19 09:46:19,114] [INFO] [<frozen importlib] - Best val AUCPR: 0.2219
[2025-11-19 09:46:19,117] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:46:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:46:30,062] [INFO] [<frozen importlib] - Optimal threshold: 0.4248
[2025-11-19 09:46:30,062] [INFO] [<frozen importlib] - Best f1: 0.2677
[2025-11-19 09:46:30,062] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:46:30,114] [INFO] [<frozen importlib] - Validation Results (threshold=0.4248):
[2025-11-19 09:46:30,114] [INFO] [<frozen importlib] -   Accuracy: 0.8943
[2025-11-19 09:46:30,115] [INFO] [<frozen importlib] -   Precision: 0.2863
[2025-11-19 09:46:30,115] [INFO] [<frozen importlib] -   Recall: 0.2514
[2025-11-19 09:46:30,115] [INFO] [<frozen importlib] -   F1 Score: 0.2677
[2025-11-19 09:46:30,115] [INFO] [<frozen importlib] -   AUROC: 0.7098
[2025-11-19 09:46:30,115] [INFO] [<frozen importlib] -   AUPRC: 0.2223
[2025-11-19 09:46:30,115] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:46:30,115] [INFO] [<frozen importlib] -     TN=16535, FP=910
[2025-11-19 09:46:30,115] [INFO] [<frozen importlib] -     FN=1087, TP=365
[2025-11-19 09:46:30,147] [INFO] [<frozen importlib] - Trial 488: AUPRC=0.2223, F1=0.4280, Prec=0.4140, Rec=0.4428 | Optimizing auprc=0.2223
[2025-11-19 09:46:30,147] [INFO] [<frozen importlib] - Trial 488 pruned.
[2025-11-19 09:46:30,147] [ERROR] [<frozen importlib] - Trial 488 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  98%|█████████▊| 488/500 [1:24:28<02:22, 11.84s/it]Best trial: 289. Best value: 0.241792:  98%|█████████▊| 488/500 [1:24:28<02:22, 11.84s/it]Best trial: 289. Best value: 0.241792:  98%|█████████▊| 489/500 [1:24:28<02:16, 12.39s/it][2025-11-19 09:46:30,162] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.8010168622647855
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   gamma: 0.24992017730755636
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   alpha: 0.5937984015455386
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   lambda: 1.266223289154142
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   learning_rate: 0.034639715029819454
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   subsample: 0.8341131040032066
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   colsample_bytree: 0.5768792868877793
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5179102769111441
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   colsample_bynode: 0.751448704810725
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:46:30,162] [INFO] [<frozen importlib] -   scale_pos_weight: 5.8010168622647855
[2025-11-19 09:46:30,235] [INFO] [<frozen importlib] - Training with 350 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:46:30] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:46:30,147] Trial 488 pruned. 
[0]	train-logloss:0.63311	train-auc:0.64151	train-aucpr:0.23198	val-logloss:0.62333	val-auc:0.61110	val-aucpr:0.11822
[10]	train-logloss:0.61248	train-auc:0.68319	train-aucpr:0.29113	val-logloss:0.57557	val-auc:0.70307	val-aucpr:0.20958
[20]	train-logloss:0.59954	train-auc:0.68791	train-aucpr:0.29615	val-logloss:0.54061	val-auc:0.70651	val-aucpr:0.22163
[30]	train-logloss:0.59031	train-auc:0.69179	train-aucpr:0.30248	val-logloss:0.50656	val-auc:0.70505	val-aucpr:0.21838
[40]	train-logloss:0.58380	train-auc:0.69662	train-aucpr:0.30723	val-logloss:0.49031	val-auc:0.70567	val-aucpr:0.22769
[50]	train-logloss:0.57830	train-auc:0.70063	train-aucpr:0.31081	val-logloss:0.49323	val-auc:0.70671	val-aucpr:0.23179
[60]	train-logloss:0.57446	train-auc:0.70372	train-aucpr:0.31482	val-logloss:0.48099	val-auc:0.70629	val-aucpr:0.23346
[70]	train-logloss:0.57068	train-auc:0.70730	train-aucpr:0.31895	val-logloss:0.47663	val-auc:0.70385	val-aucpr:0.22939
[80]	train-logloss:0.56781	train-auc:0.70992	train-aucpr:0.32259	val-logloss:0.47476	val-auc:0.70226	val-aucpr:0.22487
[90]	train-logloss:0.56543	train-auc:0.71353	train-aucpr:0.32619	val-logloss:0.46658	val-auc:0.69039	val-aucpr:0.22105
[91]	train-logloss:0.56519	train-auc:0.71439	train-aucpr:0.32667	val-logloss:0.46714	val-auc:0.69092	val-aucpr:0.22099
[2025-11-19 09:46:34,175] [INFO] [<frozen importlib] - Training completed at iteration 62
[2025-11-19 09:46:34,175] [INFO] [<frozen importlib] - Best train loss: 0.5738
[2025-11-19 09:46:34,175] [INFO] [<frozen importlib] - Best val loss: 0.4774
[2025-11-19 09:46:34,175] [INFO] [<frozen importlib] - Best val AUC: 0.7064
[2025-11-19 09:46:34,175] [INFO] [<frozen importlib] - Best val AUCPR: 0.2337
[2025-11-19 09:46:34,179] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:46:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:46:48,203] [INFO] [<frozen importlib] - Optimal threshold: 0.4644
[2025-11-19 09:46:48,203] [INFO] [<frozen importlib] - Best f1: 0.2728
[2025-11-19 09:46:48,203] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:46:48,257] [INFO] [<frozen importlib] - Validation Results (threshold=0.4644):
[2025-11-19 09:46:48,257] [INFO] [<frozen importlib] -   Accuracy: 0.9078
[2025-11-19 09:46:48,257] [INFO] [<frozen importlib] -   Precision: 0.3460
[2025-11-19 09:46:48,257] [INFO] [<frozen importlib] -   Recall: 0.2252
[2025-11-19 09:46:48,257] [INFO] [<frozen importlib] -   F1 Score: 0.2728
[2025-11-19 09:46:48,257] [INFO] [<frozen importlib] -   AUROC: 0.7064
[2025-11-19 09:46:48,257] [INFO] [<frozen importlib] -   AUPRC: 0.2340
[2025-11-19 09:46:48,257] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:46:48,257] [INFO] [<frozen importlib] -     TN=16827, FP=618
[2025-11-19 09:46:48,257] [INFO] [<frozen importlib] -     FN=1125, TP=327
[2025-11-19 09:46:48,283] [INFO] [<frozen importlib] - Trial 489: AUPRC=0.2340, F1=0.4672, Prec=0.5052, Rec=0.4346 | Optimizing auprc=0.2340
                                                                                          Best trial: 289. Best value: 0.241792:  98%|█████████▊| 489/500 [1:24:46<02:16, 12.39s/it]Best trial: 289. Best value: 0.241792:  98%|█████████▊| 489/500 [1:24:46<02:16, 12.39s/it]Best trial: 289. Best value: 0.241792:  98%|█████████▊| 490/500 [1:24:46<02:21, 14.11s/it][2025-11-19 09:46:48,309] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.421051696973723
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   min_child_weight: 8
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   gamma: 0.10243190981809003
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   alpha: 0.2881530021154225
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   lambda: 0.8755446598515723
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   learning_rate: 0.03299413985389894
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   subsample: 0.8511987063626926
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   colsample_bytree: 0.5680722998924747
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   colsample_bylevel: 0.531288408371155
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   colsample_bynode: 0.7924872983293113
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:46:48,310] [INFO] [<frozen importlib] -   scale_pos_weight: 5.421051696973723
[2025-11-19 09:46:48,388] [INFO] [<frozen importlib] - Training with 250 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:46:48] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:46:48,284] Trial 489 finished with value: 0.23401189476915127 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.24992017730755636, 'learning_rate': 0.034639715029819454, 'n_estimators': 350, 'alpha': 0.5937984015455386, 'lambda': 1.266223289154142, 'subsample': 0.8341131040032066, 'colsample_bytree': 0.5768792868877793, 'colsample_bylevel': 0.5179102769111441, 'colsample_bynode': 0.751448704810725, 'scale_pos_weight': 5.8010168622647855}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.61159	train-auc:0.63961	train-aucpr:0.23751	val-logloss:0.59719	val-auc:0.62695	val-aucpr:0.12596
[10]	train-logloss:0.59237	train-auc:0.68308	train-aucpr:0.29175	val-logloss:0.54869	val-auc:0.70509	val-aucpr:0.21559
[20]	train-logloss:0.58017	train-auc:0.68627	train-aucpr:0.29722	val-logloss:0.52151	val-auc:0.69580	val-aucpr:0.21043
[30]	train-logloss:0.57160	train-auc:0.69152	train-aucpr:0.30330	val-logloss:0.50017	val-auc:0.69347	val-aucpr:0.21731
[40]	train-logloss:0.56499	train-auc:0.69514	train-aucpr:0.30668	val-logloss:0.48527	val-auc:0.70283	val-aucpr:0.22163
[50]	train-logloss:0.55963	train-auc:0.69909	train-aucpr:0.31178	val-logloss:0.47585	val-auc:0.70362	val-aucpr:0.22669
[60]	train-logloss:0.55616	train-auc:0.70218	train-aucpr:0.31409	val-logloss:0.47025	val-auc:0.69932	val-aucpr:0.22552
[70]	train-logloss:0.55268	train-auc:0.70654	train-aucpr:0.31845	val-logloss:0.46684	val-auc:0.70110	val-aucpr:0.22271
[80]	train-logloss:0.55008	train-auc:0.70982	train-aucpr:0.32171	val-logloss:0.45628	val-auc:0.70336	val-aucpr:0.22430
[85]	train-logloss:0.54884	train-auc:0.71152	train-aucpr:0.32296	val-logloss:0.45534	val-auc:0.70406	val-aucpr:0.22308
[2025-11-19 09:46:52,071] [INFO] [<frozen importlib] - Training completed at iteration 56
[2025-11-19 09:46:52,071] [INFO] [<frozen importlib] - Best train loss: 0.5575
[2025-11-19 09:46:52,071] [INFO] [<frozen importlib] - Best val loss: 0.4686
[2025-11-19 09:46:52,071] [INFO] [<frozen importlib] - Best val AUC: 0.7043
[2025-11-19 09:46:52,071] [INFO] [<frozen importlib] - Best val AUCPR: 0.2281
[2025-11-19 09:46:52,074] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:46:52] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:47:04,256] [INFO] [<frozen importlib] - Optimal threshold: 0.4461
[2025-11-19 09:47:04,256] [INFO] [<frozen importlib] - Best f1: 0.2677
[2025-11-19 09:47:04,257] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:47:04,306] [INFO] [<frozen importlib] - Validation Results (threshold=0.4461):
[2025-11-19 09:47:04,307] [INFO] [<frozen importlib] -   Accuracy: 0.9077
[2025-11-19 09:47:04,307] [INFO] [<frozen importlib] -   Precision: 0.3426
[2025-11-19 09:47:04,307] [INFO] [<frozen importlib] -   Recall: 0.2197
[2025-11-19 09:47:04,307] [INFO] [<frozen importlib] -   F1 Score: 0.2677
[2025-11-19 09:47:04,307] [INFO] [<frozen importlib] -   AUROC: 0.7043
[2025-11-19 09:47:04,307] [INFO] [<frozen importlib] -   AUPRC: 0.2285
[2025-11-19 09:47:04,307] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:47:04,307] [INFO] [<frozen importlib] -     TN=16833, FP=612
[2025-11-19 09:47:04,307] [INFO] [<frozen importlib] -     FN=1133, TP=319
[2025-11-19 09:47:04,337] [INFO] [<frozen importlib] - Trial 490: AUPRC=0.2285, F1=0.4481, Prec=0.4934, Rec=0.4105 | Optimizing auprc=0.2285
[2025-11-19 09:47:04,338] [INFO] [<frozen importlib] - Trial 490 pruned.
[2025-11-19 09:47:04,338] [ERROR] [<frozen importlib] - Trial 490 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  98%|█████████▊| 490/500 [1:25:02<02:21, 14.11s/it]Best trial: 289. Best value: 0.241792:  98%|█████████▊| 490/500 [1:25:02<02:21, 14.11s/it]Best trial: 289. Best value: 0.241792:  98%|█████████▊| 491/500 [1:25:02<02:12, 14.70s/it][2025-11-19 09:47:04,352] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.03848731381517
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   gamma: 0.12713451292858954
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   alpha: 0.6415885565490851
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   lambda: 1.1153189907343912
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   learning_rate: 0.036308270514962125
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   subsample: 0.8836626667431343
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   colsample_bytree: 0.5836034383500198
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5111200017726342
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   colsample_bynode: 0.7611972339463359
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:47:04,352] [INFO] [<frozen importlib] -   scale_pos_weight: 6.03848731381517
[2025-11-19 09:47:04,432] [INFO] [<frozen importlib] - Training with 400 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:47:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:47:04,338] Trial 490 pruned. 
[0]	train-logloss:0.64652	train-auc:0.63275	train-aucpr:0.22769	val-logloss:0.63876	val-auc:0.60100	val-aucpr:0.11438
[10]	train-logloss:0.62486	train-auc:0.68037	train-aucpr:0.29077	val-logloss:0.58536	val-auc:0.70058	val-aucpr:0.20757
[20]	train-logloss:0.61109	train-auc:0.68563	train-aucpr:0.29872	val-logloss:0.55844	val-auc:0.69670	val-aucpr:0.21317
[30]	train-logloss:0.60191	train-auc:0.69091	train-aucpr:0.30347	val-logloss:0.53681	val-auc:0.68834	val-aucpr:0.21404
[40]	train-logloss:0.59527	train-auc:0.69649	train-aucpr:0.30616	val-logloss:0.52319	val-auc:0.69425	val-aucpr:0.21767
[50]	train-logloss:0.58936	train-auc:0.70129	train-aucpr:0.31205	val-logloss:0.51373	val-auc:0.69516	val-aucpr:0.21976
[60]	train-logloss:0.58547	train-auc:0.70415	train-aucpr:0.31549	val-logloss:0.50352	val-auc:0.69955	val-aucpr:0.22425
[70]	train-logloss:0.58203	train-auc:0.70800	train-aucpr:0.31943	val-logloss:0.50456	val-auc:0.70027	val-aucpr:0.22140
[80]	train-logloss:0.57886	train-auc:0.71188	train-aucpr:0.32422	val-logloss:0.49030	val-auc:0.70348	val-aucpr:0.22276
[90]	train-logloss:0.57644	train-auc:0.71442	train-aucpr:0.32752	val-logloss:0.48972	val-auc:0.69529	val-aucpr:0.21218
[91]	train-logloss:0.57623	train-auc:0.71469	train-aucpr:0.32784	val-logloss:0.48876	val-auc:0.69514	val-aucpr:0.21233
[2025-11-19 09:47:08,745] [INFO] [<frozen importlib] - Training completed at iteration 61
[2025-11-19 09:47:08,745] [INFO] [<frozen importlib] - Best train loss: 0.5851
[2025-11-19 09:47:08,745] [INFO] [<frozen importlib] - Best val loss: 0.5007
[2025-11-19 09:47:08,745] [INFO] [<frozen importlib] - Best val AUC: 0.7024
[2025-11-19 09:47:08,745] [INFO] [<frozen importlib] - Best val AUCPR: 0.2245
[2025-11-19 09:47:08,748] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:47:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:47:21,593] [INFO] [<frozen importlib] - Optimal threshold: 0.4717
[2025-11-19 09:47:21,593] [INFO] [<frozen importlib] - Best f1: 0.2699
[2025-11-19 09:47:21,593] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:47:21,647] [INFO] [<frozen importlib] - Validation Results (threshold=0.4717):
[2025-11-19 09:47:21,647] [INFO] [<frozen importlib] -   Accuracy: 0.8995
[2025-11-19 09:47:21,647] [INFO] [<frozen importlib] -   Precision: 0.3055
[2025-11-19 09:47:21,647] [INFO] [<frozen importlib] -   Recall: 0.2417
[2025-11-19 09:47:21,647] [INFO] [<frozen importlib] -   F1 Score: 0.2699
[2025-11-19 09:47:21,647] [INFO] [<frozen importlib] -   AUROC: 0.7024
[2025-11-19 09:47:21,647] [INFO] [<frozen importlib] -   AUPRC: 0.2249
[2025-11-19 09:47:21,647] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:47:21,647] [INFO] [<frozen importlib] -     TN=16647, FP=798
[2025-11-19 09:47:21,647] [INFO] [<frozen importlib] -     FN=1101, TP=351
[2025-11-19 09:47:21,676] [INFO] [<frozen importlib] - Trial 491: AUPRC=0.2249, F1=0.4694, Prec=0.4637, Rec=0.4752 | Optimizing auprc=0.2249
[2025-11-19 09:47:21,676] [INFO] [<frozen importlib] - Trial 491 pruned.
[2025-11-19 09:47:21,677] [ERROR] [<frozen importlib] - Trial 491 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  98%|█████████▊| 491/500 [1:25:19<02:12, 14.70s/it]Best trial: 289. Best value: 0.241792:  98%|█████████▊| 491/500 [1:25:19<02:12, 14.70s/it]Best trial: 289. Best value: 0.241792:  98%|█████████▊| 492/500 [1:25:19<02:03, 15.49s/it][2025-11-19 09:47:21,691] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.001577799024344
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   gamma: 0.17702623947834556
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   alpha: 0.3468142671402486
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   lambda: 0.9701673555818763
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   learning_rate: 0.0349753900373006
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   subsample: 0.8675087261056339
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   colsample_bytree: 0.590807340773556
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5233420920825438
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   colsample_bynode: 0.7770164888996419
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:47:21,691] [INFO] [<frozen importlib] -   scale_pos_weight: 5.001577799024344
[2025-11-19 09:47:21,768] [INFO] [<frozen importlib] - Training with 300 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:47:21] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:47:21,677] Trial 491 pruned. 
[0]	train-logloss:0.58764	train-auc:0.62937	train-aucpr:0.22662	val-logloss:0.57069	val-auc:0.61896	val-aucpr:0.12020
[10]	train-logloss:0.56838	train-auc:0.68021	train-aucpr:0.29247	val-logloss:0.52964	val-auc:0.69875	val-aucpr:0.21060
[20]	train-logloss:0.55635	train-auc:0.68634	train-aucpr:0.29851	val-logloss:0.50173	val-auc:0.68729	val-aucpr:0.21828
[30]	train-logloss:0.54787	train-auc:0.69027	train-aucpr:0.30359	val-logloss:0.47839	val-auc:0.69873	val-aucpr:0.22654
[40]	train-logloss:0.54201	train-auc:0.69498	train-aucpr:0.30713	val-logloss:0.46172	val-auc:0.70050	val-aucpr:0.22438
[50]	train-logloss:0.53691	train-auc:0.69970	train-aucpr:0.31185	val-logloss:0.45409	val-auc:0.70670	val-aucpr:0.23024
[60]	train-logloss:0.53342	train-auc:0.70263	train-aucpr:0.31527	val-logloss:0.44565	val-auc:0.70610	val-aucpr:0.23016
[70]	train-logloss:0.53044	train-auc:0.70594	train-aucpr:0.31921	val-logloss:0.44184	val-auc:0.70789	val-aucpr:0.22862
[80]	train-logloss:0.52764	train-auc:0.71043	train-aucpr:0.32290	val-logloss:0.43121	val-auc:0.70824	val-aucpr:0.22924
[90]	train-logloss:0.52520	train-auc:0.71417	train-aucpr:0.32705	val-logloss:0.43225	val-auc:0.70245	val-aucpr:0.22647
[95]	train-logloss:0.52419	train-auc:0.71587	train-aucpr:0.32869	val-logloss:0.43102	val-auc:0.69952	val-aucpr:0.22547
[2025-11-19 09:47:25,418] [INFO] [<frozen importlib] - Training completed at iteration 65
[2025-11-19 09:47:25,418] [INFO] [<frozen importlib] - Best train loss: 0.5319
[2025-11-19 09:47:25,418] [INFO] [<frozen importlib] - Best val loss: 0.4405
[2025-11-19 09:47:25,418] [INFO] [<frozen importlib] - Best val AUC: 0.7091
[2025-11-19 09:47:25,418] [INFO] [<frozen importlib] - Best val AUCPR: 0.2321
[2025-11-19 09:47:25,421] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:47:25] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:47:37,140] [INFO] [<frozen importlib] - Optimal threshold: 0.4298
[2025-11-19 09:47:37,140] [INFO] [<frozen importlib] - Best f1: 0.2739
[2025-11-19 09:47:37,140] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:47:37,205] [INFO] [<frozen importlib] - Validation Results (threshold=0.4298):
[2025-11-19 09:47:37,205] [INFO] [<frozen importlib] -   Accuracy: 0.9013
[2025-11-19 09:47:37,205] [INFO] [<frozen importlib] -   Precision: 0.3148
[2025-11-19 09:47:37,205] [INFO] [<frozen importlib] -   Recall: 0.2424
[2025-11-19 09:47:37,205] [INFO] [<frozen importlib] -   F1 Score: 0.2739
[2025-11-19 09:47:37,205] [INFO] [<frozen importlib] -   AUROC: 0.7091
[2025-11-19 09:47:37,205] [INFO] [<frozen importlib] -   AUPRC: 0.2324
[2025-11-19 09:47:37,206] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:47:37,206] [INFO] [<frozen importlib] -     TN=16679, FP=766
[2025-11-19 09:47:37,206] [INFO] [<frozen importlib] -     FN=1100, TP=352
[2025-11-19 09:47:37,233] [INFO] [<frozen importlib] - Trial 492: AUPRC=0.2324, F1=0.4603, Prec=0.4640, Rec=0.4566 | Optimizing auprc=0.2324
                                                                                          Best trial: 289. Best value: 0.241792:  98%|█████████▊| 492/500 [1:25:35<02:03, 15.49s/it]Best trial: 289. Best value: 0.241792:  98%|█████████▊| 492/500 [1:25:35<02:03, 15.49s/it]Best trial: 289. Best value: 0.241792:  99%|█████████▊| 493/500 [1:25:35<01:48, 15.51s/it][2025-11-19 09:47:37,247] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.728237512610679
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   gamma: 0.2597553038869572
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   alpha: 0.5651552377495166
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   lambda: 1.347576587599629
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   learning_rate: 0.031833414213270725
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   subsample: 0.8316675384072425
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   colsample_bytree: 0.5974890391028279
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5401505242547537
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   colsample_bynode: 0.803171903011483
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:47:37,248] [INFO] [<frozen importlib] -   scale_pos_weight: 5.728237512610679
[2025-11-19 09:47:37,319] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:47:37] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:47:37,233] Trial 492 finished with value: 0.23243251535292273 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.17702623947834556, 'learning_rate': 0.0349753900373006, 'n_estimators': 300, 'alpha': 0.3468142671402486, 'lambda': 0.9701673555818763, 'subsample': 0.8675087261056339, 'colsample_bytree': 0.590807340773556, 'colsample_bylevel': 0.5233420920825438, 'colsample_bynode': 0.7770164888996419, 'scale_pos_weight': 5.001577799024344}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.62944	train-auc:0.63263	train-aucpr:0.22126	val-logloss:0.61769	val-auc:0.64306	val-aucpr:0.15077
[10]	train-logloss:0.61001	train-auc:0.68110	train-aucpr:0.29116	val-logloss:0.57737	val-auc:0.69911	val-aucpr:0.20819
[20]	train-logloss:0.59714	train-auc:0.68799	train-aucpr:0.29939	val-logloss:0.54399	val-auc:0.71406	val-aucpr:0.22629
[30]	train-logloss:0.58774	train-auc:0.69080	train-aucpr:0.30408	val-logloss:0.51497	val-auc:0.71614	val-aucpr:0.23274
[40]	train-logloss:0.58117	train-auc:0.69546	train-aucpr:0.30772	val-logloss:0.49961	val-auc:0.72188	val-aucpr:0.23659
[50]	train-logloss:0.57565	train-auc:0.69843	train-aucpr:0.31143	val-logloss:0.48810	val-auc:0.71817	val-aucpr:0.23461
[60]	train-logloss:0.57192	train-auc:0.70137	train-aucpr:0.31475	val-logloss:0.48429	val-auc:0.71226	val-aucpr:0.23565
[69]	train-logloss:0.56871	train-auc:0.70575	train-aucpr:0.31829	val-logloss:0.48324	val-auc:0.71441	val-aucpr:0.23232
[2025-11-19 09:47:41,715] [INFO] [<frozen importlib] - Training completed at iteration 40
[2025-11-19 09:47:41,715] [INFO] [<frozen importlib] - Best train loss: 0.5812
[2025-11-19 09:47:41,715] [INFO] [<frozen importlib] - Best val loss: 0.4996
[2025-11-19 09:47:41,715] [INFO] [<frozen importlib] - Best val AUC: 0.7219
[2025-11-19 09:47:41,715] [INFO] [<frozen importlib] - Best val AUCPR: 0.2366
[2025-11-19 09:47:41,719] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:47:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:47:49,908] [INFO] [<frozen importlib] - Optimal threshold: 0.4486
[2025-11-19 09:47:49,908] [INFO] [<frozen importlib] - Best f1: 0.2887
[2025-11-19 09:47:49,908] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:47:49,966] [INFO] [<frozen importlib] - Validation Results (threshold=0.4486):
[2025-11-19 09:47:49,967] [INFO] [<frozen importlib] -   Accuracy: 0.8944
[2025-11-19 09:47:49,967] [INFO] [<frozen importlib] -   Precision: 0.2991
[2025-11-19 09:47:49,967] [INFO] [<frozen importlib] -   Recall: 0.2789
[2025-11-19 09:47:49,967] [INFO] [<frozen importlib] -   F1 Score: 0.2887
[2025-11-19 09:47:49,967] [INFO] [<frozen importlib] -   AUROC: 0.7219
[2025-11-19 09:47:49,967] [INFO] [<frozen importlib] -   AUPRC: 0.2370
[2025-11-19 09:47:49,967] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:47:49,967] [INFO] [<frozen importlib] -     TN=16496, FP=949
[2025-11-19 09:47:49,967] [INFO] [<frozen importlib] -     FN=1047, TP=405
[2025-11-19 09:47:49,993] [INFO] [<frozen importlib] - Trial 493: AUPRC=0.2370, F1=0.4510, Prec=0.4242, Rec=0.4814 | Optimizing auprc=0.2370
                                                                                          Best trial: 289. Best value: 0.241792:  99%|█████████▊| 493/500 [1:25:47<01:48, 15.51s/it]Best trial: 289. Best value: 0.241792:  99%|█████████▊| 493/500 [1:25:47<01:48, 15.51s/it]Best trial: 289. Best value: 0.241792:  99%|█████████▉| 494/500 [1:25:47<01:28, 14.68s/it][2025-11-19 09:47:50,014] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.1845131606287085
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   gamma: 0.26391128691021176
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   alpha: 0.5471965534655737
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   lambda: 1.4860175006656808
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   learning_rate: 0.030572496959543807
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   subsample: 0.822981511141707
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   colsample_bytree: 0.6067977401075976
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5002183768790084
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   colsample_bynode: 0.7994784528876554
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:47:50,014] [INFO] [<frozen importlib] -   scale_pos_weight: 6.1845131606287085
[2025-11-19 09:47:50,086] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:47:50] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:47:49,994] Trial 493 finished with value: 0.23695743740335629 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.2597553038869572, 'learning_rate': 0.031833414213270725, 'n_estimators': 450, 'alpha': 0.5651552377495166, 'lambda': 1.347576587599629, 'subsample': 0.8316675384072425, 'colsample_bytree': 0.5974890391028279, 'colsample_bylevel': 0.5401505242547537, 'colsample_bynode': 0.803171903011483, 'scale_pos_weight': 5.728237512610679}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.65475	train-auc:0.64315	train-aucpr:0.25132	val-logloss:0.64795	val-auc:0.58551	val-aucpr:0.11212
[10]	train-logloss:0.63543	train-auc:0.68090	train-aucpr:0.29011	val-logloss:0.59997	val-auc:0.67583	val-aucpr:0.18669
[20]	train-logloss:0.62258	train-auc:0.68558	train-aucpr:0.29576	val-logloss:0.56576	val-auc:0.67045	val-aucpr:0.19894
[30]	train-logloss:0.61325	train-auc:0.68889	train-aucpr:0.30041	val-logloss:0.53815	val-auc:0.69559	val-aucpr:0.20989
[40]	train-logloss:0.60652	train-auc:0.69214	train-aucpr:0.30416	val-logloss:0.51208	val-auc:0.70556	val-aucpr:0.21558
[50]	train-logloss:0.60078	train-auc:0.69508	train-aucpr:0.30770	val-logloss:0.49673	val-auc:0.70465	val-aucpr:0.21760
[60]	train-logloss:0.59681	train-auc:0.69879	train-aucpr:0.31077	val-logloss:0.49052	val-auc:0.70495	val-aucpr:0.22099
[70]	train-logloss:0.59315	train-auc:0.70224	train-aucpr:0.31431	val-logloss:0.49461	val-auc:0.70485	val-aucpr:0.21954
[80]	train-logloss:0.59005	train-auc:0.70668	train-aucpr:0.31827	val-logloss:0.48609	val-auc:0.70110	val-aucpr:0.21989
[90]	train-logloss:0.58725	train-auc:0.71033	train-aucpr:0.32165	val-logloss:0.48367	val-auc:0.69897	val-aucpr:0.21624
[2025-11-19 09:47:51,755] [INFO] [<frozen importlib] - Training completed at iteration 60
[2025-11-19 09:47:51,755] [INFO] [<frozen importlib] - Best train loss: 0.5968
[2025-11-19 09:47:51,755] [INFO] [<frozen importlib] - Best val loss: 0.4905
[2025-11-19 09:47:51,755] [INFO] [<frozen importlib] - Best val AUC: 0.7050
[2025-11-19 09:47:51,755] [INFO] [<frozen importlib] - Best val AUCPR: 0.2210
[2025-11-19 09:47:51,758] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:47:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:48:04,175] [INFO] [<frozen importlib] - Optimal threshold: 0.4567
[2025-11-19 09:48:04,175] [INFO] [<frozen importlib] - Best f1: 0.2696
[2025-11-19 09:48:04,175] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:48:04,218] [INFO] [<frozen importlib] - Validation Results (threshold=0.4567):
[2025-11-19 09:48:04,218] [INFO] [<frozen importlib] -   Accuracy: 0.8899
[2025-11-19 09:48:04,218] [INFO] [<frozen importlib] -   Precision: 0.2749
[2025-11-19 09:48:04,218] [INFO] [<frozen importlib] -   Recall: 0.2645
[2025-11-19 09:48:04,218] [INFO] [<frozen importlib] -   F1 Score: 0.2696
[2025-11-19 09:48:04,218] [INFO] [<frozen importlib] -   AUROC: 0.7050
[2025-11-19 09:48:04,218] [INFO] [<frozen importlib] -   AUPRC: 0.2214
[2025-11-19 09:48:04,218] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:48:04,218] [INFO] [<frozen importlib] -     TN=16432, FP=1013
[2025-11-19 09:48:04,218] [INFO] [<frozen importlib] -     FN=1068, TP=384
[2025-11-19 09:48:04,243] [INFO] [<frozen importlib] - Trial 494: AUPRC=0.2214, F1=0.4409, Prec=0.4076, Rec=0.4800 | Optimizing auprc=0.2214
[2025-11-19 09:48:04,243] [INFO] [<frozen importlib] - Trial 494 pruned.
[2025-11-19 09:48:04,244] [ERROR] [<frozen importlib] - Trial 494 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  99%|█████████▉| 494/500 [1:26:02<01:28, 14.68s/it]Best trial: 289. Best value: 0.241792:  99%|█████████▉| 494/500 [1:26:02<01:28, 14.68s/it]Best trial: 289. Best value: 0.241792:  99%|█████████▉| 495/500 [1:26:02<01:12, 14.55s/it][2025-11-19 09:48:04,257] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.889480255339241
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   gamma: 0.27314377736358375
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   alpha: 0.47174899820082744
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   lambda: 1.4112722410027307
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   learning_rate: 0.03115077406436128
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   subsample: 0.8325831864612989
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   colsample_bytree: 0.5973358575894352
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5162839996980548
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   colsample_bynode: 0.8061012055677572
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:48:04,258] [INFO] [<frozen importlib] -   scale_pos_weight: 5.889480255339241
[2025-11-19 09:48:04,327] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:48:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:48:04,244] Trial 494 pruned. 
[0]	train-logloss:0.63843	train-auc:0.63863	train-aucpr:0.22153	val-logloss:0.62776	val-auc:0.61586	val-aucpr:0.12856
[10]	train-logloss:0.61934	train-auc:0.68191	train-aucpr:0.29320	val-logloss:0.58691	val-auc:0.67750	val-aucpr:0.20087
[20]	train-logloss:0.60688	train-auc:0.68510	train-aucpr:0.29746	val-logloss:0.55279	val-auc:0.69075	val-aucpr:0.21492
[30]	train-logloss:0.59742	train-auc:0.68952	train-aucpr:0.30196	val-logloss:0.52531	val-auc:0.68462	val-aucpr:0.21887
[40]	train-logloss:0.59071	train-auc:0.69372	train-aucpr:0.30577	val-logloss:0.51033	val-auc:0.70338	val-aucpr:0.22684
[50]	train-logloss:0.58509	train-auc:0.69737	train-aucpr:0.30999	val-logloss:0.50016	val-auc:0.70112	val-aucpr:0.22860
[60]	train-logloss:0.58089	train-auc:0.70115	train-aucpr:0.31397	val-logloss:0.49780	val-auc:0.70909	val-aucpr:0.22864
[70]	train-logloss:0.57731	train-auc:0.70361	train-aucpr:0.31709	val-logloss:0.48544	val-auc:0.71119	val-aucpr:0.23183
[80]	train-logloss:0.57445	train-auc:0.70616	train-aucpr:0.32022	val-logloss:0.47920	val-auc:0.71174	val-aucpr:0.23016
[90]	train-logloss:0.57226	train-auc:0.70904	train-aucpr:0.32295	val-logloss:0.47567	val-auc:0.70898	val-aucpr:0.22885
[97]	train-logloss:0.57057	train-auc:0.71200	train-aucpr:0.32574	val-logloss:0.48086	val-auc:0.70596	val-aucpr:0.22474
[2025-11-19 09:48:08,664] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:48:08,664] [INFO] [<frozen importlib] - Best train loss: 0.5781
[2025-11-19 09:48:08,664] [INFO] [<frozen importlib] - Best val loss: 0.4846
[2025-11-19 09:48:08,664] [INFO] [<frozen importlib] - Best val AUC: 0.7112
[2025-11-19 09:48:08,664] [INFO] [<frozen importlib] - Best val AUCPR: 0.2321
[2025-11-19 09:48:08,669] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:48:08] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:48:22,521] [INFO] [<frozen importlib] - Optimal threshold: 0.4626
[2025-11-19 09:48:22,521] [INFO] [<frozen importlib] - Best f1: 0.2850
[2025-11-19 09:48:22,521] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:48:22,575] [INFO] [<frozen importlib] - Validation Results (threshold=0.4626):
[2025-11-19 09:48:22,575] [INFO] [<frozen importlib] -   Accuracy: 0.8986
[2025-11-19 09:48:22,575] [INFO] [<frozen importlib] -   Precision: 0.3108
[2025-11-19 09:48:22,575] [INFO] [<frozen importlib] -   Recall: 0.2631
[2025-11-19 09:48:22,575] [INFO] [<frozen importlib] -   F1 Score: 0.2850
[2025-11-19 09:48:22,575] [INFO] [<frozen importlib] -   AUROC: 0.7112
[2025-11-19 09:48:22,575] [INFO] [<frozen importlib] -   AUPRC: 0.2325
[2025-11-19 09:48:22,575] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:48:22,575] [INFO] [<frozen importlib] -     TN=16598, FP=847
[2025-11-19 09:48:22,575] [INFO] [<frozen importlib] -     FN=1070, TP=382
[2025-11-19 09:48:22,602] [INFO] [<frozen importlib] - Trial 495: AUPRC=0.2325, F1=0.4539, Prec=0.4435, Rec=0.4649 | Optimizing auprc=0.2325
[2025-11-19 09:48:22,603] [INFO] [<frozen importlib] - Trial 495 pruned.
[2025-11-19 09:48:22,603] [ERROR] [<frozen importlib] - Trial 495 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  99%|█████████▉| 495/500 [1:26:20<01:12, 14.55s/it]Best trial: 289. Best value: 0.241792:  99%|█████████▉| 495/500 [1:26:20<01:12, 14.55s/it]Best trial: 289. Best value: 0.241792:  99%|█████████▉| 496/500 [1:26:20<01:02, 15.70s/it][2025-11-19 09:48:22,618] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.3833860418290325
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   min_child_weight: 7
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   gamma: 0.2455822413164003
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   alpha: 0.4914890922665968
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   lambda: 1.3806240112115467
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   learning_rate: 0.03171819700430962
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   subsample: 0.8157273404215328
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   colsample_bytree: 0.6140694284152691
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5085320719086399
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   colsample_bynode: 0.7898724092999458
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:48:22,618] [INFO] [<frozen importlib] -   scale_pos_weight: 6.3833860418290325
[2025-11-19 09:48:22,698] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:48:22] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:48:22,603] Trial 495 pruned. 
[0]	train-logloss:0.66569	train-auc:0.64306	train-aucpr:0.25195	val-logloss:0.65977	val-auc:0.58541	val-aucpr:0.11212
[10]	train-logloss:0.64510	train-auc:0.68097	train-aucpr:0.29494	val-logloss:0.61618	val-auc:0.70701	val-aucpr:0.21643
[20]	train-logloss:0.63174	train-auc:0.68460	train-aucpr:0.29999	val-logloss:0.57781	val-auc:0.70639	val-aucpr:0.21428
[30]	train-logloss:0.62253	train-auc:0.68959	train-aucpr:0.30319	val-logloss:0.55472	val-auc:0.71007	val-aucpr:0.22992
[40]	train-logloss:0.61561	train-auc:0.69386	train-aucpr:0.30670	val-logloss:0.52936	val-auc:0.70556	val-aucpr:0.22691
[50]	train-logloss:0.60943	train-auc:0.69869	train-aucpr:0.31097	val-logloss:0.52012	val-auc:0.70443	val-aucpr:0.22441
[60]	train-logloss:0.60542	train-auc:0.70103	train-aucpr:0.31388	val-logloss:0.50877	val-auc:0.70579	val-aucpr:0.22757
[2025-11-19 09:48:25,933] [INFO] [<frozen importlib] - Training completed at iteration 31
[2025-11-19 09:48:25,933] [INFO] [<frozen importlib] - Best train loss: 0.6217
[2025-11-19 09:48:25,933] [INFO] [<frozen importlib] - Best val loss: 0.5518
[2025-11-19 09:48:25,933] [INFO] [<frozen importlib] - Best val AUC: 0.7092
[2025-11-19 09:48:25,933] [INFO] [<frozen importlib] - Best val AUCPR: 0.2300
[2025-11-19 09:48:25,936] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:48:25] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:48:31,577] [INFO] [<frozen importlib] - Optimal threshold: 0.4768
[2025-11-19 09:48:31,577] [INFO] [<frozen importlib] - Best f1: 0.2791
[2025-11-19 09:48:31,577] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:48:31,630] [INFO] [<frozen importlib] - Validation Results (threshold=0.4768):
[2025-11-19 09:48:31,630] [INFO] [<frozen importlib] -   Accuracy: 0.8934
[2025-11-19 09:48:31,630] [INFO] [<frozen importlib] -   Precision: 0.2904
[2025-11-19 09:48:31,630] [INFO] [<frozen importlib] -   Recall: 0.2686
[2025-11-19 09:48:31,630] [INFO] [<frozen importlib] -   F1 Score: 0.2791
[2025-11-19 09:48:31,630] [INFO] [<frozen importlib] -   AUROC: 0.7092
[2025-11-19 09:48:31,630] [INFO] [<frozen importlib] -   AUPRC: 0.2299
[2025-11-19 09:48:31,630] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:48:31,630] [INFO] [<frozen importlib] -     TN=16492, FP=953
[2025-11-19 09:48:31,630] [INFO] [<frozen importlib] -     FN=1062, TP=390
[2025-11-19 09:48:31,654] [INFO] [<frozen importlib] - Trial 496: AUPRC=0.2299, F1=0.4454, Prec=0.4196, Rec=0.4745 | Optimizing auprc=0.2299
                                                                                          Best trial: 289. Best value: 0.241792:  99%|█████████▉| 496/500 [1:26:29<01:02, 15.70s/it]Best trial: 289. Best value: 0.241792:  99%|█████████▉| 496/500 [1:26:29<01:02, 15.70s/it]Best trial: 289. Best value: 0.241792:  99%|█████████▉| 497/500 [1:26:29<00:41, 13.70s/it][2025-11-19 09:48:31,669] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.53335030211957
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   gamma: 0.22612437059246154
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   alpha: 0.524681137761757
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   lambda: 1.5434948895010128
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   learning_rate: 0.03240461590323018
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   subsample: 0.8398354119841337
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   colsample_bytree: 0.6015851964851866
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5323019803308296
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   colsample_bynode: 0.7821399577413285
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:48:31,669] [INFO] [<frozen importlib] -   scale_pos_weight: 5.53335030211957
[2025-11-19 09:48:31,741] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:48:31] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:48:31,655] Trial 496 finished with value: 0.22992289731446222 and parameters: {'max_depth': 4, 'min_child_weight': 7, 'gamma': 0.2455822413164003, 'learning_rate': 0.03171819700430962, 'n_estimators': 450, 'alpha': 0.4914890922665968, 'lambda': 1.3806240112115467, 'subsample': 0.8157273404215328, 'colsample_bytree': 0.6140694284152691, 'colsample_bylevel': 0.5085320719086399, 'colsample_bynode': 0.7898724092999458, 'scale_pos_weight': 6.3833860418290325}. Best is trial 289 with value: 0.24179190906297438.
[0]	train-logloss:0.61785	train-auc:0.65462	train-aucpr:0.23854	val-logloss:0.61108	val-auc:0.48669	val-aucpr:0.06933
[10]	train-logloss:0.59890	train-auc:0.68028	train-aucpr:0.29035	val-logloss:0.56111	val-auc:0.68224	val-aucpr:0.19608
[20]	train-logloss:0.58667	train-auc:0.68711	train-aucpr:0.29623	val-logloss:0.52575	val-auc:0.69484	val-aucpr:0.21005
[30]	train-logloss:0.57770	train-auc:0.69181	train-aucpr:0.30134	val-logloss:0.50088	val-auc:0.68934	val-aucpr:0.21418
[40]	train-logloss:0.57115	train-auc:0.69609	train-aucpr:0.30598	val-logloss:0.48305	val-auc:0.69670	val-aucpr:0.21676
[50]	train-logloss:0.56614	train-auc:0.69932	train-aucpr:0.30992	val-logloss:0.47174	val-auc:0.69455	val-aucpr:0.21825
[60]	train-logloss:0.56207	train-auc:0.70243	train-aucpr:0.31443	val-logloss:0.47472	val-auc:0.69831	val-aucpr:0.21890
[70]	train-logloss:0.55862	train-auc:0.70671	train-aucpr:0.31771	val-logloss:0.46987	val-auc:0.70197	val-aucpr:0.21673
[80]	train-logloss:0.55596	train-auc:0.70875	train-aucpr:0.32120	val-logloss:0.46353	val-auc:0.70481	val-aucpr:0.21902
[89]	train-logloss:0.55384	train-auc:0.71181	train-aucpr:0.32441	val-logloss:0.46481	val-auc:0.70342	val-aucpr:0.21526
[2025-11-19 09:48:34,768] [INFO] [<frozen importlib] - Training completed at iteration 59
[2025-11-19 09:48:34,768] [INFO] [<frozen importlib] - Best train loss: 0.5626
[2025-11-19 09:48:34,768] [INFO] [<frozen importlib] - Best val loss: 0.4724
[2025-11-19 09:48:34,768] [INFO] [<frozen importlib] - Best val AUC: 0.6983
[2025-11-19 09:48:34,768] [INFO] [<frozen importlib] - Best val AUCPR: 0.2226
[2025-11-19 09:48:34,771] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:48:34] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:48:47,016] [INFO] [<frozen importlib] - Optimal threshold: 0.4298
[2025-11-19 09:48:47,016] [INFO] [<frozen importlib] - Best f1: 0.2729
[2025-11-19 09:48:47,016] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:48:47,078] [INFO] [<frozen importlib] - Validation Results (threshold=0.4298):
[2025-11-19 09:48:47,078] [INFO] [<frozen importlib] -   Accuracy: 0.8759
[2025-11-19 09:48:47,078] [INFO] [<frozen importlib] -   Precision: 0.2482
[2025-11-19 09:48:47,078] [INFO] [<frozen importlib] -   Recall: 0.3030
[2025-11-19 09:48:47,078] [INFO] [<frozen importlib] -   F1 Score: 0.2729
[2025-11-19 09:48:47,078] [INFO] [<frozen importlib] -   AUROC: 0.6983
[2025-11-19 09:48:47,078] [INFO] [<frozen importlib] -   AUPRC: 0.2230
[2025-11-19 09:48:47,078] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:48:47,079] [INFO] [<frozen importlib] -     TN=16112, FP=1333
[2025-11-19 09:48:47,079] [INFO] [<frozen importlib] -     FN=1012, TP=440
[2025-11-19 09:48:47,104] [INFO] [<frozen importlib] - Trial 497: AUPRC=0.2230, F1=0.4420, Prec=0.3721, Rec=0.5441 | Optimizing auprc=0.2230
[2025-11-19 09:48:47,105] [INFO] [<frozen importlib] - Trial 497 pruned.
[2025-11-19 09:48:47,105] [ERROR] [<frozen importlib] - Trial 497 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792:  99%|█████████▉| 497/500 [1:26:45<00:41, 13.70s/it]Best trial: 289. Best value: 0.241792:  99%|█████████▉| 497/500 [1:26:45<00:41, 13.70s/it]Best trial: 289. Best value: 0.241792: 100%|█████████▉| 498/500 [1:26:45<00:28, 14.23s/it][2025-11-19 09:48:47,131] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 5.9869535056362135
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   min_child_weight: 10
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   gamma: 0.28088424703865744
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   alpha: 0.5697298547145644
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   lambda: 1.2874129129071437
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   learning_rate: 0.033265748022039965
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   subsample: 0.8293144845229307
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   colsample_bytree: 0.6239048493323621
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   colsample_bylevel: 0.52312069008204
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   colsample_bynode: 0.7993078603517174
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:48:47,131] [INFO] [<frozen importlib] -   scale_pos_weight: 5.9869535056362135
[2025-11-19 09:48:47,208] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:48:47] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:48:47,105] Trial 497 pruned. 
[0]	train-logloss:0.64372	train-auc:0.63995	train-aucpr:0.21901	val-logloss:0.63420	val-auc:0.57861	val-aucpr:0.10388
[10]	train-logloss:0.62302	train-auc:0.67778	train-aucpr:0.29500	val-logloss:0.58379	val-auc:0.69754	val-aucpr:0.20327
[20]	train-logloss:0.60971	train-auc:0.68462	train-aucpr:0.29880	val-logloss:0.54716	val-auc:0.69373	val-aucpr:0.21182
[30]	train-logloss:0.60068	train-auc:0.69158	train-aucpr:0.30306	val-logloss:0.52637	val-auc:0.69532	val-aucpr:0.21495
[40]	train-logloss:0.59389	train-auc:0.69583	train-aucpr:0.30860	val-logloss:0.50595	val-auc:0.70200	val-aucpr:0.21749
[50]	train-logloss:0.58830	train-auc:0.69952	train-aucpr:0.31270	val-logloss:0.49714	val-auc:0.70445	val-aucpr:0.21862
[60]	train-logloss:0.58445	train-auc:0.70255	train-aucpr:0.31521	val-logloss:0.48767	val-auc:0.70912	val-aucpr:0.22444
[70]	train-logloss:0.58098	train-auc:0.70519	train-aucpr:0.31808	val-logloss:0.47170	val-auc:0.70894	val-aucpr:0.22398
[80]	train-logloss:0.57832	train-auc:0.70817	train-aucpr:0.32107	val-logloss:0.46640	val-auc:0.70775	val-aucpr:0.22088
[86]	train-logloss:0.57673	train-auc:0.71036	train-aucpr:0.32313	val-logloss:0.46351	val-auc:0.70034	val-aucpr:0.20681
[2025-11-19 09:48:51,133] [INFO] [<frozen importlib] - Training completed at iteration 57
[2025-11-19 09:48:51,133] [INFO] [<frozen importlib] - Best train loss: 0.5855
[2025-11-19 09:48:51,133] [INFO] [<frozen importlib] - Best val loss: 0.4905
[2025-11-19 09:48:51,133] [INFO] [<frozen importlib] - Best val AUC: 0.7095
[2025-11-19 09:48:51,133] [INFO] [<frozen importlib] - Best val AUCPR: 0.2251
[2025-11-19 09:48:51,136] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:48:51] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:49:03,215] [INFO] [<frozen importlib] - Optimal threshold: 0.4519
[2025-11-19 09:49:03,215] [INFO] [<frozen importlib] - Best f1: 0.2671
[2025-11-19 09:49:03,215] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:49:03,261] [INFO] [<frozen importlib] - Validation Results (threshold=0.4519):
[2025-11-19 09:49:03,261] [INFO] [<frozen importlib] -   Accuracy: 0.8763
[2025-11-19 09:49:03,261] [INFO] [<frozen importlib] -   Precision: 0.2451
[2025-11-19 09:49:03,261] [INFO] [<frozen importlib] -   Recall: 0.2934
[2025-11-19 09:49:03,261] [INFO] [<frozen importlib] -   F1 Score: 0.2671
[2025-11-19 09:49:03,261] [INFO] [<frozen importlib] -   AUROC: 0.7095
[2025-11-19 09:49:03,261] [INFO] [<frozen importlib] -   AUPRC: 0.2254
[2025-11-19 09:49:03,261] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:49:03,261] [INFO] [<frozen importlib] -     TN=16133, FP=1312
[2025-11-19 09:49:03,261] [INFO] [<frozen importlib] -     FN=1026, TP=426
[2025-11-19 09:49:03,286] [INFO] [<frozen importlib] - Trial 498: AUPRC=0.2254, F1=0.4336, Prec=0.3683, Rec=0.5269 | Optimizing auprc=0.2254
[2025-11-19 09:49:03,287] [INFO] [<frozen importlib] - Trial 498 pruned.
[2025-11-19 09:49:03,287] [ERROR] [<frozen importlib] - Trial 498 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792: 100%|█████████▉| 498/500 [1:27:01<00:28, 14.23s/it]Best trial: 289. Best value: 0.241792: 100%|█████████▉| 498/500 [1:27:01<00:28, 14.23s/it]Best trial: 289. Best value: 0.241792: 100%|█████████▉| 499/500 [1:27:01<00:14, 14.81s/it][2025-11-19 09:49:03,302] [INFO] [<frozen importlib] - Using scale_pos_weight from config: 6.658236310408802
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] - === Training XGBoost Model ===
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] - XGBoost Parameters:
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   objective: binary:logistic
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   eval_metric: ['logloss', 'auc', 'aucpr']
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   tree_method: gpu_hist
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   device: cuda
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   min_child_weight: 6
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   gamma: 0.25548861247817717
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   alpha: 0.3975604536291497
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   lambda: 1.3326785606952947
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   learning_rate: 0.031894046048062945
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   subsample: 0.8186160166962173
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   colsample_bytree: 0.592243216461008
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5442402473717223
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   colsample_bynode: 0.8161653284406164
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   random_state: 42
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   n_jobs: -1
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   verbosity: 1
[2025-11-19 09:49:03,302] [INFO] [<frozen importlib] -   scale_pos_weight: 6.658236310408802
[2025-11-19 09:49:03,376] [INFO] [<frozen importlib] - Training with 450 rounds and early stopping at 30
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/callback.py:386: UserWarning: [09:49:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  self.starting_round = model.num_boosted_rounds()
[I 2025-11-19 09:49:03,287] Trial 498 pruned. 
[0]	train-logloss:0.68128	train-auc:0.63129	train-aucpr:0.21823	val-logloss:0.67684	val-auc:0.64764	val-aucpr:0.15194
[10]	train-logloss:0.65959	train-auc:0.68148	train-aucpr:0.28810	val-logloss:0.63080	val-auc:0.70614	val-aucpr:0.21822
[20]	train-logloss:0.64510	train-auc:0.68783	train-aucpr:0.29892	val-logloss:0.59668	val-auc:0.71888	val-aucpr:0.21753
[30]	train-logloss:0.63501	train-auc:0.69105	train-aucpr:0.30346	val-logloss:0.56577	val-auc:0.71594	val-aucpr:0.22425
[40]	train-logloss:0.62795	train-auc:0.69569	train-aucpr:0.30726	val-logloss:0.54680	val-auc:0.71937	val-aucpr:0.22930
[50]	train-logloss:0.62177	train-auc:0.69919	train-aucpr:0.31184	val-logloss:0.52761	val-auc:0.71688	val-aucpr:0.22926
[60]	train-logloss:0.61776	train-auc:0.70167	train-aucpr:0.31512	val-logloss:0.52203	val-auc:0.71722	val-aucpr:0.23163
[70]	train-logloss:0.61396	train-auc:0.70595	train-aucpr:0.31892	val-logloss:0.51609	val-auc:0.71707	val-aucpr:0.22986
[80]	train-logloss:0.61063	train-auc:0.71008	train-aucpr:0.32244	val-logloss:0.51119	val-auc:0.71641	val-aucpr:0.22664
[90]	train-logloss:0.60805	train-auc:0.71336	train-aucpr:0.32509	val-logloss:0.51308	val-auc:0.71242	val-aucpr:0.22023
[98]	train-logloss:0.60632	train-auc:0.71532	train-aucpr:0.32682	val-logloss:0.50036	val-auc:0.71863	val-aucpr:0.22592
[2025-11-19 09:49:03,656] [INFO] [<frozen importlib] - Training completed at iteration 68
[2025-11-19 09:49:03,656] [INFO] [<frozen importlib] - Best train loss: 0.6147
[2025-11-19 09:49:03,656] [INFO] [<frozen importlib] - Best val loss: 0.5194
[2025-11-19 09:49:03,656] [INFO] [<frozen importlib] - Best val AUC: 0.7199
[2025-11-19 09:49:03,656] [INFO] [<frozen importlib] - Best val AUCPR: 0.2332
[2025-11-19 09:49:03,661] [INFO] [<frozen importlib] - === Optimizing Threshold for F1 ===
/home/wanting/energy_anomaly_detection/.venv/lib/python3.12/site-packages/xgboost/core.py:729: UserWarning: [09:49:03] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.

    E.g. tree_method = "hist", device = "cuda"

  return func(**kwargs)
[2025-11-19 09:49:15,785] [INFO] [<frozen importlib] - Optimal threshold: 0.4788
[2025-11-19 09:49:15,785] [INFO] [<frozen importlib] - Best f1: 0.2892
[2025-11-19 09:49:15,785] [INFO] [<frozen importlib] - === Evaluating on Validation Set ===
[2025-11-19 09:49:15,830] [INFO] [<frozen importlib] - Validation Results (threshold=0.4788):
[2025-11-19 09:49:15,830] [INFO] [<frozen importlib] -   Accuracy: 0.8913
[2025-11-19 09:49:15,830] [INFO] [<frozen importlib] -   Precision: 0.2905
[2025-11-19 09:49:15,830] [INFO] [<frozen importlib] -   Recall: 0.2879
[2025-11-19 09:49:15,830] [INFO] [<frozen importlib] -   F1 Score: 0.2892
[2025-11-19 09:49:15,830] [INFO] [<frozen importlib] -   AUROC: 0.7199
[2025-11-19 09:49:15,830] [INFO] [<frozen importlib] -   AUPRC: 0.2336
[2025-11-19 09:49:15,830] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:49:15,830] [INFO] [<frozen importlib] -     TN=16424, FP=1021
[2025-11-19 09:49:15,830] [INFO] [<frozen importlib] -     FN=1034, TP=418
[2025-11-19 09:49:15,853] [INFO] [<frozen importlib] - Trial 499: AUPRC=0.2336, F1=0.4539, Prec=0.4156, Rec=0.5000 | Optimizing auprc=0.2336
[2025-11-19 09:49:15,853] [INFO] [<frozen importlib] - Trial 499 pruned.
[2025-11-19 09:49:15,853] [ERROR] [<frozen importlib] - Trial 499 failed with error: 
                                                                                          Best trial: 289. Best value: 0.241792: 100%|█████████▉| 499/500 [1:27:13<00:14, 14.81s/it]Best trial: 289. Best value: 0.241792: 100%|█████████▉| 499/500 [1:27:13<00:14, 14.81s/it]Best trial: 289. Best value: 0.241792: 100%|██████████| 500/500 [1:27:13<00:00, 14.14s/it]Best trial: 289. Best value: 0.241792: 100%|██████████| 500/500 [1:27:13<00:00, 10.47s/it]
[2025-11-19 09:49:15,854] [INFO] [<frozen importlib] - ============================================================
[2025-11-19 09:49:15,854] [INFO] [<frozen importlib] - Hyperparameter Tuning Completed
[2025-11-19 09:49:15,854] [INFO] [<frozen importlib] - ============================================================
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] - Number of finished trials: 500
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] - Best trial value (auprc): 0.2418
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] - Best hyperparameters:
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   max_depth: 4
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   min_child_weight: 5
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   gamma: 0.1839985518857824
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   learning_rate: 0.03341111958449861
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   n_estimators: 450
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   alpha: 0.4683400510947461
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   lambda: 0.8329058129495245
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   subsample: 0.8193008011639229
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   colsample_bytree: 0.5957335774509215
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   colsample_bylevel: 0.5001868011920084
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   colsample_bynode: 0.7545748702416571
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] -   scale_pos_weight: 5.753742978625884
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] - ============================================================
[2025-11-19 09:49:15,882] [INFO] [<frozen importlib] - Saving tuning results to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201
[2025-11-19 09:49:15,948] [INFO] [<frozen importlib] - Saved study object to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201/study.pkl
[2025-11-19 09:49:15,948] [INFO] [<frozen importlib] - Saved best parameters to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201/best_params.yaml
[2025-11-19 09:49:16,000] [INFO] [<frozen importlib] - Saved trials to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201/trials.csv
[2025-11-19 09:49:16,023] [INFO] [<frozen importlib] - Saved summary to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201/summary.txt
[2025-11-19 09:49:16,023] [INFO] [<frozen importlib] - All results saved to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201
[2025-11-19 09:49:16,023] [INFO] [<frozen importlib] - 
============================================================
[2025-11-19 09:49:16,023] [INFO] [<frozen importlib] - Evaluating Best Model on Test Set
[2025-11-19 09:49:16,023] [INFO] [<frozen importlib] - ============================================================
[2025-11-19 09:49:16,023] [INFO] [<frozen importlib] - === Evaluating on Test Set ===
[2025-11-19 09:49:16,085] [INFO] [<frozen importlib] - Test Results (threshold=0.4571):
[2025-11-19 09:49:16,085] [INFO] [<frozen importlib] -   Accuracy: 0.9131
[2025-11-19 09:49:16,085] [INFO] [<frozen importlib] -   Precision: 0.2884
[2025-11-19 09:49:16,085] [INFO] [<frozen importlib] -   Recall: 0.2275
[2025-11-19 09:49:16,085] [INFO] [<frozen importlib] -   F1 Score: 0.2543
[2025-11-19 09:49:16,085] [INFO] [<frozen importlib] -   AUROC: 0.7159
[2025-11-19 09:49:16,085] [INFO] [<frozen importlib] -   AUPRC: 0.1976
[2025-11-19 09:49:16,085] [INFO] [<frozen importlib] -   Confusion Matrix:
[2025-11-19 09:49:16,085] [INFO] [<frozen importlib] -     TN=16975, FP=691
[2025-11-19 09:49:16,085] [INFO] [<frozen importlib] -     FN=951, TP=280
[2025-11-19 09:49:16,112] [INFO] [<frozen importlib] - 
============================================================
[2025-11-19 09:49:16,112] [INFO] [<frozen importlib] - Extracting Feature Importance
[2025-11-19 09:49:16,112] [INFO] [<frozen importlib] - ============================================================
[2025-11-19 09:49:16,116] [INFO] [<frozen importlib] - Top 10 features by gain:
[2025-11-19 09:49:16,116] [INFO] [<frozen importlib] -   1. aCosPhi_L1_spectral_flatness: 501.1289
[2025-11-19 09:49:16,117] [INFO] [<frozen importlib] -   2. aPowerFactorPF_L2_std: 395.3449
[2025-11-19 09:49:16,117] [INFO] [<frozen importlib] -   3. aCosPhi_L1_freq_energy_ratio_low_high: 363.3707
[2025-11-19 09:49:16,117] [INFO] [<frozen importlib] -   4. aCosPhi_L3_spectral_flatness: 325.5617
[2025-11-19 09:49:16,117] [INFO] [<frozen importlib] -   5. aPowerFactorPF_L2_change_point_score: 315.9355
[2025-11-19 09:49:16,117] [INFO] [<frozen importlib] -   6. aPowerFactorPF_L2_welch_total_power: 287.6570
[2025-11-19 09:49:16,117] [INFO] [<frozen importlib] -   7. aCosPhi_L3_freq_energy_ratio_low_high: 286.4428
[2025-11-19 09:49:16,117] [INFO] [<frozen importlib] -   8. aCosPhi_L2_change_point_score: 283.7555
[2025-11-19 09:49:16,117] [INFO] [<frozen importlib] -   9. aCosPhi_L1_change_point_score: 275.7500
[2025-11-19 09:49:16,117] [INFO] [<frozen importlib] -   10. rTotalApparentEnergy_mean: 272.5132
[2025-11-19 09:49:16,118] [INFO] [<frozen importlib] - Saved feature importance (CSV) to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201/feature_importance.csv
[2025-11-19 09:49:16,118] [INFO] [<frozen importlib] - 
Top 15 Most Important Features:
[2025-11-19 09:49:16,118] [INFO] [<frozen importlib] -    1. aCosPhi_L1_spectral_flatness                  501.128876
[2025-11-19 09:49:16,118] [INFO] [<frozen importlib] -    2. aPowerFactorPF_L2_std                         395.344940
[2025-11-19 09:49:16,118] [INFO] [<frozen importlib] -    3. aCosPhi_L1_freq_energy_ratio_low_high         363.370728
[2025-11-19 09:49:16,118] [INFO] [<frozen importlib] -    4. aCosPhi_L3_spectral_flatness                  325.561676
[2025-11-19 09:49:16,118] [INFO] [<frozen importlib] -    5. aPowerFactorPF_L2_change_point_score          315.935547
[2025-11-19 09:49:16,118] [INFO] [<frozen importlib] -    6. aPowerFactorPF_L2_welch_total_power           287.657043
[2025-11-19 09:49:16,118] [INFO] [<frozen importlib] -    7. aCosPhi_L3_freq_energy_ratio_low_high         286.442810
[2025-11-19 09:49:16,119] [INFO] [<frozen importlib] -    8. aCosPhi_L2_change_point_score                 283.755493
[2025-11-19 09:49:16,119] [INFO] [<frozen importlib] -    9. aCosPhi_L1_change_point_score                 275.750000
[2025-11-19 09:49:16,119] [INFO] [<frozen importlib] -   10. rTotalApparentEnergy_mean                     272.513245
[2025-11-19 09:49:16,119] [INFO] [<frozen importlib] -   11. aPowerFactorPF_L2_spectral_flatness           269.279449
[2025-11-19 09:49:16,119] [INFO] [<frozen importlib] -   12. aCosPhi_L1_welch_total_power                  265.270874
[2025-11-19 09:49:16,119] [INFO] [<frozen importlib] -   13. rTotalReactiveEnergy_mean                     262.693970
[2025-11-19 09:49:16,119] [INFO] [<frozen importlib] -   14. airTotal_mean                                 256.603455
[2025-11-19 09:49:16,119] [INFO] [<frozen importlib] -   15. rTotalApparentEnergy_spectral_peak            246.109268
[2025-11-19 09:49:16,119] [INFO] [<frozen importlib] - Saved test results to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201/test_results.json
[2025-11-19 09:49:16,126] [INFO] [<frozen importlib] - Saved XGBoost model to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201/best_model/xgboost_model.json
[2025-11-19 09:49:16,126] [INFO] [<frozen importlib] - Saved model metadata to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201/best_model/model_metadata.pkl
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] - Saved config to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201/best_model/config.json
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] - Saved best model to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201/best_model
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] - 
============================================================
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] - HYPERPARAMETER TUNING COMPLETED
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] - ============================================================
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] - Best Trial Number: 289
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] - Best Validation Score (auprc): 0.2418
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] - 
Test Performance (With Point Adjustment):
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] -   F1 Score: 0.4758
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] -   Precision: 0.4648
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] -   Recall: 0.4874
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] -   Accuracy: 0.9300
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] - 
Results saved to: experiments/xgboost_timeseries2/hyperparameter_tuning/optuna_tuning_20251119_082201
[2025-11-19 09:49:16,127] [INFO] [<frozen importlib] - ============================================================
[I 2025-11-19 09:49:15,853] Trial 499 pruned. 
